/*******************************************************************************
* You may amend and distribute as you like, but don't remove this header!
*
* EPPlus provides server-side generation of Excel 2007/2010 spreadsheets.
* See http://www.codeplex.com/EPPlus for details.
*
* Copyright (C) 2011-2018 Michelle Lau, Evan Schallerer, and others as noted in the source history.
*
* This library is free software; you can redistribute it and/or
* modify it under the terms of the GNU Lesser General Public
* License as published by the Free Software Foundation; either
* version 2.1 of the License, or (at your option) any later version.
* This library is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
* See the GNU Lesser General Public License for more details.
*
* The GNU Lesser General Public License can be viewed at http://www.opensource.org/licenses/lgpl-license.php
* If you unfamiliar with this license or have questions about it, here is an http://www.gnu.org/licenses/gpl-faq.html
*
* All code and executables are provided "as is" with no warranty either express or implied. 
* The author accepts no liability for any damage or loss of business that this product may cause.
*
* For code change notes, see the source control history.
*******************************************************************************/
using System.IO;
using System.Linq;
using EPPlusTest.TestHelpers;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using OfficeOpenXml;
using OfficeOpenXml.Table.PivotTable;

namespace EPPlusTest.Table.PivotTable
{
	[TestClass]
	public class ExcelPivotTableTest
	{
		#region Integration Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTablesWorksheetSources.xlsx")]
		public void PivotTableXmlLoadsCorrectly()
		{
			var testFile = new FileInfo(@"PivotTablesWorksheetSources.xlsx");
			var tempFile = new FileInfo(Path.GetTempFileName());
			if (tempFile.Exists)
				tempFile.Delete();
			testFile.CopyTo(tempFile.FullName);
			try
			{
				using (var package = new ExcelPackage(tempFile))
				{
					Assert.AreEqual(2, package.Workbook.PivotCacheDefinitions.Count());

					var cacheRecords1 = package.Workbook.PivotCacheDefinitions[0].CacheRecords;
					var cacheRecords2 = package.Workbook.PivotCacheDefinitions[1].CacheRecords;

					Assert.AreNotEqual(cacheRecords1, cacheRecords2);
					Assert.AreEqual(22, cacheRecords1.Count);
					Assert.AreEqual(36, cacheRecords2.Count);
					Assert.AreEqual(cacheRecords1.Count, cacheRecords1.Count);
					Assert.AreEqual(cacheRecords2.Count, cacheRecords2.Count);

					var worksheet1 = package.Workbook.Worksheets["sheet1"];
					var worksheet2 = package.Workbook.Worksheets["sheet2"];
					var worksheet3 = package.Workbook.Worksheets["sheet3"];

					Assert.AreEqual(0, worksheet1.PivotTables.Count());
					Assert.AreEqual(2, worksheet2.PivotTables.Count());
					Assert.AreEqual(1, worksheet3.PivotTables.Count());

					Assert.AreEqual(worksheet2.PivotTables[0].CacheDefinition, worksheet2.PivotTables[1].CacheDefinition);
					Assert.AreNotEqual(worksheet2.PivotTables[0].CacheDefinition, worksheet3.PivotTables[0].CacheDefinition);
				}
			}
			finally
			{
				tempFile.Delete();
			}
		}
		#endregion

		#region Refresh Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWorksheetSource.xlsx")]
		public void PivotTableRefreshFromCacheWithChangedData()
		{
			var file = new FileInfo("PivotTableWorksheetSource.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					worksheet.Cells[4, 5].Value = "Blue";
					worksheet.Cells[5, 5].Value = "Green";
					worksheet.Cells[6, 5].Value = "Purple";
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I10:J17"), pivotTable.Address);
					Assert.AreEqual(4, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(7, pivotTable.RowItems.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 11, 9, "Blue"),
					new ExpectedCellValue(sheetName, 12, 9, "Bike"),
					new ExpectedCellValue(sheetName, 13, 9, "Green"),
					new ExpectedCellValue(sheetName, 14, 9, "Car"),
					new ExpectedCellValue(sheetName, 15, 9, "Purple"),
					new ExpectedCellValue(sheetName, 16, 9, "Skateboard"),
					new ExpectedCellValue(sheetName, 17, 9, "Grand Total"),

					new ExpectedCellValue(sheetName, 10, 10, "Sum of Cost"),
					new ExpectedCellValue(sheetName, 11, 10, 100d),
					new ExpectedCellValue(sheetName, 12, 10, 100d),
					new ExpectedCellValue(sheetName, 13, 10, 90000d),
					new ExpectedCellValue(sheetName, 14, 10, 90000d),
					new ExpectedCellValue(sheetName, 15, 10, 10d),
					new ExpectedCellValue(sheetName, 16, 10, 10d),
					new ExpectedCellValue(sheetName, 17, 10, 90110d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWorksheetSource.xlsx")]
		public void PivotTableRefreshFromCacheWithAddedData()
		{
			var file = new FileInfo("PivotTableWorksheetSource.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					worksheet.Cells[7, 3].Value = 4;
					worksheet.Cells[7, 4].Value = "Scooter";
					worksheet.Cells[7, 5].Value = "Purple";
					worksheet.Cells[7, 6].Value = 28;
					cacheDefinition.SetSourceRangeAddress(worksheet, worksheet.Cells["C3:F7"]);
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I10:J18"), pivotTable.Address);
					Assert.AreEqual(4, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(8, pivotTable.RowItems.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 11, 9, "Black"),
					new ExpectedCellValue(sheetName, 12, 9, "Bike"),
					new ExpectedCellValue(sheetName, 13, 9, "Skateboard"),
					new ExpectedCellValue(sheetName, 14, 9, "Purple"),
					new ExpectedCellValue(sheetName, 15, 9, "Scooter"),
					new ExpectedCellValue(sheetName, 16, 9, "Red"),
					new ExpectedCellValue(sheetName, 17, 9, "Car"),
					new ExpectedCellValue(sheetName, 18, 9, "Grand Total"),

					new ExpectedCellValue(sheetName, 10, 10, "Sum of Cost"),
					new ExpectedCellValue(sheetName, 11, 10, 110d),
					new ExpectedCellValue(sheetName, 12, 10, 100d),
					new ExpectedCellValue(sheetName, 13, 10, 10d),
					new ExpectedCellValue(sheetName, 14, 10, 28d),
					new ExpectedCellValue(sheetName, 15, 10, 28d),
					new ExpectedCellValue(sheetName, 16, 10, 90000d),
					new ExpectedCellValue(sheetName, 17, 10, 90000d),
					new ExpectedCellValue(sheetName, 18, 10, 90138d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWorksheetSource.xlsx")]
		public void PivotTableRefreshFromCacheRemoveRow()
		{
			var file = new FileInfo("PivotTableWorksheetSource.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.SetSourceRangeAddress(worksheet, worksheet.Cells["C3:F5"]);
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I10:J15"), pivotTable.Address);
					Assert.AreEqual(4, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(5, pivotTable.RowItems.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 11, 9, "Black"),
					new ExpectedCellValue(sheetName, 12, 9, "Bike"),
					new ExpectedCellValue(sheetName, 13, 9, "Red"),
					new ExpectedCellValue(sheetName, 14, 9, "Car"),
					new ExpectedCellValue(sheetName, 15, 9, "Grand Total"),

					new ExpectedCellValue(sheetName, 10, 10, "Sum of Cost"),
					new ExpectedCellValue(sheetName, 11, 10, 100d),
					new ExpectedCellValue(sheetName, 12, 10, 100d),
					new ExpectedCellValue(sheetName, 13, 10, 90000d),
					new ExpectedCellValue(sheetName, 14, 10, 90000d),
					new ExpectedCellValue(sheetName, 15, 10, 90100d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnFields.xlsx")]
		public void PivotTableRefreshColumnItemsWithChangedData()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					worksheet.Cells[4, 3].Value = "January";
					worksheet.Cells[7, 3].Value = "January";
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B12:O23"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 16, 2, "20100007"),
					new ExpectedCellValue(sheetName, 17, 2, "20100017"),
					new ExpectedCellValue(sheetName, 18, 2, "20100070"),
					new ExpectedCellValue(sheetName, 19, 2, "20100076"),
					new ExpectedCellValue(sheetName, 20, 2, "20100083"),
					new ExpectedCellValue(sheetName, 21, 2, "20100085"),
					new ExpectedCellValue(sheetName, 22, 2, "20100090"),
					new ExpectedCellValue(sheetName, 23, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, "January"),
					new ExpectedCellValue(sheetName, 14, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 16, 3, 415.75),
					new ExpectedCellValue(sheetName, 23, 3, 415.75),
					new ExpectedCellValue(sheetName, 15, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 4, 415.75),
					new ExpectedCellValue(sheetName, 22, 4, 415.75),
					new ExpectedCellValue(sheetName, 23, 4, 831.5),
					new ExpectedCellValue(sheetName, 15, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 19, 5, 415.75),
					new ExpectedCellValue(sheetName, 23, 5, 415.75),
					new ExpectedCellValue(sheetName, 14, 6, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 16, 6, 415.75),
					new ExpectedCellValue(sheetName, 17, 6, 415.75),
					new ExpectedCellValue(sheetName, 19, 6, 415.75),
					new ExpectedCellValue(sheetName, 22, 6, 415.75),
					new ExpectedCellValue(sheetName, 23, 6, 1663d),
					new ExpectedCellValue(sheetName, 14, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 15, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 7, 24.99),
					new ExpectedCellValue(sheetName, 23, 7, 24.99),
					new ExpectedCellValue(sheetName, 14, 8, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 20, 8, 24.99),
					new ExpectedCellValue(sheetName, 23, 8, 24.99),
					new ExpectedCellValue(sheetName, 13, 9, "January Total"),
					new ExpectedCellValue(sheetName, 16, 9, 415.75),
					new ExpectedCellValue(sheetName, 17, 9, 415.75),
					new ExpectedCellValue(sheetName, 19, 9, 415.75),
					new ExpectedCellValue(sheetName, 20, 9, 24.99),
					new ExpectedCellValue(sheetName, 22, 9, 415.75),
					new ExpectedCellValue(sheetName, 23, 9, 1687.99),
					new ExpectedCellValue(sheetName, 13, 10, "February"),
					new ExpectedCellValue(sheetName, 14, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 15, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 21, 10, 99d),
					new ExpectedCellValue(sheetName, 23, 10, 99d),
					new ExpectedCellValue(sheetName, 14, 11, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 21, 11, 99d),
					new ExpectedCellValue(sheetName, 23, 11, 99d),
					new ExpectedCellValue(sheetName, 14, 12, "Tent"),
					new ExpectedCellValue(sheetName, 15, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 18, 12, 199d),
					new ExpectedCellValue(sheetName, 23, 12, 199d),
					new ExpectedCellValue(sheetName, 14, 13, "Tent Total"),
					new ExpectedCellValue(sheetName, 18, 13, 199d),
					new ExpectedCellValue(sheetName, 13, 14, "February Total"),
					new ExpectedCellValue(sheetName, 18, 14, 199d),
					new ExpectedCellValue(sheetName, 21, 14, 99d),
					new ExpectedCellValue(sheetName, 23, 14, 298d),
					new ExpectedCellValue(sheetName, 13, 15, "Grand Total"),
					new ExpectedCellValue(sheetName, 16, 15, 415.75),
					new ExpectedCellValue(sheetName, 17, 15, 415.75),
					new ExpectedCellValue(sheetName, 18, 15, 199d),
					new ExpectedCellValue(sheetName, 19, 15, 415.75),
					new ExpectedCellValue(sheetName, 20, 15, 24.99),
					new ExpectedCellValue(sheetName, 21, 15, 99d),
					new ExpectedCellValue(sheetName, 22, 15, 415.75),
					new ExpectedCellValue(sheetName, 23, 15, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnFields.xlsx")]
		public void PivotTableRefreshColumnItemsWithAddedData()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					worksheet.Cells[9, 1].Value = 20100091;
					worksheet.Cells[9, 2].Value = "Texas";
					worksheet.Cells[9, 3].Value = "December";
					worksheet.Cells[9, 4].Value = "Bike";
					worksheet.Cells[9, 5].Value = 20;
					worksheet.Cells[9, 6].Value = 1;
					worksheet.Cells[9, 7].Value = 20;
					cacheDefinition.SetSourceRangeAddress(worksheet, worksheet.Cells["A1:G9"]);
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B12:U24"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(9, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 16, 2, "20100007"),
					new ExpectedCellValue(sheetName, 17, 2, "20100017"),
					new ExpectedCellValue(sheetName, 18, 2, "20100070"),
					new ExpectedCellValue(sheetName, 19, 2, "20100076"),
					new ExpectedCellValue(sheetName, 20, 2, "20100083"),
					new ExpectedCellValue(sheetName, 21, 2, "20100085"),
					new ExpectedCellValue(sheetName, 22, 2, "20100090"),
					new ExpectedCellValue(sheetName, 23, 2, "20100091"),
					new ExpectedCellValue(sheetName, 24, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, "January"),
					new ExpectedCellValue(sheetName, 14, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 16, 3, 415.75),
					new ExpectedCellValue(sheetName, 24, 3, 415.75),
					new ExpectedCellValue(sheetName, 15, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 22, 4, 415.75),
					new ExpectedCellValue(sheetName, 24, 4, 415.75),
					new ExpectedCellValue(sheetName, 15, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 19, 5, 415.75),
					new ExpectedCellValue(sheetName, 24, 5, 415.75),
					new ExpectedCellValue(sheetName, 14, 6, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 16, 6, 415.75),
					new ExpectedCellValue(sheetName, 19, 6, 415.75),
					new ExpectedCellValue(sheetName, 22, 6, 415.75),
					new ExpectedCellValue(sheetName, 24, 6, 1247.25),
					new ExpectedCellValue(sheetName, 13, 7, "January Total"),
					new ExpectedCellValue(sheetName, 16, 7, 415.75),
					new ExpectedCellValue(sheetName, 19, 7, 415.75),
					new ExpectedCellValue(sheetName, 22, 7, 415.75),
					new ExpectedCellValue(sheetName, 24, 7, 1247.25),
					new ExpectedCellValue(sheetName, 13, 8, "February"),
					new ExpectedCellValue(sheetName, 14, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 15, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 21, 8, 99d),
					new ExpectedCellValue(sheetName, 24, 8, 99d),
					new ExpectedCellValue(sheetName, 14, 9, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 21, 9, 99d),
					new ExpectedCellValue(sheetName, 24, 9, 99d),
					new ExpectedCellValue(sheetName, 14, 10, "Tent"),
					new ExpectedCellValue(sheetName, 15, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 18, 10, 199d),
					new ExpectedCellValue(sheetName, 24, 10, 199d),
					new ExpectedCellValue(sheetName, 14, 11, "Tent Total"),
					new ExpectedCellValue(sheetName, 18, 11, 199d),
					new ExpectedCellValue(sheetName, 24, 11, 199d),
					new ExpectedCellValue(sheetName, 13, 12, "February Total"),
					new ExpectedCellValue(sheetName, 18, 12, 199d),
					new ExpectedCellValue(sheetName, 21, 12, 99d),
					new ExpectedCellValue(sheetName, 24, 12, 298d),
					new ExpectedCellValue(sheetName, 13, 13, "March"),
					new ExpectedCellValue(sheetName, 14, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 13, 415.75),
					new ExpectedCellValue(sheetName, 24, 13, 415.75),
					new ExpectedCellValue(sheetName, 14, 14, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 17, 14, 415.75),
					new ExpectedCellValue(sheetName, 24, 14, 415.75),
					new ExpectedCellValue(sheetName, 14, 15, "Headlamp"),
					new ExpectedCellValue(sheetName, 15, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 15, 24.99),
					new ExpectedCellValue(sheetName, 24, 15, 24.99),
					new ExpectedCellValue(sheetName, 14, 16, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 20, 16, 24.99),
					new ExpectedCellValue(sheetName, 24, 16, 24.99),
					new ExpectedCellValue(sheetName, 13, 17, "March Total"),
					new ExpectedCellValue(sheetName, 17, 17, 415.75),
					new ExpectedCellValue(sheetName, 20, 17, 24.99),
					new ExpectedCellValue(sheetName, 24, 17, 440.74),
					new ExpectedCellValue(sheetName, 13, 18, "December"),
					new ExpectedCellValue(sheetName, 14, 18, "Bike"),
					new ExpectedCellValue(sheetName, 15, 18, "Texas"),
					new ExpectedCellValue(sheetName, 23, 18, 20d),
					new ExpectedCellValue(sheetName, 24, 18, 20d),
					new ExpectedCellValue(sheetName, 14, 19, "Bike Total"),
					new ExpectedCellValue(sheetName, 23, 19, 20d),
					new ExpectedCellValue(sheetName, 24, 19, 20d),
					new ExpectedCellValue(sheetName, 13, 20, "December Total"),
					new ExpectedCellValue(sheetName, 23, 20, 20d),
					new ExpectedCellValue(sheetName, 24, 20, 20d),
					new ExpectedCellValue(sheetName, 13, 21, "Grand Total"),
					new ExpectedCellValue(sheetName, 16, 21, 415.75),
					new ExpectedCellValue(sheetName, 17, 21, 415.75),
					new ExpectedCellValue(sheetName, 18, 21, 199d),
					new ExpectedCellValue(sheetName, 19, 21, 415.75),
					new ExpectedCellValue(sheetName, 20, 21, 24.99),
					new ExpectedCellValue(sheetName, 21, 21, 99d),
					new ExpectedCellValue(sheetName, 22, 21, 415.75),
					new ExpectedCellValue(sheetName, 23, 21, 20d),
					new ExpectedCellValue(sheetName, 24, 21, 2005.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnFields.xlsx")]
		public void PivotTableRefreshColumnItemsWithRemoveData()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.SetSourceRangeAddress(worksheet, worksheet.Cells["A1:G5"]);
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B12:M20"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 16, 2, "20100007"),
					new ExpectedCellValue(sheetName, 17, 2, "20100076"),
					new ExpectedCellValue(sheetName, 18, 2, "20100083"),
					new ExpectedCellValue(sheetName, 19, 2, "20100085"),
					new ExpectedCellValue(sheetName, 20, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, "January"),
					new ExpectedCellValue(sheetName, 14, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 16, 3, 415.75),
					new ExpectedCellValue(sheetName, 20, 3, 415.75),
					new ExpectedCellValue(sheetName, 15, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 4, 415.75),
					new ExpectedCellValue(sheetName, 20, 4, 415.75),
					new ExpectedCellValue(sheetName, 14, 5, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 16, 5, 415.75),
					new ExpectedCellValue(sheetName, 17, 5, 415.75),
					new ExpectedCellValue(sheetName, 20, 5, 831.5),
					new ExpectedCellValue(sheetName, 13, 6, "January Total"),
					new ExpectedCellValue(sheetName, 16, 6, 415.75),
					new ExpectedCellValue(sheetName, 17, 6, 415.75),
					new ExpectedCellValue(sheetName, 20, 6, 831.5),
					new ExpectedCellValue(sheetName, 13, 7, "February"),
					new ExpectedCellValue(sheetName, 14, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 15, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 19, 7, 99d),
					new ExpectedCellValue(sheetName, 20, 7, 99d),
					new ExpectedCellValue(sheetName, 14, 8, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 19, 8, 99d),
					new ExpectedCellValue(sheetName, 20, 8, 99d),
					new ExpectedCellValue(sheetName, 13, 9, "February Total"),
					new ExpectedCellValue(sheetName, 19, 9, 99d),
					new ExpectedCellValue(sheetName, 20, 9, 99d),
					new ExpectedCellValue(sheetName, 13, 10, "March"),
					new ExpectedCellValue(sheetName, 14, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 15, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 18, 10, 24.99),
					new ExpectedCellValue(sheetName, 20, 10, 24.99),
					new ExpectedCellValue(sheetName, 14, 11, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 18, 11, 24.99),
					new ExpectedCellValue(sheetName, 20, 11, 24.99),
					new ExpectedCellValue(sheetName, 13, 12, "March Total"),
					new ExpectedCellValue(sheetName, 18, 12, 24.99),
					new ExpectedCellValue(sheetName, 20, 12, 24.99),
					new ExpectedCellValue(sheetName, 13, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 16, 13, 415.75),
					new ExpectedCellValue(sheetName, 17, 13, 415.75),
					new ExpectedCellValue(sheetName, 18, 13, 24.99),
					new ExpectedCellValue(sheetName, 19, 13, 99d),
					new ExpectedCellValue(sheetName, 20, 13, 955.49)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnFields.xlsx")]
		public void PivotTableRefreshDeletingSourceRow()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					worksheet.DeleteRow(6);
					cacheDefinition.SetSourceRangeAddress(worksheet, worksheet.Cells["A1:G7"]);
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B11:P21"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 15, 2, "20100007"),
					new ExpectedCellValue(sheetName, 16, 2, "20100017"),
					new ExpectedCellValue(sheetName, 17, 2, "20100076"),
					new ExpectedCellValue(sheetName, 18, 2, "20100083"),
					new ExpectedCellValue(sheetName, 19, 2, "20100085"),
					new ExpectedCellValue(sheetName, 20, 2, "20100090"),
					new ExpectedCellValue(sheetName, 21, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 12, 3, "January"),
					new ExpectedCellValue(sheetName, 13, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 15, 3, 415.75),
					new ExpectedCellValue(sheetName, 21, 3, 415.75),
					new ExpectedCellValue(sheetName, 14, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 4, 415.75),
					new ExpectedCellValue(sheetName, 21, 4, 415.75),
					new ExpectedCellValue(sheetName, 14, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 5, 415.75),
					new ExpectedCellValue(sheetName, 21, 5, 415.75),
					new ExpectedCellValue(sheetName, 13, 6, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 15, 6, 415.75),
					new ExpectedCellValue(sheetName, 17, 6, 415.75),
					new ExpectedCellValue(sheetName, 20, 6, 415.75),
					new ExpectedCellValue(sheetName, 21, 6, 1247.25),
					new ExpectedCellValue(sheetName, 12, 7, "January Total"),
					new ExpectedCellValue(sheetName, 15, 7, 415.75),
					new ExpectedCellValue(sheetName, 17, 7, 415.75),
					new ExpectedCellValue(sheetName, 20, 7, 415.75),
					new ExpectedCellValue(sheetName, 21, 7, 1247.25),
					new ExpectedCellValue(sheetName, 12, 8, "February"),
					new ExpectedCellValue(sheetName, 13, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 14, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 19, 8, 99d),
					new ExpectedCellValue(sheetName, 21, 8, 99d),
					new ExpectedCellValue(sheetName, 13, 9, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 19, 9, 99d),
					new ExpectedCellValue(sheetName, 21, 9, 99d),
					new ExpectedCellValue(sheetName, 12, 10, "February Total"),
					new ExpectedCellValue(sheetName, 19, 10, 99d),
					new ExpectedCellValue(sheetName, 21, 10, 99d),
					new ExpectedCellValue(sheetName, 12, 11, "March"),
					new ExpectedCellValue(sheetName, 13, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 11, 415.75),
					new ExpectedCellValue(sheetName, 21, 11, 415.75),
					new ExpectedCellValue(sheetName, 13, 12, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 16, 12, 415.75),
					new ExpectedCellValue(sheetName, 21, 12, 415.75),
					new ExpectedCellValue(sheetName, 13, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 14, 13, "Chicago"),
					new ExpectedCellValue(sheetName, 18, 13, 24.99),
					new ExpectedCellValue(sheetName, 21, 13, 24.99),
					new ExpectedCellValue(sheetName, 13, 14, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 18, 14, 24.99),
					new ExpectedCellValue(sheetName, 21, 14, 24.99),
					new ExpectedCellValue(sheetName, 12, 15, "March Total"),
					new ExpectedCellValue(sheetName, 16, 15, 415.75),
					new ExpectedCellValue(sheetName, 18, 15, 24.99),
					new ExpectedCellValue(sheetName, 21, 15, 440.74),
					new ExpectedCellValue(sheetName, 12, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 16, 415.75),
					new ExpectedCellValue(sheetName, 16, 16, 415.75),
					new ExpectedCellValue(sheetName, 17, 16, 415.75),
					new ExpectedCellValue(sheetName, 18, 16, 24.99),
					new ExpectedCellValue(sheetName, 19, 16, 99d),
					new ExpectedCellValue(sheetName, 20, 16, 415.75),
					new ExpectedCellValue(sheetName, 21, 16, 1786.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowFieldsColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleRowFieldsColumnDataFields()
		{
			var file = new FileInfo("PivotTableWithMultipleRowFieldsColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D19"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 3, 415.75),
					new ExpectedCellValue(sheetName, 5, 4, 2),
					new ExpectedCellValue(sheetName, 6, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 3, 831.5),
					new ExpectedCellValue(sheetName, 6, 4, 4),
					new ExpectedCellValue(sheetName, 7, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 3, 415.75),
					new ExpectedCellValue(sheetName, 7, 4, 1),
					new ExpectedCellValue(sheetName, 8, 2, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 8, 3, 1663),
					new ExpectedCellValue(sheetName, 8, 4, 7),
					new ExpectedCellValue(sheetName, 9, 2, "January Total"),
					new ExpectedCellValue(sheetName, 9, 3, 1663),
					new ExpectedCellValue(sheetName, 9, 4, 7),
					new ExpectedCellValue(sheetName, 10, 2, "February"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 3, 99),
					new ExpectedCellValue(sheetName, 12, 4, 1),
					new ExpectedCellValue(sheetName, 13, 2, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 13, 3, 99),
					new ExpectedCellValue(sheetName, 13, 4, 1),
					new ExpectedCellValue(sheetName, 14, 2, "Tent"),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 15, 3, 24.99),
					new ExpectedCellValue(sheetName, 15, 4, 1),
					new ExpectedCellValue(sheetName, 16, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 3, 199),
					new ExpectedCellValue(sheetName, 16, 4, 6),
					new ExpectedCellValue(sheetName, 17, 2, "Tent Total"),
					new ExpectedCellValue(sheetName, 17, 3, 223.99),
					new ExpectedCellValue(sheetName, 17, 4, 7),
					new ExpectedCellValue(sheetName, 18, 2, "February Total"),
					new ExpectedCellValue(sheetName, 18, 3, 322.99),
					new ExpectedCellValue(sheetName, 18, 4, 8),
					new ExpectedCellValue(sheetName, 19, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 19, 3, 1985.99),
					new ExpectedCellValue(sheetName, 19, 4, 15),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithRowFieldsOnly.xlsx")]
		public void PivotTableRefreshSingleColumnNoDataFields()
		{
			var file = new FileInfo("PivotTableWithRowFieldsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:A5"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "January"),
					new ExpectedCellValue(sheetName, 3, 1, "February"),
					new ExpectedCellValue(sheetName, 4, 1, "March"),
					new ExpectedCellValue(sheetName, 5, 1, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithRowFieldsOnly.xlsx")]
		public void PivotTableRefreshSingleColumnTwoRowFieldsAndNoDataFields()
		{
			var file = new FileInfo("PivotTableWithRowFieldsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:E12"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "January"),
					new ExpectedCellValue(sheetName, 3, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 5, "February"),
					new ExpectedCellValue(sheetName, 7, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 5, "March"),
					new ExpectedCellValue(sheetName, 10, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 11, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 5, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMAttrbuteFieldItems.xlsx")]
		public void PivotTableRefreshFieldItemsWithMAttributes()
		{
			var file = new FileInfo("PivotTableWithMAttrbuteFieldItems.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet1"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					worksheet.Cells[2, 3].Value = "December";
					worksheet.Cells[5, 3].Value = "December";
					worksheet.Cells[8, 3].Value = "December";
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C15:D19"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					foreach (var field in pivotTable.Fields)
					{
						if (field.Items.Count > 0)
						{
							foreach (var item in field.Items)
							{
								Assert.IsNull(item.TopNode.Attributes["m"]);
								Assert.AreEqual(1, item.TopNode.Attributes.Count);
							}
						}
					}
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 16, 3, "February"),
					new ExpectedCellValue(sheetName, 17, 3, "March"),
					new ExpectedCellValue(sheetName, 18, 3, "December"),
					new ExpectedCellValue(sheetName, 19, 3, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 4, 7d),
					new ExpectedCellValue(sheetName, 17, 4, 3d),
					new ExpectedCellValue(sheetName, 18, 4, 5d),
					new ExpectedCellValue(sheetName, 19, 4, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMonthInSpanish.xlsx")]
		public void PivotTableRefreshSortMonthsInSpanishCorrectly()
		{
			var file = new FileInfo("PivotTableWithMonthInSpanish.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables.First();
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A13:F25"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 15, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 16, 1, "enero"),
					new ExpectedCellValue(sheetName, 17, 1, "febrero"),
					new ExpectedCellValue(sheetName, 18, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 1, "enero"),
					new ExpectedCellValue(sheetName, 20, 1, "febrero"),
					new ExpectedCellValue(sheetName, 21, 1, "marzo"),
					new ExpectedCellValue(sheetName, 22, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 1, "enero"),
					new ExpectedCellValue(sheetName, 24, 1, "marzo"),
					new ExpectedCellValue(sheetName, 25, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 14, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 2, 831.5),
					new ExpectedCellValue(sheetName, 16, 2, 831.5),
					new ExpectedCellValue(sheetName, 18, 2, 1663),
					new ExpectedCellValue(sheetName, 19, 2, 831.5),
					new ExpectedCellValue(sheetName, 21, 2, 831.5),
					new ExpectedCellValue(sheetName, 22, 2, 415.75),
					new ExpectedCellValue(sheetName, 24, 2, 415.75),
					new ExpectedCellValue(sheetName, 25, 2, 2910.25),
					new ExpectedCellValue(sheetName, 14, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 15, 3, 24.99),
					new ExpectedCellValue(sheetName, 17, 3, 24.99),
					new ExpectedCellValue(sheetName, 25, 3, 24.99),
					new ExpectedCellValue(sheetName, 14, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 22, 4, 99d),
					new ExpectedCellValue(sheetName, 23, 4, 99d),
					new ExpectedCellValue(sheetName, 25, 4, 99d),
					new ExpectedCellValue(sheetName, 14, 5, "Tent"),
					new ExpectedCellValue(sheetName, 18, 5, 1194d),
					new ExpectedCellValue(sheetName, 20, 5, 1194d),
					new ExpectedCellValue(sheetName, 25, 5, 1194d),
					new ExpectedCellValue(sheetName, 14, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 6, 856.49),
					new ExpectedCellValue(sheetName, 16, 6, 831.5),
					new ExpectedCellValue(sheetName, 17, 6, 24.99),
					new ExpectedCellValue(sheetName, 18, 6, 2857d),
					new ExpectedCellValue(sheetName, 19, 6, 831.5),
					new ExpectedCellValue(sheetName, 20, 6, 1194d),
					new ExpectedCellValue(sheetName, 21, 6, 831.5),
					new ExpectedCellValue(sheetName, 22, 6, 514.75),
					new ExpectedCellValue(sheetName, 23, 6, 99d),
					new ExpectedCellValue(sheetName, 24, 6, 415.75),
					new ExpectedCellValue(sheetName, 25, 6, 4228.24)

				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithSourceDataMissingValues.xlsx")]
		public void PivotTableRefreshWithShowBlankValuesAs()
		{
			var file = new FileInfo("PivotTableWithSourceDataMissingValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				object blankValue = 0;
				string sheetName = "PivotTables";
				void validateWorksheet() => TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 4, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 2, "January Total"),
					new ExpectedCellValue(sheetName, 6, 2, "February"),
					new ExpectedCellValue(sheetName, 7, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 8, 2, "Tent"),
					new ExpectedCellValue(sheetName, 9, 2, "February Total"),
					new ExpectedCellValue(sheetName, 10, 2, "March"),
					new ExpectedCellValue(sheetName, 11, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 13, 2, "March Total"),
					new ExpectedCellValue(sheetName, 14, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, 5),
					new ExpectedCellValue(sheetName, 5, 3, 5),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, blankValue),
					new ExpectedCellValue(sheetName, 8, 3, 6),
					new ExpectedCellValue(sheetName, 9, 3, 6),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, blankValue),
					new ExpectedCellValue(sheetName, 12, 3, blankValue),
					new ExpectedCellValue(sheetName, 13, 3, blankValue),
					new ExpectedCellValue(sheetName, 14, 3, 11),
				});

				// With ShowMissing set to false, blank values are shown as "0".
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables.First();
					pivotTable.ShowMissing = false;
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:C14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();

				// With ShowMissing set to true and the MissingCaption set to "BLAHBLAH", blank values are shown as "BLAHBLAH".
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables.First();
					pivotTable.ShowMissing = true;
					blankValue = pivotTable.MissingCaption = "BLAHBLAH";
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:C14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithSourceDataMissingValues.xlsx")]
		public void PivotTableRefreshAllValuesBlankWithShowBlankValuesAs()
		{
			var file = new FileInfo("PivotTableWithSourceDataMissingValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				object blankValue = 0;
				string sheetName = "PivotTables";
				void validateWorksheet() => TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 4, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 2, "January Total"),
					new ExpectedCellValue(sheetName, 6, 2, "February"),
					new ExpectedCellValue(sheetName, 7, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 8, 2, "Tent"),
					new ExpectedCellValue(sheetName, 9, 2, "February Total"),
					new ExpectedCellValue(sheetName, 10, 2, "March"),
					new ExpectedCellValue(sheetName, 11, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 13, 2, "March Total"),
					new ExpectedCellValue(sheetName, 14, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, blankValue),
					new ExpectedCellValue(sheetName, 5, 3, blankValue),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, blankValue),
					new ExpectedCellValue(sheetName, 8, 3, blankValue),
					new ExpectedCellValue(sheetName, 9, 3, blankValue),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, blankValue),
					new ExpectedCellValue(sheetName, 12, 3, blankValue),
					new ExpectedCellValue(sheetName, 13, 3, blankValue),
					new ExpectedCellValue(sheetName, 14, 3, blankValue),
				});

				// With ShowMissing set to false, blank values are shown as "0".
				using (var package = new ExcelPackage(file))
				{
					package.Workbook.Worksheets["Sheet1"].Cells["E2:G8"].Value = null;  // Clear out all source data values.
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables.First();
					pivotTable.ShowMissing = false;
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:C14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();

				// With ShowMissing set to true and the MissingCaption set to "BLAHBLAH", blank values are shown as "BLAHBLAH".
				using (var package = new ExcelPackage(file))
				{
					package.Workbook.Worksheets["Sheet1"].Cells["E2:G8"].Value = null;  // Clear out all source data values.
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables.First();
					pivotTable.ShowMissing = true;
					blankValue = pivotTable.MissingCaption = "BLAHBLAH";
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:C14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableRowDataFieldsMultipleColumnFields.xlsx")]
		public void PivotTableRefreshWithColumnFieldsAndRowDataFieldsSubtotalsBottom()
		{
			var file = new FileInfo("PivotTableRowDataFieldsMultipleColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B3:K7"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 4, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 4, "January Total"),
					new ExpectedCellValue(sheetName, 4, 5, "February"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 4, 7, "February Total"),
					new ExpectedCellValue(sheetName, 4, 8, "March"),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 4, 10, "March Total"),
					new ExpectedCellValue(sheetName, 4, 11, "Grand Total"),

					new ExpectedCellValue(sheetName, 5, 2, "Values"),
					new ExpectedCellValue(sheetName, 5, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 5, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 5, 6, "Tent"),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 5, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 5, 11, null),

					new ExpectedCellValue(sheetName, 6, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 6, 3, 1247.25),
					new ExpectedCellValue(sheetName, 6, 4, 1247.25),
					new ExpectedCellValue(sheetName, 6, 5, 99),
					new ExpectedCellValue(sheetName, 6, 6, 199),
					new ExpectedCellValue(sheetName, 6, 7, 298),
					new ExpectedCellValue(sheetName, 6, 8, 415.75),
					new ExpectedCellValue(sheetName, 6, 9, 24.99),
					new ExpectedCellValue(sheetName, 6, 10, 440.74),
					new ExpectedCellValue(sheetName, 6, 11, 1985.99),

					new ExpectedCellValue(sheetName, 7, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 3, 5),
					new ExpectedCellValue(sheetName, 7, 4, 5),
					new ExpectedCellValue(sheetName, 7, 5, 1),
					new ExpectedCellValue(sheetName, 7, 6, 6),
					new ExpectedCellValue(sheetName, 7, 7, 7),
					new ExpectedCellValue(sheetName, 7, 8, 2),
					new ExpectedCellValue(sheetName, 7, 9, 1),
					new ExpectedCellValue(sheetName, 7, 10, 3),
					new ExpectedCellValue(sheetName, 7, 11, 15)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableRowDataFieldsMultipleColumnFields.xlsx")]
		public void PivotTableRefreshWithColumnFieldsAndRowDataFieldsSubtotalsOff()
		{
			var file = new FileInfo("PivotTableRowDataFieldsMultipleColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B3:H7"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 4, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 4, "February"),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 4, 6, "March"),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 4, 8, "Grand Total"),

					new ExpectedCellValue(sheetName, 5, 2, "Values"),
					new ExpectedCellValue(sheetName, 5, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 5, 5, "Tent"),
					new ExpectedCellValue(sheetName, 5, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 5, 8, null),

					new ExpectedCellValue(sheetName, 6, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 6, 3, 1247.25),
					new ExpectedCellValue(sheetName, 6, 4, 99),
					new ExpectedCellValue(sheetName, 6, 5, 199),
					new ExpectedCellValue(sheetName, 6, 6, 415.75),
					new ExpectedCellValue(sheetName, 6, 7, 24.99),
					new ExpectedCellValue(sheetName, 6, 8, 1985.99),

					new ExpectedCellValue(sheetName, 7, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 3, 5),
					new ExpectedCellValue(sheetName, 7, 4, 1),
					new ExpectedCellValue(sheetName, 7, 5, 6),
					new ExpectedCellValue(sheetName, 7, 6, 2),
					new ExpectedCellValue(sheetName, 7, 7, 1),
					new ExpectedCellValue(sheetName, 7, 8, 15)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBlankValues.xlsx")]
		public void PivotTableRefreshWithBlankValueInRowAndColumnHeaders()
		{
			var file = new FileInfo("PivotTableWithBlankValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet1";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A11:F17"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 11, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 13, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 14, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 15, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 17, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 11, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 12, 2, "January"),
					new ExpectedCellValue(sheetName, 13, 2, 831.5),
					new ExpectedCellValue(sheetName, 14, 2, 831.5),
					new ExpectedCellValue(sheetName, 15, 2, 415.75),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, 2078.75),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, "February"),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, 1194d),
					new ExpectedCellValue(sheetName, 15, 3, 99d),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, 1293d),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, "March"),
					new ExpectedCellValue(sheetName, 13, 4, 24.99),
					new ExpectedCellValue(sheetName, 14, 4, 831.5),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, 856.49),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, "(blank)"),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 6, 856.49),
					new ExpectedCellValue(sheetName, 14, 6, 2857d),
					new ExpectedCellValue(sheetName, 15, 6, 514.75),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBlankValues.xlsx")]
		public void PivotTableRefreshWithBlankValueInRowAndColumnHeaderTwoRowFieldsAndOneColumnField()
		{
			var file = new FileInfo("PivotTableWithBlankValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet1";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A21:F34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 21, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 23, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 24, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 26, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 27, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 1, "Tent"),
					new ExpectedCellValue(sheetName, 29, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 30, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 32, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 33, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 34, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 21, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 22, 2, "January"),
					new ExpectedCellValue(sheetName, 23, 2, 831.5),
					new ExpectedCellValue(sheetName, 24, 2, 831.5),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, 831.5),
					new ExpectedCellValue(sheetName, 27, 2, 831.5),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, 415.75),
					new ExpectedCellValue(sheetName, 30, 2, 415.75),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, 2078.75),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, "February"),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, 1194d),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, 1194d),
					new ExpectedCellValue(sheetName, 29, 3, 99d),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, 99d),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, 1293d),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, "March"),
					new ExpectedCellValue(sheetName, 23, 4, 24.99),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, 24.99),
					new ExpectedCellValue(sheetName, 26, 4, 831.5),
					new ExpectedCellValue(sheetName, 27, 4, 831.5),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, 856.49),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, "(blank)"),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 23, 6, 856.49),
					new ExpectedCellValue(sheetName, 24, 6, 831.5),
					new ExpectedCellValue(sheetName, 25, 6, 24.99),
					new ExpectedCellValue(sheetName, 26, 6, 2857d),
					new ExpectedCellValue(sheetName, 27, 6, 1663d),
					new ExpectedCellValue(sheetName, 28, 6, 1194d),
					new ExpectedCellValue(sheetName, 29, 6, 514.75),
					new ExpectedCellValue(sheetName, 30, 6, 415.75),
					new ExpectedCellValue(sheetName, 31, 6, 99d),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBlankValues.xlsx")]
		public void PivotTableRefreshWithBlankValueInRowAndColumnHeadersWithMissingValuesInDataTable()
		{
			var file = new FileInfo("PivotTableWithBlankValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A11:F19"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 11, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 13, 1, 456d),
					new ExpectedCellValue(sheetName, 14, 1, 4568d),
					new ExpectedCellValue(sheetName, 15, 1, 13215d),
					new ExpectedCellValue(sheetName, 16, 1, 45345d),
					new ExpectedCellValue(sheetName, 17, 1, 387654),
					new ExpectedCellValue(sheetName, 18, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 19, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 11, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 12, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, 831.5),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, 831.5),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, 831.5),
					new ExpectedCellValue(sheetName, 19, 3, 831.5),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 4, 415.75),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, 99d),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, 514.75),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, "(blank)"),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, 1194d),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, 1194d),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 6, 415.75),
					new ExpectedCellValue(sheetName, 14, 6, 1194d),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, 831.5),
					new ExpectedCellValue(sheetName, 17, 6, 99d),
					new ExpectedCellValue(sheetName, 18, 6, 831.5),
					new ExpectedCellValue(sheetName, 19, 6, 3371.75)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBlankValues.xlsx")]
		public void PivotTableRefreshWithBlankValueInRowAndColumnHeadersWithMissingValuesInDataTable2()
		{
			var file = new FileInfo("PivotTableWithBlankValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A24:K47"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 24, 1, null),
					new ExpectedCellValue(sheetName, 25, 1, null),
					new ExpectedCellValue(sheetName, 26, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 27, 1, 456d),
					new ExpectedCellValue(sheetName, 28, 1, "January"),
					new ExpectedCellValue(sheetName, 29, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 30, 1, 4568d),
					new ExpectedCellValue(sheetName, 31, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 32, 1, "Tent"),
					new ExpectedCellValue(sheetName, 33, 1, 13215d),
					new ExpectedCellValue(sheetName, 34, 1, "January"),
					new ExpectedCellValue(sheetName, 35, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 36, 1, 45345d),
					new ExpectedCellValue(sheetName, 37, 1, "January"),
					new ExpectedCellValue(sheetName, 38, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 1, 387654),
					new ExpectedCellValue(sheetName, 40, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 41, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 43, 1, "March"),
					new ExpectedCellValue(sheetName, 44, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 45, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 46, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 47, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 24, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 25, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 26, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, 831.5),
					new ExpectedCellValue(sheetName, 37, 2, 831.5),
					new ExpectedCellValue(sheetName, 38, 2, 831.5),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, null),
					new ExpectedCellValue(sheetName, 47, 2, 831.5),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, 415.75),
					new ExpectedCellValue(sheetName, 37, 3, 415.75),
					new ExpectedCellValue(sheetName, 38, 3, 415.75),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, 415.75),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 4, null),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, 831.5),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, 831.5),
					new ExpectedCellValue(sheetName, 46, 4, 831.5),
					new ExpectedCellValue(sheetName, 47, 4, 831.5),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, 415.75),
					new ExpectedCellValue(sheetName, 34, 5, 415.75),
					new ExpectedCellValue(sheetName, 35, 5, 415.75),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, null),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, 415.75),
					new ExpectedCellValue(sheetName, 24, 6, null),
					new ExpectedCellValue(sheetName, 25, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 6, 415.75),
					new ExpectedCellValue(sheetName, 28, 6, 415.75),
					new ExpectedCellValue(sheetName, 29, 6, 415.75),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, null),
					new ExpectedCellValue(sheetName, 35, 6, null),
					new ExpectedCellValue(sheetName, 36, 6, null),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, 99d),
					new ExpectedCellValue(sheetName, 40, 6, 99d),
					new ExpectedCellValue(sheetName, 41, 6, 99d),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, null),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, null),
					new ExpectedCellValue(sheetName, 47, 6, 514.75),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 7, 415.75),
					new ExpectedCellValue(sheetName, 28, 7, 415.75),
					new ExpectedCellValue(sheetName, 29, 7, 415.75),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, null),
					new ExpectedCellValue(sheetName, 38, 7, null),
					new ExpectedCellValue(sheetName, 39, 7, 99d),
					new ExpectedCellValue(sheetName, 40, 7, 99d),
					new ExpectedCellValue(sheetName, 41, 7, 99d),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, null),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, null),
					new ExpectedCellValue(sheetName, 47, 7, 514.75),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, "(blank)"),
					new ExpectedCellValue(sheetName, 26, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, 1194d),
					new ExpectedCellValue(sheetName, 31, 8, 1194d),
					new ExpectedCellValue(sheetName, 32, 8, 1194d),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, null),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, null),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, 1194d),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, 199d),
					new ExpectedCellValue(sheetName, 31, 9, 199d),
					new ExpectedCellValue(sheetName, 32, 9, 199d),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, 199d),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, 415.75),
					new ExpectedCellValue(sheetName, 28, 10, 415.75),
					new ExpectedCellValue(sheetName, 29, 10, 415.75),
					new ExpectedCellValue(sheetName, 30, 10, 1194d),
					new ExpectedCellValue(sheetName, 31, 10, 1194d),
					new ExpectedCellValue(sheetName, 32, 10, 1194d),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, 831.5),
					new ExpectedCellValue(sheetName, 37, 10, 831.5),
					new ExpectedCellValue(sheetName, 38, 10, 831.5),
					new ExpectedCellValue(sheetName, 39, 10, 99d),
					new ExpectedCellValue(sheetName, 40, 10, 99d),
					new ExpectedCellValue(sheetName, 41, 10, 99d),
					new ExpectedCellValue(sheetName, 42, 10, 831.5),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, 831.5),
					new ExpectedCellValue(sheetName, 46, 10, 831.5),
					new ExpectedCellValue(sheetName, 47, 10, 3371.75),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, 415.75),
					new ExpectedCellValue(sheetName, 28, 11, 415.75),
					new ExpectedCellValue(sheetName, 29, 11, 415.75),
					new ExpectedCellValue(sheetName, 30, 11, 199d),
					new ExpectedCellValue(sheetName, 31, 11, 199d),
					new ExpectedCellValue(sheetName, 32, 11, 199d),
					new ExpectedCellValue(sheetName, 33, 11, 415.75),
					new ExpectedCellValue(sheetName, 34, 11, 415.75),
					new ExpectedCellValue(sheetName, 35, 11, 415.75),
					new ExpectedCellValue(sheetName, 36, 11, 415.75),
					new ExpectedCellValue(sheetName, 37, 11, 415.75),
					new ExpectedCellValue(sheetName, 38, 11, 415.75),
					new ExpectedCellValue(sheetName, 39, 11, 99d),
					new ExpectedCellValue(sheetName, 40, 11, 99d),
					new ExpectedCellValue(sheetName, 41, 11, 99d),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, 1545.25)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBlankValues.xlsx")]
		public void PivotTableRefreshWithBlankValueInRowAndColumnHeadersWithMissingValuesInDataTableTabularAndNonCompactForm()
		{
			var file = new FileInfo("PivotTableWithBlankValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A53:G77"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 53, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 54, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 55, 1, 456d),
					new ExpectedCellValue(sheetName, 56, 1, null),
					new ExpectedCellValue(sheetName, 57, 1, "456 Total"),
					new ExpectedCellValue(sheetName, 58, 1, 4568d),
					new ExpectedCellValue(sheetName, 59, 1, null),
					new ExpectedCellValue(sheetName, 60, 1, "4568 Total"),
					new ExpectedCellValue(sheetName, 61, 1, 13215d),
					new ExpectedCellValue(sheetName, 62, 1, null),
					new ExpectedCellValue(sheetName, 63, 1, "13215 Total"),
					new ExpectedCellValue(sheetName, 64, 1, 45345d),
					new ExpectedCellValue(sheetName, 65, 1, null),
					new ExpectedCellValue(sheetName, 66, 1, "45345 Total"),
					new ExpectedCellValue(sheetName, 67, 1, 387654),
					new ExpectedCellValue(sheetName, 68, 1, null),
					new ExpectedCellValue(sheetName, 69, 1, "387654 Total"),
					new ExpectedCellValue(sheetName, 70, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 71, 1, null),
					new ExpectedCellValue(sheetName, 72, 1, null),
					new ExpectedCellValue(sheetName, 73, 1, null),
					new ExpectedCellValue(sheetName, 74, 1, null),
					new ExpectedCellValue(sheetName, 75, 1, null),
					new ExpectedCellValue(sheetName, 76, 1, "(blank) Total"),
					new ExpectedCellValue(sheetName, 77, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, "Location"),
					new ExpectedCellValue(sheetName, 55, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, "(blank)"),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, "(blank)"),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, null),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, "Item"),
					new ExpectedCellValue(sheetName, 55, 3, null),
					new ExpectedCellValue(sheetName, 56, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, "Tent"),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, "(blank)"),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, "(blank)"),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, "(blank)"),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 53, 4, "Column Labels"),
					new ExpectedCellValue(sheetName, 54, 4, "January"),
					new ExpectedCellValue(sheetName, 55, 4, 415.75),
					new ExpectedCellValue(sheetName, 56, 4, 415.75),
					new ExpectedCellValue(sheetName, 57, 4, 415.75),
					new ExpectedCellValue(sheetName, 58, 4, null),
					new ExpectedCellValue(sheetName, 59, 4, null),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, 831.5),
					new ExpectedCellValue(sheetName, 65, 4, 831.5),
					new ExpectedCellValue(sheetName, 66, 4, 831.5),
					new ExpectedCellValue(sheetName, 67, 4, null),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, null),
					new ExpectedCellValue(sheetName, 70, 4, null),
					new ExpectedCellValue(sheetName, 71, 4, null),
					new ExpectedCellValue(sheetName, 72, 4, null),
					new ExpectedCellValue(sheetName, 73, 4, null),
					new ExpectedCellValue(sheetName, 74, 4, null),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, null),
					new ExpectedCellValue(sheetName, 77, 4, 1247.25),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, "March"),
					new ExpectedCellValue(sheetName, 55, 5, null),
					new ExpectedCellValue(sheetName, 56, 5, null),
					new ExpectedCellValue(sheetName, 57, 5, null),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, null),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, null),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, null),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, null),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, null),
					new ExpectedCellValue(sheetName, 68, 5, null),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 70, 5, null),
					new ExpectedCellValue(sheetName, 71, 5, null),
					new ExpectedCellValue(sheetName, 72, 5, null),
					new ExpectedCellValue(sheetName, 73, 5, null),
					new ExpectedCellValue(sheetName, 74, 5, null),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, null),
					new ExpectedCellValue(sheetName, 77, 5, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, "(blank)"),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, null),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, 1194d),
					new ExpectedCellValue(sheetName, 59, 6, 1194d),
					new ExpectedCellValue(sheetName, 60, 6, 1194d),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, 99d),
					new ExpectedCellValue(sheetName, 68, 6, 99d),
					new ExpectedCellValue(sheetName, 69, 6, 99d),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, 831.5),
					new ExpectedCellValue(sheetName, 73, 6, 831.5),
					new ExpectedCellValue(sheetName, 74, 6, null),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, 831.5),
					new ExpectedCellValue(sheetName, 77, 6, 2124.5),
					new ExpectedCellValue(sheetName, 53, 7, null),
					new ExpectedCellValue(sheetName, 54, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 55, 7, 415.75),
					new ExpectedCellValue(sheetName, 56, 7, 415.75),
					new ExpectedCellValue(sheetName, 57, 7, 415.75),
					new ExpectedCellValue(sheetName, 58, 7, 1194d),
					new ExpectedCellValue(sheetName, 59, 7, 1194d),
					new ExpectedCellValue(sheetName, 60, 7, 1194d),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, null),
					new ExpectedCellValue(sheetName, 64, 7, 831.5),
					new ExpectedCellValue(sheetName, 65, 7, 831.5),
					new ExpectedCellValue(sheetName, 66, 7, 831.5),
					new ExpectedCellValue(sheetName, 67, 7, 99d),
					new ExpectedCellValue(sheetName, 68, 7, 99d),
					new ExpectedCellValue(sheetName, 69, 7, 99d),
					new ExpectedCellValue(sheetName, 70, 7, null),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, 831.5),
					new ExpectedCellValue(sheetName, 73, 7, 831.5),
					new ExpectedCellValue(sheetName, 74, 7, null),
					new ExpectedCellValue(sheetName, 75, 7, null),
					new ExpectedCellValue(sheetName, 76, 7, 831.5),
					new ExpectedCellValue(sheetName, 77, 7, 3371.75)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBlankValues.xlsx")]
		public void PivotTableRefreshWithBlankValueInRowAndColumnHeadersWithMissingValuesInDataTableTabularAndNonCompactForm2()
		{
			var file = new FileInfo("PivotTableWithBlankValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet3";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A6:B9"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 8, 1, "(blank) Total"),
					new ExpectedCellValue(sheetName, 9, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 2, "Month"),
					new ExpectedCellValue(sheetName, 7, 2, "(blank)"),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, null),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableShowEmptyCellAs.xlsx")]
		public void PivotTableRefreshShowEmptyCellAsTwoRowFieldsOneColumnField()
		{
			var file = new FileInfo("PivotTableShowEmptyCellAs.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:H11"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 1, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, "January"),
					new ExpectedCellValue(sheetName, 5, 1, "March"),
					new ExpectedCellValue(sheetName, 6, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 1, "January"),
					new ExpectedCellValue(sheetName, 8, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 9, 1, "March"),
					new ExpectedCellValue(sheetName, 10, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 11, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 2, 2, 20100007),
					new ExpectedCellValue(sheetName, 3, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 4, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 6, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 7, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 8, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 9, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 10, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 11, 2, "zzzzz"),
					new ExpectedCellValue(sheetName, 1, 3, null),
					new ExpectedCellValue(sheetName, 2, 3, 20100017),
					new ExpectedCellValue(sheetName, 3, 3, "zzzzz"),
					new ExpectedCellValue(sheetName, 4, 3, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 3, "zzzzz"),
					new ExpectedCellValue(sheetName, 6, 3, "zzzzz"),
					new ExpectedCellValue(sheetName, 7, 3, "zzzzz"),
					new ExpectedCellValue(sheetName, 8, 3, 831.5),
					new ExpectedCellValue(sheetName, 9, 3, 831.5),
					new ExpectedCellValue(sheetName, 10, 3, "zzzzz"),
					new ExpectedCellValue(sheetName, 11, 3, 831.5),
					new ExpectedCellValue(sheetName, 1, 4, null),
					new ExpectedCellValue(sheetName, 2, 4, 20100076),
					new ExpectedCellValue(sheetName, 3, 4, "zzzzz"),
					new ExpectedCellValue(sheetName, 4, 4, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 4, "zzzzz"),
					new ExpectedCellValue(sheetName, 6, 4, "zzzzz"),
					new ExpectedCellValue(sheetName, 7, 4, "zzzzz"),
					new ExpectedCellValue(sheetName, 8, 4, 415.75),
					new ExpectedCellValue(sheetName, 9, 4, "zzzzz"),
					new ExpectedCellValue(sheetName, 10, 4, 415.75),
					new ExpectedCellValue(sheetName, 11, 4, 415.75),
					new ExpectedCellValue(sheetName, 1, 5, null),
					new ExpectedCellValue(sheetName, 2, 5, 20100085),
					new ExpectedCellValue(sheetName, 3, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 4, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 6, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 7, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 8, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 9, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 10, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 11, 5, "zzzzz"),
					new ExpectedCellValue(sheetName, 1, 6, null),
					new ExpectedCellValue(sheetName, 2, 6, 20100090),
					new ExpectedCellValue(sheetName, 3, 6, "zzzzz"),
					new ExpectedCellValue(sheetName, 4, 6, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 6, "zzzzz"),
					new ExpectedCellValue(sheetName, 6, 6, 831.5),
					new ExpectedCellValue(sheetName, 7, 6, 831.5),
					new ExpectedCellValue(sheetName, 8, 6, "zzzzz"),
					new ExpectedCellValue(sheetName, 9, 6, "zzzzz"),
					new ExpectedCellValue(sheetName, 10, 6, "zzzzz"),
					new ExpectedCellValue(sheetName, 11, 6, 831.5),
					new ExpectedCellValue(sheetName, 1, 7, null),
					new ExpectedCellValue(sheetName, 2, 7, "(blank)"),
					new ExpectedCellValue(sheetName, 3, 7, 24.99),
					new ExpectedCellValue(sheetName, 4, 7, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 7, 24.99),
					new ExpectedCellValue(sheetName, 6, 7, "zzzzz"),
					new ExpectedCellValue(sheetName, 7, 7, "zzzzz"),
					new ExpectedCellValue(sheetName, 8, 7, 1194d),
					new ExpectedCellValue(sheetName, 9, 7, "zzzzz"),
					new ExpectedCellValue(sheetName, 10, 7, 1194d),
					new ExpectedCellValue(sheetName, 11, 7, 1218.99),
					new ExpectedCellValue(sheetName, 1, 8, null),
					new ExpectedCellValue(sheetName, 2, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 8, 24.99),
					new ExpectedCellValue(sheetName, 4, 8, "zzzzz"),
					new ExpectedCellValue(sheetName, 5, 8, 24.99),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 7, 8, 831.5),
					new ExpectedCellValue(sheetName, 8, 8, 2441.25),
					new ExpectedCellValue(sheetName, 9, 8, 831.5),
					new ExpectedCellValue(sheetName, 10, 8, 1609.75),
					new ExpectedCellValue(sheetName, 11, 8, 3297.74)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableShowEmptyCellAs.xlsx")]
		public void PivotTableRefreshShowEmptyCellAsThreeRowFieldsOneColumnFieldTabularAndNonCompactForm()
		{
			var file = new FileInfo("PivotTableShowEmptyCellAs.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A15:H34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 15, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 17, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, null),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, null),
					new ExpectedCellValue(sheetName, 22, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 23, 1, null),
					new ExpectedCellValue(sheetName, 24, 1, null),
					new ExpectedCellValue(sheetName, 25, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, null),
					new ExpectedCellValue(sheetName, 28, 1, null),
					new ExpectedCellValue(sheetName, 29, 1, null),
					new ExpectedCellValue(sheetName, 30, 1, null),
					new ExpectedCellValue(sheetName, 31, 1, null),
					new ExpectedCellValue(sheetName, 32, 1, null),
					new ExpectedCellValue(sheetName, 33, 1, null),
					new ExpectedCellValue(sheetName, 34, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, "Transaction"),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, 20100007),
					new ExpectedCellValue(sheetName, 19, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 20, 2, "(blank)"),
					new ExpectedCellValue(sheetName, 21, 2, "(blank) Total"),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, 20100090),
					new ExpectedCellValue(sheetName, 24, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, 20100017),
					new ExpectedCellValue(sheetName, 27, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 28, 2, 20100076),
					new ExpectedCellValue(sheetName, 29, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 30, 2, 20100085),
					new ExpectedCellValue(sheetName, 31, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 32, 2, "(blank)"),
					new ExpectedCellValue(sheetName, 33, 2, "(blank) Total"),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, "Month"),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, "January"),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, "March"),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, "January"),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "March"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, "(blank)"),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, "(blank)"),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, "(blank)"),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 15, 4, "Column Labels"),
					new ExpectedCellValue(sheetName, 16, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 4, ":)"),
					new ExpectedCellValue(sheetName, 18, 4, ":)"),
					new ExpectedCellValue(sheetName, 19, 4, ":)"),
					new ExpectedCellValue(sheetName, 20, 4, ":)"),
					new ExpectedCellValue(sheetName, 21, 4, ":)"),
					new ExpectedCellValue(sheetName, 22, 4, ":)"),
					new ExpectedCellValue(sheetName, 23, 4, ":)"),
					new ExpectedCellValue(sheetName, 24, 4, ":)"),
					new ExpectedCellValue(sheetName, 25, 4, 1247.25),
					new ExpectedCellValue(sheetName, 26, 4, 831.5),
					new ExpectedCellValue(sheetName, 27, 4, 831.5),
					new ExpectedCellValue(sheetName, 28, 4, 415.75),
					new ExpectedCellValue(sheetName, 29, 4, 415.75),
					new ExpectedCellValue(sheetName, 30, 4, ":)"),
					new ExpectedCellValue(sheetName, 31, 4, ":)"),
					new ExpectedCellValue(sheetName, 32, 4, ":)"),
					new ExpectedCellValue(sheetName, 33, 4, ":)"),
					new ExpectedCellValue(sheetName, 34, 4, 1247.25),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 17, 5, 24.99),
					new ExpectedCellValue(sheetName, 18, 5, ":)"),
					new ExpectedCellValue(sheetName, 19, 5, ":)"),
					new ExpectedCellValue(sheetName, 20, 5, 24.99),
					new ExpectedCellValue(sheetName, 21, 5, 24.99),
					new ExpectedCellValue(sheetName, 22, 5, ":)"),
					new ExpectedCellValue(sheetName, 23, 5, ":)"),
					new ExpectedCellValue(sheetName, 24, 5, ":)"),
					new ExpectedCellValue(sheetName, 25, 5, ":)"),
					new ExpectedCellValue(sheetName, 26, 5, ":)"),
					new ExpectedCellValue(sheetName, 27, 5, ":)"),
					new ExpectedCellValue(sheetName, 28, 5, ":)"),
					new ExpectedCellValue(sheetName, 29, 5, ":)"),
					new ExpectedCellValue(sheetName, 30, 5, ":)"),
					new ExpectedCellValue(sheetName, 31, 5, ":)"),
					new ExpectedCellValue(sheetName, 32, 5, ":)"),
					new ExpectedCellValue(sheetName, 33, 5, ":)"),
					new ExpectedCellValue(sheetName, 34, 5, 24.99),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 17, 6, ":)"),
					new ExpectedCellValue(sheetName, 18, 6, ":)"),
					new ExpectedCellValue(sheetName, 19, 6, ":)"),
					new ExpectedCellValue(sheetName, 21, 6, ":)"),
					new ExpectedCellValue(sheetName, 20, 6, ":)"),
					new ExpectedCellValue(sheetName, 22, 6, ":)"),
					new ExpectedCellValue(sheetName, 23, 6, ":)"),
					new ExpectedCellValue(sheetName, 24, 6, ":)"),
					new ExpectedCellValue(sheetName, 25, 6, ":)"),
					new ExpectedCellValue(sheetName, 26, 6, ":)"),
					new ExpectedCellValue(sheetName, 27, 6, ":)"),
					new ExpectedCellValue(sheetName, 28, 6, ":)"),
					new ExpectedCellValue(sheetName, 29, 6, ":)"),
					new ExpectedCellValue(sheetName, 30, 6, ":)"),
					new ExpectedCellValue(sheetName, 31, 6, ":)"),
					new ExpectedCellValue(sheetName, 32, 6, ":)"),
					new ExpectedCellValue(sheetName, 33, 6, ":)"),
					new ExpectedCellValue(sheetName, 34, 6, ":)"),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, "(blank)"),
					new ExpectedCellValue(sheetName, 17, 7, ":)"),
					new ExpectedCellValue(sheetName, 18, 7, ":)"),
					new ExpectedCellValue(sheetName, 19, 7, ":)"),
					new ExpectedCellValue(sheetName, 21, 7, ":)"),
					new ExpectedCellValue(sheetName, 20, 7, ":)"),
					new ExpectedCellValue(sheetName, 22, 7, 831.5),
					new ExpectedCellValue(sheetName, 23, 7, 831.5),
					new ExpectedCellValue(sheetName, 24, 7, 831.5),
					new ExpectedCellValue(sheetName, 25, 7, 1194d),
					new ExpectedCellValue(sheetName, 26, 7, ":)"),
					new ExpectedCellValue(sheetName, 27, 7, ":)"),
					new ExpectedCellValue(sheetName, 28, 7, ":)"),
					new ExpectedCellValue(sheetName, 29, 7, ":)"),
					new ExpectedCellValue(sheetName, 30, 7, ":)"),
					new ExpectedCellValue(sheetName, 31, 7, ":)"),
					new ExpectedCellValue(sheetName, 32, 7, 1194d),
					new ExpectedCellValue(sheetName, 33, 7, 1194d),
					new ExpectedCellValue(sheetName, 34, 7, 2025.5),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 17, 8,24.99),
					new ExpectedCellValue(sheetName, 18, 8, ":)"),
					new ExpectedCellValue(sheetName, 19, 8, ":)"),
					new ExpectedCellValue(sheetName, 21, 8, 24.99),
					new ExpectedCellValue(sheetName, 20, 8, 24.99),
					new ExpectedCellValue(sheetName, 22, 8, 831.5),
					new ExpectedCellValue(sheetName, 23, 8, 831.5),
					new ExpectedCellValue(sheetName, 24, 8, 831.5),
					new ExpectedCellValue(sheetName, 25, 8, 2441.25),
					new ExpectedCellValue(sheetName, 26, 8, 831.5),
					new ExpectedCellValue(sheetName, 27, 8, 831.5),
					new ExpectedCellValue(sheetName, 28, 8, 415.75),
					new ExpectedCellValue(sheetName, 29, 8, 415.75),
					new ExpectedCellValue(sheetName, 30, 8, ":)"),
					new ExpectedCellValue(sheetName, 31, 8, ":)"),
					new ExpectedCellValue(sheetName, 32, 8, 1194d),
					new ExpectedCellValue(sheetName, 33, 8, 1194d),
					new ExpectedCellValue(sheetName, 34, 8, 3297.74)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableShowEmptyCellAs.xlsx")]
		public void PivotTableRefreshShowEmptyCellAsOneRowFieldTwoColumnFields()
		{
			var file = new FileInfo("PivotTableShowEmptyCellAs.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A39:J55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 39, 1, null),
					new ExpectedCellValue(sheetName, 40, 1, null),
					new ExpectedCellValue(sheetName, 41, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 46, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 48, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 49, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 1, "(blank)"),
					new ExpectedCellValue(sheetName, 52, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 54, 1, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 55, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 40, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 41, 2, "January"),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 44, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 47, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, 415.75),
					new ExpectedCellValue(sheetName, 53, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 54, 2, 415.75),
					new ExpectedCellValue(sheetName, 55, 2, "ahhhhh"),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, "March"),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, "ahhhhh"),
					new ExpectedCellValue(sheetName, 44, 3, "ahhhhh"),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, 24.99),
					new ExpectedCellValue(sheetName, 47, 3, 24.99),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 3, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, "ahhhhh"),
					new ExpectedCellValue(sheetName, 53, 3, "ahhhhh"),
					new ExpectedCellValue(sheetName, 54, 3, 24.99),
					new ExpectedCellValue(sheetName, 55, 3, 24.99),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, "Chicago Total"),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, "ahhhhh"),
					new ExpectedCellValue(sheetName, 44, 4, "ahhhhh"),
					new ExpectedCellValue(sheetName, 45, 4, null),
					new ExpectedCellValue(sheetName, 46, 4, 24.99),
					new ExpectedCellValue(sheetName, 47, 4, 24.99),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 4, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, 415.75),
					new ExpectedCellValue(sheetName, 53, 4, "ahhhhh"),
					new ExpectedCellValue(sheetName, 54, 4, 440.74),
					new ExpectedCellValue(sheetName, 55, 4, 24.99),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 41, 5, "January"),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 44, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 47, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 53, 5, 831.5),
					new ExpectedCellValue(sheetName, 54, 5, "ahhhhh"),
					new ExpectedCellValue(sheetName, 55, 5, 831.5),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 41, 6, null),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 44, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 47, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 53, 6, 831.5),
					new ExpectedCellValue(sheetName, 54, 6, "ahhhhh"),
					new ExpectedCellValue(sheetName, 55, 6, 831.5),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, "(blank)"),
					new ExpectedCellValue(sheetName, 41, 7, "March"),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, 415.75),
					new ExpectedCellValue(sheetName, 44, 7, 831.5),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, "ahhhhh"),
					new ExpectedCellValue(sheetName, 47, 7, "ahhhhh"),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 7, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 7, null),
					new ExpectedCellValue(sheetName, 52, 7, "ahhhhh"),
					new ExpectedCellValue(sheetName, 53, 7, "ahhhhh"),
					new ExpectedCellValue(sheetName, 54, 7, 415.75),
					new ExpectedCellValue(sheetName, 55, 7, 831.5),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, "(blank)"),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, 415.75),
					new ExpectedCellValue(sheetName, 44, 8, 415.75),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, "ahhhhh"),
					new ExpectedCellValue(sheetName, 47, 8, "ahhhhh"),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 8, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, "ahhhhh"),
					new ExpectedCellValue(sheetName, 53, 8, 1194d),
					new ExpectedCellValue(sheetName, 54, 8, 415.75),
					new ExpectedCellValue(sheetName, 55, 8, 1609.75),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, "(blank) Total"),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, 831.5),
					new ExpectedCellValue(sheetName, 44, 9, 1247.25),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, "ahhhhh"),
					new ExpectedCellValue(sheetName, 47, 9, "ahhhhh"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 9, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, "ahhhhh"),
					new ExpectedCellValue(sheetName, 53, 9, 1194d),
					new ExpectedCellValue(sheetName, 54, 9, 831.5),
					new ExpectedCellValue(sheetName, 55, 9, 2441.25),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, "Grand Total"),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, 831.5),
					new ExpectedCellValue(sheetName, 44, 10, 1247.25),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, 24.99),
					new ExpectedCellValue(sheetName, 47, 10, 24.99),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, "ahhhhh"),
					new ExpectedCellValue(sheetName, 50, 10, "ahhhhh"),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, 415.75),
					new ExpectedCellValue(sheetName, 53, 10, 2025.5),
					new ExpectedCellValue(sheetName, 54, 10, 1272.24),
					new ExpectedCellValue(sheetName, 55, 10, 3297.74)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBooleanValues.xlsx")]
		public void PivotTableRefreshContainingBooleanValuesInRows()
		{
			var file = new FileInfo("PivotTableWithBooleanValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B3:C20"), pivotTable.Address);
					Assert.AreEqual(11, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 2, "FALSE"),
					new ExpectedCellValue(sheetName, 5, 2, "Amsterdam"),
					new ExpectedCellValue(sheetName, 6, 2, "Hamburg"),
					new ExpectedCellValue(sheetName, 7, 2, "Hamburg 36"),
					new ExpectedCellValue(sheetName, 8, 2, "London"),
					new ExpectedCellValue(sheetName, 9, 2, "Thunder Bay"),
					new ExpectedCellValue(sheetName, 10, 2, "TRUE"),
					new ExpectedCellValue(sheetName, 11, 2, "AArhus C"),
					new ExpectedCellValue(sheetName, 12, 2, "Antwerpen"),
					new ExpectedCellValue(sheetName, 13, 2, "Bojkovice"),
					new ExpectedCellValue(sheetName, 14, 2, "Düsseldorf"),
					new ExpectedCellValue(sheetName, 15, 2, "K¢benhavn ¥"),
					new ExpectedCellValue(sheetName, 16, 2, "Kopavogur"),
					new ExpectedCellValue(sheetName, 17, 2, "Maidstone"),
					new ExpectedCellValue(sheetName, 18, 2, "Maribor"),
					new ExpectedCellValue(sheetName, 19, 2, "Valencia"),
					new ExpectedCellValue(sheetName, 20, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 3, "Sum of Profit (LCY)"),
					new ExpectedCellValue(sheetName, 4, 3, 95.41),
					new ExpectedCellValue(sheetName, 5, 3, 0),
					new ExpectedCellValue(sheetName, 6, 3, 0),
					new ExpectedCellValue(sheetName, 7, 3, 95.41),
					new ExpectedCellValue(sheetName, 8, 3, 0),
					new ExpectedCellValue(sheetName, 9, 3, 0),
					new ExpectedCellValue(sheetName, 10, 3, 1665.44),
					new ExpectedCellValue(sheetName, 11, 3, 0),
					new ExpectedCellValue(sheetName, 12, 3, 1119.44),
					new ExpectedCellValue(sheetName, 13, 3, 546d),
					new ExpectedCellValue(sheetName, 14, 3, 0),
					new ExpectedCellValue(sheetName, 15, 3, 0),
					new ExpectedCellValue(sheetName, 16, 3, 0),
					new ExpectedCellValue(sheetName, 17, 3, 0),
					new ExpectedCellValue(sheetName, 18, 3, 0),
					new ExpectedCellValue(sheetName, 19, 3, 0),
					new ExpectedCellValue(sheetName, 20, 3, 1760.85)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBooleanValues.xlsx")]
		public void PivotTableRefreshContainingBooleanValuesInColumns()
		{
			var file = new FileInfo("PivotTableWithBooleanValues.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B25:E42"), pivotTable.Address);
					Assert.AreEqual(11, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 25, 2, "Sum of Net Change"),
					new ExpectedCellValue(sheetName, 26, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 27, 2, "Afrifield Corporation"),
					new ExpectedCellValue(sheetName, 28, 2, "Antarcticopy"),
					new ExpectedCellValue(sheetName, 29, 2, "Autohaus Mielberg KG"),
					new ExpectedCellValue(sheetName, 30, 2, "Beef House"),
					new ExpectedCellValue(sheetName, 31, 2, "Bilabankinn"),
					new ExpectedCellValue(sheetName, 32, 2, "Blanemark Hifi Shop"),
					new ExpectedCellValue(sheetName, 33, 2, "BYT-KOMPLET s.r.o."),
					new ExpectedCellValue(sheetName, 34, 2, "Candoxy Canada Inc."),
					new ExpectedCellValue(sheetName, 35, 2, "Candoxy Kontor A/S"),
					new ExpectedCellValue(sheetName, 36, 2, "Candoxy Nederland BV"),
					new ExpectedCellValue(sheetName, 37, 2, "Carl Anthony"),
					new ExpectedCellValue(sheetName, 38, 2, "Centromerkur d.o.o."),
					new ExpectedCellValue(sheetName, 39, 2, "Corporación Beta"),
					new ExpectedCellValue(sheetName, 40, 2, "Cronus Cardoxy Procurement"),
					new ExpectedCellValue(sheetName, 41, 2, "Cronus Cardoxy Sales"),
					new ExpectedCellValue(sheetName, 42, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 25, 3, "Column Labels"),
					new ExpectedCellValue(sheetName, 26, 3, "FALSE"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, 8794.86),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, 0),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, 0),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, 0),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, 0),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, 8794.86),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, "TRUE"),
					new ExpectedCellValue(sheetName, 27, 4, 0),
					new ExpectedCellValue(sheetName, 28, 4, 3218.14),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, 14178.1),
					new ExpectedCellValue(sheetName, 31, 4, 0),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, 58518.63),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, 0),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, 0),
					new ExpectedCellValue(sheetName, 38, 4, 0),
					new ExpectedCellValue(sheetName, 39, 4, 0),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, 0),
					new ExpectedCellValue(sheetName, 42, 4, 75914.87),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 27, 5, 0),
					new ExpectedCellValue(sheetName, 28, 5, 3218.14),
					new ExpectedCellValue(sheetName, 29, 5, 8794.86),
					new ExpectedCellValue(sheetName, 30, 5, 14178.1),
					new ExpectedCellValue(sheetName, 31, 5, 0),
					new ExpectedCellValue(sheetName, 32, 5, 0),
					new ExpectedCellValue(sheetName, 33, 5, 58518.63),
					new ExpectedCellValue(sheetName, 34, 5, 0),
					new ExpectedCellValue(sheetName, 35, 5, 0),
					new ExpectedCellValue(sheetName, 36, 5, 0),
					new ExpectedCellValue(sheetName, 37, 5, 0),
					new ExpectedCellValue(sheetName, 38, 5, 0),
					new ExpectedCellValue(sheetName, 39, 5, 0),
					new ExpectedCellValue(sheetName, 40, 5, 0),
					new ExpectedCellValue(sheetName, 41, 5, 0),
					new ExpectedCellValue(sheetName, 42, 5, 84709.73)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithBooleanValuesWithGrouping.xlsx")]
		public void PivotTableRefreshContainingBooleanValuesWithGroupings()
		{
			var file = new FileInfo("PivotTableWithBooleanValuesWithGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet1";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B25:C44"), pivotTable.Address);
					Assert.AreEqual(12, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 25, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 26, 2, "Group1"),
					new ExpectedCellValue(sheetName, 27, 2, "FALSE"),
					new ExpectedCellValue(sheetName, 28, 2, "Autohaus Mielberg KG"),
					new ExpectedCellValue(sheetName, 29, 2, "Blanemark Hifi Shop"),
					new ExpectedCellValue(sheetName, 30, 2, "Candoxy Canada Inc."),
					new ExpectedCellValue(sheetName, 31, 2, "Candoxy Nederland BV"),
					new ExpectedCellValue(sheetName, 32, 2, "Cronus Cardoxy Procurement"),
					new ExpectedCellValue(sheetName, 33, 2, "TRUE"),
					new ExpectedCellValue(sheetName, 34, 2, "Afrifield Corporation"),
					new ExpectedCellValue(sheetName, 35, 2, "Antarcticopy"),
					new ExpectedCellValue(sheetName, 36, 2, "Beef House"),
					new ExpectedCellValue(sheetName, 37, 2, "Bilabankinn"),
					new ExpectedCellValue(sheetName, 38, 2, "BYT-KOMPLET s.r.o."),
					new ExpectedCellValue(sheetName, 39, 2, "Candoxy Kontor A/S"),
					new ExpectedCellValue(sheetName, 40, 2, "Carl Anthony"),
					new ExpectedCellValue(sheetName, 41, 2, "Centromerkur d.o.o."),
					new ExpectedCellValue(sheetName, 42, 2, "Corporación Beta"),
					new ExpectedCellValue(sheetName, 43, 2, "Cronus Cardoxy Sales"),
					new ExpectedCellValue(sheetName, 44, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 25, 3, "Sum of Net Change"),
					new ExpectedCellValue(sheetName, 26, 3, 84709.73),
					new ExpectedCellValue(sheetName, 27, 3, 8794.86),
					new ExpectedCellValue(sheetName, 28, 3, 8794.86),
					new ExpectedCellValue(sheetName, 29, 3, 0),
					new ExpectedCellValue(sheetName, 30, 3, 0),
					new ExpectedCellValue(sheetName, 31, 3, 0),
					new ExpectedCellValue(sheetName, 32, 3, 0),
					new ExpectedCellValue(sheetName, 33, 3, 75914.87),
					new ExpectedCellValue(sheetName, 34, 3, 0),
					new ExpectedCellValue(sheetName, 35, 3, 3218.14),
					new ExpectedCellValue(sheetName, 36, 3, 14178.1),
					new ExpectedCellValue(sheetName, 37, 3, 0),
					new ExpectedCellValue(sheetName, 38, 3, 58518.63),
					new ExpectedCellValue(sheetName, 39, 3, 0),
					new ExpectedCellValue(sheetName, 40, 3, 0),
					new ExpectedCellValue(sheetName, 41, 3, 0),
					new ExpectedCellValue(sheetName, 42, 3, 0),
					new ExpectedCellValue(sheetName, 43, 3, 0),
					new ExpectedCellValue(sheetName, 44, 3, 84709.73)
				});
			}
		}

		#region Calculated Fields Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithCalculatedFields.xlsx")]
		public void PivotTableRefreshCalculatedField()
		{
			var file = new FileInfo("PivotTableWithCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					var formulaCacheField = cacheDefinition.CacheFields.First(c => !string.IsNullOrEmpty(c.Formula));
					formulaCacheField.Formula = "'Wholesale Price'";
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 3, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 3, 3, 7),
					new ExpectedCellValue(sheetName, 3, 4, 1663),
					new ExpectedCellValue(sheetName, 4, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 3, 2),
					new ExpectedCellValue(sheetName, 4, 4, 415.75),
					new ExpectedCellValue(sheetName, 5, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 3, 4),
					new ExpectedCellValue(sheetName, 5, 4, 831.5),
					new ExpectedCellValue(sheetName, 6, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 3, 1),
					new ExpectedCellValue(sheetName, 6, 4, 415.75),
					new ExpectedCellValue(sheetName, 7, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 3, 1),
					new ExpectedCellValue(sheetName, 7, 4, 24.99),
					new ExpectedCellValue(sheetName, 8, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 3, 1),
					new ExpectedCellValue(sheetName, 8, 4, 24.99),
					new ExpectedCellValue(sheetName, 9, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 9, 3, 1),
					new ExpectedCellValue(sheetName, 9, 4, 99),
					new ExpectedCellValue(sheetName, 10, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 3, 1),
					new ExpectedCellValue(sheetName, 10, 4, 99),
					new ExpectedCellValue(sheetName, 11, 2, "Tent"),
					new ExpectedCellValue(sheetName, 11, 3, 6),
					new ExpectedCellValue(sheetName, 11, 4, 199),
					new ExpectedCellValue(sheetName, 12, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 3, 6),
					new ExpectedCellValue(sheetName, 12, 4, 199),
					new ExpectedCellValue(sheetName, 13, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, 15),
					new ExpectedCellValue(sheetName, 13, 4, 1985.99),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithCalculatedFields.xlsx")]
		public void PivotTableRefreshCalculatedFieldFormulaMultipliesFields()
		{
			var file = new FileInfo("PivotTableWithCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 3, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 3, 3, 7),
					new ExpectedCellValue(sheetName, 3, 4, 11641),
					new ExpectedCellValue(sheetName, 4, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 3, 2),
					new ExpectedCellValue(sheetName, 4, 4, 831.5),
					new ExpectedCellValue(sheetName, 5, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 3, 4),
					new ExpectedCellValue(sheetName, 5, 4, 3326),
					new ExpectedCellValue(sheetName, 6, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 3, 1),
					new ExpectedCellValue(sheetName, 6, 4, 415.75),
					new ExpectedCellValue(sheetName, 7, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 3, 1),
					new ExpectedCellValue(sheetName, 7, 4, 24.99),
					new ExpectedCellValue(sheetName, 8, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 3, 1),
					new ExpectedCellValue(sheetName, 8, 4, 24.99),
					new ExpectedCellValue(sheetName, 9, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 9, 3, 1),
					new ExpectedCellValue(sheetName, 9, 4, 99),
					new ExpectedCellValue(sheetName, 10, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 3, 1),
					new ExpectedCellValue(sheetName, 10, 4, 99),
					new ExpectedCellValue(sheetName, 11, 2, "Tent"),
					new ExpectedCellValue(sheetName, 11, 3, 6),
					new ExpectedCellValue(sheetName, 11, 4, 1194),
					new ExpectedCellValue(sheetName, 12, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 3, 6),
					new ExpectedCellValue(sheetName, 12, 4, 1194),
					new ExpectedCellValue(sheetName, 13, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, 15),
					new ExpectedCellValue(sheetName, 13, 4, 29789.85),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithCalculatedFields.xlsx")]
		public void PivotTableRefreshCalculatedFieldFormulaContainsStringField()
		{
			var file = new FileInfo("PivotTableWithCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					var formulaCacheField = cacheDefinition.CacheFields.First(c => !string.IsNullOrEmpty(c.Formula));
					formulaCacheField.Formula = "'Wholesale Price' * Item";
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 3, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 3, 3, 7),
					new ExpectedCellValue(sheetName, 3, 4, 0),
					new ExpectedCellValue(sheetName, 4, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 3, 2),
					new ExpectedCellValue(sheetName, 4, 4, 0),
					new ExpectedCellValue(sheetName, 5, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 3, 4),
					new ExpectedCellValue(sheetName, 5, 4, 0),
					new ExpectedCellValue(sheetName, 6, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 3, 1),
					new ExpectedCellValue(sheetName, 6, 4, 0),
					new ExpectedCellValue(sheetName, 7, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 3, 1),
					new ExpectedCellValue(sheetName, 7, 4, 0),
					new ExpectedCellValue(sheetName, 8, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 3, 1),
					new ExpectedCellValue(sheetName, 8, 4, 0),
					new ExpectedCellValue(sheetName, 9, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 9, 3, 1),
					new ExpectedCellValue(sheetName, 9, 4, 0),
					new ExpectedCellValue(sheetName, 10, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 3, 1),
					new ExpectedCellValue(sheetName, 10, 4, 0),
					new ExpectedCellValue(sheetName, 11, 2, "Tent"),
					new ExpectedCellValue(sheetName, 11, 3, 6),
					new ExpectedCellValue(sheetName, 11, 4, 0),
					new ExpectedCellValue(sheetName, 12, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 3, 6),
					new ExpectedCellValue(sheetName, 12, 4, 0),
					new ExpectedCellValue(sheetName, 13, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, 15),
					new ExpectedCellValue(sheetName, 13, 4, 0),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithCalculatedFields.xlsx")]
		public void PivotTableRefreshCalculatedFieldFormulaReferencesOtherCalculatedField()
		{
			var file = new FileInfo("PivotTableWithCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B18:D27"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 18, 3, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 18, 4, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 19, 2, "January"),
					new ExpectedCellValue(sheetName, 19, 3, 6236.25),
					new ExpectedCellValue(sheetName, 19, 4, 5),
					new ExpectedCellValue(sheetName, 20, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 3, 6236.25),
					new ExpectedCellValue(sheetName, 20, 4, 5),
					new ExpectedCellValue(sheetName, 21, 2, "February"),
					new ExpectedCellValue(sheetName, 21, 3, 2086.00),
					new ExpectedCellValue(sheetName, 21, 4, 7),
					new ExpectedCellValue(sheetName, 22, 2, "Tent"),
					new ExpectedCellValue(sheetName, 22, 3, 1194d),
					new ExpectedCellValue(sheetName, 22, 4, 6),
					new ExpectedCellValue(sheetName, 23, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 23, 3, 99d),
					new ExpectedCellValue(sheetName, 23, 4, 1),
					new ExpectedCellValue(sheetName, 24, 2, "March"),
					new ExpectedCellValue(sheetName, 24, 3, 1322.22),
					new ExpectedCellValue(sheetName, 24, 4, 3),
					new ExpectedCellValue(sheetName, 25, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 25, 3, 24.99),
					new ExpectedCellValue(sheetName, 25, 4, 1),
					new ExpectedCellValue(sheetName, 26, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 3, 831.5),
					new ExpectedCellValue(sheetName, 26, 4, 2),
					new ExpectedCellValue(sheetName, 27, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 27, 3, 29789.85),
					new ExpectedCellValue(sheetName, 27, 4, 15),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithCalculatedFields.xlsx")]
		public void PivotTableRefreshColumnRowAndPageFieldsWithCalculatedField()
		{
			var file = new FileInfo("PivotTableWithCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G4:L14"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 4, 8, "Column Labels"),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 4, 12, null),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 5, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 5, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 11, "Nashville Total"),
					new ExpectedCellValue(sheetName, 5, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 6, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 6, 12, null),
					new ExpectedCellValue(sheetName, 7, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 7, 12, null),
					new ExpectedCellValue(sheetName, 8, 7, "January"),
					new ExpectedCellValue(sheetName, 8, 8, 415.75),
					new ExpectedCellValue(sheetName, 8, 9, 415.75),
					new ExpectedCellValue(sheetName, 8, 10, 415.75),
					new ExpectedCellValue(sheetName, 8, 11, 415.75),
					new ExpectedCellValue(sheetName, 8, 12, 831.5),
					new ExpectedCellValue(sheetName, 9, 7, "March"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 9, 10, 415.75),
					new ExpectedCellValue(sheetName, 9, 11, 415.75),
					new ExpectedCellValue(sheetName, 9, 12, 415.75),
					new ExpectedCellValue(sheetName, 10, 7, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 10, 12, null),
					new ExpectedCellValue(sheetName, 11, 7, "January"),
					new ExpectedCellValue(sheetName, 11, 8, 831.5),
					new ExpectedCellValue(sheetName, 11, 9, 831.5),
					new ExpectedCellValue(sheetName, 11, 10, 831.5),
					new ExpectedCellValue(sheetName, 11, 11, 831.5),
					new ExpectedCellValue(sheetName, 11, 12, 3326d),
					new ExpectedCellValue(sheetName, 12, 7, "March"),
					new ExpectedCellValue(sheetName, 12, 8, 0d),
					new ExpectedCellValue(sheetName, 12, 9, 0d),
					new ExpectedCellValue(sheetName, 12, 10, 831.5),
					new ExpectedCellValue(sheetName, 12, 11, 831.5),
					new ExpectedCellValue(sheetName, 12, 12, 831.5),
					new ExpectedCellValue(sheetName, 13, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 8, 415.75),
					new ExpectedCellValue(sheetName, 13, 9, 415.75),
					new ExpectedCellValue(sheetName, 13, 10, 831.5),
					new ExpectedCellValue(sheetName, 13, 11, 831.5),
					new ExpectedCellValue(sheetName, 13, 12, 1247.25),
					new ExpectedCellValue(sheetName, 14, 7, "Total Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 14, 8, 831.5),
					new ExpectedCellValue(sheetName, 14, 9, 831.5),
					new ExpectedCellValue(sheetName, 14, 10, 3326d),
					new ExpectedCellValue(sheetName, 14, 11, 3326d),
					new ExpectedCellValue(sheetName, 14, 12, 7483.5),
				});
			}
		}
		#endregion
		#endregion

		#region UpdateData Field Values Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoColumnFields.xlsx")]
		public void PivotTableRefreshDataFieldOneRowFieldWithTrueSubtotalTop()
		{
			var file = new FileInfo("PivotTableWithNoColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B5"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "January"),
					new ExpectedCellValue(sheetName, 3, 1, "February"),
					new ExpectedCellValue(sheetName, 4, 1, "March"),
					new ExpectedCellValue(sheetName, 5, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, 2078.75),
					new ExpectedCellValue(sheetName, 3, 2, 1293d),
					new ExpectedCellValue(sheetName, 4, 2, 856.49),
					new ExpectedCellValue(sheetName, 5, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoColumnFields.xlsx")]
		public void PivotTableRefreshDataFieldTwoRowFieldsWithTrueSubtotalTop()
		{
			var file = new FileInfo("PivotTableWithNoColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F1:G10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "January"),
					new ExpectedCellValue(sheetName, 3, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 6, "February"),
					new ExpectedCellValue(sheetName, 5, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 6, 6, "Tent"),
					new ExpectedCellValue(sheetName, 7, 6, "March"),
					new ExpectedCellValue(sheetName, 8, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 10, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, 2078.75),
					new ExpectedCellValue(sheetName, 3, 7, 2078.75),
					new ExpectedCellValue(sheetName, 4, 7, 1293d),
					new ExpectedCellValue(sheetName, 5, 7, 99d),
					new ExpectedCellValue(sheetName, 6, 7, 1194d),
					new ExpectedCellValue(sheetName, 7, 7, 856.49),
					new ExpectedCellValue(sheetName, 8, 7, 831.5),
					new ExpectedCellValue(sheetName, 9, 7, 24.99),
					new ExpectedCellValue(sheetName, 10, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoColumnFields.xlsx")]
		public void PivotTableRefreshDataFieldTwoRowFieldsWithSubtotalBottom()
		{
			var file = new FileInfo("PivotTableWithNoColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F1:G13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "January"),
					new ExpectedCellValue(sheetName, 3, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 6, "January Total"),
					new ExpectedCellValue(sheetName, 5, 6, "February"),
					new ExpectedCellValue(sheetName, 6, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 7, 6, "Tent"),
					new ExpectedCellValue(sheetName, 8, 6, "February Total"),
					new ExpectedCellValue(sheetName, 9, 6, "March"),
					new ExpectedCellValue(sheetName, 10, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 6, "March Total"),
					new ExpectedCellValue(sheetName, 13, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 7, 2078.75),
					new ExpectedCellValue(sheetName, 4, 7, 2078.75),
					new ExpectedCellValue(sheetName, 6, 7, 99d),
					new ExpectedCellValue(sheetName, 7, 7, 1194d),
					new ExpectedCellValue(sheetName, 8, 7, 1293d),
					new ExpectedCellValue(sheetName, 10, 7, 831.5),
					new ExpectedCellValue(sheetName, 11, 7, 24.99),
					new ExpectedCellValue(sheetName, 12, 7, 856.49),
					new ExpectedCellValue(sheetName, 13, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoColumnFields.xlsx")]
		public void PivotTableRefreshDataFieldTwoRowFieldsWithNoSubtotal()
		{
			var file = new FileInfo("PivotTableWithNoColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F1:G10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "January"),
					new ExpectedCellValue(sheetName, 3, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 6, "February"),
					new ExpectedCellValue(sheetName, 5, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 6, 6, "Tent"),
					new ExpectedCellValue(sheetName, 7, 6, "March"),
					new ExpectedCellValue(sheetName, 8, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 10, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 7, 2078.75),
					new ExpectedCellValue(sheetName, 5, 7, 99d),
					new ExpectedCellValue(sheetName, 6, 7, 1194d),
					new ExpectedCellValue(sheetName, 8, 7, 831.5),
					new ExpectedCellValue(sheetName, 9, 7, 24.99),
					new ExpectedCellValue(sheetName, 10, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoColumnFields.xlsx")]
		public void PivotTableRefreshDataFieldThreeRowFieldsWithTrueSubtotalTop()
		{
			var file = new FileInfo("PivotTableWithNoColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L1:M17"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 12, "January"),
					new ExpectedCellValue(sheetName, 3, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 12, "February"),
					new ExpectedCellValue(sheetName, 8, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 9, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 12, "Tent"),
					new ExpectedCellValue(sheetName, 11, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 12, "March"),
					new ExpectedCellValue(sheetName, 13, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 15, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 16, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 17, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 13, 2078.75),
					new ExpectedCellValue(sheetName, 3, 13, 2078.75),
					new ExpectedCellValue(sheetName, 4, 13, 831.5),
					new ExpectedCellValue(sheetName, 5, 13, 831.5),
					new ExpectedCellValue(sheetName, 6, 13, 415.75),
					new ExpectedCellValue(sheetName, 7, 13, 1293d),
					new ExpectedCellValue(sheetName, 8, 13, 99d),
					new ExpectedCellValue(sheetName, 9, 13, 99d),
					new ExpectedCellValue(sheetName, 10, 13, 1194d),
					new ExpectedCellValue(sheetName, 11, 13, 1194d),
					new ExpectedCellValue(sheetName, 12, 13, 856.49),
					new ExpectedCellValue(sheetName, 13, 13, 831.5),
					new ExpectedCellValue(sheetName, 14, 13, 831.5),
					new ExpectedCellValue(sheetName, 15, 13, 24.99),
					new ExpectedCellValue(sheetName, 16, 13, 24.99),
					new ExpectedCellValue(sheetName, 17, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoColumnFields.xlsx")]
		public void PivotTableRefreshDataFieldThreeRowFieldsWithSubtotalBottom()
		{
			var file = new FileInfo("PivotTableWithNoColumnFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["PivotTables"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L1:M25"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "PivotTables";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 12, "January"),
					new ExpectedCellValue(sheetName, 3, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 12, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 8, 12, "January Total"),
					new ExpectedCellValue(sheetName, 9, 12, "February"),
					new ExpectedCellValue(sheetName, 10, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 11, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 12, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 13, 12, "Tent"),
					new ExpectedCellValue(sheetName, 14, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 15, 12, "Tent Total"),
					new ExpectedCellValue(sheetName, 16, 12, "February Total"),
					new ExpectedCellValue(sheetName, 17, 12, "March"),
					new ExpectedCellValue(sheetName, 18, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 12, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 21, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 22, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 23, 12, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 24, 12, "March Total"),
					new ExpectedCellValue(sheetName, 25, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 13, 831.5),
					new ExpectedCellValue(sheetName, 5, 13, 831.5),
					new ExpectedCellValue(sheetName, 6, 13, 415.75),
					new ExpectedCellValue(sheetName, 7, 13, 2078.75),
					new ExpectedCellValue(sheetName, 8, 13, 2078.75),
					new ExpectedCellValue(sheetName, 11, 13, 99d),
					new ExpectedCellValue(sheetName, 12, 13, 99d),
					new ExpectedCellValue(sheetName, 14, 13, 1194d),
					new ExpectedCellValue(sheetName, 15, 13, 1194d),
					new ExpectedCellValue(sheetName, 16, 13, 1293d),
					new ExpectedCellValue(sheetName, 19, 13, 831.5),
					new ExpectedCellValue(sheetName, 20, 13, 831.5),
					new ExpectedCellValue(sheetName, 22, 13, 24.99),
					new ExpectedCellValue(sheetName, 23, 13, 24.99),
					new ExpectedCellValue(sheetName, 24, 13, 856.49),
					new ExpectedCellValue(sheetName, 25, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithNoSubtotals.xlsx")]
		public void PivotTableRefreshDataFieldsRowsAndColumnsWithNoSubtotal()
		{
			var file = new FileInfo("PivotTableWithNoSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["NoSubtotals"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:I13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "NoSubtotals";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "1"),
					new ExpectedCellValue(sheetName, 6, 1, "2"),
					new ExpectedCellValue(sheetName, 7, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 1, "1"),
					new ExpectedCellValue(sheetName, 9, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 10, 1, "1"),
					new ExpectedCellValue(sheetName, 11, 1, "Tent"),
					new ExpectedCellValue(sheetName, 12, 1, "6"),
					new ExpectedCellValue(sheetName, 13, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 6, 2, 415.75),
					new ExpectedCellValue(sheetName, 13, 2, 415.75),
					new ExpectedCellValue(sheetName, 3, 3, "March"),
					new ExpectedCellValue(sheetName, 8, 3, 24.99),
					new ExpectedCellValue(sheetName, 13, 3, 24.99),
					new ExpectedCellValue(sheetName, 2, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 3, 4, "January"),
					new ExpectedCellValue(sheetName, 6, 4, 415.75),
					new ExpectedCellValue(sheetName, 13, 2, 415.75),
					new ExpectedCellValue(sheetName, 3, 5, "February"),
					new ExpectedCellValue(sheetName, 12, 5, 199d),
					new ExpectedCellValue(sheetName, 13, 5, 199d),
					new ExpectedCellValue(sheetName, 3, 6, "March"),
					new ExpectedCellValue(sheetName, 6, 6, 415.75),
					new ExpectedCellValue(sheetName, 13, 6, 415.75),
					new ExpectedCellValue(sheetName, 2, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 3, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, 415.75),
					new ExpectedCellValue(sheetName, 13, 7, 415.75),
					new ExpectedCellValue(sheetName, 3, 8, "February"),
					new ExpectedCellValue(sheetName, 10, 8, 99d),
					new ExpectedCellValue(sheetName, 13, 8, 99d),
					new ExpectedCellValue(sheetName, 2, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 9, 415.75),
					new ExpectedCellValue(sheetName, 6, 9, 1247.25),
					new ExpectedCellValue(sheetName, 8, 9, 24.99),
					new ExpectedCellValue(sheetName, 10, 9, 99d),
					new ExpectedCellValue(sheetName, 12, 9, 199d),
					new ExpectedCellValue(sheetName, 13, 9, 1985.99),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithGrandTotals.xlsx")]
		public void PivotTableRefreshDataFieldsRowsAndColumnsGrandTotalOff()
		{
			var file = new FileInfo("PivotTableWithGrandTotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["GrandTotals"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					pivotTable.RowGrandTotals = false;
					pivotTable.ColumnGrandTotals = false;
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:K7"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "GrandTotals";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 6, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 7, 1, "Tent"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 3, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 3, 831.5),
					new ExpectedCellValue(sheetName, 3, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 4, 415.75),
					new ExpectedCellValue(sheetName, 2, 5, "January Total"),
					new ExpectedCellValue(sheetName, 4, 5, 2078.75),
					new ExpectedCellValue(sheetName, 2, 6, "February"),
					new ExpectedCellValue(sheetName, 3, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, 1194d),
					new ExpectedCellValue(sheetName, 3, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 7, 99d),
					new ExpectedCellValue(sheetName, 2, 8, "February Total"),
					new ExpectedCellValue(sheetName, 6, 8, 99d),
					new ExpectedCellValue(sheetName, 7, 8, 1194d),
					new ExpectedCellValue(sheetName, 2, 9, "March"),
					new ExpectedCellValue(sheetName, 3, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 9, 24.99),
					new ExpectedCellValue(sheetName, 3, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 2, 11, "March Total"),
					new ExpectedCellValue(sheetName, 4, 11, 831.5),
					new ExpectedCellValue(sheetName, 5, 11, 24.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithGrandTotals.xlsx")]
		public void PivotTableRefreshDataFieldsColumnGrandTotalOff()
		{
			var file = new FileInfo("PivotTableWithGrandTotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["GrandTotals"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					pivotTable.ColumnGrandTotals = false;
					pivotTable.RowGrandTotals = true;
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:K8"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "GrandTotals";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 6, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 7, 1, "Tent"),
					new ExpectedCellValue(sheetName, 8, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 8, 2, 831.5),
					new ExpectedCellValue(sheetName, 3, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 3, 831.5),
					new ExpectedCellValue(sheetName, 8, 3, 831.5),
					new ExpectedCellValue(sheetName, 3, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 4, 415.75),
					new ExpectedCellValue(sheetName, 8, 4, 415.75),
					new ExpectedCellValue(sheetName, 2, 5, "January Total"),
					new ExpectedCellValue(sheetName, 4, 5, 2078.75),
					new ExpectedCellValue(sheetName, 8, 5, 2078.75),
					new ExpectedCellValue(sheetName, 2, 6, "February"),
					new ExpectedCellValue(sheetName, 3, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, 1194d),
					new ExpectedCellValue(sheetName, 8, 6, 1194d),
					new ExpectedCellValue(sheetName, 3, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 7, 99d),
					new ExpectedCellValue(sheetName, 8, 7, 99d),
					new ExpectedCellValue(sheetName, 2, 8, "February Total"),
					new ExpectedCellValue(sheetName, 6, 8, 99d),
					new ExpectedCellValue(sheetName, 7, 8, 1194d),
					new ExpectedCellValue(sheetName, 8, 8, 1293d),
					new ExpectedCellValue(sheetName, 2, 9, "March"),
					new ExpectedCellValue(sheetName, 3, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 9, 24.99),
					new ExpectedCellValue(sheetName, 8, 9, 24.99),
					new ExpectedCellValue(sheetName, 3, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 8, 10, 831.5),
					new ExpectedCellValue(sheetName, 2, 11, "March Total"),
					new ExpectedCellValue(sheetName, 4, 11, 831.5),
					new ExpectedCellValue(sheetName, 5, 11, 24.99),
					new ExpectedCellValue(sheetName, 8, 11, 856.49)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithGrandTotals.xlsx")]
		public void PivotTableRefreshDataFieldsRowGrandTotalOff()
		{
			var file = new FileInfo("PivotTableWithGrandTotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["GrandTotals"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					pivotTable.RowGrandTotals = false;
					pivotTable.ColumnGrandTotals = true;
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:L7"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "GrandTotals";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 6, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 7, 1, "Tent"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 3, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 3, 831.5),
					new ExpectedCellValue(sheetName, 3, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 4, 415.75),
					new ExpectedCellValue(sheetName, 2, 5, "January Total"),
					new ExpectedCellValue(sheetName, 4, 5, 2078.75),
					new ExpectedCellValue(sheetName, 2, 6, "February"),
					new ExpectedCellValue(sheetName, 3, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, 1194d),
					new ExpectedCellValue(sheetName, 3, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 6, 7, 99d),
					new ExpectedCellValue(sheetName, 2, 8, "February Total"),
					new ExpectedCellValue(sheetName, 6, 8, 99d),
					new ExpectedCellValue(sheetName, 7, 8, 1194d),
					new ExpectedCellValue(sheetName, 2, 9, "March"),
					new ExpectedCellValue(sheetName, 3, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 9, 24.99),
					new ExpectedCellValue(sheetName, 3, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 2, 11, "March Total"),
					new ExpectedCellValue(sheetName, 4, 11, 831.5),
					new ExpectedCellValue(sheetName, 5, 11, 24.99),
					new ExpectedCellValue(sheetName, 2, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 12, 2910.25),
					new ExpectedCellValue(sheetName, 5, 12, 24.99),
					new ExpectedCellValue(sheetName, 6, 12, 99d),
					new ExpectedCellValue(sheetName, 7, 12, 1194d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleDataFields.xlsx")]
		public void PivotTableRefreshMultipleDataFields()
		{
			var file = new FileInfo("PivotTableWithMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["MultipleDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:C5"), pivotTable.Address);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "MultipleDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 3, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 5, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 2, 3),
					new ExpectedCellValue(sheetName, 3, 2, 10),
					new ExpectedCellValue(sheetName, 4, 2, 2),
					new ExpectedCellValue(sheetName, 5, 2, 15),
					new ExpectedCellValue(sheetName, 1, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 3, 856.49),
					new ExpectedCellValue(sheetName, 3, 3, 2857d),
					new ExpectedCellValue(sheetName, 4, 3, 514.75),
					new ExpectedCellValue(sheetName, 5, 3, 4228.24),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleDataFields.xlsx")]
		public void PivotTableRefreshMultipleDataFieldsNoGrandTotal()
		{
			var file = new FileInfo("PivotTableWithMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["MultipleDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					pivotTable.RowGrandTotals = false;
					pivotTable.ColumnGrandTotals = true;
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:C4"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "MultipleDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 3, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 2, 3),
					new ExpectedCellValue(sheetName, 3, 2, 10),
					new ExpectedCellValue(sheetName, 4, 2, 2),
					new ExpectedCellValue(sheetName, 1, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 3, 856.49),
					new ExpectedCellValue(sheetName, 3, 3, 2857d),
					new ExpectedCellValue(sheetName, 4, 3, 514.75)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleDataFields.xlsx")]
		public void PivotTableRefreshMultipleDataFieldsWithColumnHeaders()
		{
			var file = new FileInfo("PivotTableWithMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["MultipleDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A10:W17"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "MultipleDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 14, 1, "January"),
					new ExpectedCellValue(sheetName, 15, 1, "February"),
					new ExpectedCellValue(sheetName, 16, 1, "March"),
					new ExpectedCellValue(sheetName, 17, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 11, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 2, 2d),
					new ExpectedCellValue(sheetName, 17, 2, 2d),
					new ExpectedCellValue(sheetName, 13, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 3, 831.5),
					new ExpectedCellValue(sheetName, 17, 3, 831.5),
					new ExpectedCellValue(sheetName, 12, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 4, 2d),
					new ExpectedCellValue(sheetName, 16, 4, 2d),
					new ExpectedCellValue(sheetName, 17, 4, 4d),
					new ExpectedCellValue(sheetName, 13, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 5, 831.5),
					new ExpectedCellValue(sheetName, 16, 5, 831.5),
					new ExpectedCellValue(sheetName, 17, 5, 1663d),
					new ExpectedCellValue(sheetName, 12, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 6, 1d),
					new ExpectedCellValue(sheetName, 17, 6, 1d),
					new ExpectedCellValue(sheetName, 13, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 7, 415.75),
					new ExpectedCellValue(sheetName, 17, 7, 415.75),
					new ExpectedCellValue(sheetName, 11, 8, "Car Rack Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 8, 5d),
					new ExpectedCellValue(sheetName, 16, 8, 2d),
					new ExpectedCellValue(sheetName, 17, 8, 7d),
					new ExpectedCellValue(sheetName, 11, 9, "Car Rack Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 9, 2078.75),
					new ExpectedCellValue(sheetName, 16, 9, 831.5),
					new ExpectedCellValue(sheetName, 17, 9, 2910.25),
					new ExpectedCellValue(sheetName, 11, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 10, 1d),
					new ExpectedCellValue(sheetName, 17, 10, 1d),
					new ExpectedCellValue(sheetName, 13, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 11, 24.99),
					new ExpectedCellValue(sheetName, 17, 11, 24.99),
					new ExpectedCellValue(sheetName, 11, 12, "Headlamp Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 12, 1d),
					new ExpectedCellValue(sheetName, 17, 12, 1d),
					new ExpectedCellValue(sheetName, 11, 13, "Headlamp Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 13, 24.99),
					new ExpectedCellValue(sheetName, 17, 13, 24.99),
					new ExpectedCellValue(sheetName, 11, 14, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 12, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 14, 1d),
					new ExpectedCellValue(sheetName, 17, 14, 1d),
					new ExpectedCellValue(sheetName, 13, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 15, 99d),
					new ExpectedCellValue(sheetName, 17, 15, 99d),
					new ExpectedCellValue(sheetName, 11, 16, "Sleeping Bag Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 16, 1d),
					new ExpectedCellValue(sheetName, 17, 16, 1d),
					new ExpectedCellValue(sheetName, 11, 17, "Sleeping Bag Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 17, 99d),
					new ExpectedCellValue(sheetName, 17, 17, 99d),
					new ExpectedCellValue(sheetName, 11, 18, "Tent"),
					new ExpectedCellValue(sheetName, 12, 18, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 18, 6d),
					new ExpectedCellValue(sheetName, 17, 18, 6d),
					new ExpectedCellValue(sheetName, 13, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 19, 1194d),
					new ExpectedCellValue(sheetName, 17, 19, 1194d),
					new ExpectedCellValue(sheetName, 11, 20, "Tent Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 20, 6d),
					new ExpectedCellValue(sheetName, 17, 20, 6d),
					new ExpectedCellValue(sheetName, 11, 21, "Tent Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 21, 1194d),
					new ExpectedCellValue(sheetName, 17, 21, 1194d),
					new ExpectedCellValue(sheetName, 11, 22, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 22, 5d),
					new ExpectedCellValue(sheetName, 15, 22, 7d),
					new ExpectedCellValue(sheetName, 16, 22, 3d),
					new ExpectedCellValue(sheetName, 17, 22, 15d),
					new ExpectedCellValue(sheetName, 11, 23, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 23, 2078.75),
					new ExpectedCellValue(sheetName, 15, 23, 1293d),
					new ExpectedCellValue(sheetName, 16, 23, 856.49),
					new ExpectedCellValue(sheetName, 17, 23, 4228.24)
				});
			}
		}

		#region Multiple Row Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsOneRowFieldOneColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsOneRowAndOneColumn()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsOneRowFieldOneColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:E13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 4, 2, 2d),
					new ExpectedCellValue(sheetName, 5, 2, 831.5),
					new ExpectedCellValue(sheetName, 7, 2, 2d),
					new ExpectedCellValue(sheetName, 8, 2, 831.5),
					new ExpectedCellValue(sheetName, 10, 2, 1d),
					new ExpectedCellValue(sheetName, 11, 2, 415.75),
					new ExpectedCellValue(sheetName, 12, 2, 5d),
					new ExpectedCellValue(sheetName, 13, 2, 2078.75),
					new ExpectedCellValue(sheetName, 2, 3, "February"),
					new ExpectedCellValue(sheetName, 7, 3, 6d),
					new ExpectedCellValue(sheetName, 8, 3, 1194d),
					new ExpectedCellValue(sheetName, 10, 3, 1d),
					new ExpectedCellValue(sheetName, 11, 3, 99d),
					new ExpectedCellValue(sheetName, 12, 3, 7d),
					new ExpectedCellValue(sheetName, 13, 3, 1293d),
					new ExpectedCellValue(sheetName, 2, 4, "March"),
					new ExpectedCellValue(sheetName, 4, 4, 1d),
					new ExpectedCellValue(sheetName, 5, 4, 24.99),
					new ExpectedCellValue(sheetName, 7, 4, 2d),
					new ExpectedCellValue(sheetName, 8, 4, 831.5),
					new ExpectedCellValue(sheetName, 12, 4, 3d),
					new ExpectedCellValue(sheetName, 13, 4, 856.49),
					new ExpectedCellValue(sheetName, 2, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 5, 3d),
					new ExpectedCellValue(sheetName, 5, 5, 856.49),
					new ExpectedCellValue(sheetName, 7, 5, 10d),
					new ExpectedCellValue(sheetName, 8, 5, 2857d),
					new ExpectedCellValue(sheetName, 10, 5, 2d),
					new ExpectedCellValue(sheetName, 11, 5, 514.75),
					new ExpectedCellValue(sheetName, 12, 5, 15d),
					new ExpectedCellValue(sheetName, 13, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsTwoRowFieldOneColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsTwoRowsAndOneColumnSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsTwoRowFieldOneColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:E25"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 1, "Tent"),
					new ExpectedCellValue(sheetName, 15, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 18, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 22, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, 2d),
					new ExpectedCellValue(sheetName, 6, 2, 831.5),
					new ExpectedCellValue(sheetName, 12, 2, 2d),
					new ExpectedCellValue(sheetName, 13, 2, 831.5),
					new ExpectedCellValue(sheetName, 19, 2, 1d),
					new ExpectedCellValue(sheetName, 20, 2, 415.75),
					new ExpectedCellValue(sheetName, 24, 2, 5d),
					new ExpectedCellValue(sheetName, 25, 2, 2078.75),
					new ExpectedCellValue(sheetName, 2, 3, "February"),
					new ExpectedCellValue(sheetName, 15, 3, 6d),
					new ExpectedCellValue(sheetName, 16, 3, 1194d),
					new ExpectedCellValue(sheetName, 22, 3, 1d),
					new ExpectedCellValue(sheetName, 23, 3, 99d),
					new ExpectedCellValue(sheetName, 24, 3, 7d),
					new ExpectedCellValue(sheetName, 25, 3, 1293d),
					new ExpectedCellValue(sheetName, 2, 4, "March"),
					new ExpectedCellValue(sheetName, 8, 4, 1d),
					new ExpectedCellValue(sheetName, 9, 4, 24.99),
					new ExpectedCellValue(sheetName, 12, 4, 2d),
					new ExpectedCellValue(sheetName, 13, 4, 831.5),
					new ExpectedCellValue(sheetName, 24, 4, 3d),
					new ExpectedCellValue(sheetName, 25, 4, 856.49),
					new ExpectedCellValue(sheetName, 2, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 5, 2d),
					new ExpectedCellValue(sheetName, 6, 5, 831.5),
					new ExpectedCellValue(sheetName, 8, 5, 1d),
					new ExpectedCellValue(sheetName, 9, 5, 24.99),
					new ExpectedCellValue(sheetName, 12, 5, 4d),
					new ExpectedCellValue(sheetName, 13, 5, 1663d),
					new ExpectedCellValue(sheetName, 15, 5, 6d),
					new ExpectedCellValue(sheetName, 16, 5, 1194d),
					new ExpectedCellValue(sheetName, 19, 5, 1d),
					new ExpectedCellValue(sheetName, 20, 5, 415.75),
					new ExpectedCellValue(sheetName, 22, 5, 1d),
					new ExpectedCellValue(sheetName, 23, 5, 99d),
					new ExpectedCellValue(sheetName, 24, 5, 15d),
					new ExpectedCellValue(sheetName, 25, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsTwoRowFieldOneColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsTwoRowsAndOneColumnSubtotalsBottom()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsTwoRowFieldOneColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:E31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 1, "Tent"),
					new ExpectedCellValue(sheetName, 17, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 26, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 27, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 29, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 30, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 31, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, 2d),
					new ExpectedCellValue(sheetName, 6, 2, 831.5),
					new ExpectedCellValue(sheetName, 10, 2, 2d),
					new ExpectedCellValue(sheetName, 11, 2, 831.5),
					new ExpectedCellValue(sheetName, 14, 2, 2d),
					new ExpectedCellValue(sheetName, 15, 2, 831.5),
					new ExpectedCellValue(sheetName, 19, 2, 2d),
					new ExpectedCellValue(sheetName, 20, 2, 831.5),
					new ExpectedCellValue(sheetName, 23, 2, 1d),
					new ExpectedCellValue(sheetName, 24, 2, 415.75),
					new ExpectedCellValue(sheetName, 28, 2, 1d),
					new ExpectedCellValue(sheetName, 29, 2, 415.75),
					new ExpectedCellValue(sheetName, 30, 2, 5d),
					new ExpectedCellValue(sheetName, 31, 2, 2078.75),
					new ExpectedCellValue(sheetName, 2, 3, "February"),
					new ExpectedCellValue(sheetName, 17, 3, 6d),
					new ExpectedCellValue(sheetName, 18, 3, 1194d),
					new ExpectedCellValue(sheetName, 19, 3, 6d),
					new ExpectedCellValue(sheetName, 20, 3, 1194d),
					new ExpectedCellValue(sheetName, 26, 3, 1d),
					new ExpectedCellValue(sheetName, 27, 3, 99d),
					new ExpectedCellValue(sheetName, 28, 3, 1d),
					new ExpectedCellValue(sheetName, 29, 3, 99d),
					new ExpectedCellValue(sheetName, 30, 3, 7d),
					new ExpectedCellValue(sheetName, 31, 3, 1293d),
					new ExpectedCellValue(sheetName, 2, 4, "March"),
					new ExpectedCellValue(sheetName, 8, 4, 1d),
					new ExpectedCellValue(sheetName, 9, 4, 24.99),
					new ExpectedCellValue(sheetName, 10, 4, 1d),
					new ExpectedCellValue(sheetName, 11, 4, 24.99),
					new ExpectedCellValue(sheetName, 14, 4, 2d),
					new ExpectedCellValue(sheetName, 15, 4, 831.5),
					new ExpectedCellValue(sheetName, 19, 4, 2d),
					new ExpectedCellValue(sheetName, 20, 4, 831.5),
					new ExpectedCellValue(sheetName, 30, 4, 3d),
					new ExpectedCellValue(sheetName, 31, 4, 856.49),
					new ExpectedCellValue(sheetName, 2, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 5, 2d),
					new ExpectedCellValue(sheetName, 6, 5, 831.5),
					new ExpectedCellValue(sheetName, 8, 5, 1d),
					new ExpectedCellValue(sheetName, 9, 5, 24.99),
					new ExpectedCellValue(sheetName, 10, 5, 3d),
					new ExpectedCellValue(sheetName, 11, 5, 856.49),
					new ExpectedCellValue(sheetName, 14, 5, 4d),
					new ExpectedCellValue(sheetName, 15, 5, 1663d),
					new ExpectedCellValue(sheetName, 17, 5, 6d),
					new ExpectedCellValue(sheetName, 18, 5, 1194d),
					new ExpectedCellValue(sheetName, 19, 5, 10d),
					new ExpectedCellValue(sheetName, 20, 5, 2857d),
					new ExpectedCellValue(sheetName, 23, 5, 1d),
					new ExpectedCellValue(sheetName, 24, 5, 415.75),
					new ExpectedCellValue(sheetName, 26, 5, 1d),
					new ExpectedCellValue(sheetName, 27, 5, 99d),
					new ExpectedCellValue(sheetName, 28, 5, 2d),
					new ExpectedCellValue(sheetName, 29, 5, 514.75),
					new ExpectedCellValue(sheetName, 30, 5, 15d),
					new ExpectedCellValue(sheetName, 31, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsThreeRowFieldOneColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsThreeRowsAndOneColumnSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsThreeRowFieldOneColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:E34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(7, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "20100007"),
					new ExpectedCellValue(sheetName, 6, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 9, 1, "20100083"),
					new ExpectedCellValue(sheetName, 10, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 1, "20100017"),
					new ExpectedCellValue(sheetName, 15, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 1, "20100090"),
					new ExpectedCellValue(sheetName, 18, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 19, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 1, "Tent"),
					new ExpectedCellValue(sheetName, 21, 1, "20100070"),
					new ExpectedCellValue(sheetName, 22, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 1, "20100076"),
					new ExpectedCellValue(sheetName, 27, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 30, 1, "20100085"),
					new ExpectedCellValue(sheetName, 31, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 6, 2, 2d),
					new ExpectedCellValue(sheetName, 7, 2, 831.5),
					new ExpectedCellValue(sheetName, 18, 2, 2d),
					new ExpectedCellValue(sheetName, 19, 2, 831.5),
					new ExpectedCellValue(sheetName, 27, 2, 1d),
					new ExpectedCellValue(sheetName, 28, 2, 415.75),
					new ExpectedCellValue(sheetName, 33, 2, 5d),
					new ExpectedCellValue(sheetName, 34, 2, 2078.75),
					new ExpectedCellValue(sheetName, 2, 3, "February"),
					new ExpectedCellValue(sheetName, 22, 3, 6d),
					new ExpectedCellValue(sheetName, 23, 3, 1194d),
					new ExpectedCellValue(sheetName, 31, 3, 1d),
					new ExpectedCellValue(sheetName, 32, 3, 99d),
					new ExpectedCellValue(sheetName, 33, 3, 7d),
					new ExpectedCellValue(sheetName, 34, 3, 1293d),
					new ExpectedCellValue(sheetName, 2, 4, "March"),
					new ExpectedCellValue(sheetName, 10, 4, 1d),
					new ExpectedCellValue(sheetName, 11, 4, 24.99),
					new ExpectedCellValue(sheetName, 15, 4, 2d),
					new ExpectedCellValue(sheetName, 16, 4, 831.5),
					new ExpectedCellValue(sheetName, 33, 4, 3d),
					new ExpectedCellValue(sheetName, 34, 4, 856.49),
					new ExpectedCellValue(sheetName, 2, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 5, 2d),
					new ExpectedCellValue(sheetName, 7, 5, 831.5),
					new ExpectedCellValue(sheetName, 10, 5, 1d),
					new ExpectedCellValue(sheetName, 11, 5, 24.99),
					new ExpectedCellValue(sheetName, 15, 5, 2d),
					new ExpectedCellValue(sheetName, 16, 5, 831.5),
					new ExpectedCellValue(sheetName, 18, 5, 2d),
					new ExpectedCellValue(sheetName, 19, 5, 831.5),
					new ExpectedCellValue(sheetName, 22, 5, 6d),
					new ExpectedCellValue(sheetName, 23, 5, 1194d),
					new ExpectedCellValue(sheetName, 27, 5, 1d),
					new ExpectedCellValue(sheetName, 28, 5, 415.75),
					new ExpectedCellValue(sheetName, 31, 5, 1d),
					new ExpectedCellValue(sheetName, 32, 5, 99d),
					new ExpectedCellValue(sheetName, 33, 5, 15d),
					new ExpectedCellValue(sheetName, 34, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsThreeRowFieldOneColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsThreeRowsAndOneColumnSubtotalsOn()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsThreeRowFieldOneColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:E52"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 1, "20100007"),
					new ExpectedCellValue(sheetName, 6, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 1, "Car Rack Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 1, "Car Rack Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 11, 1, "20100083"),
					new ExpectedCellValue(sheetName, 12, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 1, "Headlamp Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 1, "Headlamp Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 1, "20100017"),
					new ExpectedCellValue(sheetName, 21, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 1, "20100090"),
					new ExpectedCellValue(sheetName, 24, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 1, "Car Rack Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 27, 1, "Car Rack Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 1, "Tent"),
					new ExpectedCellValue(sheetName, 29, 1, "20100070"),
					new ExpectedCellValue(sheetName, 30, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 31, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 32, 1, "Tent Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 1, "Tent Sum of Total"),
					new ExpectedCellValue(sheetName, 34, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 35, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 37, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 1, "20100076"),
					new ExpectedCellValue(sheetName, 39, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 40, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 1, "Car Rack Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 1, "Car Rack Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 44, 1, "20100085"),
					new ExpectedCellValue(sheetName, 45, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 46, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 1, "Sleeping Bag Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 48, 1, "Sleeping Bag Sum of Total"),
					new ExpectedCellValue(sheetName, 49, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 52, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 6, 2, 2d),
					new ExpectedCellValue(sheetName, 7, 2, 831.5),
					new ExpectedCellValue(sheetName, 8, 2, 2d),
					new ExpectedCellValue(sheetName, 9, 2, 831.5),
					new ExpectedCellValue(sheetName, 16, 2, 2d),
					new ExpectedCellValue(sheetName, 17, 2, 831.5),
					new ExpectedCellValue(sheetName, 24, 2, 2d),
					new ExpectedCellValue(sheetName, 25, 2, 831.5),
					new ExpectedCellValue(sheetName, 26, 2, 2d),
					new ExpectedCellValue(sheetName, 27, 2, 831.5),
					new ExpectedCellValue(sheetName, 34, 2, 2d),
					new ExpectedCellValue(sheetName, 35, 2, 831.5),
					new ExpectedCellValue(sheetName, 39, 2, 1d),
					new ExpectedCellValue(sheetName, 40, 2, 415.75),
					new ExpectedCellValue(sheetName, 41, 2, 1d),
					new ExpectedCellValue(sheetName, 42, 2, 415.75),
					new ExpectedCellValue(sheetName, 49, 2, 1d),
					new ExpectedCellValue(sheetName, 50, 2, 415.75),
					new ExpectedCellValue(sheetName, 51, 2, 5d),
					new ExpectedCellValue(sheetName, 52, 2, 2078.75),
					new ExpectedCellValue(sheetName, 2, 3, "February"),
					new ExpectedCellValue(sheetName, 30, 3, 6d),
					new ExpectedCellValue(sheetName, 31, 3, 1194d),
					new ExpectedCellValue(sheetName, 32, 3, 6d),
					new ExpectedCellValue(sheetName, 33, 3, 1194d),
					new ExpectedCellValue(sheetName, 34, 3, 6d),
					new ExpectedCellValue(sheetName, 35, 3, 1194d),
					new ExpectedCellValue(sheetName, 45, 3, 1d),
					new ExpectedCellValue(sheetName, 46, 3, 99d),
					new ExpectedCellValue(sheetName, 47, 3, 1d),
					new ExpectedCellValue(sheetName, 48, 3, 99d),
					new ExpectedCellValue(sheetName, 49, 3, 1d),
					new ExpectedCellValue(sheetName, 50, 3, 99d),
					new ExpectedCellValue(sheetName, 51, 3, 7d),
					new ExpectedCellValue(sheetName, 52, 3, 1293d),
					new ExpectedCellValue(sheetName, 2, 4, "March"),
					new ExpectedCellValue(sheetName, 12, 4, 1d),
					new ExpectedCellValue(sheetName, 13, 4, 24.99),
					new ExpectedCellValue(sheetName, 14, 4, 1d),
					new ExpectedCellValue(sheetName, 15, 4, 24.99),
					new ExpectedCellValue(sheetName, 16, 4, 1d),
					new ExpectedCellValue(sheetName, 17, 4, 24.99),
					new ExpectedCellValue(sheetName, 21, 4, 2d),
					new ExpectedCellValue(sheetName, 22, 4, 831.5),
					new ExpectedCellValue(sheetName, 26, 4, 2d),
					new ExpectedCellValue(sheetName, 27, 4, 831.5),
					new ExpectedCellValue(sheetName, 34, 4, 2d),
					new ExpectedCellValue(sheetName, 35, 4, 831.5),
					new ExpectedCellValue(sheetName, 51, 4, 3d),
					new ExpectedCellValue(sheetName, 52, 4, 856.49),
					new ExpectedCellValue(sheetName, 2, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 5, 2d),
					new ExpectedCellValue(sheetName, 7, 5, 831.5),
					new ExpectedCellValue(sheetName, 8, 5, 2d),
					new ExpectedCellValue(sheetName, 9, 5, 831.5),
					new ExpectedCellValue(sheetName, 12, 5, 1d),
					new ExpectedCellValue(sheetName, 13, 5, 24.99),
					new ExpectedCellValue(sheetName, 14, 5, 1d),
					new ExpectedCellValue(sheetName, 15, 5, 24.99),
					new ExpectedCellValue(sheetName, 16, 5, 3d),
					new ExpectedCellValue(sheetName, 17, 5, 856.49),
					new ExpectedCellValue(sheetName, 21, 5, 2d),
					new ExpectedCellValue(sheetName, 22, 5, 831.5),
					new ExpectedCellValue(sheetName, 24, 5, 2d),
					new ExpectedCellValue(sheetName, 25, 5, 831.5),
					new ExpectedCellValue(sheetName, 26, 5, 4d),
					new ExpectedCellValue(sheetName, 27, 5, 1663),
					new ExpectedCellValue(sheetName, 30, 5, 6d),
					new ExpectedCellValue(sheetName, 31, 5, 1194d),
					new ExpectedCellValue(sheetName, 32, 5, 6d),
					new ExpectedCellValue(sheetName, 33, 5, 1194d),
					new ExpectedCellValue(sheetName, 34, 5, 10d),
					new ExpectedCellValue(sheetName, 35, 5, 2857d),
					new ExpectedCellValue(sheetName, 39, 5, 1d),
					new ExpectedCellValue(sheetName, 40, 5, 415.75),
					new ExpectedCellValue(sheetName, 41, 5, 1d),
					new ExpectedCellValue(sheetName, 42, 5, 415.75),
					new ExpectedCellValue(sheetName, 45, 5, 1d),
					new ExpectedCellValue(sheetName, 46, 5, 99d),
					new ExpectedCellValue(sheetName, 47, 5, 1d),
					new ExpectedCellValue(sheetName, 48, 5, 99d),
					new ExpectedCellValue(sheetName, 49, 5, 2d),
					new ExpectedCellValue(sheetName, 50, 5, 514.75),
					new ExpectedCellValue(sheetName, 51, 5, 15d),
					new ExpectedCellValue(sheetName, 52, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsOneRowAndNoColumns()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B12"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "January"),
					new ExpectedCellValue(sheetName, 3, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 1, "February"),
					new ExpectedCellValue(sheetName, 6, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 1, "March"),
					new ExpectedCellValue(sheetName, 9, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 2, 5d),
					new ExpectedCellValue(sheetName, 4, 2, 2078.75),
					new ExpectedCellValue(sheetName, 6, 2, 7d),
					new ExpectedCellValue(sheetName, 7, 2, 1293d),
					new ExpectedCellValue(sheetName, 9, 2, 3d),
					new ExpectedCellValue(sheetName, 10, 2, 856.49),
					new ExpectedCellValue(sheetName, 11, 2, 15d),
					new ExpectedCellValue(sheetName, 12, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsTwoRowsAndNoColumnsSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F1:G26"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "January"),
					new ExpectedCellValue(sheetName, 3, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 6, "February"),
					new ExpectedCellValue(sheetName, 12, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 14, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 15, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 18, 6, "March"),
					new ExpectedCellValue(sheetName, 19, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 22, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 24, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 25, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 26, 6, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 4, 7, 2d),
					new ExpectedCellValue(sheetName, 5, 7, 2d),
					new ExpectedCellValue(sheetName, 6, 7, 1d),
					new ExpectedCellValue(sheetName, 8, 7, 831.5),
					new ExpectedCellValue(sheetName, 9, 7, 831.5),
					new ExpectedCellValue(sheetName, 10, 7, 415.75),
					new ExpectedCellValue(sheetName, 13, 7, 6d),
					new ExpectedCellValue(sheetName, 14, 7, 1d),
					new ExpectedCellValue(sheetName, 16, 7, 1194d),
					new ExpectedCellValue(sheetName, 17, 7, 99d),
					new ExpectedCellValue(sheetName, 20, 7, 1d),
					new ExpectedCellValue(sheetName, 21, 7, 2d),
					new ExpectedCellValue(sheetName, 23, 7, 24.99),
					new ExpectedCellValue(sheetName, 24, 7, 831.5),
					new ExpectedCellValue(sheetName, 25, 7, 15d),
					new ExpectedCellValue(sheetName, 26, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsTwoRowsAndNoColumnsSubtotalsOn()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F1:G32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "January"),
					new ExpectedCellValue(sheetName, 3, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 6, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 6, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 6, "February"),
					new ExpectedCellValue(sheetName, 14, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 20, 6, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 6, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 6, "March"),
					new ExpectedCellValue(sheetName, 23, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 28, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 6, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 6, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 6, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 4, 7, 2d),
					new ExpectedCellValue(sheetName, 5, 7, 2d),
					new ExpectedCellValue(sheetName, 6, 7, 1d),
					new ExpectedCellValue(sheetName, 8, 7, 831.5),
					new ExpectedCellValue(sheetName, 9, 7, 831.5),
					new ExpectedCellValue(sheetName, 10, 7, 415.75),
					new ExpectedCellValue(sheetName, 11, 7, 5d),
					new ExpectedCellValue(sheetName, 12, 7, 2078.75),
					new ExpectedCellValue(sheetName, 15, 7, 6d),
					new ExpectedCellValue(sheetName, 16, 7, 1d),
					new ExpectedCellValue(sheetName, 18, 7, 1194d),
					new ExpectedCellValue(sheetName, 19, 7, 99d),
					new ExpectedCellValue(sheetName, 20, 7, 7d),
					new ExpectedCellValue(sheetName, 21, 7, 1293d),
					new ExpectedCellValue(sheetName, 24, 7, 1d),
					new ExpectedCellValue(sheetName, 25, 7, 2d),
					new ExpectedCellValue(sheetName, 27, 7, 24.99),
					new ExpectedCellValue(sheetName, 28, 7, 831.5),
					new ExpectedCellValue(sheetName, 29, 7, 3d),
					new ExpectedCellValue(sheetName, 30, 7, 856.49),
					new ExpectedCellValue(sheetName, 31, 7, 15d),
					new ExpectedCellValue(sheetName, 32, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsTwoRowsAndNoColumnsLastColumnDataField()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K1:L33"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 11, "January"),
					new ExpectedCellValue(sheetName, 3, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 11, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 11, "February"),
					new ExpectedCellValue(sheetName, 15, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 19, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 11, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 11, "March"),
					new ExpectedCellValue(sheetName, 24, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 26, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 28, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 29, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 30, 11, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 31, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 32, 11, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 11, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 4, 12, 2d),
					new ExpectedCellValue(sheetName, 5, 12, 831.5d),
					new ExpectedCellValue(sheetName, 7, 12, 2d),
					new ExpectedCellValue(sheetName, 8, 12, 831.5d),
					new ExpectedCellValue(sheetName, 10, 12, 1d),
					new ExpectedCellValue(sheetName, 11, 12, 415.75d),
					new ExpectedCellValue(sheetName, 12, 12, 5d),
					new ExpectedCellValue(sheetName, 13, 12, 2078.75),
					new ExpectedCellValue(sheetName, 16, 12, 6d),
					new ExpectedCellValue(sheetName, 17, 12, 1194d),
					new ExpectedCellValue(sheetName, 19, 12, 1d),
					new ExpectedCellValue(sheetName, 20, 12, 99d),
					new ExpectedCellValue(sheetName, 21, 12, 7d),
					new ExpectedCellValue(sheetName, 22, 12, 1293d),
					new ExpectedCellValue(sheetName, 25, 12, 1d),
					new ExpectedCellValue(sheetName, 26, 12, 24.99),
					new ExpectedCellValue(sheetName, 28, 12, 2d),
					new ExpectedCellValue(sheetName, 29, 12, 831.5),
					new ExpectedCellValue(sheetName, 30, 12, 3d),
					new ExpectedCellValue(sheetName, 31, 12, 856.49),
					new ExpectedCellValue(sheetName, 32, 12, 15),
					new ExpectedCellValue(sheetName, 33, 12, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx")]
		public void PivotTableRefreshMultipleRowDataFieldsThreeRowsAndNoColumnsLastColumnDataField()
		{
			var file = new FileInfo("PivotTableWithMultipleRowDataFieldsNoColumnField.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P1:Q54"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 16, "January"),
					new ExpectedCellValue(sheetName, 3, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 16, "20100007"),
					new ExpectedCellValue(sheetName, 5, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 16, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 16, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 16, "20100090"),
					new ExpectedCellValue(sheetName, 11, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 16, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 16, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 16, "20100076"),
					new ExpectedCellValue(sheetName, 17, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 16, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 16, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 16, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 16, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 16, "February"),
					new ExpectedCellValue(sheetName, 24, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 25, 16, "20100070"),
					new ExpectedCellValue(sheetName, 26, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 27, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 16, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 29, 16, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 30, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 31, 16, "20100085"),
					new ExpectedCellValue(sheetName, 32, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 34, 16, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 35, 16, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 16, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 37, 16, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 16, "March"),
					new ExpectedCellValue(sheetName, 39, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 40, 16, "20100083"),
					new ExpectedCellValue(sheetName, 41, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 16, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 44, 16, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 46, 16, "20100017"),
					new ExpectedCellValue(sheetName, 47, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 48, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 49, 16, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 16, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 16, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 52, 16, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 53, 16, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 54, 16, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 17, 2d),
					new ExpectedCellValue(sheetName, 6, 17, 831.5d),
					new ExpectedCellValue(sheetName, 7, 17, 2d),
					new ExpectedCellValue(sheetName, 8, 17, 831.5d),
					new ExpectedCellValue(sheetName, 11, 17, 2d),
					new ExpectedCellValue(sheetName, 12, 17, 831.5d),
					new ExpectedCellValue(sheetName, 13, 17, 2d),
					new ExpectedCellValue(sheetName, 14, 17, 831.5d),
					new ExpectedCellValue(sheetName, 17, 17, 1d),
					new ExpectedCellValue(sheetName, 18, 17, 415.75d),
					new ExpectedCellValue(sheetName, 19, 17, 1d),
					new ExpectedCellValue(sheetName, 20, 17, 415.75d),
					new ExpectedCellValue(sheetName, 21, 17, 5d),
					new ExpectedCellValue(sheetName, 22, 17, 2078.75),
					new ExpectedCellValue(sheetName, 26, 17, 6d),
					new ExpectedCellValue(sheetName, 27, 17, 1194d),
					new ExpectedCellValue(sheetName, 28, 17, 6d),
					new ExpectedCellValue(sheetName, 29, 17, 1194d),
					new ExpectedCellValue(sheetName, 32, 17, 1d),
					new ExpectedCellValue(sheetName, 33, 17, 99d),
					new ExpectedCellValue(sheetName, 34, 17, 1d),
					new ExpectedCellValue(sheetName, 35, 17, 99d),
					new ExpectedCellValue(sheetName, 36, 17, 7d),
					new ExpectedCellValue(sheetName, 37, 17, 1293d),
					new ExpectedCellValue(sheetName, 41, 17, 1d),
					new ExpectedCellValue(sheetName, 42, 17, 24.99),
					new ExpectedCellValue(sheetName, 43, 17, 1d),
					new ExpectedCellValue(sheetName, 44, 17, 24.99),
					new ExpectedCellValue(sheetName, 47, 17, 2d),
					new ExpectedCellValue(sheetName, 48, 17, 831.5),
					new ExpectedCellValue(sheetName, 49, 17, 2d),
					new ExpectedCellValue(sheetName, 50, 17, 831.5),
					new ExpectedCellValue(sheetName, 51, 17, 3d),
					new ExpectedCellValue(sheetName, 52, 17, 856.49),
					new ExpectedCellValue(sheetName, 53, 17, 15),
					new ExpectedCellValue(sheetName, 54, 17, 4228.24)
				});
			}
		}

		#region Pivot Tables with page fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithPageFields.xlsx")]
		public void PivotTableRefreshWithPageFields()
		{
			var file = new FileInfo("PivotTableWithPageFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet1"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					pivotTable.PageFields[0].Item = 1;
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J9:M18"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 9, 11, "Column Labels"),
					new ExpectedCellValue(sheetName, 10, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 10, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 11, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 12, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 12, 99d),
					new ExpectedCellValue(sheetName, 12, 13, 99d),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 12, 1d),
					new ExpectedCellValue(sheetName, 13, 13, 1d),
					new ExpectedCellValue(sheetName, 14, 10, "Tent"),
					new ExpectedCellValue(sheetName, 15, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 11, 199d),
					new ExpectedCellValue(sheetName, 15, 13, 199d),
					new ExpectedCellValue(sheetName, 16, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 11, 6d),
					new ExpectedCellValue(sheetName, 16, 13, 6d),
					new ExpectedCellValue(sheetName, 17, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 11, 199d),
					new ExpectedCellValue(sheetName, 17, 12, 99d),
					new ExpectedCellValue(sheetName, 17, 13, 298d),
					new ExpectedCellValue(sheetName, 18, 10, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 11, 6d),
					new ExpectedCellValue(sheetName, 18, 12, 1d),
					new ExpectedCellValue(sheetName, 18, 13, 7d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithPageFields.xlsx")]
		public void PivotTableRefreshWithPageFieldsMultipleFilters()
		{
			var file = new FileInfo("PivotTableWithPageFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet1"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					pivotTable.PageFields[0].Item = 1;
					pivotTable.PageFields[1].Item = 2;
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J9:L15"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 9, 11, "Column Labels"),
					new ExpectedCellValue(sheetName, 10, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 10, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 11, 10, "Tent"),
					new ExpectedCellValue(sheetName, 12, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 11, 199d),
					new ExpectedCellValue(sheetName, 12, 12, 199d),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 11, 6d),
					new ExpectedCellValue(sheetName, 13, 12, 6d),
					new ExpectedCellValue(sheetName, 14, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 11, 199d),
					new ExpectedCellValue(sheetName, 14, 12, 199d),
					new ExpectedCellValue(sheetName, 15, 10, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 11, 6d),
					new ExpectedCellValue(sheetName, 15, 12, 6d),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithPageFields.xlsx")]
		public void PivotTableRefreshWithMultiSelectPageFields()
		{
			var file = new FileInfo("PivotTableWithPageFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet1"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					pivotTable.Fields[2].Items[1].Hidden = true;
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J9:N18"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 9, 11, "Column Labels"),
					new ExpectedCellValue(sheetName, 10, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 10, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 10, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 13, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 11, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 11, 415.75),
					new ExpectedCellValue(sheetName, 12, 12, 831.5),
					new ExpectedCellValue(sheetName, 12, 13, 415.75),
					new ExpectedCellValue(sheetName, 12, 14, 1663d),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 11, 2d),
					new ExpectedCellValue(sheetName, 13, 12, 4d),
					new ExpectedCellValue(sheetName, 13, 13, 1d),
					new ExpectedCellValue(sheetName, 13, 14, 7d),
					new ExpectedCellValue(sheetName, 14, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 15, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 11, 24.99),
					new ExpectedCellValue(sheetName, 15, 14, 24.99),
					new ExpectedCellValue(sheetName, 16, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 11, 1d),
					new ExpectedCellValue(sheetName, 16, 14, 1d),
					new ExpectedCellValue(sheetName, 17, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 11, 440.74),
					new ExpectedCellValue(sheetName, 17, 12, 831.5),
					new ExpectedCellValue(sheetName, 17, 13, 415.75),
					new ExpectedCellValue(sheetName, 17, 14, 1687.99),
					new ExpectedCellValue(sheetName, 18, 10, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 11, 3d),
					new ExpectedCellValue(sheetName, 18, 12, 4d),
					new ExpectedCellValue(sheetName, 18, 13, 1d),
					new ExpectedCellValue(sheetName, 18, 14, 8d)
				});
			}
		}
		#endregion
		#endregion

		#region Multiple Column Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAtLeafNode()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:I7"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "January"),
					new ExpectedCellValue(sheetName, 3, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 2, 2d),
					new ExpectedCellValue(sheetName, 5, 2, 2d),
					new ExpectedCellValue(sheetName, 6, 2, 1d),
					new ExpectedCellValue(sheetName, 7, 2, 5d),
					new ExpectedCellValue(sheetName, 3, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 3, 415.75),
					new ExpectedCellValue(sheetName, 5, 3, 415.75),
					new ExpectedCellValue(sheetName, 6, 3, 415.75),
					new ExpectedCellValue(sheetName, 7, 3, 1247.25),
					new ExpectedCellValue(sheetName, 2, 4, "February"),
					new ExpectedCellValue(sheetName, 3, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 4, 6d),
					new ExpectedCellValue(sheetName, 6, 4, 1d),
					new ExpectedCellValue(sheetName, 7, 4, 7d),
					new ExpectedCellValue(sheetName, 3, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 5, 199d),
					new ExpectedCellValue(sheetName, 6, 5, 99d),
					new ExpectedCellValue(sheetName, 7, 5, 298d),
					new ExpectedCellValue(sheetName, 2, 6, "March"),
					new ExpectedCellValue(sheetName, 3, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 6, 1d),
					new ExpectedCellValue(sheetName, 5, 6, 2d),
					new ExpectedCellValue(sheetName, 7, 6, 3d),
					new ExpectedCellValue(sheetName, 3, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 7, 24.99),
					new ExpectedCellValue(sheetName, 5, 7, 415.75),
					new ExpectedCellValue(sheetName, 7, 7, 440.74),
					new ExpectedCellValue(sheetName, 2, 8, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 8, 3d),
					new ExpectedCellValue(sheetName, 5, 8, 10d),
					new ExpectedCellValue(sheetName, 6, 8, 2d),
					new ExpectedCellValue(sheetName, 7, 8, 15d),
					new ExpectedCellValue(sheetName, 2, 9, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 9, 440.74),
					new ExpectedCellValue(sheetName, 5, 9, 1030.5),
					new ExpectedCellValue(sheetName, 6, 9, 514.75),
					new ExpectedCellValue(sheetName, 7, 9, 1985.99),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsParentRowDepthTwo()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A11:I17"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 14, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 15, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 12, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 2, "January"),
					new ExpectedCellValue(sheetName, 14, 2, 2d),
					new ExpectedCellValue(sheetName, 15, 2, 2d),
					new ExpectedCellValue(sheetName, 16, 2, 1d),
					new ExpectedCellValue(sheetName, 17, 2, 5d),
					new ExpectedCellValue(sheetName, 13, 3, "February"),
					new ExpectedCellValue(sheetName, 15, 3, 6d),
					new ExpectedCellValue(sheetName, 16, 3, 1d),
					new ExpectedCellValue(sheetName, 17, 3, 7d),
					new ExpectedCellValue(sheetName, 13, 4, "March"),
					new ExpectedCellValue(sheetName, 14, 4, 1d),
					new ExpectedCellValue(sheetName, 15, 4, 2d),
					new ExpectedCellValue(sheetName, 17, 4, 3d),
					new ExpectedCellValue(sheetName, 12, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 5, "January"),
					new ExpectedCellValue(sheetName, 14, 5, 415.75),
					new ExpectedCellValue(sheetName, 15, 5, 415.75),
					new ExpectedCellValue(sheetName, 16, 5, 415.75),
					new ExpectedCellValue(sheetName, 17, 5, 1247.25),
					new ExpectedCellValue(sheetName, 13, 6, "February"),
					new ExpectedCellValue(sheetName, 15, 6, 199d),
					new ExpectedCellValue(sheetName, 16, 6, 99d),
					new ExpectedCellValue(sheetName, 17, 6, 298d),
					new ExpectedCellValue(sheetName, 13, 7, "March"),
					new ExpectedCellValue(sheetName, 14, 7, 24.99),
					new ExpectedCellValue(sheetName, 15, 7, 415.75),
					new ExpectedCellValue(sheetName, 17, 7, 440.74),
					new ExpectedCellValue(sheetName, 12, 8, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 8, 3d),
					new ExpectedCellValue(sheetName, 15, 8, 10d),
					new ExpectedCellValue(sheetName, 16, 8, 2d),
					new ExpectedCellValue(sheetName, 17, 8, 15d),
					new ExpectedCellValue(sheetName, 12, 9, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 9, 440.74),
					new ExpectedCellValue(sheetName, 15, 9, 1030.5),
					new ExpectedCellValue(sheetName, 16, 9, 514.75),
					new ExpectedCellValue(sheetName, 17, 9, 1985.99),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsParentNodeColumnDepthThreeSubtotalsOn()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A21:W29"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 25, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 27, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 1, "Tent"),
					new ExpectedCellValue(sheetName, 29, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 22, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 24, 2, "January"),
					new ExpectedCellValue(sheetName, 25, 2, 2d),
					new ExpectedCellValue(sheetName, 29, 2, 2d),
					new ExpectedCellValue(sheetName, 24, 3, "March"),
					new ExpectedCellValue(sheetName, 26, 3, 1d),
					new ExpectedCellValue(sheetName, 29, 3, 1d),
					new ExpectedCellValue(sheetName, 23, 4, "Chicago Total"),
					new ExpectedCellValue(sheetName, 25, 4, 2d),
					new ExpectedCellValue(sheetName, 26, 4, 1d),
					new ExpectedCellValue(sheetName, 29, 4, 3d),
					new ExpectedCellValue(sheetName, 23, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 5, "January"),
					new ExpectedCellValue(sheetName, 25, 5, 2d),
					new ExpectedCellValue(sheetName, 29, 5, 2d),
					new ExpectedCellValue(sheetName, 24, 6, "February"),
					new ExpectedCellValue(sheetName, 28, 6, 6d),
					new ExpectedCellValue(sheetName, 29, 6, 6d),
					new ExpectedCellValue(sheetName, 24, 7, "March"),
					new ExpectedCellValue(sheetName, 25, 7, 2d),
					new ExpectedCellValue(sheetName, 29, 7, 2d),
					new ExpectedCellValue(sheetName, 23, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 25, 8, 4d),
					new ExpectedCellValue(sheetName, 28, 8, 6d),
					new ExpectedCellValue(sheetName, 29, 8, 10d),
					new ExpectedCellValue(sheetName, 23, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 9, "January"),
					new ExpectedCellValue(sheetName, 25, 9, 1d),
					new ExpectedCellValue(sheetName, 29, 9, 1d),
					new ExpectedCellValue(sheetName, 24, 10, "February"),
					new ExpectedCellValue(sheetName, 27, 10, 1d),
					new ExpectedCellValue(sheetName, 29, 10, 1d),
					new ExpectedCellValue(sheetName, 23, 11, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 25, 11, 1d),
					new ExpectedCellValue(sheetName, 27, 11, 1d),
					new ExpectedCellValue(sheetName, 29, 11, 2d),
					new ExpectedCellValue(sheetName, 22, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 23, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 24, 12, "January"),
					new ExpectedCellValue(sheetName, 25, 12, 415.75),
					new ExpectedCellValue(sheetName, 29, 12, 415.75),
					new ExpectedCellValue(sheetName, 24, 13, "March"),
					new ExpectedCellValue(sheetName, 26, 13, 24.99),
					new ExpectedCellValue(sheetName, 29, 13, 24.99),
					new ExpectedCellValue(sheetName, 23, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 25, 14, 415.75),
					new ExpectedCellValue(sheetName, 26, 14, 24.99),
					new ExpectedCellValue(sheetName, 29, 14, 440.74),
					new ExpectedCellValue(sheetName, 23, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 15, "January"),
					new ExpectedCellValue(sheetName, 25, 15, 415.75),
					new ExpectedCellValue(sheetName, 29, 15, 415.75),
					new ExpectedCellValue(sheetName, 24, 16, "February"),
					new ExpectedCellValue(sheetName, 28, 16, 199d),
					new ExpectedCellValue(sheetName, 29, 16, 199d),
					new ExpectedCellValue(sheetName, 24, 17, "March"),
					new ExpectedCellValue(sheetName, 25, 17, 415.75),
					new ExpectedCellValue(sheetName, 29, 17, 415.75),
					new ExpectedCellValue(sheetName, 23, 18, "Nashville Total"),
					new ExpectedCellValue(sheetName, 25, 18, 831.5),
					new ExpectedCellValue(sheetName, 28, 18, 199d),
					new ExpectedCellValue(sheetName, 29, 18, 1030.5),
					new ExpectedCellValue(sheetName, 23, 19, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 19, "January"),
					new ExpectedCellValue(sheetName, 25, 19, 415.75),
					new ExpectedCellValue(sheetName, 29, 19, 415.75),
					new ExpectedCellValue(sheetName, 24, 20, "February"),
					new ExpectedCellValue(sheetName, 27, 20, 99d),
					new ExpectedCellValue(sheetName, 29, 20, 99d),
					new ExpectedCellValue(sheetName, 23, 21, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 25, 21, 415.75),
					new ExpectedCellValue(sheetName, 27, 21, 99d),
					new ExpectedCellValue(sheetName, 29, 21, 514.75),
					new ExpectedCellValue(sheetName, 22, 22, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 22, 7d),
					new ExpectedCellValue(sheetName, 26, 22, 1d),
					new ExpectedCellValue(sheetName, 27, 22, 1d),
					new ExpectedCellValue(sheetName, 28, 22, 6d),
					new ExpectedCellValue(sheetName, 29, 22, 15d),
					new ExpectedCellValue(sheetName, 22, 23, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 23, 1663d),
					new ExpectedCellValue(sheetName, 26, 23, 24.99),
					new ExpectedCellValue(sheetName, 27, 23, 99d),
					new ExpectedCellValue(sheetName, 28, 23, 199d),
					new ExpectedCellValue(sheetName, 29, 23, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsParentNodeColumnDepthThreeSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A21:Q29"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 25, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 27, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 1, "Tent"),
					new ExpectedCellValue(sheetName, 29, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 22, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 24, 2, "January"),
					new ExpectedCellValue(sheetName, 25, 2, 2d),
					new ExpectedCellValue(sheetName, 29, 2, 2d),
					new ExpectedCellValue(sheetName, 24, 3, "March"),
					new ExpectedCellValue(sheetName, 26, 3, 1d),
					new ExpectedCellValue(sheetName, 29, 3, 1d),
					new ExpectedCellValue(sheetName, 23, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 4, "January"),
					new ExpectedCellValue(sheetName, 25, 4, 2d),
					new ExpectedCellValue(sheetName, 29, 4, 2d),
					new ExpectedCellValue(sheetName, 24, 5, "February"),
					new ExpectedCellValue(sheetName, 28, 5, 6d),
					new ExpectedCellValue(sheetName, 29, 5, 6d),
					new ExpectedCellValue(sheetName, 24, 6, "March"),
					new ExpectedCellValue(sheetName, 25, 6, 2d),
					new ExpectedCellValue(sheetName, 29, 6, 2d),
					new ExpectedCellValue(sheetName, 23, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 7, "January"),
					new ExpectedCellValue(sheetName, 25, 7, 1d),
					new ExpectedCellValue(sheetName, 29, 7, 1d),
					new ExpectedCellValue(sheetName, 24, 8, "February"),
					new ExpectedCellValue(sheetName, 27, 8, 1d),
					new ExpectedCellValue(sheetName, 29, 8, 1d),
					new ExpectedCellValue(sheetName, 22, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 23, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 24, 9, "January"),
					new ExpectedCellValue(sheetName, 25, 9, 415.75),
					new ExpectedCellValue(sheetName, 29, 9, 415.75),
					new ExpectedCellValue(sheetName, 24, 10, "March"),
					new ExpectedCellValue(sheetName, 26, 10, 24.99),
					new ExpectedCellValue(sheetName, 29, 10, 24.99),
					new ExpectedCellValue(sheetName, 23, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 11, "January"),
					new ExpectedCellValue(sheetName, 25, 11, 415.75),
					new ExpectedCellValue(sheetName, 29, 11, 415.75),
					new ExpectedCellValue(sheetName, 24, 12, "February"),
					new ExpectedCellValue(sheetName, 28, 12, 199d),
					new ExpectedCellValue(sheetName, 29, 12, 199d),
					new ExpectedCellValue(sheetName, 24, 13, "March"),
					new ExpectedCellValue(sheetName, 25, 13, 415.75),
					new ExpectedCellValue(sheetName, 29, 13, 415.75),
					new ExpectedCellValue(sheetName, 23, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 14, "January"),
					new ExpectedCellValue(sheetName, 25, 14, 415.75),
					new ExpectedCellValue(sheetName, 29, 14, 415.75),
					new ExpectedCellValue(sheetName, 24, 15, "February"),
					new ExpectedCellValue(sheetName, 27, 15, 99d),
					new ExpectedCellValue(sheetName, 29, 15, 99d),
					new ExpectedCellValue(sheetName, 22, 16, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 16, 7d),
					new ExpectedCellValue(sheetName, 26, 16, 1d),
					new ExpectedCellValue(sheetName, 27, 16, 1d),
					new ExpectedCellValue(sheetName, 28, 16, 6d),
					new ExpectedCellValue(sheetName, 29, 16, 15d),
					new ExpectedCellValue(sheetName, 22, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 17, 1663d),
					new ExpectedCellValue(sheetName, 26, 17, 24.99),
					new ExpectedCellValue(sheetName, 27, 17, 99d),
					new ExpectedCellValue(sheetName, 28, 17, 199d),
					new ExpectedCellValue(sheetName, 29, 17, 1985.99),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsInnerChildSubtotalsOn()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A33:S40"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 37, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 38, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 39, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 34, 2, "January"),
					new ExpectedCellValue(sheetName, 35, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 37, 2, 2d),
					new ExpectedCellValue(sheetName, 38, 2, 2d),
					new ExpectedCellValue(sheetName, 39, 2, 1d),
					new ExpectedCellValue(sheetName, 40, 2, 5d),
					new ExpectedCellValue(sheetName, 35, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 37, 3, 415.75),
					new ExpectedCellValue(sheetName, 38, 3, 415.75),
					new ExpectedCellValue(sheetName, 39, 3, 415.75),
					new ExpectedCellValue(sheetName, 40, 3, 1247.25),
					new ExpectedCellValue(sheetName, 34, 4, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 37, 4, 2d),
					new ExpectedCellValue(sheetName, 38, 4, 2d),
					new ExpectedCellValue(sheetName, 39, 4, 1d),
					new ExpectedCellValue(sheetName, 40, 4, 5d),
					new ExpectedCellValue(sheetName, 34, 5, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 5, 415.75),
					new ExpectedCellValue(sheetName, 38, 5, 415.75),
					new ExpectedCellValue(sheetName, 39, 5, 415.75),
					new ExpectedCellValue(sheetName, 40, 5, 1247.25),
					new ExpectedCellValue(sheetName, 34, 6, "February"),
					new ExpectedCellValue(sheetName, 35, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 39, 6, 1d),
					new ExpectedCellValue(sheetName, 40, 6, 1d),
					new ExpectedCellValue(sheetName, 36, 7, "Tent"),
					new ExpectedCellValue(sheetName, 38, 7, 6d),
					new ExpectedCellValue(sheetName, 40, 7, 6d),
					new ExpectedCellValue(sheetName, 35, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 39, 8, 99d),
					new ExpectedCellValue(sheetName, 40, 8, 99d),
					new ExpectedCellValue(sheetName, 36, 9, "Tent"),
					new ExpectedCellValue(sheetName, 38, 9, 199d),
					new ExpectedCellValue(sheetName, 40, 9, 199d),
					new ExpectedCellValue(sheetName, 34, 10, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 10, 6d),
					new ExpectedCellValue(sheetName, 39, 10, 1d),
					new ExpectedCellValue(sheetName, 40, 10, 7d),
					new ExpectedCellValue(sheetName, 34, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 38, 11, 199d),
					new ExpectedCellValue(sheetName, 39, 11, 99d),
					new ExpectedCellValue(sheetName, 40, 11, 298d),
					new ExpectedCellValue(sheetName, 34, 12, "March"),
					new ExpectedCellValue(sheetName, 35, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 12, 2d),
					new ExpectedCellValue(sheetName, 40, 12, 2d),
					new ExpectedCellValue(sheetName, 36, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 37, 13, 1d),
					new ExpectedCellValue(sheetName, 40, 13, 1d),
					new ExpectedCellValue(sheetName, 35, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 14, 415.75),
					new ExpectedCellValue(sheetName, 40, 14, 415.75),
					new ExpectedCellValue(sheetName, 36, 15, "Headlamp"),
					new ExpectedCellValue(sheetName, 37, 15, 24.99),
					new ExpectedCellValue(sheetName, 40, 15, 24.99),
					new ExpectedCellValue(sheetName, 34, 16, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 37, 16, 1d),
					new ExpectedCellValue(sheetName, 38, 16, 2d),
					new ExpectedCellValue(sheetName, 40, 16, 3d),
					new ExpectedCellValue(sheetName, 34, 17, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 17, 24.99),
					new ExpectedCellValue(sheetName, 38, 17, 415.75),
					new ExpectedCellValue(sheetName, 40, 17, 440.74),
					new ExpectedCellValue(sheetName, 34, 18, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 37, 18, 3d),
					new ExpectedCellValue(sheetName, 38, 18, 10d),
					new ExpectedCellValue(sheetName, 39, 18, 2d),
					new ExpectedCellValue(sheetName, 40, 18, 15d),
					new ExpectedCellValue(sheetName, 34, 19, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 19, 440.74),
					new ExpectedCellValue(sheetName, 38, 19, 1030.5),
					new ExpectedCellValue(sheetName, 39, 19, 514.75),
					new ExpectedCellValue(sheetName, 40, 19, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsInnerChildSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A33:M40"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 37, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 38, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 39, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 34, 2, "January"),
					new ExpectedCellValue(sheetName, 35, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 37, 2, 2d),
					new ExpectedCellValue(sheetName, 38, 2, 2d),
					new ExpectedCellValue(sheetName, 39, 2, 1d),
					new ExpectedCellValue(sheetName, 40, 2, 5d),
					new ExpectedCellValue(sheetName, 35, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 37, 3, 415.75),
					new ExpectedCellValue(sheetName, 38, 3, 415.75),
					new ExpectedCellValue(sheetName, 39, 3, 415.75),
					new ExpectedCellValue(sheetName, 40, 3, 1247.25),
					new ExpectedCellValue(sheetName, 34, 4, "February"),
					new ExpectedCellValue(sheetName, 35, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 39, 4, 1d),
					new ExpectedCellValue(sheetName, 40, 4, 1d),
					new ExpectedCellValue(sheetName, 36, 5, "Tent"),
					new ExpectedCellValue(sheetName, 38, 5, 6d),
					new ExpectedCellValue(sheetName, 40, 5, 6d),
					new ExpectedCellValue(sheetName, 35, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 39, 6, 99d),
					new ExpectedCellValue(sheetName, 40, 6, 99d),
					new ExpectedCellValue(sheetName, 36, 7, "Tent"),
					new ExpectedCellValue(sheetName, 38, 7, 199d),
					new ExpectedCellValue(sheetName, 40, 7, 199d),
					new ExpectedCellValue(sheetName, 34, 8, "March"),
					new ExpectedCellValue(sheetName, 35, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 8, 2d),
					new ExpectedCellValue(sheetName, 40, 8, 2d),
					new ExpectedCellValue(sheetName, 36, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 37, 9, 1d),
					new ExpectedCellValue(sheetName, 40, 9, 1d),
					new ExpectedCellValue(sheetName, 35, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 10, 415.75),
					new ExpectedCellValue(sheetName, 40, 10, 415.75),
					new ExpectedCellValue(sheetName, 36, 11, "Headlamp"),
					new ExpectedCellValue(sheetName, 37, 11, 24.99),
					new ExpectedCellValue(sheetName, 40, 11, 24.99),
					new ExpectedCellValue(sheetName, 34, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 37, 12, 3d),
					new ExpectedCellValue(sheetName, 38, 12, 10d),
					new ExpectedCellValue(sheetName, 39, 12, 2d),
					new ExpectedCellValue(sheetName, 40, 12, 15d),
					new ExpectedCellValue(sheetName, 34, 13, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 13, 440.74),
					new ExpectedCellValue(sheetName, 38, 13, 1030.5),
					new ExpectedCellValue(sheetName, 39, 13, 514.75),
					new ExpectedCellValue(sheetName, 40, 13, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsFirstInnerChildSubtotalsOn()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A44:AK56"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 49, 1, 20100007),
					new ExpectedCellValue(sheetName, 50, 1, 20100017),
					new ExpectedCellValue(sheetName, 51, 1, 20100070),
					new ExpectedCellValue(sheetName, 52, 1, 20100076),
					new ExpectedCellValue(sheetName, 53, 1, 20100083),
					new ExpectedCellValue(sheetName, 54, 1, 20100085),
					new ExpectedCellValue(sheetName, 55, 1, 20100090),
					new ExpectedCellValue(sheetName, 56, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 45, 2, "January"),
					new ExpectedCellValue(sheetName, 46, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 47, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 2, 2d),
					new ExpectedCellValue(sheetName, 56, 2, 2d),
					new ExpectedCellValue(sheetName, 47, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 49, 3, 2d),
					new ExpectedCellValue(sheetName, 56, 3, 2d),
					new ExpectedCellValue(sheetName, 47, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 4, 2d),
					new ExpectedCellValue(sheetName, 56, 4, 2d),
					new ExpectedCellValue(sheetName, 47, 5, "Nashville Total"),
					new ExpectedCellValue(sheetName, 55, 5, 2d),
					new ExpectedCellValue(sheetName, 56, 5, 2d),
					new ExpectedCellValue(sheetName, 47, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 6, 1d),
					new ExpectedCellValue(sheetName, 56, 6, 1d),
					new ExpectedCellValue(sheetName, 47, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 52, 7, 1d),
					new ExpectedCellValue(sheetName, 56, 7, 1d),
					new ExpectedCellValue(sheetName, 46, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 8, 415.75),
					new ExpectedCellValue(sheetName, 56, 8, 415.75),
					new ExpectedCellValue(sheetName, 47, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 49, 9, 415.75),
					new ExpectedCellValue(sheetName, 56, 9, 415.75),
					new ExpectedCellValue(sheetName, 47, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 10, 415.75),
					new ExpectedCellValue(sheetName, 56, 10, 415.75),
					new ExpectedCellValue(sheetName, 47, 11, "Nashville Total"),
					new ExpectedCellValue(sheetName, 55, 11, 415.75),
					new ExpectedCellValue(sheetName, 56, 11, 415.75),
					new ExpectedCellValue(sheetName, 47, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 12, 415.75),
					new ExpectedCellValue(sheetName, 56, 12, 415.75),
					new ExpectedCellValue(sheetName, 47, 13, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 52, 13, 415.75),
					new ExpectedCellValue(sheetName, 56, 13, 415.75),
					new ExpectedCellValue(sheetName, 45, 14, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 14, 2d),
					new ExpectedCellValue(sheetName, 52, 14, 1d),
					new ExpectedCellValue(sheetName, 55, 14, 2d),
					new ExpectedCellValue(sheetName, 56, 14, 5d),
					new ExpectedCellValue(sheetName, 45, 15, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 15, 415.75),
					new ExpectedCellValue(sheetName, 52, 15, 415.75),
					new ExpectedCellValue(sheetName, 55, 15, 415.75),
					new ExpectedCellValue(sheetName, 56, 15, 1247.25),
					new ExpectedCellValue(sheetName, 45, 16, "February"),
					new ExpectedCellValue(sheetName, 46, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 47, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 16, "Tent"),
					new ExpectedCellValue(sheetName, 51, 16, 6d),
					new ExpectedCellValue(sheetName, 56, 16, 6d),
					new ExpectedCellValue(sheetName, 47, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 51, 17, 6d),
					new ExpectedCellValue(sheetName, 56, 17, 6d),
					new ExpectedCellValue(sheetName, 47, 18, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 54, 18, 1d),
					new ExpectedCellValue(sheetName, 56, 18, 1d),
					new ExpectedCellValue(sheetName, 47, 19, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 54, 19, 1d),
					new ExpectedCellValue(sheetName, 56, 19, 1d),
					new ExpectedCellValue(sheetName, 46, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 20, "Tent"),
					new ExpectedCellValue(sheetName, 51, 20, 199d),
					new ExpectedCellValue(sheetName, 56, 20, 199d),
					new ExpectedCellValue(sheetName, 47, 21, "Nashville Total"),
					new ExpectedCellValue(sheetName, 51, 21, 199d),
					new ExpectedCellValue(sheetName, 56, 21, 199d),
					new ExpectedCellValue(sheetName, 47, 22, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 54, 22, 99d),
					new ExpectedCellValue(sheetName, 56, 22, 99d),
					new ExpectedCellValue(sheetName, 47, 23, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 54, 23, 99d),
					new ExpectedCellValue(sheetName, 56, 23, 99d),
					new ExpectedCellValue(sheetName, 45, 24, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 51, 24, 6d),
					new ExpectedCellValue(sheetName, 54, 24, 1d),
					new ExpectedCellValue(sheetName, 56, 24, 7d),
					new ExpectedCellValue(sheetName, 45, 25, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 25, 199d),
					new ExpectedCellValue(sheetName, 54, 25, 99d),
					new ExpectedCellValue(sheetName, 56, 25, 298d),
					new ExpectedCellValue(sheetName, 45, 26, "March"),
					new ExpectedCellValue(sheetName, 46, 26, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 47, 26, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 53, 26, 1d),
					new ExpectedCellValue(sheetName, 56, 26, 1d),
					new ExpectedCellValue(sheetName, 47, 27, "Chicago Total"),
					new ExpectedCellValue(sheetName, 53, 27, 1d),
					new ExpectedCellValue(sheetName, 56, 27, 1d),
					new ExpectedCellValue(sheetName, 47, 28, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 28, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 28, 2d),
					new ExpectedCellValue(sheetName, 56, 28, 2d),
					new ExpectedCellValue(sheetName, 47, 29, "Nashville Total"),
					new ExpectedCellValue(sheetName, 50, 29, 2d),
					new ExpectedCellValue(sheetName, 56, 29, 2d),
					new ExpectedCellValue(sheetName, 46, 30, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 30, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 30, "Headlamp"),
					new ExpectedCellValue(sheetName, 53, 30, 24.99),
					new ExpectedCellValue(sheetName, 56, 30, 24.99),
					new ExpectedCellValue(sheetName, 47, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 53, 31, 24.99),
					new ExpectedCellValue(sheetName, 56, 31, 24.99),
					new ExpectedCellValue(sheetName, 47, 32, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 32, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 32, 415.75),
					new ExpectedCellValue(sheetName, 56, 32, 415.75),
					new ExpectedCellValue(sheetName, 47, 33, "Nashville Total"),
					new ExpectedCellValue(sheetName, 50, 33, 415.75),
					new ExpectedCellValue(sheetName, 56, 33, 415.75),
					new ExpectedCellValue(sheetName, 45, 34, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 34, 2d),
					new ExpectedCellValue(sheetName, 53, 34, 1d),
					new ExpectedCellValue(sheetName, 56, 34, 3d),
					new ExpectedCellValue(sheetName, 45, 35, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 35, 415.75),
					new ExpectedCellValue(sheetName, 53, 35, 24.99),
					new ExpectedCellValue(sheetName, 56, 35, 440.74),
					new ExpectedCellValue(sheetName, 45, 36, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 36, 2d),
					new ExpectedCellValue(sheetName, 50, 36, 2d),
					new ExpectedCellValue(sheetName, 51, 36, 6d),
					new ExpectedCellValue(sheetName, 52, 36, 1d),
					new ExpectedCellValue(sheetName, 53, 36, 1d),
					new ExpectedCellValue(sheetName, 54, 36, 1d),
					new ExpectedCellValue(sheetName, 55, 36, 2d),
					new ExpectedCellValue(sheetName, 56, 36, 15d),
					new ExpectedCellValue(sheetName, 45, 37, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 37, 415.75),
					new ExpectedCellValue(sheetName, 50, 37, 415.75),
					new ExpectedCellValue(sheetName, 51, 37, 199d),
					new ExpectedCellValue(sheetName, 52, 37, 415.75),
					new ExpectedCellValue(sheetName, 53, 37, 24.99),
					new ExpectedCellValue(sheetName, 54, 37, 99d),
					new ExpectedCellValue(sheetName, 55, 37, 415.75),
					new ExpectedCellValue(sheetName, 56, 37, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsFirstInnerChildSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A44:Q56"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(7, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 49, 1, 20100007),
					new ExpectedCellValue(sheetName, 50, 1, 20100017),
					new ExpectedCellValue(sheetName, 51, 1, 20100070),
					new ExpectedCellValue(sheetName, 52, 1, 20100076),
					new ExpectedCellValue(sheetName, 53, 1, 20100083),
					new ExpectedCellValue(sheetName, 54, 1, 20100085),
					new ExpectedCellValue(sheetName, 55, 1, 20100090),
					new ExpectedCellValue(sheetName, 56, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 45, 2, "January"),
					new ExpectedCellValue(sheetName, 46, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 47, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 2, 2d),
					new ExpectedCellValue(sheetName, 56, 2, 2d),
					new ExpectedCellValue(sheetName, 47, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 3, 2d),
					new ExpectedCellValue(sheetName, 56, 3, 2d),
					new ExpectedCellValue(sheetName, 47, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 4, 1d),
					new ExpectedCellValue(sheetName, 56, 4, 1d),
					new ExpectedCellValue(sheetName, 46, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 5, 415.75),
					new ExpectedCellValue(sheetName, 56, 5, 415.75),
					new ExpectedCellValue(sheetName, 47, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 6, 415.75),
					new ExpectedCellValue(sheetName, 56, 6, 415.75),
					new ExpectedCellValue(sheetName, 47, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 7, 415.75),
					new ExpectedCellValue(sheetName, 56, 7, 415.75),
					new ExpectedCellValue(sheetName, 45, 8, "February"),
					new ExpectedCellValue(sheetName, 46, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 47, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 8, "Tent"),
					new ExpectedCellValue(sheetName, 51, 8, 6d),
					new ExpectedCellValue(sheetName, 56, 8, 6d),
					new ExpectedCellValue(sheetName, 47, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 54, 9, 1d),
					new ExpectedCellValue(sheetName, 56, 9, 1d),
					new ExpectedCellValue(sheetName, 46, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 10, "Tent"),
					new ExpectedCellValue(sheetName, 51, 10, 199d),
					new ExpectedCellValue(sheetName, 56, 10, 199d),
					new ExpectedCellValue(sheetName, 47, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 54, 11, 99d),
					new ExpectedCellValue(sheetName, 56, 11, 99d),
					new ExpectedCellValue(sheetName, 45, 12, "March"),
					new ExpectedCellValue(sheetName, 46, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 47, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 53, 12, 1d),
					new ExpectedCellValue(sheetName, 56, 12, 1d),
					new ExpectedCellValue(sheetName, 47, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 13, 2d),
					new ExpectedCellValue(sheetName, 56, 13, 2d),
					new ExpectedCellValue(sheetName, 46, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 48, 14, "Headlamp"),
					new ExpectedCellValue(sheetName, 53, 14, 24.99),
					new ExpectedCellValue(sheetName, 56, 14, 24.99),
					new ExpectedCellValue(sheetName, 47, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 15, 415.75),
					new ExpectedCellValue(sheetName, 56, 15, 415.75),
					new ExpectedCellValue(sheetName, 45, 16, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 16, 2d),
					new ExpectedCellValue(sheetName, 50, 16, 2d),
					new ExpectedCellValue(sheetName, 51, 16, 6d),
					new ExpectedCellValue(sheetName, 52, 16, 1d),
					new ExpectedCellValue(sheetName, 53, 16, 1d),
					new ExpectedCellValue(sheetName, 54, 16, 1d),
					new ExpectedCellValue(sheetName, 55, 16, 2d),
					new ExpectedCellValue(sheetName, 56, 16, 15d),
					new ExpectedCellValue(sheetName, 45, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 17, 415.75),
					new ExpectedCellValue(sheetName, 50, 17, 415.75),
					new ExpectedCellValue(sheetName, 51, 17, 199d),
					new ExpectedCellValue(sheetName, 52, 17, 415.75),
					new ExpectedCellValue(sheetName, 53, 17, 24.99),
					new ExpectedCellValue(sheetName, 54, 17, 99d),
					new ExpectedCellValue(sheetName, 55, 17, 415.75),
					new ExpectedCellValue(sheetName, 56, 17, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsLastInnerChildSubtotalsOn()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A60:AK72"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 1, 20100007),
					new ExpectedCellValue(sheetName, 66, 1, 20100017),
					new ExpectedCellValue(sheetName, 67, 1, 20100070),
					new ExpectedCellValue(sheetName, 68, 1, 20100076),
					new ExpectedCellValue(sheetName, 69, 1, 20100083),
					new ExpectedCellValue(sheetName, 70, 1, 20100085),
					new ExpectedCellValue(sheetName, 71, 1, 20100090),
					new ExpectedCellValue(sheetName, 72, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 61, 2, "January"),
					new ExpectedCellValue(sheetName, 62, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 2, 2d),
					new ExpectedCellValue(sheetName, 72, 2, 2d),
					new ExpectedCellValue(sheetName, 63, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 3, 415.75),
					new ExpectedCellValue(sheetName, 72, 3, 415.75),
					new ExpectedCellValue(sheetName, 62, 4, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 65, 4, 2d),
					new ExpectedCellValue(sheetName, 72, 4, 2d),
					new ExpectedCellValue(sheetName, 62, 5, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 65, 5, 415.75),
					new ExpectedCellValue(sheetName, 72, 5, 415.75),
					new ExpectedCellValue(sheetName, 62, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 71, 6, 2d),
					new ExpectedCellValue(sheetName, 72, 6, 2d),
					new ExpectedCellValue(sheetName, 63, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 71, 7, 415.75),
					new ExpectedCellValue(sheetName, 72, 7, 415.75),
					new ExpectedCellValue(sheetName, 62, 8, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 71, 8, 2d),
					new ExpectedCellValue(sheetName, 72, 8, 2d),
					new ExpectedCellValue(sheetName, 62, 9, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 9, 415.75),
					new ExpectedCellValue(sheetName, 72, 9, 415.75),
					new ExpectedCellValue(sheetName, 62, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 10, 1d),
					new ExpectedCellValue(sheetName, 72, 10, 1d),
					new ExpectedCellValue(sheetName, 63, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 11, 415.75),
					new ExpectedCellValue(sheetName, 72, 11, 415.75),
					new ExpectedCellValue(sheetName, 62, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 68, 12, 1d),
					new ExpectedCellValue(sheetName, 72, 12, 1d),
					new ExpectedCellValue(sheetName, 62, 13, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 68, 13, 415.75),
					new ExpectedCellValue(sheetName, 72, 13, 415.75),
					new ExpectedCellValue(sheetName, 61, 14, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 65, 14, 2d),
					new ExpectedCellValue(sheetName, 68, 14, 1d),
					new ExpectedCellValue(sheetName, 71, 14, 2d),
					new ExpectedCellValue(sheetName, 72, 14, 5d),
					new ExpectedCellValue(sheetName, 61, 15, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 65, 15, 415.75),
					new ExpectedCellValue(sheetName, 68, 15, 415.75),
					new ExpectedCellValue(sheetName, 71, 15, 415.75),
					new ExpectedCellValue(sheetName, 72, 15, 1247.25),
					new ExpectedCellValue(sheetName, 61, 16, "February"),
					new ExpectedCellValue(sheetName, 62, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 16, "Tent"),
					new ExpectedCellValue(sheetName, 67, 16, 6d),
					new ExpectedCellValue(sheetName, 72, 16, 6d),
					new ExpectedCellValue(sheetName, 63, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 17, "Tent"),
					new ExpectedCellValue(sheetName, 67, 17, 199d),
					new ExpectedCellValue(sheetName, 72, 17, 199d),
					new ExpectedCellValue(sheetName, 62, 18, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 67, 18, 6d),
					new ExpectedCellValue(sheetName, 72, 18, 6d),
					new ExpectedCellValue(sheetName, 62, 19, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 67, 19, 199d),
					new ExpectedCellValue(sheetName, 72, 19, 199d),
					new ExpectedCellValue(sheetName, 62, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 20, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 20, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 70, 20, 1d),
					new ExpectedCellValue(sheetName, 72, 20, 1d),
					new ExpectedCellValue(sheetName, 63, 21, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 21, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 70, 21, 99d),
					new ExpectedCellValue(sheetName, 72, 21, 99d),
					new ExpectedCellValue(sheetName, 62, 22, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 70, 22, 1d),
					new ExpectedCellValue(sheetName, 72, 22, 1d),
					new ExpectedCellValue(sheetName, 62, 23, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 70, 23, 99d),
					new ExpectedCellValue(sheetName, 72, 23, 99d),
					new ExpectedCellValue(sheetName, 61, 24, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 67, 24, 6d),
					new ExpectedCellValue(sheetName, 70, 24, 1d),
					new ExpectedCellValue(sheetName, 72, 24, 7d),
					new ExpectedCellValue(sheetName, 61, 25, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 67, 25, 199d),
					new ExpectedCellValue(sheetName, 70, 25, 99d),
					new ExpectedCellValue(sheetName, 72, 25, 298d),
					new ExpectedCellValue(sheetName, 61, 26, "March"),
					new ExpectedCellValue(sheetName, 62, 26, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 26, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 69, 26, 1d),
					new ExpectedCellValue(sheetName, 72, 26, 1d),
					new ExpectedCellValue(sheetName, 63, 27, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 27, "Headlamp"),
					new ExpectedCellValue(sheetName, 69, 27, 24.99),
					new ExpectedCellValue(sheetName, 72, 27, 24.99),
					new ExpectedCellValue(sheetName, 62, 28, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 69, 28, 1d),
					new ExpectedCellValue(sheetName, 72, 28, 1d),
					new ExpectedCellValue(sheetName, 62, 29, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 29, 24.99),
					new ExpectedCellValue(sheetName, 72, 29, 24.99),
					new ExpectedCellValue(sheetName, 62, 30, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 30, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 30, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 30, 2d),
					new ExpectedCellValue(sheetName, 72, 30, 2d),
					new ExpectedCellValue(sheetName, 63, 31, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 31, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 31, 415.75),
					new ExpectedCellValue(sheetName, 72, 31, 415.75),
					new ExpectedCellValue(sheetName, 62, 32, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 66, 32, 2d),
					new ExpectedCellValue(sheetName, 72, 32, 2d),
					new ExpectedCellValue(sheetName, 62, 33, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 66, 33, 415.75),
					new ExpectedCellValue(sheetName, 72, 33, 415.75),
					new ExpectedCellValue(sheetName, 61, 34, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 66, 34, 2d),
					new ExpectedCellValue(sheetName, 69, 34, 1d),
					new ExpectedCellValue(sheetName, 72, 34, 3d),
					new ExpectedCellValue(sheetName, 61, 35, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 66, 35, 415.75),
					new ExpectedCellValue(sheetName, 69, 35, 24.99),
					new ExpectedCellValue(sheetName, 72, 35, 440.74),
					new ExpectedCellValue(sheetName, 61, 36, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 65, 36, 2d),
					new ExpectedCellValue(sheetName, 66, 36, 2d),
					new ExpectedCellValue(sheetName, 67, 36, 6d),
					new ExpectedCellValue(sheetName, 68, 36, 1d),
					new ExpectedCellValue(sheetName, 69, 36, 1d),
					new ExpectedCellValue(sheetName, 70, 36, 1d),
					new ExpectedCellValue(sheetName, 71, 36, 2d),
					new ExpectedCellValue(sheetName, 72, 36, 15d),
					new ExpectedCellValue(sheetName, 61, 37, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 65, 37, 415.75),
					new ExpectedCellValue(sheetName, 66, 37, 415.75),
					new ExpectedCellValue(sheetName, 67, 37, 199d),
					new ExpectedCellValue(sheetName, 68, 37, 415.75),
					new ExpectedCellValue(sheetName, 69, 37, 24.99),
					new ExpectedCellValue(sheetName, 70, 37, 99d),
					new ExpectedCellValue(sheetName, 71, 37, 415.75),
					new ExpectedCellValue(sheetName, 72, 37, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableWithMultipleColumnDataFields.xlsx")]
		public void PivotTableRefreshMultipleColumnDataFieldsAsLastInnerChildSubtotalsOff()
		{
			var file = new FileInfo("PivotTableWithMultipleColumnDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.None;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A60:Q72"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(7, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 1, 20100007),
					new ExpectedCellValue(sheetName, 66, 1, 20100017),
					new ExpectedCellValue(sheetName, 67, 1, 20100070),
					new ExpectedCellValue(sheetName, 68, 1, 20100076),
					new ExpectedCellValue(sheetName, 69, 1, 20100083),
					new ExpectedCellValue(sheetName, 70, 1, 20100085),
					new ExpectedCellValue(sheetName, 71, 1, 20100090),
					new ExpectedCellValue(sheetName, 72, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 61, 2, "January"),
					new ExpectedCellValue(sheetName, 62, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 2, 2d),
					new ExpectedCellValue(sheetName, 72, 2, 2d),
					new ExpectedCellValue(sheetName, 63, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 3, 415.75),
					new ExpectedCellValue(sheetName, 72, 3, 415.75),
					new ExpectedCellValue(sheetName, 62, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 71, 4, 2d),
					new ExpectedCellValue(sheetName, 72, 4, 2d),
					new ExpectedCellValue(sheetName, 63, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 71, 5, 415.75),
					new ExpectedCellValue(sheetName, 72, 5, 415.75),
					new ExpectedCellValue(sheetName, 62, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 6, 1d),
					new ExpectedCellValue(sheetName, 72, 6, 1d),
					new ExpectedCellValue(sheetName, 63, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 7, 415.75),
					new ExpectedCellValue(sheetName, 72, 7, 415.75),
					new ExpectedCellValue(sheetName, 61, 8, "February"),
					new ExpectedCellValue(sheetName, 62, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 8, "Tent"),
					new ExpectedCellValue(sheetName, 67, 8, 6d),
					new ExpectedCellValue(sheetName, 72, 8, 6d),
					new ExpectedCellValue(sheetName, 63, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 9, "Tent"),
					new ExpectedCellValue(sheetName, 67, 9, 199d),
					new ExpectedCellValue(sheetName, 72, 9, 199d),
					new ExpectedCellValue(sheetName, 62, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 70, 10, 1d),
					new ExpectedCellValue(sheetName, 72, 10, 1d),
					new ExpectedCellValue(sheetName, 63, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 70, 11, 99d),
					new ExpectedCellValue(sheetName, 72, 11, 99d),
					new ExpectedCellValue(sheetName, 61, 12, "March"),
					new ExpectedCellValue(sheetName, 62, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 69, 12, 1d),
					new ExpectedCellValue(sheetName, 72, 12, 1d),
					new ExpectedCellValue(sheetName, 63, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 69, 13, 24.99),
					new ExpectedCellValue(sheetName, 72, 13, 24.99),
					new ExpectedCellValue(sheetName, 62, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 14, 2d),
					new ExpectedCellValue(sheetName, 72, 14, 2d),
					new ExpectedCellValue(sheetName, 63, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 15, 415.75),
					new ExpectedCellValue(sheetName, 72, 15, 415.75),
					new ExpectedCellValue(sheetName, 61, 16, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 65, 16, 2d),
					new ExpectedCellValue(sheetName, 66, 16, 2d),
					new ExpectedCellValue(sheetName, 67, 16, 6d),
					new ExpectedCellValue(sheetName, 68, 16, 1d),
					new ExpectedCellValue(sheetName, 69, 16, 1d),
					new ExpectedCellValue(sheetName, 70, 16, 1d),
					new ExpectedCellValue(sheetName, 71, 16, 2d),
					new ExpectedCellValue(sheetName, 72, 16, 15d),
					new ExpectedCellValue(sheetName, 61, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 65, 17, 415.75),
					new ExpectedCellValue(sheetName, 66, 17, 415.75),
					new ExpectedCellValue(sheetName, 67, 17, 199d),
					new ExpectedCellValue(sheetName, 68, 17, 415.75),
					new ExpectedCellValue(sheetName, 69, 17, 24.99),
					new ExpectedCellValue(sheetName, 70, 17, 99d),
					new ExpectedCellValue(sheetName, 71, 17, 415.75),
					new ExpectedCellValue(sheetName, 72, 17, 1985.99)
				});
			}
		}
		#endregion

		#region Custom Field Subtotals
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomRowFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleRowFieldsColumnDataFields()
		{
			var file = new FileInfo("PivotTableCustomRowFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				void validateSheet() => TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 4, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 2, "January Sum"),
					new ExpectedCellValue(sheetName, 6, 2, "January Count"),
					new ExpectedCellValue(sheetName, 7, 2, "January Average"),
					new ExpectedCellValue(sheetName, 8, 2, "January Max"),
					new ExpectedCellValue(sheetName, 9, 2, "January Min"),
					new ExpectedCellValue(sheetName, 10, 2, "January Product"),
					new ExpectedCellValue(sheetName, 11, 2, "January Count"),
					new ExpectedCellValue(sheetName, 12, 2, "January StdDev"),
					new ExpectedCellValue(sheetName, 13, 2, "January StdDevp"),
					new ExpectedCellValue(sheetName, 14, 2, "January Var"),
					new ExpectedCellValue(sheetName, 15, 2, "January Varp"),
					new ExpectedCellValue(sheetName, 16, 2, "February"),
					new ExpectedCellValue(sheetName, 17, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 18, 2, "Tent"),
					new ExpectedCellValue(sheetName, 19, 2, "February Sum"),
					new ExpectedCellValue(sheetName, 20, 2, "February Count"),
					new ExpectedCellValue(sheetName, 21, 2, "February Average"),
					new ExpectedCellValue(sheetName, 22, 2, "February Max"),
					new ExpectedCellValue(sheetName, 23, 2, "February Min"),
					new ExpectedCellValue(sheetName, 24, 2, "February Product"),
					new ExpectedCellValue(sheetName, 25, 2, "February Count"),
					new ExpectedCellValue(sheetName, 26, 2, "February StdDev"),
					new ExpectedCellValue(sheetName, 27, 2, "February StdDevp"),
					new ExpectedCellValue(sheetName, 28, 2, "February Var"),
					new ExpectedCellValue(sheetName, 29, 2, "February Varp"),
					new ExpectedCellValue(sheetName, 30, 2, "Grand Total"),

					new ExpectedCellValue(sheetName, 2, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, 1663),
					new ExpectedCellValue(sheetName, 5, 3, 1663),
					new ExpectedCellValue(sheetName, 6, 3, 4),
					new ExpectedCellValue(sheetName, 7, 3, 415.75),
					new ExpectedCellValue(sheetName, 8, 3, 415.75),
					new ExpectedCellValue(sheetName, 9, 3, 415.75),
					new ExpectedCellValue(sheetName, 10, 3, 29876452710),
					new ExpectedCellValue(sheetName, 11, 3, 4),
					new ExpectedCellValue(sheetName, 12, 3, 0),
					new ExpectedCellValue(sheetName, 13, 3, 0),
					new ExpectedCellValue(sheetName, 14, 3, 0),
					new ExpectedCellValue(sheetName, 15, 3, 0),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, 99),
					new ExpectedCellValue(sheetName, 18, 3, 223.99),
					new ExpectedCellValue(sheetName, 19, 3, 322.99),
					new ExpectedCellValue(sheetName, 20, 3, 3),
					new ExpectedCellValue(sheetName, 21, 3, 107.663333),
					new ExpectedCellValue(sheetName, 22, 3, 199),
					new ExpectedCellValue(sheetName, 23, 3, 24.99),
					new ExpectedCellValue(sheetName, 24, 3, 492327.99),
					new ExpectedCellValue(sheetName, 25, 3, 3),
					new ExpectedCellValue(sheetName, 26, 3, 87.32788806),
					new ExpectedCellValue(sheetName, 27, 3, 71.30292202),
					new ExpectedCellValue(sheetName, 28, 3, 7626.160033),
					new ExpectedCellValue(sheetName, 29, 3, 5084.106689),
					new ExpectedCellValue(sheetName, 30, 3, 1985.99),

					new ExpectedCellValue(sheetName, 2, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, 7),
					new ExpectedCellValue(sheetName, 5, 4, 7),
					new ExpectedCellValue(sheetName, 6, 4, 4),
					new ExpectedCellValue(sheetName, 7, 4, 1.75),
					new ExpectedCellValue(sheetName, 8, 4, 2),
					new ExpectedCellValue(sheetName, 9, 4, 1),
					new ExpectedCellValue(sheetName, 10, 4, 8),
					new ExpectedCellValue(sheetName, 11, 4, 4),
					new ExpectedCellValue(sheetName, 12, 4, .5),
					new ExpectedCellValue(sheetName, 13, 4, .433012702),
					new ExpectedCellValue(sheetName, 14, 4, .25),
					new ExpectedCellValue(sheetName, 15, 4, .1875),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, 1),
					new ExpectedCellValue(sheetName, 18, 4, 7),
					new ExpectedCellValue(sheetName, 19, 4, 8),
					new ExpectedCellValue(sheetName, 20, 4, 3),
					new ExpectedCellValue(sheetName, 21, 4, 2.666666667),
					new ExpectedCellValue(sheetName, 22, 4, 6),
					new ExpectedCellValue(sheetName, 23, 4, 1),
					new ExpectedCellValue(sheetName, 24, 4, 6),
					new ExpectedCellValue(sheetName, 25, 4, 3),
					new ExpectedCellValue(sheetName, 26, 4, 2.886751346),
					new ExpectedCellValue(sheetName, 27, 4, 2.357022604),
					new ExpectedCellValue(sheetName, 28, 4, 8.333333333),
					new ExpectedCellValue(sheetName, 29, 4, 5.555555556),
					new ExpectedCellValue(sheetName, 30, 4, 15)
				});

				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(13, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				validateSheet();

				// Test again but with subtotalTop turned on. Results should be identical.
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(13, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				validateSheet();
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomRowFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleRowFieldsSingleDataFieldSubtotalsBottom()
		{
			var file = new FileInfo("PivotTableCustomRowFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(13, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "January"),
					new ExpectedCellValue(sheetName, 4, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 6, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 8, 6, "Car Rack Max"),
					new ExpectedCellValue(sheetName, 9, 6, "Car Rack Min"),
					new ExpectedCellValue(sheetName, 10, 6, "Car Rack Product"),
					new ExpectedCellValue(sheetName, 11, 6, "January Count"),
					new ExpectedCellValue(sheetName, 12, 6, "February"),
					new ExpectedCellValue(sheetName, 13, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 14, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 15, 6, "Sleeping Bag Max"),
					new ExpectedCellValue(sheetName, 16, 6, "Sleeping Bag Min"),
					new ExpectedCellValue(sheetName, 17, 6, "Sleeping Bag Product"),
					new ExpectedCellValue(sheetName, 18, 6, "Tent"),
					new ExpectedCellValue(sheetName, 19, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 6, "Tent Max"),
					new ExpectedCellValue(sheetName, 22, 6, "Tent Min"),
					new ExpectedCellValue(sheetName, 23, 6, "Tent Product"),
					new ExpectedCellValue(sheetName, 24, 6, "February Count"),
					new ExpectedCellValue(sheetName, 25, 6, "Grand Total"),

					new ExpectedCellValue(sheetName, 2, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, 415.75),
					new ExpectedCellValue(sheetName, 6, 7, 831.5),
					new ExpectedCellValue(sheetName, 7, 7, 415.75),
					new ExpectedCellValue(sheetName, 8, 7, 415.75),
					new ExpectedCellValue(sheetName, 9, 7, 415.75),
					new ExpectedCellValue(sheetName, 10, 7, 29876452710),
					new ExpectedCellValue(sheetName, 11, 7, 4),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, 99),
					new ExpectedCellValue(sheetName, 15, 7, 99),
					new ExpectedCellValue(sheetName, 16, 7, 99),
					new ExpectedCellValue(sheetName, 17, 7, 99),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, 24.99),
					new ExpectedCellValue(sheetName, 20, 7, 199),
					new ExpectedCellValue(sheetName, 21, 7, 199),
					new ExpectedCellValue(sheetName, 22, 7, 24.99),
					new ExpectedCellValue(sheetName, 23, 7, 4973.01),
					new ExpectedCellValue(sheetName, 24, 7, 3),
					new ExpectedCellValue(sheetName, 25, 7, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomRowFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleRowFieldsSingleDataFieldSubtotalsTopOn()
		{
			var file = new FileInfo("PivotTableCustomRowFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:G23"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "January"),
					new ExpectedCellValue(sheetName, 4, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 6, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 8, 6, "Car Rack Max"),
					new ExpectedCellValue(sheetName, 9, 6, "Car Rack Min"),
					new ExpectedCellValue(sheetName, 10, 6, "Car Rack Product"),
					new ExpectedCellValue(sheetName, 11, 6, "February"),
					new ExpectedCellValue(sheetName, 12, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 13, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 6, "Sleeping Bag Max"),
					new ExpectedCellValue(sheetName, 15, 6, "Sleeping Bag Min"),
					new ExpectedCellValue(sheetName, 16, 6, "Sleeping Bag Product"),
					new ExpectedCellValue(sheetName, 17, 6, "Tent"),
					new ExpectedCellValue(sheetName, 18, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 19, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 6, "Tent Max"),
					new ExpectedCellValue(sheetName, 21, 6, "Tent Min"),
					new ExpectedCellValue(sheetName, 22, 6, "Tent Product"),
					new ExpectedCellValue(sheetName, 23, 6, "Grand Total"),

					new ExpectedCellValue(sheetName, 2, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 7, 4),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, 415.75),
					new ExpectedCellValue(sheetName, 6, 7, 831.5),
					new ExpectedCellValue(sheetName, 7, 7, 415.75),
					new ExpectedCellValue(sheetName, 8, 7, 415.75),
					new ExpectedCellValue(sheetName, 9, 7, 415.75),
					new ExpectedCellValue(sheetName, 10, 7, 29876452710),
					new ExpectedCellValue(sheetName, 11, 7, 3),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, 99),
					new ExpectedCellValue(sheetName, 14, 7, 99),
					new ExpectedCellValue(sheetName, 15, 7, 99),
					new ExpectedCellValue(sheetName, 16, 7, 99),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, 24.99),
					new ExpectedCellValue(sheetName, 19, 7, 199),
					new ExpectedCellValue(sheetName, 20, 7, 199),
					new ExpectedCellValue(sheetName, 21, 7, 24.99),
					new ExpectedCellValue(sheetName, 22, 7, 4973.01),
					new ExpectedCellValue(sheetName, 23, 7, 1985.99)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomRowFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleRowFieldsRowDataFieldFirst()
		{
			var file = new FileInfo("PivotTableCustomRowFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				void validateWorksheet() => TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 9, "January"),
					new ExpectedCellValue(sheetName, 5, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 6, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 8, 9, "January Count"),
					new ExpectedCellValue(sheetName, 9, 9, "January Average"),
					new ExpectedCellValue(sheetName, 10, 9, "February"),
					new ExpectedCellValue(sheetName, 11, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 9, "February Count"),
					new ExpectedCellValue(sheetName, 15, 9, "February Average"),
					new ExpectedCellValue(sheetName, 16, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 9, "January"),
					new ExpectedCellValue(sheetName, 18, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 19, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 21, 9, "January Count"),
					new ExpectedCellValue(sheetName, 22, 9, "January Average"),
					new ExpectedCellValue(sheetName, 23, 9, "February"),
					new ExpectedCellValue(sheetName, 24, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 9, "February Count"),
					new ExpectedCellValue(sheetName, 28, 9, "February Average"),
					new ExpectedCellValue(sheetName, 29, 9, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 9, "Total Sum of Units Sold"),

					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, 415.75),
					new ExpectedCellValue(sheetName, 6, 10, 831.5),
					new ExpectedCellValue(sheetName, 7, 10, 415.75),
					new ExpectedCellValue(sheetName, 8, 10, 4),
					new ExpectedCellValue(sheetName, 9, 10, 415.75),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, 24.99),
					new ExpectedCellValue(sheetName, 12, 10, 199),
					new ExpectedCellValue(sheetName, 13, 10, 99),
					new ExpectedCellValue(sheetName, 14, 10, 3),
					new ExpectedCellValue(sheetName, 15, 10, 107.6633333),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, 2),
					new ExpectedCellValue(sheetName, 19, 10, 4),
					new ExpectedCellValue(sheetName, 20, 10, 1),
					new ExpectedCellValue(sheetName, 21, 10, 4),
					new ExpectedCellValue(sheetName, 22, 10, 1.75),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, 1),
					new ExpectedCellValue(sheetName, 25, 10, 6),
					new ExpectedCellValue(sheetName, 26, 10, 1),
					new ExpectedCellValue(sheetName, 27, 10, 3),
					new ExpectedCellValue(sheetName, 28, 10, 2.666666667),
					new ExpectedCellValue(sheetName, 29, 10, 1985.99),
					new ExpectedCellValue(sheetName, 30, 10, 15),
				});

				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I2:J30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();

				// Run again with subtotal top, results should be the same.
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I2:J30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomRowFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleRowFieldsRowDataFieldSecond()
		{
			var file = new FileInfo("PivotTableCustomRowFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				void validateWorksheet() => TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 12, "January"),
					new ExpectedCellValue(sheetName, 4, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 6, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 8, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 10, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 12, "January Max of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 12, "January Max of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 12, "January Min of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 12, "January Min of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 12, "February"),
					new ExpectedCellValue(sheetName, 17, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 19, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 21, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 23, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 12, "February Max of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 12, "February Max of Units Sold"),
					new ExpectedCellValue(sheetName, 27, 12, "February Min of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 12, "February Min of Units Sold"),
					new ExpectedCellValue(sheetName, 29, 12, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 12, "Total Sum of Units Sold"),

					new ExpectedCellValue(sheetName, 2, 13, null),
					new ExpectedCellValue(sheetName, 3, 13, null),
					new ExpectedCellValue(sheetName, 4, 13, null),
					new ExpectedCellValue(sheetName, 5, 13, 415.75),
					new ExpectedCellValue(sheetName, 6, 13, 831.5),
					new ExpectedCellValue(sheetName, 7, 13, 415.75),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, 2),
					new ExpectedCellValue(sheetName, 10, 13, 4),
					new ExpectedCellValue(sheetName, 11, 13, 1),
					new ExpectedCellValue(sheetName, 12, 13, 415.75),
					new ExpectedCellValue(sheetName, 13, 13, 2),
					new ExpectedCellValue(sheetName, 14, 13, 415.75),
					new ExpectedCellValue(sheetName, 15, 13, 1),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, 24.99),
					new ExpectedCellValue(sheetName, 19, 13, 199),
					new ExpectedCellValue(sheetName, 20, 13, 99),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, 1),
					new ExpectedCellValue(sheetName, 23, 13, 6),
					new ExpectedCellValue(sheetName, 24, 13, 1),
					new ExpectedCellValue(sheetName, 25, 13, 199),
					new ExpectedCellValue(sheetName, 26, 13, 6),
					new ExpectedCellValue(sheetName, 27, 13, 24.99),
					new ExpectedCellValue(sheetName, 28, 13, 1),
					new ExpectedCellValue(sheetName, 29, 13, 1985.99),
					new ExpectedCellValue(sheetName, 30, 13, 15),
				});

				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L2:M30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();

				// Run again with subtotal top, results should be the same.
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L2:M30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomRowFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleRowFieldsRowDataFieldLast()
		{
			var file = new FileInfo("PivotTableCustomRowFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				void validateWorksheet() => TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 15, "January"),
					new ExpectedCellValue(sheetName, 5, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 6, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 15, "February"),
					new ExpectedCellValue(sheetName, 8, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 9, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 15, "Chicago Average of Wholesale Price"),
					new ExpectedCellValue(sheetName, 11, 15, "Chicago Average of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 15, "Chicago Max of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 15, "Chicago Max of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 15, 15, "January"),
					new ExpectedCellValue(sheetName, 16, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 15, "February"),
					new ExpectedCellValue(sheetName, 19, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 15, "Nashville Average of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 15, "Nashville Average of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 15, "Nashville Max of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 15, "Nashville Max of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 15, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 15, "January"),
					new ExpectedCellValue(sheetName, 27, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 29, 15, "February"),
					new ExpectedCellValue(sheetName, 30, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 31, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 15, "San Francisco Average of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 15, "San Francisco Average of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 15, "San Francisco Max of Wholesale Price"),
					new ExpectedCellValue(sheetName, 35, 15, "San Francisco Max of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 15, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 15, "Total Sum of Units Sold"),

					new ExpectedCellValue(sheetName, 2, 16, null),
					new ExpectedCellValue(sheetName, 3, 16, null),
					new ExpectedCellValue(sheetName, 4, 16, null),
					new ExpectedCellValue(sheetName, 5, 16, 415.75),
					new ExpectedCellValue(sheetName, 6, 16, 2),
					new ExpectedCellValue(sheetName, 7, 16, null),
					new ExpectedCellValue(sheetName, 8, 16, 24.99),
					new ExpectedCellValue(sheetName, 9, 16, 1),
					new ExpectedCellValue(sheetName, 10, 16, 220.37),
					new ExpectedCellValue(sheetName, 11, 16, 1.5),
					new ExpectedCellValue(sheetName, 12, 16, 415.75),
					new ExpectedCellValue(sheetName, 13, 16, 2),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, 831.5),
					new ExpectedCellValue(sheetName, 17, 16, 4),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, 199),
					new ExpectedCellValue(sheetName, 20, 16, 6),
					new ExpectedCellValue(sheetName, 21, 16, 343.5),
					new ExpectedCellValue(sheetName, 22, 16, 3.33333333),
					new ExpectedCellValue(sheetName, 23, 16, 415.75),
					new ExpectedCellValue(sheetName, 24, 16, 6),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, 415.75),
					new ExpectedCellValue(sheetName, 28, 16, 1),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, 99),
					new ExpectedCellValue(sheetName, 31, 16, 1),
					new ExpectedCellValue(sheetName, 32, 16, 257.375),
					new ExpectedCellValue(sheetName, 33, 16, 1),
					new ExpectedCellValue(sheetName, 34, 16, 415.75),
					new ExpectedCellValue(sheetName, 35, 16, 1),
					new ExpectedCellValue(sheetName, 36, 16, 1985.99),
					new ExpectedCellValue(sheetName, 37, 16, 15),
				});

				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O2:P37"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();

				// Run again with subtotal top, results should be the same.
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O2:P37"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				validateWorksheet();
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomColumnFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleColumnFieldsRowDataFields()
		{
			var file = new FileInfo("PivotTableCustomColumnFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F3:U7"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 4, 10, "January Sum"),
					new ExpectedCellValue(sheetName, 4, 11, "January Count"),
					new ExpectedCellValue(sheetName, 4, 12, "January Average"),
					new ExpectedCellValue(sheetName, 4, 13, "January Max"),
					new ExpectedCellValue(sheetName, 4, 14, "February"),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 4, 16, null),
					new ExpectedCellValue(sheetName, 4, 17, "February Sum"),
					new ExpectedCellValue(sheetName, 4, 18, "February Count"),
					new ExpectedCellValue(sheetName, 4, 19, "February Average"),
					new ExpectedCellValue(sheetName, 4, 20, "February Max"),
					new ExpectedCellValue(sheetName, 4, 21, "Grand Total"),

					new ExpectedCellValue(sheetName, 5, 6, "Values"),
					new ExpectedCellValue(sheetName, 5, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 5, 12, null),
					new ExpectedCellValue(sheetName, 5, 13, null),
					new ExpectedCellValue(sheetName, 5, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 5, 17, null),
					new ExpectedCellValue(sheetName, 5, 18, null),
					new ExpectedCellValue(sheetName, 5, 19, null),
					new ExpectedCellValue(sheetName, 5, 20, null),
					new ExpectedCellValue(sheetName, 5, 21, null),

					new ExpectedCellValue(sheetName, 6, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 6, 7, 415.75),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 6, 9, 415.75),
					new ExpectedCellValue(sheetName, 6, 10, 1663),
					new ExpectedCellValue(sheetName, 6, 11, 4),
					new ExpectedCellValue(sheetName, 6, 12, 415.75),
					new ExpectedCellValue(sheetName, 6, 13, 415.75),
					new ExpectedCellValue(sheetName, 6, 14, 24.99),
					new ExpectedCellValue(sheetName, 6, 15, 199),
					new ExpectedCellValue(sheetName, 6, 16, 99),
					new ExpectedCellValue(sheetName, 6, 17, 322.99),
					new ExpectedCellValue(sheetName, 6, 18, 3),
					new ExpectedCellValue(sheetName, 6, 19, 107.6633333),
					new ExpectedCellValue(sheetName, 6, 20, 199),
					new ExpectedCellValue(sheetName, 6, 21, 1985.99),

					new ExpectedCellValue(sheetName, 7, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 7, 2),
					new ExpectedCellValue(sheetName, 7, 8, 4),
					new ExpectedCellValue(sheetName, 7, 9, 1),
					new ExpectedCellValue(sheetName, 7, 10, 7),
					new ExpectedCellValue(sheetName, 7, 11, 4),
					new ExpectedCellValue(sheetName, 7, 12, 1.75),
					new ExpectedCellValue(sheetName, 7, 13, 2),
					new ExpectedCellValue(sheetName, 7, 14, 1),
					new ExpectedCellValue(sheetName, 7, 15, 6),
					new ExpectedCellValue(sheetName, 7, 16, 1),
					new ExpectedCellValue(sheetName, 7, 17, 8),
					new ExpectedCellValue(sheetName, 7, 18, 3),
					new ExpectedCellValue(sheetName, 7, 19, 2.666666667),
					new ExpectedCellValue(sheetName, 7, 20, 6),
					new ExpectedCellValue(sheetName, 7, 21, 15),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomColumnFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleColumnFieldsSingleDataField()
		{
			var file = new FileInfo("PivotTableCustomColumnFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F10:Q13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 10, 7, "Column Labels"),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 10, 13, null),
					new ExpectedCellValue(sheetName, 10, 17, null),

					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 11, 7, "January"),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 11, 10, "January Max"),
					new ExpectedCellValue(sheetName, 11, 11, "January Min"),
					new ExpectedCellValue(sheetName, 11, 12, "February"),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 11, 15, "February Max"),
					new ExpectedCellValue(sheetName, 11, 16, "February Min"),
					new ExpectedCellValue(sheetName, 11, 17, "Grand Total"),

					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 12, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 12, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 12, 17, null),

					new ExpectedCellValue(sheetName, 13, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 7, 415.75),
					new ExpectedCellValue(sheetName, 13, 8, 831.5),
					new ExpectedCellValue(sheetName, 13, 9, 415.75),
					new ExpectedCellValue(sheetName, 13, 10, 415.75),
					new ExpectedCellValue(sheetName, 13, 11, 415.75),
					new ExpectedCellValue(sheetName, 13, 12, 24.99),
					new ExpectedCellValue(sheetName, 13, 13, 199),
					new ExpectedCellValue(sheetName, 13, 14, 99),
					new ExpectedCellValue(sheetName, 13, 15, 199),
					new ExpectedCellValue(sheetName, 13, 16, 24.99),
					new ExpectedCellValue(sheetName, 13, 17, 1985.99),
				});
			}
		}


		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomColumnFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleColumnAndRowFieldsWithRowDataFields()
		{
			var file = new FileInfo("PivotTableCustomColumnFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F16:Q42"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 16, 7, "Column Labels"),
					new ExpectedCellValue(sheetName, 16, 8, null),

					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 17, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 17, 11, "Car Rack Product"),
					new ExpectedCellValue(sheetName, 17, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 17, 13, "Sleeping Bag Product"),
					new ExpectedCellValue(sheetName, 17, 14, "Tent"),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 17, 16, "Tent Product"),
					new ExpectedCellValue(sheetName, 17, 17, "Grand Total"),

					new ExpectedCellValue(sheetName, 18, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 18, 7, "20100007"),
					new ExpectedCellValue(sheetName, 18, 8, "20100017"),
					new ExpectedCellValue(sheetName, 18, 9, "20100076"),
					new ExpectedCellValue(sheetName, 18, 10, "20100090"),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 18, 12, "20100085"),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 18, 14, "20100070"),
					new ExpectedCellValue(sheetName, 18, 15, "20100083"),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 18, 17, null),

					new ExpectedCellValue(sheetName, 19, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 19, 17, null),

					new ExpectedCellValue(sheetName, 20, 6, "January"),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 20, 17, null),

					new ExpectedCellValue(sheetName, 21, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 7, 415.75),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 21, 11, 415.75),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 21, 17, 415.75),

					new ExpectedCellValue(sheetName, 22, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 22, 8, 415.75),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 22, 10, 415.75),
					new ExpectedCellValue(sheetName, 22, 11, 172848.0625),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 22, 17, 831.5),

					new ExpectedCellValue(sheetName, 23, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 23, 9, 415.75),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 23, 11, 415.75),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 23, 17, 415.75),

					new ExpectedCellValue(sheetName, 24, 6, "January Count"),
					new ExpectedCellValue(sheetName, 24, 7, 1),
					new ExpectedCellValue(sheetName, 24, 8, 1),
					new ExpectedCellValue(sheetName, 24, 9, 1),
					new ExpectedCellValue(sheetName, 24, 10, 1),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 24, 12, null),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 24, 17, 4),

					new ExpectedCellValue(sheetName, 25, 6, "February"),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 25, 17, null),

					new ExpectedCellValue(sheetName, 26, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 26, 15, 24.99),
					new ExpectedCellValue(sheetName, 26, 16, 24.99),
					new ExpectedCellValue(sheetName, 26, 17, 24.99),

					new ExpectedCellValue(sheetName, 27, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 27, 14, 199),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 27, 16, 199),
					new ExpectedCellValue(sheetName, 27, 17, 199),

					new ExpectedCellValue(sheetName, 28, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 28, 12, 99),
					new ExpectedCellValue(sheetName, 28, 13, 99),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 28, 16, null),
					new ExpectedCellValue(sheetName, 28, 17, 99),

					new ExpectedCellValue(sheetName, 29, 6, "February Count"),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 29, 12, 1),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 29, 14, 1),
					new ExpectedCellValue(sheetName, 29, 15, 1),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 29, 17, 3),

					new ExpectedCellValue(sheetName, 30, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 30, 13, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 30, 17, null),

					new ExpectedCellValue(sheetName, 31, 6, "January"),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 31, 13, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 31, 17, null),

					new ExpectedCellValue(sheetName, 32, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 32, 7, 2),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 32, 11, 2),
					new ExpectedCellValue(sheetName, 32, 13, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 32, 17, 2),

					new ExpectedCellValue(sheetName, 33, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 33, 8, 2),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 33, 10, 2),
					new ExpectedCellValue(sheetName, 33, 11, 4),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 33, 15, null),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 33, 17, 4),

					new ExpectedCellValue(sheetName, 34, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 34, 9, 1),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 34, 11, 1),
					new ExpectedCellValue(sheetName, 34, 12, null),
					new ExpectedCellValue(sheetName, 34, 14, null),
					new ExpectedCellValue(sheetName, 34, 16, null),
					new ExpectedCellValue(sheetName, 34, 17, 1),

					new ExpectedCellValue(sheetName, 35, 6, "January Count"),
					new ExpectedCellValue(sheetName, 35, 7, 1),
					new ExpectedCellValue(sheetName, 35, 8, 1),
					new ExpectedCellValue(sheetName, 35, 9, 1),
					new ExpectedCellValue(sheetName, 35, 10, 1),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 35, 14, null),
					new ExpectedCellValue(sheetName, 35, 16, null),
					new ExpectedCellValue(sheetName, 35, 17, 4),

					new ExpectedCellValue(sheetName, 36, 6, "February"),
					new ExpectedCellValue(sheetName, 36, 8, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 36, 14, null),
					new ExpectedCellValue(sheetName, 36, 16, null),
					new ExpectedCellValue(sheetName, 36, 17, null),

					new ExpectedCellValue(sheetName, 37, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 37, 7, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 37, 11, null),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 37, 15, 1),
					new ExpectedCellValue(sheetName, 37, 16, 1),
					new ExpectedCellValue(sheetName, 37, 17, 1),

					new ExpectedCellValue(sheetName, 38, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 38, 7, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 38, 14, 6),
					new ExpectedCellValue(sheetName, 38, 16, 6),
					new ExpectedCellValue(sheetName, 38, 17, 6),

					new ExpectedCellValue(sheetName, 39, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 39, 12, 1),
					new ExpectedCellValue(sheetName, 39, 13, 1),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 39, 17, 1),

					new ExpectedCellValue(sheetName, 40, 6, "February Count"),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 40, 11, null),
					new ExpectedCellValue(sheetName, 40, 12, 1),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 40, 14, 1),
					new ExpectedCellValue(sheetName, 40, 15, 1),
					new ExpectedCellValue(sheetName, 40, 16, null),
					new ExpectedCellValue(sheetName, 40, 17, 3),

					new ExpectedCellValue(sheetName, 41, 6, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 41, 7, 415.75),
					new ExpectedCellValue(sheetName, 41, 8, 415.75),
					new ExpectedCellValue(sheetName, 41, 9, 415.75),
					new ExpectedCellValue(sheetName, 41, 10, 415.75),
					new ExpectedCellValue(sheetName, 41, 11, 29876452710),
					new ExpectedCellValue(sheetName, 41, 12, 99),
					new ExpectedCellValue(sheetName, 41, 13, 99),
					new ExpectedCellValue(sheetName, 41, 14, 199),
					new ExpectedCellValue(sheetName, 41, 15, 24.99),
					new ExpectedCellValue(sheetName, 41, 16, 4973.01),
					new ExpectedCellValue(sheetName, 41, 17, 1985.99),

					new ExpectedCellValue(sheetName, 42, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 7, 2),
					new ExpectedCellValue(sheetName, 42, 8, 2),
					new ExpectedCellValue(sheetName, 42, 9, 1),
					new ExpectedCellValue(sheetName, 42, 10, 2),
					new ExpectedCellValue(sheetName, 42, 11, 8),
					new ExpectedCellValue(sheetName, 42, 12, 1),
					new ExpectedCellValue(sheetName, 42, 13, 1),
					new ExpectedCellValue(sheetName, 42, 14, 6),
					new ExpectedCellValue(sheetName, 42, 15, 1),
					new ExpectedCellValue(sheetName, 42, 16, 6),
					new ExpectedCellValue(sheetName, 42, 17, 15),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomColumnFieldSubtotals.xlsx")]
		public void PivotTableRefreshCustomSubtotalsMultipleColumnAndRowFieldsWithRowDataFieldsSubtotalTopOn()
		{
			var file = new FileInfo("PivotTableCustomColumnFieldSubtotals.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "PivotTables";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F16:Q38"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}

				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 16, 7, "Column Labels"),
					new ExpectedCellValue(sheetName, 16, 8, null),

					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 17, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 17, 11, "Car Rack Product"),
					new ExpectedCellValue(sheetName, 17, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 17, 13, "Sleeping Bag Product"),
					new ExpectedCellValue(sheetName, 17, 14, "Tent"),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 17, 16, "Tent Product"),
					new ExpectedCellValue(sheetName, 17, 17, "Grand Total"),

					new ExpectedCellValue(sheetName, 18, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 18, 7, "20100007"),
					new ExpectedCellValue(sheetName, 18, 8, "20100017"),
					new ExpectedCellValue(sheetName, 18, 9, "20100076"),
					new ExpectedCellValue(sheetName, 18, 10, "20100090"),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 18, 12, "20100085"),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 18, 14, "20100070"),
					new ExpectedCellValue(sheetName, 18, 15, "20100083"),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 18, 17, null),

					new ExpectedCellValue(sheetName, 19, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 19, 17, null),

					new ExpectedCellValue(sheetName, 20, 6, "January"),
					new ExpectedCellValue(sheetName, 20, 7, 1),
					new ExpectedCellValue(sheetName, 20, 8, 1),
					new ExpectedCellValue(sheetName, 20, 9, 1),
					new ExpectedCellValue(sheetName, 20, 10, 1),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 20, 17, 4),

					new ExpectedCellValue(sheetName, 21, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 7, 415.75),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 21, 11, 415.75),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 21, 17, 415.75),

					new ExpectedCellValue(sheetName, 22, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 22, 8, 415.75),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 22, 10, 415.75),
					new ExpectedCellValue(sheetName, 22, 11, 172848.0625),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 22, 17, 831.5),

					new ExpectedCellValue(sheetName, 23, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 23, 9, 415.75),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 23, 11, 415.75),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 23, 17, 415.75),

					new ExpectedCellValue(sheetName, 24, 6, "February"),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 24, 12, 1),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 24, 14, 1),
					new ExpectedCellValue(sheetName, 24, 15, 1),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 24, 17, 3),

					new ExpectedCellValue(sheetName, 25, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 25, 15, 24.99),
					new ExpectedCellValue(sheetName, 25, 16, 24.99),
					new ExpectedCellValue(sheetName, 25, 17, 24.99),

					new ExpectedCellValue(sheetName, 26, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 26, 14, 199),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 26, 16, 199),
					new ExpectedCellValue(sheetName, 26, 17, 199),

					new ExpectedCellValue(sheetName, 27, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 27, 12, 99),
					new ExpectedCellValue(sheetName, 27, 13, 99),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 27, 16, null),
					new ExpectedCellValue(sheetName, 27, 17, 99),

					new ExpectedCellValue(sheetName, 28, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 28, 17, null),

					new ExpectedCellValue(sheetName, 29, 6, "January"),
					new ExpectedCellValue(sheetName, 29, 7, 1),
					new ExpectedCellValue(sheetName, 29, 8, 1),
					new ExpectedCellValue(sheetName, 29, 9, 1),
					new ExpectedCellValue(sheetName, 29, 10, 1),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 29, 15, null),
					new ExpectedCellValue(sheetName, 29, 17, 4),

					new ExpectedCellValue(sheetName, 30, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 30, 7, 2),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 30, 11, 2),
					new ExpectedCellValue(sheetName, 30, 13, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 30, 17, 2),

					new ExpectedCellValue(sheetName, 31, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 31, 8, 2),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 31, 10, 2),
					new ExpectedCellValue(sheetName, 31, 11, 4),
					new ExpectedCellValue(sheetName, 31, 13, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 31, 16, null),
					new ExpectedCellValue(sheetName, 31, 17, 4),

					new ExpectedCellValue(sheetName, 32, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 32, 9, 1),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 32, 11, 1),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 32, 14, null),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 32, 17, 1),

					new ExpectedCellValue(sheetName, 33, 6, "February"),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 33, 12, 1),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 33, 14, 1),
					new ExpectedCellValue(sheetName, 33, 15, 1),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 33, 17, 3),

					new ExpectedCellValue(sheetName, 34, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 34, 13, null),
					new ExpectedCellValue(sheetName, 34, 15, 1),
					new ExpectedCellValue(sheetName, 34, 16, 1),
					new ExpectedCellValue(sheetName, 34, 17, 1),

					new ExpectedCellValue(sheetName, 35, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 35, 13, null),
					new ExpectedCellValue(sheetName, 35, 14, 6),
					new ExpectedCellValue(sheetName, 35, 16, 6),
					new ExpectedCellValue(sheetName, 35, 17, 6),

					new ExpectedCellValue(sheetName, 36, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 36, 11, null),
					new ExpectedCellValue(sheetName, 36, 12, 1),
					new ExpectedCellValue(sheetName, 36, 13, 1),
					new ExpectedCellValue(sheetName, 36, 15, null),
					new ExpectedCellValue(sheetName, 36, 17, 1),

					new ExpectedCellValue(sheetName, 37, 6, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 7, 415.75),
					new ExpectedCellValue(sheetName, 37, 8, 415.75),
					new ExpectedCellValue(sheetName, 37, 9, 415.75),
					new ExpectedCellValue(sheetName, 37, 10, 415.75),
					new ExpectedCellValue(sheetName, 37, 11, 29876452710),
					new ExpectedCellValue(sheetName, 37, 12, 99),
					new ExpectedCellValue(sheetName, 37, 13, 99),
					new ExpectedCellValue(sheetName, 37, 14, 199),
					new ExpectedCellValue(sheetName, 37, 15, 24.99),
					new ExpectedCellValue(sheetName, 37, 16, 4973.01),
					new ExpectedCellValue(sheetName, 37, 17, 1985.99),

					new ExpectedCellValue(sheetName, 38, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 7, 2),
					new ExpectedCellValue(sheetName, 38, 8, 2),
					new ExpectedCellValue(sheetName, 38, 9, 1),
					new ExpectedCellValue(sheetName, 38, 10, 2),
					new ExpectedCellValue(sheetName, 38, 11, 8),
					new ExpectedCellValue(sheetName, 38, 12, 1),
					new ExpectedCellValue(sheetName, 38, 13, 1),
					new ExpectedCellValue(sheetName, 38, 14, 6),
					new ExpectedCellValue(sheetName, 38, 15, 1),
					new ExpectedCellValue(sheetName, 38, 16, 6),
					new ExpectedCellValue(sheetName, 38, 17, 15),
				});
			}
		}
		#endregion

		#region Pivot Field Settings
		#region Tabular Form
		#region Tabular Row Headers With Subtotals Off Tests
		// 2-combo
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsBothTabularSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:C10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 3, "March"),
					new ExpectedCellValue(sheetName, 5, 3, "January"),
					new ExpectedCellValue(sheetName, 6, 3, "February"),
					new ExpectedCellValue(sheetName, 7, 3, "March"),
					new ExpectedCellValue(sheetName, 8, 3, "January"),
					new ExpectedCellValue(sheetName, 9, 3, "February"),
					new ExpectedCellValue(sheetName, 10, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsTabularFirstFieldNonTabularLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B15:C23"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 15, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 16, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 3, "Month"),
					new ExpectedCellValue(sheetName, 16, 3, "January"),
					new ExpectedCellValue(sheetName, 17, 3, "March"),
					new ExpectedCellValue(sheetName, 18, 3, "January"),
					new ExpectedCellValue(sheetName, 19, 3, "February"),
					new ExpectedCellValue(sheetName, 20, 3, "March"),
					new ExpectedCellValue(sheetName, 21, 3, "January"),
					new ExpectedCellValue(sheetName, 22, 3, "February"),
					new ExpectedCellValue(sheetName, 23, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsTabularLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:F13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 6, "January"),
					new ExpectedCellValue(sheetName, 5, 6, "March"),
					new ExpectedCellValue(sheetName, 6, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, "January"),
					new ExpectedCellValue(sheetName, 8, 6, "February"),
					new ExpectedCellValue(sheetName, 9, 6, "March"),
					new ExpectedCellValue(sheetName, 10, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 6, "January"),
					new ExpectedCellValue(sheetName, 12, 6, "February"),
					new ExpectedCellValue(sheetName, 13, 6, "Grand Total")
				});
			}
		}

		// 3-combo
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsAllTabularSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 3, "March"),
					new ExpectedCellValue(sheetName, 5, 3, "January"),
					new ExpectedCellValue(sheetName, 6, 3, "February"),
					new ExpectedCellValue(sheetName, 7, 3, "March"),
					new ExpectedCellValue(sheetName, 8, 3, "January"),
					new ExpectedCellValue(sheetName, 9, 3, "February"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Item"),
					new ExpectedCellValue(sheetName, 3, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 5, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 4, "Tent"),
					new ExpectedCellValue(sheetName, 7, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 8, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 10, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularLeafFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:I10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 8, "Month"),
					new ExpectedCellValue(sheetName, 3, 8, "January"),
					new ExpectedCellValue(sheetName, 4, 8, "March"),
					new ExpectedCellValue(sheetName, 5, 8, "January"),
					new ExpectedCellValue(sheetName, 6, 8, "February"),
					new ExpectedCellValue(sheetName, 7, 8, "March"),
					new ExpectedCellValue(sheetName, 8, 8, "January"),
					new ExpectedCellValue(sheetName, 9, 8, "February"),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Item"),
					new ExpectedCellValue(sheetName, 3, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 5, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 9, "Tent"),
					new ExpectedCellValue(sheetName, 7, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 8, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 10, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularInnerFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B13:C28"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 13, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 14, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 3, "Month"),
					new ExpectedCellValue(sheetName, 14, 3, "January"),
					new ExpectedCellValue(sheetName, 15, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 3, "March"),
					new ExpectedCellValue(sheetName, 17, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 18, 3, "January"),
					new ExpectedCellValue(sheetName, 19, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 3, "February"),
					new ExpectedCellValue(sheetName, 21, 3, "Tent"),
					new ExpectedCellValue(sheetName, 22, 3, "March"),
					new ExpectedCellValue(sheetName, 23, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 3, "January"),
					new ExpectedCellValue(sheetName, 25, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 3, "February"),
					new ExpectedCellValue(sheetName, 27, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularFirstFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F13:G28"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 13, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 14, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, null),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 6, null),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 13, 7, "Month"),
					new ExpectedCellValue(sheetName, 14, 7, "January"),
					new ExpectedCellValue(sheetName, 15, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 7, "March"),
					new ExpectedCellValue(sheetName, 17, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 18, 7, "January"),
					new ExpectedCellValue(sheetName, 19, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 7, "February"),
					new ExpectedCellValue(sheetName, 21, 7, "Tent"),
					new ExpectedCellValue(sheetName, 22, 7, "March"),
					new ExpectedCellValue(sheetName, 23, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 7, "January"),
					new ExpectedCellValue(sheetName, 25, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 7, "February"),
					new ExpectedCellValue(sheetName, 27, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularFirstFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B32:C43"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 32, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 33, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 34, 2, "January"),
					new ExpectedCellValue(sheetName, 35, 2, "March"),
					new ExpectedCellValue(sheetName, 36, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 2, "January"),
					new ExpectedCellValue(sheetName, 38, 2, "February"),
					new ExpectedCellValue(sheetName, 39, 2, "March"),
					new ExpectedCellValue(sheetName, 40, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 2, "January"),
					new ExpectedCellValue(sheetName, 42, 2, "February"),
					new ExpectedCellValue(sheetName, 43, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 32, 3, "Item"),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 35, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 3, "Tent"),
					new ExpectedCellValue(sheetName, 39, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 43, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularInnerFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F32:G43"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 32, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 33, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 34, 6, "January"),
					new ExpectedCellValue(sheetName, 35, 6, "March"),
					new ExpectedCellValue(sheetName, 36, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 6, "January"),
					new ExpectedCellValue(sheetName, 38, 6, "February"),
					new ExpectedCellValue(sheetName, 39, 6, "March"),
					new ExpectedCellValue(sheetName, 40, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 6, "January"),
					new ExpectedCellValue(sheetName, 42, 6, "February"),
					new ExpectedCellValue(sheetName, 43, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 32, 7, "Item"),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 35, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 7, "Tent"),
					new ExpectedCellValue(sheetName, 39, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 43, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularLeafFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B47:B65"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 47, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 48, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 49, 2, "January"),
					new ExpectedCellValue(sheetName, 50, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 51, 2, "March"),
					new ExpectedCellValue(sheetName, 52, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 53, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 54, 2, "January"),
					new ExpectedCellValue(sheetName, 55, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 56, 2, "February"),
					new ExpectedCellValue(sheetName, 57, 2, "Tent"),
					new ExpectedCellValue(sheetName, 58, 2, "March"),
					new ExpectedCellValue(sheetName, 59, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 61, 2, "January"),
					new ExpectedCellValue(sheetName, 62, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 2, "February"),
					new ExpectedCellValue(sheetName, 64, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 65, 2, "Grand Total")
				});
			}
		}

		// 4-combo
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsAllTabularFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:E10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, 20100007),
					new ExpectedCellValue(sheetName, 4, 2, 20100017),
					new ExpectedCellValue(sheetName, 5, 2, 20100070),
					new ExpectedCellValue(sheetName, 6, 2, 20100076),
					new ExpectedCellValue(sheetName, 7, 2, 20100083),
					new ExpectedCellValue(sheetName, 8, 2, 20100085),
					new ExpectedCellValue(sheetName, 9, 2, 20100090),
					new ExpectedCellValue(sheetName, 10, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Location"),
					new ExpectedCellValue(sheetName, 3, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Month"),
					new ExpectedCellValue(sheetName, 3, 4, "January"),
					new ExpectedCellValue(sheetName, 4, 4, "March"),
					new ExpectedCellValue(sheetName, 5, 4, "February"),
					new ExpectedCellValue(sheetName, 6, 4, "January"),
					new ExpectedCellValue(sheetName, 7, 4, "March"),
					new ExpectedCellValue(sheetName, 8, 4, "February"),
					new ExpectedCellValue(sheetName, 9, 4, "January"),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, "Item"),
					new ExpectedCellValue(sheetName, 3, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 5, "Tent"),
					new ExpectedCellValue(sheetName, 6, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 9, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 5, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularLeafFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H2:K10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 8, 20100007),
					new ExpectedCellValue(sheetName, 4, 8, 20100017),
					new ExpectedCellValue(sheetName, 5, 8, 20100070),
					new ExpectedCellValue(sheetName, 6, 8, 20100076),
					new ExpectedCellValue(sheetName, 7, 8, 20100083),
					new ExpectedCellValue(sheetName, 8, 8, 20100085),
					new ExpectedCellValue(sheetName, 9, 8, 20100090),
					new ExpectedCellValue(sheetName, 10, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 9, "Location"),
					new ExpectedCellValue(sheetName, 3, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, "Month"),
					new ExpectedCellValue(sheetName, 3, 10, "January"),
					new ExpectedCellValue(sheetName, 4, 10, "March"),
					new ExpectedCellValue(sheetName, 5, 10, "February"),
					new ExpectedCellValue(sheetName, 6, 10, "January"),
					new ExpectedCellValue(sheetName, 7, 10, "March"),
					new ExpectedCellValue(sheetName, 8, 10, "February"),
					new ExpectedCellValue(sheetName, 9, 10, "January"),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 2, 11, "Item"),
					new ExpectedCellValue(sheetName, 3, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 11, "Tent"),
					new ExpectedCellValue(sheetName, 6, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 11, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 9, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 11, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularThirdFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B15:D30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 15, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 16, 2, 20100007),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, 20100017),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, 20100070),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, 20100076),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, 20100083),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, 20100085),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, 20100090),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 3, "Location"),
					new ExpectedCellValue(sheetName, 16, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 15, 4, "Month"),
					new ExpectedCellValue(sheetName, 16, 4, "January"),
					new ExpectedCellValue(sheetName, 17, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 4, "March"),
					new ExpectedCellValue(sheetName, 19, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 4, "February"),
					new ExpectedCellValue(sheetName, 21, 4, "Tent"),
					new ExpectedCellValue(sheetName, 22, 4, "January"),
					new ExpectedCellValue(sheetName, 23, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 4, "March"),
					new ExpectedCellValue(sheetName, 25, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 26, 4, "February"),
					new ExpectedCellValue(sheetName, 27, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 4, "January"),
					new ExpectedCellValue(sheetName, 29, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 30, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularLastTwoFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G15:I30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 15, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 16, 7, 20100007),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, 20100017),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, 20100070),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, 20100076),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, 20100083),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, 20100085),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, 20100090),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 8, "Location"),
					new ExpectedCellValue(sheetName, 16, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 15, 9, "Month"),
					new ExpectedCellValue(sheetName, 16, 9, "January"),
					new ExpectedCellValue(sheetName, 17, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 9, "March"),
					new ExpectedCellValue(sheetName, 19, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 9, "February"),
					new ExpectedCellValue(sheetName, 21, 9, "Tent"),
					new ExpectedCellValue(sheetName, 22, 9, "January"),
					new ExpectedCellValue(sheetName, 23, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 9, "March"),
					new ExpectedCellValue(sheetName, 25, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 26, 9, "February"),
					new ExpectedCellValue(sheetName, 27, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 9, "January"),
					new ExpectedCellValue(sheetName, 29, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 30, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B35:D50"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 35, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 36, 2, 20100007),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, 20100017),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, 20100070),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, 20100076),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, 20100083),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, 20100085),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, 20100090),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 35, 3, "Location"),
					new ExpectedCellValue(sheetName, 36, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 37, 3, "January"),
					new ExpectedCellValue(sheetName, 38, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 39, 3, "March"),
					new ExpectedCellValue(sheetName, 40, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 41, 3, "February"),
					new ExpectedCellValue(sheetName, 42, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 43, 3, "January"),
					new ExpectedCellValue(sheetName, 44, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 45, 3, "March"),
					new ExpectedCellValue(sheetName, 46, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 47, 3, "February"),
					new ExpectedCellValue(sheetName, 48, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 3, "January"),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 35, 4, "Item"),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, "Tent"),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondAndLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G35:I50"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 35, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 36, 7, 20100007),
					new ExpectedCellValue(sheetName, 37, 7, null),
					new ExpectedCellValue(sheetName, 38, 7, 20100017),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, 20100070),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, 20100076),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, 20100083),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, 20100085),
					new ExpectedCellValue(sheetName, 47, 7, null),
					new ExpectedCellValue(sheetName, 48, 7, 20100090),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 35, 8, "Location"),
					new ExpectedCellValue(sheetName, 36, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 37, 8, "January"),
					new ExpectedCellValue(sheetName, 38, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 39, 8, "March"),
					new ExpectedCellValue(sheetName, 40, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 41, 8, "February"),
					new ExpectedCellValue(sheetName, 42, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 43, 8, "January"),
					new ExpectedCellValue(sheetName, 44, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 45, 8, "March"),
					new ExpectedCellValue(sheetName, 46, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 47, 8, "February"),
					new ExpectedCellValue(sheetName, 48, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 8, "January"),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 35, 9, "Item"),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, "Tent"),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularInnerFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B55:C77"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 55, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 56, 2, 20100007),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, 20100017),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, 20100070),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, 20100076),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, 20100083),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, null),
					new ExpectedCellValue(sheetName, 71, 2, 20100085),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, 20100090),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 55, 3, "Location"),
					new ExpectedCellValue(sheetName, 56, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 57, 3, "January"),
					new ExpectedCellValue(sheetName, 58, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 59, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 60, 3, "March"),
					new ExpectedCellValue(sheetName, 61, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 62, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 3, "February"),
					new ExpectedCellValue(sheetName, 64, 3, "Tent"),
					new ExpectedCellValue(sheetName, 65, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 66, 3, "January"),
					new ExpectedCellValue(sheetName, 67, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 69, 3, "March"),
					new ExpectedCellValue(sheetName, 70, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 71, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 72, 3, "February"),
					new ExpectedCellValue(sheetName, 73, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 74, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 75, 3, "January"),
					new ExpectedCellValue(sheetName, 76, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularFirstFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F55:G77"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 55, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 56, 6, 20100007),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, 20100017),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, 20100070),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, 20100076),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, null),
					new ExpectedCellValue(sheetName, 68, 6, 20100083),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, 20100085),
					new ExpectedCellValue(sheetName, 72, 6, null),
					new ExpectedCellValue(sheetName, 73, 6, null),
					new ExpectedCellValue(sheetName, 74, 6, 20100090),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 55, 7, "Location"),
					new ExpectedCellValue(sheetName, 56, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 57, 7, "January"),
					new ExpectedCellValue(sheetName, 58, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 59, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 60, 7, "March"),
					new ExpectedCellValue(sheetName, 61, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 62, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 7, "February"),
					new ExpectedCellValue(sheetName, 64, 7, "Tent"),
					new ExpectedCellValue(sheetName, 65, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 66, 7, "January"),
					new ExpectedCellValue(sheetName, 67, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 69, 7, "March"),
					new ExpectedCellValue(sheetName, 70, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 71, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 72, 7, "February"),
					new ExpectedCellValue(sheetName, 73, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 74, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 75, 7, "January"),
					new ExpectedCellValue(sheetName, 76, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularLastFieldOnlySubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B82:B111"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 82, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 83, 2, 20100007),
					new ExpectedCellValue(sheetName, 84, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 85, 2, "January"),
					new ExpectedCellValue(sheetName, 86, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 87, 2, 20100017),
					new ExpectedCellValue(sheetName, 88, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 89, 2, "March"),
					new ExpectedCellValue(sheetName, 90, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 91, 2, 20100070),
					new ExpectedCellValue(sheetName, 92, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 93, 2, "February"),
					new ExpectedCellValue(sheetName, 94, 2, "Tent"),
					new ExpectedCellValue(sheetName, 95, 2, 20100076),
					new ExpectedCellValue(sheetName, 96, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 97, 2, "January"),
					new ExpectedCellValue(sheetName, 98, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 99, 2, 20100083),
					new ExpectedCellValue(sheetName, 100, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 101, 2, "March"),
					new ExpectedCellValue(sheetName, 102, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 103, 2, 20100085),
					new ExpectedCellValue(sheetName, 104, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 105, 2, "February"),
					new ExpectedCellValue(sheetName, 106, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 107, 2, 20100090),
					new ExpectedCellValue(sheetName, 108, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 109, 2, "January"),
					new ExpectedCellValue(sheetName, 110, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 111, 2, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularLastTwoFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E82:F104"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 82, 5, "Row Labels"),
					new ExpectedCellValue(sheetName, 83, 5, 20100007),
					new ExpectedCellValue(sheetName, 84, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 85, 5, "January"),
					new ExpectedCellValue(sheetName, 86, 5, 20100017),
					new ExpectedCellValue(sheetName, 87, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 88, 5, "March"),
					new ExpectedCellValue(sheetName, 89, 5, 20100070),
					new ExpectedCellValue(sheetName, 90, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 91, 5, "February"),
					new ExpectedCellValue(sheetName, 92, 5, 20100076),
					new ExpectedCellValue(sheetName, 93, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 94, 5, "January"),
					new ExpectedCellValue(sheetName, 95, 5, 20100083),
					new ExpectedCellValue(sheetName, 96, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 97, 5, "March"),
					new ExpectedCellValue(sheetName, 98, 5, 20100085),
					new ExpectedCellValue(sheetName, 99, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 5, "February"),
					new ExpectedCellValue(sheetName, 101, 5, 20100090),
					new ExpectedCellValue(sheetName, 102, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 103, 5, "January"),
					new ExpectedCellValue(sheetName, 104, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 82, 6, "Item"),
					new ExpectedCellValue(sheetName, 83, 6, null),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 6, null),
					new ExpectedCellValue(sheetName, 87, 6, null),
					new ExpectedCellValue(sheetName, 88, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 6, null),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 91, 6, "Tent"),
					new ExpectedCellValue(sheetName, 92, 6, null),
					new ExpectedCellValue(sheetName, 93, 6, null),
					new ExpectedCellValue(sheetName, 94, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 95, 6, null),
					new ExpectedCellValue(sheetName, 96, 6, null),
					new ExpectedCellValue(sheetName, 97, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 98, 6, null),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 100, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 101, 6, null),
					new ExpectedCellValue(sheetName, 102, 6, null),
					new ExpectedCellValue(sheetName, 103, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 104, 6, null),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularThirdFieldOnlySubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I82:J104"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 82, 9, "Row Labels"),
					new ExpectedCellValue(sheetName, 83, 9, 20100007),
					new ExpectedCellValue(sheetName, 84, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 85, 9, "January"),
					new ExpectedCellValue(sheetName, 86, 9, 20100017),
					new ExpectedCellValue(sheetName, 87, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 88, 9, "March"),
					new ExpectedCellValue(sheetName, 89, 9, 20100070),
					new ExpectedCellValue(sheetName, 90, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 91, 9, "February"),
					new ExpectedCellValue(sheetName, 92, 9, 20100076),
					new ExpectedCellValue(sheetName, 93, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 94, 9, "January"),
					new ExpectedCellValue(sheetName, 95, 9, 20100083),
					new ExpectedCellValue(sheetName, 96, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 97, 9, "March"),
					new ExpectedCellValue(sheetName, 98, 9, 20100085),
					new ExpectedCellValue(sheetName, 99, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 9, "February"),
					new ExpectedCellValue(sheetName, 101, 9, 20100090),
					new ExpectedCellValue(sheetName, 102, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 103, 9, "January"),
					new ExpectedCellValue(sheetName, 104, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 82, 10, "Item"),
					new ExpectedCellValue(sheetName, 83, 10, null),
					new ExpectedCellValue(sheetName, 84, 10, null),
					new ExpectedCellValue(sheetName, 85, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 10, null),
					new ExpectedCellValue(sheetName, 87, 10, null),
					new ExpectedCellValue(sheetName, 88, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 10, null),
					new ExpectedCellValue(sheetName, 99, 10, null),
					new ExpectedCellValue(sheetName, 91, 10, "Tent"),
					new ExpectedCellValue(sheetName, 92, 10, null),
					new ExpectedCellValue(sheetName, 93, 10, null),
					new ExpectedCellValue(sheetName, 94, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 95, 10, null),
					new ExpectedCellValue(sheetName, 96, 10, null),
					new ExpectedCellValue(sheetName, 97, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 98, 10, null),
					new ExpectedCellValue(sheetName, 99, 10, null),
					new ExpectedCellValue(sheetName, 100, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 101, 10, null),
					new ExpectedCellValue(sheetName, 102, 10, null),
					new ExpectedCellValue(sheetName, 103, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 104, 10, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularSecondFieldOnlySubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B117:C139"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 117, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 118, 2, 20100007),
					new ExpectedCellValue(sheetName, 119, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 120, 2, null),
					new ExpectedCellValue(sheetName, 121, 2, 20100017),
					new ExpectedCellValue(sheetName, 122, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 123, 2, null),
					new ExpectedCellValue(sheetName, 124, 2, 20100070),
					new ExpectedCellValue(sheetName, 125, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 2, null),
					new ExpectedCellValue(sheetName, 127, 2, 20100076),
					new ExpectedCellValue(sheetName, 128, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 129, 2, null),
					new ExpectedCellValue(sheetName, 130, 2, 20100083),
					new ExpectedCellValue(sheetName, 131, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 132, 2, null),
					new ExpectedCellValue(sheetName, 133, 2, 20100085),
					new ExpectedCellValue(sheetName, 134, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 2, null),
					new ExpectedCellValue(sheetName, 136, 2, 20100090),
					new ExpectedCellValue(sheetName, 137, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 138, 2, null),
					new ExpectedCellValue(sheetName, 139, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 117, 3, "Month"),
					new ExpectedCellValue(sheetName, 118, 3, null),
					new ExpectedCellValue(sheetName, 119, 3, "January"),
					new ExpectedCellValue(sheetName, 120, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 121, 3, null),
					new ExpectedCellValue(sheetName, 122, 3, "March"),
					new ExpectedCellValue(sheetName, 123, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 3, null),
					new ExpectedCellValue(sheetName, 125, 3, "February"),
					new ExpectedCellValue(sheetName, 126, 3, "Tent"),
					new ExpectedCellValue(sheetName, 127, 3, null),
					new ExpectedCellValue(sheetName, 128, 3, "January"),
					new ExpectedCellValue(sheetName, 129, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 130, 3, null),
					new ExpectedCellValue(sheetName, 131, 3, "March"),
					new ExpectedCellValue(sheetName, 132, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 133, 3, null),
					new ExpectedCellValue(sheetName, 134, 3, "February"),
					new ExpectedCellValue(sheetName, 135, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, "January"),
					new ExpectedCellValue(sheetName, 138, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 139, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularSecondAndLastFieldsOnlySubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F117:G139"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 117, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 118, 6, 20100007),
					new ExpectedCellValue(sheetName, 119, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 120, 6, null),
					new ExpectedCellValue(sheetName, 121, 6, 20100017),
					new ExpectedCellValue(sheetName, 122, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 123, 6, null),
					new ExpectedCellValue(sheetName, 124, 6, 20100070),
					new ExpectedCellValue(sheetName, 125, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 6, null),
					new ExpectedCellValue(sheetName, 127, 6, 20100076),
					new ExpectedCellValue(sheetName, 128, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 129, 6, null),
					new ExpectedCellValue(sheetName, 130, 6, 20100083),
					new ExpectedCellValue(sheetName, 131, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 132, 6, null),
					new ExpectedCellValue(sheetName, 133, 6, 20100085),
					new ExpectedCellValue(sheetName, 134, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 6, null),
					new ExpectedCellValue(sheetName, 136, 6, 20100090),
					new ExpectedCellValue(sheetName, 137, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 138, 6, null),
					new ExpectedCellValue(sheetName, 139, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 117, 7, "Month"),
					new ExpectedCellValue(sheetName, 118, 7, null),
					new ExpectedCellValue(sheetName, 119, 7, "January"),
					new ExpectedCellValue(sheetName, 120, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 121, 7, null),
					new ExpectedCellValue(sheetName, 122, 7, "March"),
					new ExpectedCellValue(sheetName, 123, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 7, null),
					new ExpectedCellValue(sheetName, 125, 7, "February"),
					new ExpectedCellValue(sheetName, 126, 7, "Tent"),
					new ExpectedCellValue(sheetName, 127, 7, null),
					new ExpectedCellValue(sheetName, 128, 7, "January"),
					new ExpectedCellValue(sheetName, 129, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 130, 7, null),
					new ExpectedCellValue(sheetName, 131, 7, "March"),
					new ExpectedCellValue(sheetName, 132, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 133, 7, null),
					new ExpectedCellValue(sheetName, 134, 7, "February"),
					new ExpectedCellValue(sheetName, 135, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 136, 7, null),
					new ExpectedCellValue(sheetName, 137, 7, "January"),
					new ExpectedCellValue(sheetName, 138, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 139, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularFirstFieldOnlySubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B144:D159"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 144, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 145, 2, 20100007),
					new ExpectedCellValue(sheetName, 146, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 147, 2, 20100017),
					new ExpectedCellValue(sheetName, 148, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 149, 2, 20100070),
					new ExpectedCellValue(sheetName, 150, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 151, 2, 20100076),
					new ExpectedCellValue(sheetName, 152, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 2, 20100083),
					new ExpectedCellValue(sheetName, 154, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 155, 2, 20100085),
					new ExpectedCellValue(sheetName, 156, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 157, 2, 20100090),
					new ExpectedCellValue(sheetName, 158, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 159, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 144, 3, "Month"),
					new ExpectedCellValue(sheetName, 145, 3, null),
					new ExpectedCellValue(sheetName, 146, 3, "January"),
					new ExpectedCellValue(sheetName, 147, 3, null),
					new ExpectedCellValue(sheetName, 148, 3, "March"),
					new ExpectedCellValue(sheetName, 149, 3, null),
					new ExpectedCellValue(sheetName, 150, 3, "February"),
					new ExpectedCellValue(sheetName, 151, 3, null),
					new ExpectedCellValue(sheetName, 152, 3, "January"),
					new ExpectedCellValue(sheetName, 153, 3, null),
					new ExpectedCellValue(sheetName, 154, 3, "March"),
					new ExpectedCellValue(sheetName, 155, 3, null),
					new ExpectedCellValue(sheetName, 156, 3, "February"),
					new ExpectedCellValue(sheetName, 157, 3, null),
					new ExpectedCellValue(sheetName, 158, 3, "January"),
					new ExpectedCellValue(sheetName, 159, 3, null),
					new ExpectedCellValue(sheetName, 144, 4, "Item"),
					new ExpectedCellValue(sheetName, 145, 4, null),
					new ExpectedCellValue(sheetName, 146, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 4, null),
					new ExpectedCellValue(sheetName, 148, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 149, 4, null),
					new ExpectedCellValue(sheetName, 150, 4, "Tent"),
					new ExpectedCellValue(sheetName, 151, 4, null),
					new ExpectedCellValue(sheetName, 152, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 153, 4, null),
					new ExpectedCellValue(sheetName, 154, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 155, 4, null),
					new ExpectedCellValue(sheetName, 156, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 157, 4, null),
					new ExpectedCellValue(sheetName, 158, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOff.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularFirstAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOff.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Off;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G144:I159"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 144, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 145, 7, 20100007),
					new ExpectedCellValue(sheetName, 146, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 147, 7, 20100017),
					new ExpectedCellValue(sheetName, 148, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 149, 7, 20100070),
					new ExpectedCellValue(sheetName, 150, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 151, 7, 20100076),
					new ExpectedCellValue(sheetName, 152, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 7, 20100083),
					new ExpectedCellValue(sheetName, 154, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 155, 7, 20100085),
					new ExpectedCellValue(sheetName, 156, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 157, 7, 20100090),
					new ExpectedCellValue(sheetName, 158, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 159, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 144, 8, "Month"),
					new ExpectedCellValue(sheetName, 145, 8, null),
					new ExpectedCellValue(sheetName, 146, 8, "January"),
					new ExpectedCellValue(sheetName, 147, 8, null),
					new ExpectedCellValue(sheetName, 148, 8, "March"),
					new ExpectedCellValue(sheetName, 149, 8, null),
					new ExpectedCellValue(sheetName, 150, 8, "February"),
					new ExpectedCellValue(sheetName, 151, 8, null),
					new ExpectedCellValue(sheetName, 152, 8, "January"),
					new ExpectedCellValue(sheetName, 153, 8, null),
					new ExpectedCellValue(sheetName, 154, 8, "March"),
					new ExpectedCellValue(sheetName, 155, 8, null),
					new ExpectedCellValue(sheetName, 156, 8, "February"),
					new ExpectedCellValue(sheetName, 157, 8, null),
					new ExpectedCellValue(sheetName, 158, 8, "January"),
					new ExpectedCellValue(sheetName, 159, 8, null),
					new ExpectedCellValue(sheetName, 144, 9, "Item"),
					new ExpectedCellValue(sheetName, 145, 9, null),
					new ExpectedCellValue(sheetName, 146, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 9, null),
					new ExpectedCellValue(sheetName, 148, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 149, 9, null),
					new ExpectedCellValue(sheetName, 150, 9, "Tent"),
					new ExpectedCellValue(sheetName, 151, 9, null),
					new ExpectedCellValue(sheetName, 152, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 153, 9, null),
					new ExpectedCellValue(sheetName, 154, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 155, 9, null),
					new ExpectedCellValue(sheetName, 156, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 157, 9, null),
					new ExpectedCellValue(sheetName, 158, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 9, null)
				});
			}
		}
		#endregion

		#region Tabular Row Headers With Subtotals On Tests
		// 2-combo
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsBothTabularSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:C13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 6, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 10, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 13, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 3, "March"),
					new ExpectedCellValue(sheetName, 5, 3, null),
					new ExpectedCellValue(sheetName, 6, 3, "January"),
					new ExpectedCellValue(sheetName, 7, 3, "February"),
					new ExpectedCellValue(sheetName, 8, 3, "March"),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, "January"),
					new ExpectedCellValue(sheetName, 11, 3, "February"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsBothTabularSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E2:F13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 5, 5, "Chicago Total"),
					new ExpectedCellValue(sheetName, 6, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 5, null),
					new ExpectedCellValue(sheetName, 8, 5, null),
					new ExpectedCellValue(sheetName, 9, 5, "Nashville Total"),
					new ExpectedCellValue(sheetName, 10, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 13, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 6, "Month"),
					new ExpectedCellValue(sheetName, 3, 6, "January"),
					new ExpectedCellValue(sheetName, 4, 6, "March"),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, "January"),
					new ExpectedCellValue(sheetName, 7, 6, "February"),
					new ExpectedCellValue(sheetName, 8, 6, "March"),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, "January"),
					new ExpectedCellValue(sheetName, 11, 6, "February"),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsTabularLeafFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B18:B32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 18, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 19, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 2, "January"),
					new ExpectedCellValue(sheetName, 21, 2, "March"),
					new ExpectedCellValue(sheetName, 22, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 23, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 2, "January"),
					new ExpectedCellValue(sheetName, 25, 2, "February"),
					new ExpectedCellValue(sheetName, 26, 2, "March"),
					new ExpectedCellValue(sheetName, 27, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 28, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 29, 2, "January"),
					new ExpectedCellValue(sheetName, 30, 2, "February"),
					new ExpectedCellValue(sheetName, 31, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 32, 2, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsTabularFirstFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E18:F29"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 18, 5, "Row Labels"),
					new ExpectedCellValue(sheetName, 19, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, "Chicago Total"),
					new ExpectedCellValue(sheetName, 22, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, "Nashville Total"),
					new ExpectedCellValue(sheetName, 26, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 29, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 18, 6, "Month"),
					new ExpectedCellValue(sheetName, 19, 6, "January"),
					new ExpectedCellValue(sheetName, 20, 6, "March"),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, "January"),
					new ExpectedCellValue(sheetName, 23, 6, "February"),
					new ExpectedCellValue(sheetName, 24, 6, "March"),
					new ExpectedCellValue(sheetName, 25, 6, null),
					new ExpectedCellValue(sheetName, 26, 6, "January"),
					new ExpectedCellValue(sheetName, 27, 6, "February"),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, null),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsTwoRowFieldsTabularFirstFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I18:J29"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 18, 9, "Row Labels"),
					new ExpectedCellValue(sheetName, 19, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 22, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 26, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 29, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 18, 10, "Month"),
					new ExpectedCellValue(sheetName, 19, 10, "January"),
					new ExpectedCellValue(sheetName, 20, 10, "March"),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, "January"),
					new ExpectedCellValue(sheetName, 23, 10, "February"),
					new ExpectedCellValue(sheetName, 24, 10, "March"),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, "January"),
					new ExpectedCellValue(sheetName, 27, 10, "February"),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null)
				});
			}
		}

		// 3-combo
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsAllTabularFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B3:D21"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 21, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 3, "Month"),
					new ExpectedCellValue(sheetName, 4, 3, "January"),
					new ExpectedCellValue(sheetName, 5, 3, "January Total"),
					new ExpectedCellValue(sheetName, 6, 3, "March"),
					new ExpectedCellValue(sheetName, 7, 3, "March Total"),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, "January"),
					new ExpectedCellValue(sheetName, 10, 3, "January Total"),
					new ExpectedCellValue(sheetName, 11, 3, "February"),
					new ExpectedCellValue(sheetName, 12, 3, "February Total"),
					new ExpectedCellValue(sheetName, 13, 3, "March"),
					new ExpectedCellValue(sheetName, 14, 3, "March Total"),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, "January"),
					new ExpectedCellValue(sheetName, 17, 3, "January Total"),
					new ExpectedCellValue(sheetName, 18, 3, "February"),
					new ExpectedCellValue(sheetName, 19, 3, "February Total"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 3, 4, "Item"),
					new ExpectedCellValue(sheetName, 4, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, "Tent"),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsAllTabularFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F3:H21"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 21, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 7, "Month"),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, "January Total"),
					new ExpectedCellValue(sheetName, 6, 7, "March"),
					new ExpectedCellValue(sheetName, 7, 7, "March Total"),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, "January"),
					new ExpectedCellValue(sheetName, 10, 7, "January Total"),
					new ExpectedCellValue(sheetName, 11, 7, "February"),
					new ExpectedCellValue(sheetName, 12, 7, "February Total"),
					new ExpectedCellValue(sheetName, 13, 7, "March"),
					new ExpectedCellValue(sheetName, 14, 7, "March Total"),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, "January"),
					new ExpectedCellValue(sheetName, 17, 7, "January Total"),
					new ExpectedCellValue(sheetName, 18, 7, "February"),
					new ExpectedCellValue(sheetName, 19, 7, "February Total"),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 3, 8, "Item"),
					new ExpectedCellValue(sheetName, 4, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, "Tent"),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsLastFieldRegularSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B26:D44"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 26, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 27, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 32, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, null),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 39, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 44, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 26, 3, "Month"),
					new ExpectedCellValue(sheetName, 27, 3, "January"),
					new ExpectedCellValue(sheetName, 28, 3, "January Total"),
					new ExpectedCellValue(sheetName, 29, 3, "March"),
					new ExpectedCellValue(sheetName, 30, 3, "March Total"),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, "January"),
					new ExpectedCellValue(sheetName, 33, 3, "January Total"),
					new ExpectedCellValue(sheetName, 34, 3, "February"),
					new ExpectedCellValue(sheetName, 35, 3, "February Total"),
					new ExpectedCellValue(sheetName, 36, 3, "March"),
					new ExpectedCellValue(sheetName, 37, 3, "March Total"),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, "January"),
					new ExpectedCellValue(sheetName, 40, 3, "January Total"),
					new ExpectedCellValue(sheetName, 41, 3, "February"),
					new ExpectedCellValue(sheetName, 42, 3, "February Total"),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 26, 4, "Item"),
					new ExpectedCellValue(sheetName, 27, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, "Tent"),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsLastFieldRegularSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F26:H44"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 26, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 27, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 32, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, null),
					new ExpectedCellValue(sheetName, 35, 6, null),
					new ExpectedCellValue(sheetName, 36, 6, null),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 39, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 6, null),
					new ExpectedCellValue(sheetName, 41, 6, null),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 44, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 26, 7, "Month"),
					new ExpectedCellValue(sheetName, 27, 7, "January"),
					new ExpectedCellValue(sheetName, 28, 7, "January Total"),
					new ExpectedCellValue(sheetName, 29, 7, "March"),
					new ExpectedCellValue(sheetName, 30, 7, "March Total"),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, "January"),
					new ExpectedCellValue(sheetName, 33, 7, "January Total"),
					new ExpectedCellValue(sheetName, 34, 7, "February"),
					new ExpectedCellValue(sheetName, 35, 7, "February Total"),
					new ExpectedCellValue(sheetName, 36, 7, "March"),
					new ExpectedCellValue(sheetName, 37, 7, "March Total"),
					new ExpectedCellValue(sheetName, 38, 7, null),
					new ExpectedCellValue(sheetName, 39, 7, "January"),
					new ExpectedCellValue(sheetName, 40, 7, "January Total"),
					new ExpectedCellValue(sheetName, 41, 7, "February"),
					new ExpectedCellValue(sheetName, 42, 7, "February Total"),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, null),
					new ExpectedCellValue(sheetName, 26, 8, "Item"),
					new ExpectedCellValue(sheetName, 27, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, "Tent"),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularInnerFieldSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B49:C67"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 49, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 50, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 55, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 62, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 67, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 49, 3, "Month"),
					new ExpectedCellValue(sheetName, 50, 3, "January"),
					new ExpectedCellValue(sheetName, 51, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 3, "March"),
					new ExpectedCellValue(sheetName, 53, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, "January"),
					new ExpectedCellValue(sheetName, 56, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 57, 3, "February"),
					new ExpectedCellValue(sheetName, 58, 3, "Tent"),
					new ExpectedCellValue(sheetName, 59, 3, "March"),
					new ExpectedCellValue(sheetName, 60, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, "January"),
					new ExpectedCellValue(sheetName, 63, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 64, 3, "February"),
					new ExpectedCellValue(sheetName, 65, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularInnerFieldSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F49:G74"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 49, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 50, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 57, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, null),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 67, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 68, 6, null),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, null),
					new ExpectedCellValue(sheetName, 73, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 74, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 49, 7, "Month"),
					new ExpectedCellValue(sheetName, 50, 7, "January"),
					new ExpectedCellValue(sheetName, 51, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 7, "January Total"),
					new ExpectedCellValue(sheetName, 53, 7, "March"),
					new ExpectedCellValue(sheetName, 54, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 55, 7, "March Total"),
					new ExpectedCellValue(sheetName, 56, 7, null),
					new ExpectedCellValue(sheetName, 57, 7, "January"),
					new ExpectedCellValue(sheetName, 58, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 59, 7, "January Total"),
					new ExpectedCellValue(sheetName, 60, 7, "February"),
					new ExpectedCellValue(sheetName, 61, 7, "Tent"),
					new ExpectedCellValue(sheetName, 62, 7, "February Total"),
					new ExpectedCellValue(sheetName, 63, 7, "March"),
					new ExpectedCellValue(sheetName, 64, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 7, "March Total"),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, "January"),
					new ExpectedCellValue(sheetName, 68, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 7, "January Total"),
					new ExpectedCellValue(sheetName, 70, 7, "February"),
					new ExpectedCellValue(sheetName, 71, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 72, 7, "February Total"),
					new ExpectedCellValue(sheetName, 73, 7, null),
					new ExpectedCellValue(sheetName, 74, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularFirstFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B78:C96"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 78, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 79, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 80, 2, null),
					new ExpectedCellValue(sheetName, 81, 2, null),
					new ExpectedCellValue(sheetName, 82, 2, null),
					new ExpectedCellValue(sheetName, 83, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 84, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, null),
					new ExpectedCellValue(sheetName, 87, 2, null),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 90, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 91, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 92, 2, null),
					new ExpectedCellValue(sheetName, 93, 2, null),
					new ExpectedCellValue(sheetName, 94, 2, null),
					new ExpectedCellValue(sheetName, 95, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 96, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 78, 3, "Month"),
					new ExpectedCellValue(sheetName, 79, 3, "January"),
					new ExpectedCellValue(sheetName, 80, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 3, "March"),
					new ExpectedCellValue(sheetName, 82, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, "January"),
					new ExpectedCellValue(sheetName, 85, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 3, "February"),
					new ExpectedCellValue(sheetName, 87, 3, "Tent"),
					new ExpectedCellValue(sheetName, 88, 3, "March"),
					new ExpectedCellValue(sheetName, 89, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 90, 3, null),
					new ExpectedCellValue(sheetName, 91, 3, "January"),
					new ExpectedCellValue(sheetName, 92, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 93, 3, "February"),
					new ExpectedCellValue(sheetName, 94, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularFirstFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F78:G103"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 78, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 79, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 80, 6, null),
					new ExpectedCellValue(sheetName, 81, 6, null),
					new ExpectedCellValue(sheetName, 82, 6, null),
					new ExpectedCellValue(sheetName, 83, 6, null),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 86, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 87, 6, null),
					new ExpectedCellValue(sheetName, 88, 6, null),
					new ExpectedCellValue(sheetName, 89, 6, null),
					new ExpectedCellValue(sheetName, 90, 6, null),
					new ExpectedCellValue(sheetName, 91, 6, null),
					new ExpectedCellValue(sheetName, 92, 6, null),
					new ExpectedCellValue(sheetName, 93, 6, null),
					new ExpectedCellValue(sheetName, 94, 6, null),
					new ExpectedCellValue(sheetName, 95, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 96, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 97, 6, null),
					new ExpectedCellValue(sheetName, 98, 6, null),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 100, 6, null),
					new ExpectedCellValue(sheetName, 101, 6, null),
					new ExpectedCellValue(sheetName, 102, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 103, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 78, 7, "Month"),
					new ExpectedCellValue(sheetName, 79, 7, "January"),
					new ExpectedCellValue(sheetName, 80, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 7, "January Total"),
					new ExpectedCellValue(sheetName, 82, 7, "March"),
					new ExpectedCellValue(sheetName, 83, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 84, 7, "March Total"),
					new ExpectedCellValue(sheetName, 85, 7, null),
					new ExpectedCellValue(sheetName, 86, 7, "January"),
					new ExpectedCellValue(sheetName, 87, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 88, 7, "January Total"),
					new ExpectedCellValue(sheetName, 89, 7, "February"),
					new ExpectedCellValue(sheetName, 90, 7, "Tent"),
					new ExpectedCellValue(sheetName, 91, 7, "February Total"),
					new ExpectedCellValue(sheetName, 92, 7, "March"),
					new ExpectedCellValue(sheetName, 93, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 94, 7, "March Total"),
					new ExpectedCellValue(sheetName, 95, 7, null),
					new ExpectedCellValue(sheetName, 96, 7, "January"),
					new ExpectedCellValue(sheetName, 97, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 98, 7, "January Total"),
					new ExpectedCellValue(sheetName, 99, 7, "February"),
					new ExpectedCellValue(sheetName, 100, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 101, 7, "February Total"),
					new ExpectedCellValue(sheetName, 102, 7, null),
					new ExpectedCellValue(sheetName, 103, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularFirstFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B107:C125"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 107, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 108, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 109, 2, "January"),
					new ExpectedCellValue(sheetName, 110, 2, "January Total"),
					new ExpectedCellValue(sheetName, 111, 2, "March"),
					new ExpectedCellValue(sheetName, 112, 2, "March Total"),
					new ExpectedCellValue(sheetName, 113, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 114, 2, "January"),
					new ExpectedCellValue(sheetName, 115, 2, "January Total"),
					new ExpectedCellValue(sheetName, 116, 2, "February"),
					new ExpectedCellValue(sheetName, 117, 2, "February Total"),
					new ExpectedCellValue(sheetName, 118, 2, "March"),
					new ExpectedCellValue(sheetName, 119, 2, "March Total"),
					new ExpectedCellValue(sheetName, 120, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 121, 2, "January"),
					new ExpectedCellValue(sheetName, 122, 2, "January Total"),
					new ExpectedCellValue(sheetName, 123, 2, "February"),
					new ExpectedCellValue(sheetName, 124, 2, "February Total"),
					new ExpectedCellValue(sheetName, 125, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 107, 3, "Item"),
					new ExpectedCellValue(sheetName, 108, 3, null),
					new ExpectedCellValue(sheetName, 109, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 110, 3, null),
					new ExpectedCellValue(sheetName, 111, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 112, 3, null),
					new ExpectedCellValue(sheetName, 113, 3, null),
					new ExpectedCellValue(sheetName, 114, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 115, 3, null),
					new ExpectedCellValue(sheetName, 116, 3, "Tent"),
					new ExpectedCellValue(sheetName, 117, 3, null),
					new ExpectedCellValue(sheetName, 118, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 119, 3, null),
					new ExpectedCellValue(sheetName, 120, 3, null),
					new ExpectedCellValue(sheetName, 121, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 3, null),
					new ExpectedCellValue(sheetName, 123, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 124, 3, null),
					new ExpectedCellValue(sheetName, 125, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsRegularFirstFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F107:G128"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 107, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 108, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 109, 6, "January"),
					new ExpectedCellValue(sheetName, 110, 6, "January Total"),
					new ExpectedCellValue(sheetName, 111, 6, "March"),
					new ExpectedCellValue(sheetName, 112, 6, "March Total"),
					new ExpectedCellValue(sheetName, 113, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 114, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 115, 6, "January"),
					new ExpectedCellValue(sheetName, 116, 6, "January Total"),
					new ExpectedCellValue(sheetName, 117, 6, "February"),
					new ExpectedCellValue(sheetName, 118, 6, "February Total"),
					new ExpectedCellValue(sheetName, 119, 6, "March"),
					new ExpectedCellValue(sheetName, 120, 6, "March Total"),
					new ExpectedCellValue(sheetName, 121, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 122, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 123, 6, "January"),
					new ExpectedCellValue(sheetName, 124, 6, "January Total"),
					new ExpectedCellValue(sheetName, 125, 6, "February"),
					new ExpectedCellValue(sheetName, 126, 6, "February Total"),
					new ExpectedCellValue(sheetName, 127, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 128, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 107, 7, "Item"),
					new ExpectedCellValue(sheetName, 108, 7, null),
					new ExpectedCellValue(sheetName, 109, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 110, 7, null),
					new ExpectedCellValue(sheetName, 111, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 112, 7, null),
					new ExpectedCellValue(sheetName, 113, 7, null),
					new ExpectedCellValue(sheetName, 114, 7, null),
					new ExpectedCellValue(sheetName, 115, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 116, 7, null),
					new ExpectedCellValue(sheetName, 117, 7, "Tent"),
					new ExpectedCellValue(sheetName, 118, 7, null),
					new ExpectedCellValue(sheetName, 119, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 7, null),
					new ExpectedCellValue(sheetName, 121, 7, null),
					new ExpectedCellValue(sheetName, 122, 7, null),
					new ExpectedCellValue(sheetName, 123, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 7, null),
					new ExpectedCellValue(sheetName, 125, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 126, 7, null),
					new ExpectedCellValue(sheetName, 127, 7, null),
					new ExpectedCellValue(sheetName, 128, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularInnerFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B133:C151"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 133, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 134, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 135, 2, "January"),
					new ExpectedCellValue(sheetName, 136, 2, "January Total"),
					new ExpectedCellValue(sheetName, 137, 2, "March"),
					new ExpectedCellValue(sheetName, 138, 2, "March Total"),
					new ExpectedCellValue(sheetName, 139, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 140, 2, "January"),
					new ExpectedCellValue(sheetName, 141, 2, "January Total"),
					new ExpectedCellValue(sheetName, 142, 2, "February"),
					new ExpectedCellValue(sheetName, 143, 2, "February Total"),
					new ExpectedCellValue(sheetName, 144, 2, "March"),
					new ExpectedCellValue(sheetName, 145, 2, "March Total"),
					new ExpectedCellValue(sheetName, 146, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 147, 2, "January"),
					new ExpectedCellValue(sheetName, 148, 2, "January Total"),
					new ExpectedCellValue(sheetName, 149, 2, "February"),
					new ExpectedCellValue(sheetName, 150, 2, "February Total"),
					new ExpectedCellValue(sheetName, 151, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 133, 3, "Item"),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 140, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 3, null),
					new ExpectedCellValue(sheetName, 142, 3, "Tent"),
					new ExpectedCellValue(sheetName, 143, 3, null),
					new ExpectedCellValue(sheetName, 144, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 145, 3, null),
					new ExpectedCellValue(sheetName, 146, 3, null),
					new ExpectedCellValue(sheetName, 147, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 148, 3, null),
					new ExpectedCellValue(sheetName, 149, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 150, 3, null),
					new ExpectedCellValue(sheetName, 151, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularInnerFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F133:G154"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 133, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 134, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 135, 6, "January"),
					new ExpectedCellValue(sheetName, 136, 6, "January Total"),
					new ExpectedCellValue(sheetName, 137, 6, "March"),
					new ExpectedCellValue(sheetName, 138, 6, "March Total"),
					new ExpectedCellValue(sheetName, 139, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 140, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 141, 6, "January"),
					new ExpectedCellValue(sheetName, 142, 6, "January Total"),
					new ExpectedCellValue(sheetName, 143, 6, "February"),
					new ExpectedCellValue(sheetName, 144, 6, "February Total"),
					new ExpectedCellValue(sheetName, 145, 6, "March"),
					new ExpectedCellValue(sheetName, 146, 6, "March Total"),
					new ExpectedCellValue(sheetName, 147, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 148, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 149, 6, "January"),
					new ExpectedCellValue(sheetName, 150, 6, "January Total"),
					new ExpectedCellValue(sheetName, 151, 6, "February"),
					new ExpectedCellValue(sheetName, 152, 6, "February Total"),
					new ExpectedCellValue(sheetName, 153, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 154, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 133, 7, "Item"),
					new ExpectedCellValue(sheetName, 134, 7, null),
					new ExpectedCellValue(sheetName, 135, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 7, null),
					new ExpectedCellValue(sheetName, 137, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 138, 7, null),
					new ExpectedCellValue(sheetName, 139, 7, null),
					new ExpectedCellValue(sheetName, 140, 7, null),
					new ExpectedCellValue(sheetName, 141, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 7, null),
					new ExpectedCellValue(sheetName, 143, 7, "Tent"),
					new ExpectedCellValue(sheetName, 144, 7, null),
					new ExpectedCellValue(sheetName, 145, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 146, 7, null),
					new ExpectedCellValue(sheetName, 147, 7, null),
					new ExpectedCellValue(sheetName, 148, 7, null),
					new ExpectedCellValue(sheetName, 149, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 150, 7, null),
					new ExpectedCellValue(sheetName, 151, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 152, 7, null),
					new ExpectedCellValue(sheetName, 153, 7, null),
					new ExpectedCellValue(sheetName, 154, 7, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularLastFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B159:B187"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 159, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 160, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 161, 2, "January"),
					new ExpectedCellValue(sheetName, 162, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 163, 2, "January Total"),
					new ExpectedCellValue(sheetName, 164, 2, "March"),
					new ExpectedCellValue(sheetName, 165, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 166, 2, "March Total"),
					new ExpectedCellValue(sheetName, 167, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 168, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 169, 2, "January"),
					new ExpectedCellValue(sheetName, 170, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 171, 2, "January Total"),
					new ExpectedCellValue(sheetName, 172, 2, "February"),
					new ExpectedCellValue(sheetName, 173, 2, "Tent"),
					new ExpectedCellValue(sheetName, 174, 2, "February Total"),
					new ExpectedCellValue(sheetName, 175, 2, "March"),
					new ExpectedCellValue(sheetName, 176, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 177, 2, "March Total"),
					new ExpectedCellValue(sheetName, 178, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 179, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 180, 2, "January"),
					new ExpectedCellValue(sheetName, 181, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 182, 2, "January Total"),
					new ExpectedCellValue(sheetName, 183, 2, "February"),
					new ExpectedCellValue(sheetName, 184, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 185, 2, "February Total"),
					new ExpectedCellValue(sheetName, 186, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 187, 2, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsThreeRowFieldsTabularLastFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F159:F187"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 159, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 160, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 161, 6, "January"),
					new ExpectedCellValue(sheetName, 162, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 163, 6, "January Total"),
					new ExpectedCellValue(sheetName, 164, 6, "March"),
					new ExpectedCellValue(sheetName, 165, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 166, 6, "March Total"),
					new ExpectedCellValue(sheetName, 167, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 168, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 169, 6, "January"),
					new ExpectedCellValue(sheetName, 170, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 171, 6, "January Total"),
					new ExpectedCellValue(sheetName, 172, 6, "February"),
					new ExpectedCellValue(sheetName, 173, 6, "Tent"),
					new ExpectedCellValue(sheetName, 174, 6, "February Total"),
					new ExpectedCellValue(sheetName, 175, 6, "March"),
					new ExpectedCellValue(sheetName, 176, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 177, 6, "March Total"),
					new ExpectedCellValue(sheetName, 178, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 179, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 180, 6, "January"),
					new ExpectedCellValue(sheetName, 181, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 182, 6, "January Total"),
					new ExpectedCellValue(sheetName, 183, 6, "February"),
					new ExpectedCellValue(sheetName, 184, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 185, 6, "February Total"),
					new ExpectedCellValue(sheetName, 186, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 187, 6, "Grand Total")
				});
			}
		}

		// 4-combo
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsAllTabularFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:E31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, 20100007),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 7, 2, 20100017),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 11, 2, 20100070),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 15, 2, 20100076),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 19, 2, 20100083),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 23, 2, 20100085),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 27, 2, 20100090),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 31, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Location"),
					new ExpectedCellValue(sheetName, 3, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Month"),
					new ExpectedCellValue(sheetName, 3, 4, "January"),
					new ExpectedCellValue(sheetName, 4, 4, "January Total"),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, null),
					new ExpectedCellValue(sheetName, 7, 4, "March"),
					new ExpectedCellValue(sheetName, 8, 4, "March Total"),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, "February"),
					new ExpectedCellValue(sheetName, 12, 4, "February Total"),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, "January"),
					new ExpectedCellValue(sheetName, 16, 4, "January Total"),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, "March"),
					new ExpectedCellValue(sheetName, 20, 4, "March Total"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, "February"),
					new ExpectedCellValue(sheetName, 24, 4, "February Total"),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, "January"),
					new ExpectedCellValue(sheetName, 28, 4, "January Total"),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, "Item"),
					new ExpectedCellValue(sheetName, 3, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, null),
					new ExpectedCellValue(sheetName, 7, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 8, 5, null),
					new ExpectedCellValue(sheetName, 9, 5, null),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, "Tent"),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsAllTabularFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H2:K31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 8, 20100007),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 7, 8, 20100017),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 11, 8, 20100070),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 15, 8, 20100076),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 19, 8, 20100083),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 23, 8, 20100085),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 27, 8, 20100090),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 31, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 9, "Location"),
					new ExpectedCellValue(sheetName, 3, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, "Month"),
					new ExpectedCellValue(sheetName, 3, 10, "January"),
					new ExpectedCellValue(sheetName, 4, 10, "January Total"),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, "March"),
					new ExpectedCellValue(sheetName, 8, 10, "March Total"),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, "February"),
					new ExpectedCellValue(sheetName, 12, 10, "February Total"),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, "January"),
					new ExpectedCellValue(sheetName, 16, 10, "January Total"),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, "March"),
					new ExpectedCellValue(sheetName, 20, 10, "March Total"),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, "February"),
					new ExpectedCellValue(sheetName, 24, 10, "February Total"),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, "January"),
					new ExpectedCellValue(sheetName, 28, 10, "January Total"),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 2, 11, "Item"),
					new ExpectedCellValue(sheetName, 3, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, "Tent"),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, "Headlamp"),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularLastFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B36:E65"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 36, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 37, 2, 20100007),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 41, 2, 20100017),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 45, 2, 20100070),
					new ExpectedCellValue(sheetName, 46, 2, null),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 49, 2, 20100076),
					new ExpectedCellValue(sheetName, 50, 2, null),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 53, 2, 20100083),
					new ExpectedCellValue(sheetName, 54, 2, null),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 56, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 57, 2, 20100085),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 61, 2, 20100090),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 65, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 36, 3, "Location"),
					new ExpectedCellValue(sheetName, 37, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 36, 4, "Month"),
					new ExpectedCellValue(sheetName, 37, 4, "January"),
					new ExpectedCellValue(sheetName, 38, 4, "January Total"),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, "March"),
					new ExpectedCellValue(sheetName, 42, 4, "March Total"),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, "February"),
					new ExpectedCellValue(sheetName, 46, 4, "February Total"),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, "January"),
					new ExpectedCellValue(sheetName, 50, 4, "January Total"),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, "March"),
					new ExpectedCellValue(sheetName, 54, 4, "March Total"),
					new ExpectedCellValue(sheetName, 55, 4, null),
					new ExpectedCellValue(sheetName, 56, 4, null),
					new ExpectedCellValue(sheetName, 57, 4, "February"),
					new ExpectedCellValue(sheetName, 58, 4, "February Total"),
					new ExpectedCellValue(sheetName, 59, 4, null),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 61, 4, "January"),
					new ExpectedCellValue(sheetName, 62, 4, "January Total"),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, null),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 36, 5, "Item"),
					new ExpectedCellValue(sheetName, 37, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, "Tent"),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 54, 5, null),
					new ExpectedCellValue(sheetName, 55, 5, null),
					new ExpectedCellValue(sheetName, 56, 5, null),
					new ExpectedCellValue(sheetName, 57, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, null),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, null),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularLastFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H36:K65"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 36, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 37, 8, 20100007),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 41, 8, 20100017),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 45, 8, 20100070),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 49, 8, 20100076),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 53, 8, 20100083),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 57, 8, 20100085),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 61, 8, 20100090),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 65, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 36, 9, "Location"),
					new ExpectedCellValue(sheetName, 37, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 36, 10, "Month"),
					new ExpectedCellValue(sheetName, 37, 10, "January"),
					new ExpectedCellValue(sheetName, 38, 10, "January Total"),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, "March"),
					new ExpectedCellValue(sheetName, 42, 10, "March Total"),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, "February"),
					new ExpectedCellValue(sheetName, 46, 10, "February Total"),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, "January"),
					new ExpectedCellValue(sheetName, 50, 10, "January Total"),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, "March"),
					new ExpectedCellValue(sheetName, 54, 10, "March Total"),
					new ExpectedCellValue(sheetName, 55, 10, null),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, "February"),
					new ExpectedCellValue(sheetName, 58, 10, "February Total"),
					new ExpectedCellValue(sheetName, 59, 10, null),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, "January"),
					new ExpectedCellValue(sheetName, 62, 10, "January Total"),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 36, 11, "Item"),
					new ExpectedCellValue(sheetName, 37, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, null),
					new ExpectedCellValue(sheetName, 41, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, "Tent"),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, null),
					new ExpectedCellValue(sheetName, 49, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 53, 11, "Headlamp"),
					new ExpectedCellValue(sheetName, 54, 11, null),
					new ExpectedCellValue(sheetName, 55, 11, null),
					new ExpectedCellValue(sheetName, 56, 11, null),
					new ExpectedCellValue(sheetName, 57, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, null),
					new ExpectedCellValue(sheetName, 60, 11, null),
					new ExpectedCellValue(sheetName, 61, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, null),
					new ExpectedCellValue(sheetName, 65, 11, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularThirdFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B71:D100"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 71, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 72, 2, 20100007),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, null),
					new ExpectedCellValue(sheetName, 75, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 76, 2, 20100017),
					new ExpectedCellValue(sheetName, 77, 2, null),
					new ExpectedCellValue(sheetName, 78, 2, null),
					new ExpectedCellValue(sheetName, 79, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 80, 2, 20100070),
					new ExpectedCellValue(sheetName, 81, 2, null),
					new ExpectedCellValue(sheetName, 82, 2, null),
					new ExpectedCellValue(sheetName, 83, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 84, 2, 20100076),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, null),
					new ExpectedCellValue(sheetName, 87, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 88, 2, 20100083),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 90, 2, null),
					new ExpectedCellValue(sheetName, 91, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 92, 2, 20100085),
					new ExpectedCellValue(sheetName, 93, 2, null),
					new ExpectedCellValue(sheetName, 94, 2, null),
					new ExpectedCellValue(sheetName, 95, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 96, 2, 20100090),
					new ExpectedCellValue(sheetName, 97, 2, null),
					new ExpectedCellValue(sheetName, 98, 2, null),
					new ExpectedCellValue(sheetName, 99, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 100, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 71, 3, "Location"),
					new ExpectedCellValue(sheetName, 72, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 85, 3, null),
					new ExpectedCellValue(sheetName, 86, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 90, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 91, 3, null),
					new ExpectedCellValue(sheetName, 92, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 93, 3, null),
					new ExpectedCellValue(sheetName, 94, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 97, 3, null),
					new ExpectedCellValue(sheetName, 98, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 99, 3, null),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 71, 4, "Month"),
					new ExpectedCellValue(sheetName, 72, 4, "January"),
					new ExpectedCellValue(sheetName, 73, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 4, null),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, "March"),
					new ExpectedCellValue(sheetName, 77, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 78, 4, null),
					new ExpectedCellValue(sheetName, 79, 4, null),
					new ExpectedCellValue(sheetName, 80, 4, "February"),
					new ExpectedCellValue(sheetName, 81, 4, "Tent"),
					new ExpectedCellValue(sheetName, 82, 4, null),
					new ExpectedCellValue(sheetName, 83, 4, null),
					new ExpectedCellValue(sheetName, 84, 4, "January"),
					new ExpectedCellValue(sheetName, 85, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 4, null),
					new ExpectedCellValue(sheetName, 87, 4, null),
					new ExpectedCellValue(sheetName, 88, 4, "March"),
					new ExpectedCellValue(sheetName, 89, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 90, 4, null),
					new ExpectedCellValue(sheetName, 91, 4, null),
					new ExpectedCellValue(sheetName, 92, 4, "February"),
					new ExpectedCellValue(sheetName, 93, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 94, 4, null),
					new ExpectedCellValue(sheetName, 95, 4, null),
					new ExpectedCellValue(sheetName, 96, 4, "January"),
					new ExpectedCellValue(sheetName, 97, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 98, 4, null),
					new ExpectedCellValue(sheetName, 99, 4, null),
					new ExpectedCellValue(sheetName, 100, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularThirdFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H71:J107"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 71, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 72, 8, 20100007),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 77, 8, 20100017),
					new ExpectedCellValue(sheetName, 78, 8, null),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, null),
					new ExpectedCellValue(sheetName, 81, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 82, 8, 20100070),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, null),
					new ExpectedCellValue(sheetName, 85, 8, null),
					new ExpectedCellValue(sheetName, 86, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 87, 8, 20100076),
					new ExpectedCellValue(sheetName, 88, 8, null),
					new ExpectedCellValue(sheetName, 89, 8, null),
					new ExpectedCellValue(sheetName, 90, 8, null),
					new ExpectedCellValue(sheetName, 91, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 92, 8, 20100083),
					new ExpectedCellValue(sheetName, 93, 8, null),
					new ExpectedCellValue(sheetName, 94, 8, null),
					new ExpectedCellValue(sheetName, 95, 8, null),
					new ExpectedCellValue(sheetName, 96, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 97, 8, 20100085),
					new ExpectedCellValue(sheetName, 98, 8, null),
					new ExpectedCellValue(sheetName, 99, 8, null),
					new ExpectedCellValue(sheetName, 100, 8, null),
					new ExpectedCellValue(sheetName, 101, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 102, 8, 20100090),
					new ExpectedCellValue(sheetName, 103, 8, null),
					new ExpectedCellValue(sheetName, 104, 8, null),
					new ExpectedCellValue(sheetName, 105, 8, null),
					new ExpectedCellValue(sheetName, 106, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 107, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 71, 9, "Location"),
					new ExpectedCellValue(sheetName, 72, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 9, null),
					new ExpectedCellValue(sheetName, 74, 9, null),
					new ExpectedCellValue(sheetName, 75, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 76, 9, null),
					new ExpectedCellValue(sheetName, 77, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 78, 9, null),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 80, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 81, 9, null),
					new ExpectedCellValue(sheetName, 82, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 83, 9, null),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 86, 9, null),
					new ExpectedCellValue(sheetName, 87, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 88, 9, null),
					new ExpectedCellValue(sheetName, 89, 9, null),
					new ExpectedCellValue(sheetName, 90, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 93, 9, null),
					new ExpectedCellValue(sheetName, 94, 9, null),
					new ExpectedCellValue(sheetName, 95, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 96, 9, null),
					new ExpectedCellValue(sheetName, 97, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 9, null),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 101, 9, null),
					new ExpectedCellValue(sheetName, 102, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 103, 9, null),
					new ExpectedCellValue(sheetName, 104, 9, null),
					new ExpectedCellValue(sheetName, 105, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 106, 9, null),
					new ExpectedCellValue(sheetName, 107, 9, null),
					new ExpectedCellValue(sheetName, 71, 10, "Month"),
					new ExpectedCellValue(sheetName, 72, 10, "January"),
					new ExpectedCellValue(sheetName, 73, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 10, "January Total"),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, "March"),
					new ExpectedCellValue(sheetName, 78, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 10, "March Total"),
					new ExpectedCellValue(sheetName, 80, 10, null),
					new ExpectedCellValue(sheetName, 81, 10, null),
					new ExpectedCellValue(sheetName, 82, 10, "February"),
					new ExpectedCellValue(sheetName, 83, 10, "Tent"),
					new ExpectedCellValue(sheetName, 84, 10, "February Total"),
					new ExpectedCellValue(sheetName, 85, 10, null),
					new ExpectedCellValue(sheetName, 86, 10, null),
					new ExpectedCellValue(sheetName, 87, 10, "January"),
					new ExpectedCellValue(sheetName, 88, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 10, "January Total"),
					new ExpectedCellValue(sheetName, 90, 10, null),
					new ExpectedCellValue(sheetName, 91, 10, null),
					new ExpectedCellValue(sheetName, 92, 10, "March"),
					new ExpectedCellValue(sheetName, 93, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 94, 10, "March Total"),
					new ExpectedCellValue(sheetName, 95, 10, null),
					new ExpectedCellValue(sheetName, 96, 10, null),
					new ExpectedCellValue(sheetName, 97, 10, "February"),
					new ExpectedCellValue(sheetName, 98, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 99, 10, "February Total"),
					new ExpectedCellValue(sheetName, 100, 10, null),
					new ExpectedCellValue(sheetName, 101, 10, null),
					new ExpectedCellValue(sheetName, 102, 10, "January"),
					new ExpectedCellValue(sheetName, 103, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 104, 10, "January Total"),
					new ExpectedCellValue(sheetName, 105, 10, null),
					new ExpectedCellValue(sheetName, 106, 10, null),
					new ExpectedCellValue(sheetName, 107, 10, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularThirdAndLastFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B110:D139"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 110, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 111, 2, 20100007),
					new ExpectedCellValue(sheetName, 112, 2, null),
					new ExpectedCellValue(sheetName, 113, 2, null),
					new ExpectedCellValue(sheetName, 114, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 115, 2, 20100017),
					new ExpectedCellValue(sheetName, 116, 2, null),
					new ExpectedCellValue(sheetName, 117, 2, null),
					new ExpectedCellValue(sheetName, 118, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 119, 2, 20100070),
					new ExpectedCellValue(sheetName, 120, 2, null),
					new ExpectedCellValue(sheetName, 121, 2, null),
					new ExpectedCellValue(sheetName, 122, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 123, 2, 20100076),
					new ExpectedCellValue(sheetName, 124, 2, null),
					new ExpectedCellValue(sheetName, 125, 2, null),
					new ExpectedCellValue(sheetName, 126, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 127, 2, 20100083),
					new ExpectedCellValue(sheetName, 128, 2, null),
					new ExpectedCellValue(sheetName, 129, 2, null),
					new ExpectedCellValue(sheetName, 130, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 131, 2, 20100085),
					new ExpectedCellValue(sheetName, 132, 2, null),
					new ExpectedCellValue(sheetName, 133, 2, null),
					new ExpectedCellValue(sheetName, 134, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 135, 2, 20100090),
					new ExpectedCellValue(sheetName, 136, 2, null),
					new ExpectedCellValue(sheetName, 137, 2, null),
					new ExpectedCellValue(sheetName, 138, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 139, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 110, 3, "Location"),
					new ExpectedCellValue(sheetName, 111, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 112, 3, null),
					new ExpectedCellValue(sheetName, 113, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 114, 3, null),
					new ExpectedCellValue(sheetName, 115, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 116, 3, null),
					new ExpectedCellValue(sheetName, 117, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 118, 3, null),
					new ExpectedCellValue(sheetName, 119, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 120, 3, null),
					new ExpectedCellValue(sheetName, 121, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 122, 3, null),
					new ExpectedCellValue(sheetName, 123, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 124, 3, null),
					new ExpectedCellValue(sheetName, 125, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 126, 3, null),
					new ExpectedCellValue(sheetName, 127, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 128, 3, null),
					new ExpectedCellValue(sheetName, 129, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 130, 3, null),
					new ExpectedCellValue(sheetName, 131, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 132, 3, null),
					new ExpectedCellValue(sheetName, 133, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 110, 4, "Month"),
					new ExpectedCellValue(sheetName, 111, 4, "January"),
					new ExpectedCellValue(sheetName, 112, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 113, 4, null),
					new ExpectedCellValue(sheetName, 114, 4, null),
					new ExpectedCellValue(sheetName, 115, 4, "March"),
					new ExpectedCellValue(sheetName, 116, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 117, 4, null),
					new ExpectedCellValue(sheetName, 118, 4, null),
					new ExpectedCellValue(sheetName, 119, 4, "February"),
					new ExpectedCellValue(sheetName, 120, 4, "Tent"),
					new ExpectedCellValue(sheetName, 121, 4, null),
					new ExpectedCellValue(sheetName, 122, 4, null),
					new ExpectedCellValue(sheetName, 123, 4, "January"),
					new ExpectedCellValue(sheetName, 124, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 125, 4, null),
					new ExpectedCellValue(sheetName, 126, 4, null),
					new ExpectedCellValue(sheetName, 127, 4, "March"),
					new ExpectedCellValue(sheetName, 128, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 129, 4, null),
					new ExpectedCellValue(sheetName, 130, 4, null),
					new ExpectedCellValue(sheetName, 131, 4, "February"),
					new ExpectedCellValue(sheetName, 132, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 133, 4, null),
					new ExpectedCellValue(sheetName, 134, 4, null),
					new ExpectedCellValue(sheetName, 135, 4, "January"),
					new ExpectedCellValue(sheetName, 136, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 137, 4, null),
					new ExpectedCellValue(sheetName, 138, 4, null),
					new ExpectedCellValue(sheetName, 139, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularThirdAndLastFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H110:J146"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 110, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 111, 8, 20100007),
					new ExpectedCellValue(sheetName, 112, 8, null),
					new ExpectedCellValue(sheetName, 113, 8, null),
					new ExpectedCellValue(sheetName, 114, 8, null),
					new ExpectedCellValue(sheetName, 115, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 116, 8, 20100017),
					new ExpectedCellValue(sheetName, 117, 8, null),
					new ExpectedCellValue(sheetName, 118, 8, null),
					new ExpectedCellValue(sheetName, 119, 8, null),
					new ExpectedCellValue(sheetName, 120, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 121, 8, 20100070),
					new ExpectedCellValue(sheetName, 122, 8, null),
					new ExpectedCellValue(sheetName, 123, 8, null),
					new ExpectedCellValue(sheetName, 124, 8, null),
					new ExpectedCellValue(sheetName, 125, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 126, 8, 20100076),
					new ExpectedCellValue(sheetName, 127, 8, null),
					new ExpectedCellValue(sheetName, 128, 8, null),
					new ExpectedCellValue(sheetName, 129, 8, null),
					new ExpectedCellValue(sheetName, 130, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 131, 8, 20100083),
					new ExpectedCellValue(sheetName, 132, 8, null),
					new ExpectedCellValue(sheetName, 133, 8, null),
					new ExpectedCellValue(sheetName, 134, 8, null),
					new ExpectedCellValue(sheetName, 135, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 136, 8, 20100085),
					new ExpectedCellValue(sheetName, 137, 8, null),
					new ExpectedCellValue(sheetName, 138, 8, null),
					new ExpectedCellValue(sheetName, 139, 8, null),
					new ExpectedCellValue(sheetName, 140, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 141, 8, 20100090),
					new ExpectedCellValue(sheetName, 142, 8, null),
					new ExpectedCellValue(sheetName, 143, 8, null),
					new ExpectedCellValue(sheetName, 144, 8, null),
					new ExpectedCellValue(sheetName, 145, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 146, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 110, 9, "Location"),
					new ExpectedCellValue(sheetName, 111, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 112, 9, null),
					new ExpectedCellValue(sheetName, 113, 9, null),
					new ExpectedCellValue(sheetName, 114, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 115, 9, null),
					new ExpectedCellValue(sheetName, 116, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 117, 9, null),
					new ExpectedCellValue(sheetName, 118, 9, null),
					new ExpectedCellValue(sheetName, 119, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 120, 9, null),
					new ExpectedCellValue(sheetName, 121, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 122, 9, null),
					new ExpectedCellValue(sheetName, 123, 9, null),
					new ExpectedCellValue(sheetName, 124, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 125, 9, null),
					new ExpectedCellValue(sheetName, 126, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 127, 9, null),
					new ExpectedCellValue(sheetName, 128, 9, null),
					new ExpectedCellValue(sheetName, 129, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 130, 9, null),
					new ExpectedCellValue(sheetName, 131, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 132, 9, null),
					new ExpectedCellValue(sheetName, 133, 9, null),
					new ExpectedCellValue(sheetName, 134, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 135, 9, null),
					new ExpectedCellValue(sheetName, 136, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 137, 9, null),
					new ExpectedCellValue(sheetName, 138, 9, null),
					new ExpectedCellValue(sheetName, 139, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 140, 9, null),
					new ExpectedCellValue(sheetName, 141, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 142, 9, null),
					new ExpectedCellValue(sheetName, 143, 9, null),
					new ExpectedCellValue(sheetName, 144, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 145, 9, null),
					new ExpectedCellValue(sheetName, 146, 9, null),
					new ExpectedCellValue(sheetName, 110, 10, "Month"),
					new ExpectedCellValue(sheetName, 111, 10, "January"),
					new ExpectedCellValue(sheetName, 112, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 113, 10, "January Total"),
					new ExpectedCellValue(sheetName, 114, 10, null),
					new ExpectedCellValue(sheetName, 115, 10, null),
					new ExpectedCellValue(sheetName, 116, 10, "March"),
					new ExpectedCellValue(sheetName, 117, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 118, 10, "March Total"),
					new ExpectedCellValue(sheetName, 119, 10, null),
					new ExpectedCellValue(sheetName, 120, 10, null),
					new ExpectedCellValue(sheetName, 121, 10, "February"),
					new ExpectedCellValue(sheetName, 122, 10, "Tent"),
					new ExpectedCellValue(sheetName, 123, 10, "February Total"),
					new ExpectedCellValue(sheetName, 124, 10, null),
					new ExpectedCellValue(sheetName, 125, 10, null),
					new ExpectedCellValue(sheetName, 126, 10, "January"),
					new ExpectedCellValue(sheetName, 127, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 128, 10, "January Total"),
					new ExpectedCellValue(sheetName, 129, 10, null),
					new ExpectedCellValue(sheetName, 130, 10, null),
					new ExpectedCellValue(sheetName, 131, 10, "March"),
					new ExpectedCellValue(sheetName, 132, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 133, 10, "March Total"),
					new ExpectedCellValue(sheetName, 134, 10, null),
					new ExpectedCellValue(sheetName, 135, 10, null),
					new ExpectedCellValue(sheetName, 136, 10, "February"),
					new ExpectedCellValue(sheetName, 137, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 138, 10, "February Total"),
					new ExpectedCellValue(sheetName, 139, 10, null),
					new ExpectedCellValue(sheetName, 140, 10, null),
					new ExpectedCellValue(sheetName, 141, 10, "January"),
					new ExpectedCellValue(sheetName, 142, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 143, 10, "January Total"),
					new ExpectedCellValue(sheetName, 144, 10, null),
					new ExpectedCellValue(sheetName, 145, 10, null),
					new ExpectedCellValue(sheetName, 146, 10, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B149:D178"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 149, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 150, 2, 20100007),
					new ExpectedCellValue(sheetName, 151, 2, null),
					new ExpectedCellValue(sheetName, 152, 2, null),
					new ExpectedCellValue(sheetName, 153, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 154, 2, 20100017),
					new ExpectedCellValue(sheetName, 155, 2, null),
					new ExpectedCellValue(sheetName, 156, 2, null),
					new ExpectedCellValue(sheetName, 157, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 158, 2, 20100070),
					new ExpectedCellValue(sheetName, 159, 2, null),
					new ExpectedCellValue(sheetName, 160, 2, null),
					new ExpectedCellValue(sheetName, 161, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 162, 2, 20100076),
					new ExpectedCellValue(sheetName, 163, 2, null),
					new ExpectedCellValue(sheetName, 164, 2, null),
					new ExpectedCellValue(sheetName, 165, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 166, 2, 20100083),
					new ExpectedCellValue(sheetName, 167, 2, null),
					new ExpectedCellValue(sheetName, 168, 2, null),
					new ExpectedCellValue(sheetName, 169, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 170, 2, 20100085),
					new ExpectedCellValue(sheetName, 171, 2, null),
					new ExpectedCellValue(sheetName, 172, 2, null),
					new ExpectedCellValue(sheetName, 173, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 174, 2, 20100090),
					new ExpectedCellValue(sheetName, 175, 2, null),
					new ExpectedCellValue(sheetName, 176, 2, null),
					new ExpectedCellValue(sheetName, 177, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 178, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 149, 3, "Location"),
					new ExpectedCellValue(sheetName, 150, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 151, 3, "January"),
					new ExpectedCellValue(sheetName, 152, 3, "January Total"),
					new ExpectedCellValue(sheetName, 153, 3, null),
					new ExpectedCellValue(sheetName, 154, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 155, 3, "March"),
					new ExpectedCellValue(sheetName, 156, 3, "March Total"),
					new ExpectedCellValue(sheetName, 157, 3, null),
					new ExpectedCellValue(sheetName, 158, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 159, 3, "February"),
					new ExpectedCellValue(sheetName, 160, 3, "February Total"),
					new ExpectedCellValue(sheetName, 161, 3, null),
					new ExpectedCellValue(sheetName, 162, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 163, 3, "January"),
					new ExpectedCellValue(sheetName, 164, 3, "January Total"),
					new ExpectedCellValue(sheetName, 165, 3, null),
					new ExpectedCellValue(sheetName, 166, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 167, 3, "March"),
					new ExpectedCellValue(sheetName, 168, 3, "March Total"),
					new ExpectedCellValue(sheetName, 169, 3, null),
					new ExpectedCellValue(sheetName, 170, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 171, 3, "February"),
					new ExpectedCellValue(sheetName, 172, 3, "February Total"),
					new ExpectedCellValue(sheetName, 173, 3, null),
					new ExpectedCellValue(sheetName, 174, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 175, 3, "January"),
					new ExpectedCellValue(sheetName, 176, 3, "January Total"),
					new ExpectedCellValue(sheetName, 177, 3, null),
					new ExpectedCellValue(sheetName, 178, 3, null),
					new ExpectedCellValue(sheetName, 149, 4, "Item"),
					new ExpectedCellValue(sheetName, 150, 4, null),
					new ExpectedCellValue(sheetName, 151, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 152, 4, null),
					new ExpectedCellValue(sheetName, 153, 4, null),
					new ExpectedCellValue(sheetName, 154, 4, null),
					new ExpectedCellValue(sheetName, 155, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 156, 4, null),
					new ExpectedCellValue(sheetName, 157, 4, null),
					new ExpectedCellValue(sheetName, 158, 4, null),
					new ExpectedCellValue(sheetName, 159, 4, "Tent"),
					new ExpectedCellValue(sheetName, 160, 4, null),
					new ExpectedCellValue(sheetName, 161, 4, null),
					new ExpectedCellValue(sheetName, 162, 4, null),
					new ExpectedCellValue(sheetName, 163, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 164, 4, null),
					new ExpectedCellValue(sheetName, 165, 4, null),
					new ExpectedCellValue(sheetName, 166, 4, null),
					new ExpectedCellValue(sheetName, 167, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 168, 4, null),
					new ExpectedCellValue(sheetName, 169, 4, null),
					new ExpectedCellValue(sheetName, 170, 4, null),
					new ExpectedCellValue(sheetName, 171, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 172, 4, null),
					new ExpectedCellValue(sheetName, 173, 4, null),
					new ExpectedCellValue(sheetName, 174, 4, null),
					new ExpectedCellValue(sheetName, 175, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 176, 4, null),
					new ExpectedCellValue(sheetName, 177, 4, null),
					new ExpectedCellValue(sheetName, 178, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H149:J185"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 149, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 150, 8, 20100007),
					new ExpectedCellValue(sheetName, 151, 8, null),
					new ExpectedCellValue(sheetName, 152, 8, null),
					new ExpectedCellValue(sheetName, 153, 8, null),
					new ExpectedCellValue(sheetName, 154, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 155, 8, 20100017),
					new ExpectedCellValue(sheetName, 156, 8, null),
					new ExpectedCellValue(sheetName, 157, 8, null),
					new ExpectedCellValue(sheetName, 158, 8, null),
					new ExpectedCellValue(sheetName, 159, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 160, 8, 20100070),
					new ExpectedCellValue(sheetName, 161, 8, null),
					new ExpectedCellValue(sheetName, 162, 8, null),
					new ExpectedCellValue(sheetName, 163, 8, null),
					new ExpectedCellValue(sheetName, 164, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 165, 8, 20100076),
					new ExpectedCellValue(sheetName, 166, 8, null),
					new ExpectedCellValue(sheetName, 167, 8, null),
					new ExpectedCellValue(sheetName, 168, 8, null),
					new ExpectedCellValue(sheetName, 169, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 170, 8, 20100083),
					new ExpectedCellValue(sheetName, 171, 8, null),
					new ExpectedCellValue(sheetName, 172, 8, null),
					new ExpectedCellValue(sheetName, 173, 8, null),
					new ExpectedCellValue(sheetName, 174, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 175, 8, 20100085),
					new ExpectedCellValue(sheetName, 176, 8, null),
					new ExpectedCellValue(sheetName, 177, 8, null),
					new ExpectedCellValue(sheetName, 178, 8, null),
					new ExpectedCellValue(sheetName, 179, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 180, 8, 20100090),
					new ExpectedCellValue(sheetName, 181, 8, null),
					new ExpectedCellValue(sheetName, 182, 8, null),
					new ExpectedCellValue(sheetName, 183, 8, null),
					new ExpectedCellValue(sheetName, 184, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 185, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 149, 9, "Location"),
					new ExpectedCellValue(sheetName, 150, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 151, 9, "January"),
					new ExpectedCellValue(sheetName, 152, 9, "January Total"),
					new ExpectedCellValue(sheetName, 153, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 154, 9, null),
					new ExpectedCellValue(sheetName, 155, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 156, 9, "March"),
					new ExpectedCellValue(sheetName, 157, 9, "March Total"),
					new ExpectedCellValue(sheetName, 158, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 159, 9, null),
					new ExpectedCellValue(sheetName, 160, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 161, 9, "February"),
					new ExpectedCellValue(sheetName, 162, 9, "February Total"),
					new ExpectedCellValue(sheetName, 163, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 164, 9, null),
					new ExpectedCellValue(sheetName, 165, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 166, 9, "January"),
					new ExpectedCellValue(sheetName, 167, 9, "January Total"),
					new ExpectedCellValue(sheetName, 168, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 169, 9, null),
					new ExpectedCellValue(sheetName, 170, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 171, 9, "March"),
					new ExpectedCellValue(sheetName, 172, 9, "March Total"),
					new ExpectedCellValue(sheetName, 173, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 174, 9, null),
					new ExpectedCellValue(sheetName, 175, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 176, 9, "February"),
					new ExpectedCellValue(sheetName, 177, 9, "February Total"),
					new ExpectedCellValue(sheetName, 178, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 179, 9, null),
					new ExpectedCellValue(sheetName, 180, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 181, 9, "January"),
					new ExpectedCellValue(sheetName, 182, 9, "January Total"),
					new ExpectedCellValue(sheetName, 183, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 184, 9, null),
					new ExpectedCellValue(sheetName, 185, 9, null),
					new ExpectedCellValue(sheetName, 149, 10, "Item"),
					new ExpectedCellValue(sheetName, 150, 10, null),
					new ExpectedCellValue(sheetName, 151, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 152, 10, null),
					new ExpectedCellValue(sheetName, 153, 10, null),
					new ExpectedCellValue(sheetName, 154, 10, null),
					new ExpectedCellValue(sheetName, 155, 10, null),
					new ExpectedCellValue(sheetName, 156, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 157, 10, null),
					new ExpectedCellValue(sheetName, 158, 10, null),
					new ExpectedCellValue(sheetName, 159, 10, null),
					new ExpectedCellValue(sheetName, 160, 10, null),
					new ExpectedCellValue(sheetName, 161, 10, "Tent"),
					new ExpectedCellValue(sheetName, 162, 10, null),
					new ExpectedCellValue(sheetName, 163, 10, null),
					new ExpectedCellValue(sheetName, 164, 10, null),
					new ExpectedCellValue(sheetName, 165, 10, null),
					new ExpectedCellValue(sheetName, 166, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 167, 10, null),
					new ExpectedCellValue(sheetName, 168, 10, null),
					new ExpectedCellValue(sheetName, 169, 10, null),
					new ExpectedCellValue(sheetName, 170, 10, null),
					new ExpectedCellValue(sheetName, 171, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 172, 10, null),
					new ExpectedCellValue(sheetName, 173, 10, null),
					new ExpectedCellValue(sheetName, 174, 10, null),
					new ExpectedCellValue(sheetName, 175, 10, null),
					new ExpectedCellValue(sheetName, 176, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 177, 10, null),
					new ExpectedCellValue(sheetName, 178, 10, null),
					new ExpectedCellValue(sheetName, 179, 10, null),
					new ExpectedCellValue(sheetName, 180, 10, null),
					new ExpectedCellValue(sheetName, 181, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 182, 10, null),
					new ExpectedCellValue(sheetName, 183, 10, null),
					new ExpectedCellValue(sheetName, 184, 10, null),
					new ExpectedCellValue(sheetName, 185, 10, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondAndLastFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B189:D218"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 189, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 190, 2, 20100007),
					new ExpectedCellValue(sheetName, 191, 2, null),
					new ExpectedCellValue(sheetName, 192, 2, null),
					new ExpectedCellValue(sheetName, 193, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 194, 2, 20100017),
					new ExpectedCellValue(sheetName, 195, 2, null),
					new ExpectedCellValue(sheetName, 196, 2, null),
					new ExpectedCellValue(sheetName, 197, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 198, 2, 20100070),
					new ExpectedCellValue(sheetName, 199, 2, null),
					new ExpectedCellValue(sheetName, 200, 2, null),
					new ExpectedCellValue(sheetName, 201, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 202, 2, 20100076),
					new ExpectedCellValue(sheetName, 203, 2, null),
					new ExpectedCellValue(sheetName, 204, 2, null),
					new ExpectedCellValue(sheetName, 205, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 206, 2, 20100083),
					new ExpectedCellValue(sheetName, 207, 2, null),
					new ExpectedCellValue(sheetName, 208, 2, null),
					new ExpectedCellValue(sheetName, 209, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 210, 2, 20100085),
					new ExpectedCellValue(sheetName, 211, 2, null),
					new ExpectedCellValue(sheetName, 212, 2, null),
					new ExpectedCellValue(sheetName, 213, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 214, 2, 20100090),
					new ExpectedCellValue(sheetName, 215, 2, null),
					new ExpectedCellValue(sheetName, 216, 2, null),
					new ExpectedCellValue(sheetName, 217, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 218, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 189, 3, "Location"),
					new ExpectedCellValue(sheetName, 190, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 191, 3, "January"),
					new ExpectedCellValue(sheetName, 192, 3, "January Total"),
					new ExpectedCellValue(sheetName, 193, 3, null),
					new ExpectedCellValue(sheetName, 194, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 195, 3, "March"),
					new ExpectedCellValue(sheetName, 196, 3, "March Total"),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 199, 3, "February"),
					new ExpectedCellValue(sheetName, 200, 3, "February Total"),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 203, 3, "January"),
					new ExpectedCellValue(sheetName, 204, 3, "January Total"),
					new ExpectedCellValue(sheetName, 205, 3, null),
					new ExpectedCellValue(sheetName, 206, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 207, 3, "March"),
					new ExpectedCellValue(sheetName, 208, 3, "March Total"),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 210, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 211, 3, "February"),
					new ExpectedCellValue(sheetName, 212, 3, "February Total"),
					new ExpectedCellValue(sheetName, 213, 3, null),
					new ExpectedCellValue(sheetName, 214, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 215, 3, "January"),
					new ExpectedCellValue(sheetName, 216, 3, "January Total"),
					new ExpectedCellValue(sheetName, 217, 3, null),
					new ExpectedCellValue(sheetName, 218, 3, null),
					new ExpectedCellValue(sheetName, 189, 4, "Item"),
					new ExpectedCellValue(sheetName, 190, 4, null),
					new ExpectedCellValue(sheetName, 191, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 4, null),
					new ExpectedCellValue(sheetName, 193, 4, null),
					new ExpectedCellValue(sheetName, 194, 4, null),
					new ExpectedCellValue(sheetName, 195, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 196, 4, null),
					new ExpectedCellValue(sheetName, 197, 4, null),
					new ExpectedCellValue(sheetName, 198, 4, null),
					new ExpectedCellValue(sheetName, 199, 4, "Tent"),
					new ExpectedCellValue(sheetName, 200, 4, null),
					new ExpectedCellValue(sheetName, 201, 4, null),
					new ExpectedCellValue(sheetName, 202, 4, null),
					new ExpectedCellValue(sheetName, 203, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 204, 4, null),
					new ExpectedCellValue(sheetName, 205, 4, null),
					new ExpectedCellValue(sheetName, 206, 4, null),
					new ExpectedCellValue(sheetName, 207, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 208, 4, null),
					new ExpectedCellValue(sheetName, 209, 4, null),
					new ExpectedCellValue(sheetName, 210, 4, null),
					new ExpectedCellValue(sheetName, 211, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 212, 4, null),
					new ExpectedCellValue(sheetName, 213, 4, null),
					new ExpectedCellValue(sheetName, 214, 4, null),
					new ExpectedCellValue(sheetName, 215, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 216, 4, null),
					new ExpectedCellValue(sheetName, 217, 4, null),
					new ExpectedCellValue(sheetName, 218, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondAndLastFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H189:J225"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 189, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 190, 8, 20100007),
					new ExpectedCellValue(sheetName, 191, 8, null),
					new ExpectedCellValue(sheetName, 192, 8, null),
					new ExpectedCellValue(sheetName, 193, 8, null),
					new ExpectedCellValue(sheetName, 194, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 195, 8, 20100017),
					new ExpectedCellValue(sheetName, 196, 8, null),
					new ExpectedCellValue(sheetName, 197, 8, null),
					new ExpectedCellValue(sheetName, 198, 8, null),
					new ExpectedCellValue(sheetName, 199, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 200, 8, 20100070),
					new ExpectedCellValue(sheetName, 201, 8, null),
					new ExpectedCellValue(sheetName, 202, 8, null),
					new ExpectedCellValue(sheetName, 203, 8, null),
					new ExpectedCellValue(sheetName, 204, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 205, 8, 20100076),
					new ExpectedCellValue(sheetName, 206, 8, null),
					new ExpectedCellValue(sheetName, 207, 8, null),
					new ExpectedCellValue(sheetName, 208, 8, null),
					new ExpectedCellValue(sheetName, 209, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 210, 8, 20100083),
					new ExpectedCellValue(sheetName, 211, 8, null),
					new ExpectedCellValue(sheetName, 212, 8, null),
					new ExpectedCellValue(sheetName, 213, 8, null),
					new ExpectedCellValue(sheetName, 214, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 215, 8, 20100085),
					new ExpectedCellValue(sheetName, 216, 8, null),
					new ExpectedCellValue(sheetName, 217, 8, null),
					new ExpectedCellValue(sheetName, 218, 8, null),
					new ExpectedCellValue(sheetName, 219, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 220, 8, 20100090),
					new ExpectedCellValue(sheetName, 221, 8, null),
					new ExpectedCellValue(sheetName, 222, 8, null),
					new ExpectedCellValue(sheetName, 223, 8, null),
					new ExpectedCellValue(sheetName, 224, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 225, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 189, 9, "Location"),
					new ExpectedCellValue(sheetName, 190, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 191, 9, "January"),
					new ExpectedCellValue(sheetName, 192, 9, "January Total"),
					new ExpectedCellValue(sheetName, 193, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 194, 9, null),
					new ExpectedCellValue(sheetName, 195, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 9, "March"),
					new ExpectedCellValue(sheetName, 197, 9, "March Total"),
					new ExpectedCellValue(sheetName, 198, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 199, 9, null),
					new ExpectedCellValue(sheetName, 200, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 201, 9, "February"),
					new ExpectedCellValue(sheetName, 202, 9, "February Total"),
					new ExpectedCellValue(sheetName, 203, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 204, 9, null),
					new ExpectedCellValue(sheetName, 205, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 206, 9, "January"),
					new ExpectedCellValue(sheetName, 207, 9, "January Total"),
					new ExpectedCellValue(sheetName, 208, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 209, 9, null),
					new ExpectedCellValue(sheetName, 210, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 211, 9, "March"),
					new ExpectedCellValue(sheetName, 212, 9, "March Total"),
					new ExpectedCellValue(sheetName, 213, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 214, 9, null),
					new ExpectedCellValue(sheetName, 215, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 216, 9, "February"),
					new ExpectedCellValue(sheetName, 217, 9, "February Total"),
					new ExpectedCellValue(sheetName, 218, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 219, 9, null),
					new ExpectedCellValue(sheetName, 220, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 221, 9, "January"),
					new ExpectedCellValue(sheetName, 222, 9, "January Total"),
					new ExpectedCellValue(sheetName, 223, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 224, 9, null),
					new ExpectedCellValue(sheetName, 225, 9, null),
					new ExpectedCellValue(sheetName, 189, 10, "Item"),
					new ExpectedCellValue(sheetName, 190, 10, null),
					new ExpectedCellValue(sheetName, 191, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 10, null),
					new ExpectedCellValue(sheetName, 193, 10, null),
					new ExpectedCellValue(sheetName, 194, 10, null),
					new ExpectedCellValue(sheetName, 195, 10, null),
					new ExpectedCellValue(sheetName, 196, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 10, null),
					new ExpectedCellValue(sheetName, 198, 10, null),
					new ExpectedCellValue(sheetName, 199, 10, null),
					new ExpectedCellValue(sheetName, 200, 10, null),
					new ExpectedCellValue(sheetName, 201, 10, "Tent"),
					new ExpectedCellValue(sheetName, 202, 10, null),
					new ExpectedCellValue(sheetName, 203, 10, null),
					new ExpectedCellValue(sheetName, 204, 10, null),
					new ExpectedCellValue(sheetName, 205, 10, null),
					new ExpectedCellValue(sheetName, 206, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 207, 10, null),
					new ExpectedCellValue(sheetName, 208, 10, null),
					new ExpectedCellValue(sheetName, 209, 10, null),
					new ExpectedCellValue(sheetName, 210, 10, null),
					new ExpectedCellValue(sheetName, 211, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 212, 10, null),
					new ExpectedCellValue(sheetName, 213, 10, null),
					new ExpectedCellValue(sheetName, 214, 10, null),
					new ExpectedCellValue(sheetName, 215, 10, null),
					new ExpectedCellValue(sheetName, 216, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 217, 10, null),
					new ExpectedCellValue(sheetName, 218, 10, null),
					new ExpectedCellValue(sheetName, 219, 10, null),
					new ExpectedCellValue(sheetName, 220, 10, null),
					new ExpectedCellValue(sheetName, 221, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 222, 10, null),
					new ExpectedCellValue(sheetName, 223, 10, null),
					new ExpectedCellValue(sheetName, 224, 10, null),
					new ExpectedCellValue(sheetName, 225, 10, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondAndThirdFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B231:C260"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 231, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 232, 2, 20100007),
					new ExpectedCellValue(sheetName, 233, 2, null),
					new ExpectedCellValue(sheetName, 234, 2, null),
					new ExpectedCellValue(sheetName, 235, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 236, 2, 20100017),
					new ExpectedCellValue(sheetName, 237, 2, null),
					new ExpectedCellValue(sheetName, 238, 2, null),
					new ExpectedCellValue(sheetName, 239, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 240, 2, 20100070),
					new ExpectedCellValue(sheetName, 241, 2, null),
					new ExpectedCellValue(sheetName, 242, 2, null),
					new ExpectedCellValue(sheetName, 243, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 244, 2, 20100076),
					new ExpectedCellValue(sheetName, 245, 2, null),
					new ExpectedCellValue(sheetName, 246, 2, null),
					new ExpectedCellValue(sheetName, 247, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 248, 2, 20100083),
					new ExpectedCellValue(sheetName, 249, 2, null),
					new ExpectedCellValue(sheetName, 250, 2, null),
					new ExpectedCellValue(sheetName, 251, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 252, 2, 20100085),
					new ExpectedCellValue(sheetName, 253, 2, null),
					new ExpectedCellValue(sheetName, 254, 2, null),
					new ExpectedCellValue(sheetName, 255, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 256, 2, 20100090),
					new ExpectedCellValue(sheetName, 257, 2, null),
					new ExpectedCellValue(sheetName, 258, 2, null),
					new ExpectedCellValue(sheetName, 259, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 260, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 231, 3, "Location"),
					new ExpectedCellValue(sheetName, 232, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 233, 3, "January"),
					new ExpectedCellValue(sheetName, 234, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 235, 3, null),
					new ExpectedCellValue(sheetName, 236, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 237, 3, "March"),
					new ExpectedCellValue(sheetName, 238, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 239, 3, null),
					new ExpectedCellValue(sheetName, 240, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 241, 3, "February"),
					new ExpectedCellValue(sheetName, 242, 3, "Tent"),
					new ExpectedCellValue(sheetName, 243, 3, null),
					new ExpectedCellValue(sheetName, 244, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 245, 3, "January"),
					new ExpectedCellValue(sheetName, 246, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 247, 3, null),
					new ExpectedCellValue(sheetName, 248, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 249, 3, "March"),
					new ExpectedCellValue(sheetName, 250, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 251, 3, null),
					new ExpectedCellValue(sheetName, 252, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 253, 3, "February"),
					new ExpectedCellValue(sheetName, 254, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 255, 3, null),
					new ExpectedCellValue(sheetName, 256, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 257, 3, "January"),
					new ExpectedCellValue(sheetName, 258, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 259, 3, null),
					new ExpectedCellValue(sheetName, 260, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularSecondAndThirdFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H231:I274"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 231, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 232, 8, 20100007),
					new ExpectedCellValue(sheetName, 233, 8, null),
					new ExpectedCellValue(sheetName, 234, 8, null),
					new ExpectedCellValue(sheetName, 235, 8, null),
					new ExpectedCellValue(sheetName, 236, 8, null),
					new ExpectedCellValue(sheetName, 237, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 238, 8, 20100017),
					new ExpectedCellValue(sheetName, 239, 8, null),
					new ExpectedCellValue(sheetName, 240, 8, null),
					new ExpectedCellValue(sheetName, 241, 8, null),
					new ExpectedCellValue(sheetName, 242, 8, null),
					new ExpectedCellValue(sheetName, 243, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 244, 8, 20100070),
					new ExpectedCellValue(sheetName, 245, 8, null),
					new ExpectedCellValue(sheetName, 246, 8, null),
					new ExpectedCellValue(sheetName, 247, 8, null),
					new ExpectedCellValue(sheetName, 248, 8, null),
					new ExpectedCellValue(sheetName, 249, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 250, 8, 20100076),
					new ExpectedCellValue(sheetName, 251, 8, null),
					new ExpectedCellValue(sheetName, 252, 8, null),
					new ExpectedCellValue(sheetName, 253, 8, null),
					new ExpectedCellValue(sheetName, 254, 8, null),
					new ExpectedCellValue(sheetName, 255, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 256, 8, 20100083),
					new ExpectedCellValue(sheetName, 257, 8, null),
					new ExpectedCellValue(sheetName, 258, 8, null),
					new ExpectedCellValue(sheetName, 259, 8, null),
					new ExpectedCellValue(sheetName, 260, 8, null),
					new ExpectedCellValue(sheetName, 261, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 262, 8, 20100085),
					new ExpectedCellValue(sheetName, 263, 8, null),
					new ExpectedCellValue(sheetName, 264, 8, null),
					new ExpectedCellValue(sheetName, 265, 8, null),
					new ExpectedCellValue(sheetName, 266, 8, null),
					new ExpectedCellValue(sheetName, 267, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 268, 8, 20100090),
					new ExpectedCellValue(sheetName, 269, 8, null),
					new ExpectedCellValue(sheetName, 270, 8, null),
					new ExpectedCellValue(sheetName, 271, 8, null),
					new ExpectedCellValue(sheetName, 272, 8, null),
					new ExpectedCellValue(sheetName, 273, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 274, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 231, 9, "Location"),
					new ExpectedCellValue(sheetName, 232, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 233, 9, "January"),
					new ExpectedCellValue(sheetName, 234, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 235, 9, "January Total"),
					new ExpectedCellValue(sheetName, 236, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 237, 9, null),
					new ExpectedCellValue(sheetName, 238, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 239, 9, "March"),
					new ExpectedCellValue(sheetName, 240, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 241, 9, "March Total"),
					new ExpectedCellValue(sheetName, 242, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 243, 9, null),
					new ExpectedCellValue(sheetName, 244, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 245, 9, "February"),
					new ExpectedCellValue(sheetName, 246, 9, "Tent"),
					new ExpectedCellValue(sheetName, 247, 9, "February Total"),
					new ExpectedCellValue(sheetName, 248, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 249, 9, null),
					new ExpectedCellValue(sheetName, 250, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 251, 9, "January"),
					new ExpectedCellValue(sheetName, 252, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 253, 9, "January Total"),
					new ExpectedCellValue(sheetName, 254, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 255, 9, null),
					new ExpectedCellValue(sheetName, 256, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 257, 9, "March"),
					new ExpectedCellValue(sheetName, 258, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 259, 9, "March Total"),
					new ExpectedCellValue(sheetName, 260, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 261, 9, null),
					new ExpectedCellValue(sheetName, 262, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 263, 9, "February"),
					new ExpectedCellValue(sheetName, 264, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 265, 9, "February Total"),
					new ExpectedCellValue(sheetName, 266, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 267, 9, null),
					new ExpectedCellValue(sheetName, 268, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 269, 9, "January"),
					new ExpectedCellValue(sheetName, 270, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 9, "January Total"),
					new ExpectedCellValue(sheetName, 272, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 273, 9, null),
					new ExpectedCellValue(sheetName, 274, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularFirstFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B278:C307"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 278, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 279, 2, 20100007),
					new ExpectedCellValue(sheetName, 280, 2, null),
					new ExpectedCellValue(sheetName, 281, 2, null),
					new ExpectedCellValue(sheetName, 282, 2, "20100007 Total"),
					new ExpectedCellValue(sheetName, 283, 2, 20100017),
					new ExpectedCellValue(sheetName, 284, 2, null),
					new ExpectedCellValue(sheetName, 285, 2, null),
					new ExpectedCellValue(sheetName, 286, 2, "20100017 Total"),
					new ExpectedCellValue(sheetName, 287, 2, 20100070),
					new ExpectedCellValue(sheetName, 288, 2, null),
					new ExpectedCellValue(sheetName, 289, 2, null),
					new ExpectedCellValue(sheetName, 290, 2, "20100070 Total"),
					new ExpectedCellValue(sheetName, 291, 2, 20100076),
					new ExpectedCellValue(sheetName, 292, 2, null),
					new ExpectedCellValue(sheetName, 293, 2, null),
					new ExpectedCellValue(sheetName, 294, 2, "20100076 Total"),
					new ExpectedCellValue(sheetName, 295, 2, 20100083),
					new ExpectedCellValue(sheetName, 296, 2, null),
					new ExpectedCellValue(sheetName, 297, 2, null),
					new ExpectedCellValue(sheetName, 298, 2, "20100083 Total"),
					new ExpectedCellValue(sheetName, 299, 2, 20100085),
					new ExpectedCellValue(sheetName, 300, 2, null),
					new ExpectedCellValue(sheetName, 301, 2, null),
					new ExpectedCellValue(sheetName, 302, 2, "20100085 Total"),
					new ExpectedCellValue(sheetName, 303, 2, 20100090),
					new ExpectedCellValue(sheetName, 304, 2, null),
					new ExpectedCellValue(sheetName, 305, 2, null),
					new ExpectedCellValue(sheetName, 306, 2, "20100090 Total"),
					new ExpectedCellValue(sheetName, 307, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 278, 3, "Location"),
					new ExpectedCellValue(sheetName, 279, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 280, 3, "January"),
					new ExpectedCellValue(sheetName, 281, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 282, 3, null),
					new ExpectedCellValue(sheetName, 283, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 284, 3, "March"),
					new ExpectedCellValue(sheetName, 285, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 286, 3, null),
					new ExpectedCellValue(sheetName, 287, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 288, 3, "February"),
					new ExpectedCellValue(sheetName, 289, 3, "Tent"),
					new ExpectedCellValue(sheetName, 290, 3, null),
					new ExpectedCellValue(sheetName, 291, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 292, 3, "January"),
					new ExpectedCellValue(sheetName, 293, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 294, 3, null),
					new ExpectedCellValue(sheetName, 295, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 296, 3, "March"),
					new ExpectedCellValue(sheetName, 297, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 298, 3, null),
					new ExpectedCellValue(sheetName, 299, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 300, 3, "February"),
					new ExpectedCellValue(sheetName, 301, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 302, 3, null),
					new ExpectedCellValue(sheetName, 303, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 304, 3, "January"),
					new ExpectedCellValue(sheetName, 305, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 306, 3, null),
					new ExpectedCellValue(sheetName, 307, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularFirstFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable16"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H278:I321"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 278, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 279, 8, 20100007),
					new ExpectedCellValue(sheetName, 280, 8, null),
					new ExpectedCellValue(sheetName, 281, 8, null),
					new ExpectedCellValue(sheetName, 282, 8, null),
					new ExpectedCellValue(sheetName, 283, 8, null),
					new ExpectedCellValue(sheetName, 284, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 285, 8, 20100017),
					new ExpectedCellValue(sheetName, 286, 8, null),
					new ExpectedCellValue(sheetName, 287, 8, null),
					new ExpectedCellValue(sheetName, 288, 8, null),
					new ExpectedCellValue(sheetName, 289, 8, null),
					new ExpectedCellValue(sheetName, 290, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 291, 8, 20100070),
					new ExpectedCellValue(sheetName, 292, 8, null),
					new ExpectedCellValue(sheetName, 293, 8, null),
					new ExpectedCellValue(sheetName, 294, 8, null),
					new ExpectedCellValue(sheetName, 295, 8, null),
					new ExpectedCellValue(sheetName, 296, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 297, 8, 20100076),
					new ExpectedCellValue(sheetName, 298, 8, null),
					new ExpectedCellValue(sheetName, 299, 8, null),
					new ExpectedCellValue(sheetName, 300, 8, null),
					new ExpectedCellValue(sheetName, 301, 8, null),
					new ExpectedCellValue(sheetName, 302, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 303, 8, 20100083),
					new ExpectedCellValue(sheetName, 304, 8, null),
					new ExpectedCellValue(sheetName, 305, 8, null),
					new ExpectedCellValue(sheetName, 306, 8, null),
					new ExpectedCellValue(sheetName, 307, 8, null),
					new ExpectedCellValue(sheetName, 308, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 309, 8, 20100085),
					new ExpectedCellValue(sheetName, 310, 8, null),
					new ExpectedCellValue(sheetName, 311, 8, null),
					new ExpectedCellValue(sheetName, 312, 8, null),
					new ExpectedCellValue(sheetName, 313, 8, null),
					new ExpectedCellValue(sheetName, 314, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 315, 8, 20100090),
					new ExpectedCellValue(sheetName, 316, 8, null),
					new ExpectedCellValue(sheetName, 317, 8, null),
					new ExpectedCellValue(sheetName, 318, 8, null),
					new ExpectedCellValue(sheetName, 319, 8, null),
					new ExpectedCellValue(sheetName, 320, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 321, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 278, 9, "Location"),
					new ExpectedCellValue(sheetName, 279, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 280, 9, "January"),
					new ExpectedCellValue(sheetName, 281, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 282, 9, "January Total"),
					new ExpectedCellValue(sheetName, 283, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 284, 9, null),
					new ExpectedCellValue(sheetName, 285, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 286, 9, "March"),
					new ExpectedCellValue(sheetName, 287, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 288, 9, "March Total"),
					new ExpectedCellValue(sheetName, 289, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 290, 9, null),
					new ExpectedCellValue(sheetName, 291, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 292, 9, "February"),
					new ExpectedCellValue(sheetName, 293, 9, "Tent"),
					new ExpectedCellValue(sheetName, 294, 9, "February Total"),
					new ExpectedCellValue(sheetName, 295, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 296, 9, null),
					new ExpectedCellValue(sheetName, 297, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 298, 9, "January"),
					new ExpectedCellValue(sheetName, 299, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 300, 9, "January Total"),
					new ExpectedCellValue(sheetName, 301, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 302, 9, null),
					new ExpectedCellValue(sheetName, 303, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 304, 9, "March"),
					new ExpectedCellValue(sheetName, 305, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 306, 9, "March Total"),
					new ExpectedCellValue(sheetName, 307, 9, "Chicago Total"),
					new ExpectedCellValue(sheetName, 308, 9, null),
					new ExpectedCellValue(sheetName, 309, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 310, 9, "February"),
					new ExpectedCellValue(sheetName, 311, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 312, 9, "February Total"),
					new ExpectedCellValue(sheetName, 313, 9, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 314, 9, null),
					new ExpectedCellValue(sheetName, 315, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 316, 9, "January"),
					new ExpectedCellValue(sheetName, 317, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 318, 9, "January Total"),
					new ExpectedCellValue(sheetName, 319, 9, "Nashville Total"),
					new ExpectedCellValue(sheetName, 320, 9, null),
					new ExpectedCellValue(sheetName, 321, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularLastFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable17"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B326:B355"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 326, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 327, 2, 20100007),
					new ExpectedCellValue(sheetName, 328, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 329, 2, "January"),
					new ExpectedCellValue(sheetName, 330, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 331, 2, 20100017),
					new ExpectedCellValue(sheetName, 332, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 333, 2, "March"),
					new ExpectedCellValue(sheetName, 334, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 335, 2, 20100070),
					new ExpectedCellValue(sheetName, 336, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 337, 2, "February"),
					new ExpectedCellValue(sheetName, 338, 2, "Tent"),
					new ExpectedCellValue(sheetName, 339, 2, 20100076),
					new ExpectedCellValue(sheetName, 340, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 341, 2, "January"),
					new ExpectedCellValue(sheetName, 342, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 343, 2, 20100083),
					new ExpectedCellValue(sheetName, 344, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 345, 2, "March"),
					new ExpectedCellValue(sheetName, 346, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 347, 2, 20100085),
					new ExpectedCellValue(sheetName, 348, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 349, 2, "February"),
					new ExpectedCellValue(sheetName, 350, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 351, 2, 20100090),
					new ExpectedCellValue(sheetName, 352, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 353, 2, "January"),
					new ExpectedCellValue(sheetName, 354, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 355, 2, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularLastFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable18"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H326:H376"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 326, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 327, 8, 20100007),
					new ExpectedCellValue(sheetName, 328, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 329, 8, "January"),
					new ExpectedCellValue(sheetName, 330, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 331, 8, "January Total"),
					new ExpectedCellValue(sheetName, 332, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 333, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 334, 8, 20100017),
					new ExpectedCellValue(sheetName, 335, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 336, 8, "March"),
					new ExpectedCellValue(sheetName, 337, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 338, 8, "March Total"),
					new ExpectedCellValue(sheetName, 339, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 340, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 341, 8, 20100070),
					new ExpectedCellValue(sheetName, 342, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 343, 8, "February"),
					new ExpectedCellValue(sheetName, 344, 8, "Tent"),
					new ExpectedCellValue(sheetName, 345, 8, "February Total"),
					new ExpectedCellValue(sheetName, 346, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 347, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 348, 8, 20100076),
					new ExpectedCellValue(sheetName, 349, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 350, 8, "January"),
					new ExpectedCellValue(sheetName, 351, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 352, 8, "January Total"),
					new ExpectedCellValue(sheetName, 353, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 354, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 355, 8, 20100083),
					new ExpectedCellValue(sheetName, 356, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 357, 8, "March"),
					new ExpectedCellValue(sheetName, 358, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 359, 8, "March Total"),
					new ExpectedCellValue(sheetName, 360, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 361, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 362, 8, 20100085),
					new ExpectedCellValue(sheetName, 363, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 364, 8, "February"),
					new ExpectedCellValue(sheetName, 365, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 366, 8, "February Total"),
					new ExpectedCellValue(sheetName, 367, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 368, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 369, 8, 20100090),
					new ExpectedCellValue(sheetName, 370, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 371, 8, "January"),
					new ExpectedCellValue(sheetName, 372, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 8, "January Total"),
					new ExpectedCellValue(sheetName, 374, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 375, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 376, 8, "Grand Total")
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularLastTwoFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable19"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B380:C409"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 380, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 381, 2, 20100007),
					new ExpectedCellValue(sheetName, 382, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 383, 2, "January"),
					new ExpectedCellValue(sheetName, 384, 2, "January Total"),
					new ExpectedCellValue(sheetName, 385, 2, 20100017),
					new ExpectedCellValue(sheetName, 386, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 387, 2, "March"),
					new ExpectedCellValue(sheetName, 388, 2, "March Total"),
					new ExpectedCellValue(sheetName, 389, 2, 20100070),
					new ExpectedCellValue(sheetName, 390, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 391, 2, "February"),
					new ExpectedCellValue(sheetName, 392, 2, "February Total"),
					new ExpectedCellValue(sheetName, 393, 2, 20100076),
					new ExpectedCellValue(sheetName, 394, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 395, 2, "January"),
					new ExpectedCellValue(sheetName, 396, 2, "January Total"),
					new ExpectedCellValue(sheetName, 397, 2, 20100083),
					new ExpectedCellValue(sheetName, 398, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 399, 2, "March"),
					new ExpectedCellValue(sheetName, 400, 2, "March Total"),
					new ExpectedCellValue(sheetName, 401, 2, 20100085),
					new ExpectedCellValue(sheetName, 402, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 403, 2, "February"),
					new ExpectedCellValue(sheetName, 404, 2, "February Total"),
					new ExpectedCellValue(sheetName, 405, 2, 20100090),
					new ExpectedCellValue(sheetName, 406, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 407, 2, "January"),
					new ExpectedCellValue(sheetName, 408, 2, "January Total"),
					new ExpectedCellValue(sheetName, 409, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 380, 3, "Item"),
					new ExpectedCellValue(sheetName, 381, 3, null),
					new ExpectedCellValue(sheetName, 382, 3, null),
					new ExpectedCellValue(sheetName, 383, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 3, null),
					new ExpectedCellValue(sheetName, 385, 3, null),
					new ExpectedCellValue(sheetName, 386, 3, null),
					new ExpectedCellValue(sheetName, 387, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 3, null),
					new ExpectedCellValue(sheetName, 389, 3, null),
					new ExpectedCellValue(sheetName, 390, 3, null),
					new ExpectedCellValue(sheetName, 391, 3, "Tent"),
					new ExpectedCellValue(sheetName, 392, 3, null),
					new ExpectedCellValue(sheetName, 393, 3, null),
					new ExpectedCellValue(sheetName, 394, 3, null),
					new ExpectedCellValue(sheetName, 395, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 396, 3, null),
					new ExpectedCellValue(sheetName, 397, 3, null),
					new ExpectedCellValue(sheetName, 398, 3, null),
					new ExpectedCellValue(sheetName, 399, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 400, 3, null),
					new ExpectedCellValue(sheetName, 401, 3, null),
					new ExpectedCellValue(sheetName, 402, 3, null),
					new ExpectedCellValue(sheetName, 403, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 404, 3, null),
					new ExpectedCellValue(sheetName, 405, 3, null),
					new ExpectedCellValue(sheetName, 406, 3, null),
					new ExpectedCellValue(sheetName, 407, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 408, 3, null),
					new ExpectedCellValue(sheetName, 409, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularLastTwoFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable20"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H380:I423"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 380, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 381, 8, 20100007),
					new ExpectedCellValue(sheetName, 382, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 383, 8, "January"),
					new ExpectedCellValue(sheetName, 384, 8, "January Total"),
					new ExpectedCellValue(sheetName, 385, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 386, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 387, 8, 20100017),
					new ExpectedCellValue(sheetName, 388, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 389, 8, "March"),
					new ExpectedCellValue(sheetName, 390, 8, "March Total"),
					new ExpectedCellValue(sheetName, 391, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 392, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 393, 8, 20100070),
					new ExpectedCellValue(sheetName, 394, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 395, 8, "February"),
					new ExpectedCellValue(sheetName, 396, 8, "February Total"),
					new ExpectedCellValue(sheetName, 397, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 398, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 399, 8, 20100076),
					new ExpectedCellValue(sheetName, 400, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 401, 8, "January"),
					new ExpectedCellValue(sheetName, 402, 8, "January Total"),
					new ExpectedCellValue(sheetName, 403, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 404, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 405, 8, 20100083),
					new ExpectedCellValue(sheetName, 406, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 407, 8, "March"),
					new ExpectedCellValue(sheetName, 408, 8, "March Total"),
					new ExpectedCellValue(sheetName, 409, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 410, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 411, 8, 20100085),
					new ExpectedCellValue(sheetName, 412, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 413, 8, "February"),
					new ExpectedCellValue(sheetName, 414, 8, "February Total"),
					new ExpectedCellValue(sheetName, 415, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 416, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 417, 8, 20100090),
					new ExpectedCellValue(sheetName, 418, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 419, 8, "January"),
					new ExpectedCellValue(sheetName, 420, 8, "January Total"),
					new ExpectedCellValue(sheetName, 421, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 422, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 423, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 380, 9, "Item"),
					new ExpectedCellValue(sheetName, 381, 9, null),
					new ExpectedCellValue(sheetName, 382, 9, null),
					new ExpectedCellValue(sheetName, 383, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 9, null),
					new ExpectedCellValue(sheetName, 385, 9, null),
					new ExpectedCellValue(sheetName, 386, 9, null),
					new ExpectedCellValue(sheetName, 387, 9, null),
					new ExpectedCellValue(sheetName, 388, 9, null),
					new ExpectedCellValue(sheetName, 389, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 390, 9, null),
					new ExpectedCellValue(sheetName, 391, 9, null),
					new ExpectedCellValue(sheetName, 392, 9, null),
					new ExpectedCellValue(sheetName, 393, 9, null),
					new ExpectedCellValue(sheetName, 394, 9, null),
					new ExpectedCellValue(sheetName, 395, 9, "Tent"),
					new ExpectedCellValue(sheetName, 396, 9, null),
					new ExpectedCellValue(sheetName, 397, 9, null),
					new ExpectedCellValue(sheetName, 398, 9, null),
					new ExpectedCellValue(sheetName, 399, 9, null),
					new ExpectedCellValue(sheetName, 400, 9, null),
					new ExpectedCellValue(sheetName, 401, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 402, 9, null),
					new ExpectedCellValue(sheetName, 403, 9, null),
					new ExpectedCellValue(sheetName, 404, 9, null),
					new ExpectedCellValue(sheetName, 405, 9, null),
					new ExpectedCellValue(sheetName, 406, 9, null),
					new ExpectedCellValue(sheetName, 407, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 408, 9, null),
					new ExpectedCellValue(sheetName, 409, 9, null),
					new ExpectedCellValue(sheetName, 410, 9, null),
					new ExpectedCellValue(sheetName, 411, 9, null),
					new ExpectedCellValue(sheetName, 412, 9, null),
					new ExpectedCellValue(sheetName, 413, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 414, 9, null),
					new ExpectedCellValue(sheetName, 415, 9, null),
					new ExpectedCellValue(sheetName, 416, 9, null),
					new ExpectedCellValue(sheetName, 417, 9, null),
					new ExpectedCellValue(sheetName, 418, 9, null),
					new ExpectedCellValue(sheetName, 419, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 420, 9, null),
					new ExpectedCellValue(sheetName, 421, 9, null),
					new ExpectedCellValue(sheetName, 422, 9, null),
					new ExpectedCellValue(sheetName, 423, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularThirdFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable21"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B427:C456"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 427, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 428, 2, 20100007),
					new ExpectedCellValue(sheetName, 429, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 430, 2, "January"),
					new ExpectedCellValue(sheetName, 431, 2, "January Total"),
					new ExpectedCellValue(sheetName, 432, 2, 20100017),
					new ExpectedCellValue(sheetName, 433, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 434, 2, "March"),
					new ExpectedCellValue(sheetName, 435, 2, "March Total"),
					new ExpectedCellValue(sheetName, 436, 2, 20100070),
					new ExpectedCellValue(sheetName, 437, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 438, 2, "February"),
					new ExpectedCellValue(sheetName, 439, 2, "February Total"),
					new ExpectedCellValue(sheetName, 440, 2, 20100076),
					new ExpectedCellValue(sheetName, 441, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 442, 2, "January"),
					new ExpectedCellValue(sheetName, 443, 2, "January Total"),
					new ExpectedCellValue(sheetName, 444, 2, 20100083),
					new ExpectedCellValue(sheetName, 445, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 446, 2, "March"),
					new ExpectedCellValue(sheetName, 447, 2, "March Total"),
					new ExpectedCellValue(sheetName, 448, 2, 20100085),
					new ExpectedCellValue(sheetName, 449, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 450, 2, "February"),
					new ExpectedCellValue(sheetName, 451, 2, "February Total"),
					new ExpectedCellValue(sheetName, 452, 2, 20100090),
					new ExpectedCellValue(sheetName, 453, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 454, 2, "January"),
					new ExpectedCellValue(sheetName, 455, 2, "January Total"),
					new ExpectedCellValue(sheetName, 456, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 427, 3, "Item"),
					new ExpectedCellValue(sheetName, 428, 3, null),
					new ExpectedCellValue(sheetName, 429, 3, null),
					new ExpectedCellValue(sheetName, 430, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 431, 3, null),
					new ExpectedCellValue(sheetName, 432, 3, null),
					new ExpectedCellValue(sheetName, 433, 3, null),
					new ExpectedCellValue(sheetName, 434, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 435, 3, null),
					new ExpectedCellValue(sheetName, 436, 3, null),
					new ExpectedCellValue(sheetName, 437, 3, null),
					new ExpectedCellValue(sheetName, 438, 3, "Tent"),
					new ExpectedCellValue(sheetName, 439, 3, null),
					new ExpectedCellValue(sheetName, 440, 3, null),
					new ExpectedCellValue(sheetName, 441, 3, null),
					new ExpectedCellValue(sheetName, 442, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 443, 3, null),
					new ExpectedCellValue(sheetName, 444, 3, null),
					new ExpectedCellValue(sheetName, 445, 3, null),
					new ExpectedCellValue(sheetName, 446, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 447, 3, null),
					new ExpectedCellValue(sheetName, 448, 3, null),
					new ExpectedCellValue(sheetName, 449, 3, null),
					new ExpectedCellValue(sheetName, 450, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 451, 3, null),
					new ExpectedCellValue(sheetName, 452, 3, null),
					new ExpectedCellValue(sheetName, 453, 3, null),
					new ExpectedCellValue(sheetName, 454, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 455, 3, null),
					new ExpectedCellValue(sheetName, 456, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularThirdFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable22"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H427:I470"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 427, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 428, 8, 20100007),
					new ExpectedCellValue(sheetName, 429, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 430, 8, "January"),
					new ExpectedCellValue(sheetName, 431, 8, "January Total"),
					new ExpectedCellValue(sheetName, 432, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 433, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 434, 8, 20100017),
					new ExpectedCellValue(sheetName, 435, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 436, 8, "March"),
					new ExpectedCellValue(sheetName, 437, 8, "March Total"),
					new ExpectedCellValue(sheetName, 438, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 439, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 440, 8, 20100070),
					new ExpectedCellValue(sheetName, 441, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 442, 8, "February"),
					new ExpectedCellValue(sheetName, 443, 8, "February Total"),
					new ExpectedCellValue(sheetName, 444, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 445, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 446, 8, 20100076),
					new ExpectedCellValue(sheetName, 447, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 448, 8, "January"),
					new ExpectedCellValue(sheetName, 449, 8, "January Total"),
					new ExpectedCellValue(sheetName, 450, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 451, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 452, 8, 20100083),
					new ExpectedCellValue(sheetName, 453, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 454, 8, "March"),
					new ExpectedCellValue(sheetName, 455, 8, "March Total"),
					new ExpectedCellValue(sheetName, 456, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 457, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 458, 8, 20100085),
					new ExpectedCellValue(sheetName, 459, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 460, 8, "February"),
					new ExpectedCellValue(sheetName, 461, 8, "February Total"),
					new ExpectedCellValue(sheetName, 462, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 463, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 464, 8, 20100090),
					new ExpectedCellValue(sheetName, 465, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 466, 8, "January"),
					new ExpectedCellValue(sheetName, 467, 8, "January Total"),
					new ExpectedCellValue(sheetName, 468, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 469, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 470, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 427, 9, "Item"),
					new ExpectedCellValue(sheetName, 428, 9, null),
					new ExpectedCellValue(sheetName, 429, 9, null),
					new ExpectedCellValue(sheetName, 430, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 431, 9, null),
					new ExpectedCellValue(sheetName, 432, 9, null),
					new ExpectedCellValue(sheetName, 433, 9, null),
					new ExpectedCellValue(sheetName, 434, 9, null),
					new ExpectedCellValue(sheetName, 435, 9, null),
					new ExpectedCellValue(sheetName, 436, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 437, 9, null),
					new ExpectedCellValue(sheetName, 438, 9, null),
					new ExpectedCellValue(sheetName, 439, 9, null),
					new ExpectedCellValue(sheetName, 440, 9, null),
					new ExpectedCellValue(sheetName, 441, 9, null),
					new ExpectedCellValue(sheetName, 442, 9, "Tent"),
					new ExpectedCellValue(sheetName, 443, 9, null),
					new ExpectedCellValue(sheetName, 444, 9, null),
					new ExpectedCellValue(sheetName, 445, 9, null),
					new ExpectedCellValue(sheetName, 446, 9, null),
					new ExpectedCellValue(sheetName, 447, 9, null),
					new ExpectedCellValue(sheetName, 448, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 449, 9, null),
					new ExpectedCellValue(sheetName, 450, 9, null),
					new ExpectedCellValue(sheetName, 451, 9, null),
					new ExpectedCellValue(sheetName, 452, 9, null),
					new ExpectedCellValue(sheetName, 453, 9, null),
					new ExpectedCellValue(sheetName, 454, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 455, 9, null),
					new ExpectedCellValue(sheetName, 456, 9, null),
					new ExpectedCellValue(sheetName, 457, 9, null),
					new ExpectedCellValue(sheetName, 458, 9, null),
					new ExpectedCellValue(sheetName, 459, 9, null),
					new ExpectedCellValue(sheetName, 460, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 461, 9, null),
					new ExpectedCellValue(sheetName, 462, 9, null),
					new ExpectedCellValue(sheetName, 463, 9, null),
					new ExpectedCellValue(sheetName, 464, 9, null),
					new ExpectedCellValue(sheetName, 465, 9, null),
					new ExpectedCellValue(sheetName, 466, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 467, 9, null),
					new ExpectedCellValue(sheetName, 468, 9, null),
					new ExpectedCellValue(sheetName, 469, 9, null),
					new ExpectedCellValue(sheetName, 470, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularSecondFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable23"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B481:C510"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 481, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 482, 2, 20100007),
					new ExpectedCellValue(sheetName, 483, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 484, 2, null),
					new ExpectedCellValue(sheetName, 485, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 486, 2, 20100017),
					new ExpectedCellValue(sheetName, 487, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 488, 2, null),
					new ExpectedCellValue(sheetName, 489, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 490, 2, 20100070),
					new ExpectedCellValue(sheetName, 491, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 492, 2, null),
					new ExpectedCellValue(sheetName, 493, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 494, 2, 20100076),
					new ExpectedCellValue(sheetName, 495, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 496, 2, null),
					new ExpectedCellValue(sheetName, 497, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 498, 2, 20100083),
					new ExpectedCellValue(sheetName, 499, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 500, 2, null),
					new ExpectedCellValue(sheetName, 501, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 502, 2, 20100085),
					new ExpectedCellValue(sheetName, 503, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 504, 2, null),
					new ExpectedCellValue(sheetName, 505, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 506, 2, 20100090),
					new ExpectedCellValue(sheetName, 507, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 508, 2, null),
					new ExpectedCellValue(sheetName, 509, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 510, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 481, 3, "Month"),
					new ExpectedCellValue(sheetName, 482, 3, null),
					new ExpectedCellValue(sheetName, 483, 3, "January"),
					new ExpectedCellValue(sheetName, 484, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 485, 3, null),
					new ExpectedCellValue(sheetName, 486, 3, null),
					new ExpectedCellValue(sheetName, 487, 3, "March"),
					new ExpectedCellValue(sheetName, 488, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 489, 3, null),
					new ExpectedCellValue(sheetName, 490, 3, null),
					new ExpectedCellValue(sheetName, 491, 3, "February"),
					new ExpectedCellValue(sheetName, 492, 3, "Tent"),
					new ExpectedCellValue(sheetName, 493, 3, null),
					new ExpectedCellValue(sheetName, 494, 3, null),
					new ExpectedCellValue(sheetName, 495, 3, "January"),
					new ExpectedCellValue(sheetName, 496, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 497, 3, null),
					new ExpectedCellValue(sheetName, 498, 3, null),
					new ExpectedCellValue(sheetName, 499, 3, "March"),
					new ExpectedCellValue(sheetName, 500, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 501, 3, null),
					new ExpectedCellValue(sheetName, 502, 3, null),
					new ExpectedCellValue(sheetName, 503, 3, "February"),
					new ExpectedCellValue(sheetName, 504, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 505, 3, null),
					new ExpectedCellValue(sheetName, 506, 3, null),
					new ExpectedCellValue(sheetName, 507, 3, "January"),
					new ExpectedCellValue(sheetName, 508, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 509, 3, null),
					new ExpectedCellValue(sheetName, 510, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularSecondFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable24"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H481:I524"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 481, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 482, 8, 20100007),
					new ExpectedCellValue(sheetName, 483, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 484, 8, null),
					new ExpectedCellValue(sheetName, 485, 8, null),
					new ExpectedCellValue(sheetName, 486, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 487, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 488, 8, 20100017),
					new ExpectedCellValue(sheetName, 489, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 490, 8, null),
					new ExpectedCellValue(sheetName, 491, 8, null),
					new ExpectedCellValue(sheetName, 492, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 493, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 494, 8, 20100070),
					new ExpectedCellValue(sheetName, 495, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 496, 8, null),
					new ExpectedCellValue(sheetName, 497, 8, null),
					new ExpectedCellValue(sheetName, 498, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 499, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 500, 8, 20100076),
					new ExpectedCellValue(sheetName, 501, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 502, 8, null),
					new ExpectedCellValue(sheetName, 503, 8, null),
					new ExpectedCellValue(sheetName, 504, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 505, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 506, 8, 20100083),
					new ExpectedCellValue(sheetName, 507, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 508, 8, null),
					new ExpectedCellValue(sheetName, 509, 8, null),
					new ExpectedCellValue(sheetName, 510, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 511, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 512, 8, 20100085),
					new ExpectedCellValue(sheetName, 513, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 514, 8, null),
					new ExpectedCellValue(sheetName, 515, 8, null),
					new ExpectedCellValue(sheetName, 516, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 517, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 518, 8, 20100090),
					new ExpectedCellValue(sheetName, 519, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 520, 8, null),
					new ExpectedCellValue(sheetName, 521, 8, null),
					new ExpectedCellValue(sheetName, 522, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 523, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 524, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 481, 9, "Month"),
					new ExpectedCellValue(sheetName, 482, 9, null),
					new ExpectedCellValue(sheetName, 483, 9, "January"),
					new ExpectedCellValue(sheetName, 484, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 485, 9, "January Total"),
					new ExpectedCellValue(sheetName, 486, 9, null),
					new ExpectedCellValue(sheetName, 487, 9, null),
					new ExpectedCellValue(sheetName, 488, 9, null),
					new ExpectedCellValue(sheetName, 489, 9, "March"),
					new ExpectedCellValue(sheetName, 490, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 491, 9, "March Total"),
					new ExpectedCellValue(sheetName, 492, 9, null),
					new ExpectedCellValue(sheetName, 493, 9, null),
					new ExpectedCellValue(sheetName, 494, 9, null),
					new ExpectedCellValue(sheetName, 495, 9, "February"),
					new ExpectedCellValue(sheetName, 496, 9, "Tent"),
					new ExpectedCellValue(sheetName, 497, 9, "February Total"),
					new ExpectedCellValue(sheetName, 498, 9, null),
					new ExpectedCellValue(sheetName, 499, 9, null),
					new ExpectedCellValue(sheetName, 500, 9, null),
					new ExpectedCellValue(sheetName, 501, 9, "January"),
					new ExpectedCellValue(sheetName, 502, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 503, 9, "January Total"),
					new ExpectedCellValue(sheetName, 504, 9, null),
					new ExpectedCellValue(sheetName, 505, 9, null),
					new ExpectedCellValue(sheetName, 506, 9, null),
					new ExpectedCellValue(sheetName, 507, 9, "March"),
					new ExpectedCellValue(sheetName, 508, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 509, 9, "March Total"),
					new ExpectedCellValue(sheetName, 510, 9, null),
					new ExpectedCellValue(sheetName, 511, 9, null),
					new ExpectedCellValue(sheetName, 512, 9, null),
					new ExpectedCellValue(sheetName, 513, 9, "February"),
					new ExpectedCellValue(sheetName, 514, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 515, 9, "February Total"),
					new ExpectedCellValue(sheetName, 516, 9, null),
					new ExpectedCellValue(sheetName, 517, 9, null),
					new ExpectedCellValue(sheetName, 518, 9, null),
					new ExpectedCellValue(sheetName, 519, 9, "January"),
					new ExpectedCellValue(sheetName, 520, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 521, 9, "January Total"),
					new ExpectedCellValue(sheetName, 522, 9, null),
					new ExpectedCellValue(sheetName, 523, 9, null),
					new ExpectedCellValue(sheetName, 524, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularSecondAndLastFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable25"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B527:C556"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 527, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 528, 2, 20100007),
					new ExpectedCellValue(sheetName, 529, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 530, 2, null),
					new ExpectedCellValue(sheetName, 531, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 532, 2, 20100017),
					new ExpectedCellValue(sheetName, 533, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 534, 2, null),
					new ExpectedCellValue(sheetName, 535, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 536, 2, 20100070),
					new ExpectedCellValue(sheetName, 537, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 538, 2, null),
					new ExpectedCellValue(sheetName, 539, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 540, 2, 20100076),
					new ExpectedCellValue(sheetName, 541, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 542, 2, null),
					new ExpectedCellValue(sheetName, 543, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 544, 2, 20100083),
					new ExpectedCellValue(sheetName, 545, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 546, 2, null),
					new ExpectedCellValue(sheetName, 547, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 548, 2, 20100085),
					new ExpectedCellValue(sheetName, 549, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 550, 2, null),
					new ExpectedCellValue(sheetName, 551, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 552, 2, 20100090),
					new ExpectedCellValue(sheetName, 553, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 554, 2, null),
					new ExpectedCellValue(sheetName, 555, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 556, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 527, 3, "Month"),
					new ExpectedCellValue(sheetName, 528, 3, null),
					new ExpectedCellValue(sheetName, 529, 3, "January"),
					new ExpectedCellValue(sheetName, 530, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 531, 3, null),
					new ExpectedCellValue(sheetName, 532, 3, null),
					new ExpectedCellValue(sheetName, 533, 3, "March"),
					new ExpectedCellValue(sheetName, 534, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 535, 3, null),
					new ExpectedCellValue(sheetName, 536, 3, null),
					new ExpectedCellValue(sheetName, 537, 3, "February"),
					new ExpectedCellValue(sheetName, 538, 3, "Tent"),
					new ExpectedCellValue(sheetName, 539, 3, null),
					new ExpectedCellValue(sheetName, 540, 3, null),
					new ExpectedCellValue(sheetName, 541, 3, "January"),
					new ExpectedCellValue(sheetName, 542, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 543, 3, null),
					new ExpectedCellValue(sheetName, 544, 3, null),
					new ExpectedCellValue(sheetName, 545, 3, "March"),
					new ExpectedCellValue(sheetName, 546, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 547, 3, null),
					new ExpectedCellValue(sheetName, 548, 3, null),
					new ExpectedCellValue(sheetName, 549, 3, "February"),
					new ExpectedCellValue(sheetName, 550, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 551, 3, null),
					new ExpectedCellValue(sheetName, 552, 3, null),
					new ExpectedCellValue(sheetName, 553, 3, "January"),
					new ExpectedCellValue(sheetName, 554, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 555, 3, null),
					new ExpectedCellValue(sheetName, 556, 3, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsTabularSecondAndLastFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable26"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H527:I570"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 527, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 528, 8, 20100007),
					new ExpectedCellValue(sheetName, 529, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 530, 8, null),
					new ExpectedCellValue(sheetName, 531, 8, null),
					new ExpectedCellValue(sheetName, 532, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 533, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 534, 8, 20100017),
					new ExpectedCellValue(sheetName, 535, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 536, 8, null),
					new ExpectedCellValue(sheetName, 537, 8, null),
					new ExpectedCellValue(sheetName, 538, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 539, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 540, 8, 20100070),
					new ExpectedCellValue(sheetName, 541, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 542, 8, null),
					new ExpectedCellValue(sheetName, 543, 8, null),
					new ExpectedCellValue(sheetName, 544, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 545, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 546, 8, 20100076),
					new ExpectedCellValue(sheetName, 547, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 548, 8, null),
					new ExpectedCellValue(sheetName, 549, 8, null),
					new ExpectedCellValue(sheetName, 550, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 551, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 552, 8, 20100083),
					new ExpectedCellValue(sheetName, 553, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 554, 8, null),
					new ExpectedCellValue(sheetName, 555, 8, null),
					new ExpectedCellValue(sheetName, 556, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 557, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 558, 8, 20100085),
					new ExpectedCellValue(sheetName, 559, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 560, 8, null),
					new ExpectedCellValue(sheetName, 561, 8, null),
					new ExpectedCellValue(sheetName, 562, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 563, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 564, 8, 20100090),
					new ExpectedCellValue(sheetName, 565, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 566, 8, null),
					new ExpectedCellValue(sheetName, 567, 8, null),
					new ExpectedCellValue(sheetName, 568, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 569, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 570, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 527, 9, "Month"),
					new ExpectedCellValue(sheetName, 528, 9, null),
					new ExpectedCellValue(sheetName, 529, 9, "January"),
					new ExpectedCellValue(sheetName, 530, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 531, 9, "January Total"),
					new ExpectedCellValue(sheetName, 532, 9, null),
					new ExpectedCellValue(sheetName, 533, 9, null),
					new ExpectedCellValue(sheetName, 534, 9, null),
					new ExpectedCellValue(sheetName, 535, 9, "March"),
					new ExpectedCellValue(sheetName, 536, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 537, 9, "March Total"),
					new ExpectedCellValue(sheetName, 538, 9, null),
					new ExpectedCellValue(sheetName, 539, 9, null),
					new ExpectedCellValue(sheetName, 540, 9, null),
					new ExpectedCellValue(sheetName, 541, 9, "February"),
					new ExpectedCellValue(sheetName, 542, 9, "Tent"),
					new ExpectedCellValue(sheetName, 543, 9, "February Total"),
					new ExpectedCellValue(sheetName, 544, 9, null),
					new ExpectedCellValue(sheetName, 545, 9, null),
					new ExpectedCellValue(sheetName, 546, 9, null),
					new ExpectedCellValue(sheetName, 547, 9, "January"),
					new ExpectedCellValue(sheetName, 548, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 549, 9, "January Total"),
					new ExpectedCellValue(sheetName, 550, 9, null),
					new ExpectedCellValue(sheetName, 551, 9, null),
					new ExpectedCellValue(sheetName, 552, 9, null),
					new ExpectedCellValue(sheetName, 553, 9, "March"),
					new ExpectedCellValue(sheetName, 554, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 555, 9, "March Total"),
					new ExpectedCellValue(sheetName, 556, 9, null),
					new ExpectedCellValue(sheetName, 557, 9, null),
					new ExpectedCellValue(sheetName, 558, 9, null),
					new ExpectedCellValue(sheetName, 559, 9, "February"),
					new ExpectedCellValue(sheetName, 560, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 561, 9, "February Total"),
					new ExpectedCellValue(sheetName, 562, 9, null),
					new ExpectedCellValue(sheetName, 563, 9, null),
					new ExpectedCellValue(sheetName, 564, 9, null),
					new ExpectedCellValue(sheetName, 565, 9, "January"),
					new ExpectedCellValue(sheetName, 566, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 567, 9, "January Total"),
					new ExpectedCellValue(sheetName, 568, 9, null),
					new ExpectedCellValue(sheetName, 569, 9, null),
					new ExpectedCellValue(sheetName, 570, 9, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularFirstFieldOnlySubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable27"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B573:D602"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 573, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 574, 2, 20100007),
					new ExpectedCellValue(sheetName, 575, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 576, 2, null),
					new ExpectedCellValue(sheetName, 577, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 578, 2, 20100017),
					new ExpectedCellValue(sheetName, 579, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 580, 2, null),
					new ExpectedCellValue(sheetName, 581, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 582, 2, 20100070),
					new ExpectedCellValue(sheetName, 583, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 584, 2, null),
					new ExpectedCellValue(sheetName, 585, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 586, 2, 20100076),
					new ExpectedCellValue(sheetName, 587, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 588, 2, null),
					new ExpectedCellValue(sheetName, 589, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 590, 2, 20100083),
					new ExpectedCellValue(sheetName, 591, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 592, 2, null),
					new ExpectedCellValue(sheetName, 593, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 594, 2, 20100085),
					new ExpectedCellValue(sheetName, 595, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 596, 2, null),
					new ExpectedCellValue(sheetName, 597, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 598, 2, 20100090),
					new ExpectedCellValue(sheetName, 599, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 600, 2, null),
					new ExpectedCellValue(sheetName, 601, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 602, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 573, 3, "Month"),
					new ExpectedCellValue(sheetName, 574, 3, null),
					new ExpectedCellValue(sheetName, 575, 3, "January"),
					new ExpectedCellValue(sheetName, 576, 3, "January Total"),
					new ExpectedCellValue(sheetName, 577, 3, null),
					new ExpectedCellValue(sheetName, 578, 3, null),
					new ExpectedCellValue(sheetName, 579, 3, "March"),
					new ExpectedCellValue(sheetName, 580, 3, "March Total"),
					new ExpectedCellValue(sheetName, 581, 3, null),
					new ExpectedCellValue(sheetName, 582, 3, null),
					new ExpectedCellValue(sheetName, 583, 3, "February"),
					new ExpectedCellValue(sheetName, 584, 3, "February Total"),
					new ExpectedCellValue(sheetName, 585, 3, null),
					new ExpectedCellValue(sheetName, 586, 3, null),
					new ExpectedCellValue(sheetName, 587, 3, "January"),
					new ExpectedCellValue(sheetName, 588, 3, "January Total"),
					new ExpectedCellValue(sheetName, 589, 3, null),
					new ExpectedCellValue(sheetName, 590, 3, null),
					new ExpectedCellValue(sheetName, 591, 3, "March"),
					new ExpectedCellValue(sheetName, 592, 3, "March Total"),
					new ExpectedCellValue(sheetName, 593, 3, null),
					new ExpectedCellValue(sheetName, 594, 3, null),
					new ExpectedCellValue(sheetName, 595, 3, "February"),
					new ExpectedCellValue(sheetName, 596, 3, "February Total"),
					new ExpectedCellValue(sheetName, 597, 3, null),
					new ExpectedCellValue(sheetName, 598, 3, null),
					new ExpectedCellValue(sheetName, 599, 3, "January"),
					new ExpectedCellValue(sheetName, 600, 3, "January Total"),
					new ExpectedCellValue(sheetName, 601, 3, null),
					new ExpectedCellValue(sheetName, 602, 3, null),
					new ExpectedCellValue(sheetName, 573, 4, "Item"),
					new ExpectedCellValue(sheetName, 574, 4, null),
					new ExpectedCellValue(sheetName, 575, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 576, 4, null),
					new ExpectedCellValue(sheetName, 577, 4, null),
					new ExpectedCellValue(sheetName, 578, 4, null),
					new ExpectedCellValue(sheetName, 579, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 580, 4, null),
					new ExpectedCellValue(sheetName, 581, 4, null),
					new ExpectedCellValue(sheetName, 582, 4, null),
					new ExpectedCellValue(sheetName, 583, 4, "Tent"),
					new ExpectedCellValue(sheetName, 584, 4, null),
					new ExpectedCellValue(sheetName, 585, 4, null),
					new ExpectedCellValue(sheetName, 586, 4, null),
					new ExpectedCellValue(sheetName, 587, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 588, 4, null),
					new ExpectedCellValue(sheetName, 589, 4, null),
					new ExpectedCellValue(sheetName, 590, 4, null),
					new ExpectedCellValue(sheetName, 591, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 592, 4, null),
					new ExpectedCellValue(sheetName, 593, 4, null),
					new ExpectedCellValue(sheetName, 594, 4, null),
					new ExpectedCellValue(sheetName, 595, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 596, 4, null),
					new ExpectedCellValue(sheetName, 597, 4, null),
					new ExpectedCellValue(sheetName, 598, 4, null),
					new ExpectedCellValue(sheetName, 599, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 600, 4, null),
					new ExpectedCellValue(sheetName, 601, 4, null),
					new ExpectedCellValue(sheetName, 602, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularFirstFieldOnlySubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable28"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H573:J609"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 573, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 574, 8, 20100007),
					new ExpectedCellValue(sheetName, 575, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 576, 8, null),
					new ExpectedCellValue(sheetName, 577, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 578, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 579, 8, 20100017),
					new ExpectedCellValue(sheetName, 580, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 581, 8, null),
					new ExpectedCellValue(sheetName, 582, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 583, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 584, 8, 20100070),
					new ExpectedCellValue(sheetName, 585, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 586, 8, null),
					new ExpectedCellValue(sheetName, 587, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 588, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 589, 8, 20100076),
					new ExpectedCellValue(sheetName, 590, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 591, 8, null),
					new ExpectedCellValue(sheetName, 592, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 593, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 594, 8, 20100083),
					new ExpectedCellValue(sheetName, 595, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 596, 8, null),
					new ExpectedCellValue(sheetName, 597, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 598, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 599, 8, 20100085),
					new ExpectedCellValue(sheetName, 600, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 601, 8, null),
					new ExpectedCellValue(sheetName, 602, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 603, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 604, 8, 20100090),
					new ExpectedCellValue(sheetName, 605, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 606, 8, null),
					new ExpectedCellValue(sheetName, 607, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 608, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 609, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 573, 9, "Month"),
					new ExpectedCellValue(sheetName, 574, 9, null),
					new ExpectedCellValue(sheetName, 575, 9, "January"),
					new ExpectedCellValue(sheetName, 576, 9, "January Total"),
					new ExpectedCellValue(sheetName, 577, 9, null),
					new ExpectedCellValue(sheetName, 578, 9, null),
					new ExpectedCellValue(sheetName, 579, 9, null),
					new ExpectedCellValue(sheetName, 580, 9, "March"),
					new ExpectedCellValue(sheetName, 581, 9, "March Total"),
					new ExpectedCellValue(sheetName, 582, 9, null),
					new ExpectedCellValue(sheetName, 583, 9, null),
					new ExpectedCellValue(sheetName, 584, 9, null),
					new ExpectedCellValue(sheetName, 585, 9, "February"),
					new ExpectedCellValue(sheetName, 586, 9, "February Total"),
					new ExpectedCellValue(sheetName, 587, 9, null),
					new ExpectedCellValue(sheetName, 588, 9, null),
					new ExpectedCellValue(sheetName, 589, 9, null),
					new ExpectedCellValue(sheetName, 590, 9, "January"),
					new ExpectedCellValue(sheetName, 591, 9, "January Total"),
					new ExpectedCellValue(sheetName, 592, 9, null),
					new ExpectedCellValue(sheetName, 593, 9, null),
					new ExpectedCellValue(sheetName, 594, 9, null),
					new ExpectedCellValue(sheetName, 595, 9, "March"),
					new ExpectedCellValue(sheetName, 596, 9, "March Total"),
					new ExpectedCellValue(sheetName, 597, 9, null),
					new ExpectedCellValue(sheetName, 598, 9, null),
					new ExpectedCellValue(sheetName, 599, 9, null),
					new ExpectedCellValue(sheetName, 600, 9, "February"),
					new ExpectedCellValue(sheetName, 601, 9, "February Total"),
					new ExpectedCellValue(sheetName, 602, 9, null),
					new ExpectedCellValue(sheetName, 603, 9, null),
					new ExpectedCellValue(sheetName, 604, 9, null),
					new ExpectedCellValue(sheetName, 605, 9, "January"),
					new ExpectedCellValue(sheetName, 606, 9, "January Total"),
					new ExpectedCellValue(sheetName, 607, 9, null),
					new ExpectedCellValue(sheetName, 608, 9, null),
					new ExpectedCellValue(sheetName, 609, 9, null),
					new ExpectedCellValue(sheetName, 573, 10, "Item"),
					new ExpectedCellValue(sheetName, 574, 10, null),
					new ExpectedCellValue(sheetName, 575, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 576, 10, null),
					new ExpectedCellValue(sheetName, 577, 10, null),
					new ExpectedCellValue(sheetName, 578, 10, null),
					new ExpectedCellValue(sheetName, 579, 10, null),
					new ExpectedCellValue(sheetName, 580, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 581, 10, null),
					new ExpectedCellValue(sheetName, 582, 10, null),
					new ExpectedCellValue(sheetName, 583, 10, null),
					new ExpectedCellValue(sheetName, 584, 10, null),
					new ExpectedCellValue(sheetName, 585, 10, "Tent"),
					new ExpectedCellValue(sheetName, 586, 10, null),
					new ExpectedCellValue(sheetName, 587, 10, null),
					new ExpectedCellValue(sheetName, 588, 10, null),
					new ExpectedCellValue(sheetName, 589, 10, null),
					new ExpectedCellValue(sheetName, 590, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 591, 10, null),
					new ExpectedCellValue(sheetName, 592, 10, null),
					new ExpectedCellValue(sheetName, 593, 10, null),
					new ExpectedCellValue(sheetName, 594, 10, null),
					new ExpectedCellValue(sheetName, 595, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 596, 10, null),
					new ExpectedCellValue(sheetName, 597, 10, null),
					new ExpectedCellValue(sheetName, 598, 10, null),
					new ExpectedCellValue(sheetName, 599, 10, null),
					new ExpectedCellValue(sheetName, 600, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 601, 10, null),
					new ExpectedCellValue(sheetName, 602, 10, null),
					new ExpectedCellValue(sheetName, 603, 10, null),
					new ExpectedCellValue(sheetName, 604, 10, null),
					new ExpectedCellValue(sheetName, 605, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 606, 10, null),
					new ExpectedCellValue(sheetName, 607, 10, null),
					new ExpectedCellValue(sheetName, 608, 10, null),
					new ExpectedCellValue(sheetName, 609, 10, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularFirstAndLastFieldsSubtotalsTopTrue()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable29"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B614:D643"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 614, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 615, 2, 20100007),
					new ExpectedCellValue(sheetName, 616, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 617, 2, null),
					new ExpectedCellValue(sheetName, 618, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 619, 2, 20100017),
					new ExpectedCellValue(sheetName, 620, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 621, 2, null),
					new ExpectedCellValue(sheetName, 622, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 623, 2, 20100070),
					new ExpectedCellValue(sheetName, 624, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 625, 2, null),
					new ExpectedCellValue(sheetName, 626, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 627, 2, 20100076),
					new ExpectedCellValue(sheetName, 628, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 629, 2, null),
					new ExpectedCellValue(sheetName, 630, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 631, 2, 20100083),
					new ExpectedCellValue(sheetName, 632, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 633, 2, null),
					new ExpectedCellValue(sheetName, 634, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 635, 2, 20100085),
					new ExpectedCellValue(sheetName, 636, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 637, 2, null),
					new ExpectedCellValue(sheetName, 638, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 639, 2, 20100090),
					new ExpectedCellValue(sheetName, 640, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 641, 2, null),
					new ExpectedCellValue(sheetName, 642, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 643, 2, "Grand Total"),
					new ExpectedCellValue(sheetName, 614, 3, "Month"),
					new ExpectedCellValue(sheetName, 615, 3, null),
					new ExpectedCellValue(sheetName, 616, 3, "January"),
					new ExpectedCellValue(sheetName, 617, 3, "January Total"),
					new ExpectedCellValue(sheetName, 618, 3, null),
					new ExpectedCellValue(sheetName, 619, 3, null),
					new ExpectedCellValue(sheetName, 620, 3, "March"),
					new ExpectedCellValue(sheetName, 621, 3, "March Total"),
					new ExpectedCellValue(sheetName, 622, 3, null),
					new ExpectedCellValue(sheetName, 623, 3, null),
					new ExpectedCellValue(sheetName, 624, 3, "February"),
					new ExpectedCellValue(sheetName, 625, 3, "February Total"),
					new ExpectedCellValue(sheetName, 626, 3, null),
					new ExpectedCellValue(sheetName, 627, 3, null),
					new ExpectedCellValue(sheetName, 628, 3, "January"),
					new ExpectedCellValue(sheetName, 629, 3, "January Total"),
					new ExpectedCellValue(sheetName, 630, 3, null),
					new ExpectedCellValue(sheetName, 631, 3, null),
					new ExpectedCellValue(sheetName, 632, 3, "March"),
					new ExpectedCellValue(sheetName, 633, 3, "March Total"),
					new ExpectedCellValue(sheetName, 634, 3, null),
					new ExpectedCellValue(sheetName, 635, 3, null),
					new ExpectedCellValue(sheetName, 636, 3, "February"),
					new ExpectedCellValue(sheetName, 637, 3, "February Total"),
					new ExpectedCellValue(sheetName, 638, 3, null),
					new ExpectedCellValue(sheetName, 639, 3, null),
					new ExpectedCellValue(sheetName, 640, 3, "January"),
					new ExpectedCellValue(sheetName, 641, 3, "January Total"),
					new ExpectedCellValue(sheetName, 642, 3, null),
					new ExpectedCellValue(sheetName, 643, 3, null),
					new ExpectedCellValue(sheetName, 614, 4, "Item"),
					new ExpectedCellValue(sheetName, 615, 4, null),
					new ExpectedCellValue(sheetName, 616, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 617, 4, null),
					new ExpectedCellValue(sheetName, 618, 4, null),
					new ExpectedCellValue(sheetName, 619, 4, null),
					new ExpectedCellValue(sheetName, 620, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 621, 4, null),
					new ExpectedCellValue(sheetName, 622, 4, null),
					new ExpectedCellValue(sheetName, 623, 4, null),
					new ExpectedCellValue(sheetName, 624, 4, "Tent"),
					new ExpectedCellValue(sheetName, 625, 4, null),
					new ExpectedCellValue(sheetName, 626, 4, null),
					new ExpectedCellValue(sheetName, 627, 4, null),
					new ExpectedCellValue(sheetName, 628, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 629, 4, null),
					new ExpectedCellValue(sheetName, 630, 4, null),
					new ExpectedCellValue(sheetName, 631, 4, null),
					new ExpectedCellValue(sheetName, 632, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 633, 4, null),
					new ExpectedCellValue(sheetName, 634, 4, null),
					new ExpectedCellValue(sheetName, 635, 4, null),
					new ExpectedCellValue(sheetName, 636, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 637, 4, null),
					new ExpectedCellValue(sheetName, 638, 4, null),
					new ExpectedCellValue(sheetName, 639, 4, null),
					new ExpectedCellValue(sheetName, 640, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 641, 4, null),
					new ExpectedCellValue(sheetName, 642, 4, null),
					new ExpectedCellValue(sheetName, 643, 4, null)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsSubtotalOn.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsFourRowFieldsRegularFirstAndLastFieldsSubtotalsTopFalse()
		{
			var file = new FileInfo("PivotTableTabularSettingsSubtotalOn.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable30"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H614:J650"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 614, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 615, 8, 20100007),
					new ExpectedCellValue(sheetName, 616, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 617, 8, null),
					new ExpectedCellValue(sheetName, 618, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 619, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 620, 8, 20100017),
					new ExpectedCellValue(sheetName, 621, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 622, 8, null),
					new ExpectedCellValue(sheetName, 623, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 624, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 625, 8, 20100070),
					new ExpectedCellValue(sheetName, 626, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 627, 8, null),
					new ExpectedCellValue(sheetName, 628, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 629, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 630, 8, 20100076),
					new ExpectedCellValue(sheetName, 631, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 632, 8, null),
					new ExpectedCellValue(sheetName, 633, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 634, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 635, 8, 20100083),
					new ExpectedCellValue(sheetName, 636, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 637, 8, null),
					new ExpectedCellValue(sheetName, 638, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 639, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 640, 8, 20100085),
					new ExpectedCellValue(sheetName, 641, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 642, 8, null),
					new ExpectedCellValue(sheetName, 643, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 644, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 645, 8, 20100090),
					new ExpectedCellValue(sheetName, 646, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 647, 8, null),
					new ExpectedCellValue(sheetName, 648, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 649, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 650, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 614, 9, "Month"),
					new ExpectedCellValue(sheetName, 615, 9, null),
					new ExpectedCellValue(sheetName, 616, 9, "January"),
					new ExpectedCellValue(sheetName, 617, 9, "January Total"),
					new ExpectedCellValue(sheetName, 618, 9, null),
					new ExpectedCellValue(sheetName, 619, 9, null),
					new ExpectedCellValue(sheetName, 620, 9, null),
					new ExpectedCellValue(sheetName, 621, 9, "March"),
					new ExpectedCellValue(sheetName, 622, 9, "March Total"),
					new ExpectedCellValue(sheetName, 623, 9, null),
					new ExpectedCellValue(sheetName, 624, 9, null),
					new ExpectedCellValue(sheetName, 625, 9, null),
					new ExpectedCellValue(sheetName, 626, 9, "February"),
					new ExpectedCellValue(sheetName, 627, 9, "February Total"),
					new ExpectedCellValue(sheetName, 628, 9, null),
					new ExpectedCellValue(sheetName, 629, 9, null),
					new ExpectedCellValue(sheetName, 630, 9, null),
					new ExpectedCellValue(sheetName, 631, 9, "January"),
					new ExpectedCellValue(sheetName, 632, 9, "January Total"),
					new ExpectedCellValue(sheetName, 633, 9, null),
					new ExpectedCellValue(sheetName, 634, 9, null),
					new ExpectedCellValue(sheetName, 635, 9, null),
					new ExpectedCellValue(sheetName, 636, 9, "March"),
					new ExpectedCellValue(sheetName, 637, 9, "March Total"),
					new ExpectedCellValue(sheetName, 638, 9, null),
					new ExpectedCellValue(sheetName, 639, 9, null),
					new ExpectedCellValue(sheetName, 640, 9, null),
					new ExpectedCellValue(sheetName, 641, 9, "February"),
					new ExpectedCellValue(sheetName, 642, 9, "February Total"),
					new ExpectedCellValue(sheetName, 643, 9, null),
					new ExpectedCellValue(sheetName, 644, 9, null),
					new ExpectedCellValue(sheetName, 645, 9, null),
					new ExpectedCellValue(sheetName, 646, 9, "January"),
					new ExpectedCellValue(sheetName, 647, 9, "January Total"),
					new ExpectedCellValue(sheetName, 648, 9, null),
					new ExpectedCellValue(sheetName, 649, 9, null),
					new ExpectedCellValue(sheetName, 650, 9, null),
					new ExpectedCellValue(sheetName, 614, 10, "Item"),
					new ExpectedCellValue(sheetName, 615, 10, null),
					new ExpectedCellValue(sheetName, 616, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 617, 10, null),
					new ExpectedCellValue(sheetName, 618, 10, null),
					new ExpectedCellValue(sheetName, 619, 10, null),
					new ExpectedCellValue(sheetName, 620, 10, null),
					new ExpectedCellValue(sheetName, 621, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 622, 10, null),
					new ExpectedCellValue(sheetName, 623, 10, null),
					new ExpectedCellValue(sheetName, 624, 10, null),
					new ExpectedCellValue(sheetName, 625, 10, null),
					new ExpectedCellValue(sheetName, 626, 10, "Tent"),
					new ExpectedCellValue(sheetName, 627, 10, null),
					new ExpectedCellValue(sheetName, 628, 10, null),
					new ExpectedCellValue(sheetName, 629, 10, null),
					new ExpectedCellValue(sheetName, 630, 10, null),
					new ExpectedCellValue(sheetName, 631, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 632, 10, null),
					new ExpectedCellValue(sheetName, 633, 10, null),
					new ExpectedCellValue(sheetName, 634, 10, null),
					new ExpectedCellValue(sheetName, 635, 10, null),
					new ExpectedCellValue(sheetName, 636, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 637, 10, null),
					new ExpectedCellValue(sheetName, 638, 10, null),
					new ExpectedCellValue(sheetName, 639, 10, null),
					new ExpectedCellValue(sheetName, 640, 10, null),
					new ExpectedCellValue(sheetName, 641, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 642, 10, null),
					new ExpectedCellValue(sheetName, 643, 10, null),
					new ExpectedCellValue(sheetName, 644, 10, null),
					new ExpectedCellValue(sheetName, 645, 10, null),
					new ExpectedCellValue(sheetName, 646, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 647, 10, null),
					new ExpectedCellValue(sheetName, 648, 10, null),
					new ExpectedCellValue(sheetName, 649, 10, null),
					new ExpectedCellValue(sheetName, 650, 10, null)
				});
			}
		}
		#endregion

		#region Tabular Pivot Tables With Data Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledTwoRowFieldsBothTabularNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:C13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 6, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 10, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 13, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 4, 2, "March"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, "January"),
					new ExpectedCellValue(sheetName, 7, 2, "February"),
					new ExpectedCellValue(sheetName, 8, 2, "March"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "January"),
					new ExpectedCellValue(sheetName, 11, 2, "February"),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 3, 831.5),
					new ExpectedCellValue(sheetName, 4, 3, 24.99),
					new ExpectedCellValue(sheetName, 5, 3, 856.49),
					new ExpectedCellValue(sheetName, 6, 3, 831.5),
					new ExpectedCellValue(sheetName, 7, 3, 1194d),
					new ExpectedCellValue(sheetName, 8, 3, 831.5),
					new ExpectedCellValue(sheetName, 9, 3, 2857d),
					new ExpectedCellValue(sheetName, 10, 3, 415.75),
					new ExpectedCellValue(sheetName, 11, 3, 99d),
					new ExpectedCellValue(sheetName, 12, 3, 514.75),
					new ExpectedCellValue(sheetName, 13, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledTwoRowFieldsBothTabularOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:L14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 7, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 11, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 14, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, null),
					new ExpectedCellValue(sheetName, 3, 7, "Month"),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, "March"),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, "January"),
					new ExpectedCellValue(sheetName, 8, 7, "February"),
					new ExpectedCellValue(sheetName, 9, 7, "March"),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, "January"),
					new ExpectedCellValue(sheetName, 12, 7, "February"),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 2, 8, "Column Labels"),
					new ExpectedCellValue(sheetName, 3, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 8, 831.5),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 7, 8, 831.5),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, 831.5),
					new ExpectedCellValue(sheetName, 10, 8, 1663d),
					new ExpectedCellValue(sheetName, 11, 8, 415.75),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, 415.75),
					new ExpectedCellValue(sheetName, 14, 8, 2910.25),
					new ExpectedCellValue(sheetName, 2, 9, null),
					new ExpectedCellValue(sheetName, 3, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, 24.99),
					new ExpectedCellValue(sheetName, 6, 9, 24.99),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, null),
					new ExpectedCellValue(sheetName, 14, 9, 24.99),
					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, 99d),
					new ExpectedCellValue(sheetName, 13, 10, 99d),
					new ExpectedCellValue(sheetName, 14, 10, 99d),
					new ExpectedCellValue(sheetName, 2, 11, null),
					new ExpectedCellValue(sheetName, 3, 11, "Tent"),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, 1194d),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, 1194d),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, 1194d),
					new ExpectedCellValue(sheetName, 2, 12, null),
					new ExpectedCellValue(sheetName, 3, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 12, 831.5),
					new ExpectedCellValue(sheetName, 5, 12, 24.99),
					new ExpectedCellValue(sheetName, 6, 12, 856.49),
					new ExpectedCellValue(sheetName, 7, 12, 831.5),
					new ExpectedCellValue(sheetName, 8, 12, 1194d),
					new ExpectedCellValue(sheetName, 9, 12, 831.5),
					new ExpectedCellValue(sheetName, 10, 12, 2857d),
					new ExpectedCellValue(sheetName, 11, 12, 415.75),
					new ExpectedCellValue(sheetName, 12, 12, 99d),
					new ExpectedCellValue(sheetName, 13, 12, 514.75),
					new ExpectedCellValue(sheetName, 14, 12, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledTwoRowFieldsBothTabularTwoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A19:N32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 19, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 22, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 23, 1, null),
					new ExpectedCellValue(sheetName, 24, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 25, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, null),
					new ExpectedCellValue(sheetName, 28, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 29, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 30, 1, null),
					new ExpectedCellValue(sheetName, 31, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 32, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, "Month"),
					new ExpectedCellValue(sheetName, 22, 2, "January"),
					new ExpectedCellValue(sheetName, 23, 2, "March"),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, "January"),
					new ExpectedCellValue(sheetName, 26, 2, "February"),
					new ExpectedCellValue(sheetName, 27, 2, "March"),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, "January"),
					new ExpectedCellValue(sheetName, 30, 2, "February"),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 19, 3, "Column Labels"),
					new ExpectedCellValue(sheetName, 20, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 3, 20100007),
					new ExpectedCellValue(sheetName, 22, 3, 831.5),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, 831.5),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, 831.5),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, 20100017),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, 831.5),
					new ExpectedCellValue(sheetName, 28, 4, 831.5),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, 831.5),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, 20100076),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, 415.75),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, 415.75),
					new ExpectedCellValue(sheetName, 32, 5, 415.75),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, 20100090),
					new ExpectedCellValue(sheetName, 22, 6, null),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, null),
					new ExpectedCellValue(sheetName, 25, 6, 831.5),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, 831.5),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, 831.5),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, 831.5),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, 831.5),
					new ExpectedCellValue(sheetName, 25, 7, 831.5),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, 831.5),
					new ExpectedCellValue(sheetName, 28, 7, 1663d),
					new ExpectedCellValue(sheetName, 29, 7, 415.75),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, 415.75),
					new ExpectedCellValue(sheetName, 32, 7, 2910.25),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 21, 8, 20100083),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, 24.99),
					new ExpectedCellValue(sheetName, 24, 8, 24.99),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, 24.99),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, 24.99),
					new ExpectedCellValue(sheetName, 24, 9, 24.99),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, 24.99),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 21, 10, 20100085),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, 99d),
					new ExpectedCellValue(sheetName, 31, 10, 99d),
					new ExpectedCellValue(sheetName, 32, 10, 99d),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, null),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, 99d),
					new ExpectedCellValue(sheetName, 31, 11, 99d),
					new ExpectedCellValue(sheetName, 32, 11, 99d),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, "Tent"),
					new ExpectedCellValue(sheetName, 21, 12, 20100070),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, null),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, 1194d),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, 1194d),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, 1194d),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, "Tent Total"),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 26, 13, 1194d),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, 1194d),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 30, 13, null),
					new ExpectedCellValue(sheetName, 31, 13, null),
					new ExpectedCellValue(sheetName, 32, 13, 1194d),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, 831.5),
					new ExpectedCellValue(sheetName, 23, 14, 24.99),
					new ExpectedCellValue(sheetName, 24, 14, 856.49),
					new ExpectedCellValue(sheetName, 25, 14, 831.5),
					new ExpectedCellValue(sheetName, 26, 14, 1194d),
					new ExpectedCellValue(sheetName, 27, 14, 831.5),
					new ExpectedCellValue(sheetName, 28, 14, 2857d),
					new ExpectedCellValue(sheetName, 29, 14, 415.75),
					new ExpectedCellValue(sheetName, 30, 14, 99d),
					new ExpectedCellValue(sheetName, 31, 14, 514.75),
					new ExpectedCellValue(sheetName, 32, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledThreeRowFieldsTabularFirstAndSecondFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:D20"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 8, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 15, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 1, null),
					new ExpectedCellValue(sheetName, 17, 1, null),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 20, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, "January"),
					new ExpectedCellValue(sheetName, 4, 2, "January Total"),
					new ExpectedCellValue(sheetName, 5, 2, "March"),
					new ExpectedCellValue(sheetName, 6, 2, "March Total"),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "January"),
					new ExpectedCellValue(sheetName, 9, 2, "January Total"),
					new ExpectedCellValue(sheetName, 10, 2, "February"),
					new ExpectedCellValue(sheetName, 11, 2, "February Total"),
					new ExpectedCellValue(sheetName, 12, 2, "March"),
					new ExpectedCellValue(sheetName, 13, 2, "March Total"),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, "January"),
					new ExpectedCellValue(sheetName, 16, 2, "January Total"),
					new ExpectedCellValue(sheetName, 17, 2, "February"),
					new ExpectedCellValue(sheetName, 18, 2, "February Total"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Item"),
					new ExpectedCellValue(sheetName, 3, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, "Tent"),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 4, 831.5),
					new ExpectedCellValue(sheetName, 4, 4, 831.5),
					new ExpectedCellValue(sheetName, 5, 4, 24.99),
					new ExpectedCellValue(sheetName, 6, 4, 24.99),
					new ExpectedCellValue(sheetName, 7, 4, 856.49),
					new ExpectedCellValue(sheetName, 8, 4, 831.5),
					new ExpectedCellValue(sheetName, 9, 4, 831.5),
					new ExpectedCellValue(sheetName, 10, 4, 1194d),
					new ExpectedCellValue(sheetName, 11, 4, 1194d),
					new ExpectedCellValue(sheetName, 12, 4, 831.5),
					new ExpectedCellValue(sheetName, 13, 4, 831.5),
					new ExpectedCellValue(sheetName, 14, 4, 2857d),
					new ExpectedCellValue(sheetName, 15, 4, 415.75),
					new ExpectedCellValue(sheetName, 16, 4, 415.75),
					new ExpectedCellValue(sheetName, 17, 4, 99d),
					new ExpectedCellValue(sheetName, 18, 4, 99d),
					new ExpectedCellValue(sheetName, 19, 4, 514.75),
					new ExpectedCellValue(sheetName, 20, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledThreeRowFieldsTabularFirstAndSecondFieldsOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:Q21"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 21, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 8, null),
					new ExpectedCellValue(sheetName, 3, 8, "Month"),
					new ExpectedCellValue(sheetName, 4, 8, "January"),
					new ExpectedCellValue(sheetName, 5, 8, "January Total"),
					new ExpectedCellValue(sheetName, 6, 8, "March"),
					new ExpectedCellValue(sheetName, 7, 8, "March Total"),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, "January"),
					new ExpectedCellValue(sheetName, 10, 8, "January Total"),
					new ExpectedCellValue(sheetName, 11, 8, "February"),
					new ExpectedCellValue(sheetName, 12, 8, "February Total"),
					new ExpectedCellValue(sheetName, 13, 8, "March"),
					new ExpectedCellValue(sheetName, 14, 8, "March Total"),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "January"),
					new ExpectedCellValue(sheetName, 17, 8, "January Total"),
					new ExpectedCellValue(sheetName, 18, 8, "February"),
					new ExpectedCellValue(sheetName, 19, 8, "February Total"),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, null),
					new ExpectedCellValue(sheetName, 3, 9, "Item"),
					new ExpectedCellValue(sheetName, 4, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 9, null),
					new ExpectedCellValue(sheetName, 6, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "Tent"),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, "Column Labels"),
					new ExpectedCellValue(sheetName, 3, 10, 20100007),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 5, 10, 831.5),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, 831.5),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, 831.5),
					new ExpectedCellValue(sheetName, 2, 11, null),
					new ExpectedCellValue(sheetName, 3, 11, 20100017),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, 831.5),
					new ExpectedCellValue(sheetName, 14, 11, 831.5),
					new ExpectedCellValue(sheetName, 15, 11, 831.5),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, 831.5),
					new ExpectedCellValue(sheetName, 2, 12, null),
					new ExpectedCellValue(sheetName, 3, 12, 20100070),
					new ExpectedCellValue(sheetName, 4, 12, null),
					new ExpectedCellValue(sheetName, 5, 12, null),
					new ExpectedCellValue(sheetName, 6, 12, null),
					new ExpectedCellValue(sheetName, 7, 12, null),
					new ExpectedCellValue(sheetName, 8, 12, null),
					new ExpectedCellValue(sheetName, 9, 12, null),
					new ExpectedCellValue(sheetName, 10, 12, null),
					new ExpectedCellValue(sheetName, 11, 12, 1194d),
					new ExpectedCellValue(sheetName, 12, 12, 1194d),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, 1194d),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, 1194d),
					new ExpectedCellValue(sheetName, 2, 13, null),
					new ExpectedCellValue(sheetName, 3, 13, 20100076),
					new ExpectedCellValue(sheetName, 4, 13, null),
					new ExpectedCellValue(sheetName, 5, 13, null),
					new ExpectedCellValue(sheetName, 6, 13, null),
					new ExpectedCellValue(sheetName, 7, 13, null),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, null),
					new ExpectedCellValue(sheetName, 10, 13, null),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, 415.75),
					new ExpectedCellValue(sheetName, 17, 13, 415.75),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, 415.75),
					new ExpectedCellValue(sheetName, 21, 13, 415.75),
					new ExpectedCellValue(sheetName, 2, 14, null),
					new ExpectedCellValue(sheetName, 3, 14, 20100083),
					new ExpectedCellValue(sheetName, 4, 14, null),
					new ExpectedCellValue(sheetName, 5, 14, null),
					new ExpectedCellValue(sheetName, 6, 14, 24.99),
					new ExpectedCellValue(sheetName, 7, 14, 24.99),
					new ExpectedCellValue(sheetName, 8, 14, 24.99),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, 24.99),
					new ExpectedCellValue(sheetName, 2, 15, null),
					new ExpectedCellValue(sheetName, 3, 15, 20100085),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, null),
					new ExpectedCellValue(sheetName, 6, 15, null),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, 99d),
					new ExpectedCellValue(sheetName, 19, 15, 99d),
					new ExpectedCellValue(sheetName, 20, 15, 99d),
					new ExpectedCellValue(sheetName, 21, 15, 99d),
					new ExpectedCellValue(sheetName, 2, 16, null),
					new ExpectedCellValue(sheetName, 3, 16, 20100090),
					new ExpectedCellValue(sheetName, 4, 16, null),
					new ExpectedCellValue(sheetName, 5, 16, null),
					new ExpectedCellValue(sheetName, 6, 16, null),
					new ExpectedCellValue(sheetName, 7, 16, null),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, 831.5),
					new ExpectedCellValue(sheetName, 10, 16, 831.5),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, 831.5),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, 831.5),
					new ExpectedCellValue(sheetName, 2, 17, null),
					new ExpectedCellValue(sheetName, 3, 17, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 17, 831.5),
					new ExpectedCellValue(sheetName, 5, 17, 831.5),
					new ExpectedCellValue(sheetName, 6, 17, 24.99),
					new ExpectedCellValue(sheetName, 7, 17, 24.99),
					new ExpectedCellValue(sheetName, 8, 17, 856.49),
					new ExpectedCellValue(sheetName, 9, 17, 831.5),
					new ExpectedCellValue(sheetName, 10, 17, 831.5),
					new ExpectedCellValue(sheetName, 11, 17, 1194d),
					new ExpectedCellValue(sheetName, 12, 17, 1194d),
					new ExpectedCellValue(sheetName, 13, 17, 831.5),
					new ExpectedCellValue(sheetName, 14, 17, 831.5),
					new ExpectedCellValue(sheetName, 15, 17, 2857d),
					new ExpectedCellValue(sheetName, 16, 17, 415.75),
					new ExpectedCellValue(sheetName, 17, 17, 415.75),
					new ExpectedCellValue(sheetName, 18, 17, 99d),
					new ExpectedCellValue(sheetName, 19, 17, 99d),
					new ExpectedCellValue(sheetName, 20, 17, 514.75),
					new ExpectedCellValue(sheetName, 21, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledThreeRowFieldsTabularFirstFieldOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A27:C45"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 27, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 28, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 29, 1, null),
					new ExpectedCellValue(sheetName, 30, 1, null),
					new ExpectedCellValue(sheetName, 31, 1, null),
					new ExpectedCellValue(sheetName, 32, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 33, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 34, 1, null),
					new ExpectedCellValue(sheetName, 35, 1, null),
					new ExpectedCellValue(sheetName, 36, 1, null),
					new ExpectedCellValue(sheetName, 37, 1, null),
					new ExpectedCellValue(sheetName, 38, 1, null),
					new ExpectedCellValue(sheetName, 39, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 40, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 1, null),
					new ExpectedCellValue(sheetName, 42, 1, null),
					new ExpectedCellValue(sheetName, 43, 1, null),
					new ExpectedCellValue(sheetName, 44, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 45, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 27, 2, "Month"),
					new ExpectedCellValue(sheetName, 28, 2, "January"),
					new ExpectedCellValue(sheetName, 29, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 30, 2, "March"),
					new ExpectedCellValue(sheetName, 31, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, "January"),
					new ExpectedCellValue(sheetName, 34, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 35, 2, "February"),
					new ExpectedCellValue(sheetName, 36, 2, "Tent"),
					new ExpectedCellValue(sheetName, 37, 2, "March"),
					new ExpectedCellValue(sheetName, 38, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, "January"),
					new ExpectedCellValue(sheetName, 41, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 2, "February"),
					new ExpectedCellValue(sheetName, 43, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 27, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 3, 831.5),
					new ExpectedCellValue(sheetName, 29, 3, 831.5),
					new ExpectedCellValue(sheetName, 30, 3, 24.99),
					new ExpectedCellValue(sheetName, 31, 3, 24.99),
					new ExpectedCellValue(sheetName, 32, 3, 856.49),
					new ExpectedCellValue(sheetName, 33, 3, 831.5),
					new ExpectedCellValue(sheetName, 34, 3, 831.5),
					new ExpectedCellValue(sheetName, 35, 3, 1194d),
					new ExpectedCellValue(sheetName, 36, 3, 1194d),
					new ExpectedCellValue(sheetName, 37, 3, 831.5),
					new ExpectedCellValue(sheetName, 38, 3, 831.5),
					new ExpectedCellValue(sheetName, 39, 3, 2857d),
					new ExpectedCellValue(sheetName, 40, 3, 415.75),
					new ExpectedCellValue(sheetName, 41, 3, 415.75),
					new ExpectedCellValue(sheetName, 42, 3, 99d),
					new ExpectedCellValue(sheetName, 43, 3, 99d),
					new ExpectedCellValue(sheetName, 44, 3, 514.75),
					new ExpectedCellValue(sheetName, 45, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledThreeRowFieldsTabularFirstFieldOnlyOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G27:P46"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 27, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 29, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, "Chicago Total"),
					new ExpectedCellValue(sheetName, 34, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, null),
					new ExpectedCellValue(sheetName, 38, 7, null),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 41, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, null),
					new ExpectedCellValue(sheetName, 45, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 46, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, "Month"),
					new ExpectedCellValue(sheetName, 29, 8, "January"),
					new ExpectedCellValue(sheetName, 30, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 8, "March"),
					new ExpectedCellValue(sheetName, 32, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, "January"),
					new ExpectedCellValue(sheetName, 35, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 36, 8, "February"),
					new ExpectedCellValue(sheetName, 37, 8, "Tent"),
					new ExpectedCellValue(sheetName, 38, 8, "March"),
					new ExpectedCellValue(sheetName, 39, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, "January"),
					new ExpectedCellValue(sheetName, 42, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 8, "February"),
					new ExpectedCellValue(sheetName, 44, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 27, 9, "Column Labels"),
					new ExpectedCellValue(sheetName, 28, 9, 20100007),
					new ExpectedCellValue(sheetName, 29, 9, 831.5),
					new ExpectedCellValue(sheetName, 30, 9, 831.5),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, 831.5),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, 831.5),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, 20100017),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, 831.5),
					new ExpectedCellValue(sheetName, 39, 10, 831.5),
					new ExpectedCellValue(sheetName, 40, 10, 831.5),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, 831.5),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, 20100070),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 32, 11, null),
					new ExpectedCellValue(sheetName, 33, 11, null),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 36, 11, 1194d),
					new ExpectedCellValue(sheetName, 37, 11, 1194d),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, 1194d),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, 1194d),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, 20100076),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 33, 12, null),
					new ExpectedCellValue(sheetName, 34, 12, null),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, null),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, 415.75),
					new ExpectedCellValue(sheetName, 42, 12, 415.75),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, 415.75),
					new ExpectedCellValue(sheetName, 46, 12, 415.75),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, 20100083),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 30, 13, null),
					new ExpectedCellValue(sheetName, 31, 13, 24.99),
					new ExpectedCellValue(sheetName, 32, 13, 24.99),
					new ExpectedCellValue(sheetName, 33, 13, 24.99),
					new ExpectedCellValue(sheetName, 34, 13, null),
					new ExpectedCellValue(sheetName, 35, 13, null),
					new ExpectedCellValue(sheetName, 36, 13, null),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 41, 13, null),
					new ExpectedCellValue(sheetName, 42, 13, null),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, null),
					new ExpectedCellValue(sheetName, 45, 13, null),
					new ExpectedCellValue(sheetName, 46, 13, 24.99),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 28, 14, 20100085),
					new ExpectedCellValue(sheetName, 29, 14, null),
					new ExpectedCellValue(sheetName, 30, 14, null),
					new ExpectedCellValue(sheetName, 31, 14, null),
					new ExpectedCellValue(sheetName, 32, 14, null),
					new ExpectedCellValue(sheetName, 33, 14, null),
					new ExpectedCellValue(sheetName, 34, 14, null),
					new ExpectedCellValue(sheetName, 35, 14, null),
					new ExpectedCellValue(sheetName, 36, 14, null),
					new ExpectedCellValue(sheetName, 37, 14, null),
					new ExpectedCellValue(sheetName, 38, 14, null),
					new ExpectedCellValue(sheetName, 39, 14, null),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, null),
					new ExpectedCellValue(sheetName, 42, 14, null),
					new ExpectedCellValue(sheetName, 43, 14, 99d),
					new ExpectedCellValue(sheetName, 44, 14, 99d),
					new ExpectedCellValue(sheetName, 45, 14, 99d),
					new ExpectedCellValue(sheetName, 46, 14, 99d),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 28, 15, 20100090),
					new ExpectedCellValue(sheetName, 29, 15, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 33, 15, null),
					new ExpectedCellValue(sheetName, 34, 15, 831.5),
					new ExpectedCellValue(sheetName, 35, 15, 831.5),
					new ExpectedCellValue(sheetName, 36, 15, null),
					new ExpectedCellValue(sheetName, 37, 15, null),
					new ExpectedCellValue(sheetName, 38, 15, null),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 40, 15, 831.5),
					new ExpectedCellValue(sheetName, 41, 15, null),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, null),
					new ExpectedCellValue(sheetName, 44, 15, null),
					new ExpectedCellValue(sheetName, 45, 15, null),
					new ExpectedCellValue(sheetName, 46, 15, 831.5),
					new ExpectedCellValue(sheetName, 27, 16, null),
					new ExpectedCellValue(sheetName, 28, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 29, 16, 831.5),
					new ExpectedCellValue(sheetName, 30, 16, 831.5),
					new ExpectedCellValue(sheetName, 31, 16, 24.99),
					new ExpectedCellValue(sheetName, 32, 16, 24.99),
					new ExpectedCellValue(sheetName, 33, 16, 856.49),
					new ExpectedCellValue(sheetName, 34, 16, 831.5),
					new ExpectedCellValue(sheetName, 35, 16, 831.5),
					new ExpectedCellValue(sheetName, 36, 16, 1194d),
					new ExpectedCellValue(sheetName, 37, 16, 1194d),
					new ExpectedCellValue(sheetName, 38, 16, 831.5),
					new ExpectedCellValue(sheetName, 39, 16, 831.5),
					new ExpectedCellValue(sheetName, 40, 16, 2857d),
					new ExpectedCellValue(sheetName, 41, 16, 415.75),
					new ExpectedCellValue(sheetName, 42, 16, 415.75),
					new ExpectedCellValue(sheetName, 43, 16, 99d),
					new ExpectedCellValue(sheetName, 44, 16, 99d),
					new ExpectedCellValue(sheetName, 45, 16, 514.75),
					new ExpectedCellValue(sheetName, 46, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledThreeRowFieldsTabularSecondFieldOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A50:C68"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 50, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 51, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 52, 1, "January"),
					new ExpectedCellValue(sheetName, 53, 1, "January Total"),
					new ExpectedCellValue(sheetName, 54, 1, "March"),
					new ExpectedCellValue(sheetName, 55, 1, "March Total"),
					new ExpectedCellValue(sheetName, 56, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 57, 1, "January"),
					new ExpectedCellValue(sheetName, 58, 1, "January Total"),
					new ExpectedCellValue(sheetName, 59, 1, "February"),
					new ExpectedCellValue(sheetName, 60, 1, "February Total"),
					new ExpectedCellValue(sheetName, 61, 1, "March"),
					new ExpectedCellValue(sheetName, 62, 1, "March Total"),
					new ExpectedCellValue(sheetName, 63, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 64, 1, "January"),
					new ExpectedCellValue(sheetName, 65, 1, "January Total"),
					new ExpectedCellValue(sheetName, 66, 1, "February"),
					new ExpectedCellValue(sheetName, 67, 1, "February Total"),
					new ExpectedCellValue(sheetName, 68, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 50, 2, "Item"),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, "Tent"),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 50, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 3, 856.49),
					new ExpectedCellValue(sheetName, 52, 3, 831.5),
					new ExpectedCellValue(sheetName, 53, 3, 831.5),
					new ExpectedCellValue(sheetName, 54, 3, 24.99),
					new ExpectedCellValue(sheetName, 55, 3, 24.99),
					new ExpectedCellValue(sheetName, 56, 3, 2857d),
					new ExpectedCellValue(sheetName, 57, 3, 831.5),
					new ExpectedCellValue(sheetName, 58, 3, 831.5),
					new ExpectedCellValue(sheetName, 59, 3, 1194d),
					new ExpectedCellValue(sheetName, 60, 3, 1194d),
					new ExpectedCellValue(sheetName, 61, 3, 831.5),
					new ExpectedCellValue(sheetName, 62, 3, 831.5),
					new ExpectedCellValue(sheetName, 63, 3, 514.75),
					new ExpectedCellValue(sheetName, 64, 3, 415.75),
					new ExpectedCellValue(sheetName, 65, 3, 415.75),
					new ExpectedCellValue(sheetName, 66, 3, 99d),
					new ExpectedCellValue(sheetName, 67, 3, 99d),
					new ExpectedCellValue(sheetName, 68, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledThreeRowFieldsTabularSecondFieldOnlyOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G50:P69"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 50, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 7, "January"),
					new ExpectedCellValue(sheetName, 54, 7, "January Total"),
					new ExpectedCellValue(sheetName, 55, 7, "March"),
					new ExpectedCellValue(sheetName, 56, 7, "March Total"),
					new ExpectedCellValue(sheetName, 57, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 58, 7, "January"),
					new ExpectedCellValue(sheetName, 59, 7, "January Total"),
					new ExpectedCellValue(sheetName, 60, 7, "February"),
					new ExpectedCellValue(sheetName, 61, 7, "February Total"),
					new ExpectedCellValue(sheetName, 62, 7, "March"),
					new ExpectedCellValue(sheetName, 63, 7, "March Total"),
					new ExpectedCellValue(sheetName, 64, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 65, 7, "January"),
					new ExpectedCellValue(sheetName, 66, 7, "January Total"),
					new ExpectedCellValue(sheetName, 67, 7, "February"),
					new ExpectedCellValue(sheetName, 68, 7, "February Total"),
					new ExpectedCellValue(sheetName, 69, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, "Item"),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, "Tent"),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, null),
					new ExpectedCellValue(sheetName, 50, 9, "Column Labels"),
					new ExpectedCellValue(sheetName, 51, 9, 20100007),
					new ExpectedCellValue(sheetName, 52, 9, 831.5),
					new ExpectedCellValue(sheetName, 53, 9, 831.5),
					new ExpectedCellValue(sheetName, 54, 9, 831.5),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, null),
					new ExpectedCellValue(sheetName, 69, 9, 831.5),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, 20100017),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, null),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, 831.5),
					new ExpectedCellValue(sheetName, 58, 10, null),
					new ExpectedCellValue(sheetName, 59, 10, null),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, null),
					new ExpectedCellValue(sheetName, 62, 10, 831.5),
					new ExpectedCellValue(sheetName, 63, 10, 831.5),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 66, 10, null),
					new ExpectedCellValue(sheetName, 67, 10, null),
					new ExpectedCellValue(sheetName, 68, 10, null),
					new ExpectedCellValue(sheetName, 69, 10, 831.5),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, 20100070),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 54, 11, null),
					new ExpectedCellValue(sheetName, 55, 11, null),
					new ExpectedCellValue(sheetName, 56, 11, null),
					new ExpectedCellValue(sheetName, 57, 11, 1194d),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, null),
					new ExpectedCellValue(sheetName, 60, 11, 1194d),
					new ExpectedCellValue(sheetName, 61, 11, 1194d),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, null),
					new ExpectedCellValue(sheetName, 65, 11, null),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, null),
					new ExpectedCellValue(sheetName, 68, 11, null),
					new ExpectedCellValue(sheetName, 69, 11, 1194d),
					new ExpectedCellValue(sheetName, 50, 12, null),
					new ExpectedCellValue(sheetName, 51, 12, 20100076),
					new ExpectedCellValue(sheetName, 52, 12, null),
					new ExpectedCellValue(sheetName, 53, 12, null),
					new ExpectedCellValue(sheetName, 54, 12, null),
					new ExpectedCellValue(sheetName, 55, 12, null),
					new ExpectedCellValue(sheetName, 56, 12, null),
					new ExpectedCellValue(sheetName, 57, 12, null),
					new ExpectedCellValue(sheetName, 58, 12, null),
					new ExpectedCellValue(sheetName, 59, 12, null),
					new ExpectedCellValue(sheetName, 60, 12, null),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, null),
					new ExpectedCellValue(sheetName, 63, 12, null),
					new ExpectedCellValue(sheetName, 64, 12, 415.75),
					new ExpectedCellValue(sheetName, 65, 12, 415.75),
					new ExpectedCellValue(sheetName, 66, 12, 415.75),
					new ExpectedCellValue(sheetName, 67, 12, null),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, 415.75),
					new ExpectedCellValue(sheetName, 50, 13, null),
					new ExpectedCellValue(sheetName, 51, 13, 20100083),
					new ExpectedCellValue(sheetName, 52, 13, 24.99),
					new ExpectedCellValue(sheetName, 53, 13, null),
					new ExpectedCellValue(sheetName, 54, 13, null),
					new ExpectedCellValue(sheetName, 55, 13, 24.99),
					new ExpectedCellValue(sheetName, 56, 13, 24.99),
					new ExpectedCellValue(sheetName, 57, 13, null),
					new ExpectedCellValue(sheetName, 58, 13, null),
					new ExpectedCellValue(sheetName, 59, 13, null),
					new ExpectedCellValue(sheetName, 60, 13, null),
					new ExpectedCellValue(sheetName, 61, 13, null),
					new ExpectedCellValue(sheetName, 62, 13, null),
					new ExpectedCellValue(sheetName, 63, 13, null),
					new ExpectedCellValue(sheetName, 64, 13, null),
					new ExpectedCellValue(sheetName, 65, 13, null),
					new ExpectedCellValue(sheetName, 66, 13, null),
					new ExpectedCellValue(sheetName, 67, 13, null),
					new ExpectedCellValue(sheetName, 68, 13, null),
					new ExpectedCellValue(sheetName, 69, 13, 24.99),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, 20100085),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, null),
					new ExpectedCellValue(sheetName, 58, 14, null),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, null),
					new ExpectedCellValue(sheetName, 61, 14, null),
					new ExpectedCellValue(sheetName, 62, 14, null),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, 99d),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, 99d),
					new ExpectedCellValue(sheetName, 68, 14, 99d),
					new ExpectedCellValue(sheetName, 69, 14, 99d),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, 20100090),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 53, 15, null),
					new ExpectedCellValue(sheetName, 54, 15, null),
					new ExpectedCellValue(sheetName, 55, 15, null),
					new ExpectedCellValue(sheetName, 56, 15, null),
					new ExpectedCellValue(sheetName, 57, 15, 831.5),
					new ExpectedCellValue(sheetName, 58, 15, 831.5),
					new ExpectedCellValue(sheetName, 59, 15, 831.5),
					new ExpectedCellValue(sheetName, 60, 15, null),
					new ExpectedCellValue(sheetName, 61, 15, null),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, null),
					new ExpectedCellValue(sheetName, 64, 15, null),
					new ExpectedCellValue(sheetName, 65, 15, null),
					new ExpectedCellValue(sheetName, 66, 15, null),
					new ExpectedCellValue(sheetName, 67, 15, null),
					new ExpectedCellValue(sheetName, 68, 15, null),
					new ExpectedCellValue(sheetName, 69, 15, 831.5),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 52, 16, 856.49),
					new ExpectedCellValue(sheetName, 53, 16, 831.5),
					new ExpectedCellValue(sheetName, 54, 16, 831.5),
					new ExpectedCellValue(sheetName, 55, 16, 24.99),
					new ExpectedCellValue(sheetName, 56, 16, 24.99),
					new ExpectedCellValue(sheetName, 57, 16, 2857d),
					new ExpectedCellValue(sheetName, 58, 16, 831.5),
					new ExpectedCellValue(sheetName, 59, 16, 831.5),
					new ExpectedCellValue(sheetName, 60, 16, 1194d),
					new ExpectedCellValue(sheetName, 61, 16, 1194d),
					new ExpectedCellValue(sheetName, 62, 16, 831.5),
					new ExpectedCellValue(sheetName, 63, 16, 831.5),
					new ExpectedCellValue(sheetName, 64, 16, 514.75),
					new ExpectedCellValue(sheetName, 65, 16, 415.75),
					new ExpectedCellValue(sheetName, 66, 16, 415.75),
					new ExpectedCellValue(sheetName, 67, 16, 99d),
					new ExpectedCellValue(sheetName, 68, 16, 99d),
					new ExpectedCellValue(sheetName, 69, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledFourRowFieldsTabularFirstAndSecondFieldsOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:N32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 7, 20100007),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, "20100007 Total"),
					new ExpectedCellValue(sheetName, 8, 7, 20100017),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, "20100017 Total"),
					new ExpectedCellValue(sheetName, 12, 7, 20100070),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, "20100070 Total"),
					new ExpectedCellValue(sheetName, 16, 7, 20100076),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, "20100076 Total"),
					new ExpectedCellValue(sheetName, 20, 7, 20100083),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, "20100083 Total"),
					new ExpectedCellValue(sheetName, 24, 7, 20100085),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, "20100085 Total"),
					new ExpectedCellValue(sheetName, 28, 7, 20100090),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, "20100090 Total"),
					new ExpectedCellValue(sheetName, 32, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 8, null),
					new ExpectedCellValue(sheetName, 3, 8, "Location"),
					new ExpectedCellValue(sheetName, 4, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, null),
					new ExpectedCellValue(sheetName, 3, 9, "Month"),
					new ExpectedCellValue(sheetName, 4, 9, "January"),
					new ExpectedCellValue(sheetName, 5, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, "March"),
					new ExpectedCellValue(sheetName, 9, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, "February"),
					new ExpectedCellValue(sheetName, 13, 9, "Tent"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, "January"),
					new ExpectedCellValue(sheetName, 17, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, "March"),
					new ExpectedCellValue(sheetName, 21, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, "February"),
					new ExpectedCellValue(sheetName, 25, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, "January"),
					new ExpectedCellValue(sheetName, 29, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, "Column Labels"),
					new ExpectedCellValue(sheetName, 3, 10, 24.99),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, 24.99),
					new ExpectedCellValue(sheetName, 21, 10, 24.99),
					new ExpectedCellValue(sheetName, 22, 10, 24.99),
					new ExpectedCellValue(sheetName, 23, 10, 24.99),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, 24.99),
					new ExpectedCellValue(sheetName, 2, 11, null),
					new ExpectedCellValue(sheetName, 3, 11, 99d),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, null),
					new ExpectedCellValue(sheetName, 24, 11, 99d),
					new ExpectedCellValue(sheetName, 25, 11, 99d),
					new ExpectedCellValue(sheetName, 26, 11, 99d),
					new ExpectedCellValue(sheetName, 27, 11, 99d),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 32, 11, 99d),
					new ExpectedCellValue(sheetName, 2, 12, null),
					new ExpectedCellValue(sheetName, 3, 12, 199d),
					new ExpectedCellValue(sheetName, 4, 12, null),
					new ExpectedCellValue(sheetName, 5, 12, null),
					new ExpectedCellValue(sheetName, 6, 12, null),
					new ExpectedCellValue(sheetName, 7, 12, null),
					new ExpectedCellValue(sheetName, 8, 12, null),
					new ExpectedCellValue(sheetName, 9, 12, null),
					new ExpectedCellValue(sheetName, 10, 12, null),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, 1194d),
					new ExpectedCellValue(sheetName, 13, 12, 1194d),
					new ExpectedCellValue(sheetName, 14, 12, 1194d),
					new ExpectedCellValue(sheetName, 15, 12, 1194d),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, null),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, null),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, 1194d),
					new ExpectedCellValue(sheetName, 2, 13, null),
					new ExpectedCellValue(sheetName, 3, 13, 415.75),
					new ExpectedCellValue(sheetName, 4, 13, 831.5),
					new ExpectedCellValue(sheetName, 5, 13, 831.5),
					new ExpectedCellValue(sheetName, 6, 13, 831.5),
					new ExpectedCellValue(sheetName, 7, 13, 831.5),
					new ExpectedCellValue(sheetName, 8, 13, 831.5),
					new ExpectedCellValue(sheetName, 9, 13, 831.5),
					new ExpectedCellValue(sheetName, 10, 13, 831.5),
					new ExpectedCellValue(sheetName, 11, 13, 831.5),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, 415.75),
					new ExpectedCellValue(sheetName, 17, 13, 415.75),
					new ExpectedCellValue(sheetName, 18, 13, 415.75),
					new ExpectedCellValue(sheetName, 19, 13, 415.75),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, 831.5),
					new ExpectedCellValue(sheetName, 29, 13, 831.5),
					new ExpectedCellValue(sheetName, 30, 13, 831.5),
					new ExpectedCellValue(sheetName, 31, 13, 831.5),
					new ExpectedCellValue(sheetName, 32, 13, 2910.25),
					new ExpectedCellValue(sheetName, 2, 14, null),
					new ExpectedCellValue(sheetName, 3, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 14, 831.5),
					new ExpectedCellValue(sheetName, 5, 14, 831.5),
					new ExpectedCellValue(sheetName, 6, 14, 831.5),
					new ExpectedCellValue(sheetName, 7, 14, 831.5),
					new ExpectedCellValue(sheetName, 8, 14, 831.5),
					new ExpectedCellValue(sheetName, 9, 14, 831.5),
					new ExpectedCellValue(sheetName, 10, 14, 831.5),
					new ExpectedCellValue(sheetName, 11, 14, 831.5),
					new ExpectedCellValue(sheetName, 12, 14, 1194d),
					new ExpectedCellValue(sheetName, 13, 14, 1194d),
					new ExpectedCellValue(sheetName, 14, 14, 1194d),
					new ExpectedCellValue(sheetName, 15, 14, 1194d),
					new ExpectedCellValue(sheetName, 16, 14, 415.75),
					new ExpectedCellValue(sheetName, 17, 14, 415.75),
					new ExpectedCellValue(sheetName, 18, 14, 415.75),
					new ExpectedCellValue(sheetName, 19, 14, 415.75),
					new ExpectedCellValue(sheetName, 20, 14, 24.99),
					new ExpectedCellValue(sheetName, 21, 14, 24.99),
					new ExpectedCellValue(sheetName, 22, 14, 24.99),
					new ExpectedCellValue(sheetName, 23, 14, 24.99),
					new ExpectedCellValue(sheetName, 24, 14, 99d),
					new ExpectedCellValue(sheetName, 25, 14, 99d),
					new ExpectedCellValue(sheetName, 26, 14, 99d),
					new ExpectedCellValue(sheetName, 27, 14, 99d),
					new ExpectedCellValue(sheetName, 28, 14, 831.5),
					new ExpectedCellValue(sheetName, 29, 14, 831.5),
					new ExpectedCellValue(sheetName, 30, 14, 831.5),
					new ExpectedCellValue(sheetName, 31, 14, 831.5),
					new ExpectedCellValue(sheetName, 32, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledFourRowFieldsTabularFirstAndThirdFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A37:D66"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 37, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 38, 1, 20100007),
					new ExpectedCellValue(sheetName, 39, 1, null),
					new ExpectedCellValue(sheetName, 40, 1, null),
					new ExpectedCellValue(sheetName, 41, 1, "20100007 Total"),
					new ExpectedCellValue(sheetName, 42, 1, 20100017),
					new ExpectedCellValue(sheetName, 43, 1, null),
					new ExpectedCellValue(sheetName, 44, 1, null),
					new ExpectedCellValue(sheetName, 45, 1, "20100017 Total"),
					new ExpectedCellValue(sheetName, 46, 1, 20100070),
					new ExpectedCellValue(sheetName, 47, 1, null),
					new ExpectedCellValue(sheetName, 48, 1, null),
					new ExpectedCellValue(sheetName, 49, 1, "20100070 Total"),
					new ExpectedCellValue(sheetName, 50, 1, 20100076),
					new ExpectedCellValue(sheetName, 51, 1, null),
					new ExpectedCellValue(sheetName, 52, 1, null),
					new ExpectedCellValue(sheetName, 53, 1, "20100076 Total"),
					new ExpectedCellValue(sheetName, 54, 1, 20100083),
					new ExpectedCellValue(sheetName, 55, 1, null),
					new ExpectedCellValue(sheetName, 56, 1, null),
					new ExpectedCellValue(sheetName, 57, 1, "20100083 Total"),
					new ExpectedCellValue(sheetName, 58, 1, 20100085),
					new ExpectedCellValue(sheetName, 59, 1, null),
					new ExpectedCellValue(sheetName, 60, 1, null),
					new ExpectedCellValue(sheetName, 61, 1, "20100085 Total"),
					new ExpectedCellValue(sheetName, 62, 1, 20100090),
					new ExpectedCellValue(sheetName, 63, 1, null),
					new ExpectedCellValue(sheetName, 64, 1, null),
					new ExpectedCellValue(sheetName, 65, 1, "20100090 Total"),
					new ExpectedCellValue(sheetName, 66, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 37, 2, "Location"),
					new ExpectedCellValue(sheetName, 38, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 39, 2, "January"),
					new ExpectedCellValue(sheetName, 40, 2, "January Total"),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 43, 2, "March"),
					new ExpectedCellValue(sheetName, 44, 2, "March Total"),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 2, "February"),
					new ExpectedCellValue(sheetName, 48, 2, "February Total"),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 51, 2, "January"),
					new ExpectedCellValue(sheetName, 52, 2, "January Total"),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 55, 2, "March"),
					new ExpectedCellValue(sheetName, 56, 2, "March Total"),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 59, 2, "February"),
					new ExpectedCellValue(sheetName, 60, 2, "February Total"),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 63, 2, "January"),
					new ExpectedCellValue(sheetName, 64, 2, "January Total"),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 37, 3, "Item"),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, "Tent"),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 37, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 4, 831.5),
					new ExpectedCellValue(sheetName, 39, 4, 831.5),
					new ExpectedCellValue(sheetName, 40, 4, 831.5),
					new ExpectedCellValue(sheetName, 41, 4, 831.5),
					new ExpectedCellValue(sheetName, 42, 4, 831.5),
					new ExpectedCellValue(sheetName, 43, 4, 831.5),
					new ExpectedCellValue(sheetName, 44, 4, 831.5),
					new ExpectedCellValue(sheetName, 45, 4, 831.5),
					new ExpectedCellValue(sheetName, 46, 4, 1194d),
					new ExpectedCellValue(sheetName, 47, 4, 1194d),
					new ExpectedCellValue(sheetName, 48, 4, 1194d),
					new ExpectedCellValue(sheetName, 49, 4, 1194d),
					new ExpectedCellValue(sheetName, 50, 4, 415.75),
					new ExpectedCellValue(sheetName, 51, 4, 415.75),
					new ExpectedCellValue(sheetName, 52, 4, 415.75),
					new ExpectedCellValue(sheetName, 53, 4, 415.75),
					new ExpectedCellValue(sheetName, 54, 4, 24.99),
					new ExpectedCellValue(sheetName, 55, 4, 24.99),
					new ExpectedCellValue(sheetName, 56, 4, 24.99),
					new ExpectedCellValue(sheetName, 57, 4, 24.99),
					new ExpectedCellValue(sheetName, 58, 4, 99d),
					new ExpectedCellValue(sheetName, 59, 4, 99d),
					new ExpectedCellValue(sheetName, 60, 4, 99d),
					new ExpectedCellValue(sheetName, 61, 4, 99d),
					new ExpectedCellValue(sheetName, 62, 4, 831.5),
					new ExpectedCellValue(sheetName, 63, 4, 831.5),
					new ExpectedCellValue(sheetName, 64, 4, 831.5),
					new ExpectedCellValue(sheetName, 65, 4, 831.5),
					new ExpectedCellValue(sheetName, 66, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledFourRowFieldsTabularFirstAndThirdFieldsOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G37:M67"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 37, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 39, 7, 20100007),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, "20100007 Total"),
					new ExpectedCellValue(sheetName, 43, 7, 20100017),
					new ExpectedCellValue(sheetName, 44, 7, null),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, "20100017 Total"),
					new ExpectedCellValue(sheetName, 47, 7, 20100070),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, "20100070 Total"),
					new ExpectedCellValue(sheetName, 51, 7, 20100076),
					new ExpectedCellValue(sheetName, 52, 7, null),
					new ExpectedCellValue(sheetName, 53, 7, null),
					new ExpectedCellValue(sheetName, 54, 7, "20100076 Total"),
					new ExpectedCellValue(sheetName, 55, 7, 20100083),
					new ExpectedCellValue(sheetName, 56, 7, null),
					new ExpectedCellValue(sheetName, 57, 7, null),
					new ExpectedCellValue(sheetName, 58, 7, "20100083 Total"),
					new ExpectedCellValue(sheetName, 59, 7, 20100085),
					new ExpectedCellValue(sheetName, 60, 7, null),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, "20100085 Total"),
					new ExpectedCellValue(sheetName, 63, 7, 20100090),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, "20100090 Total"),
					new ExpectedCellValue(sheetName, 67, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, "Location"),
					new ExpectedCellValue(sheetName, 39, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 40, 8, "January"),
					new ExpectedCellValue(sheetName, 41, 8, "January Total"),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 44, 8, "March"),
					new ExpectedCellValue(sheetName, 45, 8, "March Total"),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 48, 8, "February"),
					new ExpectedCellValue(sheetName, 49, 8, "February Total"),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 52, 8, "January"),
					new ExpectedCellValue(sheetName, 53, 8, "January Total"),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 56, 8, "March"),
					new ExpectedCellValue(sheetName, 57, 8, "March Total"),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 60, 8, "February"),
					new ExpectedCellValue(sheetName, 61, 8, "February Total"),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 64, 8, "January"),
					new ExpectedCellValue(sheetName, 65, 8, "January Total"),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, "Item"),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, "Tent"),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 37, 10, "Column Labels"),
					new ExpectedCellValue(sheetName, 38, 10, 1d),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, 415.75),
					new ExpectedCellValue(sheetName, 52, 10, 415.75),
					new ExpectedCellValue(sheetName, 53, 10, 415.75),
					new ExpectedCellValue(sheetName, 54, 10, 415.75),
					new ExpectedCellValue(sheetName, 55, 10, 24.99),
					new ExpectedCellValue(sheetName, 56, 10, 24.99),
					new ExpectedCellValue(sheetName, 57, 10, 24.99),
					new ExpectedCellValue(sheetName, 58, 10, 24.99),
					new ExpectedCellValue(sheetName, 59, 10, 99d),
					new ExpectedCellValue(sheetName, 60, 10, 99d),
					new ExpectedCellValue(sheetName, 61, 10, 99d),
					new ExpectedCellValue(sheetName, 62, 10, 99d),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 66, 10, null),
					new ExpectedCellValue(sheetName, 67, 10, 539.74),
					new ExpectedCellValue(sheetName, 37, 11, null),
					new ExpectedCellValue(sheetName, 38, 11, 2d),
					new ExpectedCellValue(sheetName, 39, 11, 831.5),
					new ExpectedCellValue(sheetName, 40, 11, 831.5),
					new ExpectedCellValue(sheetName, 41, 11, 831.5),
					new ExpectedCellValue(sheetName, 42, 11, 831.5),
					new ExpectedCellValue(sheetName, 43, 11, 831.5),
					new ExpectedCellValue(sheetName, 44, 11, 831.5),
					new ExpectedCellValue(sheetName, 45, 11, 831.5),
					new ExpectedCellValue(sheetName, 46, 11, 831.5),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, null),
					new ExpectedCellValue(sheetName, 49, 11, null),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 54, 11, null),
					new ExpectedCellValue(sheetName, 55, 11, null),
					new ExpectedCellValue(sheetName, 56, 11, null),
					new ExpectedCellValue(sheetName, 57, 11, null),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, null),
					new ExpectedCellValue(sheetName, 60, 11, null),
					new ExpectedCellValue(sheetName, 61, 11, null),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, 831.5),
					new ExpectedCellValue(sheetName, 64, 11, 831.5),
					new ExpectedCellValue(sheetName, 65, 11, 831.5),
					new ExpectedCellValue(sheetName, 66, 11, 831.5),
					new ExpectedCellValue(sheetName, 67, 11, 2494.5),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, 6d),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, null),
					new ExpectedCellValue(sheetName, 42, 12, null),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, null),
					new ExpectedCellValue(sheetName, 47, 12, 1194d),
					new ExpectedCellValue(sheetName, 48, 12, 1194d),
					new ExpectedCellValue(sheetName, 49, 12, 1194d),
					new ExpectedCellValue(sheetName, 50, 12, 1194d),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, null),
					new ExpectedCellValue(sheetName, 53, 12, null),
					new ExpectedCellValue(sheetName, 54, 12, null),
					new ExpectedCellValue(sheetName, 55, 12, null),
					new ExpectedCellValue(sheetName, 56, 12, null),
					new ExpectedCellValue(sheetName, 57, 12, null),
					new ExpectedCellValue(sheetName, 58, 12, null),
					new ExpectedCellValue(sheetName, 59, 12, null),
					new ExpectedCellValue(sheetName, 60, 12, null),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, null),
					new ExpectedCellValue(sheetName, 63, 12, null),
					new ExpectedCellValue(sheetName, 64, 12, null),
					new ExpectedCellValue(sheetName, 65, 12, null),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, 1194d),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 39, 13, 831.5),
					new ExpectedCellValue(sheetName, 40, 13, 831.5),
					new ExpectedCellValue(sheetName, 41, 13, 831.5),
					new ExpectedCellValue(sheetName, 42, 13, 831.5),
					new ExpectedCellValue(sheetName, 43, 13, 831.5),
					new ExpectedCellValue(sheetName, 44, 13, 831.5),
					new ExpectedCellValue(sheetName, 45, 13, 831.5),
					new ExpectedCellValue(sheetName, 46, 13, 831.5),
					new ExpectedCellValue(sheetName, 47, 13, 1194d),
					new ExpectedCellValue(sheetName, 48, 13, 1194d),
					new ExpectedCellValue(sheetName, 49, 13, 1194d),
					new ExpectedCellValue(sheetName, 50, 13, 1194d),
					new ExpectedCellValue(sheetName, 51, 13, 415.75),
					new ExpectedCellValue(sheetName, 52, 13, 415.75),
					new ExpectedCellValue(sheetName, 53, 13, 415.75),
					new ExpectedCellValue(sheetName, 54, 13, 415.75),
					new ExpectedCellValue(sheetName, 55, 13, 24.99),
					new ExpectedCellValue(sheetName, 56, 13, 24.99),
					new ExpectedCellValue(sheetName, 57, 13, 24.99),
					new ExpectedCellValue(sheetName, 58, 13, 24.99),
					new ExpectedCellValue(sheetName, 59, 13, 99d),
					new ExpectedCellValue(sheetName, 60, 13, 99d),
					new ExpectedCellValue(sheetName, 61, 13, 99d),
					new ExpectedCellValue(sheetName, 62, 13, 99d),
					new ExpectedCellValue(sheetName, 63, 13, 831.5),
					new ExpectedCellValue(sheetName, 64, 13, 831.5),
					new ExpectedCellValue(sheetName, 65, 13, 831.5),
					new ExpectedCellValue(sheetName, 66, 13, 831.5),
					new ExpectedCellValue(sheetName, 67, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledFourRowFieldsTabularSecondAndThirdFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A71:D100"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 71, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 72, 1, 20100007),
					new ExpectedCellValue(sheetName, 73, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 74, 1, null),
					new ExpectedCellValue(sheetName, 75, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 76, 1, 20100017),
					new ExpectedCellValue(sheetName, 77, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 78, 1, null),
					new ExpectedCellValue(sheetName, 79, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 80, 1, 20100070),
					new ExpectedCellValue(sheetName, 81, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 82, 1, null),
					new ExpectedCellValue(sheetName, 83, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 84, 1, 20100076),
					new ExpectedCellValue(sheetName, 85, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 86, 1, null),
					new ExpectedCellValue(sheetName, 87, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 1, 20100083),
					new ExpectedCellValue(sheetName, 89, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 90, 1, null),
					new ExpectedCellValue(sheetName, 91, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 92, 1, 20100085),
					new ExpectedCellValue(sheetName, 93, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 94, 1, null),
					new ExpectedCellValue(sheetName, 95, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 96, 1, 20100090),
					new ExpectedCellValue(sheetName, 97, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 98, 1, null),
					new ExpectedCellValue(sheetName, 99, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 100, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 71, 2, "Month"),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, "January"),
					new ExpectedCellValue(sheetName, 74, 2, "January Total"),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, "March"),
					new ExpectedCellValue(sheetName, 78, 2, "March Total"),
					new ExpectedCellValue(sheetName, 79, 2, null),
					new ExpectedCellValue(sheetName, 80, 2, null),
					new ExpectedCellValue(sheetName, 81, 2, "February"),
					new ExpectedCellValue(sheetName, 82, 2, "February Total"),
					new ExpectedCellValue(sheetName, 83, 2, null),
					new ExpectedCellValue(sheetName, 84, 2, null),
					new ExpectedCellValue(sheetName, 85, 2, "January"),
					new ExpectedCellValue(sheetName, 86, 2, "January Total"),
					new ExpectedCellValue(sheetName, 87, 2, null),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, "March"),
					new ExpectedCellValue(sheetName, 90, 2, "March Total"),
					new ExpectedCellValue(sheetName, 91, 2, null),
					new ExpectedCellValue(sheetName, 92, 2, null),
					new ExpectedCellValue(sheetName, 93, 2, "February"),
					new ExpectedCellValue(sheetName, 94, 2, "February Total"),
					new ExpectedCellValue(sheetName, 95, 2, null),
					new ExpectedCellValue(sheetName, 96, 2, null),
					new ExpectedCellValue(sheetName, 97, 2, "January"),
					new ExpectedCellValue(sheetName, 98, 2, "January Total"),
					new ExpectedCellValue(sheetName, 99, 2, null),
					new ExpectedCellValue(sheetName, 100, 2, null),
					new ExpectedCellValue(sheetName, 71, 3, "Item"),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, "Tent"),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, null),
					new ExpectedCellValue(sheetName, 85, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 3, null),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, null),
					new ExpectedCellValue(sheetName, 89, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 90, 3, null),
					new ExpectedCellValue(sheetName, 91, 3, null),
					new ExpectedCellValue(sheetName, 92, 3, null),
					new ExpectedCellValue(sheetName, 93, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 94, 3, null),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null),
					new ExpectedCellValue(sheetName, 97, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 98, 3, null),
					new ExpectedCellValue(sheetName, 99, 3, null),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 71, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 4, 831.5),
					new ExpectedCellValue(sheetName, 73, 4, 831.5),
					new ExpectedCellValue(sheetName, 74, 4, 831.5),
					new ExpectedCellValue(sheetName, 75, 4, 831.5),
					new ExpectedCellValue(sheetName, 76, 4, 831.5),
					new ExpectedCellValue(sheetName, 77, 4, 831.5),
					new ExpectedCellValue(sheetName, 78, 4, 831.5),
					new ExpectedCellValue(sheetName, 79, 4, 831.5),
					new ExpectedCellValue(sheetName, 80, 4, 1194d),
					new ExpectedCellValue(sheetName, 81, 4, 1194d),
					new ExpectedCellValue(sheetName, 82, 4, 1194d),
					new ExpectedCellValue(sheetName, 83, 4, 1194d),
					new ExpectedCellValue(sheetName, 84, 4, 415.75),
					new ExpectedCellValue(sheetName, 85, 4, 415.75),
					new ExpectedCellValue(sheetName, 86, 4, 415.75),
					new ExpectedCellValue(sheetName, 87, 4, 415.75),
					new ExpectedCellValue(sheetName, 88, 4, 24.99),
					new ExpectedCellValue(sheetName, 89, 4, 24.99),
					new ExpectedCellValue(sheetName, 90, 4, 24.99),
					new ExpectedCellValue(sheetName, 91, 4, 24.99),
					new ExpectedCellValue(sheetName, 92, 4, 99d),
					new ExpectedCellValue(sheetName, 93, 4, 99d),
					new ExpectedCellValue(sheetName, 94, 4, 99d),
					new ExpectedCellValue(sheetName, 95, 4, 99d),
					new ExpectedCellValue(sheetName, 96, 4, 831.5),
					new ExpectedCellValue(sheetName, 97, 4, 831.5),
					new ExpectedCellValue(sheetName, 98, 4, 831.5),
					new ExpectedCellValue(sheetName, 99, 4, 831.5),
					new ExpectedCellValue(sheetName, 100, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsEnabled.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledFourRowFieldsTabularSecondAndThirdFieldsOneColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsEnabled.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourTabularFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G71:M101"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 71, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 73, 7, 20100007),
					new ExpectedCellValue(sheetName, 74, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 75, 7, null),
					new ExpectedCellValue(sheetName, 76, 7, "Chicago Total"),
					new ExpectedCellValue(sheetName, 77, 7, 20100017),
					new ExpectedCellValue(sheetName, 78, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 7, null),
					new ExpectedCellValue(sheetName, 80, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 81, 7, 20100070),
					new ExpectedCellValue(sheetName, 82, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 83, 7, null),
					new ExpectedCellValue(sheetName, 84, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 85, 7, 20100076),
					new ExpectedCellValue(sheetName, 86, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 87, 7, null),
					new ExpectedCellValue(sheetName, 88, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 89, 7, 20100083),
					new ExpectedCellValue(sheetName, 90, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 91, 7, null),
					new ExpectedCellValue(sheetName, 92, 7, "Chicago Total"),
					new ExpectedCellValue(sheetName, 93, 7, 20100085),
					new ExpectedCellValue(sheetName, 94, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 95, 7, null),
					new ExpectedCellValue(sheetName, 96, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 97, 7, 20100090),
					new ExpectedCellValue(sheetName, 98, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 99, 7, null),
					new ExpectedCellValue(sheetName, 100, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 101, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 71, 8, null),
					new ExpectedCellValue(sheetName, 72, 8, "Month"),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, "January"),
					new ExpectedCellValue(sheetName, 75, 8, "January Total"),
					new ExpectedCellValue(sheetName, 76, 8, null),
					new ExpectedCellValue(sheetName, 77, 8, null),
					new ExpectedCellValue(sheetName, 78, 8, "March"),
					new ExpectedCellValue(sheetName, 79, 8, "March Total"),
					new ExpectedCellValue(sheetName, 80, 8, null),
					new ExpectedCellValue(sheetName, 81, 8, null),
					new ExpectedCellValue(sheetName, 82, 8, "February"),
					new ExpectedCellValue(sheetName, 83, 8, "February Total"),
					new ExpectedCellValue(sheetName, 84, 8, null),
					new ExpectedCellValue(sheetName, 85, 8, null),
					new ExpectedCellValue(sheetName, 86, 8, "January"),
					new ExpectedCellValue(sheetName, 87, 8, "January Total"),
					new ExpectedCellValue(sheetName, 88, 8, null),
					new ExpectedCellValue(sheetName, 89, 8, null),
					new ExpectedCellValue(sheetName, 90, 8, "March"),
					new ExpectedCellValue(sheetName, 91, 8, "March Total"),
					new ExpectedCellValue(sheetName, 92, 8, null),
					new ExpectedCellValue(sheetName, 93, 8, null),
					new ExpectedCellValue(sheetName, 94, 8, "February"),
					new ExpectedCellValue(sheetName, 95, 8, "February Total"),
					new ExpectedCellValue(sheetName, 96, 8, null),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, "January"),
					new ExpectedCellValue(sheetName, 99, 8, "January Total"),
					new ExpectedCellValue(sheetName, 100, 8, null),
					new ExpectedCellValue(sheetName, 101, 8, null),
					new ExpectedCellValue(sheetName, 71, 9, null),
					new ExpectedCellValue(sheetName, 72, 9, "Item"),
					new ExpectedCellValue(sheetName, 73, 9, null),
					new ExpectedCellValue(sheetName, 74, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 75, 9, null),
					new ExpectedCellValue(sheetName, 76, 9, null),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 80, 9, null),
					new ExpectedCellValue(sheetName, 81, 9, null),
					new ExpectedCellValue(sheetName, 82, 9, "Tent"),
					new ExpectedCellValue(sheetName, 83, 9, null),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, null),
					new ExpectedCellValue(sheetName, 86, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 87, 9, null),
					new ExpectedCellValue(sheetName, 88, 9, null),
					new ExpectedCellValue(sheetName, 89, 9, null),
					new ExpectedCellValue(sheetName, 90, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, null),
					new ExpectedCellValue(sheetName, 93, 9, null),
					new ExpectedCellValue(sheetName, 94, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 95, 9, null),
					new ExpectedCellValue(sheetName, 96, 9, null),
					new ExpectedCellValue(sheetName, 97, 9, null),
					new ExpectedCellValue(sheetName, 98, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, null),
					new ExpectedCellValue(sheetName, 101, 9, null),
					new ExpectedCellValue(sheetName, 71, 10, "Column Labels"),
					new ExpectedCellValue(sheetName, 72, 10, 1d),
					new ExpectedCellValue(sheetName, 73, 10, null),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, null),
					new ExpectedCellValue(sheetName, 78, 10, null),
					new ExpectedCellValue(sheetName, 79, 10, null),
					new ExpectedCellValue(sheetName, 80, 10, null),
					new ExpectedCellValue(sheetName, 81, 10, null),
					new ExpectedCellValue(sheetName, 82, 10, null),
					new ExpectedCellValue(sheetName, 83, 10, null),
					new ExpectedCellValue(sheetName, 84, 10, null),
					new ExpectedCellValue(sheetName, 85, 10, 415.75),
					new ExpectedCellValue(sheetName, 86, 10, 415.75),
					new ExpectedCellValue(sheetName, 87, 10, 415.75),
					new ExpectedCellValue(sheetName, 88, 10, 415.75),
					new ExpectedCellValue(sheetName, 89, 10, 24.99),
					new ExpectedCellValue(sheetName, 90, 10, 24.99),
					new ExpectedCellValue(sheetName, 91, 10, 24.99),
					new ExpectedCellValue(sheetName, 92, 10, 24.99),
					new ExpectedCellValue(sheetName, 93, 10, 99d),
					new ExpectedCellValue(sheetName, 94, 10, 99d),
					new ExpectedCellValue(sheetName, 95, 10, 99d),
					new ExpectedCellValue(sheetName, 96, 10, 99d),
					new ExpectedCellValue(sheetName, 97, 10, null),
					new ExpectedCellValue(sheetName, 98, 10, null),
					new ExpectedCellValue(sheetName, 99, 10, null),
					new ExpectedCellValue(sheetName, 100, 10, null),
					new ExpectedCellValue(sheetName, 101, 10, 539.74),
					new ExpectedCellValue(sheetName, 71, 11, null),
					new ExpectedCellValue(sheetName, 72, 11, 2d),
					new ExpectedCellValue(sheetName, 73, 11, 831.5),
					new ExpectedCellValue(sheetName, 74, 11, 831.5),
					new ExpectedCellValue(sheetName, 75, 11, 831.5),
					new ExpectedCellValue(sheetName, 76, 11, 831.5),
					new ExpectedCellValue(sheetName, 77, 11, 831.5),
					new ExpectedCellValue(sheetName, 78, 11, 831.5),
					new ExpectedCellValue(sheetName, 79, 11, 831.5),
					new ExpectedCellValue(sheetName, 80, 11, 831.5),
					new ExpectedCellValue(sheetName, 81, 11, null),
					new ExpectedCellValue(sheetName, 82, 11, null),
					new ExpectedCellValue(sheetName, 83, 11, null),
					new ExpectedCellValue(sheetName, 84, 11, null),
					new ExpectedCellValue(sheetName, 85, 11, null),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, null),
					new ExpectedCellValue(sheetName, 88, 11, null),
					new ExpectedCellValue(sheetName, 89, 11, null),
					new ExpectedCellValue(sheetName, 90, 11, null),
					new ExpectedCellValue(sheetName, 91, 11, null),
					new ExpectedCellValue(sheetName, 92, 11, null),
					new ExpectedCellValue(sheetName, 93, 11, null),
					new ExpectedCellValue(sheetName, 94, 11, null),
					new ExpectedCellValue(sheetName, 95, 11, null),
					new ExpectedCellValue(sheetName, 96, 11, null),
					new ExpectedCellValue(sheetName, 97, 11, 831.5),
					new ExpectedCellValue(sheetName, 98, 11, 831.5),
					new ExpectedCellValue(sheetName, 99, 11, 831.5),
					new ExpectedCellValue(sheetName, 100, 11, 831.5),
					new ExpectedCellValue(sheetName, 101, 11, 2494.5),
					new ExpectedCellValue(sheetName, 71, 12, null),
					new ExpectedCellValue(sheetName, 72, 12, 6d),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, null),
					new ExpectedCellValue(sheetName, 77, 12, null),
					new ExpectedCellValue(sheetName, 78, 12, null),
					new ExpectedCellValue(sheetName, 79, 12, null),
					new ExpectedCellValue(sheetName, 80, 12, null),
					new ExpectedCellValue(sheetName, 81, 12, 1194d),
					new ExpectedCellValue(sheetName, 82, 12, 1194d),
					new ExpectedCellValue(sheetName, 83, 12, 1194d),
					new ExpectedCellValue(sheetName, 84, 12, 1194d),
					new ExpectedCellValue(sheetName, 85, 12, null),
					new ExpectedCellValue(sheetName, 86, 12, null),
					new ExpectedCellValue(sheetName, 87, 12, null),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 90, 12, null),
					new ExpectedCellValue(sheetName, 91, 12, null),
					new ExpectedCellValue(sheetName, 92, 12, null),
					new ExpectedCellValue(sheetName, 93, 12, null),
					new ExpectedCellValue(sheetName, 94, 12, null),
					new ExpectedCellValue(sheetName, 95, 12, null),
					new ExpectedCellValue(sheetName, 96, 12, null),
					new ExpectedCellValue(sheetName, 97, 12, null),
					new ExpectedCellValue(sheetName, 98, 12, null),
					new ExpectedCellValue(sheetName, 99, 12, null),
					new ExpectedCellValue(sheetName, 100, 12, null),
					new ExpectedCellValue(sheetName, 101, 12, 1194d),
					new ExpectedCellValue(sheetName, 71, 13, null),
					new ExpectedCellValue(sheetName, 72, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 73, 13, 831.5),
					new ExpectedCellValue(sheetName, 74, 13, 831.5),
					new ExpectedCellValue(sheetName, 75, 13, 831.5),
					new ExpectedCellValue(sheetName, 76, 13, 831.5),
					new ExpectedCellValue(sheetName, 77, 13, 831.5),
					new ExpectedCellValue(sheetName, 78, 13, 831.5),
					new ExpectedCellValue(sheetName, 79, 13, 831.5),
					new ExpectedCellValue(sheetName, 80, 13, 831.5),
					new ExpectedCellValue(sheetName, 81, 13, 1194d),
					new ExpectedCellValue(sheetName, 82, 13, 1194d),
					new ExpectedCellValue(sheetName, 83, 13, 1194d),
					new ExpectedCellValue(sheetName, 84, 13, 1194d),
					new ExpectedCellValue(sheetName, 85, 13, 415.75),
					new ExpectedCellValue(sheetName, 86, 13, 415.75),
					new ExpectedCellValue(sheetName, 87, 13, 415.75),
					new ExpectedCellValue(sheetName, 88, 13, 415.75),
					new ExpectedCellValue(sheetName, 89, 13, 24.99),
					new ExpectedCellValue(sheetName, 90, 13, 24.99),
					new ExpectedCellValue(sheetName, 91, 13, 24.99),
					new ExpectedCellValue(sheetName, 92, 13, 24.99),
					new ExpectedCellValue(sheetName, 93, 13, 99d),
					new ExpectedCellValue(sheetName, 94, 13, 99d),
					new ExpectedCellValue(sheetName, 95, 13, 99d),
					new ExpectedCellValue(sheetName, 96, 13, 99d),
					new ExpectedCellValue(sheetName, 97, 13, 831.5),
					new ExpectedCellValue(sheetName, 98, 13, 831.5),
					new ExpectedCellValue(sheetName, 99, 13, 831.5),
					new ExpectedCellValue(sheetName, 100, 13, 831.5),
					new ExpectedCellValue(sheetName, 101, 13, 4228.24)
				});
			}
		}
		#endregion

		#region Tabular Pivot Tables With Multiple Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsOneRowFieldOneTabularFieldNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "OneRowField";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:D10"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Values"),
					new ExpectedCellValue(sheetName, 3, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, null),
					new ExpectedCellValue(sheetName, 3, 4, 3d),
					new ExpectedCellValue(sheetName, 4, 4, 856.49),
					new ExpectedCellValue(sheetName, 5, 4, 10d),
					new ExpectedCellValue(sheetName, 6, 4, 2857d),
					new ExpectedCellValue(sheetName, 7, 4, 2d),
					new ExpectedCellValue(sheetName, 8, 4, 514.75),
					new ExpectedCellValue(sheetName, 9, 4, 15d),
					new ExpectedCellValue(sheetName, 10, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsOneRowFieldOneTabularFieldOneColumnField()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "OneRowField";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:L11"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, null),
					new ExpectedCellValue(sheetName, 3, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 4, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 8, null),
					new ExpectedCellValue(sheetName, 3, 8, "Values"),
					new ExpectedCellValue(sheetName, 4, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Column Labels"),
					new ExpectedCellValue(sheetName, 3, 9, "January"),
					new ExpectedCellValue(sheetName, 4, 9, 2d),
					new ExpectedCellValue(sheetName, 5, 9, 831.5),
					new ExpectedCellValue(sheetName, 6, 9, 2d),
					new ExpectedCellValue(sheetName, 7, 9, 831.5),
					new ExpectedCellValue(sheetName, 8, 9, 1d),
					new ExpectedCellValue(sheetName, 9, 9, 415.75),
					new ExpectedCellValue(sheetName, 10, 9, 5d),
					new ExpectedCellValue(sheetName, 11, 9, 2078.75),
					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, "February"),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, 6d),
					new ExpectedCellValue(sheetName, 7, 10, 1194d),
					new ExpectedCellValue(sheetName, 8, 10, 1d),
					new ExpectedCellValue(sheetName, 9, 10, 99d),
					new ExpectedCellValue(sheetName, 10, 10, 7d),
					new ExpectedCellValue(sheetName, 11, 10, 1293d),
					new ExpectedCellValue(sheetName, 2, 11, null),
					new ExpectedCellValue(sheetName, 3, 11, "March"),
					new ExpectedCellValue(sheetName, 4, 11, 1d),
					new ExpectedCellValue(sheetName, 5, 11, 24.99),
					new ExpectedCellValue(sheetName, 6, 11, 2d),
					new ExpectedCellValue(sheetName, 7, 11, 831.5),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, 3d),
					new ExpectedCellValue(sheetName, 11, 11, 856.49),
					new ExpectedCellValue(sheetName, 2, 12, null),
					new ExpectedCellValue(sheetName, 3, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 12, 3d),
					new ExpectedCellValue(sheetName, 5, 12, 856.49),
					new ExpectedCellValue(sheetName, 6, 12, 10d),
					new ExpectedCellValue(sheetName, 7, 12, 2857d),
					new ExpectedCellValue(sheetName, 8, 12, 2d),
					new ExpectedCellValue(sheetName, 9, 12, 514.75),
					new ExpectedCellValue(sheetName, 10, 12, 15d),
					new ExpectedCellValue(sheetName, 11, 12, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsTwoRowFieldsBothTabularLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:E24"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 2, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "March"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, "January"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, "February"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, "March"),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "January"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "February"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Values"),
					new ExpectedCellValue(sheetName, 3, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, null),
					new ExpectedCellValue(sheetName, 3, 5, 2d),
					new ExpectedCellValue(sheetName, 4, 5, 831.5),
					new ExpectedCellValue(sheetName, 5, 5, 1d),
					new ExpectedCellValue(sheetName, 6, 5, 24.99),
					new ExpectedCellValue(sheetName, 7, 5, 3d),
					new ExpectedCellValue(sheetName, 8, 5, 856.49),
					new ExpectedCellValue(sheetName, 9, 5, 2d),
					new ExpectedCellValue(sheetName, 10, 5, 831.5),
					new ExpectedCellValue(sheetName, 11, 5, 6d),
					new ExpectedCellValue(sheetName, 12, 5, 1194d),
					new ExpectedCellValue(sheetName, 13, 5, 2d),
					new ExpectedCellValue(sheetName, 14, 5, 831.5),
					new ExpectedCellValue(sheetName, 15, 5, 10d),
					new ExpectedCellValue(sheetName, 16, 5, 2857d),
					new ExpectedCellValue(sheetName, 17, 5, 1d),
					new ExpectedCellValue(sheetName, 18, 5, 415.75),
					new ExpectedCellValue(sheetName, 19, 5, 1d),
					new ExpectedCellValue(sheetName, 20, 5, 99d),
					new ExpectedCellValue(sheetName, 21, 5, 2d),
					new ExpectedCellValue(sheetName, 22, 5, 514.75),
					new ExpectedCellValue(sheetName, 23, 5, 15d),
					new ExpectedCellValue(sheetName, 24, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsTwoRowFieldsBothTabularInnerDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H2:J30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 8, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 8, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 8, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 8, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 9, "Values"),
					new ExpectedCellValue(sheetName, 3, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 9, "January"),
					new ExpectedCellValue(sheetName, 5, 9, "March"),
					new ExpectedCellValue(sheetName, 6, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 9, "January"),
					new ExpectedCellValue(sheetName, 8, 9, "March"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 9, "January"),
					new ExpectedCellValue(sheetName, 13, 9, "February"),
					new ExpectedCellValue(sheetName, 14, 9, "March"),
					new ExpectedCellValue(sheetName, 15, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 9, "January"),
					new ExpectedCellValue(sheetName, 17, 9, "February"),
					new ExpectedCellValue(sheetName, 18, 9, "March"),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 9, "January"),
					new ExpectedCellValue(sheetName, 23, 9, "February"),
					new ExpectedCellValue(sheetName, 24, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 9, "January"),
					new ExpectedCellValue(sheetName, 26, 9, "February"),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, 2d),
					new ExpectedCellValue(sheetName, 5, 10, 1d),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, 831.5),
					new ExpectedCellValue(sheetName, 8, 10, 24.99),
					new ExpectedCellValue(sheetName, 9, 10, 3d),
					new ExpectedCellValue(sheetName, 10, 10, 856.49),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, 2d),
					new ExpectedCellValue(sheetName, 13, 10, 6d),
					new ExpectedCellValue(sheetName, 14, 10, 2d),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, 831.5),
					new ExpectedCellValue(sheetName, 17, 10, 1194d),
					new ExpectedCellValue(sheetName, 18, 10, 831.5),
					new ExpectedCellValue(sheetName, 19, 10, 10d),
					new ExpectedCellValue(sheetName, 20, 10, 2857d),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, 1d),
					new ExpectedCellValue(sheetName, 23, 10, 1d),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, 415.75),
					new ExpectedCellValue(sheetName, 26, 10, 99d),
					new ExpectedCellValue(sheetName, 27, 10, 2d),
					new ExpectedCellValue(sheetName, 28, 10, 514.75),
					new ExpectedCellValue(sheetName, 29, 10, 15d),
					new ExpectedCellValue(sheetName, 30, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsTwoRowFieldsBothTabularFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M2:O26"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 13, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 13, null),
					new ExpectedCellValue(sheetName, 6, 13, "Chicago Total"),
					new ExpectedCellValue(sheetName, 7, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, null),
					new ExpectedCellValue(sheetName, 10, 13, "Nashville Total"),
					new ExpectedCellValue(sheetName, 11, 13, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 14, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 13, "Chicago"),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, "Chicago Total"),
					new ExpectedCellValue(sheetName, 18, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 13, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 25, 13, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 26, 13, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 14, "Month"),
					new ExpectedCellValue(sheetName, 3, 14, null),
					new ExpectedCellValue(sheetName, 4, 14, "January"),
					new ExpectedCellValue(sheetName, 5, 14, "March"),
					new ExpectedCellValue(sheetName, 6, 14, null),
					new ExpectedCellValue(sheetName, 7, 14, "January"),
					new ExpectedCellValue(sheetName, 8, 14, "February"),
					new ExpectedCellValue(sheetName, 9, 14, "March"),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, "January"),
					new ExpectedCellValue(sheetName, 12, 14, "February"),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, "January"),
					new ExpectedCellValue(sheetName, 16, 14, "March"),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, "January"),
					new ExpectedCellValue(sheetName, 19, 14, "February"),
					new ExpectedCellValue(sheetName, 20, 14, "March"),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, "January"),
					new ExpectedCellValue(sheetName, 23, 14, "February"),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 2, 15, null),
					new ExpectedCellValue(sheetName, 3, 15, null),
					new ExpectedCellValue(sheetName, 4, 15, 2d),
					new ExpectedCellValue(sheetName, 5, 15, 1d),
					new ExpectedCellValue(sheetName, 6, 15, 3d),
					new ExpectedCellValue(sheetName, 7, 15, 2d),
					new ExpectedCellValue(sheetName, 8, 15, 6d),
					new ExpectedCellValue(sheetName, 9, 15, 2d),
					new ExpectedCellValue(sheetName, 10, 15, 10d),
					new ExpectedCellValue(sheetName, 11, 15, 1d),
					new ExpectedCellValue(sheetName, 12, 15, 1d),
					new ExpectedCellValue(sheetName, 13, 15, 2d),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, 831.5),
					new ExpectedCellValue(sheetName, 16, 15, 24.99),
					new ExpectedCellValue(sheetName, 17, 15, 856.49),
					new ExpectedCellValue(sheetName, 18, 15, 831.5),
					new ExpectedCellValue(sheetName, 19, 15, 1194d),
					new ExpectedCellValue(sheetName, 20, 15, 831.5),
					new ExpectedCellValue(sheetName, 21, 15, 2857d),
					new ExpectedCellValue(sheetName, 22, 15, 415.75),
					new ExpectedCellValue(sheetName, 23, 15, 99d),
					new ExpectedCellValue(sheetName, 24, 15, 514.75),
					new ExpectedCellValue(sheetName, 25, 15, 15d),
					new ExpectedCellValue(sheetName, 26, 15, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsAllTabularLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:F38"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 26, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 2, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 3, "March"),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, "January"),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 3, "February"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 3, "March"),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, "January"),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 3, "February"),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Item"),
					new ExpectedCellValue(sheetName, 3, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, null),
					new ExpectedCellValue(sheetName, 7, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, "Tent"),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, "Values"),
					new ExpectedCellValue(sheetName, 3, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, null),
					new ExpectedCellValue(sheetName, 7, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 5, null),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, null),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, null),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 2, 6, null),
					new ExpectedCellValue(sheetName, 3, 6, 2d),
					new ExpectedCellValue(sheetName, 4, 6, 831.5),
					new ExpectedCellValue(sheetName, 5, 6, 2d),
					new ExpectedCellValue(sheetName, 6, 6, 831.5),
					new ExpectedCellValue(sheetName, 7, 6, 1d),
					new ExpectedCellValue(sheetName, 8, 6, 24.99),
					new ExpectedCellValue(sheetName, 9, 6, 1d),
					new ExpectedCellValue(sheetName, 10, 6, 24.99),
					new ExpectedCellValue(sheetName, 11, 6, 3d),
					new ExpectedCellValue(sheetName, 12, 6, 856.49),
					new ExpectedCellValue(sheetName, 13, 6, 2d),
					new ExpectedCellValue(sheetName, 14, 6, 831.5),
					new ExpectedCellValue(sheetName, 15, 6, 2d),
					new ExpectedCellValue(sheetName, 16, 6, 831.5),
					new ExpectedCellValue(sheetName, 17, 6, 6d),
					new ExpectedCellValue(sheetName, 18, 6, 1194d),
					new ExpectedCellValue(sheetName, 19, 6, 6d),
					new ExpectedCellValue(sheetName, 20, 6, 1194d),
					new ExpectedCellValue(sheetName, 21, 6, 2d),
					new ExpectedCellValue(sheetName, 22, 6, 831.5),
					new ExpectedCellValue(sheetName, 23, 6, 2d),
					new ExpectedCellValue(sheetName, 24, 6, 831.5),
					new ExpectedCellValue(sheetName, 25, 6, 10d),
					new ExpectedCellValue(sheetName, 26, 6, 2857d),
					new ExpectedCellValue(sheetName, 27, 6, 1d),
					new ExpectedCellValue(sheetName, 28, 6, 415.75),
					new ExpectedCellValue(sheetName, 29, 6, 1d),
					new ExpectedCellValue(sheetName, 30, 6, 415.75),
					new ExpectedCellValue(sheetName, 31, 6, 1d),
					new ExpectedCellValue(sheetName, 32, 6, 99d),
					new ExpectedCellValue(sheetName, 33, 6, 1d),
					new ExpectedCellValue(sheetName, 34, 6, 99d),
					new ExpectedCellValue(sheetName, 35, 6, 2d),
					new ExpectedCellValue(sheetName, 36, 6, 514.75),
					new ExpectedCellValue(sheetName, 37, 6, 15d),
					new ExpectedCellValue(sheetName, 38, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsAllTabularThirdFieldDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I2:L52"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, null),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, null),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 9, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 9, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 9, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 9, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 52, 9, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 10, "Month"),
					new ExpectedCellValue(sheetName, 3, 10, "January"),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 10, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 10, "March"),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 10, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, "January"),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 10, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 10, "February"),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 10, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 10, "March"),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 10, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, "January"),
					new ExpectedCellValue(sheetName, 38, 10, null),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 10, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 10, "February"),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 48, 10, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 2, 11, "Values"),
					new ExpectedCellValue(sheetName, 3, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 11, "Headlamp"),
					new ExpectedCellValue(sheetName, 11, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 11, "Headlamp"),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 11, "Tent"),
					new ExpectedCellValue(sheetName, 25, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 11, "Tent"),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 32, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 11, null),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 36, 11, null),
					new ExpectedCellValue(sheetName, 37, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 40, 11, "Car Rack"),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 44, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 45, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 11, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, null),
					new ExpectedCellValue(sheetName, 49, 11, null),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 2, 12, null),
					new ExpectedCellValue(sheetName, 3, 12, null),
					new ExpectedCellValue(sheetName, 4, 12, 2d),
					new ExpectedCellValue(sheetName, 5, 12, null),
					new ExpectedCellValue(sheetName, 6, 12, 831.5),
					new ExpectedCellValue(sheetName, 7, 12, 2d),
					new ExpectedCellValue(sheetName, 8, 12, 831.5),
					new ExpectedCellValue(sheetName, 9, 12, null),
					new ExpectedCellValue(sheetName, 10, 12, 1d),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, 24.99),
					new ExpectedCellValue(sheetName, 13, 12, 1d),
					new ExpectedCellValue(sheetName, 14, 12, 24.99),
					new ExpectedCellValue(sheetName, 15, 12, 3d),
					new ExpectedCellValue(sheetName, 16, 12, 856.49),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, 2d),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, 831.5),
					new ExpectedCellValue(sheetName, 21, 12, 2d),
					new ExpectedCellValue(sheetName, 22, 12, 831.5),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, 6d),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, 1194d),
					new ExpectedCellValue(sheetName, 27, 12, 6d),
					new ExpectedCellValue(sheetName, 28, 12, 1194d),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, 2d),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, 831.5),
					new ExpectedCellValue(sheetName, 33, 12, 2d),
					new ExpectedCellValue(sheetName, 34, 12, 831.5),
					new ExpectedCellValue(sheetName, 35, 12, 10d),
					new ExpectedCellValue(sheetName, 36, 12, 2857d),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, 1d),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, 415.75),
					new ExpectedCellValue(sheetName, 41, 12, 1d),
					new ExpectedCellValue(sheetName, 42, 12, 415.75),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, 1d),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, 99d),
					new ExpectedCellValue(sheetName, 47, 12, 1d),
					new ExpectedCellValue(sheetName, 48, 12, 99d),
					new ExpectedCellValue(sheetName, 49, 12, 2d),
					new ExpectedCellValue(sheetName, 50, 12, 514.75),
					new ExpectedCellValue(sheetName, 51, 12, 15d),
					new ExpectedCellValue(sheetName, 52, 12, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsAllTabularSecondFieldDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O2:R44"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, null),
					new ExpectedCellValue(sheetName, 6, 15, null),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 14, 15, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, null),
					new ExpectedCellValue(sheetName, 22, 15, null),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, null),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 29, 15, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 15, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 15, "San Francisco"),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 33, 15, null),
					new ExpectedCellValue(sheetName, 34, 15, null),
					new ExpectedCellValue(sheetName, 35, 15, null),
					new ExpectedCellValue(sheetName, 36, 15, null),
					new ExpectedCellValue(sheetName, 37, 15, null),
					new ExpectedCellValue(sheetName, 38, 15, null),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 40, 15, null),
					new ExpectedCellValue(sheetName, 41, 15, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 15, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 15, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 44, 15, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 16, "Values"),
					new ExpectedCellValue(sheetName, 3, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 16, "January"),
					new ExpectedCellValue(sheetName, 5, 16, "January Total"),
					new ExpectedCellValue(sheetName, 6, 16, "March"),
					new ExpectedCellValue(sheetName, 7, 16, "March Total"),
					new ExpectedCellValue(sheetName, 8, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 16, "January"),
					new ExpectedCellValue(sheetName, 10, 16, "January Total"),
					new ExpectedCellValue(sheetName, 11, 16, "March"),
					new ExpectedCellValue(sheetName, 12, 16, "March Total"),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 16, "January"),
					new ExpectedCellValue(sheetName, 17, 16, "January Total"),
					new ExpectedCellValue(sheetName, 18, 16, "February"),
					new ExpectedCellValue(sheetName, 19, 16, "February Total"),
					new ExpectedCellValue(sheetName, 20, 16, "March"),
					new ExpectedCellValue(sheetName, 21, 16, "March Total"),
					new ExpectedCellValue(sheetName, 22, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 16, "January"),
					new ExpectedCellValue(sheetName, 24, 16, "January Total"),
					new ExpectedCellValue(sheetName, 25, 16, "February"),
					new ExpectedCellValue(sheetName, 26, 16, "February Total"),
					new ExpectedCellValue(sheetName, 27, 16, "March"),
					new ExpectedCellValue(sheetName, 28, 16, "March Total"),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 31, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 16, "January"),
					new ExpectedCellValue(sheetName, 33, 16, "January Total"),
					new ExpectedCellValue(sheetName, 34, 16, "February"),
					new ExpectedCellValue(sheetName, 35, 16, "February Total"),
					new ExpectedCellValue(sheetName, 36, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 16, "January"),
					new ExpectedCellValue(sheetName, 38, 16, "January Total"),
					new ExpectedCellValue(sheetName, 39, 16, "February"),
					new ExpectedCellValue(sheetName, 40, 16, "February Total"),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, null),
					new ExpectedCellValue(sheetName, 2, 17, "Item"),
					new ExpectedCellValue(sheetName, 3, 17, null),
					new ExpectedCellValue(sheetName, 4, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 17, null),
					new ExpectedCellValue(sheetName, 6, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 17, null),
					new ExpectedCellValue(sheetName, 11, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, "Tent"),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, "Tent"),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 40, 17, null),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, null),
					new ExpectedCellValue(sheetName, 43, 17, null),
					new ExpectedCellValue(sheetName, 44, 17, null),
					new ExpectedCellValue(sheetName, 2, 18, null),
					new ExpectedCellValue(sheetName, 3, 18, null),
					new ExpectedCellValue(sheetName, 4, 18, 2d),
					new ExpectedCellValue(sheetName, 5, 18, 2d),
					new ExpectedCellValue(sheetName, 6, 18, 1d),
					new ExpectedCellValue(sheetName, 7, 18, 1d),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, 831.5),
					new ExpectedCellValue(sheetName, 10, 18, 831.5),
					new ExpectedCellValue(sheetName, 11, 18, 24.99),
					new ExpectedCellValue(sheetName, 12, 18, 24.99),
					new ExpectedCellValue(sheetName, 13, 18, 3d),
					new ExpectedCellValue(sheetName, 14, 18, 856.49),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, 2d),
					new ExpectedCellValue(sheetName, 17, 18, 2d),
					new ExpectedCellValue(sheetName, 18, 18, 6d),
					new ExpectedCellValue(sheetName, 19, 18, 6d),
					new ExpectedCellValue(sheetName, 20, 18, 2d),
					new ExpectedCellValue(sheetName, 21, 18, 2d),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, 831.5),
					new ExpectedCellValue(sheetName, 24, 18, 831.5),
					new ExpectedCellValue(sheetName, 25, 18, 1194d),
					new ExpectedCellValue(sheetName, 26, 18, 1194d),
					new ExpectedCellValue(sheetName, 27, 18, 831.5),
					new ExpectedCellValue(sheetName, 28, 18, 831.5),
					new ExpectedCellValue(sheetName, 29, 18, 10d),
					new ExpectedCellValue(sheetName, 30, 18, 2857d),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, 1d),
					new ExpectedCellValue(sheetName, 33, 18, 1d),
					new ExpectedCellValue(sheetName, 34, 18, 1d),
					new ExpectedCellValue(sheetName, 35, 18, 1d),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, 415.75),
					new ExpectedCellValue(sheetName, 38, 18, 415.75),
					new ExpectedCellValue(sheetName, 39, 18, 99d),
					new ExpectedCellValue(sheetName, 40, 18, 99d),
					new ExpectedCellValue(sheetName, 41, 18, 2d),
					new ExpectedCellValue(sheetName, 42, 18, 514.75),
					new ExpectedCellValue(sheetName, 43, 18, 15d),
					new ExpectedCellValue(sheetName, 44, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsAllTabularFirstFieldDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("U2:X40"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 21, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 21, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 21, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 21, null),
					new ExpectedCellValue(sheetName, 6, 21, null),
					new ExpectedCellValue(sheetName, 7, 21, null),
					new ExpectedCellValue(sheetName, 8, 21, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 21, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, null),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, null),
					new ExpectedCellValue(sheetName, 14, 21, null),
					new ExpectedCellValue(sheetName, 15, 21, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 21, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 21, null),
					new ExpectedCellValue(sheetName, 18, 21, null),
					new ExpectedCellValue(sheetName, 19, 21, null),
					new ExpectedCellValue(sheetName, 20, 21, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 21, 21, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 21, "Chicago"),
					new ExpectedCellValue(sheetName, 23, 21, null),
					new ExpectedCellValue(sheetName, 24, 21, null),
					new ExpectedCellValue(sheetName, 25, 21, null),
					new ExpectedCellValue(sheetName, 26, 21, "Chicago Total"),
					new ExpectedCellValue(sheetName, 27, 21, "Nashville"),
					new ExpectedCellValue(sheetName, 28, 21, null),
					new ExpectedCellValue(sheetName, 29, 21, null),
					new ExpectedCellValue(sheetName, 30, 21, null),
					new ExpectedCellValue(sheetName, 31, 21, null),
					new ExpectedCellValue(sheetName, 32, 21, null),
					new ExpectedCellValue(sheetName, 33, 21, "Nashville Total"),
					new ExpectedCellValue(sheetName, 34, 21, "San Francisco"),
					new ExpectedCellValue(sheetName, 35, 21, null),
					new ExpectedCellValue(sheetName, 36, 21, null),
					new ExpectedCellValue(sheetName, 37, 21, null),
					new ExpectedCellValue(sheetName, 38, 21, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 39, 21, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 40, 21, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 22, "Month"),
					new ExpectedCellValue(sheetName, 3, 22, null),
					new ExpectedCellValue(sheetName, 4, 22, "January"),
					new ExpectedCellValue(sheetName, 5, 22, "January Total"),
					new ExpectedCellValue(sheetName, 6, 22, "March"),
					new ExpectedCellValue(sheetName, 7, 22, "March Total"),
					new ExpectedCellValue(sheetName, 8, 22, null),
					new ExpectedCellValue(sheetName, 9, 22, "January"),
					new ExpectedCellValue(sheetName, 10, 22, "January Total"),
					new ExpectedCellValue(sheetName, 11, 22, "February"),
					new ExpectedCellValue(sheetName, 12, 22, "February Total"),
					new ExpectedCellValue(sheetName, 13, 22, "March"),
					new ExpectedCellValue(sheetName, 14, 22, "March Total"),
					new ExpectedCellValue(sheetName, 15, 22, null),
					new ExpectedCellValue(sheetName, 16, 22, "January"),
					new ExpectedCellValue(sheetName, 17, 22, "January Total"),
					new ExpectedCellValue(sheetName, 18, 22, "February"),
					new ExpectedCellValue(sheetName, 19, 22, "February Total"),
					new ExpectedCellValue(sheetName, 20, 22, null),
					new ExpectedCellValue(sheetName, 21, 22, null),
					new ExpectedCellValue(sheetName, 22, 22, "January"),
					new ExpectedCellValue(sheetName, 23, 22, "January Total"),
					new ExpectedCellValue(sheetName, 24, 22, "March"),
					new ExpectedCellValue(sheetName, 25, 22, "March Total"),
					new ExpectedCellValue(sheetName, 26, 22, null),
					new ExpectedCellValue(sheetName, 27, 22, "January"),
					new ExpectedCellValue(sheetName, 28, 22, "January Total"),
					new ExpectedCellValue(sheetName, 29, 22, "February"),
					new ExpectedCellValue(sheetName, 30, 22, "February Total"),
					new ExpectedCellValue(sheetName, 31, 22, "March"),
					new ExpectedCellValue(sheetName, 32, 22, "March Total"),
					new ExpectedCellValue(sheetName, 33, 22, null),
					new ExpectedCellValue(sheetName, 34, 22, "January"),
					new ExpectedCellValue(sheetName, 35, 22, "January Total"),
					new ExpectedCellValue(sheetName, 36, 22, "February"),
					new ExpectedCellValue(sheetName, 37, 22, "February Total"),
					new ExpectedCellValue(sheetName, 38, 22, null),
					new ExpectedCellValue(sheetName, 39, 22, null),
					new ExpectedCellValue(sheetName, 40, 22, null),
					new ExpectedCellValue(sheetName, 2, 23, "Item"),
					new ExpectedCellValue(sheetName, 3, 23, null),
					new ExpectedCellValue(sheetName, 4, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 5, 23, null),
					new ExpectedCellValue(sheetName, 6, 23, "Headlamp"),
					new ExpectedCellValue(sheetName, 7, 23, null),
					new ExpectedCellValue(sheetName, 8, 23, null),
					new ExpectedCellValue(sheetName, 9, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 23, null),
					new ExpectedCellValue(sheetName, 11, 23, "Tent"),
					new ExpectedCellValue(sheetName, 12, 23, null),
					new ExpectedCellValue(sheetName, 13, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 23, null),
					new ExpectedCellValue(sheetName, 15, 23, null),
					new ExpectedCellValue(sheetName, 16, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 23, null),
					new ExpectedCellValue(sheetName, 18, 23, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 19, 23, null),
					new ExpectedCellValue(sheetName, 20, 23, null),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 23, null),
					new ExpectedCellValue(sheetName, 24, 23, "Headlamp"),
					new ExpectedCellValue(sheetName, 25, 23, null),
					new ExpectedCellValue(sheetName, 26, 23, null),
					new ExpectedCellValue(sheetName, 27, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 23, null),
					new ExpectedCellValue(sheetName, 29, 23, "Tent"),
					new ExpectedCellValue(sheetName, 30, 23, null),
					new ExpectedCellValue(sheetName, 31, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 32, 23, null),
					new ExpectedCellValue(sheetName, 33, 23, null),
					new ExpectedCellValue(sheetName, 34, 23, "Car Rack"),
					new ExpectedCellValue(sheetName, 35, 23, null),
					new ExpectedCellValue(sheetName, 36, 23, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 37, 23, null),
					new ExpectedCellValue(sheetName, 38, 23, null),
					new ExpectedCellValue(sheetName, 39, 23, null),
					new ExpectedCellValue(sheetName, 40, 23, null),
					new ExpectedCellValue(sheetName, 2, 24, null),
					new ExpectedCellValue(sheetName, 3, 24, null),
					new ExpectedCellValue(sheetName, 4, 24, 2d),
					new ExpectedCellValue(sheetName, 5, 24, 2d),
					new ExpectedCellValue(sheetName, 6, 24, 1d),
					new ExpectedCellValue(sheetName, 7, 24, 1d),
					new ExpectedCellValue(sheetName, 8, 24, 3d),
					new ExpectedCellValue(sheetName, 9, 24, 2d),
					new ExpectedCellValue(sheetName, 10, 24, 2d),
					new ExpectedCellValue(sheetName, 11, 24, 6d),
					new ExpectedCellValue(sheetName, 12, 24, 6d),
					new ExpectedCellValue(sheetName, 13, 24, 2d),
					new ExpectedCellValue(sheetName, 14, 24, 2d),
					new ExpectedCellValue(sheetName, 15, 24, 10d),
					new ExpectedCellValue(sheetName, 16, 24, 1d),
					new ExpectedCellValue(sheetName, 17, 24, 1d),
					new ExpectedCellValue(sheetName, 18, 24, 1d),
					new ExpectedCellValue(sheetName, 19, 24, 1d),
					new ExpectedCellValue(sheetName, 20, 24, 2d),
					new ExpectedCellValue(sheetName, 21, 24, null),
					new ExpectedCellValue(sheetName, 22, 24, 831.5),
					new ExpectedCellValue(sheetName, 23, 24, 831.5),
					new ExpectedCellValue(sheetName, 24, 24, 24.99),
					new ExpectedCellValue(sheetName, 25, 24, 24.99),
					new ExpectedCellValue(sheetName, 26, 24, 856.49),
					new ExpectedCellValue(sheetName, 27, 24, 831.5),
					new ExpectedCellValue(sheetName, 28, 24, 831.5),
					new ExpectedCellValue(sheetName, 29, 24, 1194d),
					new ExpectedCellValue(sheetName, 30, 24, 1194d),
					new ExpectedCellValue(sheetName, 31, 24, 831.5),
					new ExpectedCellValue(sheetName, 32, 24, 831.5),
					new ExpectedCellValue(sheetName, 33, 24, 2857d),
					new ExpectedCellValue(sheetName, 34, 24, 415.75),
					new ExpectedCellValue(sheetName, 35, 24, 415.75),
					new ExpectedCellValue(sheetName, 36, 24, 99d),
					new ExpectedCellValue(sheetName, 37, 24, 99d),
					new ExpectedCellValue(sheetName, 38, 24, 514.75),
					new ExpectedCellValue(sheetName, 39, 24, 15d),
					new ExpectedCellValue(sheetName, 40, 24, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstFieldOnlyLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B59:D109"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 59, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 60, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, null),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 73, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 74, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, null),
					new ExpectedCellValue(sheetName, 78, 2, null),
					new ExpectedCellValue(sheetName, 79, 2, null),
					new ExpectedCellValue(sheetName, 80, 2, null),
					new ExpectedCellValue(sheetName, 81, 2, null),
					new ExpectedCellValue(sheetName, 82, 2, null),
					new ExpectedCellValue(sheetName, 83, 2, null),
					new ExpectedCellValue(sheetName, 84, 2, null),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, null),
					new ExpectedCellValue(sheetName, 87, 2, null),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 90, 2, null),
					new ExpectedCellValue(sheetName, 91, 2, null),
					new ExpectedCellValue(sheetName, 92, 2, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 93, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 94, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 95, 2, null),
					new ExpectedCellValue(sheetName, 96, 2, null),
					new ExpectedCellValue(sheetName, 97, 2, null),
					new ExpectedCellValue(sheetName, 98, 2, null),
					new ExpectedCellValue(sheetName, 99, 2, null),
					new ExpectedCellValue(sheetName, 100, 2, null),
					new ExpectedCellValue(sheetName, 101, 2, null),
					new ExpectedCellValue(sheetName, 102, 2, null),
					new ExpectedCellValue(sheetName, 103, 2, null),
					new ExpectedCellValue(sheetName, 104, 2, null),
					new ExpectedCellValue(sheetName, 105, 2, null),
					new ExpectedCellValue(sheetName, 106, 2, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 107, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 109, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 3, "Month"),
					new ExpectedCellValue(sheetName, 60, 3, "January"),
					new ExpectedCellValue(sheetName, 61, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 62, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 63, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 64, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 65, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 66, 3, "March"),
					new ExpectedCellValue(sheetName, 67, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 68, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 3, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, "January"),
					new ExpectedCellValue(sheetName, 75, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 76, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 77, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 78, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 79, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 3, "February"),
					new ExpectedCellValue(sheetName, 81, 3, "Tent"),
					new ExpectedCellValue(sheetName, 82, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 83, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 84, 3, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 85, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 86, 3, "March"),
					new ExpectedCellValue(sheetName, 87, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 88, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 3, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 91, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 92, 3, null),
					new ExpectedCellValue(sheetName, 93, 3, null),
					new ExpectedCellValue(sheetName, 94, 3, "January"),
					new ExpectedCellValue(sheetName, 95, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 96, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 97, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 98, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 99, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 100, 3, "February"),
					new ExpectedCellValue(sheetName, 101, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 102, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 103, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 104, 3, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 3, null),
					new ExpectedCellValue(sheetName, 107, 3, null),
					new ExpectedCellValue(sheetName, 108, 3, null),
					new ExpectedCellValue(sheetName, 109, 3, null),
					new ExpectedCellValue(sheetName, 59, 4, null),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, 415.75),
					new ExpectedCellValue(sheetName, 63, 4, 831.5),
					new ExpectedCellValue(sheetName, 64, 4, 415.75),
					new ExpectedCellValue(sheetName, 65, 4, 831.5),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, null),
					new ExpectedCellValue(sheetName, 68, 4, 24.99),
					new ExpectedCellValue(sheetName, 69, 4, 24.99),
					new ExpectedCellValue(sheetName, 70, 4, 24.99),
					new ExpectedCellValue(sheetName, 71, 4, 24.99),
					new ExpectedCellValue(sheetName, 72, 4, 440.74),
					new ExpectedCellValue(sheetName, 73, 4, 856.49),
					new ExpectedCellValue(sheetName, 74, 4, null),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, 415.75),
					new ExpectedCellValue(sheetName, 77, 4, 831.5),
					new ExpectedCellValue(sheetName, 78, 4, 415.75),
					new ExpectedCellValue(sheetName, 79, 4, 831.5),
					new ExpectedCellValue(sheetName, 80, 4, null),
					new ExpectedCellValue(sheetName, 81, 4, null),
					new ExpectedCellValue(sheetName, 82, 4, 199d),
					new ExpectedCellValue(sheetName, 83, 4, 1194d),
					new ExpectedCellValue(sheetName, 84, 4, 199d),
					new ExpectedCellValue(sheetName, 85, 4, 1194d),
					new ExpectedCellValue(sheetName, 86, 4, null),
					new ExpectedCellValue(sheetName, 87, 4, null),
					new ExpectedCellValue(sheetName, 88, 4, 415.75),
					new ExpectedCellValue(sheetName, 89, 4, 831.5),
					new ExpectedCellValue(sheetName, 90, 4, 415.75),
					new ExpectedCellValue(sheetName, 91, 4, 831.5),
					new ExpectedCellValue(sheetName, 92, 4, 1030.5),
					new ExpectedCellValue(sheetName, 93, 4, 2857d),
					new ExpectedCellValue(sheetName, 94, 4, null),
					new ExpectedCellValue(sheetName, 95, 4, null),
					new ExpectedCellValue(sheetName, 96, 4, 415.75),
					new ExpectedCellValue(sheetName, 97, 4, 415.75),
					new ExpectedCellValue(sheetName, 98, 4, 415.75),
					new ExpectedCellValue(sheetName, 99, 4, 415.75),
					new ExpectedCellValue(sheetName, 100, 4, null),
					new ExpectedCellValue(sheetName, 101, 4, null),
					new ExpectedCellValue(sheetName, 102, 4, 99d),
					new ExpectedCellValue(sheetName, 103, 4, 99d),
					new ExpectedCellValue(sheetName, 104, 4, 99d),
					new ExpectedCellValue(sheetName, 105, 4, 99d),
					new ExpectedCellValue(sheetName, 106, 4, 514.75),
					new ExpectedCellValue(sheetName, 107, 4, 514.75),
					new ExpectedCellValue(sheetName, 108, 4, 1985.99),
					new ExpectedCellValue(sheetName, 109, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstFieldOnlyThirdDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G59:I116"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 59, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 60, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, null),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, null),
					new ExpectedCellValue(sheetName, 68, 7, null),
					new ExpectedCellValue(sheetName, 69, 7, null),
					new ExpectedCellValue(sheetName, 70, 7, null),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, null),
					new ExpectedCellValue(sheetName, 73, 7, null),
					new ExpectedCellValue(sheetName, 74, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 75, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, null),
					new ExpectedCellValue(sheetName, 79, 7, null),
					new ExpectedCellValue(sheetName, 80, 7, null),
					new ExpectedCellValue(sheetName, 81, 7, null),
					new ExpectedCellValue(sheetName, 82, 7, null),
					new ExpectedCellValue(sheetName, 83, 7, null),
					new ExpectedCellValue(sheetName, 84, 7, null),
					new ExpectedCellValue(sheetName, 85, 7, null),
					new ExpectedCellValue(sheetName, 86, 7, null),
					new ExpectedCellValue(sheetName, 87, 7, null),
					new ExpectedCellValue(sheetName, 88, 7, null),
					new ExpectedCellValue(sheetName, 89, 7, null),
					new ExpectedCellValue(sheetName, 90, 7, null),
					new ExpectedCellValue(sheetName, 91, 7, null),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, null),
					new ExpectedCellValue(sheetName, 94, 7, null),
					new ExpectedCellValue(sheetName, 95, 7, null),
					new ExpectedCellValue(sheetName, 96, 7, null),
					new ExpectedCellValue(sheetName, 97, 7, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 98, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 7, null),
					new ExpectedCellValue(sheetName, 101, 7, null),
					new ExpectedCellValue(sheetName, 102, 7, null),
					new ExpectedCellValue(sheetName, 103, 7, null),
					new ExpectedCellValue(sheetName, 104, 7, null),
					new ExpectedCellValue(sheetName, 105, 7, null),
					new ExpectedCellValue(sheetName, 106, 7, null),
					new ExpectedCellValue(sheetName, 107, 7, null),
					new ExpectedCellValue(sheetName, 108, 7, null),
					new ExpectedCellValue(sheetName, 109, 7, null),
					new ExpectedCellValue(sheetName, 110, 7, null),
					new ExpectedCellValue(sheetName, 111, 7, null),
					new ExpectedCellValue(sheetName, 112, 7, null),
					new ExpectedCellValue(sheetName, 113, 7, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 114, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 115, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 116, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 8, "Month"),
					new ExpectedCellValue(sheetName, 60, 8, "January"),
					new ExpectedCellValue(sheetName, 61, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 62, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 64, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 66, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 67, 8, "March"),
					new ExpectedCellValue(sheetName, 68, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 70, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 73, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, "January"),
					new ExpectedCellValue(sheetName, 77, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 8, "February"),
					new ExpectedCellValue(sheetName, 84, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 85, 8, "Tent"),
					new ExpectedCellValue(sheetName, 86, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 87, 8, "Tent"),
					new ExpectedCellValue(sheetName, 88, 8, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 8, "March"),
					new ExpectedCellValue(sheetName, 91, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 92, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 93, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 94, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 95, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, null),
					new ExpectedCellValue(sheetName, 99, 8, "January"),
					new ExpectedCellValue(sheetName, 100, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 101, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 102, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 104, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 8, "February"),
					new ExpectedCellValue(sheetName, 107, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 108, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 109, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 111, 8, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 112, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 113, 8, null),
					new ExpectedCellValue(sheetName, 114, 8, null),
					new ExpectedCellValue(sheetName, 115, 8, null),
					new ExpectedCellValue(sheetName, 116, 8, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, 415.75),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, 831.5),
					new ExpectedCellValue(sheetName, 65, 9, 415.75),
					new ExpectedCellValue(sheetName, 66, 9, 831.5),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, null),
					new ExpectedCellValue(sheetName, 69, 9, 24.99),
					new ExpectedCellValue(sheetName, 70, 9, null),
					new ExpectedCellValue(sheetName, 71, 9, 24.99),
					new ExpectedCellValue(sheetName, 72, 9, 24.99),
					new ExpectedCellValue(sheetName, 73, 9, 24.99),
					new ExpectedCellValue(sheetName, 74, 9, 440.74),
					new ExpectedCellValue(sheetName, 75, 9, 856.49),
					new ExpectedCellValue(sheetName, 76, 9, null),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, 415.75),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 80, 9, 831.5),
					new ExpectedCellValue(sheetName, 81, 9, 415.75),
					new ExpectedCellValue(sheetName, 82, 9, 831.5),
					new ExpectedCellValue(sheetName, 83, 9, null),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, 199d),
					new ExpectedCellValue(sheetName, 86, 9, null),
					new ExpectedCellValue(sheetName, 87, 9, 1194d),
					new ExpectedCellValue(sheetName, 88, 9, 199d),
					new ExpectedCellValue(sheetName, 89, 9, 1194d),
					new ExpectedCellValue(sheetName, 90, 9, null),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, 415.75),
					new ExpectedCellValue(sheetName, 93, 9, null),
					new ExpectedCellValue(sheetName, 94, 9, 831.5),
					new ExpectedCellValue(sheetName, 95, 9, 415.75),
					new ExpectedCellValue(sheetName, 96, 9, 831.5),
					new ExpectedCellValue(sheetName, 97, 9, 1030.5),
					new ExpectedCellValue(sheetName, 98, 9, 2857d),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, null),
					new ExpectedCellValue(sheetName, 101, 9, 415.75),
					new ExpectedCellValue(sheetName, 102, 9, null),
					new ExpectedCellValue(sheetName, 103, 9, 415.75),
					new ExpectedCellValue(sheetName, 104, 9, 415.75),
					new ExpectedCellValue(sheetName, 105, 9, 415.75),
					new ExpectedCellValue(sheetName, 106, 9, null),
					new ExpectedCellValue(sheetName, 107, 9, null),
					new ExpectedCellValue(sheetName, 108, 9, 99d),
					new ExpectedCellValue(sheetName, 109, 9, null),
					new ExpectedCellValue(sheetName, 110, 9, 99d),
					new ExpectedCellValue(sheetName, 111, 9, 99d),
					new ExpectedCellValue(sheetName, 112, 9, 99d),
					new ExpectedCellValue(sheetName, 113, 9, 514.75),
					new ExpectedCellValue(sheetName, 114, 9, 514.75),
					new ExpectedCellValue(sheetName, 115, 9, 1985.99),
					new ExpectedCellValue(sheetName, 116, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstFieldOnlySecondDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L59:N101"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 59, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 60, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, null),
					new ExpectedCellValue(sheetName, 63, 12, null),
					new ExpectedCellValue(sheetName, 64, 12, null),
					new ExpectedCellValue(sheetName, 65, 12, null),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, null),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, null),
					new ExpectedCellValue(sheetName, 70, 12, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, null),
					new ExpectedCellValue(sheetName, 77, 12, null),
					new ExpectedCellValue(sheetName, 78, 12, null),
					new ExpectedCellValue(sheetName, 79, 12, null),
					new ExpectedCellValue(sheetName, 80, 12, null),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, null),
					new ExpectedCellValue(sheetName, 83, 12, null),
					new ExpectedCellValue(sheetName, 84, 12, null),
					new ExpectedCellValue(sheetName, 85, 12, null),
					new ExpectedCellValue(sheetName, 86, 12, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 90, 12, null),
					new ExpectedCellValue(sheetName, 91, 12, null),
					new ExpectedCellValue(sheetName, 92, 12, null),
					new ExpectedCellValue(sheetName, 93, 12, null),
					new ExpectedCellValue(sheetName, 94, 12, null),
					new ExpectedCellValue(sheetName, 95, 12, null),
					new ExpectedCellValue(sheetName, 96, 12, null),
					new ExpectedCellValue(sheetName, 97, 12, null),
					new ExpectedCellValue(sheetName, 98, 12, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 99, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 100, 12, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 101, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 13, "Values"),
					new ExpectedCellValue(sheetName, 60, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 61, 13, "January"),
					new ExpectedCellValue(sheetName, 62, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 13, "March"),
					new ExpectedCellValue(sheetName, 64, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 65, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 66, 13, "January"),
					new ExpectedCellValue(sheetName, 67, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 13, "March"),
					new ExpectedCellValue(sheetName, 69, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, null),
					new ExpectedCellValue(sheetName, 72, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 73, 13, "January"),
					new ExpectedCellValue(sheetName, 74, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 75, 13, "February"),
					new ExpectedCellValue(sheetName, 76, 13, "Tent"),
					new ExpectedCellValue(sheetName, 77, 13, "March"),
					new ExpectedCellValue(sheetName, 78, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 13, "January"),
					new ExpectedCellValue(sheetName, 81, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 82, 13, "February"),
					new ExpectedCellValue(sheetName, 83, 13, "Tent"),
					new ExpectedCellValue(sheetName, 84, 13, "March"),
					new ExpectedCellValue(sheetName, 85, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 13, null),
					new ExpectedCellValue(sheetName, 87, 13, null),
					new ExpectedCellValue(sheetName, 88, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 13, "January"),
					new ExpectedCellValue(sheetName, 90, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 91, 13, "February"),
					new ExpectedCellValue(sheetName, 92, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 93, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 94, 13, "January"),
					new ExpectedCellValue(sheetName, 95, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 96, 13, "February"),
					new ExpectedCellValue(sheetName, 97, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 98, 13, null),
					new ExpectedCellValue(sheetName, 99, 13, null),
					new ExpectedCellValue(sheetName, 100, 13, null),
					new ExpectedCellValue(sheetName, 101, 13, null),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, null),
					new ExpectedCellValue(sheetName, 61, 14, 415.75),
					new ExpectedCellValue(sheetName, 62, 14, 415.75),
					new ExpectedCellValue(sheetName, 63, 14, 24.99),
					new ExpectedCellValue(sheetName, 64, 14, 24.99),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, 831.5),
					new ExpectedCellValue(sheetName, 67, 14, 831.5),
					new ExpectedCellValue(sheetName, 68, 14, 24.99),
					new ExpectedCellValue(sheetName, 69, 14, 24.99),
					new ExpectedCellValue(sheetName, 70, 14, 440.74),
					new ExpectedCellValue(sheetName, 71, 14, 856.49),
					new ExpectedCellValue(sheetName, 72, 14, null),
					new ExpectedCellValue(sheetName, 73, 14, 415.75),
					new ExpectedCellValue(sheetName, 74, 14, 415.75),
					new ExpectedCellValue(sheetName, 75, 14, 199d),
					new ExpectedCellValue(sheetName, 76, 14, 199d),
					new ExpectedCellValue(sheetName, 77, 14, 415.75),
					new ExpectedCellValue(sheetName, 78, 14, 415.75),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, 831.5),
					new ExpectedCellValue(sheetName, 81, 14, 831.5),
					new ExpectedCellValue(sheetName, 82, 14, 1194d),
					new ExpectedCellValue(sheetName, 83, 14, 1194d),
					new ExpectedCellValue(sheetName, 84, 14, 831.5),
					new ExpectedCellValue(sheetName, 85, 14, 831.5),
					new ExpectedCellValue(sheetName, 86, 14, 1030.5),
					new ExpectedCellValue(sheetName, 87, 14, 2857d),
					new ExpectedCellValue(sheetName, 88, 14, null),
					new ExpectedCellValue(sheetName, 89, 14, 415.75),
					new ExpectedCellValue(sheetName, 90, 14, 415.75),
					new ExpectedCellValue(sheetName, 91, 14, 99d),
					new ExpectedCellValue(sheetName, 92, 14, 99d),
					new ExpectedCellValue(sheetName, 93, 14, null),
					new ExpectedCellValue(sheetName, 94, 14, 415.75),
					new ExpectedCellValue(sheetName, 95, 14, 415.75),
					new ExpectedCellValue(sheetName, 96, 14, 99d),
					new ExpectedCellValue(sheetName, 97, 14, 99d),
					new ExpectedCellValue(sheetName, 98, 14, 514.75),
					new ExpectedCellValue(sheetName, 99, 14, 514.75),
					new ExpectedCellValue(sheetName, 100, 14, 1985.99),
					new ExpectedCellValue(sheetName, 101, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstFieldOnlyFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P59:R97"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 59, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 60, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 61, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 62, 16, null),
					new ExpectedCellValue(sheetName, 63, 16, null),
					new ExpectedCellValue(sheetName, 64, 16, null),
					new ExpectedCellValue(sheetName, 65, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 66, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 67, 16, null),
					new ExpectedCellValue(sheetName, 68, 16, null),
					new ExpectedCellValue(sheetName, 69, 16, null),
					new ExpectedCellValue(sheetName, 70, 16, null),
					new ExpectedCellValue(sheetName, 71, 16, null),
					new ExpectedCellValue(sheetName, 72, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 73, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 74, 16, null),
					new ExpectedCellValue(sheetName, 75, 16, null),
					new ExpectedCellValue(sheetName, 76, 16, null),
					new ExpectedCellValue(sheetName, 77, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 78, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 79, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 80, 16, null),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, null),
					new ExpectedCellValue(sheetName, 83, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 84, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 85, 16, null),
					new ExpectedCellValue(sheetName, 86, 16, null),
					new ExpectedCellValue(sheetName, 87, 16, null),
					new ExpectedCellValue(sheetName, 88, 16, null),
					new ExpectedCellValue(sheetName, 89, 16, null),
					new ExpectedCellValue(sheetName, 90, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 91, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 92, 16, null),
					new ExpectedCellValue(sheetName, 93, 16, null),
					new ExpectedCellValue(sheetName, 94, 16, null),
					new ExpectedCellValue(sheetName, 95, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 96, 16, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 97, 16, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 17, "Month"),
					new ExpectedCellValue(sheetName, 60, 17, null),
					new ExpectedCellValue(sheetName, 61, 17, "January"),
					new ExpectedCellValue(sheetName, 62, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 17, "March"),
					new ExpectedCellValue(sheetName, 64, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 65, 17, null),
					new ExpectedCellValue(sheetName, 66, 17, "January"),
					new ExpectedCellValue(sheetName, 67, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 17, "February"),
					new ExpectedCellValue(sheetName, 69, 17, "Tent"),
					new ExpectedCellValue(sheetName, 70, 17, "March"),
					new ExpectedCellValue(sheetName, 71, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 72, 17, null),
					new ExpectedCellValue(sheetName, 73, 17, "January"),
					new ExpectedCellValue(sheetName, 74, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 75, 17, "February"),
					new ExpectedCellValue(sheetName, 76, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 77, 17, null),
					new ExpectedCellValue(sheetName, 78, 17, null),
					new ExpectedCellValue(sheetName, 79, 17, "January"),
					new ExpectedCellValue(sheetName, 80, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 17, "March"),
					new ExpectedCellValue(sheetName, 82, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, "January"),
					new ExpectedCellValue(sheetName, 85, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 17, "February"),
					new ExpectedCellValue(sheetName, 87, 17, "Tent"),
					new ExpectedCellValue(sheetName, 88, 17, "March"),
					new ExpectedCellValue(sheetName, 89, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 90, 17, null),
					new ExpectedCellValue(sheetName, 91, 17, "January"),
					new ExpectedCellValue(sheetName, 92, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 93, 17, "February"),
					new ExpectedCellValue(sheetName, 94, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 95, 17, null),
					new ExpectedCellValue(sheetName, 96, 17, null),
					new ExpectedCellValue(sheetName, 97, 17, null),
					new ExpectedCellValue(sheetName, 59, 18, null),
					new ExpectedCellValue(sheetName, 60, 18, null),
					new ExpectedCellValue(sheetName, 61, 18, 415.75),
					new ExpectedCellValue(sheetName, 62, 18, 415.75),
					new ExpectedCellValue(sheetName, 63, 18, 24.99),
					new ExpectedCellValue(sheetName, 64, 18, 24.99),
					new ExpectedCellValue(sheetName, 65, 18, 440.74),
					new ExpectedCellValue(sheetName, 66, 18, 415.75),
					new ExpectedCellValue(sheetName, 67, 18, 415.75),
					new ExpectedCellValue(sheetName, 68, 18, 199d),
					new ExpectedCellValue(sheetName, 69, 18, 199d),
					new ExpectedCellValue(sheetName, 70, 18, 415.75),
					new ExpectedCellValue(sheetName, 71, 18, 415.75),
					new ExpectedCellValue(sheetName, 72, 18, 1030.5),
					new ExpectedCellValue(sheetName, 73, 18, 415.75),
					new ExpectedCellValue(sheetName, 74, 18, 415.75),
					new ExpectedCellValue(sheetName, 75, 18, 99d),
					new ExpectedCellValue(sheetName, 76, 18, 99d),
					new ExpectedCellValue(sheetName, 77, 18, 514.75),
					new ExpectedCellValue(sheetName, 78, 18, null),
					new ExpectedCellValue(sheetName, 79, 18, 831.5),
					new ExpectedCellValue(sheetName, 80, 18, 831.5),
					new ExpectedCellValue(sheetName, 81, 18, 24.99),
					new ExpectedCellValue(sheetName, 82, 18, 24.99),
					new ExpectedCellValue(sheetName, 83, 18, 856.49),
					new ExpectedCellValue(sheetName, 84, 18, 831.5),
					new ExpectedCellValue(sheetName, 85, 18, 831.5),
					new ExpectedCellValue(sheetName, 86, 18, 1194d),
					new ExpectedCellValue(sheetName, 87, 18, 1194d),
					new ExpectedCellValue(sheetName, 88, 18, 831.5),
					new ExpectedCellValue(sheetName, 89, 18, 831.5),
					new ExpectedCellValue(sheetName, 90, 18, 2857d),
					new ExpectedCellValue(sheetName, 91, 18, 415.75),
					new ExpectedCellValue(sheetName, 92, 18, 415.75),
					new ExpectedCellValue(sheetName, 93, 18, 99d),
					new ExpectedCellValue(sheetName, 94, 18, 99d),
					new ExpectedCellValue(sheetName, 95, 18, 514.75),
					new ExpectedCellValue(sheetName, 96, 18, 1985.99),
					new ExpectedCellValue(sheetName, 97, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondFieldOnlyLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B120:D166"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 2, "January"),
					new ExpectedCellValue(sheetName, 123, 2, null),
					new ExpectedCellValue(sheetName, 124, 2, null),
					new ExpectedCellValue(sheetName, 125, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 126, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 127, 2, "March"),
					new ExpectedCellValue(sheetName, 128, 2, null),
					new ExpectedCellValue(sheetName, 129, 2, null),
					new ExpectedCellValue(sheetName, 130, 2, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 131, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 132, 2, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 133, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 134, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 135, 2, "January"),
					new ExpectedCellValue(sheetName, 136, 2, null),
					new ExpectedCellValue(sheetName, 137, 2, null),
					new ExpectedCellValue(sheetName, 138, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 2, "February"),
					new ExpectedCellValue(sheetName, 141, 2, null),
					new ExpectedCellValue(sheetName, 142, 2, null),
					new ExpectedCellValue(sheetName, 143, 2, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 144, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 145, 2, "March"),
					new ExpectedCellValue(sheetName, 146, 2, null),
					new ExpectedCellValue(sheetName, 147, 2, null),
					new ExpectedCellValue(sheetName, 148, 2, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 150, 2, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 151, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 152, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 2, "January"),
					new ExpectedCellValue(sheetName, 154, 2, null),
					new ExpectedCellValue(sheetName, 155, 2, null),
					new ExpectedCellValue(sheetName, 156, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 157, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 158, 2, "February"),
					new ExpectedCellValue(sheetName, 159, 2, null),
					new ExpectedCellValue(sheetName, 160, 2, null),
					new ExpectedCellValue(sheetName, 161, 2, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 2, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 164, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 165, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 166, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 3, "Item"),
					new ExpectedCellValue(sheetName, 121, 3, null),
					new ExpectedCellValue(sheetName, 122, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 123, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 124, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 125, 3,  null),
					new ExpectedCellValue(sheetName, 126, 3,  null),
					new ExpectedCellValue(sheetName, 127, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 128, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 129, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 130, 3, null),
					new ExpectedCellValue(sheetName, 131, 3, null),
					new ExpectedCellValue(sheetName, 132, 3, null),
					new ExpectedCellValue(sheetName, 133, 3, null),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 137, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 140, 3, "Tent"),
					new ExpectedCellValue(sheetName, 141, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 3, null),
					new ExpectedCellValue(sheetName, 144, 3, null),
					new ExpectedCellValue(sheetName, 145, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 146, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 147, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 148, 3, null),
					new ExpectedCellValue(sheetName, 149, 3, null),
					new ExpectedCellValue(sheetName, 150, 3, null),
					new ExpectedCellValue(sheetName, 151, 3, null),
					new ExpectedCellValue(sheetName, 152, 3, null),
					new ExpectedCellValue(sheetName, 153, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 154, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 155, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 156, 3, null),
					new ExpectedCellValue(sheetName, 157, 3, null),
					new ExpectedCellValue(sheetName, 158, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 159, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 160, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 161, 3, null),
					new ExpectedCellValue(sheetName, 162, 3, null),
					new ExpectedCellValue(sheetName, 163, 3, null),
					new ExpectedCellValue(sheetName, 164, 3, null),
					new ExpectedCellValue(sheetName, 165, 3, null),
					new ExpectedCellValue(sheetName, 166, 3, null),
					new ExpectedCellValue(sheetName, 120, 4, null),
					new ExpectedCellValue(sheetName, 121, 4, null),
					new ExpectedCellValue(sheetName, 122, 4, null),
					new ExpectedCellValue(sheetName, 123, 4, 415.75),
					new ExpectedCellValue(sheetName, 124, 4, 831.5),
					new ExpectedCellValue(sheetName, 125, 4,  415.75),
					new ExpectedCellValue(sheetName, 126, 4,  831.5),
					new ExpectedCellValue(sheetName, 127, 4, null),
					new ExpectedCellValue(sheetName, 128, 4, 24.99),
					new ExpectedCellValue(sheetName, 129, 4, 24.99),
					new ExpectedCellValue(sheetName, 130, 4, 24.99),
					new ExpectedCellValue(sheetName, 131, 4, 24.99),
					new ExpectedCellValue(sheetName, 132, 4, 440.74),
					new ExpectedCellValue(sheetName, 133, 4, 856.49),
					new ExpectedCellValue(sheetName, 134, 4, null),
					new ExpectedCellValue(sheetName, 135, 4, null),
					new ExpectedCellValue(sheetName, 136, 4, 415.75),
					new ExpectedCellValue(sheetName, 137, 4, 831.5),
					new ExpectedCellValue(sheetName, 138, 4, 415.75),
					new ExpectedCellValue(sheetName, 139, 4, 831.5),
					new ExpectedCellValue(sheetName, 140, 4, null),
					new ExpectedCellValue(sheetName, 141, 4, 199d),
					new ExpectedCellValue(sheetName, 142, 4, 1194d),
					new ExpectedCellValue(sheetName, 143, 4, 199d),
					new ExpectedCellValue(sheetName, 144, 4, 1194d),
					new ExpectedCellValue(sheetName, 145, 4, null),
					new ExpectedCellValue(sheetName, 146, 4, 415.75),
					new ExpectedCellValue(sheetName, 147, 4, 831.5),
					new ExpectedCellValue(sheetName, 148, 4, 415.75),
					new ExpectedCellValue(sheetName, 149, 4, 831.5),
					new ExpectedCellValue(sheetName, 150, 4, 1030.5),
					new ExpectedCellValue(sheetName, 151, 4, 2857d),
					new ExpectedCellValue(sheetName, 152, 4, null),
					new ExpectedCellValue(sheetName, 153, 4, null),
					new ExpectedCellValue(sheetName, 154, 4, 415.75),
					new ExpectedCellValue(sheetName, 155, 4, 415.75),
					new ExpectedCellValue(sheetName, 156, 4, 415.75),
					new ExpectedCellValue(sheetName, 157, 4, 415.75),
					new ExpectedCellValue(sheetName, 158, 4, null),
					new ExpectedCellValue(sheetName, 159, 4, 99d),
					new ExpectedCellValue(sheetName, 160, 4, 99d),
					new ExpectedCellValue(sheetName, 161, 4, 99d),
					new ExpectedCellValue(sheetName, 162, 4, 99d),
					new ExpectedCellValue(sheetName, 163, 4, 514.75),
					new ExpectedCellValue(sheetName, 164, 4, 514.75),
					new ExpectedCellValue(sheetName, 165, 4, 1985.99),
					new ExpectedCellValue(sheetName, 166, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondFieldOnlyThirdDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G120:I173"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 7, "January"),
					new ExpectedCellValue(sheetName, 123, 7, null),
					new ExpectedCellValue(sheetName, 124, 7, null),
					new ExpectedCellValue(sheetName, 125, 7, null),
					new ExpectedCellValue(sheetName, 126, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 127, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 7, "March"),
					new ExpectedCellValue(sheetName, 129, 7, null),
					new ExpectedCellValue(sheetName, 130, 7, null),
					new ExpectedCellValue(sheetName, 131, 7, null),
					new ExpectedCellValue(sheetName, 132, 7, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 133, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 134, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 135, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 137, 7, "January"),
					new ExpectedCellValue(sheetName, 138, 7, null),
					new ExpectedCellValue(sheetName, 139, 7, null),
					new ExpectedCellValue(sheetName, 140, 7, null),
					new ExpectedCellValue(sheetName, 141, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 7, "February"),
					new ExpectedCellValue(sheetName, 144, 7, null),
					new ExpectedCellValue(sheetName, 145, 7, null),
					new ExpectedCellValue(sheetName, 146, 7, null),
					new ExpectedCellValue(sheetName, 147, 7, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 148, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 149, 7, "March"),
					new ExpectedCellValue(sheetName, 150, 7, null),
					new ExpectedCellValue(sheetName, 151, 7, null),
					new ExpectedCellValue(sheetName, 152, 7, null),
					new ExpectedCellValue(sheetName, 153, 7, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 154, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 155, 7, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 156, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 158, 7, "January"),
					new ExpectedCellValue(sheetName, 159, 7, null),
					new ExpectedCellValue(sheetName, 160, 7, null),
					new ExpectedCellValue(sheetName, 161, 7, null),
					new ExpectedCellValue(sheetName, 162, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 163, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 164, 7, "February"),
					new ExpectedCellValue(sheetName, 165, 7, null),
					new ExpectedCellValue(sheetName, 166, 7, null),
					new ExpectedCellValue(sheetName, 167, 7, null),
					new ExpectedCellValue(sheetName, 168, 7, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 169, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 7, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 171, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 172, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 173, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 8, "Values"),
					new ExpectedCellValue(sheetName, 121, 8, null),
					new ExpectedCellValue(sheetName, 122, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 123, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 125, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 126, 8,  null),
					new ExpectedCellValue(sheetName, 127, 8,  null),
					new ExpectedCellValue(sheetName, 128, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 129, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 130, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 132, 8, null),
					new ExpectedCellValue(sheetName, 133, 8, null),
					new ExpectedCellValue(sheetName, 134, 8, null),
					new ExpectedCellValue(sheetName, 135, 8, null),
					new ExpectedCellValue(sheetName, 136, 8, null),
					new ExpectedCellValue(sheetName, 137, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 138, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 139, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 8, null),
					new ExpectedCellValue(sheetName, 142, 8, null),
					new ExpectedCellValue(sheetName, 143, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 144, 8, "Tent"),
					new ExpectedCellValue(sheetName, 145, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 8, "Tent"),
					new ExpectedCellValue(sheetName, 147, 8, null),
					new ExpectedCellValue(sheetName, 148, 8, null),
					new ExpectedCellValue(sheetName, 149, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 150, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 151, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 152, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 153, 8, null),
					new ExpectedCellValue(sheetName, 154, 8, null),
					new ExpectedCellValue(sheetName, 155, 8, null),
					new ExpectedCellValue(sheetName, 156, 8, null),
					new ExpectedCellValue(sheetName, 157, 8, null),
					new ExpectedCellValue(sheetName, 158, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 159, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 160, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 161, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 162, 8, null),
					new ExpectedCellValue(sheetName, 163, 8, null),
					new ExpectedCellValue(sheetName, 164, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 165, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 166, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 168, 8, null),
					new ExpectedCellValue(sheetName, 169, 8, null),
					new ExpectedCellValue(sheetName, 170, 8, null),
					new ExpectedCellValue(sheetName, 171, 8, null),
					new ExpectedCellValue(sheetName, 172, 8, null),
					new ExpectedCellValue(sheetName, 173, 8, null),
					new ExpectedCellValue(sheetName, 120, 9, null),
					new ExpectedCellValue(sheetName, 121, 9, null),
					new ExpectedCellValue(sheetName, 122, 9, null),
					new ExpectedCellValue(sheetName, 123, 9, 415.75),
					new ExpectedCellValue(sheetName, 124, 9, null),
					new ExpectedCellValue(sheetName, 125, 9, 831.5),
					new ExpectedCellValue(sheetName, 126, 9, 415.75),
					new ExpectedCellValue(sheetName, 127, 9, 831.5),
					new ExpectedCellValue(sheetName, 128, 9, null),
					new ExpectedCellValue(sheetName, 129, 9, 24.99),
					new ExpectedCellValue(sheetName, 130, 9, null),
					new ExpectedCellValue(sheetName, 131, 9, 24.99),
					new ExpectedCellValue(sheetName, 132, 9, 24.99),
					new ExpectedCellValue(sheetName, 133, 9, 24.99),
					new ExpectedCellValue(sheetName, 134, 9, 440.74),
					new ExpectedCellValue(sheetName, 135, 9, 856.49),
					new ExpectedCellValue(sheetName, 136, 9, null),
					new ExpectedCellValue(sheetName, 137, 9, null),
					new ExpectedCellValue(sheetName, 138, 9, 415.75),
					new ExpectedCellValue(sheetName, 139, 9, null),
					new ExpectedCellValue(sheetName, 140, 9, 831.5),
					new ExpectedCellValue(sheetName, 141, 9, 415.75),
					new ExpectedCellValue(sheetName, 142, 9, 831.5),
					new ExpectedCellValue(sheetName, 143, 9, null),
					new ExpectedCellValue(sheetName, 144, 9, 199d),
					new ExpectedCellValue(sheetName, 145, 9, null),
					new ExpectedCellValue(sheetName, 146, 9, 1194d),
					new ExpectedCellValue(sheetName, 147, 9, 199d),
					new ExpectedCellValue(sheetName, 148, 9, 1194d),
					new ExpectedCellValue(sheetName, 149, 9, null),
					new ExpectedCellValue(sheetName, 150, 9, 415.75),
					new ExpectedCellValue(sheetName, 151, 9, null),
					new ExpectedCellValue(sheetName, 152, 9, 831.5),
					new ExpectedCellValue(sheetName, 153, 9, 415.75),
					new ExpectedCellValue(sheetName, 154, 9, 831.5),
					new ExpectedCellValue(sheetName, 155, 9, 1030.5),
					new ExpectedCellValue(sheetName, 156, 9, 2857d),
					new ExpectedCellValue(sheetName, 157, 9, null),
					new ExpectedCellValue(sheetName, 158, 9, null),
					new ExpectedCellValue(sheetName, 159, 9, 415.75),
					new ExpectedCellValue(sheetName, 160, 9, null),
					new ExpectedCellValue(sheetName, 161, 9, 415.75),
					new ExpectedCellValue(sheetName, 162, 9, 415.75),
					new ExpectedCellValue(sheetName, 163, 9, 415.75),
					new ExpectedCellValue(sheetName, 164, 9, null),
					new ExpectedCellValue(sheetName, 165, 9, 99d),
					new ExpectedCellValue(sheetName, 166, 9, null),
					new ExpectedCellValue(sheetName, 167, 9, 99d),
					new ExpectedCellValue(sheetName, 168, 9, 99d),
					new ExpectedCellValue(sheetName, 169, 9, 99d),
					new ExpectedCellValue(sheetName, 170, 9, 514.75),
					new ExpectedCellValue(sheetName, 171, 9, 514.75),
					new ExpectedCellValue(sheetName, 172, 9, 1985.99),
					new ExpectedCellValue(sheetName, 173, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondFieldOnlySecondDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K120:M165"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 123, 11, "January"),
					new ExpectedCellValue(sheetName, 124, 11, "January Total"),
					new ExpectedCellValue(sheetName, 125, 11, "March"),
					new ExpectedCellValue(sheetName, 126, 11, "March Total"),
					new ExpectedCellValue(sheetName, 127, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 11, "January"),
					new ExpectedCellValue(sheetName, 129, 11, "January Total"),
					new ExpectedCellValue(sheetName, 130, 11, "March"),
					new ExpectedCellValue(sheetName, 131, 11, "March Total"),
					new ExpectedCellValue(sheetName, 132, 11, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 133, 11, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 134, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 135, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 136, 11, "January"),
					new ExpectedCellValue(sheetName, 137, 11, "January Total"),
					new ExpectedCellValue(sheetName, 138, 11, "February"),
					new ExpectedCellValue(sheetName, 139, 11, "February Total"),
					new ExpectedCellValue(sheetName, 140, 11, "March"),
					new ExpectedCellValue(sheetName, 141, 11, "March Total"),
					new ExpectedCellValue(sheetName, 142, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 11, "January"),
					new ExpectedCellValue(sheetName, 144, 11, "January Total"),
					new ExpectedCellValue(sheetName, 145, 11, "February"),
					new ExpectedCellValue(sheetName, 146, 11, "February Total"),
					new ExpectedCellValue(sheetName, 147, 11, "March"),
					new ExpectedCellValue(sheetName, 148, 11, "March Total"),
					new ExpectedCellValue(sheetName, 149, 11, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 150, 11, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 152, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 11, "January"),
					new ExpectedCellValue(sheetName, 154, 11, "January Total"),
					new ExpectedCellValue(sheetName, 155, 11, "February"),
					new ExpectedCellValue(sheetName, 156, 11, "February Total"),
					new ExpectedCellValue(sheetName, 157, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 158, 11, "January"),
					new ExpectedCellValue(sheetName, 159, 11, "January Total"),
					new ExpectedCellValue(sheetName, 160, 11, "February"),
					new ExpectedCellValue(sheetName, 161, 11, "February Total"),
					new ExpectedCellValue(sheetName, 162, 11, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 163, 11, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 164, 11, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 165, 11, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 12, "Item"),
					new ExpectedCellValue(sheetName, 121, 12, null),
					new ExpectedCellValue(sheetName, 122, 12, null),
					new ExpectedCellValue(sheetName, 123, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 12, null),
					new ExpectedCellValue(sheetName, 125, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 126, 12, null),
					new ExpectedCellValue(sheetName, 127, 12, null),
					new ExpectedCellValue(sheetName, 128, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 129, 12, null),
					new ExpectedCellValue(sheetName, 130, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 131, 12, null),
					new ExpectedCellValue(sheetName, 132, 12, null),
					new ExpectedCellValue(sheetName, 133, 12, null),
					new ExpectedCellValue(sheetName, 134, 12, null),
					new ExpectedCellValue(sheetName, 135, 12, null),
					new ExpectedCellValue(sheetName, 136, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 137, 12, null),
					new ExpectedCellValue(sheetName, 138, 12, "Tent"),
					new ExpectedCellValue(sheetName, 139, 12, null),
					new ExpectedCellValue(sheetName, 140, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 12, null),
					new ExpectedCellValue(sheetName, 142, 12, null),
					new ExpectedCellValue(sheetName, 143, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 12, null),
					new ExpectedCellValue(sheetName, 145, 12, "Tent"),
					new ExpectedCellValue(sheetName, 146, 12, null),
					new ExpectedCellValue(sheetName, 147, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 148, 12, null),
					new ExpectedCellValue(sheetName, 149, 12, null),
					new ExpectedCellValue(sheetName, 150, 12, null),
					new ExpectedCellValue(sheetName, 151, 12, null),
					new ExpectedCellValue(sheetName, 152, 12, null),
					new ExpectedCellValue(sheetName, 153, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 154, 12, null),
					new ExpectedCellValue(sheetName, 155, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 156, 12, null),
					new ExpectedCellValue(sheetName, 157, 12, null),
					new ExpectedCellValue(sheetName, 158, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 12, null),
					new ExpectedCellValue(sheetName, 160, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 161, 12, null),
					new ExpectedCellValue(sheetName, 162, 12, null),
					new ExpectedCellValue(sheetName, 163, 12, null),
					new ExpectedCellValue(sheetName, 164, 12, null),
					new ExpectedCellValue(sheetName, 165, 12, null),
					new ExpectedCellValue(sheetName, 120, 13, null),
					new ExpectedCellValue(sheetName, 121, 13, null),
					new ExpectedCellValue(sheetName, 122, 13, null),
					new ExpectedCellValue(sheetName, 123, 13, 415.75),
					new ExpectedCellValue(sheetName, 124, 13, 415.75),
					new ExpectedCellValue(sheetName, 125, 13, 24.99),
					new ExpectedCellValue(sheetName, 126, 13, 24.99),
					new ExpectedCellValue(sheetName, 127, 13, null),
					new ExpectedCellValue(sheetName, 128, 13, 831.5),
					new ExpectedCellValue(sheetName, 129, 13, 831.5),
					new ExpectedCellValue(sheetName, 130, 13, 24.99),
					new ExpectedCellValue(sheetName, 131, 13, 24.99),
					new ExpectedCellValue(sheetName, 132, 13, 440.74),
					new ExpectedCellValue(sheetName, 133, 13, 856.49),
					new ExpectedCellValue(sheetName, 134, 13, null),
					new ExpectedCellValue(sheetName, 135, 13, null),
					new ExpectedCellValue(sheetName, 136, 13, 415.75),
					new ExpectedCellValue(sheetName, 137, 13, 415.75),
					new ExpectedCellValue(sheetName, 138, 13, 199d),
					new ExpectedCellValue(sheetName, 139, 13, 199d),
					new ExpectedCellValue(sheetName, 140, 13, 415.75),
					new ExpectedCellValue(sheetName, 141, 13, 415.75),
					new ExpectedCellValue(sheetName, 142, 13, null),
					new ExpectedCellValue(sheetName, 143, 13, 831.5),
					new ExpectedCellValue(sheetName, 144, 13, 831.5),
					new ExpectedCellValue(sheetName, 145, 13, 1194d),
					new ExpectedCellValue(sheetName, 146, 13, 1194d),
					new ExpectedCellValue(sheetName, 147, 13, 831.5),
					new ExpectedCellValue(sheetName, 148, 13, 831.5),
					new ExpectedCellValue(sheetName, 149, 13, 1030.5),
					new ExpectedCellValue(sheetName, 150, 13, 2857d),
					new ExpectedCellValue(sheetName, 151, 13, null),
					new ExpectedCellValue(sheetName, 152, 13, null),
					new ExpectedCellValue(sheetName, 153, 13, 415.75),
					new ExpectedCellValue(sheetName, 154, 13, 415.75),
					new ExpectedCellValue(sheetName, 155, 13, 99d),
					new ExpectedCellValue(sheetName, 156, 13, 99d),
					new ExpectedCellValue(sheetName, 157, 13, null),
					new ExpectedCellValue(sheetName, 158, 13, 415.75),
					new ExpectedCellValue(sheetName, 159, 13, 415.75),
					new ExpectedCellValue(sheetName, 160, 13, 99d),
					new ExpectedCellValue(sheetName, 161, 13, 99d),
					new ExpectedCellValue(sheetName, 162, 13, 514.75),
					new ExpectedCellValue(sheetName, 163, 13, 514.75),
					new ExpectedCellValue(sheetName, 164, 13, 1985.99),
					new ExpectedCellValue(sheetName, 165, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondFieldOnlyFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O120:Q158"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 122, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 123, 15, "January"),
					new ExpectedCellValue(sheetName, 124, 15, "January Total"),
					new ExpectedCellValue(sheetName, 125, 15, "March"),
					new ExpectedCellValue(sheetName, 126, 15, "March Total"),
					new ExpectedCellValue(sheetName, 127, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 15, "January"),
					new ExpectedCellValue(sheetName, 129, 15, "January Total"),
					new ExpectedCellValue(sheetName, 130, 15, "February"),
					new ExpectedCellValue(sheetName, 131, 15, "February Total"),
					new ExpectedCellValue(sheetName, 132, 15, "March"),
					new ExpectedCellValue(sheetName, 133, 15, "March Total"),
					new ExpectedCellValue(sheetName, 134, 15, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 15, "January"),
					new ExpectedCellValue(sheetName, 136, 15, "January Total"),
					new ExpectedCellValue(sheetName, 137, 15, "February"),
					new ExpectedCellValue(sheetName, 138, 15, "February Total"),
					new ExpectedCellValue(sheetName, 139, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 141, 15, "January"),
					new ExpectedCellValue(sheetName, 142, 15, "January Total"),
					new ExpectedCellValue(sheetName, 143, 15, "March"),
					new ExpectedCellValue(sheetName, 144, 15, "March Total"),
					new ExpectedCellValue(sheetName, 145, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 146, 15, "January"),
					new ExpectedCellValue(sheetName, 147, 15, "January Total"),
					new ExpectedCellValue(sheetName, 148, 15, "February"),
					new ExpectedCellValue(sheetName, 149, 15, "February Total"),
					new ExpectedCellValue(sheetName, 150, 15, "March"),
					new ExpectedCellValue(sheetName, 151, 15, "March Total"),
					new ExpectedCellValue(sheetName, 152, 15, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 15, "January"),
					new ExpectedCellValue(sheetName, 154, 15, "January Total"),
					new ExpectedCellValue(sheetName, 155, 15, "February"),
					new ExpectedCellValue(sheetName, 156, 15, "February Total"),
					new ExpectedCellValue(sheetName, 157, 15, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 15, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 16, "Item"),
					new ExpectedCellValue(sheetName, 121, 16, null),
					new ExpectedCellValue(sheetName, 122, 16, null),
					new ExpectedCellValue(sheetName, 123, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 16, null),
					new ExpectedCellValue(sheetName, 125, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 126, 16, null),
					new ExpectedCellValue(sheetName, 127, 16, null),
					new ExpectedCellValue(sheetName, 128, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 129, 16, null),
					new ExpectedCellValue(sheetName, 130, 16, "Tent"),
					new ExpectedCellValue(sheetName, 131, 16, null),
					new ExpectedCellValue(sheetName, 132, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 133, 16, null),
					new ExpectedCellValue(sheetName, 134, 16, null),
					new ExpectedCellValue(sheetName, 135, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 16, null),
					new ExpectedCellValue(sheetName, 137, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 138, 16, null),
					new ExpectedCellValue(sheetName, 139, 16, null),
					new ExpectedCellValue(sheetName, 140, 16, null),
					new ExpectedCellValue(sheetName, 141, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 16, null),
					new ExpectedCellValue(sheetName, 143, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 144, 16, null),
					new ExpectedCellValue(sheetName, 145, 16, null),
					new ExpectedCellValue(sheetName, 146, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 16, null),
					new ExpectedCellValue(sheetName, 148, 16, "Tent"),
					new ExpectedCellValue(sheetName, 149, 16, null),
					new ExpectedCellValue(sheetName, 150, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 151, 16, null),
					new ExpectedCellValue(sheetName, 152, 16, null),
					new ExpectedCellValue(sheetName, 153, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 154, 16, null),
					new ExpectedCellValue(sheetName, 155, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 156, 16, null),
					new ExpectedCellValue(sheetName, 157, 16, null),
					new ExpectedCellValue(sheetName, 158, 16, null),
					new ExpectedCellValue(sheetName, 120, 17, null),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, 440.74),
					new ExpectedCellValue(sheetName, 123, 17, 415.75),
					new ExpectedCellValue(sheetName, 124, 17, 415.75),
					new ExpectedCellValue(sheetName, 125, 17, 24.99),
					new ExpectedCellValue(sheetName, 126, 17, 24.99),
					new ExpectedCellValue(sheetName, 127, 17, 1030.5),
					new ExpectedCellValue(sheetName, 128, 17, 415.75),
					new ExpectedCellValue(sheetName, 129, 17, 415.75),
					new ExpectedCellValue(sheetName, 130, 17, 199d),
					new ExpectedCellValue(sheetName, 131, 17, 199d),
					new ExpectedCellValue(sheetName, 132, 17, 415.75),
					new ExpectedCellValue(sheetName, 133, 17, 415.75),
					new ExpectedCellValue(sheetName, 134, 17, 514.75),
					new ExpectedCellValue(sheetName, 135, 17, 415.75),
					new ExpectedCellValue(sheetName, 136, 17, 415.75),
					new ExpectedCellValue(sheetName, 137, 17, 99d),
					new ExpectedCellValue(sheetName, 138, 17, 99d),
					new ExpectedCellValue(sheetName, 139, 17, null),
					new ExpectedCellValue(sheetName, 140, 17, 856.49),
					new ExpectedCellValue(sheetName, 141, 17, 831.5),
					new ExpectedCellValue(sheetName, 142, 17, 831.5),
					new ExpectedCellValue(sheetName, 143, 17, 24.99),
					new ExpectedCellValue(sheetName, 144, 17, 24.99),
					new ExpectedCellValue(sheetName, 145, 17, 2857d),
					new ExpectedCellValue(sheetName, 146, 17, 831.5),
					new ExpectedCellValue(sheetName, 147, 17, 831.5),
					new ExpectedCellValue(sheetName, 148, 17, 1194d),
					new ExpectedCellValue(sheetName, 149, 17, 1194d),
					new ExpectedCellValue(sheetName, 150, 17, 831.5),
					new ExpectedCellValue(sheetName, 151, 17, 831.5),
					new ExpectedCellValue(sheetName, 152, 17, 514.75),
					new ExpectedCellValue(sheetName, 153, 17, 415.75),
					new ExpectedCellValue(sheetName, 154, 17, 415.75),
					new ExpectedCellValue(sheetName, 155, 17, 99d),
					new ExpectedCellValue(sheetName, 156, 17, 99d),
					new ExpectedCellValue(sheetName, 157, 17, 1985.99),
					new ExpectedCellValue(sheetName, 158, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularThirdFieldOnlyLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B178:D224"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 178, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 179, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 180, 2, "January"),
					new ExpectedCellValue(sheetName, 181, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 182, 2, null),
					new ExpectedCellValue(sheetName, 183, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 184, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 185, 2, "March"),
					new ExpectedCellValue(sheetName, 186, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 187, 2, null),
					new ExpectedCellValue(sheetName, 188, 2, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 189, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 190, 2, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 191, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 193, 2, "January"),
					new ExpectedCellValue(sheetName, 194, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 195, 2, null),
					new ExpectedCellValue(sheetName, 196, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 197, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 198, 2, "February"),
					new ExpectedCellValue(sheetName, 199, 2, "Tent"),
					new ExpectedCellValue(sheetName, 200, 2, null),
					new ExpectedCellValue(sheetName, 201, 2, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 202, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 203, 2, "March"),
					new ExpectedCellValue(sheetName, 204, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 205, 2, null),
					new ExpectedCellValue(sheetName, 206, 2, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 208, 2, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 209, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 210, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 211, 2, "January"),
					new ExpectedCellValue(sheetName, 212, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 213, 2, null),
					new ExpectedCellValue(sheetName, 214, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 215, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 2, "February"),
					new ExpectedCellValue(sheetName, 217, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 218, 2, null),
					new ExpectedCellValue(sheetName, 219, 2, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 220, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 221, 2, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 222, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 178, 3, "Values"),
					new ExpectedCellValue(sheetName, 179, 3, null),
					new ExpectedCellValue(sheetName, 180, 3, null),
					new ExpectedCellValue(sheetName, 181, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 183, 3, null),
					new ExpectedCellValue(sheetName, 184, 3, null),
					new ExpectedCellValue(sheetName, 185, 3, null),
					new ExpectedCellValue(sheetName, 186, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 187, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 188, 3, null),
					new ExpectedCellValue(sheetName, 189, 3, null),
					new ExpectedCellValue(sheetName, 190, 3, null),
					new ExpectedCellValue(sheetName, 191, 3, null),
					new ExpectedCellValue(sheetName, 192, 3, null),
					new ExpectedCellValue(sheetName, 193, 3, null),
					new ExpectedCellValue(sheetName, 194, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 195, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 196, 3, null),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, null),
					new ExpectedCellValue(sheetName, 199, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 200, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, null),
					new ExpectedCellValue(sheetName, 203, 3, null),
					new ExpectedCellValue(sheetName, 204, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 205, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, null),
					new ExpectedCellValue(sheetName, 208, 3, null),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 210, 3, null),
					new ExpectedCellValue(sheetName, 211, 3, null),
					new ExpectedCellValue(sheetName, 212, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 213, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 214, 3, null),
					new ExpectedCellValue(sheetName, 215, 3, null),
					new ExpectedCellValue(sheetName, 216, 3, null),
					new ExpectedCellValue(sheetName, 217, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 219, 3, null),
					new ExpectedCellValue(sheetName, 220, 3, null),
					new ExpectedCellValue(sheetName, 221, 3, null),
					new ExpectedCellValue(sheetName, 222, 3, null),
					new ExpectedCellValue(sheetName, 223, 3, null),
					new ExpectedCellValue(sheetName, 224, 3, null),
					new ExpectedCellValue(sheetName, 178, 4, null),
					new ExpectedCellValue(sheetName, 179, 4, null),
					new ExpectedCellValue(sheetName, 180, 4, null),
					new ExpectedCellValue(sheetName, 181, 4, 415.75),
					new ExpectedCellValue(sheetName, 182, 4, 831.5),
					new ExpectedCellValue(sheetName, 183, 4, 415.75),
					new ExpectedCellValue(sheetName, 184, 4, 831.5),
					new ExpectedCellValue(sheetName, 185, 4, null),
					new ExpectedCellValue(sheetName, 186, 4, 24.99),
					new ExpectedCellValue(sheetName, 187, 4, 24.99),
					new ExpectedCellValue(sheetName, 188, 4, 24.99),
					new ExpectedCellValue(sheetName, 189, 4, 24.99),
					new ExpectedCellValue(sheetName, 190, 4, 440.74),
					new ExpectedCellValue(sheetName, 191, 4, 856.49),
					new ExpectedCellValue(sheetName, 192, 4, null),
					new ExpectedCellValue(sheetName, 193, 4, null),
					new ExpectedCellValue(sheetName, 194, 4, 415.75),
					new ExpectedCellValue(sheetName, 195, 4, 831.5),
					new ExpectedCellValue(sheetName, 196, 4, 415.75),
					new ExpectedCellValue(sheetName, 197, 4, 831.5),
					new ExpectedCellValue(sheetName, 198, 4, null),
					new ExpectedCellValue(sheetName, 199, 4, 199d),
					new ExpectedCellValue(sheetName, 200, 4, 1194d),
					new ExpectedCellValue(sheetName, 201, 4, 199d),
					new ExpectedCellValue(sheetName, 202, 4, 1194d),
					new ExpectedCellValue(sheetName, 203, 4, null),
					new ExpectedCellValue(sheetName, 204, 4, 415.75),
					new ExpectedCellValue(sheetName, 205, 4, 831.5),
					new ExpectedCellValue(sheetName, 206, 4, 415.75),
					new ExpectedCellValue(sheetName, 207, 4, 831.5),
					new ExpectedCellValue(sheetName, 208, 4, 1030.5),
					new ExpectedCellValue(sheetName, 209, 4, 2857d),
					new ExpectedCellValue(sheetName, 210, 4, null),
					new ExpectedCellValue(sheetName, 211, 4, null),
					new ExpectedCellValue(sheetName, 212, 4, 415.75),
					new ExpectedCellValue(sheetName, 213, 4, 415.75),
					new ExpectedCellValue(sheetName, 214, 4, 415.75),
					new ExpectedCellValue(sheetName, 215, 4, 415.75),
					new ExpectedCellValue(sheetName, 216, 4, null),
					new ExpectedCellValue(sheetName, 217, 4, 99d),
					new ExpectedCellValue(sheetName, 218, 4, 99d),
					new ExpectedCellValue(sheetName, 219, 4, 99d),
					new ExpectedCellValue(sheetName, 220, 4, 99d),
					new ExpectedCellValue(sheetName, 221, 4, 514.75),
					new ExpectedCellValue(sheetName, 222, 4, 514.75),
					new ExpectedCellValue(sheetName, 223, 4, 1985.99),
					new ExpectedCellValue(sheetName, 224, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularThirdFieldOnlyThirdDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G178:H238"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 178, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 179, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 180, 7, "January"),
					new ExpectedCellValue(sheetName, 181, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 187, 7, "March"),
					new ExpectedCellValue(sheetName, 188, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 189, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 190, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 191, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 192, 7, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 193, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 194, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 195, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 196, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 197, 7, "January"),
					new ExpectedCellValue(sheetName, 198, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 199, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 201, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 202, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 203, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 204, 7, "February"),
					new ExpectedCellValue(sheetName, 205, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 206, 7, "Tent"),
					new ExpectedCellValue(sheetName, 207, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 208, 7, "Tent"),
					new ExpectedCellValue(sheetName, 209, 7, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 210, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 211, 7, "March"),
					new ExpectedCellValue(sheetName, 212, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 213, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 214, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 215, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 216, 7, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 217, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 218, 7, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 219, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 220, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 221, 7, "January"),
					new ExpectedCellValue(sheetName, 222, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 223, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 224, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 225, 7, "Car Rack"),
					new ExpectedCellValue(sheetName, 226, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 227, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 228, 7, "February"),
					new ExpectedCellValue(sheetName, 229, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 230, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 231, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 232, 7, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 233, 7, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 234, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 235, 7, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 236, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 237, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 238, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 178, 8, null),
					new ExpectedCellValue(sheetName, 179, 8, null),
					new ExpectedCellValue(sheetName, 180, 8, null),
					new ExpectedCellValue(sheetName, 181, 8, null),
					new ExpectedCellValue(sheetName, 182, 8, 415.75),
					new ExpectedCellValue(sheetName, 183, 8, null),
					new ExpectedCellValue(sheetName, 184, 8, 831.5),
					new ExpectedCellValue(sheetName, 185, 8, 415.75),
					new ExpectedCellValue(sheetName, 186, 8, 831.5),
					new ExpectedCellValue(sheetName, 187, 8, null),
					new ExpectedCellValue(sheetName, 188, 8, null),
					new ExpectedCellValue(sheetName, 189, 8, 24.99),
					new ExpectedCellValue(sheetName, 190, 8, null),
					new ExpectedCellValue(sheetName, 191, 8, 24.99),
					new ExpectedCellValue(sheetName, 192, 8, 24.99),
					new ExpectedCellValue(sheetName, 193, 8, 24.99),
					new ExpectedCellValue(sheetName, 194, 8, 440.74),
					new ExpectedCellValue(sheetName, 195, 8, 856.49),
					new ExpectedCellValue(sheetName, 196, 8, null),
					new ExpectedCellValue(sheetName, 197, 8, null),
					new ExpectedCellValue(sheetName, 198, 8, null),
					new ExpectedCellValue(sheetName, 199, 8, 415.75),
					new ExpectedCellValue(sheetName, 200, 8, null),
					new ExpectedCellValue(sheetName, 201, 8, 831.5),
					new ExpectedCellValue(sheetName, 202, 8, 415.75),
					new ExpectedCellValue(sheetName, 203, 8, 831.5),
					new ExpectedCellValue(sheetName, 204, 8, null),
					new ExpectedCellValue(sheetName, 205, 8, null),
					new ExpectedCellValue(sheetName, 206, 8, 199d),
					new ExpectedCellValue(sheetName, 207, 8, null),
					new ExpectedCellValue(sheetName, 208, 8, 1194d),
					new ExpectedCellValue(sheetName, 209, 8, 199d),
					new ExpectedCellValue(sheetName, 210, 8, 1194d),
					new ExpectedCellValue(sheetName, 211, 8, null),
					new ExpectedCellValue(sheetName, 212, 8, null),
					new ExpectedCellValue(sheetName, 213, 8, 415.75),
					new ExpectedCellValue(sheetName, 214, 8, null),
					new ExpectedCellValue(sheetName, 215, 8, 831.5),
					new ExpectedCellValue(sheetName, 216, 8, 415.75),
					new ExpectedCellValue(sheetName, 217, 8, 831.5),
					new ExpectedCellValue(sheetName, 218, 8, 1030.5),
					new ExpectedCellValue(sheetName, 219, 8, 2857d),
					new ExpectedCellValue(sheetName, 220, 8, null),
					new ExpectedCellValue(sheetName, 221, 8, null),
					new ExpectedCellValue(sheetName, 222, 8, null),
					new ExpectedCellValue(sheetName, 223, 8, 415.75),
					new ExpectedCellValue(sheetName, 224, 8, null),
					new ExpectedCellValue(sheetName, 225, 8, 415.75),
					new ExpectedCellValue(sheetName, 226, 8, 415.75),
					new ExpectedCellValue(sheetName, 227, 8, 415.75),
					new ExpectedCellValue(sheetName, 228, 8, null),
					new ExpectedCellValue(sheetName, 229, 8, null),
					new ExpectedCellValue(sheetName, 230, 8, 99d),
					new ExpectedCellValue(sheetName, 231, 8, null),
					new ExpectedCellValue(sheetName, 232, 8, 99d),
					new ExpectedCellValue(sheetName, 233, 8, 99d),
					new ExpectedCellValue(sheetName, 234, 8, 99d),
					new ExpectedCellValue(sheetName, 235, 8, 514.75),
					new ExpectedCellValue(sheetName, 236, 8, 514.75),
					new ExpectedCellValue(sheetName, 237, 8, 1985.99),
					new ExpectedCellValue(sheetName, 238, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularThirdFieldOnlySecondDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J178:K223"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 178, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 179, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 180, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 181, 10, "January"),
					new ExpectedCellValue(sheetName, 182, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 10, "March"),
					new ExpectedCellValue(sheetName, 184, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 185, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 186, 10, "January"),
					new ExpectedCellValue(sheetName, 187, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 188, 10, "March"),
					new ExpectedCellValue(sheetName, 189, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 190, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 191, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 193, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 10, "January"),
					new ExpectedCellValue(sheetName, 195, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 196, 10, "February"),
					new ExpectedCellValue(sheetName, 197, 10, "Tent"),
					new ExpectedCellValue(sheetName, 198, 10, "March"),
					new ExpectedCellValue(sheetName, 199, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 201, 10, "January"),
					new ExpectedCellValue(sheetName, 202, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 203, 10, "February"),
					new ExpectedCellValue(sheetName, 204, 10, "Tent"),
					new ExpectedCellValue(sheetName, 205, 10, "March"),
					new ExpectedCellValue(sheetName, 206, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 207, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 208, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 209, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 210, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 211, 10, "January"),
					new ExpectedCellValue(sheetName, 212, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 213, 10, "February"),
					new ExpectedCellValue(sheetName, 214, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 215, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 10, "January"),
					new ExpectedCellValue(sheetName, 217, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 218, 10, "February"),
					new ExpectedCellValue(sheetName, 219, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 220, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 221, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 222, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 223, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 178, 11, null),
					new ExpectedCellValue(sheetName, 179, 11, null),
					new ExpectedCellValue(sheetName, 180, 11, null),
					new ExpectedCellValue(sheetName, 181, 11, 415.75),
					new ExpectedCellValue(sheetName, 182, 11, 415.75),
					new ExpectedCellValue(sheetName, 183, 11, 24.99),
					new ExpectedCellValue(sheetName, 184, 11, 24.99),
					new ExpectedCellValue(sheetName, 185, 11, null),
					new ExpectedCellValue(sheetName, 186, 11, 831.5),
					new ExpectedCellValue(sheetName, 187, 11, 831.5),
					new ExpectedCellValue(sheetName, 188, 11, 24.99),
					new ExpectedCellValue(sheetName, 189, 11, 24.99),
					new ExpectedCellValue(sheetName, 190, 11, 440.74),
					new ExpectedCellValue(sheetName, 191, 11, 856.49),
					new ExpectedCellValue(sheetName, 192, 11, null),
					new ExpectedCellValue(sheetName, 193, 11, null),
					new ExpectedCellValue(sheetName, 194, 11, 415.75),
					new ExpectedCellValue(sheetName, 195, 11, 415.75),
					new ExpectedCellValue(sheetName, 196, 11, 199d),
					new ExpectedCellValue(sheetName, 197, 11, 199d),
					new ExpectedCellValue(sheetName, 198, 11, 415.75),
					new ExpectedCellValue(sheetName, 199, 11, 415.75),
					new ExpectedCellValue(sheetName, 200, 11, null),
					new ExpectedCellValue(sheetName, 201, 11, 831.5),
					new ExpectedCellValue(sheetName, 202, 11, 831.5),
					new ExpectedCellValue(sheetName, 203, 11, 1194d),
					new ExpectedCellValue(sheetName, 204, 11, 1194d),
					new ExpectedCellValue(sheetName, 205, 11, 831.5),
					new ExpectedCellValue(sheetName, 206, 11, 831.5),
					new ExpectedCellValue(sheetName, 207, 11, 1030.5),
					new ExpectedCellValue(sheetName, 208, 11, 2857d),
					new ExpectedCellValue(sheetName, 209, 11, null),
					new ExpectedCellValue(sheetName, 210, 11, null),
					new ExpectedCellValue(sheetName, 211, 11, 415.75),
					new ExpectedCellValue(sheetName, 212, 11, 415.75),
					new ExpectedCellValue(sheetName, 213, 11, 99d),
					new ExpectedCellValue(sheetName, 214, 11, 99d),
					new ExpectedCellValue(sheetName, 215, 11, null),
					new ExpectedCellValue(sheetName, 216, 11, 415.75),
					new ExpectedCellValue(sheetName, 217, 11, 415.75),
					new ExpectedCellValue(sheetName, 218, 11, 99d),
					new ExpectedCellValue(sheetName, 219, 11, 99d),
					new ExpectedCellValue(sheetName, 220, 11, 514.75),
					new ExpectedCellValue(sheetName, 221, 11, 514.75),
					new ExpectedCellValue(sheetName, 222, 11, 1985.99),
					new ExpectedCellValue(sheetName, 223, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularThirdFieldOnlyFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable16"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M178:N216"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 178, 13, "Row Labels"),
					new ExpectedCellValue(sheetName, 179, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 180, 13, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 13, "January"),
					new ExpectedCellValue(sheetName, 182, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 13, "March"),
					new ExpectedCellValue(sheetName, 184, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 185, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 186, 13, "January"),
					new ExpectedCellValue(sheetName, 187, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 188, 13, "February"),
					new ExpectedCellValue(sheetName, 189, 13, "Tent"),
					new ExpectedCellValue(sheetName, 190, 13, "March"),
					new ExpectedCellValue(sheetName, 191, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 13, "San Francisco"),
					new ExpectedCellValue(sheetName, 193, 13, "January"),
					new ExpectedCellValue(sheetName, 194, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 195, 13, "February"),
					new ExpectedCellValue(sheetName, 196, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 197, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 198, 13, "Chicago"),
					new ExpectedCellValue(sheetName, 199, 13, "January"),
					new ExpectedCellValue(sheetName, 200, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 201, 13, "March"),
					new ExpectedCellValue(sheetName, 202, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 203, 13, "Nashville"),
					new ExpectedCellValue(sheetName, 204, 13, "January"),
					new ExpectedCellValue(sheetName, 205, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 206, 13, "February"),
					new ExpectedCellValue(sheetName, 207, 13, "Tent"),
					new ExpectedCellValue(sheetName, 208, 13, "March"),
					new ExpectedCellValue(sheetName, 209, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 13, "San Francisco"),
					new ExpectedCellValue(sheetName, 211, 13, "January"),
					new ExpectedCellValue(sheetName, 212, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 213, 13, "February"),
					new ExpectedCellValue(sheetName, 214, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 215, 13, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 216, 13, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 178, 14, null),
					new ExpectedCellValue(sheetName, 179, 14, null),
					new ExpectedCellValue(sheetName, 180, 14, 440.74),
					new ExpectedCellValue(sheetName, 181, 14, 415.75),
					new ExpectedCellValue(sheetName, 182, 14, 415.75),
					new ExpectedCellValue(sheetName, 183, 14, 24.99),
					new ExpectedCellValue(sheetName, 184, 14, 24.99),
					new ExpectedCellValue(sheetName, 185, 14, 1030.5),
					new ExpectedCellValue(sheetName, 186, 14, 415.75),
					new ExpectedCellValue(sheetName, 187, 14, 415.75),
					new ExpectedCellValue(sheetName, 188, 14, 199d),
					new ExpectedCellValue(sheetName, 189, 14, 199d),
					new ExpectedCellValue(sheetName, 190, 14, 415.75),
					new ExpectedCellValue(sheetName, 191, 14, 415.75),
					new ExpectedCellValue(sheetName, 192, 14, 514.75),
					new ExpectedCellValue(sheetName, 193, 14, 415.75),
					new ExpectedCellValue(sheetName, 194, 14, 415.75),
					new ExpectedCellValue(sheetName, 195, 14, 99d),
					new ExpectedCellValue(sheetName, 196, 14, 99d),
					new ExpectedCellValue(sheetName, 197, 14, null),
					new ExpectedCellValue(sheetName, 198, 14, 856.49),
					new ExpectedCellValue(sheetName, 199, 14, 831.5),
					new ExpectedCellValue(sheetName, 200, 14, 831.5),
					new ExpectedCellValue(sheetName, 201, 14, 24.99),
					new ExpectedCellValue(sheetName, 202, 14, 24.99),
					new ExpectedCellValue(sheetName, 203, 14, 2857d),
					new ExpectedCellValue(sheetName, 204, 14, 831.5),
					new ExpectedCellValue(sheetName, 205, 14, 831.5),
					new ExpectedCellValue(sheetName, 206, 14, 1194d),
					new ExpectedCellValue(sheetName, 207, 14, 1194d),
					new ExpectedCellValue(sheetName, 208, 14, 831.5),
					new ExpectedCellValue(sheetName, 209, 14, 831.5),
					new ExpectedCellValue(sheetName, 210, 14, 514.75),
					new ExpectedCellValue(sheetName, 211, 14, 415.75),
					new ExpectedCellValue(sheetName, 212, 14, 415.75),
					new ExpectedCellValue(sheetName, 213, 14, 99d),
					new ExpectedCellValue(sheetName, 214, 14, 99d),
					new ExpectedCellValue(sheetName, 215, 14, 1985.99),
					new ExpectedCellValue(sheetName, 216, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndSecondFieldsLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable17"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B242:E285"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 242, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 243, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 244, 2, null),
					new ExpectedCellValue(sheetName, 245, 2, null),
					new ExpectedCellValue(sheetName, 246, 2, null),
					new ExpectedCellValue(sheetName, 247, 2, null),
					new ExpectedCellValue(sheetName, 248, 2, null),
					new ExpectedCellValue(sheetName, 249, 2, null),
					new ExpectedCellValue(sheetName, 250, 2, null),
					new ExpectedCellValue(sheetName, 251, 2, null),
					new ExpectedCellValue(sheetName, 252, 2, null),
					new ExpectedCellValue(sheetName, 253, 2, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 254, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 255, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 256, 2, null),
					new ExpectedCellValue(sheetName, 257, 2, null),
					new ExpectedCellValue(sheetName, 258, 2, null),
					new ExpectedCellValue(sheetName, 259, 2, null),
					new ExpectedCellValue(sheetName, 260, 2, null),
					new ExpectedCellValue(sheetName, 261, 2, null),
					new ExpectedCellValue(sheetName, 262, 2, null),
					new ExpectedCellValue(sheetName, 263, 2, null),
					new ExpectedCellValue(sheetName, 264, 2, null),
					new ExpectedCellValue(sheetName, 265, 2, null),
					new ExpectedCellValue(sheetName, 266, 2, null),
					new ExpectedCellValue(sheetName, 267, 2, null),
					new ExpectedCellValue(sheetName, 268, 2, null),
					new ExpectedCellValue(sheetName, 269, 2, null),
					new ExpectedCellValue(sheetName, 270, 2, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 271, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 272, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 273, 2, null),
					new ExpectedCellValue(sheetName, 274, 2, null),
					new ExpectedCellValue(sheetName, 275, 2, null),
					new ExpectedCellValue(sheetName, 276, 2, null),
					new ExpectedCellValue(sheetName, 277, 2, null),
					new ExpectedCellValue(sheetName, 278, 2, null),
					new ExpectedCellValue(sheetName, 279, 2, null),
					new ExpectedCellValue(sheetName, 280, 2, null),
					new ExpectedCellValue(sheetName, 281, 2, null),
					new ExpectedCellValue(sheetName, 282, 2, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 283, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 284, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 285, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 242, 3, "Month"),
					new ExpectedCellValue(sheetName, 243, 3, "January"),
					new ExpectedCellValue(sheetName, 244, 3, null),
					new ExpectedCellValue(sheetName, 245, 3, null),
					new ExpectedCellValue(sheetName, 246, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 247, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 248, 3, "March"),
					new ExpectedCellValue(sheetName, 249, 3, null),
					new ExpectedCellValue(sheetName, 250, 3, null),
					new ExpectedCellValue(sheetName, 251, 3, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 252, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 3, null),
					new ExpectedCellValue(sheetName, 254, 3, null),
					new ExpectedCellValue(sheetName, 255, 3, "January"),
					new ExpectedCellValue(sheetName, 256, 3, null),
					new ExpectedCellValue(sheetName, 257, 3, null),
					new ExpectedCellValue(sheetName, 258, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 259, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 260, 3, "February"),
					new ExpectedCellValue(sheetName, 261, 3, null),
					new ExpectedCellValue(sheetName, 262, 3, null),
					new ExpectedCellValue(sheetName, 263, 3, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 264, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 265, 3, "March"),
					new ExpectedCellValue(sheetName, 266, 3, null),
					new ExpectedCellValue(sheetName, 267, 3, null),
					new ExpectedCellValue(sheetName, 268, 3, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 269, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 270, 3, null),
					new ExpectedCellValue(sheetName, 271, 3, null),
					new ExpectedCellValue(sheetName, 272, 3, "January"),
					new ExpectedCellValue(sheetName, 273, 3, null),
					new ExpectedCellValue(sheetName, 274, 3, null),
					new ExpectedCellValue(sheetName, 275, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 276, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 277, 3, "February"),
					new ExpectedCellValue(sheetName, 278, 3, null),
					new ExpectedCellValue(sheetName, 279, 3, null),
					new ExpectedCellValue(sheetName, 280, 3, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 281, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 282, 3, null),
					new ExpectedCellValue(sheetName, 283, 3, null),
					new ExpectedCellValue(sheetName, 284, 3, null),
					new ExpectedCellValue(sheetName, 285, 3, null),
					new ExpectedCellValue(sheetName, 242, 4, "Item"),
					new ExpectedCellValue(sheetName, 243, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 244, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 245, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 246, 4, null),
					new ExpectedCellValue(sheetName, 247, 4, null),
					new ExpectedCellValue(sheetName, 248, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 249, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 250, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 4, null),
					new ExpectedCellValue(sheetName, 252, 4, null),
					new ExpectedCellValue(sheetName, 253, 4, null),
					new ExpectedCellValue(sheetName, 254, 4, null),
					new ExpectedCellValue(sheetName, 255, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 256, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 257, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 258, 4, null),
					new ExpectedCellValue(sheetName, 259, 4, null),
					new ExpectedCellValue(sheetName, 260, 4, "Tent"),
					new ExpectedCellValue(sheetName, 261, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 262, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 263, 4, null),
					new ExpectedCellValue(sheetName, 264, 4, null),
					new ExpectedCellValue(sheetName, 265, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 266, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 267, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 268, 4, null),
					new ExpectedCellValue(sheetName, 269, 4, null),
					new ExpectedCellValue(sheetName, 270, 4, null),
					new ExpectedCellValue(sheetName, 271, 4, null),
					new ExpectedCellValue(sheetName, 272, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 273, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 274, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 275, 4, null),
					new ExpectedCellValue(sheetName, 276, 4, null),
					new ExpectedCellValue(sheetName, 277, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 278, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 279, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 280, 4, null),
					new ExpectedCellValue(sheetName, 281, 4, null),
					new ExpectedCellValue(sheetName, 282, 4, null),
					new ExpectedCellValue(sheetName, 283, 4, null),
					new ExpectedCellValue(sheetName, 284, 4, null),
					new ExpectedCellValue(sheetName, 285, 4, null),
					new ExpectedCellValue(sheetName, 242, 5, null),
					new ExpectedCellValue(sheetName, 243, 5, null),
					new ExpectedCellValue(sheetName, 244, 5, 415.75),
					new ExpectedCellValue(sheetName, 245, 5, 831.5),
					new ExpectedCellValue(sheetName, 246, 5, 415.75),
					new ExpectedCellValue(sheetName, 247, 5, 831.5),
					new ExpectedCellValue(sheetName, 248, 5, null),
					new ExpectedCellValue(sheetName, 249, 5, 24.99),
					new ExpectedCellValue(sheetName, 250, 5, 24.99),
					new ExpectedCellValue(sheetName, 251, 5, 24.99),
					new ExpectedCellValue(sheetName, 252, 5, 24.99),
					new ExpectedCellValue(sheetName, 253, 5, 440.74),
					new ExpectedCellValue(sheetName, 254, 5, 856.49),
					new ExpectedCellValue(sheetName, 255, 5, null),
					new ExpectedCellValue(sheetName, 256, 5, 415.75),
					new ExpectedCellValue(sheetName, 257, 5, 831.5),
					new ExpectedCellValue(sheetName, 258, 5, 415.75),
					new ExpectedCellValue(sheetName, 259, 5, 831.5),
					new ExpectedCellValue(sheetName, 260, 5, null),
					new ExpectedCellValue(sheetName, 261, 5, 199d),
					new ExpectedCellValue(sheetName, 262, 5, 1194d),
					new ExpectedCellValue(sheetName, 263, 5, 199d),
					new ExpectedCellValue(sheetName, 264, 5, 1194d),
					new ExpectedCellValue(sheetName, 265, 5, null),
					new ExpectedCellValue(sheetName, 266, 5, 415.75),
					new ExpectedCellValue(sheetName, 267, 5, 831.5),
					new ExpectedCellValue(sheetName, 268, 5, 415.75),
					new ExpectedCellValue(sheetName, 269, 5, 831.5),
					new ExpectedCellValue(sheetName, 270, 5, 1030.5),
					new ExpectedCellValue(sheetName, 271, 5, 2857d),
					new ExpectedCellValue(sheetName, 272, 5, null),
					new ExpectedCellValue(sheetName, 273, 5, 415.75),
					new ExpectedCellValue(sheetName, 274, 5, 415.75),
					new ExpectedCellValue(sheetName, 275, 5, 415.75),
					new ExpectedCellValue(sheetName, 276, 5, 415.75),
					new ExpectedCellValue(sheetName, 277, 5, null),
					new ExpectedCellValue(sheetName, 278, 5, 99d),
					new ExpectedCellValue(sheetName, 279, 5, 99d),
					new ExpectedCellValue(sheetName, 280, 5, 99d),
					new ExpectedCellValue(sheetName, 281, 5, 99d),
					new ExpectedCellValue(sheetName, 282, 5, 514.75),
					new ExpectedCellValue(sheetName, 283, 5, 514.75),
					new ExpectedCellValue(sheetName, 284, 5, 1985.99),
					new ExpectedCellValue(sheetName, 285, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndSecondFieldsThirdDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable18"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G242:J292"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 242, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 243, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 244, 7, null),
					new ExpectedCellValue(sheetName, 245, 7, null),
					new ExpectedCellValue(sheetName, 246, 7, null),
					new ExpectedCellValue(sheetName, 247, 7, null),
					new ExpectedCellValue(sheetName, 248, 7, null),
					new ExpectedCellValue(sheetName, 249, 7, null),
					new ExpectedCellValue(sheetName, 250, 7, null),
					new ExpectedCellValue(sheetName, 251, 7, null),
					new ExpectedCellValue(sheetName, 252, 7, null),
					new ExpectedCellValue(sheetName, 253, 7, null),
					new ExpectedCellValue(sheetName, 254, 7, null),
					new ExpectedCellValue(sheetName, 255, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 257, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 258, 7, null),
					new ExpectedCellValue(sheetName, 259, 7, null),
					new ExpectedCellValue(sheetName, 260, 7, null),
					new ExpectedCellValue(sheetName, 261, 7, null),
					new ExpectedCellValue(sheetName, 262, 7, null),
					new ExpectedCellValue(sheetName, 263, 7, null),
					new ExpectedCellValue(sheetName, 264, 7, null),
					new ExpectedCellValue(sheetName, 265, 7, null),
					new ExpectedCellValue(sheetName, 266, 7, null),
					new ExpectedCellValue(sheetName, 267, 7, null),
					new ExpectedCellValue(sheetName, 268, 7, null),
					new ExpectedCellValue(sheetName, 269, 7, null),
					new ExpectedCellValue(sheetName, 270, 7, null),
					new ExpectedCellValue(sheetName, 271, 7, null),
					new ExpectedCellValue(sheetName, 272, 7, null),
					new ExpectedCellValue(sheetName, 273, 7, null),
					new ExpectedCellValue(sheetName, 274, 7, null),
					new ExpectedCellValue(sheetName, 275, 7, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 276, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 277, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 278, 7, null),
					new ExpectedCellValue(sheetName, 279, 7, null),
					new ExpectedCellValue(sheetName, 280, 7, null),
					new ExpectedCellValue(sheetName, 281, 7, null),
					new ExpectedCellValue(sheetName, 282, 7, null),
					new ExpectedCellValue(sheetName, 283, 7, null),
					new ExpectedCellValue(sheetName, 284, 7, null),
					new ExpectedCellValue(sheetName, 285, 7, null),
					new ExpectedCellValue(sheetName, 286, 7, null),
					new ExpectedCellValue(sheetName, 287, 7, null),
					new ExpectedCellValue(sheetName, 288, 7, null),
					new ExpectedCellValue(sheetName, 289, 7, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 290, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 292, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 242, 8, "Month"),
					new ExpectedCellValue(sheetName, 243, 8, "January"),
					new ExpectedCellValue(sheetName, 244, 8, null),
					new ExpectedCellValue(sheetName, 245, 8, null),
					new ExpectedCellValue(sheetName, 246, 8, null),
					new ExpectedCellValue(sheetName, 247, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 248, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 249, 8, "March"),
					new ExpectedCellValue(sheetName, 250, 8, null),
					new ExpectedCellValue(sheetName, 251, 8, null),
					new ExpectedCellValue(sheetName, 252, 8, null),
					new ExpectedCellValue(sheetName, 253, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 254, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 255, 8, null),
					new ExpectedCellValue(sheetName, 256, 8, null),
					new ExpectedCellValue(sheetName, 257, 8, "January"),
					new ExpectedCellValue(sheetName, 258, 8, null),
					new ExpectedCellValue(sheetName, 259, 8, null),
					new ExpectedCellValue(sheetName, 260, 8, null),
					new ExpectedCellValue(sheetName, 261, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 262, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 263, 8, "February"),
					new ExpectedCellValue(sheetName, 264, 8, null),
					new ExpectedCellValue(sheetName, 265, 8, null),
					new ExpectedCellValue(sheetName, 266, 8, null),
					new ExpectedCellValue(sheetName, 267, 8, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 268, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 269, 8, "March"),
					new ExpectedCellValue(sheetName, 270, 8, null),
					new ExpectedCellValue(sheetName, 271, 8, null),
					new ExpectedCellValue(sheetName, 272, 8, null),
					new ExpectedCellValue(sheetName, 273, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 274, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 275, 8, null),
					new ExpectedCellValue(sheetName, 276, 8, null),
					new ExpectedCellValue(sheetName, 277, 8, "January"),
					new ExpectedCellValue(sheetName, 278, 8, null),
					new ExpectedCellValue(sheetName, 279, 8, null),
					new ExpectedCellValue(sheetName, 280, 8, null),
					new ExpectedCellValue(sheetName, 281, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 282, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 283, 8, "February"),
					new ExpectedCellValue(sheetName, 284, 8, null),
					new ExpectedCellValue(sheetName, 285, 8, null),
					new ExpectedCellValue(sheetName, 286, 8, null),
					new ExpectedCellValue(sheetName, 287, 8, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 288, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 289, 8, null),
					new ExpectedCellValue(sheetName, 290, 8, null),
					new ExpectedCellValue(sheetName, 291, 8, null),
					new ExpectedCellValue(sheetName, 292, 8, null),
					new ExpectedCellValue(sheetName, 242, 9, "Values"),
					new ExpectedCellValue(sheetName, 243, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 244, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 245, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 246, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 247, 9, null),
					new ExpectedCellValue(sheetName, 248, 9, null),
					new ExpectedCellValue(sheetName, 249, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 250, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 251, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 252, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 253, 9, null),
					new ExpectedCellValue(sheetName, 254, 9, null),
					new ExpectedCellValue(sheetName, 255, 9, null),
					new ExpectedCellValue(sheetName, 256, 9, null),
					new ExpectedCellValue(sheetName, 257, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 258, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 259, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 260, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 261, 9, null),
					new ExpectedCellValue(sheetName, 262, 9, null),
					new ExpectedCellValue(sheetName, 263, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 264, 9, "Tent"),
					new ExpectedCellValue(sheetName, 265, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 266, 9, "Tent"),
					new ExpectedCellValue(sheetName, 267, 9, null),
					new ExpectedCellValue(sheetName, 268, 9, null),
					new ExpectedCellValue(sheetName, 269, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 270, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 272, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 273, 9, null),
					new ExpectedCellValue(sheetName, 274, 9, null),
					new ExpectedCellValue(sheetName, 275, 9, null),
					new ExpectedCellValue(sheetName, 276, 9, null),
					new ExpectedCellValue(sheetName, 277, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 278, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 279, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 280, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 281, 9, null),
					new ExpectedCellValue(sheetName, 282, 9, null),
					new ExpectedCellValue(sheetName, 283, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 285, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 286, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 287, 9, null),
					new ExpectedCellValue(sheetName, 288, 9, null),
					new ExpectedCellValue(sheetName, 289, 9, null),
					new ExpectedCellValue(sheetName, 290, 9, null),
					new ExpectedCellValue(sheetName, 291, 9, null),
					new ExpectedCellValue(sheetName, 292, 9, null),
					new ExpectedCellValue(sheetName, 242, 10, null),
					new ExpectedCellValue(sheetName, 243, 10, null),
					new ExpectedCellValue(sheetName, 244, 10, 415.75),
					new ExpectedCellValue(sheetName, 245, 10, null),
					new ExpectedCellValue(sheetName, 246, 10, 831.5),
					new ExpectedCellValue(sheetName, 247, 10, 415.75),
					new ExpectedCellValue(sheetName, 248, 10, 831.5),
					new ExpectedCellValue(sheetName, 249, 10, null),
					new ExpectedCellValue(sheetName, 250, 10, 24.99),
					new ExpectedCellValue(sheetName, 251, 10, null),
					new ExpectedCellValue(sheetName, 252, 10, 24.99),
					new ExpectedCellValue(sheetName, 253, 10, 24.99),
					new ExpectedCellValue(sheetName, 254, 10, 24.99),
					new ExpectedCellValue(sheetName, 255, 10, 440.74),
					new ExpectedCellValue(sheetName, 256, 10, 856.49),
					new ExpectedCellValue(sheetName, 257, 10, null),
					new ExpectedCellValue(sheetName, 258, 10, 415.75),
					new ExpectedCellValue(sheetName, 259, 10, null),
					new ExpectedCellValue(sheetName, 260, 10, 831.5),
					new ExpectedCellValue(sheetName, 261, 10, 415.75),
					new ExpectedCellValue(sheetName, 262, 10, 831.5),
					new ExpectedCellValue(sheetName, 263, 10, null),
					new ExpectedCellValue(sheetName, 264, 10, 199d),
					new ExpectedCellValue(sheetName, 265, 10, null),
					new ExpectedCellValue(sheetName, 266, 10, 1194d),
					new ExpectedCellValue(sheetName, 267, 10, 199d),
					new ExpectedCellValue(sheetName, 268, 10, 1194d),
					new ExpectedCellValue(sheetName, 269, 10, null),
					new ExpectedCellValue(sheetName, 270, 10, 415.75),
					new ExpectedCellValue(sheetName, 271, 10, null),
					new ExpectedCellValue(sheetName, 272, 10, 831.5),
					new ExpectedCellValue(sheetName, 273, 10, 415.75),
					new ExpectedCellValue(sheetName, 274, 10, 831.5),
					new ExpectedCellValue(sheetName, 275, 10, 1030.5),
					new ExpectedCellValue(sheetName, 276, 10, 2857d),
					new ExpectedCellValue(sheetName, 277, 10, null),
					new ExpectedCellValue(sheetName, 278, 10, 415.75),
					new ExpectedCellValue(sheetName, 279, 10, null),
					new ExpectedCellValue(sheetName, 280, 10, 415.75),
					new ExpectedCellValue(sheetName, 281, 10, 415.75),
					new ExpectedCellValue(sheetName, 282, 10, 415.75),
					new ExpectedCellValue(sheetName, 283, 10, null),
					new ExpectedCellValue(sheetName, 284, 10, 99d),
					new ExpectedCellValue(sheetName, 285, 10, null),
					new ExpectedCellValue(sheetName, 286, 10, 99d),
					new ExpectedCellValue(sheetName, 287, 10, 99d),
					new ExpectedCellValue(sheetName, 288, 10, 99d),
					new ExpectedCellValue(sheetName, 289, 10, 514.75),
					new ExpectedCellValue(sheetName, 290, 10, 514.75),
					new ExpectedCellValue(sheetName, 291, 10, 1985.99),
					new ExpectedCellValue(sheetName, 292, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndSecondFieldsSecondDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable19"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L242:O284"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 242, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 243, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 244, 12, null),
					new ExpectedCellValue(sheetName, 245, 12, null),
					new ExpectedCellValue(sheetName, 246, 12, null),
					new ExpectedCellValue(sheetName, 247, 12, null),
					new ExpectedCellValue(sheetName, 248, 12, null),
					new ExpectedCellValue(sheetName, 249, 12, null),
					new ExpectedCellValue(sheetName, 250, 12, null),
					new ExpectedCellValue(sheetName, 251, 12, null),
					new ExpectedCellValue(sheetName, 252, 12, null),
					new ExpectedCellValue(sheetName, 253, 12, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 254, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 255, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 256, 12, null),
					new ExpectedCellValue(sheetName, 257, 12, null),
					new ExpectedCellValue(sheetName, 258, 12, null),
					new ExpectedCellValue(sheetName, 259, 12, null),
					new ExpectedCellValue(sheetName, 260, 12, null),
					new ExpectedCellValue(sheetName, 261, 12, null),
					new ExpectedCellValue(sheetName, 262, 12, null),
					new ExpectedCellValue(sheetName, 263, 12, null),
					new ExpectedCellValue(sheetName, 264, 12, null),
					new ExpectedCellValue(sheetName, 265, 12, null),
					new ExpectedCellValue(sheetName, 266, 12, null),
					new ExpectedCellValue(sheetName, 267, 12, null),
					new ExpectedCellValue(sheetName, 268, 12, null),
					new ExpectedCellValue(sheetName, 269, 12, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 270, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 271, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 272, 12, null),
					new ExpectedCellValue(sheetName, 273, 12, null),
					new ExpectedCellValue(sheetName, 274, 12, null),
					new ExpectedCellValue(sheetName, 275, 12, null),
					new ExpectedCellValue(sheetName, 276, 12, null),
					new ExpectedCellValue(sheetName, 277, 12, null),
					new ExpectedCellValue(sheetName, 278, 12, null),
					new ExpectedCellValue(sheetName, 279, 12, null),
					new ExpectedCellValue(sheetName, 280, 12, null),
					new ExpectedCellValue(sheetName, 281, 12, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 282, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 283, 12, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 242, 13, "Values"),
					new ExpectedCellValue(sheetName, 243, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 244, 13, "January"),
					new ExpectedCellValue(sheetName, 245, 13, "January Total"),
					new ExpectedCellValue(sheetName, 246, 13, "March"),
					new ExpectedCellValue(sheetName, 247, 13, "March Total"),
					new ExpectedCellValue(sheetName, 248, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 249, 13, "January"),
					new ExpectedCellValue(sheetName, 250, 13, "January Total"),
					new ExpectedCellValue(sheetName, 251, 13, "March"),
					new ExpectedCellValue(sheetName, 252, 13, "March Total"),
					new ExpectedCellValue(sheetName, 253, 13, null),
					new ExpectedCellValue(sheetName, 254, 13, null),
					new ExpectedCellValue(sheetName, 255, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 13, "January"),
					new ExpectedCellValue(sheetName, 257, 13, "January Total"),
					new ExpectedCellValue(sheetName, 258, 13, "February"),
					new ExpectedCellValue(sheetName, 259, 13, "February Total"),
					new ExpectedCellValue(sheetName, 260, 13, "March"),
					new ExpectedCellValue(sheetName, 261, 13, "March Total"),
					new ExpectedCellValue(sheetName, 262, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 263, 13, "January"),
					new ExpectedCellValue(sheetName, 264, 13, "January Total"),
					new ExpectedCellValue(sheetName, 265, 13, "February"),
					new ExpectedCellValue(sheetName, 266, 13, "February Total"),
					new ExpectedCellValue(sheetName, 267, 13, "March"),
					new ExpectedCellValue(sheetName, 268, 13, "March Total"),
					new ExpectedCellValue(sheetName, 269, 13, null),
					new ExpectedCellValue(sheetName, 270, 13, null),
					new ExpectedCellValue(sheetName, 271, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 272, 13, "January"),
					new ExpectedCellValue(sheetName, 273, 13, "January Total"),
					new ExpectedCellValue(sheetName, 274, 13, "February"),
					new ExpectedCellValue(sheetName, 275, 13, "February Total"),
					new ExpectedCellValue(sheetName, 276, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 277, 13, "January"),
					new ExpectedCellValue(sheetName, 278, 13, "January Total"),
					new ExpectedCellValue(sheetName, 279, 13, "February"),
					new ExpectedCellValue(sheetName, 280, 13, "February Total"),
					new ExpectedCellValue(sheetName, 281, 13, null),
					new ExpectedCellValue(sheetName, 282, 13, null),
					new ExpectedCellValue(sheetName, 283, 13, null),
					new ExpectedCellValue(sheetName, 284, 13, null),
					new ExpectedCellValue(sheetName, 242, 14, "Item"),
					new ExpectedCellValue(sheetName, 243, 14, null),
					new ExpectedCellValue(sheetName, 244, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 245, 14, null),
					new ExpectedCellValue(sheetName, 246, 14, "Headlamp"),
					new ExpectedCellValue(sheetName, 247, 14, null),
					new ExpectedCellValue(sheetName, 248, 14, null),
					new ExpectedCellValue(sheetName, 249, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 250, 14, null),
					new ExpectedCellValue(sheetName, 251, 14, "Headlamp"),
					new ExpectedCellValue(sheetName, 252, 14, null),
					new ExpectedCellValue(sheetName, 253, 14, null),
					new ExpectedCellValue(sheetName, 254, 14, null),
					new ExpectedCellValue(sheetName, 255, 14, null),
					new ExpectedCellValue(sheetName, 256, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 257, 14, null),
					new ExpectedCellValue(sheetName, 258, 14, "Tent"),
					new ExpectedCellValue(sheetName, 259, 14, null),
					new ExpectedCellValue(sheetName, 260, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 261, 14, null),
					new ExpectedCellValue(sheetName, 262, 14, null),
					new ExpectedCellValue(sheetName, 263, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 264, 14, null),
					new ExpectedCellValue(sheetName, 265, 14, "Tent"),
					new ExpectedCellValue(sheetName, 266, 14, null),
					new ExpectedCellValue(sheetName, 267, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 268, 14, null),
					new ExpectedCellValue(sheetName, 269, 14, null),
					new ExpectedCellValue(sheetName, 270, 14, null),
					new ExpectedCellValue(sheetName, 271, 14, null),
					new ExpectedCellValue(sheetName, 272, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 273, 14, null),
					new ExpectedCellValue(sheetName, 274, 14, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 275, 14, null),
					new ExpectedCellValue(sheetName, 276, 14, null),
					new ExpectedCellValue(sheetName, 277, 14, "Car Rack"),
					new ExpectedCellValue(sheetName, 278, 14, null),
					new ExpectedCellValue(sheetName, 279, 14, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 280, 14, null),
					new ExpectedCellValue(sheetName, 281, 14, null),
					new ExpectedCellValue(sheetName, 282, 14, null),
					new ExpectedCellValue(sheetName, 283, 14, null),
					new ExpectedCellValue(sheetName, 284, 14, null),
					new ExpectedCellValue(sheetName, 242, 15, null),
					new ExpectedCellValue(sheetName, 243, 15, null),
					new ExpectedCellValue(sheetName, 244, 15, 415.75),
					new ExpectedCellValue(sheetName, 245, 15, 415.75),
					new ExpectedCellValue(sheetName, 246, 15, 24.99),
					new ExpectedCellValue(sheetName, 247, 15, 24.99),
					new ExpectedCellValue(sheetName, 248, 15, null),
					new ExpectedCellValue(sheetName, 249, 15, 831.5),
					new ExpectedCellValue(sheetName, 250, 15, 831.5),
					new ExpectedCellValue(sheetName, 251, 15, 24.99),
					new ExpectedCellValue(sheetName, 252, 15, 24.99),
					new ExpectedCellValue(sheetName, 253, 15, 440.74),
					new ExpectedCellValue(sheetName, 254, 15, 856.49),
					new ExpectedCellValue(sheetName, 255, 15, null),
					new ExpectedCellValue(sheetName, 256, 15, 415.75),
					new ExpectedCellValue(sheetName, 257, 15, 415.75),
					new ExpectedCellValue(sheetName, 258, 15, 199d),
					new ExpectedCellValue(sheetName, 259, 15, 199d),
					new ExpectedCellValue(sheetName, 260, 15, 415.75),
					new ExpectedCellValue(sheetName, 261, 15, 415.75),
					new ExpectedCellValue(sheetName, 262, 15, null),
					new ExpectedCellValue(sheetName, 263, 15, 831.5),
					new ExpectedCellValue(sheetName, 264, 15, 831.5),
					new ExpectedCellValue(sheetName, 265, 15, 1194d),
					new ExpectedCellValue(sheetName, 266, 15, 1194d),
					new ExpectedCellValue(sheetName, 267, 15, 831.5),
					new ExpectedCellValue(sheetName, 268, 15, 831.5),
					new ExpectedCellValue(sheetName, 269, 15, 1030.5),
					new ExpectedCellValue(sheetName, 270, 15, 2857d),
					new ExpectedCellValue(sheetName, 271, 15, null),
					new ExpectedCellValue(sheetName, 272, 15, 415.75),
					new ExpectedCellValue(sheetName, 273, 15, 415.75),
					new ExpectedCellValue(sheetName, 274, 15, 99d),
					new ExpectedCellValue(sheetName, 275, 15, 99d),
					new ExpectedCellValue(sheetName, 276, 15, null),
					new ExpectedCellValue(sheetName, 277, 15, 415.75),
					new ExpectedCellValue(sheetName, 278, 15, 415.75),
					new ExpectedCellValue(sheetName, 279, 15, 99d),
					new ExpectedCellValue(sheetName, 280, 15, 99d),
					new ExpectedCellValue(sheetName, 281, 15, 514.75),
					new ExpectedCellValue(sheetName, 282, 15, 514.75),
					new ExpectedCellValue(sheetName, 283, 15, 1985.99),
					new ExpectedCellValue(sheetName, 284, 15, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndSecondFieldsFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable20"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q242:T280"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 242, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 243, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 244, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 245, 17, null),
					new ExpectedCellValue(sheetName, 246, 17, null),
					new ExpectedCellValue(sheetName, 247, 17, null),
					new ExpectedCellValue(sheetName, 248, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 249, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 250, 17, null),
					new ExpectedCellValue(sheetName, 251, 17, null),
					new ExpectedCellValue(sheetName, 252, 17, null),
					new ExpectedCellValue(sheetName, 253, 17, null),
					new ExpectedCellValue(sheetName, 254, 17, null),
					new ExpectedCellValue(sheetName, 255, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 256, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 257, 17, null),
					new ExpectedCellValue(sheetName, 258, 17, null),
					new ExpectedCellValue(sheetName, 259, 17, null),
					new ExpectedCellValue(sheetName, 260, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 261, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 262, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 263, 17, null),
					new ExpectedCellValue(sheetName, 264, 17, null),
					new ExpectedCellValue(sheetName, 265, 17, null),
					new ExpectedCellValue(sheetName, 266, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 267, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 268, 17, null),
					new ExpectedCellValue(sheetName, 269, 17, null),
					new ExpectedCellValue(sheetName, 270, 17, null),
					new ExpectedCellValue(sheetName, 271, 17, null),
					new ExpectedCellValue(sheetName, 272, 17, null),
					new ExpectedCellValue(sheetName, 273, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 274, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 275, 17, null),
					new ExpectedCellValue(sheetName, 276, 17, null),
					new ExpectedCellValue(sheetName, 277, 17, null),
					new ExpectedCellValue(sheetName, 278, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 279, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 280, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 242, 18, "Month"),
					new ExpectedCellValue(sheetName, 243, 18, null),
					new ExpectedCellValue(sheetName, 244, 18, "January"),
					new ExpectedCellValue(sheetName, 245, 18, "January Total"),
					new ExpectedCellValue(sheetName, 246, 18, "March"),
					new ExpectedCellValue(sheetName, 247, 18, "March Total"),
					new ExpectedCellValue(sheetName, 248, 18, null),
					new ExpectedCellValue(sheetName, 249, 18, "January"),
					new ExpectedCellValue(sheetName, 250, 18, "January Total"),
					new ExpectedCellValue(sheetName, 251, 18, "February"),
					new ExpectedCellValue(sheetName, 252, 18, "February Total"),
					new ExpectedCellValue(sheetName, 253, 18, "March"),
					new ExpectedCellValue(sheetName, 254, 18, "March Total"),
					new ExpectedCellValue(sheetName, 255, 18, null),
					new ExpectedCellValue(sheetName, 256, 18, "January"),
					new ExpectedCellValue(sheetName, 257, 18, "January Total"),
					new ExpectedCellValue(sheetName, 258, 18, "February"),
					new ExpectedCellValue(sheetName, 259, 18, "February Total"),
					new ExpectedCellValue(sheetName, 260, 18, null),
					new ExpectedCellValue(sheetName, 261, 18, null),
					new ExpectedCellValue(sheetName, 262, 18, "January"),
					new ExpectedCellValue(sheetName, 263, 18, "January Total"),
					new ExpectedCellValue(sheetName, 264, 18, "March"),
					new ExpectedCellValue(sheetName, 265, 18, "March Total"),
					new ExpectedCellValue(sheetName, 266, 18, null),
					new ExpectedCellValue(sheetName, 267, 18, "January"),
					new ExpectedCellValue(sheetName, 268, 18, "January Total"),
					new ExpectedCellValue(sheetName, 269, 18, "February"),
					new ExpectedCellValue(sheetName, 270, 18, "February Total"),
					new ExpectedCellValue(sheetName, 271, 18, "March"),
					new ExpectedCellValue(sheetName, 272, 18, "March Total"),
					new ExpectedCellValue(sheetName, 273, 18, null),
					new ExpectedCellValue(sheetName, 274, 18, "January"),
					new ExpectedCellValue(sheetName, 275, 18, "January Total"),
					new ExpectedCellValue(sheetName, 276, 18, "February"),
					new ExpectedCellValue(sheetName, 277, 18, "February Total"),
					new ExpectedCellValue(sheetName, 278, 18, null),
					new ExpectedCellValue(sheetName, 279, 18, null),
					new ExpectedCellValue(sheetName, 280, 18, null),
					new ExpectedCellValue(sheetName, 242, 19, "Item"),
					new ExpectedCellValue(sheetName, 243, 19, null),
					new ExpectedCellValue(sheetName, 244, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 245, 19, null),
					new ExpectedCellValue(sheetName, 246, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 247, 19, null),
					new ExpectedCellValue(sheetName, 248, 19, null),
					new ExpectedCellValue(sheetName, 249, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 250, 19, null),
					new ExpectedCellValue(sheetName, 251, 19, "Tent"),
					new ExpectedCellValue(sheetName, 252, 19, null),
					new ExpectedCellValue(sheetName, 253, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 254, 19, null),
					new ExpectedCellValue(sheetName, 255, 19, null),
					new ExpectedCellValue(sheetName, 256, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 257, 19, null),
					new ExpectedCellValue(sheetName, 258, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 259, 19, null),
					new ExpectedCellValue(sheetName, 260, 19, null),
					new ExpectedCellValue(sheetName, 261, 19, null),
					new ExpectedCellValue(sheetName, 262, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 19, null),
					new ExpectedCellValue(sheetName, 264, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 265, 19, null),
					new ExpectedCellValue(sheetName, 266, 19, null),
					new ExpectedCellValue(sheetName, 267, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 268, 19, null),
					new ExpectedCellValue(sheetName, 269, 19, "Tent"),
					new ExpectedCellValue(sheetName, 270, 19, null),
					new ExpectedCellValue(sheetName, 271, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 272, 19, null),
					new ExpectedCellValue(sheetName, 273, 19, null),
					new ExpectedCellValue(sheetName, 274, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 19, null),
					new ExpectedCellValue(sheetName, 276, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 277, 19, null),
					new ExpectedCellValue(sheetName, 278, 19, null),
					new ExpectedCellValue(sheetName, 279, 19, null),
					new ExpectedCellValue(sheetName, 280, 19, null),
					new ExpectedCellValue(sheetName, 242, 20, null),
					new ExpectedCellValue(sheetName, 243, 20, null),
					new ExpectedCellValue(sheetName, 244, 20, 415.75),
					new ExpectedCellValue(sheetName, 245, 20, 415.75),
					new ExpectedCellValue(sheetName, 246, 20, 24.99),
					new ExpectedCellValue(sheetName, 247, 20, 24.99),
					new ExpectedCellValue(sheetName, 248, 20, 440.74),
					new ExpectedCellValue(sheetName, 249, 20, 415.75),
					new ExpectedCellValue(sheetName, 250, 20, 415.75),
					new ExpectedCellValue(sheetName, 251, 20, 199d),
					new ExpectedCellValue(sheetName, 252, 20, 199d),
					new ExpectedCellValue(sheetName, 253, 20, 415.75),
					new ExpectedCellValue(sheetName, 254, 20, 415.75),
					new ExpectedCellValue(sheetName, 255, 20, 1030.5),
					new ExpectedCellValue(sheetName, 256, 20, 415.75),
					new ExpectedCellValue(sheetName, 257, 20, 415.75),
					new ExpectedCellValue(sheetName, 258, 20, 99d),
					new ExpectedCellValue(sheetName, 259, 20, 99d),
					new ExpectedCellValue(sheetName, 260, 20, 514.75),
					new ExpectedCellValue(sheetName, 261, 20, null),
					new ExpectedCellValue(sheetName, 262, 20, 831.5),
					new ExpectedCellValue(sheetName, 263, 20, 831.5),
					new ExpectedCellValue(sheetName, 264, 20, 24.99),
					new ExpectedCellValue(sheetName, 265, 20, 24.99),
					new ExpectedCellValue(sheetName, 266, 20, 856.49),
					new ExpectedCellValue(sheetName, 267, 20, 831.5),
					new ExpectedCellValue(sheetName, 268, 20, 831.5),
					new ExpectedCellValue(sheetName, 269, 20, 1194d),
					new ExpectedCellValue(sheetName, 270, 20, 1194d),
					new ExpectedCellValue(sheetName, 271, 20, 831.5),
					new ExpectedCellValue(sheetName, 272, 20, 831.5),
					new ExpectedCellValue(sheetName, 273, 20, 2857d),
					new ExpectedCellValue(sheetName, 274, 20, 415.75),
					new ExpectedCellValue(sheetName, 275, 20, 415.75),
					new ExpectedCellValue(sheetName, 276, 20, 99d),
					new ExpectedCellValue(sheetName, 277, 20, 99d),
					new ExpectedCellValue(sheetName, 278, 20, 514.75),
					new ExpectedCellValue(sheetName, 279, 20, 1985.99),
					new ExpectedCellValue(sheetName, 280, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndThirdFieldsLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable21"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B297:E340"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 297, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 298, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 299, 2, null),
					new ExpectedCellValue(sheetName, 300, 2, null),
					new ExpectedCellValue(sheetName, 301, 2, null),
					new ExpectedCellValue(sheetName, 302, 2, null),
					new ExpectedCellValue(sheetName, 303, 2, null),
					new ExpectedCellValue(sheetName, 304, 2, null),
					new ExpectedCellValue(sheetName, 305, 2, null),
					new ExpectedCellValue(sheetName, 306, 2, null),
					new ExpectedCellValue(sheetName, 307, 2, null),
					new ExpectedCellValue(sheetName, 308, 2, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 309, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 310, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 311, 2, null),
					new ExpectedCellValue(sheetName, 312, 2, null),
					new ExpectedCellValue(sheetName, 313, 2, null),
					new ExpectedCellValue(sheetName, 314, 2, null),
					new ExpectedCellValue(sheetName, 315, 2, null),
					new ExpectedCellValue(sheetName, 316, 2, null),
					new ExpectedCellValue(sheetName, 317, 2, null),
					new ExpectedCellValue(sheetName, 318, 2, null),
					new ExpectedCellValue(sheetName, 319, 2, null),
					new ExpectedCellValue(sheetName, 320, 2, null),
					new ExpectedCellValue(sheetName, 321, 2, null),
					new ExpectedCellValue(sheetName, 322, 2, null),
					new ExpectedCellValue(sheetName, 323, 2, null),
					new ExpectedCellValue(sheetName, 324, 2, null),
					new ExpectedCellValue(sheetName, 325, 2, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 326, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 327, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 328, 2, null),
					new ExpectedCellValue(sheetName, 329, 2, null),
					new ExpectedCellValue(sheetName, 330, 2, null),
					new ExpectedCellValue(sheetName, 331, 2, null),
					new ExpectedCellValue(sheetName, 332, 2, null),
					new ExpectedCellValue(sheetName, 333, 2, null),
					new ExpectedCellValue(sheetName, 334, 2, null),
					new ExpectedCellValue(sheetName, 335, 2, null),
					new ExpectedCellValue(sheetName, 336, 2, null),
					new ExpectedCellValue(sheetName, 337, 2, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 338, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 339, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 340, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 3, "Month"),
					new ExpectedCellValue(sheetName, 298, 3, "January"),
					new ExpectedCellValue(sheetName, 299, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 300, 3, null),
					new ExpectedCellValue(sheetName, 301, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 302, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 303, 3, "March"),
					new ExpectedCellValue(sheetName, 304, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 305, 3, null),
					new ExpectedCellValue(sheetName, 306, 3, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 307, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 308, 3, null),
					new ExpectedCellValue(sheetName, 309, 3, null),
					new ExpectedCellValue(sheetName, 310, 3, "January"),
					new ExpectedCellValue(sheetName, 311, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 312, 3, null),
					new ExpectedCellValue(sheetName, 313, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 314, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 315, 3, "February"),
					new ExpectedCellValue(sheetName, 316, 3, "Tent"),
					new ExpectedCellValue(sheetName, 317, 3, null),
					new ExpectedCellValue(sheetName, 318, 3, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 319, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 320, 3, "March"),
					new ExpectedCellValue(sheetName, 321, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 3, null),
					new ExpectedCellValue(sheetName, 323, 3, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 324, 3, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 325, 3, null),
					new ExpectedCellValue(sheetName, 326, 3, null),
					new ExpectedCellValue(sheetName, 327, 3, "January"),
					new ExpectedCellValue(sheetName, 328, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 3, null),
					new ExpectedCellValue(sheetName, 330, 3, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 331, 3, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 332, 3, "February"),
					new ExpectedCellValue(sheetName, 333, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 334, 3, null),
					new ExpectedCellValue(sheetName, 335, 3, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 336, 3, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 337, 3, null),
					new ExpectedCellValue(sheetName, 338, 3, null),
					new ExpectedCellValue(sheetName, 339, 3, null),
					new ExpectedCellValue(sheetName, 340, 3, null),
					new ExpectedCellValue(sheetName, 297, 4, "Values"),
					new ExpectedCellValue(sheetName, 298, 4, null),
					new ExpectedCellValue(sheetName, 299, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 300, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 301, 4, null),
					new ExpectedCellValue(sheetName, 302, 4, null),
					new ExpectedCellValue(sheetName, 303, 4, null),
					new ExpectedCellValue(sheetName, 304, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 305, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 306, 4, null),
					new ExpectedCellValue(sheetName, 307, 4, null),
					new ExpectedCellValue(sheetName, 308, 4, null),
					new ExpectedCellValue(sheetName, 309, 4, null),
					new ExpectedCellValue(sheetName, 310, 4, null),
					new ExpectedCellValue(sheetName, 311, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 312, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 4, null),
					new ExpectedCellValue(sheetName, 314, 4, null),
					new ExpectedCellValue(sheetName, 315, 4, null),
					new ExpectedCellValue(sheetName, 316, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 317, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 318, 4, null),
					new ExpectedCellValue(sheetName, 319, 4, null),
					new ExpectedCellValue(sheetName, 320, 4, null),
					new ExpectedCellValue(sheetName, 321, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 322, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 323, 4, null),
					new ExpectedCellValue(sheetName, 324, 4, null),
					new ExpectedCellValue(sheetName, 325, 4, null),
					new ExpectedCellValue(sheetName, 326, 4, null),
					new ExpectedCellValue(sheetName, 327, 4, null),
					new ExpectedCellValue(sheetName, 328, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 329, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 330, 4, null),
					new ExpectedCellValue(sheetName, 331, 4, null),
					new ExpectedCellValue(sheetName, 332, 4, null),
					new ExpectedCellValue(sheetName, 333, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 334, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 335, 4, null),
					new ExpectedCellValue(sheetName, 336, 4, null),
					new ExpectedCellValue(sheetName, 337, 4, null),
					new ExpectedCellValue(sheetName, 338, 4, null),
					new ExpectedCellValue(sheetName, 339, 4, null),
					new ExpectedCellValue(sheetName, 340, 4, null),
					new ExpectedCellValue(sheetName, 297, 5, null),
					new ExpectedCellValue(sheetName, 298, 5, null),
					new ExpectedCellValue(sheetName, 299, 5, 415.75),
					new ExpectedCellValue(sheetName, 300, 5, 831.5),
					new ExpectedCellValue(sheetName, 301, 5, 415.75),
					new ExpectedCellValue(sheetName, 302, 5, 831.5),
					new ExpectedCellValue(sheetName, 303, 5, null),
					new ExpectedCellValue(sheetName, 304, 5, 24.99),
					new ExpectedCellValue(sheetName, 305, 5, 24.99),
					new ExpectedCellValue(sheetName, 306, 5, 24.99),
					new ExpectedCellValue(sheetName, 307, 5, 24.99),
					new ExpectedCellValue(sheetName, 308, 5, 440.74),
					new ExpectedCellValue(sheetName, 309, 5, 856.49),
					new ExpectedCellValue(sheetName, 310, 5, null),
					new ExpectedCellValue(sheetName, 311, 5, 415.75),
					new ExpectedCellValue(sheetName, 312, 5, 831.5),
					new ExpectedCellValue(sheetName, 313, 5, 415.75),
					new ExpectedCellValue(sheetName, 314, 5, 831.5),
					new ExpectedCellValue(sheetName, 315, 5, null),
					new ExpectedCellValue(sheetName, 316, 5, 199d),
					new ExpectedCellValue(sheetName, 317, 5, 1194d),
					new ExpectedCellValue(sheetName, 318, 5, 199d),
					new ExpectedCellValue(sheetName, 319, 5, 1194d),
					new ExpectedCellValue(sheetName, 320, 5, null),
					new ExpectedCellValue(sheetName, 321, 5, 415.75),
					new ExpectedCellValue(sheetName, 322, 5, 831.5),
					new ExpectedCellValue(sheetName, 323, 5, 415.75),
					new ExpectedCellValue(sheetName, 324, 5, 831.5),
					new ExpectedCellValue(sheetName, 325, 5, 1030.5),
					new ExpectedCellValue(sheetName, 326, 5, 2857d),
					new ExpectedCellValue(sheetName, 327, 5, null),
					new ExpectedCellValue(sheetName, 328, 5, 415.75),
					new ExpectedCellValue(sheetName, 329, 5, 415.75),
					new ExpectedCellValue(sheetName, 330, 5, 415.75),
					new ExpectedCellValue(sheetName, 331, 5, 415.75),
					new ExpectedCellValue(sheetName, 332, 5, null),
					new ExpectedCellValue(sheetName, 333, 5, 99d),
					new ExpectedCellValue(sheetName, 334, 5, 99d),
					new ExpectedCellValue(sheetName, 335, 5, 99d),
					new ExpectedCellValue(sheetName, 336, 5, 99d),
					new ExpectedCellValue(sheetName, 337, 5, 514.75),
					new ExpectedCellValue(sheetName, 338, 5, 514.75),
					new ExpectedCellValue(sheetName, 339, 5, 1985.99),
					new ExpectedCellValue(sheetName, 340, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndThirdFieldsThirdDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable22"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G297:I354"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 297, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 298, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 299, 7, null),
					new ExpectedCellValue(sheetName, 300, 7, null),
					new ExpectedCellValue(sheetName, 301, 7, null),
					new ExpectedCellValue(sheetName, 302, 7, null),
					new ExpectedCellValue(sheetName, 303, 7, null),
					new ExpectedCellValue(sheetName, 304, 7, null),
					new ExpectedCellValue(sheetName, 305, 7, null),
					new ExpectedCellValue(sheetName, 306, 7, null),
					new ExpectedCellValue(sheetName, 307, 7, null),
					new ExpectedCellValue(sheetName, 308, 7, null),
					new ExpectedCellValue(sheetName, 309, 7, null),
					new ExpectedCellValue(sheetName, 310, 7, null),
					new ExpectedCellValue(sheetName, 311, 7, null),
					new ExpectedCellValue(sheetName, 312, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 313, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 314, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 315, 7, null),
					new ExpectedCellValue(sheetName, 316, 7, null),
					new ExpectedCellValue(sheetName, 317, 7, null),
					new ExpectedCellValue(sheetName, 318, 7, null),
					new ExpectedCellValue(sheetName, 319, 7, null),
					new ExpectedCellValue(sheetName, 320, 7, null),
					new ExpectedCellValue(sheetName, 321, 7, null),
					new ExpectedCellValue(sheetName, 322, 7, null),
					new ExpectedCellValue(sheetName, 323, 7, null),
					new ExpectedCellValue(sheetName, 324, 7, null),
					new ExpectedCellValue(sheetName, 325, 7, null),
					new ExpectedCellValue(sheetName, 326, 7, null),
					new ExpectedCellValue(sheetName, 327, 7, null),
					new ExpectedCellValue(sheetName, 328, 7, null),
					new ExpectedCellValue(sheetName, 329, 7, null),
					new ExpectedCellValue(sheetName, 330, 7, null),
					new ExpectedCellValue(sheetName, 331, 7, null),
					new ExpectedCellValue(sheetName, 332, 7, null),
					new ExpectedCellValue(sheetName, 333, 7, null),
					new ExpectedCellValue(sheetName, 334, 7, null),
					new ExpectedCellValue(sheetName, 335, 7, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 336, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 337, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 338, 7, null),
					new ExpectedCellValue(sheetName, 339, 7, null),
					new ExpectedCellValue(sheetName, 340, 7, null),
					new ExpectedCellValue(sheetName, 341, 7, null),
					new ExpectedCellValue(sheetName, 342, 7, null),
					new ExpectedCellValue(sheetName, 343, 7, null),
					new ExpectedCellValue(sheetName, 344, 7, null),
					new ExpectedCellValue(sheetName, 345, 7, null),
					new ExpectedCellValue(sheetName, 346, 7, null),
					new ExpectedCellValue(sheetName, 347, 7, null),
					new ExpectedCellValue(sheetName, 348, 7, null),
					new ExpectedCellValue(sheetName, 379, 7, null),
					new ExpectedCellValue(sheetName, 359, 7, null),
					new ExpectedCellValue(sheetName, 351, 7, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 352, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 353, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 354, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 8, "Month"),
					new ExpectedCellValue(sheetName, 298, 8, "January"),
					new ExpectedCellValue(sheetName, 299, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 300, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 301, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 302, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 303, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 304, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 8, "March"),
					new ExpectedCellValue(sheetName, 306, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 307, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 308, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 309, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 310, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 311, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 312, 8, null),
					new ExpectedCellValue(sheetName, 313, 8, null),
					new ExpectedCellValue(sheetName, 314, 8, "January"),
					new ExpectedCellValue(sheetName, 315, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 316, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 317, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 318, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 319, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 320, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 321, 8, "February"),
					new ExpectedCellValue(sheetName, 322, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 323, 8, "Tent"),
					new ExpectedCellValue(sheetName, 324, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 325, 8, "Tent"),
					new ExpectedCellValue(sheetName, 326, 8, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 327, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 328, 8, "March"),
					new ExpectedCellValue(sheetName, 329, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 330, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 331, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 332, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 334, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 335, 8, null),
					new ExpectedCellValue(sheetName, 336, 8, null),
					new ExpectedCellValue(sheetName, 337, 8, "January"),
					new ExpectedCellValue(sheetName, 338, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 339, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 340, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 341, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 342, 8, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 343, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 344, 8, "February"),
					new ExpectedCellValue(sheetName, 345, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 346, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 347, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 348, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 349, 8, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 350, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 351, 8, null),
					new ExpectedCellValue(sheetName, 352, 8, null),
					new ExpectedCellValue(sheetName, 353, 8, null),
					new ExpectedCellValue(sheetName, 354, 8, null),
					new ExpectedCellValue(sheetName, 297, 9, null),
					new ExpectedCellValue(sheetName, 298, 9, null),
					new ExpectedCellValue(sheetName, 299, 9, null),
					new ExpectedCellValue(sheetName, 300, 9, 415.75),
					new ExpectedCellValue(sheetName, 301, 9, null),
					new ExpectedCellValue(sheetName, 302, 9, 831.5),
					new ExpectedCellValue(sheetName, 303, 9, 415.75),
					new ExpectedCellValue(sheetName, 304, 9, 831.5),
					new ExpectedCellValue(sheetName, 305, 9, null),
					new ExpectedCellValue(sheetName, 306, 9, null),
					new ExpectedCellValue(sheetName, 307, 9, 24.99),
					new ExpectedCellValue(sheetName, 308, 9, null),
					new ExpectedCellValue(sheetName, 309, 9, 24.99),
					new ExpectedCellValue(sheetName, 310, 9, 24.99),
					new ExpectedCellValue(sheetName, 311, 9, 24.99),
					new ExpectedCellValue(sheetName, 312, 9, 440.74),
					new ExpectedCellValue(sheetName, 313, 9, 856.49),
					new ExpectedCellValue(sheetName, 314, 9, null),
					new ExpectedCellValue(sheetName, 315, 9, null),
					new ExpectedCellValue(sheetName, 316, 9, 415.75),
					new ExpectedCellValue(sheetName, 317, 9, null),
					new ExpectedCellValue(sheetName, 318, 9, 831.5),
					new ExpectedCellValue(sheetName, 319, 9, 415.75),
					new ExpectedCellValue(sheetName, 320, 9, 831.5),
					new ExpectedCellValue(sheetName, 321, 9, null),
					new ExpectedCellValue(sheetName, 322, 9, null),
					new ExpectedCellValue(sheetName, 323, 9, 199d),
					new ExpectedCellValue(sheetName, 324, 9, null),
					new ExpectedCellValue(sheetName, 325, 9, 1194d),
					new ExpectedCellValue(sheetName, 326, 9, 199d),
					new ExpectedCellValue(sheetName, 327, 9, 1194d),
					new ExpectedCellValue(sheetName, 328, 9, null),
					new ExpectedCellValue(sheetName, 329, 9, null),
					new ExpectedCellValue(sheetName, 330, 9, 415.75),
					new ExpectedCellValue(sheetName, 331, 9, null),
					new ExpectedCellValue(sheetName, 332, 9, 831.5),
					new ExpectedCellValue(sheetName, 333, 9, 415.75),
					new ExpectedCellValue(sheetName, 334, 9, 831.5),
					new ExpectedCellValue(sheetName, 335, 9, 1030.5),
					new ExpectedCellValue(sheetName, 336, 9, 2857d),
					new ExpectedCellValue(sheetName, 337, 9, null),
					new ExpectedCellValue(sheetName, 338, 9, null),
					new ExpectedCellValue(sheetName, 339, 9, 415.75),
					new ExpectedCellValue(sheetName, 340, 9, null),
					new ExpectedCellValue(sheetName, 341, 9, 415.75),
					new ExpectedCellValue(sheetName, 342, 9, 415.75),
					new ExpectedCellValue(sheetName, 343, 9, 415.75),
					new ExpectedCellValue(sheetName, 344, 9, null),
					new ExpectedCellValue(sheetName, 345, 9, null),
					new ExpectedCellValue(sheetName, 346, 9, 99d),
					new ExpectedCellValue(sheetName, 347, 9, null),
					new ExpectedCellValue(sheetName, 348, 9, 99d),
					new ExpectedCellValue(sheetName, 349, 9, 99d),
					new ExpectedCellValue(sheetName, 350, 9, 99d),
					new ExpectedCellValue(sheetName, 351, 9, 514.75),
					new ExpectedCellValue(sheetName, 352, 9, 514.75),
					new ExpectedCellValue(sheetName, 353, 9, 1985.99),
					new ExpectedCellValue(sheetName, 354, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndThirdFieldsSecondDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable23"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L297:N339"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 297, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 298, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 299, 12, null),
					new ExpectedCellValue(sheetName, 300, 12, null),
					new ExpectedCellValue(sheetName, 301, 12, null),
					new ExpectedCellValue(sheetName, 302, 12, null),
					new ExpectedCellValue(sheetName, 303, 12, null),
					new ExpectedCellValue(sheetName, 304, 12, null),
					new ExpectedCellValue(sheetName, 305, 12, null),
					new ExpectedCellValue(sheetName, 306, 12, null),
					new ExpectedCellValue(sheetName, 307, 12, null),
					new ExpectedCellValue(sheetName, 308, 12, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 309, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 310, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 311, 12, null),
					new ExpectedCellValue(sheetName, 312, 12, null),
					new ExpectedCellValue(sheetName, 313, 12, null),
					new ExpectedCellValue(sheetName, 314, 12, null),
					new ExpectedCellValue(sheetName, 315, 12, null),
					new ExpectedCellValue(sheetName, 316, 12, null),
					new ExpectedCellValue(sheetName, 317, 12, null),
					new ExpectedCellValue(sheetName, 318, 12, null),
					new ExpectedCellValue(sheetName, 319, 12, null),
					new ExpectedCellValue(sheetName, 320, 12, null),
					new ExpectedCellValue(sheetName, 321, 12, null),
					new ExpectedCellValue(sheetName, 322, 12, null),
					new ExpectedCellValue(sheetName, 323, 12, null),
					new ExpectedCellValue(sheetName, 324, 12, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 325, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 326, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 327, 12, null),
					new ExpectedCellValue(sheetName, 328, 12, null),
					new ExpectedCellValue(sheetName, 329, 12, null),
					new ExpectedCellValue(sheetName, 330, 12, null),
					new ExpectedCellValue(sheetName, 331, 12, null),
					new ExpectedCellValue(sheetName, 332, 12, null),
					new ExpectedCellValue(sheetName, 333, 12, null),
					new ExpectedCellValue(sheetName, 334, 12, null),
					new ExpectedCellValue(sheetName, 335, 12, null),
					new ExpectedCellValue(sheetName, 336, 12, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 337, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 338, 12, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 339, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 13, "Values"),
					new ExpectedCellValue(sheetName, 298, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 299, 13, "January"),
					new ExpectedCellValue(sheetName, 300, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 301, 13, "March"),
					new ExpectedCellValue(sheetName, 302, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 303, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 304, 13, "January"),
					new ExpectedCellValue(sheetName, 305, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 306, 13, "March"),
					new ExpectedCellValue(sheetName, 307, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 308, 13, null),
					new ExpectedCellValue(sheetName, 309, 13, null),
					new ExpectedCellValue(sheetName, 310, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 311, 13, "January"),
					new ExpectedCellValue(sheetName, 312, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 313, 13, "February"),
					new ExpectedCellValue(sheetName, 314, 13, "Tent"),
					new ExpectedCellValue(sheetName, 315, 13, "March"),
					new ExpectedCellValue(sheetName, 316, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 317, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 318, 13, "January"),
					new ExpectedCellValue(sheetName, 319, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 320, 13, "February"),
					new ExpectedCellValue(sheetName, 321, 13, "Tent"),
					new ExpectedCellValue(sheetName, 322, 13, "March"),
					new ExpectedCellValue(sheetName, 323, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 324, 13, null),
					new ExpectedCellValue(sheetName, 325, 13, null),
					new ExpectedCellValue(sheetName, 326, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 327, 13, "January"),
					new ExpectedCellValue(sheetName, 328, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 13, "February"),
					new ExpectedCellValue(sheetName, 330, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 331, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 332, 13, "January"),
					new ExpectedCellValue(sheetName, 333, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 334, 13, "February"),
					new ExpectedCellValue(sheetName, 335, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 336, 13, null),
					new ExpectedCellValue(sheetName, 337, 13, null),
					new ExpectedCellValue(sheetName, 338, 13, null),
					new ExpectedCellValue(sheetName, 339, 13, null),
					new ExpectedCellValue(sheetName, 297, 14, null),
					new ExpectedCellValue(sheetName, 298, 14, null),
					new ExpectedCellValue(sheetName, 299, 14, 415.75),
					new ExpectedCellValue(sheetName, 300, 14, 415.75),
					new ExpectedCellValue(sheetName, 301, 14, 24.99),
					new ExpectedCellValue(sheetName, 302, 14, 24.99),
					new ExpectedCellValue(sheetName, 303, 14, null),
					new ExpectedCellValue(sheetName, 304, 14, 831.5),
					new ExpectedCellValue(sheetName, 305, 14, 831.5),
					new ExpectedCellValue(sheetName, 306, 14, 24.99),
					new ExpectedCellValue(sheetName, 307, 14, 24.99),
					new ExpectedCellValue(sheetName, 308, 14, 440.74),
					new ExpectedCellValue(sheetName, 309, 14, 856.49),
					new ExpectedCellValue(sheetName, 310, 14, null),
					new ExpectedCellValue(sheetName, 311, 14, 415.75),
					new ExpectedCellValue(sheetName, 312, 14, 415.75),
					new ExpectedCellValue(sheetName, 313, 14, 199d),
					new ExpectedCellValue(sheetName, 314, 14, 199d),
					new ExpectedCellValue(sheetName, 315, 14, 415.75),
					new ExpectedCellValue(sheetName, 316, 14, 415.75),
					new ExpectedCellValue(sheetName, 317, 14, null),
					new ExpectedCellValue(sheetName, 318, 14, 831.5),
					new ExpectedCellValue(sheetName, 319, 14, 831.5),
					new ExpectedCellValue(sheetName, 320, 14, 1194d),
					new ExpectedCellValue(sheetName, 321, 14, 1194d),
					new ExpectedCellValue(sheetName, 322, 14, 831.5),
					new ExpectedCellValue(sheetName, 323, 14, 831.5),
					new ExpectedCellValue(sheetName, 324, 14, 1030.5),
					new ExpectedCellValue(sheetName, 325, 14, 2857d),
					new ExpectedCellValue(sheetName, 326, 14, null),
					new ExpectedCellValue(sheetName, 327, 14, 415.75),
					new ExpectedCellValue(sheetName, 328, 14, 415.75),
					new ExpectedCellValue(sheetName, 329, 14, 99d),
					new ExpectedCellValue(sheetName, 330, 14, 99d),
					new ExpectedCellValue(sheetName, 331, 14, null),
					new ExpectedCellValue(sheetName, 332, 14, 415.75),
					new ExpectedCellValue(sheetName, 333, 14, 415.75),
					new ExpectedCellValue(sheetName, 334, 14, 99d),
					new ExpectedCellValue(sheetName, 335, 14, 99d),
					new ExpectedCellValue(sheetName, 336, 14, 514.75),
					new ExpectedCellValue(sheetName, 337, 14, 514.75),
					new ExpectedCellValue(sheetName, 338, 14, 1985.99),
					new ExpectedCellValue(sheetName, 339, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularFirstAndThirdFieldsFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable24"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P297:R335"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 297, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 298, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 299, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 300, 16, null),
					new ExpectedCellValue(sheetName, 301, 16, null),
					new ExpectedCellValue(sheetName, 302, 16, null),
					new ExpectedCellValue(sheetName, 303, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 304, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 305, 16, null),
					new ExpectedCellValue(sheetName, 306, 16, null),
					new ExpectedCellValue(sheetName, 307, 16, null),
					new ExpectedCellValue(sheetName, 308, 16, null),
					new ExpectedCellValue(sheetName, 309, 16, null),
					new ExpectedCellValue(sheetName, 310, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 311, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 312, 16, null),
					new ExpectedCellValue(sheetName, 313, 16, null),
					new ExpectedCellValue(sheetName, 314, 16, null),
					new ExpectedCellValue(sheetName, 315, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 316, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 317, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 318, 16, null),
					new ExpectedCellValue(sheetName, 319, 16, null),
					new ExpectedCellValue(sheetName, 320, 16, null),
					new ExpectedCellValue(sheetName, 321, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 322, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 323, 16, null),
					new ExpectedCellValue(sheetName, 324, 16, null),
					new ExpectedCellValue(sheetName, 325, 16, null),
					new ExpectedCellValue(sheetName, 326, 16, null),
					new ExpectedCellValue(sheetName, 327, 16, null),
					new ExpectedCellValue(sheetName, 328, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 329, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 330, 16, null),
					new ExpectedCellValue(sheetName, 331, 16, null),
					new ExpectedCellValue(sheetName, 332, 16, null),
					new ExpectedCellValue(sheetName, 333, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 334, 16, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 335, 16, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 17, "Month"),
					new ExpectedCellValue(sheetName, 298, 17, null),
					new ExpectedCellValue(sheetName, 299, 17, "January"),
					new ExpectedCellValue(sheetName, 300, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 301, 17, "March"),
					new ExpectedCellValue(sheetName, 302, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 303, 17, null),
					new ExpectedCellValue(sheetName, 304, 17, "January"),
					new ExpectedCellValue(sheetName, 305, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 306, 17, "February"),
					new ExpectedCellValue(sheetName, 307, 17, "Tent"),
					new ExpectedCellValue(sheetName, 308, 17, "March"),
					new ExpectedCellValue(sheetName, 309, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 310, 17, null),
					new ExpectedCellValue(sheetName, 311, 17, "January"),
					new ExpectedCellValue(sheetName, 312, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 313, 17, "February"),
					new ExpectedCellValue(sheetName, 314, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 315, 17, null),
					new ExpectedCellValue(sheetName, 316, 17, null),
					new ExpectedCellValue(sheetName, 317, 17, "January"),
					new ExpectedCellValue(sheetName, 318, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 319, 17, "March"),
					new ExpectedCellValue(sheetName, 320, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 321, 17, null),
					new ExpectedCellValue(sheetName, 322, 17, "January"),
					new ExpectedCellValue(sheetName, 323, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 324, 17, "February"),
					new ExpectedCellValue(sheetName, 325, 17, "Tent"),
					new ExpectedCellValue(sheetName, 326, 17, "March"),
					new ExpectedCellValue(sheetName, 327, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 328, 17, null),
					new ExpectedCellValue(sheetName, 329, 17, "January"),
					new ExpectedCellValue(sheetName, 330, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 331, 17, "February"),
					new ExpectedCellValue(sheetName, 332, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 333, 17, null),
					new ExpectedCellValue(sheetName, 334, 17, null),
					new ExpectedCellValue(sheetName, 335, 17, null),
					new ExpectedCellValue(sheetName, 297, 18, null),
					new ExpectedCellValue(sheetName, 298, 18, null),
					new ExpectedCellValue(sheetName, 299, 18, 415.75),
					new ExpectedCellValue(sheetName, 300, 18, 415.75),
					new ExpectedCellValue(sheetName, 301, 18, 24.99),
					new ExpectedCellValue(sheetName, 302, 18, 24.99),
					new ExpectedCellValue(sheetName, 303, 18, 440.74),
					new ExpectedCellValue(sheetName, 304, 18, 415.75),
					new ExpectedCellValue(sheetName, 305, 18, 415.75),
					new ExpectedCellValue(sheetName, 306, 18, 199d),
					new ExpectedCellValue(sheetName, 307, 18, 199d),
					new ExpectedCellValue(sheetName, 308, 18, 415.75),
					new ExpectedCellValue(sheetName, 309, 18, 415.75),
					new ExpectedCellValue(sheetName, 310, 18, 1030.5),
					new ExpectedCellValue(sheetName, 311, 18, 415.75),
					new ExpectedCellValue(sheetName, 312, 18, 415.75),
					new ExpectedCellValue(sheetName, 313, 18, 99d),
					new ExpectedCellValue(sheetName, 314, 18, 99d),
					new ExpectedCellValue(sheetName, 315, 18, 514.75),
					new ExpectedCellValue(sheetName, 316, 18, null),
					new ExpectedCellValue(sheetName, 317, 18, 831.5),
					new ExpectedCellValue(sheetName, 318, 18, 831.5),
					new ExpectedCellValue(sheetName, 319, 18, 24.99),
					new ExpectedCellValue(sheetName, 320, 18, 24.99),
					new ExpectedCellValue(sheetName, 321, 18, 856.49),
					new ExpectedCellValue(sheetName, 322, 18, 831.5),
					new ExpectedCellValue(sheetName, 323, 18, 831.5),
					new ExpectedCellValue(sheetName, 324, 18, 1194d),
					new ExpectedCellValue(sheetName, 325, 18, 1194d),
					new ExpectedCellValue(sheetName, 326, 18, 831.5),
					new ExpectedCellValue(sheetName, 327, 18, 831.5),
					new ExpectedCellValue(sheetName, 328, 18, 2857d),
					new ExpectedCellValue(sheetName, 329, 18, 415.75),
					new ExpectedCellValue(sheetName, 330, 18, 415.75),
					new ExpectedCellValue(sheetName, 331, 18, 99d),
					new ExpectedCellValue(sheetName, 332, 18, 99d),
					new ExpectedCellValue(sheetName, 333, 18, 514.75),
					new ExpectedCellValue(sheetName, 334, 18, 1985.99),
					new ExpectedCellValue(sheetName, 335, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondAndThirdFieldsLastDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable25"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B360:E399"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 360, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 361, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 362, 2, "January"),
					new ExpectedCellValue(sheetName, 363, 2, null),
					new ExpectedCellValue(sheetName, 364, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 365, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 366, 2, "March"),
					new ExpectedCellValue(sheetName, 367, 2, null),
					new ExpectedCellValue(sheetName, 368, 2, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 369, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 2, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 371, 2, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 372, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 373, 2, "January"),
					new ExpectedCellValue(sheetName, 374, 2, null),
					new ExpectedCellValue(sheetName, 375, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 376, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 377, 2, "February"),
					new ExpectedCellValue(sheetName, 378, 2, null),
					new ExpectedCellValue(sheetName, 379, 2, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 380, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 381, 2, "March"),
					new ExpectedCellValue(sheetName, 382, 2, null),
					new ExpectedCellValue(sheetName, 383, 2, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 384, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 385, 2, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 386, 2, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 387, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 388, 2, "January"),
					new ExpectedCellValue(sheetName, 389, 2, null),
					new ExpectedCellValue(sheetName, 390, 2, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 391, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 392, 2, "February"),
					new ExpectedCellValue(sheetName, 393, 2, null),
					new ExpectedCellValue(sheetName, 394, 2, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 395, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 396, 2, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 397, 2, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 398, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 399, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 360, 3, "Item"),
					new ExpectedCellValue(sheetName, 361, 3, null),
					new ExpectedCellValue(sheetName, 362, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 363, 3, null),
					new ExpectedCellValue(sheetName, 364, 3, null),
					new ExpectedCellValue(sheetName, 365, 3, null),
					new ExpectedCellValue(sheetName, 366, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 367, 3, null),
					new ExpectedCellValue(sheetName, 368, 3, null),
					new ExpectedCellValue(sheetName, 369, 3, null),
					new ExpectedCellValue(sheetName, 370, 3, null),
					new ExpectedCellValue(sheetName, 371, 3, null),
					new ExpectedCellValue(sheetName, 372, 3, null),
					new ExpectedCellValue(sheetName, 373, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 3, null),
					new ExpectedCellValue(sheetName, 375, 3, null),
					new ExpectedCellValue(sheetName, 376, 3, null),
					new ExpectedCellValue(sheetName, 377, 3, "Tent"),
					new ExpectedCellValue(sheetName, 378, 3, null),
					new ExpectedCellValue(sheetName, 379, 3, null),
					new ExpectedCellValue(sheetName, 380, 3, null),
					new ExpectedCellValue(sheetName, 381, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 382, 3, null),
					new ExpectedCellValue(sheetName, 383, 3, null),
					new ExpectedCellValue(sheetName, 384, 3, null),
					new ExpectedCellValue(sheetName, 385, 3, null),
					new ExpectedCellValue(sheetName, 386, 3, null),
					new ExpectedCellValue(sheetName, 387, 3, null),
					new ExpectedCellValue(sheetName, 388, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 389, 3, null),
					new ExpectedCellValue(sheetName, 390, 3, null),
					new ExpectedCellValue(sheetName, 391, 3, null),
					new ExpectedCellValue(sheetName, 392, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 393, 3, null),
					new ExpectedCellValue(sheetName, 394, 3, null),
					new ExpectedCellValue(sheetName, 395, 3, null),
					new ExpectedCellValue(sheetName, 396, 3, null),
					new ExpectedCellValue(sheetName, 397, 3, null),
					new ExpectedCellValue(sheetName, 398, 3, null),
					new ExpectedCellValue(sheetName, 399, 3, null),
					new ExpectedCellValue(sheetName, 360, 4, "Values"),
					new ExpectedCellValue(sheetName, 361, 4, null),
					new ExpectedCellValue(sheetName, 362, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 363, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 364, 4, null),
					new ExpectedCellValue(sheetName, 365, 4, null),
					new ExpectedCellValue(sheetName, 366, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 367, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 368, 4, null),
					new ExpectedCellValue(sheetName, 369, 4, null),
					new ExpectedCellValue(sheetName, 370, 4, null),
					new ExpectedCellValue(sheetName, 371, 4, null),
					new ExpectedCellValue(sheetName, 372, 4, null),
					new ExpectedCellValue(sheetName, 373, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 374, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 375, 4, null),
					new ExpectedCellValue(sheetName, 376, 4, null),
					new ExpectedCellValue(sheetName, 377, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 378, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 379, 4, null),
					new ExpectedCellValue(sheetName, 380, 4, null),
					new ExpectedCellValue(sheetName, 381, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 382, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 383, 4, null),
					new ExpectedCellValue(sheetName, 384, 4, null),
					new ExpectedCellValue(sheetName, 385, 4, null),
					new ExpectedCellValue(sheetName, 386, 4, null),
					new ExpectedCellValue(sheetName, 387, 4, null),
					new ExpectedCellValue(sheetName, 388, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 389, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 390, 4, null),
					new ExpectedCellValue(sheetName, 391, 4, null),
					new ExpectedCellValue(sheetName, 392, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 393, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 394, 4, null),
					new ExpectedCellValue(sheetName, 395, 4, null),
					new ExpectedCellValue(sheetName, 396, 4, null),
					new ExpectedCellValue(sheetName, 397, 4, null),
					new ExpectedCellValue(sheetName, 398, 4, null),
					new ExpectedCellValue(sheetName, 399, 4, null),
					new ExpectedCellValue(sheetName, 360, 5, null),
					new ExpectedCellValue(sheetName, 361, 5, null),
					new ExpectedCellValue(sheetName, 362, 5, 415.75),
					new ExpectedCellValue(sheetName, 363, 5, 831.5),
					new ExpectedCellValue(sheetName, 364, 5, 415.75),
					new ExpectedCellValue(sheetName, 365, 5, 831.5),
					new ExpectedCellValue(sheetName, 366, 5, 24.99),
					new ExpectedCellValue(sheetName, 367, 5, 24.99),
					new ExpectedCellValue(sheetName, 368, 5, 24.99),
					new ExpectedCellValue(sheetName, 369, 5, 24.99),
					new ExpectedCellValue(sheetName, 370, 5, 440.74),
					new ExpectedCellValue(sheetName, 371, 5, 856.49),
					new ExpectedCellValue(sheetName, 372, 5, null),
					new ExpectedCellValue(sheetName, 373, 5, 415.75),
					new ExpectedCellValue(sheetName, 374, 5, 831.5),
					new ExpectedCellValue(sheetName, 375, 5, 415.75),
					new ExpectedCellValue(sheetName, 376, 5, 831.5),
					new ExpectedCellValue(sheetName, 377, 5, 199d),
					new ExpectedCellValue(sheetName, 378, 5, 1194d),
					new ExpectedCellValue(sheetName, 379, 5, 199d),
					new ExpectedCellValue(sheetName, 380, 5, 1194d),
					new ExpectedCellValue(sheetName, 381, 5, 415.75),
					new ExpectedCellValue(sheetName, 382, 5, 831.5),
					new ExpectedCellValue(sheetName, 383, 5, 415.75),
					new ExpectedCellValue(sheetName, 384, 5, 831.5),
					new ExpectedCellValue(sheetName, 385, 5, 1030.5),
					new ExpectedCellValue(sheetName, 386, 5, 2857d),
					new ExpectedCellValue(sheetName, 387, 5, null),
					new ExpectedCellValue(sheetName, 388, 5, 415.75),
					new ExpectedCellValue(sheetName, 389, 5, 415.75),
					new ExpectedCellValue(sheetName, 390, 5, 415.75),
					new ExpectedCellValue(sheetName, 391, 5, 415.75),
					new ExpectedCellValue(sheetName, 392, 5, 99d),
					new ExpectedCellValue(sheetName, 393, 5, 99d),
					new ExpectedCellValue(sheetName, 394, 5, 99d),
					new ExpectedCellValue(sheetName, 395, 5, 99d),
					new ExpectedCellValue(sheetName, 396, 5, 514.75),
					new ExpectedCellValue(sheetName, 397, 5, 514.75),
					new ExpectedCellValue(sheetName, 398, 5, 1985.99),
					new ExpectedCellValue(sheetName, 399, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondAndThirdFieldsThirdDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable26"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G360:I413"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 360, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 361, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 362, 7, "January"),
					new ExpectedCellValue(sheetName, 363, 7, null),
					new ExpectedCellValue(sheetName, 364, 7, null),
					new ExpectedCellValue(sheetName, 365, 7, null),
					new ExpectedCellValue(sheetName, 366, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 367, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 368, 7, "March"),
					new ExpectedCellValue(sheetName, 369, 7, null),
					new ExpectedCellValue(sheetName, 370, 7, null),
					new ExpectedCellValue(sheetName, 371, 7, null),
					new ExpectedCellValue(sheetName, 372, 7, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 373, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 374, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 375, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 376, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 377, 7, "January"),
					new ExpectedCellValue(sheetName, 378, 7, null),
					new ExpectedCellValue(sheetName, 379, 7, null),
					new ExpectedCellValue(sheetName, 380, 7, null),
					new ExpectedCellValue(sheetName, 381, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 382, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 383, 7, "February"),
					new ExpectedCellValue(sheetName, 384, 7, null),
					new ExpectedCellValue(sheetName, 385, 7, null),
					new ExpectedCellValue(sheetName, 386, 7, null),
					new ExpectedCellValue(sheetName, 387, 7, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 388, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 389, 7, "March"),
					new ExpectedCellValue(sheetName, 390, 7, null),
					new ExpectedCellValue(sheetName, 391, 7, null),
					new ExpectedCellValue(sheetName, 392, 7, null),
					new ExpectedCellValue(sheetName, 393, 7, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 394, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 395, 7, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 396, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 397, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 398, 7, "January"),
					new ExpectedCellValue(sheetName, 399, 7, null),
					new ExpectedCellValue(sheetName, 400, 7, null),
					new ExpectedCellValue(sheetName, 401, 7, null),
					new ExpectedCellValue(sheetName, 402, 7, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 403, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 404, 7, "February"),
					new ExpectedCellValue(sheetName, 405, 7, null),
					new ExpectedCellValue(sheetName, 406, 7, null),
					new ExpectedCellValue(sheetName, 407, 7, null),
					new ExpectedCellValue(sheetName, 408, 7, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 409, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 410, 7, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 411, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 412, 7, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 413, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 360, 8, "Values"),
					new ExpectedCellValue(sheetName, 361, 8, null),
					new ExpectedCellValue(sheetName, 362, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 363, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 364, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 365, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 366, 8, null),
					new ExpectedCellValue(sheetName, 367, 8, null),
					new ExpectedCellValue(sheetName, 368, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 369, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 370, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 371, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 372, 8, null),
					new ExpectedCellValue(sheetName, 373, 8, null),
					new ExpectedCellValue(sheetName, 374, 8, null),
					new ExpectedCellValue(sheetName, 375, 8, null),
					new ExpectedCellValue(sheetName, 376, 8, null),
					new ExpectedCellValue(sheetName, 377, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 378, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 380, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 381, 8, null),
					new ExpectedCellValue(sheetName, 382, 8, null),
					new ExpectedCellValue(sheetName, 383, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 384, 8, "Tent"),
					new ExpectedCellValue(sheetName, 385, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 386, 8, "Tent"),
					new ExpectedCellValue(sheetName, 387, 8, null),
					new ExpectedCellValue(sheetName, 388, 8, null),
					new ExpectedCellValue(sheetName, 389, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 390, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 392, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 393, 8, null),
					new ExpectedCellValue(sheetName, 394, 8, null),
					new ExpectedCellValue(sheetName, 395, 8, null),
					new ExpectedCellValue(sheetName, 396, 8, null),
					new ExpectedCellValue(sheetName, 397, 8, null),
					new ExpectedCellValue(sheetName, 398, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 399, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 400, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 401, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 402, 8, null),
					new ExpectedCellValue(sheetName, 403, 8, null),
					new ExpectedCellValue(sheetName, 404, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 405, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 406, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 407, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 408, 8, null),
					new ExpectedCellValue(sheetName, 409, 8, null),
					new ExpectedCellValue(sheetName, 410, 8, null),
					new ExpectedCellValue(sheetName, 411, 8, null),
					new ExpectedCellValue(sheetName, 412, 8, null),
					new ExpectedCellValue(sheetName, 413, 8, null),
					new ExpectedCellValue(sheetName, 360, 9, null),
					new ExpectedCellValue(sheetName, 361, 9, null),
					new ExpectedCellValue(sheetName, 362, 9, null),
					new ExpectedCellValue(sheetName, 363, 9, 415.75),
					new ExpectedCellValue(sheetName, 364, 9, null),
					new ExpectedCellValue(sheetName, 365, 9, 831.5),
					new ExpectedCellValue(sheetName, 366, 9, 415.75),
					new ExpectedCellValue(sheetName, 367, 9, 831.5),
					new ExpectedCellValue(sheetName, 368, 9, null),
					new ExpectedCellValue(sheetName, 369, 9, 24.99),
					new ExpectedCellValue(sheetName, 370, 9, null),
					new ExpectedCellValue(sheetName, 371, 9, 24.99),
					new ExpectedCellValue(sheetName, 372, 9, 24.99),
					new ExpectedCellValue(sheetName, 373, 9, 24.99),
					new ExpectedCellValue(sheetName, 374, 9, 440.74),
					new ExpectedCellValue(sheetName, 375, 9, 856.49),
					new ExpectedCellValue(sheetName, 376, 9, null),
					new ExpectedCellValue(sheetName, 377, 9, null),
					new ExpectedCellValue(sheetName, 378, 9, 415.75),
					new ExpectedCellValue(sheetName, 379, 9, null),
					new ExpectedCellValue(sheetName, 380, 9, 831.5),
					new ExpectedCellValue(sheetName, 381, 9, 415.75),
					new ExpectedCellValue(sheetName, 382, 9, 831.5),
					new ExpectedCellValue(sheetName, 383, 9, null),
					new ExpectedCellValue(sheetName, 384, 9, 199d),
					new ExpectedCellValue(sheetName, 385, 9, null),
					new ExpectedCellValue(sheetName, 386, 9, 1194d),
					new ExpectedCellValue(sheetName, 387, 9, 199d),
					new ExpectedCellValue(sheetName, 388, 9, 1194d),
					new ExpectedCellValue(sheetName, 389, 9, null),
					new ExpectedCellValue(sheetName, 390, 9, 415.75),
					new ExpectedCellValue(sheetName, 391, 9, null),
					new ExpectedCellValue(sheetName, 392, 9, 831.5),
					new ExpectedCellValue(sheetName, 393, 9, 415.75),
					new ExpectedCellValue(sheetName, 394, 9, 831.5),
					new ExpectedCellValue(sheetName, 395, 9, 1030.5),
					new ExpectedCellValue(sheetName, 396, 9, 2857d),
					new ExpectedCellValue(sheetName, 397, 9, null),
					new ExpectedCellValue(sheetName, 398, 9, null),
					new ExpectedCellValue(sheetName, 399, 9, 415.75),
					new ExpectedCellValue(sheetName, 400, 9, null),
					new ExpectedCellValue(sheetName, 401, 9, 415.75),
					new ExpectedCellValue(sheetName, 402, 9, 415.75),
					new ExpectedCellValue(sheetName, 403, 9, 415.75),
					new ExpectedCellValue(sheetName, 404, 9, null),
					new ExpectedCellValue(sheetName, 405, 9, 99d),
					new ExpectedCellValue(sheetName, 406, 9, null),
					new ExpectedCellValue(sheetName, 407, 9, 99d),
					new ExpectedCellValue(sheetName, 408, 9, 99d),
					new ExpectedCellValue(sheetName, 409, 9, 99d),
					new ExpectedCellValue(sheetName, 410, 9, 514.75),
					new ExpectedCellValue(sheetName, 411, 9, 514.75),
					new ExpectedCellValue(sheetName, 412, 9, 1985.99),
					new ExpectedCellValue(sheetName, 413, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondAndThirdFieldsSecondDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable27"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L360:N405"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 360, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 361, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 362, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 363, 12, "January"),
					new ExpectedCellValue(sheetName, 364, 12, "January Total"),
					new ExpectedCellValue(sheetName, 365, 12, "March"),
					new ExpectedCellValue(sheetName, 366, 12, "March Total"),
					new ExpectedCellValue(sheetName, 367, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 368, 12, "January"),
					new ExpectedCellValue(sheetName, 369, 12, "January Total"),
					new ExpectedCellValue(sheetName, 370, 12, "March"),
					new ExpectedCellValue(sheetName, 371, 12, "March Total"),
					new ExpectedCellValue(sheetName, 372, 12, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 373, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 374, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 375, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 376, 12, "January"),
					new ExpectedCellValue(sheetName, 377, 12, "January Total"),
					new ExpectedCellValue(sheetName, 378, 12, "February"),
					new ExpectedCellValue(sheetName, 379, 12, "February Total"),
					new ExpectedCellValue(sheetName, 380, 12, "March"),
					new ExpectedCellValue(sheetName, 381, 12, "March Total"),
					new ExpectedCellValue(sheetName, 382, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 383, 12, "January"),
					new ExpectedCellValue(sheetName, 384, 12, "January Total"),
					new ExpectedCellValue(sheetName, 385, 12, "February"),
					new ExpectedCellValue(sheetName, 386, 12, "February Total"),
					new ExpectedCellValue(sheetName, 387, 12, "March"),
					new ExpectedCellValue(sheetName, 388, 12, "March Total"),
					new ExpectedCellValue(sheetName, 389, 12, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 390, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 391, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 392, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 393, 12, "January"),
					new ExpectedCellValue(sheetName, 394, 12, "January Total"),
					new ExpectedCellValue(sheetName, 395, 12, "February"),
					new ExpectedCellValue(sheetName, 396, 12, "February Total"),
					new ExpectedCellValue(sheetName, 397, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 398, 12, "January"),
					new ExpectedCellValue(sheetName, 399, 12, "January Total"),
					new ExpectedCellValue(sheetName, 400, 12, "February"),
					new ExpectedCellValue(sheetName, 401, 12, "February Total"),
					new ExpectedCellValue(sheetName, 402, 12, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 403, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 404, 12, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 405, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 360, 13, "Item"),
					new ExpectedCellValue(sheetName, 361, 13, null),
					new ExpectedCellValue(sheetName, 362, 13, null),
					new ExpectedCellValue(sheetName, 363, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 364, 13, null),
					new ExpectedCellValue(sheetName, 365, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 366, 13, null),
					new ExpectedCellValue(sheetName, 367, 13, null),
					new ExpectedCellValue(sheetName, 368, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 369, 13, null),
					new ExpectedCellValue(sheetName, 370, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 371, 13, null),
					new ExpectedCellValue(sheetName, 372, 13, null),
					new ExpectedCellValue(sheetName, 373, 13, null),
					new ExpectedCellValue(sheetName, 374, 13, null),
					new ExpectedCellValue(sheetName, 375, 13, null),
					new ExpectedCellValue(sheetName, 376, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 377, 13, null),
					new ExpectedCellValue(sheetName, 378, 13, "Tent"),
					new ExpectedCellValue(sheetName, 379, 13, null),
					new ExpectedCellValue(sheetName, 380, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 381, 13, null),
					new ExpectedCellValue(sheetName, 382, 13, null),
					new ExpectedCellValue(sheetName, 383, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 13, null),
					new ExpectedCellValue(sheetName, 385, 13, "Tent"),
					new ExpectedCellValue(sheetName, 386, 13, null),
					new ExpectedCellValue(sheetName, 387, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 13, null),
					new ExpectedCellValue(sheetName, 389, 13, null),
					new ExpectedCellValue(sheetName, 390, 13, null),
					new ExpectedCellValue(sheetName, 391, 13, null),
					new ExpectedCellValue(sheetName, 392, 13, null),
					new ExpectedCellValue(sheetName, 393, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 394, 13, null),
					new ExpectedCellValue(sheetName, 395, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 396, 13, null),
					new ExpectedCellValue(sheetName, 397, 13, null),
					new ExpectedCellValue(sheetName, 398, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 399, 13, null),
					new ExpectedCellValue(sheetName, 400, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 401, 13, null),
					new ExpectedCellValue(sheetName, 402, 13, null),
					new ExpectedCellValue(sheetName, 403, 13, null),
					new ExpectedCellValue(sheetName, 404, 13, null),
					new ExpectedCellValue(sheetName, 405, 13, null),
					new ExpectedCellValue(sheetName, 360, 14, null),
					new ExpectedCellValue(sheetName, 361, 14, null),
					new ExpectedCellValue(sheetName, 362, 14, null),
					new ExpectedCellValue(sheetName, 363, 14, 415.75),
					new ExpectedCellValue(sheetName, 364, 14, 415.75),
					new ExpectedCellValue(sheetName, 365, 14, 24.99),
					new ExpectedCellValue(sheetName, 366, 14, 24.99),
					new ExpectedCellValue(sheetName, 367, 14, null),
					new ExpectedCellValue(sheetName, 368, 14, 831.5),
					new ExpectedCellValue(sheetName, 369, 14, 831.5),
					new ExpectedCellValue(sheetName, 370, 14, 24.99),
					new ExpectedCellValue(sheetName, 371, 14, 24.99),
					new ExpectedCellValue(sheetName, 372, 14, 440.74),
					new ExpectedCellValue(sheetName, 373, 14, 856.49),
					new ExpectedCellValue(sheetName, 374, 14, null),
					new ExpectedCellValue(sheetName, 375, 14, null),
					new ExpectedCellValue(sheetName, 376, 14, 415.75),
					new ExpectedCellValue(sheetName, 377, 14, 415.75),
					new ExpectedCellValue(sheetName, 378, 14, 199d),
					new ExpectedCellValue(sheetName, 379, 14, 199d),
					new ExpectedCellValue(sheetName, 380, 14, 415.75),
					new ExpectedCellValue(sheetName, 381, 14, 415.75),
					new ExpectedCellValue(sheetName, 382, 14, null),
					new ExpectedCellValue(sheetName, 383, 14, 831.5),
					new ExpectedCellValue(sheetName, 384, 14, 831.5),
					new ExpectedCellValue(sheetName, 385, 14, 1194d),
					new ExpectedCellValue(sheetName, 386, 14, 1194d),
					new ExpectedCellValue(sheetName, 387, 14, 831.5),
					new ExpectedCellValue(sheetName, 388, 14, 831.5),
					new ExpectedCellValue(sheetName, 389, 14, 1030.5),
					new ExpectedCellValue(sheetName, 390, 14, 2857d),
					new ExpectedCellValue(sheetName, 391, 14, null),
					new ExpectedCellValue(sheetName, 392, 14, null),
					new ExpectedCellValue(sheetName, 393, 14, 415.75),
					new ExpectedCellValue(sheetName, 394, 14, 415.75),
					new ExpectedCellValue(sheetName, 395, 14, 99d),
					new ExpectedCellValue(sheetName, 396, 14, 99d),
					new ExpectedCellValue(sheetName, 397, 14, null),
					new ExpectedCellValue(sheetName, 398, 14, 415.75),
					new ExpectedCellValue(sheetName, 399, 14, 415.75),
					new ExpectedCellValue(sheetName, 400, 14, 99d),
					new ExpectedCellValue(sheetName, 401, 14, 99d),
					new ExpectedCellValue(sheetName, 402, 14, 514.75),
					new ExpectedCellValue(sheetName, 403, 14, 514.75),
					new ExpectedCellValue(sheetName, 404, 14, 1985.99),
					new ExpectedCellValue(sheetName, 405, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsThreeRowFieldsTabularSecondAndThirdFieldsFirstDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable28"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P360:R398"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 360, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 361, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 362, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 363, 16, "January"),
					new ExpectedCellValue(sheetName, 364, 16, "January Total"),
					new ExpectedCellValue(sheetName, 365, 16, "March"),
					new ExpectedCellValue(sheetName, 366, 16, "March Total"),
					new ExpectedCellValue(sheetName, 367, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 368, 16, "January"),
					new ExpectedCellValue(sheetName, 369, 16, "January Total"),
					new ExpectedCellValue(sheetName, 370, 16, "February"),
					new ExpectedCellValue(sheetName, 371, 16, "February Total"),
					new ExpectedCellValue(sheetName, 372, 16, "March"),
					new ExpectedCellValue(sheetName, 373, 16, "March Total"),
					new ExpectedCellValue(sheetName, 374, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 375, 16, "January"),
					new ExpectedCellValue(sheetName, 376, 16, "January Total"),
					new ExpectedCellValue(sheetName, 377, 16, "February"),
					new ExpectedCellValue(sheetName, 378, 16, "February Total"),
					new ExpectedCellValue(sheetName, 379, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 380, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 381, 16, "January"),
					new ExpectedCellValue(sheetName, 382, 16, "January Total"),
					new ExpectedCellValue(sheetName, 383, 16, "March"),
					new ExpectedCellValue(sheetName, 384, 16, "March Total"),
					new ExpectedCellValue(sheetName, 385, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 386, 16, "January"),
					new ExpectedCellValue(sheetName, 387, 16, "January Total"),
					new ExpectedCellValue(sheetName, 388, 16, "February"),
					new ExpectedCellValue(sheetName, 389, 16, "February Total"),
					new ExpectedCellValue(sheetName, 390, 16, "March"),
					new ExpectedCellValue(sheetName, 391, 16, "March Total"),
					new ExpectedCellValue(sheetName, 392, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 393, 16, "January"),
					new ExpectedCellValue(sheetName, 394, 16, "January Total"),
					new ExpectedCellValue(sheetName, 395, 16, "February"),
					new ExpectedCellValue(sheetName, 396, 16, "February Total"),
					new ExpectedCellValue(sheetName, 397, 16, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 398, 16, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 360, 17, "Item"),
					new ExpectedCellValue(sheetName, 361, 17, null),
					new ExpectedCellValue(sheetName, 362, 17, null),
					new ExpectedCellValue(sheetName, 363, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 364, 17, null),
					new ExpectedCellValue(sheetName, 365, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 366, 17, null),
					new ExpectedCellValue(sheetName, 367, 17, null),
					new ExpectedCellValue(sheetName, 368, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 369, 17, null),
					new ExpectedCellValue(sheetName, 370, 17, "Tent"),
					new ExpectedCellValue(sheetName, 371, 17, null),
					new ExpectedCellValue(sheetName, 372, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 17, null),
					new ExpectedCellValue(sheetName, 374, 17, null),
					new ExpectedCellValue(sheetName, 375, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 376, 17, null),
					new ExpectedCellValue(sheetName, 377, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 378, 17, null),
					new ExpectedCellValue(sheetName, 379, 17, null),
					new ExpectedCellValue(sheetName, 380, 17, null),
					new ExpectedCellValue(sheetName, 381, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 382, 17, null),
					new ExpectedCellValue(sheetName, 383, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 384, 17, null),
					new ExpectedCellValue(sheetName, 385, 17, null),
					new ExpectedCellValue(sheetName, 386, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 387, 17, null),
					new ExpectedCellValue(sheetName, 388, 17, "Tent"),
					new ExpectedCellValue(sheetName, 389, 17, null),
					new ExpectedCellValue(sheetName, 390, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 17, null),
					new ExpectedCellValue(sheetName, 392, 17, null),
					new ExpectedCellValue(sheetName, 393, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 394, 17, null),
					new ExpectedCellValue(sheetName, 395, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 396, 17, null),
					new ExpectedCellValue(sheetName, 397, 17, null),
					new ExpectedCellValue(sheetName, 398, 17, null),
					new ExpectedCellValue(sheetName, 360, 18, null),
					new ExpectedCellValue(sheetName, 361, 18, null),
					new ExpectedCellValue(sheetName, 362, 18, 440.74),
					new ExpectedCellValue(sheetName, 363, 18, 415.75),
					new ExpectedCellValue(sheetName, 364, 18, 415.75),
					new ExpectedCellValue(sheetName, 365, 18, 24.99),
					new ExpectedCellValue(sheetName, 366, 18, 24.99),
					new ExpectedCellValue(sheetName, 367, 18, 1030.5),
					new ExpectedCellValue(sheetName, 368, 18, 415.75),
					new ExpectedCellValue(sheetName, 369, 18, 415.75),
					new ExpectedCellValue(sheetName, 370, 18, 199d),
					new ExpectedCellValue(sheetName, 371, 18, 199d),
					new ExpectedCellValue(sheetName, 372, 18, 415.75),
					new ExpectedCellValue(sheetName, 373, 18, 415.75),
					new ExpectedCellValue(sheetName, 374, 18, 514.75),
					new ExpectedCellValue(sheetName, 375, 18, 415.75),
					new ExpectedCellValue(sheetName, 376, 18, 415.75),
					new ExpectedCellValue(sheetName, 377, 18, 99d),
					new ExpectedCellValue(sheetName, 378, 18, 99d),
					new ExpectedCellValue(sheetName, 379, 18, null),
					new ExpectedCellValue(sheetName, 380, 18, 856.49),
					new ExpectedCellValue(sheetName, 381, 18, 831.5),
					new ExpectedCellValue(sheetName, 382, 18, 831.5),
					new ExpectedCellValue(sheetName, 383, 18, 24.99),
					new ExpectedCellValue(sheetName, 384, 18, 24.99),
					new ExpectedCellValue(sheetName, 385, 18, 2857d),
					new ExpectedCellValue(sheetName, 386, 18, 831.5),
					new ExpectedCellValue(sheetName, 387, 18, 831.5),
					new ExpectedCellValue(sheetName, 388, 18, 1194d),
					new ExpectedCellValue(sheetName, 389, 18, 1194d),
					new ExpectedCellValue(sheetName, 390, 18, 831.5),
					new ExpectedCellValue(sheetName, 391, 18, 831.5),
					new ExpectedCellValue(sheetName, 392, 18, 514.75),
					new ExpectedCellValue(sheetName, 393, 18, 415.75),
					new ExpectedCellValue(sheetName, 394, 18, 415.75),
					new ExpectedCellValue(sheetName, 395, 18, 99d),
					new ExpectedCellValue(sheetName, 396, 18, 99d),
					new ExpectedCellValue(sheetName, 397, 18, 1985.99),
					new ExpectedCellValue(sheetName, 398, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableTabularSettingsMultipleDataFields.xlsx")]
		public void PivotTableRefreshWithTabularFieldSettingsEnabledMultipleDataFieldsFourRowFieldsAllTabularFieldsLeafDataFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableTabularSettingsMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("B2:G60"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 2, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 2, 20100007),
					new ExpectedCellValue(sheetName, 4, 2, null),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, "20100007 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 2, "20100007 Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 2, 20100017),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, "20100017 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 2, "20100017 Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 2, 20100070),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, "20100070 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 2, "20100070 Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 2, 20100076),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, "20100076 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 2, "20100076 Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 2, 20100083),
					new ExpectedCellValue(sheetName, 36, 2, null),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, "20100083 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 2, "20100083 Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 2, 20100085),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, null),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, "20100085 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 2, "20100085 Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 2, 20100090),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, null),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, "20100090 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 58, 2, "20100090 Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 2, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 60, 2, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 3, "Location"),
					new ExpectedCellValue(sheetName, 3, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, null),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 8, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 40, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 48, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 56, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, null),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Month"),
					new ExpectedCellValue(sheetName, 3, 4, "January"),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 6, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, "March"),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, "February"),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, "January"),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, "March"),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 38, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, "February"),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 46, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, null),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, "January"),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 54, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 55, 4, null),
					new ExpectedCellValue(sheetName, 56, 4, null),
					new ExpectedCellValue(sheetName, 57, 4, null),
					new ExpectedCellValue(sheetName, 58, 4, null),
					new ExpectedCellValue(sheetName, 59, 4, null),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, "Item"),
					new ExpectedCellValue(sheetName, 3, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, null),
					new ExpectedCellValue(sheetName, 7, 5, null),
					new ExpectedCellValue(sheetName, 8, 5, null),
					new ExpectedCellValue(sheetName, 9, 5, null),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, "Tent"),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, null),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, null),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, null),
					new ExpectedCellValue(sheetName, 55, 5, null),
					new ExpectedCellValue(sheetName, 56, 5, null),
					new ExpectedCellValue(sheetName, 57, 5, null),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, null),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 2, 6, "Values"),
					new ExpectedCellValue(sheetName, 3, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, null),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, null),
					new ExpectedCellValue(sheetName, 25, 6, null),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, null),
					new ExpectedCellValue(sheetName, 35, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, null),
					new ExpectedCellValue(sheetName, 41, 6, null),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, null),
					new ExpectedCellValue(sheetName, 47, 6, null),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, null),
					new ExpectedCellValue(sheetName, 51, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, null),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, null),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 2, 7, null),
					new ExpectedCellValue(sheetName, 3, 7, 415.75),
					new ExpectedCellValue(sheetName, 4, 7, 831.5),
					new ExpectedCellValue(sheetName, 5, 7, 415.75),
					new ExpectedCellValue(sheetName, 6, 7, 831.5),
					new ExpectedCellValue(sheetName, 7, 7, 415.75),
					new ExpectedCellValue(sheetName, 8, 7, 831.5),
					new ExpectedCellValue(sheetName, 9, 7, 415.75),
					new ExpectedCellValue(sheetName, 10, 7, 831.5),
					new ExpectedCellValue(sheetName, 11, 7, 415.75),
					new ExpectedCellValue(sheetName, 12, 7, 831.5),
					new ExpectedCellValue(sheetName, 13, 7, 415.75),
					new ExpectedCellValue(sheetName, 14, 7, 831.5),
					new ExpectedCellValue(sheetName, 15, 7, 415.75),
					new ExpectedCellValue(sheetName, 16, 7, 831.5),
					new ExpectedCellValue(sheetName, 17, 7, 415.75),
					new ExpectedCellValue(sheetName, 18, 7, 831.5),
					new ExpectedCellValue(sheetName, 19, 7, 199d),
					new ExpectedCellValue(sheetName, 20, 7, 1194d),
					new ExpectedCellValue(sheetName, 21, 7, 199d),
					new ExpectedCellValue(sheetName, 22, 7, 1194d),
					new ExpectedCellValue(sheetName, 23, 7, 199d),
					new ExpectedCellValue(sheetName, 24, 7, 1194d),
					new ExpectedCellValue(sheetName, 25, 7, 199d),
					new ExpectedCellValue(sheetName, 26, 7, 1194d),
					new ExpectedCellValue(sheetName, 27, 7, 415.75),
					new ExpectedCellValue(sheetName, 28, 7, 415.75),
					new ExpectedCellValue(sheetName, 29, 7, 415.75),
					new ExpectedCellValue(sheetName, 30, 7, 415.75),
					new ExpectedCellValue(sheetName, 31, 7, 415.75),
					new ExpectedCellValue(sheetName, 32, 7, 415.75),
					new ExpectedCellValue(sheetName, 33, 7, 415.75),
					new ExpectedCellValue(sheetName, 34, 7, 415.75),
					new ExpectedCellValue(sheetName, 35, 7, 24.99),
					new ExpectedCellValue(sheetName, 36, 7, 24.99),
					new ExpectedCellValue(sheetName, 37, 7, 24.99),
					new ExpectedCellValue(sheetName, 38, 7, 24.99),
					new ExpectedCellValue(sheetName, 39, 7, 24.99),
					new ExpectedCellValue(sheetName, 40, 7, 24.99),
					new ExpectedCellValue(sheetName, 41, 7, 24.99),
					new ExpectedCellValue(sheetName, 42, 7, 24.99),
					new ExpectedCellValue(sheetName, 43, 7, 99d),
					new ExpectedCellValue(sheetName, 44, 7, 99d),
					new ExpectedCellValue(sheetName, 45, 7, 99d),
					new ExpectedCellValue(sheetName, 46, 7, 99d),
					new ExpectedCellValue(sheetName, 47, 7, 99d),
					new ExpectedCellValue(sheetName, 48, 7, 99d),
					new ExpectedCellValue(sheetName, 49, 7, 99d),
					new ExpectedCellValue(sheetName, 50, 7, 99d),
					new ExpectedCellValue(sheetName, 51, 7, 415.75),
					new ExpectedCellValue(sheetName, 52, 7, 831.5),
					new ExpectedCellValue(sheetName, 53, 7, 415.75),
					new ExpectedCellValue(sheetName, 54, 7, 831.5),
					new ExpectedCellValue(sheetName, 55, 7, 415.75),
					new ExpectedCellValue(sheetName, 56, 7, 831.5),
					new ExpectedCellValue(sheetName, 57, 7, 415.75),
					new ExpectedCellValue(sheetName, 58, 7, 831.5),
					new ExpectedCellValue(sheetName, 59, 7, 1985.99),
					new ExpectedCellValue(sheetName, 60, 7, 4228.24)
				});
			}
		}
		#endregion
		#endregion

		#region Compact Form
		// 2 Row Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:C13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, "March"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "January"),
					new ExpectedCellValue(sheetName, 8, 2, "February"),
					new ExpectedCellValue(sheetName, 9, 2, "March"),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, "January"),
					new ExpectedCellValue(sheetName, 12, 2, "February"),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 3, 856.49),
					new ExpectedCellValue(sheetName, 4, 3, 831.5),
					new ExpectedCellValue(sheetName, 5, 3, 24.99),
					new ExpectedCellValue(sheetName, 6, 3, 2857d),
					new ExpectedCellValue(sheetName, 7, 3, 831.5),
					new ExpectedCellValue(sheetName, 8, 3, 1194d),
					new ExpectedCellValue(sheetName, 9, 3, 831.5),
					new ExpectedCellValue(sheetName, 10, 3, 514.75),
					new ExpectedCellValue(sheetName, 11, 3, 415.75),
					new ExpectedCellValue(sheetName, 12, 3, 99d),
					new ExpectedCellValue(sheetName, 13, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsFirstFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:C16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 7, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 12, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 16, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, "March"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "January"),
					new ExpectedCellValue(sheetName, 9, 2, "February"),
					new ExpectedCellValue(sheetName, 10, 2, "March"),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, "January"),
					new ExpectedCellValue(sheetName, 14, 2, "February"),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, 831.5),
					new ExpectedCellValue(sheetName, 5, 3, 24.99),
					new ExpectedCellValue(sheetName, 6, 3, 856.49),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, 831.5),
					new ExpectedCellValue(sheetName, 9, 3, 1194d),
					new ExpectedCellValue(sheetName, 10, 3, 831.5),
					new ExpectedCellValue(sheetName, 11, 3, 2857d),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, 415.75),
					new ExpectedCellValue(sheetName, 14, 3, 99d),
					new ExpectedCellValue(sheetName, 15, 3, 514.75),
					new ExpectedCellValue(sheetName, 16, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsBothFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:H13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, "Month"),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, "March"),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, "January"),
					new ExpectedCellValue(sheetName, 8, 7, "February"),
					new ExpectedCellValue(sheetName, 9, 7, "March"),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, "January"),
					new ExpectedCellValue(sheetName, 12, 7, "February"),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 2, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 8, 856.49),
					new ExpectedCellValue(sheetName, 4, 8, 831.5),
					new ExpectedCellValue(sheetName, 5, 8, 24.99),
					new ExpectedCellValue(sheetName, 6, 8, 2857d),
					new ExpectedCellValue(sheetName, 7, 8, 831.5),
					new ExpectedCellValue(sheetName, 8, 8, 1194d),
					new ExpectedCellValue(sheetName, 9, 8, 831.5),
					new ExpectedCellValue(sheetName, 10, 8, 514.75),
					new ExpectedCellValue(sheetName, 11, 8, 415.75),
					new ExpectedCellValue(sheetName, 12, 8, 99d),
					new ExpectedCellValue(sheetName, 13, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsBothFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:H16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 7, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 12, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 16, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, "Month"),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, "March"),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, "January"),
					new ExpectedCellValue(sheetName, 9, 7, "February"),
					new ExpectedCellValue(sheetName, 10, 7, "March"),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, "January"),
					new ExpectedCellValue(sheetName, 14, 7, "February"),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 2, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, 831.5),
					new ExpectedCellValue(sheetName, 5, 8, 24.99),
					new ExpectedCellValue(sheetName, 6, 8, 856.49),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, 831.5),
					new ExpectedCellValue(sheetName, 9, 8, 1194d),
					new ExpectedCellValue(sheetName, 10, 8, 831.5),
					new ExpectedCellValue(sheetName, 11, 8, 2857d),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, 415.75),
					new ExpectedCellValue(sheetName, 14, 8, 99d),
					new ExpectedCellValue(sheetName, 15, 8, 514.75),
					new ExpectedCellValue(sheetName, 16, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K2:L13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 11, "January"),
					new ExpectedCellValue(sheetName, 5, 11, "March"),
					new ExpectedCellValue(sheetName, 6, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 11, "January"),
					new ExpectedCellValue(sheetName, 8, 11, "February"),
					new ExpectedCellValue(sheetName, 9, 11, "March"),
					new ExpectedCellValue(sheetName, 10, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 11, "January"),
					new ExpectedCellValue(sheetName, 12, 11, "February"),
					new ExpectedCellValue(sheetName, 13, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 12, 856.49),
					new ExpectedCellValue(sheetName, 4, 12, 831.5),
					new ExpectedCellValue(sheetName, 5, 12, 24.99),
					new ExpectedCellValue(sheetName, 6, 12, 2857d),
					new ExpectedCellValue(sheetName, 7, 12, 831.5),
					new ExpectedCellValue(sheetName, 8, 12, 1194d),
					new ExpectedCellValue(sheetName, 9, 12, 831.5),
					new ExpectedCellValue(sheetName, 10, 12, 514.75),
					new ExpectedCellValue(sheetName, 11, 12, 415.75),
					new ExpectedCellValue(sheetName, 12, 12, 99d),
					new ExpectedCellValue(sheetName, 13, 12, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsLastFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K2:L16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 11, "January"),
					new ExpectedCellValue(sheetName, 5, 11, "March"),
					new ExpectedCellValue(sheetName, 6, 11, "Chicago Total"),
					new ExpectedCellValue(sheetName, 7, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 11, "January"),
					new ExpectedCellValue(sheetName, 9, 11, "February"),
					new ExpectedCellValue(sheetName, 10, 11, "March"),
					new ExpectedCellValue(sheetName, 11, 11, "Nashville Total"),
					new ExpectedCellValue(sheetName, 12, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 11, "January"),
					new ExpectedCellValue(sheetName, 14, 11, "February"),
					new ExpectedCellValue(sheetName, 15, 11, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 16, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 2,	12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3,	12, null),
					new ExpectedCellValue(sheetName, 4,	12, 831.5),
					new ExpectedCellValue(sheetName, 5,	12, 24.99),
					new ExpectedCellValue(sheetName, 6,	12, 856.49),
					new ExpectedCellValue(sheetName, 7,	12, null),
					new ExpectedCellValue(sheetName, 8,	12, 831.5),
					new ExpectedCellValue(sheetName, 9,	12, 1194d),
					new ExpectedCellValue(sheetName, 10, 12, 831.5),
					new ExpectedCellValue(sheetName, 11, 12, 2857d),
					new ExpectedCellValue(sheetName, 12, 12, null),
					new ExpectedCellValue(sheetName, 13, 12, 415.75),
					new ExpectedCellValue(sheetName, 14, 12, 99d),
					new ExpectedCellValue(sheetName, 15, 12, 514.75),
					new ExpectedCellValue(sheetName, 16, 12, 4228.24)
				});
			}
		}

		// 3 Row Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsAllFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:D20"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 1, null),
					new ExpectedCellValue(sheetName, 17, 1, null),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, null),
					new ExpectedCellValue(sheetName, 20, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, "March"),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, "January"),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, "February"),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, "March"),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, "January"),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, "February"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Item"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, "Tent"),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 4, 856.49),
					new ExpectedCellValue(sheetName, 4, 4, 831.5),
					new ExpectedCellValue(sheetName, 5, 4, 831.5),
					new ExpectedCellValue(sheetName, 6, 4, 24.99),
					new ExpectedCellValue(sheetName, 7, 4, 24.99),
					new ExpectedCellValue(sheetName, 8, 4, 2857d),
					new ExpectedCellValue(sheetName, 9, 4, 831.5),
					new ExpectedCellValue(sheetName, 10, 4, 831.5),
					new ExpectedCellValue(sheetName, 11, 4, 1194d),
					new ExpectedCellValue(sheetName, 12, 4, 1194d),
					new ExpectedCellValue(sheetName, 13, 4, 831.5),
					new ExpectedCellValue(sheetName, 14, 4, 831.5),
					new ExpectedCellValue(sheetName, 15, 4, 514.75),
					new ExpectedCellValue(sheetName, 16, 4, 415.75),
					new ExpectedCellValue(sheetName, 17, 4, 415.75),
					new ExpectedCellValue(sheetName, 18, 4, 99d),
					new ExpectedCellValue(sheetName, 19, 4, 99d),
					new ExpectedCellValue(sheetName, 20, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsAllFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:D30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 11, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, null),
					new ExpectedCellValue(sheetName, 16, 1, null),
					new ExpectedCellValue(sheetName, 17, 1, null),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, null),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 1, null),
					new ExpectedCellValue(sheetName, 24, 1, null),
					new ExpectedCellValue(sheetName, 25, 1, null),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, null),
					new ExpectedCellValue(sheetName, 28, 1, null),
					new ExpectedCellValue(sheetName, 29, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, "January Total"),
					new ExpectedCellValue(sheetName, 7, 2, "March"),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, "March Total"),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, "January"),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, "January Total"),
					new ExpectedCellValue(sheetName, 15, 2, "February"),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, "February Total"),
					new ExpectedCellValue(sheetName, 18, 2, "March"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, "March Total"),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, "January"),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, "January Total"),
					new ExpectedCellValue(sheetName, 26, 2, "February"),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, "February Total"),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Item"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, "Tent"),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 4, 831.5),
					new ExpectedCellValue(sheetName, 6, 4, 831.5),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 4, 24.99),
					new ExpectedCellValue(sheetName, 9, 4, 24.99),
					new ExpectedCellValue(sheetName, 10, 4, 856.49),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 4, 831.5),
					new ExpectedCellValue(sheetName, 14, 4, 831.5),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 4, 1194d),
					new ExpectedCellValue(sheetName, 17, 4, 1194d),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 4, 831.5),
					new ExpectedCellValue(sheetName, 20, 4, 831.5),
					new ExpectedCellValue(sheetName, 21, 4, 2857d),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 4, 415.75),
					new ExpectedCellValue(sheetName, 25, 4, 415.75),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 4, 99d),
					new ExpectedCellValue(sheetName, 28, 4, 99d),
					new ExpectedCellValue(sheetName, 29, 4, 514.75),
					new ExpectedCellValue(sheetName, 30, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsFirstAndSecondFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:I20"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, "Month"),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, "March"),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, "January"),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, "February"),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, "March"),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, "January"),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, "February"),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 2, 8, "Item"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, "Tent"),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 9, 856.49),
					new ExpectedCellValue(sheetName, 4, 9, 831.5),
					new ExpectedCellValue(sheetName, 5, 9, 831.5),
					new ExpectedCellValue(sheetName, 6, 9, 24.99),
					new ExpectedCellValue(sheetName, 7, 9, 24.99),
					new ExpectedCellValue(sheetName, 8, 9, 2857d),
					new ExpectedCellValue(sheetName, 9, 9, 831.5),
					new ExpectedCellValue(sheetName, 10, 9, 831.5),
					new ExpectedCellValue(sheetName, 11, 9, 1194d),
					new ExpectedCellValue(sheetName, 12, 9, 1194d),
					new ExpectedCellValue(sheetName, 13, 9, 831.5),
					new ExpectedCellValue(sheetName, 14, 9, 831.5),
					new ExpectedCellValue(sheetName, 15, 9, 514.75),
					new ExpectedCellValue(sheetName, 16, 9, 415.75),
					new ExpectedCellValue(sheetName, 17, 9, 415.75),
					new ExpectedCellValue(sheetName, 18, 9, 99d),
					new ExpectedCellValue(sheetName, 19, 9, 99d),
					new ExpectedCellValue(sheetName, 20, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsFirstAndSecondFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:I30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 11, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, null),
					new ExpectedCellValue(sheetName, 25, 6, null),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, "Month"),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, "January Total"),
					new ExpectedCellValue(sheetName, 7, 7, "March"),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, "March Total"),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, "January"),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, "January Total"),
					new ExpectedCellValue(sheetName, 15, 7, "February"),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 17, 7, "February Total"),
					new ExpectedCellValue(sheetName, 18, 7, "March"),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, "March Total"),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, "January"),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, "January Total"),
					new ExpectedCellValue(sheetName, 26, 7, "February"),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, "February Total"),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 2, 8, "Item"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "Tent"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 9, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, 831.5),
					new ExpectedCellValue(sheetName, 6, 9, 831.5),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, 24.99),
					new ExpectedCellValue(sheetName, 9, 9, 24.99),
					new ExpectedCellValue(sheetName, 10, 9, 856.49),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, 831.5),
					new ExpectedCellValue(sheetName, 14, 9, 831.5),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, 1194d),
					new ExpectedCellValue(sheetName, 17, 9, 1194d),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, 831.5),
					new ExpectedCellValue(sheetName, 20, 9, 831.5),
					new ExpectedCellValue(sheetName, 21, 9, 2857d),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, 415.75),
					new ExpectedCellValue(sheetName, 25, 9, 415.75),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, 99d),
					new ExpectedCellValue(sheetName, 28, 9, 99d),
					new ExpectedCellValue(sheetName, 29, 9, 514.75),
					new ExpectedCellValue(sheetName, 30, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsFirstAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K2:M20"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 12, "Month"),
					new ExpectedCellValue(sheetName, 3, 12, null),
					new ExpectedCellValue(sheetName, 4, 12, "January"),
					new ExpectedCellValue(sheetName, 5, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 12, "March"),
					new ExpectedCellValue(sheetName, 7, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 12, null),
					new ExpectedCellValue(sheetName, 9, 12, "January"),
					new ExpectedCellValue(sheetName, 10, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 12, "February"),
					new ExpectedCellValue(sheetName, 12, 12, "Tent"),
					new ExpectedCellValue(sheetName, 13, 12, "March"),
					new ExpectedCellValue(sheetName, 14, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, "January"),
					new ExpectedCellValue(sheetName, 17, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 12, "February"),
					new ExpectedCellValue(sheetName, 19, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 2, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 13, 856.49),
					new ExpectedCellValue(sheetName, 4, 13, 831.5),
					new ExpectedCellValue(sheetName, 5, 13, 831.5),
					new ExpectedCellValue(sheetName, 6, 13, 24.99),
					new ExpectedCellValue(sheetName, 7, 13, 24.99),
					new ExpectedCellValue(sheetName, 8, 13, 2857d),
					new ExpectedCellValue(sheetName, 9, 13, 831.5),
					new ExpectedCellValue(sheetName, 10, 13, 831.5),
					new ExpectedCellValue(sheetName, 11, 13, 1194d),
					new ExpectedCellValue(sheetName, 12, 13, 1194d),
					new ExpectedCellValue(sheetName, 13, 13, 831.5),
					new ExpectedCellValue(sheetName, 14, 13, 831.5),
					new ExpectedCellValue(sheetName, 15, 13, 514.75),
					new ExpectedCellValue(sheetName, 16, 13, 415.75),
					new ExpectedCellValue(sheetName, 17, 13, 415.75),
					new ExpectedCellValue(sheetName, 18, 13, 99d),
					new ExpectedCellValue(sheetName, 19, 13, 99d),
					new ExpectedCellValue(sheetName, 20, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsFirstAndThirdFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K2:M30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 11, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, "Chicago Total"),
					new ExpectedCellValue(sheetName, 11, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 11, null),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 12, "Month"),
					new ExpectedCellValue(sheetName, 3, 12, null),
					new ExpectedCellValue(sheetName, 4, 12, "January"),
					new ExpectedCellValue(sheetName, 5, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 12, "January Total"),
					new ExpectedCellValue(sheetName, 7, 12, "March"),
					new ExpectedCellValue(sheetName, 8, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 9, 12, "March Total"),
					new ExpectedCellValue(sheetName, 10, 12, null),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, "January"),
					new ExpectedCellValue(sheetName, 13, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 12, "January Total"),
					new ExpectedCellValue(sheetName, 15, 12, "February"),
					new ExpectedCellValue(sheetName, 16, 12, "Tent"),
					new ExpectedCellValue(sheetName, 17, 12, "February Total"),
					new ExpectedCellValue(sheetName, 18, 12, "March"),
					new ExpectedCellValue(sheetName, 19, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 12, "March Total"),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, "January"),
					new ExpectedCellValue(sheetName, 24, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 12, "January Total"),
					new ExpectedCellValue(sheetName, 26, 12, "February"),
					new ExpectedCellValue(sheetName, 27, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 12, "February Total"),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 2, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 13, null),
					new ExpectedCellValue(sheetName, 4, 13, null),
					new ExpectedCellValue(sheetName, 5, 13, 831.5),
					new ExpectedCellValue(sheetName, 6, 13, 831.5),
					new ExpectedCellValue(sheetName, 7, 13, null),
					new ExpectedCellValue(sheetName, 8, 13, 24.99),
					new ExpectedCellValue(sheetName, 9, 13, 24.99),
					new ExpectedCellValue(sheetName, 10, 13, 856.49),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, 831.5),
					new ExpectedCellValue(sheetName, 14, 13, 831.5),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, 1194d),
					new ExpectedCellValue(sheetName, 17, 13, 1194d),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, 831.5),
					new ExpectedCellValue(sheetName, 20, 13, 831.5),
					new ExpectedCellValue(sheetName, 21, 13, 2857d),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, 415.75),
					new ExpectedCellValue(sheetName, 25, 13, 415.75),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, 99d),
					new ExpectedCellValue(sheetName, 28, 13, 99d),
					new ExpectedCellValue(sheetName, 29, 13, 514.75),
					new ExpectedCellValue(sheetName, 30, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O2:Q20"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, null),
					new ExpectedCellValue(sheetName, 6, 15, null),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 16, "Month"),
					new ExpectedCellValue(sheetName, 3, 16, null),
					new ExpectedCellValue(sheetName, 4, 16, "January"),
					new ExpectedCellValue(sheetName, 5, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 16, "March"),
					new ExpectedCellValue(sheetName, 7, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, "January"),
					new ExpectedCellValue(sheetName, 10, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 16, "February"),
					new ExpectedCellValue(sheetName, 12, 16, "Tent"),
					new ExpectedCellValue(sheetName, 13, 16, "March"),
					new ExpectedCellValue(sheetName, 14, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, "January"),
					new ExpectedCellValue(sheetName, 17, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 16, "February"),
					new ExpectedCellValue(sheetName, 19, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 2, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 17, 856.49),
					new ExpectedCellValue(sheetName, 4, 17, 831.5),
					new ExpectedCellValue(sheetName, 5, 17, 831.5),
					new ExpectedCellValue(sheetName, 6, 17, 24.99),
					new ExpectedCellValue(sheetName, 7, 17, 24.99),
					new ExpectedCellValue(sheetName, 8, 17, 2857d),
					new ExpectedCellValue(sheetName, 9, 17, 831.5),
					new ExpectedCellValue(sheetName, 10, 17, 831.5),
					new ExpectedCellValue(sheetName, 11, 17, 1194d),
					new ExpectedCellValue(sheetName, 12, 17, 1194d),
					new ExpectedCellValue(sheetName, 13, 17, 831.5),
					new ExpectedCellValue(sheetName, 14, 17, 831.5),
					new ExpectedCellValue(sheetName, 15, 17, 514.75),
					new ExpectedCellValue(sheetName, 16, 17, 415.75),
					new ExpectedCellValue(sheetName, 17, 17, 415.75),
					new ExpectedCellValue(sheetName, 18, 17, 99d),
					new ExpectedCellValue(sheetName, 19, 17, 99d),
					new ExpectedCellValue(sheetName, 20, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsFirstFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O2:Q30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 15, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, null),
					new ExpectedCellValue(sheetName, 6, 15, null),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, "Chicago Total"),
					new ExpectedCellValue(sheetName, 11, 15, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 15, "San Francisco"),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, null),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 29, 15, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 15, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 16, "Month"),
					new ExpectedCellValue(sheetName, 3, 16, null),
					new ExpectedCellValue(sheetName, 4, 16, "January"),
					new ExpectedCellValue(sheetName, 5, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 16, "January Total"),
					new ExpectedCellValue(sheetName, 7, 16, "March"),
					new ExpectedCellValue(sheetName, 8, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 9, 16, "March Total"),
					new ExpectedCellValue(sheetName, 10, 16, null),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, "January"),
					new ExpectedCellValue(sheetName, 13, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 16, "January Total"),
					new ExpectedCellValue(sheetName, 15, 16, "February"),
					new ExpectedCellValue(sheetName, 16, 16, "Tent"),
					new ExpectedCellValue(sheetName, 17, 16, "February Total"),
					new ExpectedCellValue(sheetName, 18, 16, "March"),
					new ExpectedCellValue(sheetName, 19, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 16, "March Total"),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, "January"),
					new ExpectedCellValue(sheetName, 24, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 16, "January Total"),
					new ExpectedCellValue(sheetName, 26, 16, "February"),
					new ExpectedCellValue(sheetName, 27, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 28, 16, "February Total"),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 2, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 17, null),
					new ExpectedCellValue(sheetName, 4, 17, null),
					new ExpectedCellValue(sheetName, 5, 17, 831.5),
					new ExpectedCellValue(sheetName, 6, 17, 831.5),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, 24.99),
					new ExpectedCellValue(sheetName, 9, 17, 24.99),
					new ExpectedCellValue(sheetName, 10, 17, 856.49),
					new ExpectedCellValue(sheetName, 11, 17, null),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, 831.5),
					new ExpectedCellValue(sheetName, 14, 17, 831.5),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, 1194d),
					new ExpectedCellValue(sheetName, 17, 17, 1194d),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, 831.5),
					new ExpectedCellValue(sheetName, 20, 17, 831.5),
					new ExpectedCellValue(sheetName, 21, 17, 2857d),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, 415.75),
					new ExpectedCellValue(sheetName, 25, 17, 415.75),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, 99d),
					new ExpectedCellValue(sheetName, 28, 17, 99d),
					new ExpectedCellValue(sheetName, 29, 17, 514.75),
					new ExpectedCellValue(sheetName, 30, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A51:B69"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 51, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 1, "January"),
					new ExpectedCellValue(sheetName, 54, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 1, "March"),
					new ExpectedCellValue(sheetName, 56, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 57, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 58, 1, "January"),
					new ExpectedCellValue(sheetName, 59, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 1, "February"),
					new ExpectedCellValue(sheetName, 61, 1, "Tent"),
					new ExpectedCellValue(sheetName, 62, 1, "March"),
					new ExpectedCellValue(sheetName, 63, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 64, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 65, 1, "January"),
					new ExpectedCellValue(sheetName, 66, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 67, 1, "February"),
					new ExpectedCellValue(sheetName, 68, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 69, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 51, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 2, 856.49),
					new ExpectedCellValue(sheetName, 53, 2, 831.5),
					new ExpectedCellValue(sheetName, 54, 2, 831.5),
					new ExpectedCellValue(sheetName, 55, 2, 24.99),
					new ExpectedCellValue(sheetName, 56, 2, 24.99),
					new ExpectedCellValue(sheetName, 57, 2, 2857d),
					new ExpectedCellValue(sheetName, 58, 2, 831.5),
					new ExpectedCellValue(sheetName, 59, 2, 831.5),
					new ExpectedCellValue(sheetName, 60, 2, 1194d),
					new ExpectedCellValue(sheetName, 61, 2, 1194d),
					new ExpectedCellValue(sheetName, 62, 2, 831.5),
					new ExpectedCellValue(sheetName, 63, 2, 831.5),
					new ExpectedCellValue(sheetName, 64, 2, 514.75),
					new ExpectedCellValue(sheetName, 65, 2, 415.75),
					new ExpectedCellValue(sheetName, 66, 2, 415.75),
					new ExpectedCellValue(sheetName, 67, 2, 99d),
					new ExpectedCellValue(sheetName, 68, 2, 99d),
					new ExpectedCellValue(sheetName, 69, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsLastFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A51:B79"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 51, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 1, "January"),
					new ExpectedCellValue(sheetName, 54, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 1, "January Total"),
					new ExpectedCellValue(sheetName, 56, 1, "March"),
					new ExpectedCellValue(sheetName, 57, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 58, 1, "March Total"),
					new ExpectedCellValue(sheetName, 59, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 60, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 61, 1, "January"),
					new ExpectedCellValue(sheetName, 62, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 1, "January Total"),
					new ExpectedCellValue(sheetName, 64, 1, "February"),
					new ExpectedCellValue(sheetName, 65, 1, "Tent"),
					new ExpectedCellValue(sheetName, 66, 1, "February Total"),
					new ExpectedCellValue(sheetName, 67, 1, "March"),
					new ExpectedCellValue(sheetName, 68, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 1, "March Total"),
					new ExpectedCellValue(sheetName, 70, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 71, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 72, 1, "January"),
					new ExpectedCellValue(sheetName, 73, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 1, "January Total"),
					new ExpectedCellValue(sheetName, 75, 1, "February"),
					new ExpectedCellValue(sheetName, 76, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 77, 1, "February Total"),
					new ExpectedCellValue(sheetName, 78, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 79, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 51, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, 831.5),
					new ExpectedCellValue(sheetName, 55, 2, 831.5),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, 24.99),
					new ExpectedCellValue(sheetName, 58, 2, 24.99),
					new ExpectedCellValue(sheetName, 59, 2, 856.49),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, 831.5),
					new ExpectedCellValue(sheetName, 63, 2, 831.5),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, 1194d),
					new ExpectedCellValue(sheetName, 66, 2, 1194d),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, 831.5),
					new ExpectedCellValue(sheetName, 69, 2, 831.5),
					new ExpectedCellValue(sheetName, 70, 2, 2857d),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, 415.75),
					new ExpectedCellValue(sheetName, 74, 2, 415.75),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, 99d),
					new ExpectedCellValue(sheetName, 77, 2, 99d),
					new ExpectedCellValue(sheetName, 78, 2, 514.75),
					new ExpectedCellValue(sheetName, 79, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsSecondFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("D51:F69"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 51, 4, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 4, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 4, "January"),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, "March"),
					new ExpectedCellValue(sheetName, 56, 4, null),
					new ExpectedCellValue(sheetName, 57, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 58, 4, "January"),
					new ExpectedCellValue(sheetName, 59, 4, null),
					new ExpectedCellValue(sheetName, 60, 4, "February"),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, "March"),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 65, 4, "January"),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, "February"),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, "Grand Total"),
					new ExpectedCellValue(sheetName, 51, 5, "Item"),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 5, null),
					new ExpectedCellValue(sheetName, 56, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 57, 5, null),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, "Tent"),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, null),
					new ExpectedCellValue(sheetName, 66, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 67, 5, null),
					new ExpectedCellValue(sheetName, 68, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 51, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 6, 856.49),
					new ExpectedCellValue(sheetName, 53, 6, 831.5),
					new ExpectedCellValue(sheetName, 54, 6, 831.5),
					new ExpectedCellValue(sheetName, 55, 6, 24.99),
					new ExpectedCellValue(sheetName, 56, 6, 24.99),
					new ExpectedCellValue(sheetName, 57, 6, 2857d),
					new ExpectedCellValue(sheetName, 58, 6, 831.5),
					new ExpectedCellValue(sheetName, 59, 6, 831.5),
					new ExpectedCellValue(sheetName, 60, 6, 1194d),
					new ExpectedCellValue(sheetName, 61, 6, 1194d),
					new ExpectedCellValue(sheetName, 62, 6, 831.5),
					new ExpectedCellValue(sheetName, 63, 6, 831.5),
					new ExpectedCellValue(sheetName, 64, 6, 514.75),
					new ExpectedCellValue(sheetName, 65, 6, 415.75),
					new ExpectedCellValue(sheetName, 66, 6, 415.75),
					new ExpectedCellValue(sheetName, 67, 6, 99d),
					new ExpectedCellValue(sheetName, 68, 6, 99d),
					new ExpectedCellValue(sheetName, 69, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsSecondFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("D51:F79"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 51, 4, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 4, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 4, "January"),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, "January Total"),
					new ExpectedCellValue(sheetName, 56, 4, "March"),
					new ExpectedCellValue(sheetName, 57, 4, null),
					new ExpectedCellValue(sheetName, 58, 4, "March Total"),
					new ExpectedCellValue(sheetName, 59, 4, "Chicago Total"),
					new ExpectedCellValue(sheetName, 60, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 61, 4, "January"),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, "January Total"),
					new ExpectedCellValue(sheetName, 64, 4, "February"),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 66, 4, "February Total"),
					new ExpectedCellValue(sheetName, 67, 4, "March"),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, "March Total"),
					new ExpectedCellValue(sheetName, 70, 4, "Nashville Total"),
					new ExpectedCellValue(sheetName, 71, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 72, 4, "January"),
					new ExpectedCellValue(sheetName, 73, 4, null),
					new ExpectedCellValue(sheetName, 74, 4, "January Total"),
					new ExpectedCellValue(sheetName, 75, 4, "February"),
					new ExpectedCellValue(sheetName, 76, 4, null),
					new ExpectedCellValue(sheetName, 77, 4, "February Total"),
					new ExpectedCellValue(sheetName, 78, 4, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 79, 4, "Grand Total"),
					new ExpectedCellValue(sheetName, 51, 5, "Item"),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 5, null),
					new ExpectedCellValue(sheetName, 56, 5, null),
					new ExpectedCellValue(sheetName, 57, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, null),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, null),
					new ExpectedCellValue(sheetName, 62, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 5, null),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, "Tent"),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, null),
					new ExpectedCellValue(sheetName, 68, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 70, 5, null),
					new ExpectedCellValue(sheetName, 71, 5, null),
					new ExpectedCellValue(sheetName, 72, 5, null),
					new ExpectedCellValue(sheetName, 73, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 5, null),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 77, 5, null),
					new ExpectedCellValue(sheetName, 78, 5, null),
					new ExpectedCellValue(sheetName, 79, 5, null),
					new ExpectedCellValue(sheetName, 51, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, 831.5),
					new ExpectedCellValue(sheetName, 55, 6, 831.5),
					new ExpectedCellValue(sheetName, 56, 6, null),
					new ExpectedCellValue(sheetName, 57, 6, 24.99),
					new ExpectedCellValue(sheetName, 58, 6, 24.99),
					new ExpectedCellValue(sheetName, 59, 6, 856.49),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, 831.5),
					new ExpectedCellValue(sheetName, 63, 6, 831.5),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, 1194d),
					new ExpectedCellValue(sheetName, 66, 6, 1194d),
					new ExpectedCellValue(sheetName, 67, 6, null),
					new ExpectedCellValue(sheetName, 68, 6, 831.5),
					new ExpectedCellValue(sheetName, 69, 6, 831.5),
					new ExpectedCellValue(sheetName, 70, 6, 2857d),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, null),
					new ExpectedCellValue(sheetName, 73, 6, 415.75),
					new ExpectedCellValue(sheetName, 74, 6, 415.75),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, 99d),
					new ExpectedCellValue(sheetName, 77, 6, 99d),
					new ExpectedCellValue(sheetName, 78, 6, 514.75),
					new ExpectedCellValue(sheetName, 79, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsSecondAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H51:J69"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 51, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 8, "January"),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, "March"),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 58, 8, "January"),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, "February"),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, "March"),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 65, 8, "January"),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, "February"),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 51, 9, "Item"),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, "Tent"),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 51, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 10, 856.49),
					new ExpectedCellValue(sheetName, 53, 10, 831.5),
					new ExpectedCellValue(sheetName, 54, 10, 831.5),
					new ExpectedCellValue(sheetName, 55, 10, 24.99),
					new ExpectedCellValue(sheetName, 56, 10, 24.99),
					new ExpectedCellValue(sheetName, 57, 10, 2857d),
					new ExpectedCellValue(sheetName, 58, 10, 831.5),
					new ExpectedCellValue(sheetName, 59, 10, 831.5),
					new ExpectedCellValue(sheetName, 60, 10, 1194d),
					new ExpectedCellValue(sheetName, 61, 10, 1194d),
					new ExpectedCellValue(sheetName, 62, 10, 831.5),
					new ExpectedCellValue(sheetName, 63, 10, 831.5),
					new ExpectedCellValue(sheetName, 64, 10, 514.75),
					new ExpectedCellValue(sheetName, 65, 10, 415.75),
					new ExpectedCellValue(sheetName, 66, 10, 415.75),
					new ExpectedCellValue(sheetName, 67, 10, 99d),
					new ExpectedCellValue(sheetName, 68, 10, 99d),
					new ExpectedCellValue(sheetName, 69, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsSecondAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H51:J79"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 51, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 52, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 53, 8, "January"),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, "January Total"),
					new ExpectedCellValue(sheetName, 56, 8, "March"),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, "March Total"),
					new ExpectedCellValue(sheetName, 59, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 60, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 61, 8, "January"),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, "January Total"),
					new ExpectedCellValue(sheetName, 64, 8, "February"),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, "February Total"),
					new ExpectedCellValue(sheetName, 67, 8, "March"),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, "March Total"),
					new ExpectedCellValue(sheetName, 70, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 71, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 72, 8, "January"),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, "January Total"),
					new ExpectedCellValue(sheetName, 75, 8, "February"),
					new ExpectedCellValue(sheetName, 76, 8, null),
					new ExpectedCellValue(sheetName, 77, 8, "February Total"),
					new ExpectedCellValue(sheetName, 78, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 79, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 51, 9, "Item"),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, "Tent"),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 70, 9, null),
					new ExpectedCellValue(sheetName, 71, 9, null),
					new ExpectedCellValue(sheetName, 72, 9, null),
					new ExpectedCellValue(sheetName, 73, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 9, null),
					new ExpectedCellValue(sheetName, 75, 9, null),
					new ExpectedCellValue(sheetName, 76, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, null),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 51, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, 831.5),
					new ExpectedCellValue(sheetName, 55, 10, 831.5),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, 24.99),
					new ExpectedCellValue(sheetName, 58, 10, 24.99),
					new ExpectedCellValue(sheetName, 59, 10, 856.49),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, null),
					new ExpectedCellValue(sheetName, 62, 10, 831.5),
					new ExpectedCellValue(sheetName, 63, 10, 831.5),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, 1194d),
					new ExpectedCellValue(sheetName, 66, 10, 1194d),
					new ExpectedCellValue(sheetName, 67, 10, null),
					new ExpectedCellValue(sheetName, 68, 10, 831.5),
					new ExpectedCellValue(sheetName, 69, 10, 831.5),
					new ExpectedCellValue(sheetName, 70, 10, 2857d),
					new ExpectedCellValue(sheetName, 71, 10, null),
					new ExpectedCellValue(sheetName, 72, 10, null),
					new ExpectedCellValue(sheetName, 73, 10, 415.75),
					new ExpectedCellValue(sheetName, 74, 10, 415.75),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, 99d),
					new ExpectedCellValue(sheetName, 77, 10, 99d),
					new ExpectedCellValue(sheetName, 78, 10, 514.75),
					new ExpectedCellValue(sheetName, 79, 10, 4228.24)
				});
			}
		}

		// 4 Row Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsAllFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:E31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, 20100007),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, 20100017),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, 20100070),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, 20100076),
					new ExpectedCellValue(sheetName, 16, 1, null),
					new ExpectedCellValue(sheetName, 17, 1, null),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, 20100083),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, null),
					new ExpectedCellValue(sheetName, 22, 1, null),
					new ExpectedCellValue(sheetName, 23, 1, 20100085),
					new ExpectedCellValue(sheetName, 24, 1, null),
					new ExpectedCellValue(sheetName, 25, 1, null),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, 20100090),
					new ExpectedCellValue(sheetName, 28, 1, null),
					new ExpectedCellValue(sheetName, 29, 1, null),
					new ExpectedCellValue(sheetName, 30, 1, null),
					new ExpectedCellValue(sheetName, 31, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Location"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "January"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, "March"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, "February"),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "January"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, "March"),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, "February"),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, "January"),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Item"),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, "Tent"),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 27, 4, null),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 5, 831.5),
					new ExpectedCellValue(sheetName, 4, 5, 831.5),
					new ExpectedCellValue(sheetName, 5, 5, 831.5),
					new ExpectedCellValue(sheetName, 6, 5, 831.5),
					new ExpectedCellValue(sheetName, 7, 5, 831.5),
					new ExpectedCellValue(sheetName, 8, 5, 831.5),
					new ExpectedCellValue(sheetName, 9, 5, 831.5),
					new ExpectedCellValue(sheetName, 10, 5, 831.5),
					new ExpectedCellValue(sheetName, 11, 5, 1194d),
					new ExpectedCellValue(sheetName, 12, 5, 1194d),
					new ExpectedCellValue(sheetName, 13, 5, 1194d),
					new ExpectedCellValue(sheetName, 14, 5, 1194d),
					new ExpectedCellValue(sheetName, 15, 5, 415.75),
					new ExpectedCellValue(sheetName, 16, 5, 415.75),
					new ExpectedCellValue(sheetName, 17, 5, 415.75),
					new ExpectedCellValue(sheetName, 18, 5, 415.75),
					new ExpectedCellValue(sheetName, 19, 5, 24.99),
					new ExpectedCellValue(sheetName, 20, 5, 24.99),
					new ExpectedCellValue(sheetName, 21, 5, 24.99),
					new ExpectedCellValue(sheetName, 22, 5, 24.99),
					new ExpectedCellValue(sheetName, 23, 5, 99d),
					new ExpectedCellValue(sheetName, 24, 5, 99d),
					new ExpectedCellValue(sheetName, 25, 5, 99d),
					new ExpectedCellValue(sheetName, 26, 5, 99d),
					new ExpectedCellValue(sheetName, 27, 5, 831.5),
					new ExpectedCellValue(sheetName, 28, 5, 831.5),
					new ExpectedCellValue(sheetName, 29, 5, 831.5),
					new ExpectedCellValue(sheetName, 30, 5, 831.5),
					new ExpectedCellValue(sheetName, 31, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsAllFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:E52"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, 20100007),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, "20100007 Total"),
					new ExpectedCellValue(sheetName, 10, 1, 20100017),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, null),
					new ExpectedCellValue(sheetName, 16, 1, "20100017 Total"),
					new ExpectedCellValue(sheetName, 17, 1, 20100070),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, null),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, null),
					new ExpectedCellValue(sheetName, 22, 1, null),
					new ExpectedCellValue(sheetName, 23, 1, "20100070 Total"),
					new ExpectedCellValue(sheetName, 24, 1, 20100076),
					new ExpectedCellValue(sheetName, 25, 1, null),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, null),
					new ExpectedCellValue(sheetName, 28, 1, null),
					new ExpectedCellValue(sheetName, 29, 1, null),
					new ExpectedCellValue(sheetName, 30, 1, "20100076 Total"),
					new ExpectedCellValue(sheetName, 31, 1, 20100083),
					new ExpectedCellValue(sheetName, 32, 1, null),
					new ExpectedCellValue(sheetName, 33, 1, null),
					new ExpectedCellValue(sheetName, 34, 1, null),
					new ExpectedCellValue(sheetName, 35, 1, null),
					new ExpectedCellValue(sheetName, 36, 1, null),
					new ExpectedCellValue(sheetName, 37, 1, "20100083 Total"),
					new ExpectedCellValue(sheetName, 38, 1, 20100085),
					new ExpectedCellValue(sheetName, 39, 1, null),
					new ExpectedCellValue(sheetName, 40, 1, null),
					new ExpectedCellValue(sheetName, 41, 1, null),
					new ExpectedCellValue(sheetName, 42, 1, null),
					new ExpectedCellValue(sheetName, 43, 1, null),
					new ExpectedCellValue(sheetName, 44, 1, "20100085 Total"),
					new ExpectedCellValue(sheetName, 45, 1, 20100090),
					new ExpectedCellValue(sheetName, 46, 1, null),
					new ExpectedCellValue(sheetName, 47, 1, null),
					new ExpectedCellValue(sheetName, 48, 1, null),
					new ExpectedCellValue(sheetName, 49, 1, null),
					new ExpectedCellValue(sheetName, 50, 1, null),
					new ExpectedCellValue(sheetName, 51, 1, "20100090 Total"),
					new ExpectedCellValue(sheetName, 52, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Location"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Month"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "January"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, "January Total"),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, "March"),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, "March Total"),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, "February"),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, "February Total"),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "January"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, "January Total"),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, "March"),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, "March Total"),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, "February"),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, "February Total"),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, "January"),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, "January Total"),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Item"),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, "Tent"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, null),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 4, null),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 5, null),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, 831.5),
					new ExpectedCellValue(sheetName, 7, 5, 831.5),
					new ExpectedCellValue(sheetName, 8, 5, 831.5),
					new ExpectedCellValue(sheetName, 9, 5, 831.5),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, 831.5),
					new ExpectedCellValue(sheetName, 14, 5, 831.5),
					new ExpectedCellValue(sheetName, 15, 5, 831.5),
					new ExpectedCellValue(sheetName, 16, 5, 831.5),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, 1194d),
					new ExpectedCellValue(sheetName, 21, 5, 1194d),
					new ExpectedCellValue(sheetName, 22, 5, 1194d),
					new ExpectedCellValue(sheetName, 23, 5, 1194d),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, 415.75),
					new ExpectedCellValue(sheetName, 28, 5, 415.75),
					new ExpectedCellValue(sheetName, 29, 5, 415.75),
					new ExpectedCellValue(sheetName, 30, 5, 415.75),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, 24.99),
					new ExpectedCellValue(sheetName, 35, 5, 24.99),
					new ExpectedCellValue(sheetName, 36, 5, 24.99),
					new ExpectedCellValue(sheetName, 37, 5, 24.99),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, 99d),
					new ExpectedCellValue(sheetName, 42, 5, 99d),
					new ExpectedCellValue(sheetName, 43, 5, 99d),
					new ExpectedCellValue(sheetName, 44, 5, 99d),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, 831.5),
					new ExpectedCellValue(sheetName, 49, 5, 831.5),
					new ExpectedCellValue(sheetName, 50, 5, 831.5),
					new ExpectedCellValue(sheetName, 51, 5, 831.5),
					new ExpectedCellValue(sheetName, 52, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstThreeFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:K31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 7, 20100007),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, 20100017),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, 20100070),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, 20100076),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, 20100083),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, 20100085),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, 20100090),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 8, "Location"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Month"),
					new ExpectedCellValue(sheetName, 3, 9, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, "January"),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, "March"),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, "February"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, "January"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, "March"),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, "February"),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, "January"),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, "Item"),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, "Tent"),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 2, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 11, 831.5),
					new ExpectedCellValue(sheetName, 4, 11, 831.5),
					new ExpectedCellValue(sheetName, 5, 11, 831.5),
					new ExpectedCellValue(sheetName, 6, 11, 831.5),
					new ExpectedCellValue(sheetName, 7, 11, 831.5),
					new ExpectedCellValue(sheetName, 8, 11, 831.5),
					new ExpectedCellValue(sheetName, 9, 11, 831.5),
					new ExpectedCellValue(sheetName, 10, 11, 831.5),
					new ExpectedCellValue(sheetName, 11, 11, 1194d),
					new ExpectedCellValue(sheetName, 12, 11, 1194d),
					new ExpectedCellValue(sheetName, 13, 11, 1194d),
					new ExpectedCellValue(sheetName, 14, 11, 1194d),
					new ExpectedCellValue(sheetName, 15, 11, 415.75),
					new ExpectedCellValue(sheetName, 16, 11, 415.75),
					new ExpectedCellValue(sheetName, 17, 11, 415.75),
					new ExpectedCellValue(sheetName, 18, 11, 415.75),
					new ExpectedCellValue(sheetName, 19, 11, 24.99),
					new ExpectedCellValue(sheetName, 20, 11, 24.99),
					new ExpectedCellValue(sheetName, 21, 11, 24.99),
					new ExpectedCellValue(sheetName, 22, 11, 24.99),
					new ExpectedCellValue(sheetName, 23, 11, 99d),
					new ExpectedCellValue(sheetName, 24, 11, 99d),
					new ExpectedCellValue(sheetName, 25, 11, 99d),
					new ExpectedCellValue(sheetName, 26, 11, 99d),
					new ExpectedCellValue(sheetName, 27, 11, 831.5),
					new ExpectedCellValue(sheetName, 28, 11, 831.5),
					new ExpectedCellValue(sheetName, 29, 11, 831.5),
					new ExpectedCellValue(sheetName, 30, 11, 831.5),
					new ExpectedCellValue(sheetName, 31, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstThreeFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:K52"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 7, 20100007),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, "20100007 Total"),
					new ExpectedCellValue(sheetName, 10, 7, 20100017),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, "20100017 Total"),
					new ExpectedCellValue(sheetName, 17, 7, 20100070),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, "20100070 Total"),
					new ExpectedCellValue(sheetName, 24, 7, 20100076),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, "20100076 Total"),
					new ExpectedCellValue(sheetName, 31, 7, 20100083),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, "20100083 Total"),
					new ExpectedCellValue(sheetName, 38, 7, 20100085),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, "20100085 Total"),
					new ExpectedCellValue(sheetName, 45, 7, 20100090),
					new ExpectedCellValue(sheetName, 46, 7, null),
					new ExpectedCellValue(sheetName, 47, 7, null),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, "20100090 Total"),
					new ExpectedCellValue(sheetName, 52, 7, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 8, "Location"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, null),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Month"),
					new ExpectedCellValue(sheetName, 3, 9, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, "January"),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, "January Total"),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, "March"),
					new ExpectedCellValue(sheetName, 13, 9, null),
					new ExpectedCellValue(sheetName, 14, 9, "March Total"),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, "February"),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, "February Total"),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, "January"),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, "January Total"),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, "March"),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, "March Total"),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, "February"),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, "February Total"),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, "January"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, "January Total"),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, "Item"),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, "Tent"),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, null),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 2, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 11, null),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, 831.5),
					new ExpectedCellValue(sheetName, 7, 11, 831.5),
					new ExpectedCellValue(sheetName, 8, 11, 831.5),
					new ExpectedCellValue(sheetName, 9, 11, 831.5),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, 831.5),
					new ExpectedCellValue(sheetName, 14, 11, 831.5),
					new ExpectedCellValue(sheetName, 15, 11, 831.5),
					new ExpectedCellValue(sheetName, 16, 11, 831.5),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, 1194d),
					new ExpectedCellValue(sheetName, 21, 11, 1194d),
					new ExpectedCellValue(sheetName, 22, 11, 1194d),
					new ExpectedCellValue(sheetName, 23, 11, 1194d),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, 415.75),
					new ExpectedCellValue(sheetName, 28, 11, 415.75),
					new ExpectedCellValue(sheetName, 29, 11, 415.75),
					new ExpectedCellValue(sheetName, 30, 11, 415.75),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 32, 11, null),
					new ExpectedCellValue(sheetName, 33, 11, null),
					new ExpectedCellValue(sheetName, 34, 11, 24.99),
					new ExpectedCellValue(sheetName, 35, 11, 24.99),
					new ExpectedCellValue(sheetName, 36, 11, 24.99),
					new ExpectedCellValue(sheetName, 37, 11, 24.99),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, null),
					new ExpectedCellValue(sheetName, 41, 11, 99d),
					new ExpectedCellValue(sheetName, 42, 11, 99d),
					new ExpectedCellValue(sheetName, 43, 11, 99d),
					new ExpectedCellValue(sheetName, 44, 11, 99d),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, 831.5),
					new ExpectedCellValue(sheetName, 49, 11, 831.5),
					new ExpectedCellValue(sheetName, 50, 11, 831.5),
					new ExpectedCellValue(sheetName, 51, 11, 831.5),
					new ExpectedCellValue(sheetName, 52, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstSecondAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M2:P31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 13, 20100007),
					new ExpectedCellValue(sheetName, 4, 13, null),
					new ExpectedCellValue(sheetName, 5, 13, null),
					new ExpectedCellValue(sheetName, 6, 13, null),
					new ExpectedCellValue(sheetName, 7, 13, 20100017),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, null),
					new ExpectedCellValue(sheetName, 10, 13, null),
					new ExpectedCellValue(sheetName, 11, 13, 20100070),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, 20100076),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, 20100083),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, 20100085),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, 20100090),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 30, 13, null),
					new ExpectedCellValue(sheetName, 31, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 14, "Location"),
					new ExpectedCellValue(sheetName, 3, 14, null),
					new ExpectedCellValue(sheetName, 4, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 14, null),
					new ExpectedCellValue(sheetName, 6, 14, null),
					new ExpectedCellValue(sheetName, 7, 14, null),
					new ExpectedCellValue(sheetName, 8, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 28, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 14, null),
					new ExpectedCellValue(sheetName, 30, 14, null),
					new ExpectedCellValue(sheetName, 31, 14, null),
					new ExpectedCellValue(sheetName, 2, 15, "Month"),
					new ExpectedCellValue(sheetName, 3, 15, null),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, "January"),
					new ExpectedCellValue(sheetName, 6, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, "March"),
					new ExpectedCellValue(sheetName, 10, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, "February"),
					new ExpectedCellValue(sheetName, 14, 15, "Tent"),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, "January"),
					new ExpectedCellValue(sheetName, 18, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, "March"),
					new ExpectedCellValue(sheetName, 22, 15, "Headlamp"),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, "February"),
					new ExpectedCellValue(sheetName, 26, 15, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 29, 15, "January"),
					new ExpectedCellValue(sheetName, 30, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 2, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 16, 831.5),
					new ExpectedCellValue(sheetName, 4, 16, 831.5),
					new ExpectedCellValue(sheetName, 5, 16, 831.5),
					new ExpectedCellValue(sheetName, 6, 16, 831.5),
					new ExpectedCellValue(sheetName, 7, 16, 831.5),
					new ExpectedCellValue(sheetName, 8, 16, 831.5),
					new ExpectedCellValue(sheetName, 9, 16, 831.5),
					new ExpectedCellValue(sheetName, 10, 16, 831.5),
					new ExpectedCellValue(sheetName, 11, 16, 1194d),
					new ExpectedCellValue(sheetName, 12, 16, 1194d),
					new ExpectedCellValue(sheetName, 13, 16, 1194d),
					new ExpectedCellValue(sheetName, 14, 16, 1194d),
					new ExpectedCellValue(sheetName, 15, 16, 415.75),
					new ExpectedCellValue(sheetName, 16, 16, 415.75),
					new ExpectedCellValue(sheetName, 17, 16, 415.75),
					new ExpectedCellValue(sheetName, 18, 16, 415.75),
					new ExpectedCellValue(sheetName, 19, 16, 24.99),
					new ExpectedCellValue(sheetName, 20, 16, 24.99),
					new ExpectedCellValue(sheetName, 21, 16, 24.99),
					new ExpectedCellValue(sheetName, 22, 16, 24.99),
					new ExpectedCellValue(sheetName, 23, 16, 99d),
					new ExpectedCellValue(sheetName, 24, 16, 99d),
					new ExpectedCellValue(sheetName, 25, 16, 99d),
					new ExpectedCellValue(sheetName, 26, 16, 99d),
					new ExpectedCellValue(sheetName, 27, 16, 831.5),
					new ExpectedCellValue(sheetName, 28, 16, 831.5),
					new ExpectedCellValue(sheetName, 29, 16, 831.5),
					new ExpectedCellValue(sheetName, 30, 16, 831.5),
					new ExpectedCellValue(sheetName, 31, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstSecondAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M2:P52"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 13, 20100007),
					new ExpectedCellValue(sheetName, 4, 13, null),
					new ExpectedCellValue(sheetName, 5, 13, null),
					new ExpectedCellValue(sheetName, 6, 13, null),
					new ExpectedCellValue(sheetName, 7, 13, null),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, "20100007 Total"),
					new ExpectedCellValue(sheetName, 10, 13, 20100017),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, "20100017 Total"),
					new ExpectedCellValue(sheetName, 17, 13, 20100070),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, "20100070 Total"),
					new ExpectedCellValue(sheetName, 24, 13, 20100076),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 30, 13, "20100076 Total"),
					new ExpectedCellValue(sheetName, 31, 13, 20100083),
					new ExpectedCellValue(sheetName, 32, 13, null),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 34, 13, null),
					new ExpectedCellValue(sheetName, 35, 13, null),
					new ExpectedCellValue(sheetName, 36, 13, null),
					new ExpectedCellValue(sheetName, 37, 13, "20100083 Total"),
					new ExpectedCellValue(sheetName, 38, 13, 20100085),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 41, 13, null),
					new ExpectedCellValue(sheetName, 42, 13, null),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, "20100085 Total"),
					new ExpectedCellValue(sheetName, 45, 13, 20100090),
					new ExpectedCellValue(sheetName, 46, 13, null),
					new ExpectedCellValue(sheetName, 47, 13, null),
					new ExpectedCellValue(sheetName, 48, 13, null),
					new ExpectedCellValue(sheetName, 49, 13, null),
					new ExpectedCellValue(sheetName, 50, 13, null),
					new ExpectedCellValue(sheetName, 51, 13, "20100090 Total"),
					new ExpectedCellValue(sheetName, 52, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 14, "Location"),
					new ExpectedCellValue(sheetName, 3, 14, null),
					new ExpectedCellValue(sheetName, 4, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 14, null),
					new ExpectedCellValue(sheetName, 6, 14, null),
					new ExpectedCellValue(sheetName, 7, 14, null),
					new ExpectedCellValue(sheetName, 8, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 25, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 29, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 14, null),
					new ExpectedCellValue(sheetName, 31, 14, null),
					new ExpectedCellValue(sheetName, 32, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 33, 14, null),
					new ExpectedCellValue(sheetName, 34, 14, null),
					new ExpectedCellValue(sheetName, 35, 14, null),
					new ExpectedCellValue(sheetName, 36, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 37, 14, null),
					new ExpectedCellValue(sheetName, 38, 14, null),
					new ExpectedCellValue(sheetName, 39, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, null),
					new ExpectedCellValue(sheetName, 42, 14, null),
					new ExpectedCellValue(sheetName, 43, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, null),
					new ExpectedCellValue(sheetName, 50, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 51, 14, null),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 2, 15, "Month"),
					new ExpectedCellValue(sheetName, 3, 15, null),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, "January"),
					new ExpectedCellValue(sheetName, 6, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 15, "January Total"),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, "March"),
					new ExpectedCellValue(sheetName, 13, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 15, "March Total"),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, "February"),
					new ExpectedCellValue(sheetName, 20, 15, "Tent"),
					new ExpectedCellValue(sheetName, 21, 15, "February Total"),
					new ExpectedCellValue(sheetName, 22, 15, null),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, null),
					new ExpectedCellValue(sheetName, 26, 15, "January"),
					new ExpectedCellValue(sheetName, 27, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 15, "January Total"),
					new ExpectedCellValue(sheetName, 29, 15, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 33, 15, "March"),
					new ExpectedCellValue(sheetName, 34, 15, "Headlamp"),
					new ExpectedCellValue(sheetName, 35, 15, "March Total"),
					new ExpectedCellValue(sheetName, 36, 15, null),
					new ExpectedCellValue(sheetName, 37, 15, null),
					new ExpectedCellValue(sheetName, 38, 15, null),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 40, 15, "February"),
					new ExpectedCellValue(sheetName, 41, 15, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 15, "February Total"),
					new ExpectedCellValue(sheetName, 43, 15, null),
					new ExpectedCellValue(sheetName, 44, 15, null),
					new ExpectedCellValue(sheetName, 45, 15, null),
					new ExpectedCellValue(sheetName, 46, 15, null),
					new ExpectedCellValue(sheetName, 47, 15, "January"),
					new ExpectedCellValue(sheetName, 48, 15, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 15, "January Total"),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, null),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 2, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 16, null),
					new ExpectedCellValue(sheetName, 4, 16, null),
					new ExpectedCellValue(sheetName, 5, 16, null),
					new ExpectedCellValue(sheetName, 6, 16, 831.5),
					new ExpectedCellValue(sheetName, 7, 16, 831.5),
					new ExpectedCellValue(sheetName, 8, 16, 831.5),
					new ExpectedCellValue(sheetName, 9, 16, 831.5),
					new ExpectedCellValue(sheetName, 10, 16, null),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, 831.5),
					new ExpectedCellValue(sheetName, 14, 16, 831.5),
					new ExpectedCellValue(sheetName, 15, 16, 831.5),
					new ExpectedCellValue(sheetName, 16, 16, 831.5),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 20, 16, 1194d),
					new ExpectedCellValue(sheetName, 21, 16, 1194d),
					new ExpectedCellValue(sheetName, 22, 16, 1194d),
					new ExpectedCellValue(sheetName, 23, 16, 1194d),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, 415.75),
					new ExpectedCellValue(sheetName, 28, 16, 415.75),
					new ExpectedCellValue(sheetName, 29, 16, 415.75),
					new ExpectedCellValue(sheetName, 30, 16, 415.75),
					new ExpectedCellValue(sheetName, 31, 16, null),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 34, 16, 24.99),
					new ExpectedCellValue(sheetName, 35, 16, 24.99),
					new ExpectedCellValue(sheetName, 36, 16, 24.99),
					new ExpectedCellValue(sheetName, 37, 16, 24.99),
					new ExpectedCellValue(sheetName, 38, 16, null),
					new ExpectedCellValue(sheetName, 39, 16, null),
					new ExpectedCellValue(sheetName, 40, 16, null),
					new ExpectedCellValue(sheetName, 41, 16, 99d),
					new ExpectedCellValue(sheetName, 42, 16, 99d),
					new ExpectedCellValue(sheetName, 43, 16, 99d),
					new ExpectedCellValue(sheetName, 44, 16, 99d),
					new ExpectedCellValue(sheetName, 45, 16, null),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, null),
					new ExpectedCellValue(sheetName, 48, 16, 831.5),
					new ExpectedCellValue(sheetName, 49, 16, 831.5),
					new ExpectedCellValue(sheetName, 50, 16, 831.5),
					new ExpectedCellValue(sheetName, 51, 16, 831.5),
					new ExpectedCellValue(sheetName, 52, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstAndSecondFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("R2:U31"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 18, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 18, 20100007),
					new ExpectedCellValue(sheetName, 4, 18, null),
					new ExpectedCellValue(sheetName, 5, 18, null),
					new ExpectedCellValue(sheetName, 6, 18, null),
					new ExpectedCellValue(sheetName, 7, 18, 20100017),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, null),
					new ExpectedCellValue(sheetName, 10, 18, null),
					new ExpectedCellValue(sheetName, 11, 18, 20100070),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, 20100076),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, null),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, 20100083),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, 20100085),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, 20100090),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, null),
					new ExpectedCellValue(sheetName, 30, 18, null),
					new ExpectedCellValue(sheetName, 31, 18, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 19, "Location"),
					new ExpectedCellValue(sheetName, 3, 19, null),
					new ExpectedCellValue(sheetName, 4, 19, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 19, null),
					new ExpectedCellValue(sheetName, 6, 19, null),
					new ExpectedCellValue(sheetName, 7, 19, null),
					new ExpectedCellValue(sheetName, 8, 19, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 19, null),
					new ExpectedCellValue(sheetName, 10, 19, null),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, null),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, null),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, "Chicago"),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, null),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, "Nashville"),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 2, 20, "Month"),
					new ExpectedCellValue(sheetName, 3, 20, null),
					new ExpectedCellValue(sheetName, 4, 20, null),
					new ExpectedCellValue(sheetName, 5, 20, "January"),
					new ExpectedCellValue(sheetName, 6, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 20, null),
					new ExpectedCellValue(sheetName, 8, 20, null),
					new ExpectedCellValue(sheetName, 9, 20, "March"),
					new ExpectedCellValue(sheetName, 10, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, "February"),
					new ExpectedCellValue(sheetName, 14, 20, "Tent"),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, "January"),
					new ExpectedCellValue(sheetName, 18, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 20, null),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, "March"),
					new ExpectedCellValue(sheetName, 22, 20, "Headlamp"),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, "February"),
					new ExpectedCellValue(sheetName, 26, 20, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 27, 20, null),
					new ExpectedCellValue(sheetName, 28, 20, null),
					new ExpectedCellValue(sheetName, 29, 20, "January"),
					new ExpectedCellValue(sheetName, 30, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 2, 21, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 21, 831.5),
					new ExpectedCellValue(sheetName, 4, 21, 831.5),
					new ExpectedCellValue(sheetName, 5, 21, 831.5),
					new ExpectedCellValue(sheetName, 6, 21, 831.5),
					new ExpectedCellValue(sheetName, 7, 21, 831.5),
					new ExpectedCellValue(sheetName, 8, 21, 831.5),
					new ExpectedCellValue(sheetName, 9, 21, 831.5),
					new ExpectedCellValue(sheetName, 10, 21, 831.5),
					new ExpectedCellValue(sheetName, 11, 21, 1194d),
					new ExpectedCellValue(sheetName, 12, 21, 1194d),
					new ExpectedCellValue(sheetName, 13, 21, 1194d),
					new ExpectedCellValue(sheetName, 14, 21, 1194d),
					new ExpectedCellValue(sheetName, 15, 21, 415.75),
					new ExpectedCellValue(sheetName, 16, 21, 415.75),
					new ExpectedCellValue(sheetName, 17, 21, 415.75),
					new ExpectedCellValue(sheetName, 18, 21, 415.75),
					new ExpectedCellValue(sheetName, 19, 21, 24.99),
					new ExpectedCellValue(sheetName, 20, 21, 24.99),
					new ExpectedCellValue(sheetName, 21, 21, 24.99),
					new ExpectedCellValue(sheetName, 22, 21, 24.99),
					new ExpectedCellValue(sheetName, 23, 21, 99d),
					new ExpectedCellValue(sheetName, 24, 21, 99d),
					new ExpectedCellValue(sheetName, 25, 21, 99d),
					new ExpectedCellValue(sheetName, 26, 21, 99d),
					new ExpectedCellValue(sheetName, 27, 21, 831.5),
					new ExpectedCellValue(sheetName, 28, 21, 831.5),
					new ExpectedCellValue(sheetName, 29, 21, 831.5),
					new ExpectedCellValue(sheetName, 30, 21, 831.5),
					new ExpectedCellValue(sheetName, 31, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstAndSecondFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("R2:U52"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 18, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 18, 20100007),
					new ExpectedCellValue(sheetName, 4, 18, null),
					new ExpectedCellValue(sheetName, 5, 18, null),
					new ExpectedCellValue(sheetName, 6, 18, null),
					new ExpectedCellValue(sheetName, 7, 18, null),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, "20100007 Total"),
					new ExpectedCellValue(sheetName, 10, 18, 20100017),
					new ExpectedCellValue(sheetName, 11, 18, null),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, "20100017 Total"),
					new ExpectedCellValue(sheetName, 17, 18, 20100070),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, "20100070 Total"),
					new ExpectedCellValue(sheetName, 24, 18, 20100076),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, null),
					new ExpectedCellValue(sheetName, 30, 18, "20100076 Total"),
					new ExpectedCellValue(sheetName, 31, 18, 20100083),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, null),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, null),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, "20100083 Total"),
					new ExpectedCellValue(sheetName, 38, 18, 20100085),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, null),
					new ExpectedCellValue(sheetName, 41, 18, null),
					new ExpectedCellValue(sheetName, 42, 18, null),
					new ExpectedCellValue(sheetName, 43, 18, null),
					new ExpectedCellValue(sheetName, 44, 18, "20100085 Total"),
					new ExpectedCellValue(sheetName, 45, 18, 20100090),
					new ExpectedCellValue(sheetName, 46, 18, null),
					new ExpectedCellValue(sheetName, 47, 18, null),
					new ExpectedCellValue(sheetName, 48, 18, null),
					new ExpectedCellValue(sheetName, 49, 18, null),
					new ExpectedCellValue(sheetName, 50, 18, null),
					new ExpectedCellValue(sheetName, 51, 18, "20100090 Total"),
					new ExpectedCellValue(sheetName, 52, 18, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 19, "Location"),
					new ExpectedCellValue(sheetName, 3, 19, null),
					new ExpectedCellValue(sheetName, 4, 19, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 19, null),
					new ExpectedCellValue(sheetName, 6, 19, null),
					new ExpectedCellValue(sheetName, 7, 19, null),
					new ExpectedCellValue(sheetName, 8, 19, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 19, null),
					new ExpectedCellValue(sheetName, 10, 19, null),
					new ExpectedCellValue(sheetName, 11, 19, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 19, null),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, null),
					new ExpectedCellValue(sheetName, 15, 19, "Nashville Total"),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, "Nashville Total"),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, null),
					new ExpectedCellValue(sheetName, 29, 19, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, "Chicago"),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, null),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, "Chicago Total"),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, null),
					new ExpectedCellValue(sheetName, 39, 19, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, null),
					new ExpectedCellValue(sheetName, 43, 19, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 44, 19, null),
					new ExpectedCellValue(sheetName, 45, 19, null),
					new ExpectedCellValue(sheetName, 46, 19, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 19, null),
					new ExpectedCellValue(sheetName, 48, 19, null),
					new ExpectedCellValue(sheetName, 49, 19, null),
					new ExpectedCellValue(sheetName, 50, 19, "Nashville Total"),
					new ExpectedCellValue(sheetName, 51, 19, null),
					new ExpectedCellValue(sheetName, 52, 19, null),
					new ExpectedCellValue(sheetName, 2, 20, "Month"),
					new ExpectedCellValue(sheetName, 3, 20, null),
					new ExpectedCellValue(sheetName, 4, 20, null),
					new ExpectedCellValue(sheetName, 5, 20, "January"),
					new ExpectedCellValue(sheetName, 6, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 7, 20, "January Total"),
					new ExpectedCellValue(sheetName, 8, 20, null),
					new ExpectedCellValue(sheetName, 9, 20, null),
					new ExpectedCellValue(sheetName, 10, 20, null),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, "March"),
					new ExpectedCellValue(sheetName, 13, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 20, "March Total"),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, "February"),
					new ExpectedCellValue(sheetName, 20, 20, "Tent"),
					new ExpectedCellValue(sheetName, 21, 20, "February Total"),
					new ExpectedCellValue(sheetName, 22, 20, null),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, "January"),
					new ExpectedCellValue(sheetName, 27, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 20, "January Total"),
					new ExpectedCellValue(sheetName, 29, 20, null),
					new ExpectedCellValue(sheetName, 30, 20, null),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, "March"),
					new ExpectedCellValue(sheetName, 34, 20, "Headlamp"),
					new ExpectedCellValue(sheetName, 35, 20, "March Total"),
					new ExpectedCellValue(sheetName, 36, 20, null),
					new ExpectedCellValue(sheetName, 37, 20, null),
					new ExpectedCellValue(sheetName, 38, 20, null),
					new ExpectedCellValue(sheetName, 39, 20, null),
					new ExpectedCellValue(sheetName, 40, 20, "February"),
					new ExpectedCellValue(sheetName, 41, 20, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 42, 20, "February Total"),
					new ExpectedCellValue(sheetName, 43, 20, null),
					new ExpectedCellValue(sheetName, 44, 20, null),
					new ExpectedCellValue(sheetName, 45, 20, null),
					new ExpectedCellValue(sheetName, 46, 20, null),
					new ExpectedCellValue(sheetName, 47, 20, "January"),
					new ExpectedCellValue(sheetName, 48, 20, "Car Rack"),
					new ExpectedCellValue(sheetName, 49, 20, "January Total"),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, null),
					new ExpectedCellValue(sheetName, 2, 21, "Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 21, null),
					new ExpectedCellValue(sheetName, 4, 21, null),
					new ExpectedCellValue(sheetName, 5, 21, null),
					new ExpectedCellValue(sheetName, 6, 21, 831.5),
					new ExpectedCellValue(sheetName, 7, 21, 831.5),
					new ExpectedCellValue(sheetName, 8, 21, 831.5),
					new ExpectedCellValue(sheetName, 9, 21, 831.5),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, null),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, 831.5),
					new ExpectedCellValue(sheetName, 14, 21, 831.5),
					new ExpectedCellValue(sheetName, 15, 21, 831.5),
					new ExpectedCellValue(sheetName, 16, 21, 831.5),
					new ExpectedCellValue(sheetName, 17, 21, null),
					new ExpectedCellValue(sheetName, 18, 21, null),
					new ExpectedCellValue(sheetName, 19, 21, null),
					new ExpectedCellValue(sheetName, 20, 21, 1194d),
					new ExpectedCellValue(sheetName, 21, 21, 1194d),
					new ExpectedCellValue(sheetName, 22, 21, 1194d),
					new ExpectedCellValue(sheetName, 23, 21, 1194d),
					new ExpectedCellValue(sheetName, 24, 21, null),
					new ExpectedCellValue(sheetName, 25, 21, null),
					new ExpectedCellValue(sheetName, 26, 21, null),
					new ExpectedCellValue(sheetName, 27, 21, 415.75),
					new ExpectedCellValue(sheetName, 28, 21, 415.75),
					new ExpectedCellValue(sheetName, 29, 21, 415.75),
					new ExpectedCellValue(sheetName, 30, 21, 415.75),
					new ExpectedCellValue(sheetName, 31, 21, null),
					new ExpectedCellValue(sheetName, 32, 21, null),
					new ExpectedCellValue(sheetName, 33, 21, null),
					new ExpectedCellValue(sheetName, 34, 21, 24.99),
					new ExpectedCellValue(sheetName, 35, 21, 24.99),
					new ExpectedCellValue(sheetName, 36, 21, 24.99),
					new ExpectedCellValue(sheetName, 37, 21, 24.99),
					new ExpectedCellValue(sheetName, 38, 21, null),
					new ExpectedCellValue(sheetName, 39, 21, null),
					new ExpectedCellValue(sheetName, 40, 21, null),
					new ExpectedCellValue(sheetName, 41, 21, 99d),
					new ExpectedCellValue(sheetName, 42, 21, 99d),
					new ExpectedCellValue(sheetName, 43, 21, 99d),
					new ExpectedCellValue(sheetName, 44, 21, 99d),
					new ExpectedCellValue(sheetName, 45, 21, null),
					new ExpectedCellValue(sheetName, 46, 21, null),
					new ExpectedCellValue(sheetName, 47, 21, null),
					new ExpectedCellValue(sheetName, 48, 21, 831.5),
					new ExpectedCellValue(sheetName, 49, 21, 831.5),
					new ExpectedCellValue(sheetName, 50, 21, 831.5),
					new ExpectedCellValue(sheetName, 51, 21, 831.5),
					new ExpectedCellValue(sheetName, 52, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A60:D89"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 1, 20100007),
					new ExpectedCellValue(sheetName, 62, 1, null),
					new ExpectedCellValue(sheetName, 63, 1, null),
					new ExpectedCellValue(sheetName, 64, 1, null),
					new ExpectedCellValue(sheetName, 65, 1, 20100017),
					new ExpectedCellValue(sheetName, 66, 1, null),
					new ExpectedCellValue(sheetName, 67, 1, null),
					new ExpectedCellValue(sheetName, 68, 1, null),
					new ExpectedCellValue(sheetName, 69, 1, 20100070),
					new ExpectedCellValue(sheetName, 70, 1, null),
					new ExpectedCellValue(sheetName, 71, 1, null),
					new ExpectedCellValue(sheetName, 72, 1, null),
					new ExpectedCellValue(sheetName, 73, 1, 20100076),
					new ExpectedCellValue(sheetName, 74, 1, null),
					new ExpectedCellValue(sheetName, 75, 1, null),
					new ExpectedCellValue(sheetName, 76, 1, null),
					new ExpectedCellValue(sheetName, 77, 1, 20100083),
					new ExpectedCellValue(sheetName, 78, 1, null),
					new ExpectedCellValue(sheetName, 79, 1, null),
					new ExpectedCellValue(sheetName, 80, 1, null),
					new ExpectedCellValue(sheetName, 81, 1, 20100085),
					new ExpectedCellValue(sheetName, 82, 1, null),
					new ExpectedCellValue(sheetName, 83, 1, null),
					new ExpectedCellValue(sheetName, 84, 1, null),
					new ExpectedCellValue(sheetName, 85, 1, 20100090),
					new ExpectedCellValue(sheetName, 86, 1, null),
					new ExpectedCellValue(sheetName, 87, 1, null),
					new ExpectedCellValue(sheetName, 88, 1, null),
					new ExpectedCellValue(sheetName, 89, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 2, "Location"),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 2, "January"),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 67, 2, "March"),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 71, 2, "February"),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 75, 2, "January"),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, null),
					new ExpectedCellValue(sheetName, 78, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 2, "March"),
					new ExpectedCellValue(sheetName, 80, 2, null),
					new ExpectedCellValue(sheetName, 81, 2, null),
					new ExpectedCellValue(sheetName, 82, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 83, 2, "February"),
					new ExpectedCellValue(sheetName, 84, 2, null),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 87, 2, "January"),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 60, 3, "Item"),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, null),
					new ExpectedCellValue(sheetName, 72, 3, "Tent"),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 85, 3, null),
					new ExpectedCellValue(sheetName, 86, 3, null),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 60, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 4, 831.5),
					new ExpectedCellValue(sheetName, 62, 4, 831.5),
					new ExpectedCellValue(sheetName, 63, 4, 831.5),
					new ExpectedCellValue(sheetName, 64, 4, 831.5),
					new ExpectedCellValue(sheetName, 65, 4, 831.5),
					new ExpectedCellValue(sheetName, 66, 4, 831.5),
					new ExpectedCellValue(sheetName, 67, 4, 831.5),
					new ExpectedCellValue(sheetName, 68, 4, 831.5),
					new ExpectedCellValue(sheetName, 69, 4, 1194d),
					new ExpectedCellValue(sheetName, 70, 4, 1194d),
					new ExpectedCellValue(sheetName, 71, 4, 1194d),
					new ExpectedCellValue(sheetName, 72, 4, 1194d),
					new ExpectedCellValue(sheetName, 73, 4, 415.75),
					new ExpectedCellValue(sheetName, 74, 4, 415.75),
					new ExpectedCellValue(sheetName, 75, 4, 415.75),
					new ExpectedCellValue(sheetName, 76, 4, 415.75),
					new ExpectedCellValue(sheetName, 77, 4, 24.99),
					new ExpectedCellValue(sheetName, 78, 4, 24.99),
					new ExpectedCellValue(sheetName, 79, 4, 24.99),
					new ExpectedCellValue(sheetName, 80, 4, 24.99),
					new ExpectedCellValue(sheetName, 81, 4, 99d),
					new ExpectedCellValue(sheetName, 82, 4, 99d),
					new ExpectedCellValue(sheetName, 83, 4, 99d),
					new ExpectedCellValue(sheetName, 84, 4, 99d),
					new ExpectedCellValue(sheetName, 85, 4, 831.5),
					new ExpectedCellValue(sheetName, 86, 4, 831.5),
					new ExpectedCellValue(sheetName, 87, 4, 831.5),
					new ExpectedCellValue(sheetName, 88, 4, 831.5),
					new ExpectedCellValue(sheetName, 89, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstThirdAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A60:D110"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 1, 20100007),
					new ExpectedCellValue(sheetName, 62, 1, null),
					new ExpectedCellValue(sheetName, 63, 1, null),
					new ExpectedCellValue(sheetName, 64, 1, null),
					new ExpectedCellValue(sheetName, 65, 1, null),
					new ExpectedCellValue(sheetName, 66, 1, null),
					new ExpectedCellValue(sheetName, 67, 1, "20100007 Total"),
					new ExpectedCellValue(sheetName, 68, 1, 20100017),
					new ExpectedCellValue(sheetName, 69, 1, null),
					new ExpectedCellValue(sheetName, 70, 1, null),
					new ExpectedCellValue(sheetName, 71, 1, null),
					new ExpectedCellValue(sheetName, 72, 1, null),
					new ExpectedCellValue(sheetName, 73, 1, null),
					new ExpectedCellValue(sheetName, 74, 1, "20100017 Total"),
					new ExpectedCellValue(sheetName, 75, 1, 20100070),
					new ExpectedCellValue(sheetName, 76, 1, null),
					new ExpectedCellValue(sheetName, 77, 1, null),
					new ExpectedCellValue(sheetName, 78, 1, null),
					new ExpectedCellValue(sheetName, 79, 1, null),
					new ExpectedCellValue(sheetName, 80, 1, null),
					new ExpectedCellValue(sheetName, 81, 1, "20100070 Total"),
					new ExpectedCellValue(sheetName, 82, 1, 20100076),
					new ExpectedCellValue(sheetName, 83, 1, null),
					new ExpectedCellValue(sheetName, 84, 1, null),
					new ExpectedCellValue(sheetName, 85, 1, null),
					new ExpectedCellValue(sheetName, 86, 1, null),
					new ExpectedCellValue(sheetName, 87, 1, null),
					new ExpectedCellValue(sheetName, 88, 1, "20100076 Total"),
					new ExpectedCellValue(sheetName, 89, 1, 20100083),
					new ExpectedCellValue(sheetName, 90, 1, null),
					new ExpectedCellValue(sheetName, 91, 1, null),
					new ExpectedCellValue(sheetName, 92, 1, null),
					new ExpectedCellValue(sheetName, 93, 1, null),
					new ExpectedCellValue(sheetName, 94, 1, null),
					new ExpectedCellValue(sheetName, 95, 1, "20100083 Total"),
					new ExpectedCellValue(sheetName, 96, 1, 20100085),
					new ExpectedCellValue(sheetName, 97, 1, null),
					new ExpectedCellValue(sheetName, 98, 1, null),
					new ExpectedCellValue(sheetName, 99, 1, null),
					new ExpectedCellValue(sheetName, 100, 1, null),
					new ExpectedCellValue(sheetName, 101, 1, null),
					new ExpectedCellValue(sheetName, 102, 1, "20100085 Total"),
					new ExpectedCellValue(sheetName, 103, 1, 20100090),
					new ExpectedCellValue(sheetName, 104, 1, null),
					new ExpectedCellValue(sheetName, 105, 1, null),
					new ExpectedCellValue(sheetName, 106, 1, null),
					new ExpectedCellValue(sheetName, 107, 1, null),
					new ExpectedCellValue(sheetName, 108, 1, null),
					new ExpectedCellValue(sheetName, 109, 1, "20100090 Total"),
					new ExpectedCellValue(sheetName, 110, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 2, "Location"),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 2, "January"),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, "January Total"),
					new ExpectedCellValue(sheetName, 66, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 70, 2, "March"),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, "March Total"),
					new ExpectedCellValue(sheetName, 73, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 74, 2, null),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 2, "February"),
					new ExpectedCellValue(sheetName, 78, 2, null),
					new ExpectedCellValue(sheetName, 79, 2, "February Total"),
					new ExpectedCellValue(sheetName, 80, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 81, 2, null),
					new ExpectedCellValue(sheetName, 82, 2, null),
					new ExpectedCellValue(sheetName, 83, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 2, "January"),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, "January Total"),
					new ExpectedCellValue(sheetName, 87, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 90, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 91, 2, "March"),
					new ExpectedCellValue(sheetName, 92, 2, null),
					new ExpectedCellValue(sheetName, 93, 2, "March Total"),
					new ExpectedCellValue(sheetName, 94, 2, "Chicago Total"),
					new ExpectedCellValue(sheetName, 95, 2, null),
					new ExpectedCellValue(sheetName, 96, 2, null),
					new ExpectedCellValue(sheetName, 97, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 2, "February"),
					new ExpectedCellValue(sheetName, 99, 2, null),
					new ExpectedCellValue(sheetName, 100, 2, "February Total"),
					new ExpectedCellValue(sheetName, 101, 2, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 102, 2, null),
					new ExpectedCellValue(sheetName, 103, 2, null),
					new ExpectedCellValue(sheetName, 104, 2, "Nashville"),
					new ExpectedCellValue(sheetName, 105, 2, "January"),
					new ExpectedCellValue(sheetName, 106, 2, null),
					new ExpectedCellValue(sheetName, 107, 2, "January Total"),
					new ExpectedCellValue(sheetName, 108, 2, "Nashville Total"),
					new ExpectedCellValue(sheetName, 109, 2, null),
					new ExpectedCellValue(sheetName, 110, 2, null),
					new ExpectedCellValue(sheetName, 60, 3, "Item"),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, "Tent"),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, null),
					new ExpectedCellValue(sheetName, 85, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 3, null),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, null),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 90, 3, null),
					new ExpectedCellValue(sheetName, 91, 3, null),
					new ExpectedCellValue(sheetName, 92, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 93, 3, null),
					new ExpectedCellValue(sheetName, 94, 3, null),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null),
					new ExpectedCellValue(sheetName, 97, 3, null),
					new ExpectedCellValue(sheetName, 98, 3, null),
					new ExpectedCellValue(sheetName, 99, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 101, 3, null),
					new ExpectedCellValue(sheetName, 102, 3, null),
					new ExpectedCellValue(sheetName, 103, 3, null),
					new ExpectedCellValue(sheetName, 104, 3, null),
					new ExpectedCellValue(sheetName, 105, 3, null),
					new ExpectedCellValue(sheetName, 106, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 107, 3, null),
					new ExpectedCellValue(sheetName, 108, 3, null),
					new ExpectedCellValue(sheetName, 109, 3, null),
					new ExpectedCellValue(sheetName, 110, 3, null),
					new ExpectedCellValue(sheetName, 60, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, 831.5),
					new ExpectedCellValue(sheetName, 65, 4, 831.5),
					new ExpectedCellValue(sheetName, 66, 4, 831.5),
					new ExpectedCellValue(sheetName, 67, 4, 831.5),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, null),
					new ExpectedCellValue(sheetName, 70, 4, null),
					new ExpectedCellValue(sheetName, 71, 4, 831.5),
					new ExpectedCellValue(sheetName, 72, 4, 831.5),
					new ExpectedCellValue(sheetName, 73, 4, 831.5),
					new ExpectedCellValue(sheetName, 74, 4, 831.5),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, null),
					new ExpectedCellValue(sheetName, 77, 4, null),
					new ExpectedCellValue(sheetName, 78, 4, 1194d),
					new ExpectedCellValue(sheetName, 79, 4, 1194d),
					new ExpectedCellValue(sheetName, 80, 4, 1194d),
					new ExpectedCellValue(sheetName, 81, 4, 1194d),
					new ExpectedCellValue(sheetName, 82, 4, null),
					new ExpectedCellValue(sheetName, 83, 4, null),
					new ExpectedCellValue(sheetName, 84, 4, null),
					new ExpectedCellValue(sheetName, 85, 4, 415.75),
					new ExpectedCellValue(sheetName, 86, 4, 415.75),
					new ExpectedCellValue(sheetName, 87, 4, 415.75),
					new ExpectedCellValue(sheetName, 88, 4, 415.75),
					new ExpectedCellValue(sheetName, 89, 4, null),
					new ExpectedCellValue(sheetName, 90, 4, null),
					new ExpectedCellValue(sheetName, 91, 4, null),
					new ExpectedCellValue(sheetName, 92, 4, 24.99),
					new ExpectedCellValue(sheetName, 93, 4, 24.99),
					new ExpectedCellValue(sheetName, 94, 4, 24.99),
					new ExpectedCellValue(sheetName, 95, 4, 24.99),
					new ExpectedCellValue(sheetName, 96, 4, null),
					new ExpectedCellValue(sheetName, 97, 4, null),
					new ExpectedCellValue(sheetName, 98, 4, null),
					new ExpectedCellValue(sheetName, 99, 4, 99d),
					new ExpectedCellValue(sheetName, 100, 4, 99d),
					new ExpectedCellValue(sheetName, 101, 4, 99d),
					new ExpectedCellValue(sheetName, 102, 4, 99d),
					new ExpectedCellValue(sheetName, 103, 4, null),
					new ExpectedCellValue(sheetName, 104, 4, null),
					new ExpectedCellValue(sheetName, 105, 4, null),
					new ExpectedCellValue(sheetName, 106, 4, 831.5),
					new ExpectedCellValue(sheetName, 107, 4, 831.5),
					new ExpectedCellValue(sheetName, 108, 4, 831.5),
					new ExpectedCellValue(sheetName, 109, 4, 831.5),
					new ExpectedCellValue(sheetName, 110, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F60:I89"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 6, 20100007),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, 20100017),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, null),
					new ExpectedCellValue(sheetName, 68, 6, null),
					new ExpectedCellValue(sheetName, 69, 6, 20100070),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, null),
					new ExpectedCellValue(sheetName, 73, 6, 20100076),
					new ExpectedCellValue(sheetName, 74, 6, null),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, 20100083),
					new ExpectedCellValue(sheetName, 78, 6, null),
					new ExpectedCellValue(sheetName, 79, 6, null),
					new ExpectedCellValue(sheetName, 80, 6, null),
					new ExpectedCellValue(sheetName, 81, 6, 20100085),
					new ExpectedCellValue(sheetName, 82, 6, null),
					new ExpectedCellValue(sheetName, 83, 6, null),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, 20100090),
					new ExpectedCellValue(sheetName, 86, 6, null),
					new ExpectedCellValue(sheetName, 87, 6, null),
					new ExpectedCellValue(sheetName, 88, 6, null),
					new ExpectedCellValue(sheetName, 89, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 7, "Location"),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 7, "January"),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 67, 7, "March"),
					new ExpectedCellValue(sheetName, 68, 7, null),
					new ExpectedCellValue(sheetName, 69, 7, null),
					new ExpectedCellValue(sheetName, 70, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 71, 7, "February"),
					new ExpectedCellValue(sheetName, 72, 7, null),
					new ExpectedCellValue(sheetName, 73, 7, null),
					new ExpectedCellValue(sheetName, 74, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 75, 7, "January"),
					new ExpectedCellValue(sheetName, 76, 7, null),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 7, "March"),
					new ExpectedCellValue(sheetName, 80, 7, null),
					new ExpectedCellValue(sheetName, 81, 7, null),
					new ExpectedCellValue(sheetName, 82, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 83, 7, "February"),
					new ExpectedCellValue(sheetName, 84, 7, null),
					new ExpectedCellValue(sheetName, 85, 7, null),
					new ExpectedCellValue(sheetName, 86, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 87, 7, "January"),
					new ExpectedCellValue(sheetName, 88, 7, null),
					new ExpectedCellValue(sheetName, 89, 7, null),
					new ExpectedCellValue(sheetName, 60, 8, "Item"),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, null),
					new ExpectedCellValue(sheetName, 68, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 8, null),
					new ExpectedCellValue(sheetName, 70, 8, null),
					new ExpectedCellValue(sheetName, 71, 8, null),
					new ExpectedCellValue(sheetName, 72, 8, "Tent"),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 8, null),
					new ExpectedCellValue(sheetName, 78, 8, null),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 81, 8, null),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 85, 8, null),
					new ExpectedCellValue(sheetName, 86, 8, null),
					new ExpectedCellValue(sheetName, 87, 8, null),
					new ExpectedCellValue(sheetName, 88, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 8, null),
					new ExpectedCellValue(sheetName, 60, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 9, 831.5),
					new ExpectedCellValue(sheetName, 62, 9, 831.5),
					new ExpectedCellValue(sheetName, 63, 9, 831.5),
					new ExpectedCellValue(sheetName, 64, 9, 831.5),
					new ExpectedCellValue(sheetName, 65, 9, 831.5),
					new ExpectedCellValue(sheetName, 66, 9, 831.5),
					new ExpectedCellValue(sheetName, 67, 9, 831.5),
					new ExpectedCellValue(sheetName, 68, 9, 831.5),
					new ExpectedCellValue(sheetName, 69, 9, 1194d),
					new ExpectedCellValue(sheetName, 70, 9, 1194d),
					new ExpectedCellValue(sheetName, 71, 9, 1194d),
					new ExpectedCellValue(sheetName, 72, 9, 1194d),
					new ExpectedCellValue(sheetName, 73, 9, 415.75),
					new ExpectedCellValue(sheetName, 74, 9, 415.75),
					new ExpectedCellValue(sheetName, 75, 9, 415.75),
					new ExpectedCellValue(sheetName, 76, 9, 415.75),
					new ExpectedCellValue(sheetName, 77, 9, 24.99),
					new ExpectedCellValue(sheetName, 78, 9, 24.99),
					new ExpectedCellValue(sheetName, 79, 9, 24.99),
					new ExpectedCellValue(sheetName, 80, 9, 24.99),
					new ExpectedCellValue(sheetName, 81, 9, 99d),
					new ExpectedCellValue(sheetName, 82, 9, 99d),
					new ExpectedCellValue(sheetName, 83, 9, 99d),
					new ExpectedCellValue(sheetName, 84, 9, 99d),
					new ExpectedCellValue(sheetName, 85, 9, 831.5),
					new ExpectedCellValue(sheetName, 86, 9, 831.5),
					new ExpectedCellValue(sheetName, 87, 9, 831.5),
					new ExpectedCellValue(sheetName, 88, 9, 831.5),
					new ExpectedCellValue(sheetName, 89, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstAndThirdFieldsCompactFormFalseSubtotal()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F60:I110"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 6, 20100007),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, "20100007 Total"),
					new ExpectedCellValue(sheetName, 68, 6, 20100017),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, null),
					new ExpectedCellValue(sheetName, 73, 6, null),
					new ExpectedCellValue(sheetName, 74, 6, "20100017 Total"),
					new ExpectedCellValue(sheetName, 75, 6, 20100070),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, null),
					new ExpectedCellValue(sheetName, 78, 6, null),
					new ExpectedCellValue(sheetName, 79, 6, null),
					new ExpectedCellValue(sheetName, 80, 6, null),
					new ExpectedCellValue(sheetName, 81, 6, "20100070 Total"),
					new ExpectedCellValue(sheetName, 82, 6, 20100076),
					new ExpectedCellValue(sheetName, 83, 6, null),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, null),
					new ExpectedCellValue(sheetName, 86, 6, null),
					new ExpectedCellValue(sheetName, 87, 6, null),
					new ExpectedCellValue(sheetName, 88, 6, "20100076 Total"),
					new ExpectedCellValue(sheetName, 89, 6, 20100083),
					new ExpectedCellValue(sheetName, 90, 6, null),
					new ExpectedCellValue(sheetName, 91, 6, null),
					new ExpectedCellValue(sheetName, 92, 6, null),
					new ExpectedCellValue(sheetName, 93, 6, null),
					new ExpectedCellValue(sheetName, 94, 6, null),
					new ExpectedCellValue(sheetName, 95, 6, "20100083 Total"),
					new ExpectedCellValue(sheetName, 96, 6, 20100085),
					new ExpectedCellValue(sheetName, 97, 6, null),
					new ExpectedCellValue(sheetName, 98, 6, null),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 100, 6, null),
					new ExpectedCellValue(sheetName, 101, 6, null),
					new ExpectedCellValue(sheetName, 102, 6, "20100085 Total"),
					new ExpectedCellValue(sheetName, 103, 6, 20100090),
					new ExpectedCellValue(sheetName, 104, 6, null),
					new ExpectedCellValue(sheetName, 105, 6, null),
					new ExpectedCellValue(sheetName, 106, 6, null),
					new ExpectedCellValue(sheetName, 107, 6, null),
					new ExpectedCellValue(sheetName, 108, 6, null),
					new ExpectedCellValue(sheetName, 109, 6, "20100090 Total"),
					new ExpectedCellValue(sheetName, 110, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 7, "Location"),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 7, "January"),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, "January Total"),
					new ExpectedCellValue(sheetName, 66, 7, "Chicago Total"),
					new ExpectedCellValue(sheetName, 67, 7, null),
					new ExpectedCellValue(sheetName, 68, 7, null),
					new ExpectedCellValue(sheetName, 69, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 70, 7, "March"),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, "March Total"),
					new ExpectedCellValue(sheetName, 73, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 74, 7, null),
					new ExpectedCellValue(sheetName, 75, 7, null),
					new ExpectedCellValue(sheetName, 76, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 7, "February"),
					new ExpectedCellValue(sheetName, 78, 7, null),
					new ExpectedCellValue(sheetName, 79, 7, "February Total"),
					new ExpectedCellValue(sheetName, 80, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 81, 7, null),
					new ExpectedCellValue(sheetName, 82, 7, null),
					new ExpectedCellValue(sheetName, 83, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 7, "January"),
					new ExpectedCellValue(sheetName, 85, 7, null),
					new ExpectedCellValue(sheetName, 86, 7, "January Total"),
					new ExpectedCellValue(sheetName, 87, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 7, null),
					new ExpectedCellValue(sheetName, 89, 7, null),
					new ExpectedCellValue(sheetName, 90, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 91, 7, "March"),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, "March Total"),
					new ExpectedCellValue(sheetName, 94, 7, "Chicago Total"),
					new ExpectedCellValue(sheetName, 95, 7, null),
					new ExpectedCellValue(sheetName, 96, 7, null),
					new ExpectedCellValue(sheetName, 97, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 7, "February"),
					new ExpectedCellValue(sheetName, 99, 7, null),
					new ExpectedCellValue(sheetName, 100, 7, "February Total"),
					new ExpectedCellValue(sheetName, 101, 7, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 102, 7, null),
					new ExpectedCellValue(sheetName, 103, 7, null),
					new ExpectedCellValue(sheetName, 104, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 105, 7, "January"),
					new ExpectedCellValue(sheetName, 106, 7, null),
					new ExpectedCellValue(sheetName, 107, 7, "January Total"),
					new ExpectedCellValue(sheetName, 108, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 109, 7, null),
					new ExpectedCellValue(sheetName, 110, 7, null),
					new ExpectedCellValue(sheetName, 60, 8, "Item"),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, null),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, null),
					new ExpectedCellValue(sheetName, 70, 8, null),
					new ExpectedCellValue(sheetName, 71, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 72, 8, null),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, null),
					new ExpectedCellValue(sheetName, 77, 8, null),
					new ExpectedCellValue(sheetName, 78, 8, "Tent"),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, null),
					new ExpectedCellValue(sheetName, 81, 8, null),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, null),
					new ExpectedCellValue(sheetName, 85, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 8, null),
					new ExpectedCellValue(sheetName, 87, 8, null),
					new ExpectedCellValue(sheetName, 88, 8, null),
					new ExpectedCellValue(sheetName, 89, 8, null),
					new ExpectedCellValue(sheetName, 90, 8, null),
					new ExpectedCellValue(sheetName, 91, 8, null),
					new ExpectedCellValue(sheetName, 92, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 93, 8, null),
					new ExpectedCellValue(sheetName, 94, 8, null),
					new ExpectedCellValue(sheetName, 95, 8, null),
					new ExpectedCellValue(sheetName, 96, 8, null),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, null),
					new ExpectedCellValue(sheetName, 99, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 100, 8, null),
					new ExpectedCellValue(sheetName, 101, 8, null),
					new ExpectedCellValue(sheetName, 102, 8, null),
					new ExpectedCellValue(sheetName, 103, 8, null),
					new ExpectedCellValue(sheetName, 104, 8, null),
					new ExpectedCellValue(sheetName, 105, 8, null),
					new ExpectedCellValue(sheetName, 106, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 107, 8, null),
					new ExpectedCellValue(sheetName, 108, 8, null),
					new ExpectedCellValue(sheetName, 109, 8, null),
					new ExpectedCellValue(sheetName, 110, 8, null),
					new ExpectedCellValue(sheetName, 60, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, 831.5),
					new ExpectedCellValue(sheetName, 65, 9, 831.5),
					new ExpectedCellValue(sheetName, 66, 9, 831.5),
					new ExpectedCellValue(sheetName, 67, 9, 831.5),
					new ExpectedCellValue(sheetName, 68, 9, null),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 70, 9, null),
					new ExpectedCellValue(sheetName, 71, 9, 831.5),
					new ExpectedCellValue(sheetName, 72, 9, 831.5),
					new ExpectedCellValue(sheetName, 73, 9, 831.5),
					new ExpectedCellValue(sheetName, 74, 9, 831.5),
					new ExpectedCellValue(sheetName, 75, 9, null),
					new ExpectedCellValue(sheetName, 76, 9, null),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, 1194d),
					new ExpectedCellValue(sheetName, 79, 9, 1194d),
					new ExpectedCellValue(sheetName, 80, 9, 1194d),
					new ExpectedCellValue(sheetName, 81, 9, 1194d),
					new ExpectedCellValue(sheetName, 82, 9, null),
					new ExpectedCellValue(sheetName, 83, 9, null),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, 415.75),
					new ExpectedCellValue(sheetName, 86, 9, 415.75),
					new ExpectedCellValue(sheetName, 87, 9, 415.75),
					new ExpectedCellValue(sheetName, 88, 9, 415.75),
					new ExpectedCellValue(sheetName, 89, 9, null),
					new ExpectedCellValue(sheetName, 90, 9, null),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, 24.99),
					new ExpectedCellValue(sheetName, 93, 9, 24.99),
					new ExpectedCellValue(sheetName, 94, 9, 24.99),
					new ExpectedCellValue(sheetName, 95, 9, 24.99),
					new ExpectedCellValue(sheetName, 96, 9, null),
					new ExpectedCellValue(sheetName, 97, 9, null),
					new ExpectedCellValue(sheetName, 98, 9, null),
					new ExpectedCellValue(sheetName, 99, 9, 99d),
					new ExpectedCellValue(sheetName, 100, 9, 99d),
					new ExpectedCellValue(sheetName, 101, 9, 99d),
					new ExpectedCellValue(sheetName, 102, 9, 99d),
					new ExpectedCellValue(sheetName, 103, 9, null),
					new ExpectedCellValue(sheetName, 104, 9, null),
					new ExpectedCellValue(sheetName, 105, 9, null),
					new ExpectedCellValue(sheetName, 106, 9, 831.5),
					new ExpectedCellValue(sheetName, 107, 9, 831.5),
					new ExpectedCellValue(sheetName, 108, 9, 831.5),
					new ExpectedCellValue(sheetName, 109, 9, 831.5),
					new ExpectedCellValue(sheetName, 110, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K60:M89"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 11, 20100007),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, null),
					new ExpectedCellValue(sheetName, 65, 11, 20100017),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, null),
					new ExpectedCellValue(sheetName, 68, 11, null),
					new ExpectedCellValue(sheetName, 69, 11, 20100070),
					new ExpectedCellValue(sheetName, 70, 11, null),
					new ExpectedCellValue(sheetName, 71, 11, null),
					new ExpectedCellValue(sheetName, 72, 11, null),
					new ExpectedCellValue(sheetName, 73, 11, 20100076),
					new ExpectedCellValue(sheetName, 74, 11, null),
					new ExpectedCellValue(sheetName, 75, 11, null),
					new ExpectedCellValue(sheetName, 76, 11, null),
					new ExpectedCellValue(sheetName, 77, 11, 20100083),
					new ExpectedCellValue(sheetName, 78, 11, null),
					new ExpectedCellValue(sheetName, 79, 11, null),
					new ExpectedCellValue(sheetName, 80, 11, null),
					new ExpectedCellValue(sheetName, 81, 11, 20100085),
					new ExpectedCellValue(sheetName, 82, 11, null),
					new ExpectedCellValue(sheetName, 83, 11, null),
					new ExpectedCellValue(sheetName, 84, 11, null),
					new ExpectedCellValue(sheetName, 85, 11, 20100090),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, null),
					new ExpectedCellValue(sheetName, 88, 11, null),
					new ExpectedCellValue(sheetName, 89, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 12, "Location"),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 12, "January"),
					new ExpectedCellValue(sheetName, 64, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 12, null),
					new ExpectedCellValue(sheetName, 66, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 67, 12, "March"),
					new ExpectedCellValue(sheetName, 68, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 12, null),
					new ExpectedCellValue(sheetName, 70, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 71, 12, "February"),
					new ExpectedCellValue(sheetName, 72, 12, "Tent"),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 75, 12, "January"),
					new ExpectedCellValue(sheetName, 76, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 12, null),
					new ExpectedCellValue(sheetName, 78, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 12, "March"),
					new ExpectedCellValue(sheetName, 80, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 83, 12, "February"),
					new ExpectedCellValue(sheetName, 84, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 85, 12, null),
					new ExpectedCellValue(sheetName, 86, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 87, 12, "January"),
					new ExpectedCellValue(sheetName, 88, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 60, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 13, 831.5),
					new ExpectedCellValue(sheetName, 62, 13, 831.5),
					new ExpectedCellValue(sheetName, 63, 13, 831.5),
					new ExpectedCellValue(sheetName, 64, 13, 831.5),
					new ExpectedCellValue(sheetName, 65, 13, 831.5),
					new ExpectedCellValue(sheetName, 66, 13, 831.5),
					new ExpectedCellValue(sheetName, 67, 13, 831.5),
					new ExpectedCellValue(sheetName, 68, 13, 831.5),
					new ExpectedCellValue(sheetName, 69, 13, 1194d),
					new ExpectedCellValue(sheetName, 70, 13, 1194d),
					new ExpectedCellValue(sheetName, 71, 13, 1194d),
					new ExpectedCellValue(sheetName, 72, 13, 1194d),
					new ExpectedCellValue(sheetName, 73, 13, 415.75),
					new ExpectedCellValue(sheetName, 74, 13, 415.75),
					new ExpectedCellValue(sheetName, 75, 13, 415.75),
					new ExpectedCellValue(sheetName, 76, 13, 415.75),
					new ExpectedCellValue(sheetName, 77, 13, 24.99),
					new ExpectedCellValue(sheetName, 78, 13, 24.99),
					new ExpectedCellValue(sheetName, 79, 13, 24.99),
					new ExpectedCellValue(sheetName, 80, 13, 24.99),
					new ExpectedCellValue(sheetName, 81, 13, 99d),
					new ExpectedCellValue(sheetName, 82, 13, 99d),
					new ExpectedCellValue(sheetName, 83, 13, 99d),
					new ExpectedCellValue(sheetName, 84, 13, 99d),
					new ExpectedCellValue(sheetName, 85, 13, 831.5),
					new ExpectedCellValue(sheetName, 86, 13, 831.5),
					new ExpectedCellValue(sheetName, 87, 13, 831.5),
					new ExpectedCellValue(sheetName, 88, 13, 831.5),
					new ExpectedCellValue(sheetName, 89, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("K60:M110"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 11, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 11, 20100007),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, null),
					new ExpectedCellValue(sheetName, 65, 11, null),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, "20100007 Total"),
					new ExpectedCellValue(sheetName, 68, 11, 20100017),
					new ExpectedCellValue(sheetName, 69, 11, null),
					new ExpectedCellValue(sheetName, 70, 11, null),
					new ExpectedCellValue(sheetName, 71, 11, null),
					new ExpectedCellValue(sheetName, 72, 11, null),
					new ExpectedCellValue(sheetName, 73, 11, null),
					new ExpectedCellValue(sheetName, 74, 11, "20100017 Total"),
					new ExpectedCellValue(sheetName, 75, 11, 20100070),
					new ExpectedCellValue(sheetName, 76, 11, null),
					new ExpectedCellValue(sheetName, 77, 11, null),
					new ExpectedCellValue(sheetName, 78, 11, null),
					new ExpectedCellValue(sheetName, 79, 11, null),
					new ExpectedCellValue(sheetName, 80, 11, null),
					new ExpectedCellValue(sheetName, 81, 11, "20100070 Total"),
					new ExpectedCellValue(sheetName, 82, 11, 20100076),
					new ExpectedCellValue(sheetName, 83, 11, null),
					new ExpectedCellValue(sheetName, 84, 11, null),
					new ExpectedCellValue(sheetName, 85, 11, null),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, null),
					new ExpectedCellValue(sheetName, 88, 11, "20100076 Total"),
					new ExpectedCellValue(sheetName, 89, 11, 20100083),
					new ExpectedCellValue(sheetName, 90, 11, null),
					new ExpectedCellValue(sheetName, 91, 11, null),
					new ExpectedCellValue(sheetName, 92, 11, null),
					new ExpectedCellValue(sheetName, 93, 11, null),
					new ExpectedCellValue(sheetName, 94, 11, null),
					new ExpectedCellValue(sheetName, 95, 11, "20100083 Total"),
					new ExpectedCellValue(sheetName, 96, 11, 20100085),
					new ExpectedCellValue(sheetName, 97, 11, null),
					new ExpectedCellValue(sheetName, 98, 11, null),
					new ExpectedCellValue(sheetName, 99, 11, null),
					new ExpectedCellValue(sheetName, 100, 11, null),
					new ExpectedCellValue(sheetName, 101, 11, null),
					new ExpectedCellValue(sheetName, 102, 11, "20100085 Total"),
					new ExpectedCellValue(sheetName, 103, 11, 20100090),
					new ExpectedCellValue(sheetName, 104, 11, null),
					new ExpectedCellValue(sheetName, 105, 11, null),
					new ExpectedCellValue(sheetName, 106, 11, null),
					new ExpectedCellValue(sheetName, 107, 11, null),
					new ExpectedCellValue(sheetName, 108, 11, null),
					new ExpectedCellValue(sheetName, 109, 11, "20100090 Total"),
					new ExpectedCellValue(sheetName, 110, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 12, "Location"),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 12, "January"),
					new ExpectedCellValue(sheetName, 64, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 12, "January Total"),
					new ExpectedCellValue(sheetName, 66, 12, "Chicago Total"),
					new ExpectedCellValue(sheetName, 67, 12, null),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 70, 12, "March"),
					new ExpectedCellValue(sheetName, 71, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 72, 12, "March Total"),
					new ExpectedCellValue(sheetName, 73, 12, "Nashville Total"),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 12, "February"),
					new ExpectedCellValue(sheetName, 78, 12, "Tent"),
					new ExpectedCellValue(sheetName, 79, 12, "February Total"),
					new ExpectedCellValue(sheetName, 80, 12, "Nashville Total"),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, null),
					new ExpectedCellValue(sheetName, 83, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 12, "January"),
					new ExpectedCellValue(sheetName, 85, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 12, "January Total"),
					new ExpectedCellValue(sheetName, 87, 12, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 90, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 91, 12, "March"),
					new ExpectedCellValue(sheetName, 92, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 93, 12, "March Total"),
					new ExpectedCellValue(sheetName, 94, 12, "Chicago Total"),
					new ExpectedCellValue(sheetName, 95, 12, null),
					new ExpectedCellValue(sheetName, 96, 12, null),
					new ExpectedCellValue(sheetName, 97, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 12, "February"),
					new ExpectedCellValue(sheetName, 99, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 100, 12, "February Total"),
					new ExpectedCellValue(sheetName, 101, 12, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 102, 12, null),
					new ExpectedCellValue(sheetName, 103, 12, null),
					new ExpectedCellValue(sheetName, 104, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 105, 12, "January"),
					new ExpectedCellValue(sheetName, 106, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 107, 12, "January Total"),
					new ExpectedCellValue(sheetName, 108, 12, "Nashville Total"),
					new ExpectedCellValue(sheetName, 109, 12, null),
					new ExpectedCellValue(sheetName, 110, 12, null),
					new ExpectedCellValue(sheetName, 60, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 13, null),
					new ExpectedCellValue(sheetName, 62, 13, null),
					new ExpectedCellValue(sheetName, 63, 13, null),
					new ExpectedCellValue(sheetName, 64, 13, 831.5),
					new ExpectedCellValue(sheetName, 65, 13, 831.5),
					new ExpectedCellValue(sheetName, 66, 13, 831.5),
					new ExpectedCellValue(sheetName, 67, 13, 831.5),
					new ExpectedCellValue(sheetName, 68, 13, null),
					new ExpectedCellValue(sheetName, 69, 13, null),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, 831.5),
					new ExpectedCellValue(sheetName, 72, 13, 831.5),
					new ExpectedCellValue(sheetName, 73, 13, 831.5),
					new ExpectedCellValue(sheetName, 74, 13, 831.5),
					new ExpectedCellValue(sheetName, 75, 13, null),
					new ExpectedCellValue(sheetName, 76, 13, null),
					new ExpectedCellValue(sheetName, 77, 13, null),
					new ExpectedCellValue(sheetName, 78, 13, 1194d),
					new ExpectedCellValue(sheetName, 79, 13, 1194d),
					new ExpectedCellValue(sheetName, 80, 13, 1194d),
					new ExpectedCellValue(sheetName, 81, 13, 1194d),
					new ExpectedCellValue(sheetName, 82, 13, null),
					new ExpectedCellValue(sheetName, 83, 13, null),
					new ExpectedCellValue(sheetName, 84, 13, null),
					new ExpectedCellValue(sheetName, 85, 13, 415.75),
					new ExpectedCellValue(sheetName, 86, 13, 415.75),
					new ExpectedCellValue(sheetName, 87, 13, 415.75),
					new ExpectedCellValue(sheetName, 88, 13, 415.75),
					new ExpectedCellValue(sheetName, 89, 13, null),
					new ExpectedCellValue(sheetName, 90, 13, null),
					new ExpectedCellValue(sheetName, 91, 13, null),
					new ExpectedCellValue(sheetName, 92, 13, 24.99),
					new ExpectedCellValue(sheetName, 93, 13, 24.99),
					new ExpectedCellValue(sheetName, 94, 13, 24.99),
					new ExpectedCellValue(sheetName, 95, 13, 24.99),
					new ExpectedCellValue(sheetName, 96, 13, null),
					new ExpectedCellValue(sheetName, 97, 13, null),
					new ExpectedCellValue(sheetName, 98, 13, null),
					new ExpectedCellValue(sheetName, 99, 13, 99d),
					new ExpectedCellValue(sheetName, 100, 13, 99d),
					new ExpectedCellValue(sheetName, 101, 13, 99d),
					new ExpectedCellValue(sheetName, 102, 13, 99d),
					new ExpectedCellValue(sheetName, 103, 13, null),
					new ExpectedCellValue(sheetName, 104, 13, null),
					new ExpectedCellValue(sheetName, 105, 13, null),
					new ExpectedCellValue(sheetName, 106, 13, 831.5),
					new ExpectedCellValue(sheetName, 107, 13, 831.5),
					new ExpectedCellValue(sheetName, 108, 13, 831.5),
					new ExpectedCellValue(sheetName, 109, 13, 831.5),
					new ExpectedCellValue(sheetName, 110, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O60:Q89"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 15, 20100007),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, null),
					new ExpectedCellValue(sheetName, 64, 15, null),
					new ExpectedCellValue(sheetName, 65, 15, 20100017),
					new ExpectedCellValue(sheetName, 66, 15, null),
					new ExpectedCellValue(sheetName, 67, 15, null),
					new ExpectedCellValue(sheetName, 68, 15, null),
					new ExpectedCellValue(sheetName, 69, 15, 20100070),
					new ExpectedCellValue(sheetName, 70, 15, null),
					new ExpectedCellValue(sheetName, 71, 15, null),
					new ExpectedCellValue(sheetName, 72, 15, null),
					new ExpectedCellValue(sheetName, 73, 15, 20100076),
					new ExpectedCellValue(sheetName, 74, 15, null),
					new ExpectedCellValue(sheetName, 75, 15, null),
					new ExpectedCellValue(sheetName, 76, 15, null),
					new ExpectedCellValue(sheetName, 77, 15, 20100083),
					new ExpectedCellValue(sheetName, 78, 15, null),
					new ExpectedCellValue(sheetName, 79, 15, null),
					new ExpectedCellValue(sheetName, 80, 15, null),
					new ExpectedCellValue(sheetName, 81, 15, 20100085),
					new ExpectedCellValue(sheetName, 82, 15, null),
					new ExpectedCellValue(sheetName, 83, 15, null),
					new ExpectedCellValue(sheetName, 84, 15, null),
					new ExpectedCellValue(sheetName, 85, 15, 20100090),
					new ExpectedCellValue(sheetName, 86, 15, null),
					new ExpectedCellValue(sheetName, 87, 15, null),
					new ExpectedCellValue(sheetName, 88, 15, null),
					new ExpectedCellValue(sheetName, 89, 15, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 16, "Location"),
					new ExpectedCellValue(sheetName, 61, 16, null),
					new ExpectedCellValue(sheetName, 62, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 16, "January"),
					new ExpectedCellValue(sheetName, 64, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 16, null),
					new ExpectedCellValue(sheetName, 66, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 67, 16, "March"),
					new ExpectedCellValue(sheetName, 68, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 16, null),
					new ExpectedCellValue(sheetName, 70, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 71, 16, "February"),
					new ExpectedCellValue(sheetName, 72, 16, "Tent"),
					new ExpectedCellValue(sheetName, 73, 16, null),
					new ExpectedCellValue(sheetName, 74, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 75, 16, "January"),
					new ExpectedCellValue(sheetName, 76, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 16, null),
					new ExpectedCellValue(sheetName, 78, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 16, "March"),
					new ExpectedCellValue(sheetName, 80, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 83, 16, "February"),
					new ExpectedCellValue(sheetName, 84, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 85, 16, null),
					new ExpectedCellValue(sheetName, 86, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 87, 16, "January"),
					new ExpectedCellValue(sheetName, 88, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 89, 16, null),
					new ExpectedCellValue(sheetName, 60, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 17, 831.5),
					new ExpectedCellValue(sheetName, 62, 17, 831.5),
					new ExpectedCellValue(sheetName, 63, 17, 831.5),
					new ExpectedCellValue(sheetName, 64, 17, 831.5),
					new ExpectedCellValue(sheetName, 65, 17, 831.5),
					new ExpectedCellValue(sheetName, 66, 17, 831.5),
					new ExpectedCellValue(sheetName, 67, 17, 831.5),
					new ExpectedCellValue(sheetName, 68, 17, 831.5),
					new ExpectedCellValue(sheetName, 69, 17, 1194d),
					new ExpectedCellValue(sheetName, 70, 17, 1194d),
					new ExpectedCellValue(sheetName, 71, 17, 1194d),
					new ExpectedCellValue(sheetName, 72, 17, 1194d),
					new ExpectedCellValue(sheetName, 73, 17, 415.75),
					new ExpectedCellValue(sheetName, 74, 17, 415.75),
					new ExpectedCellValue(sheetName, 75, 17, 415.75),
					new ExpectedCellValue(sheetName, 76, 17, 415.75),
					new ExpectedCellValue(sheetName, 77, 17, 24.99),
					new ExpectedCellValue(sheetName, 78, 17, 24.99),
					new ExpectedCellValue(sheetName, 79, 17, 24.99),
					new ExpectedCellValue(sheetName, 80, 17, 24.99),
					new ExpectedCellValue(sheetName, 81, 17, 99d),
					new ExpectedCellValue(sheetName, 82, 17, 99d),
					new ExpectedCellValue(sheetName, 83, 17, 99d),
					new ExpectedCellValue(sheetName, 84, 17, 99d),
					new ExpectedCellValue(sheetName, 85, 17, 831.5),
					new ExpectedCellValue(sheetName, 86, 17, 831.5),
					new ExpectedCellValue(sheetName, 87, 17, 831.5),
					new ExpectedCellValue(sheetName, 88, 17, 831.5),
					new ExpectedCellValue(sheetName, 89, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsFirstFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("O60:Q110"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 60, 15, "Row Labels"),
					new ExpectedCellValue(sheetName, 61, 15, 20100007),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, null),
					new ExpectedCellValue(sheetName, 64, 15, null),
					new ExpectedCellValue(sheetName, 65, 15, null),
					new ExpectedCellValue(sheetName, 66, 15, null),
					new ExpectedCellValue(sheetName, 67, 15, "20100007 Total"),
					new ExpectedCellValue(sheetName, 68, 15, 20100017),
					new ExpectedCellValue(sheetName, 69, 15, null),
					new ExpectedCellValue(sheetName, 70, 15, null),
					new ExpectedCellValue(sheetName, 71, 15, null),
					new ExpectedCellValue(sheetName, 72, 15, null),
					new ExpectedCellValue(sheetName, 73, 15, null),
					new ExpectedCellValue(sheetName, 74, 15, "20100017 Total"),
					new ExpectedCellValue(sheetName, 75, 15, 20100070),
					new ExpectedCellValue(sheetName, 76, 15, null),
					new ExpectedCellValue(sheetName, 77, 15, null),
					new ExpectedCellValue(sheetName, 78, 15, null),
					new ExpectedCellValue(sheetName, 79, 15, null),
					new ExpectedCellValue(sheetName, 80, 15, null),
					new ExpectedCellValue(sheetName, 81, 15, "20100070 Total"),
					new ExpectedCellValue(sheetName, 82, 15, 20100076),
					new ExpectedCellValue(sheetName, 83, 15, null),
					new ExpectedCellValue(sheetName, 84, 15, null),
					new ExpectedCellValue(sheetName, 85, 15, null),
					new ExpectedCellValue(sheetName, 86, 15, null),
					new ExpectedCellValue(sheetName, 87, 15, null),
					new ExpectedCellValue(sheetName, 88, 15, "20100076 Total"),
					new ExpectedCellValue(sheetName, 89, 15, 20100083),
					new ExpectedCellValue(sheetName, 90, 15, null),
					new ExpectedCellValue(sheetName, 91, 15, null),
					new ExpectedCellValue(sheetName, 92, 15, null),
					new ExpectedCellValue(sheetName, 93, 15, null),
					new ExpectedCellValue(sheetName, 94, 15, null),
					new ExpectedCellValue(sheetName, 95, 15, "20100083 Total"),
					new ExpectedCellValue(sheetName, 96, 15, 20100085),
					new ExpectedCellValue(sheetName, 97, 15, null),
					new ExpectedCellValue(sheetName, 98, 15, null),
					new ExpectedCellValue(sheetName, 99, 15, null),
					new ExpectedCellValue(sheetName, 100, 15, null),
					new ExpectedCellValue(sheetName, 101, 15, null),
					new ExpectedCellValue(sheetName, 102, 15, "20100085 Total"),
					new ExpectedCellValue(sheetName, 103, 15, 20100090),
					new ExpectedCellValue(sheetName, 104, 15, null),
					new ExpectedCellValue(sheetName, 105, 15, null),
					new ExpectedCellValue(sheetName, 106, 15, null),
					new ExpectedCellValue(sheetName, 107, 15, null),
					new ExpectedCellValue(sheetName, 108, 15, null),
					new ExpectedCellValue(sheetName, 109, 15, "20100090 Total"),
					new ExpectedCellValue(sheetName, 110, 15, "Grand Total"),
					new ExpectedCellValue(sheetName, 60, 16, "Location"),
					new ExpectedCellValue(sheetName, 61, 16, null),
					new ExpectedCellValue(sheetName, 62, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 63, 16, "January"),
					new ExpectedCellValue(sheetName, 64, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 65, 16, "January Total"),
					new ExpectedCellValue(sheetName, 66, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 67, 16, null),
					new ExpectedCellValue(sheetName, 68, 16, null),
					new ExpectedCellValue(sheetName, 69, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 70, 16, "March"),
					new ExpectedCellValue(sheetName, 71, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 72, 16, "March Total"),
					new ExpectedCellValue(sheetName, 73, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 74, 16, null),
					new ExpectedCellValue(sheetName, 75, 16, null),
					new ExpectedCellValue(sheetName, 76, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 16, "February"),
					new ExpectedCellValue(sheetName, 78, 16, "Tent"),
					new ExpectedCellValue(sheetName, 79, 16, "February Total"),
					new ExpectedCellValue(sheetName, 80, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, null),
					new ExpectedCellValue(sheetName, 83, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 16, "January"),
					new ExpectedCellValue(sheetName, 85, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 16, "January Total"),
					new ExpectedCellValue(sheetName, 87, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 16, null),
					new ExpectedCellValue(sheetName, 89, 16, null),
					new ExpectedCellValue(sheetName, 90, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 91, 16, "March"),
					new ExpectedCellValue(sheetName, 92, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 93, 16, "March Total"),
					new ExpectedCellValue(sheetName, 94, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 95, 16, null),
					new ExpectedCellValue(sheetName, 96, 16, null),
					new ExpectedCellValue(sheetName, 97, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 16, "February"),
					new ExpectedCellValue(sheetName, 99, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 100, 16, "February Total"),
					new ExpectedCellValue(sheetName, 101, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 102, 16, null),
					new ExpectedCellValue(sheetName, 103, 16, null),
					new ExpectedCellValue(sheetName, 104, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 105, 16, "January"),
					new ExpectedCellValue(sheetName, 106, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 107, 16, "January Total"),
					new ExpectedCellValue(sheetName, 108, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 109, 16, null),
					new ExpectedCellValue(sheetName, 110, 16, null),
					new ExpectedCellValue(sheetName, 60, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 61, 17, null),
					new ExpectedCellValue(sheetName, 62, 17, null),
					new ExpectedCellValue(sheetName, 63, 17, null),
					new ExpectedCellValue(sheetName, 64, 17, 831.5),
					new ExpectedCellValue(sheetName, 65, 17, 831.5),
					new ExpectedCellValue(sheetName, 66, 17, 831.5),
					new ExpectedCellValue(sheetName, 67, 17, 831.5),
					new ExpectedCellValue(sheetName, 68, 17, null),
					new ExpectedCellValue(sheetName, 69, 17, null),
					new ExpectedCellValue(sheetName, 70, 17, null),
					new ExpectedCellValue(sheetName, 71, 17, 831.5),
					new ExpectedCellValue(sheetName, 72, 17, 831.5),
					new ExpectedCellValue(sheetName, 73, 17, 831.5),
					new ExpectedCellValue(sheetName, 74, 17, 831.5),
					new ExpectedCellValue(sheetName, 75, 17, null),
					new ExpectedCellValue(sheetName, 76, 17, null),
					new ExpectedCellValue(sheetName, 77, 17, null),
					new ExpectedCellValue(sheetName, 78, 17, 1194d),
					new ExpectedCellValue(sheetName, 79, 17, 1194d),
					new ExpectedCellValue(sheetName, 80, 17, 1194d),
					new ExpectedCellValue(sheetName, 81, 17, 1194d),
					new ExpectedCellValue(sheetName, 82, 17, null),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, null),
					new ExpectedCellValue(sheetName, 85, 17, 415.75),
					new ExpectedCellValue(sheetName, 86, 17, 415.75),
					new ExpectedCellValue(sheetName, 87, 17, 415.75),
					new ExpectedCellValue(sheetName, 88, 17, 415.75),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, null),
					new ExpectedCellValue(sheetName, 91, 17, null),
					new ExpectedCellValue(sheetName, 92, 17, 24.99),
					new ExpectedCellValue(sheetName, 93, 17, 24.99),
					new ExpectedCellValue(sheetName, 94, 17, 24.99),
					new ExpectedCellValue(sheetName, 95, 17, 24.99),
					new ExpectedCellValue(sheetName, 96, 17, null),
					new ExpectedCellValue(sheetName, 97, 17, null),
					new ExpectedCellValue(sheetName, 98, 17, null),
					new ExpectedCellValue(sheetName, 99, 17, 99d),
					new ExpectedCellValue(sheetName, 100, 17, 99d),
					new ExpectedCellValue(sheetName, 101, 17, 99d),
					new ExpectedCellValue(sheetName, 102, 17, 99d),
					new ExpectedCellValue(sheetName, 103, 17, null),
					new ExpectedCellValue(sheetName, 104, 17, null),
					new ExpectedCellValue(sheetName, 105, 17, null),
					new ExpectedCellValue(sheetName, 106, 17, 831.5),
					new ExpectedCellValue(sheetName, 107, 17, 831.5),
					new ExpectedCellValue(sheetName, 108, 17, 831.5),
					new ExpectedCellValue(sheetName, 109, 17, 831.5),
					new ExpectedCellValue(sheetName, 110, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A115:B144"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 1, 20100007),
					new ExpectedCellValue(sheetName, 117, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 1, "January"),
					new ExpectedCellValue(sheetName, 119, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 1, 20100017),
					new ExpectedCellValue(sheetName, 121, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 122, 1, "March"),
					new ExpectedCellValue(sheetName, 123, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 1, 20100070),
					new ExpectedCellValue(sheetName, 125, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 1, "February"),
					new ExpectedCellValue(sheetName, 127, 1, "Tent"),
					new ExpectedCellValue(sheetName, 128, 1, 20100076),
					new ExpectedCellValue(sheetName, 129, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 130, 1, "January"),
					new ExpectedCellValue(sheetName, 131, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 1, 20100083),
					new ExpectedCellValue(sheetName, 133, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 1, "March"),
					new ExpectedCellValue(sheetName, 135, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 1, 20100085),
					new ExpectedCellValue(sheetName, 137, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 1, "February"),
					new ExpectedCellValue(sheetName, 139, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 140, 1, 20100090),
					new ExpectedCellValue(sheetName, 141, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 142, 1, "January"),
					new ExpectedCellValue(sheetName, 143, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 2, 831.5),
					new ExpectedCellValue(sheetName, 117, 2, 831.5),
					new ExpectedCellValue(sheetName, 118, 2, 831.5),
					new ExpectedCellValue(sheetName, 119, 2, 831.5),
					new ExpectedCellValue(sheetName, 120, 2, 831.5),
					new ExpectedCellValue(sheetName, 121, 2, 831.5),
					new ExpectedCellValue(sheetName, 122, 2, 831.5),
					new ExpectedCellValue(sheetName, 123, 2, 831.5),
					new ExpectedCellValue(sheetName, 124, 2, 1194d),
					new ExpectedCellValue(sheetName, 125, 2, 1194d),
					new ExpectedCellValue(sheetName, 126, 2, 1194d),
					new ExpectedCellValue(sheetName, 127, 2, 1194d),
					new ExpectedCellValue(sheetName, 128, 2, 415.75),
					new ExpectedCellValue(sheetName, 129, 2, 415.75),
					new ExpectedCellValue(sheetName, 130, 2, 415.75),
					new ExpectedCellValue(sheetName, 131, 2, 415.75),
					new ExpectedCellValue(sheetName, 132, 2, 24.99),
					new ExpectedCellValue(sheetName, 133, 2, 24.99),
					new ExpectedCellValue(sheetName, 134, 2, 24.99),
					new ExpectedCellValue(sheetName, 135, 2, 24.99),
					new ExpectedCellValue(sheetName, 136, 2, 99d),
					new ExpectedCellValue(sheetName, 137, 2, 99d),
					new ExpectedCellValue(sheetName, 138, 2, 99d),
					new ExpectedCellValue(sheetName, 139, 2, 99d),
					new ExpectedCellValue(sheetName, 140, 2, 831.5),
					new ExpectedCellValue(sheetName, 141, 2, 831.5),
					new ExpectedCellValue(sheetName, 142, 2, 831.5),
					new ExpectedCellValue(sheetName, 143, 2, 831.5),
					new ExpectedCellValue(sheetName, 144, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsLastFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A115:B165"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 1, 20100007),
					new ExpectedCellValue(sheetName, 117, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 1, "January"),
					new ExpectedCellValue(sheetName, 119, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 1, "January Total"),
					new ExpectedCellValue(sheetName, 121, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 122, 1, "20100007 Total"),
					new ExpectedCellValue(sheetName, 123, 1, 20100017),
					new ExpectedCellValue(sheetName, 124, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 1, "March"),
					new ExpectedCellValue(sheetName, 126, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 1, "March Total"),
					new ExpectedCellValue(sheetName, 128, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 129, 1, "20100017 Total"),
					new ExpectedCellValue(sheetName, 130, 1, 20100070),
					new ExpectedCellValue(sheetName, 131, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 1, "February"),
					new ExpectedCellValue(sheetName, 133, 1, "Tent"),
					new ExpectedCellValue(sheetName, 134, 1, "February Total"),
					new ExpectedCellValue(sheetName, 135, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 136, 1, "20100070 Total"),
					new ExpectedCellValue(sheetName, 137, 1, 20100076),
					new ExpectedCellValue(sheetName, 138, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 139, 1, "January"),
					new ExpectedCellValue(sheetName, 140, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 1, "January Total"),
					new ExpectedCellValue(sheetName, 142, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 143, 1, "20100076 Total"),
					new ExpectedCellValue(sheetName, 144, 1, 20100083),
					new ExpectedCellValue(sheetName, 145, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 1, "March"),
					new ExpectedCellValue(sheetName, 147, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 1, "March Total"),
					new ExpectedCellValue(sheetName, 149, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 1, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 1, 20100085),
					new ExpectedCellValue(sheetName, 152, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 1, "February"),
					new ExpectedCellValue(sheetName, 154, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 155, 1, "February Total"),
					new ExpectedCellValue(sheetName, 156, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 157, 1, "20100085 Total"),
					new ExpectedCellValue(sheetName, 158, 1, 20100090),
					new ExpectedCellValue(sheetName, 159, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 160, 1, "January"),
					new ExpectedCellValue(sheetName, 161, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 162, 1, "January Total"),
					new ExpectedCellValue(sheetName, 163, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 164, 1, "20100090 Total"),
					new ExpectedCellValue(sheetName, 165, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 2, null),
					new ExpectedCellValue(sheetName, 117, 2, null),
					new ExpectedCellValue(sheetName, 118, 2, null),
					new ExpectedCellValue(sheetName, 119, 2, 831.5),
					new ExpectedCellValue(sheetName, 120, 2, 831.5),
					new ExpectedCellValue(sheetName, 121, 2, 831.5),
					new ExpectedCellValue(sheetName, 122, 2, 831.5),
					new ExpectedCellValue(sheetName, 123, 2, null),
					new ExpectedCellValue(sheetName, 124, 2, null),
					new ExpectedCellValue(sheetName, 125, 2, null),
					new ExpectedCellValue(sheetName, 126, 2, 831.5),
					new ExpectedCellValue(sheetName, 127, 2, 831.5),
					new ExpectedCellValue(sheetName, 128, 2, 831.5),
					new ExpectedCellValue(sheetName, 129, 2, 831.5),
					new ExpectedCellValue(sheetName, 130, 2, null),
					new ExpectedCellValue(sheetName, 131, 2, null),
					new ExpectedCellValue(sheetName, 132, 2, null),
					new ExpectedCellValue(sheetName, 133, 2, 1194d),
					new ExpectedCellValue(sheetName, 134, 2, 1194d),
					new ExpectedCellValue(sheetName, 135, 2, 1194d),
					new ExpectedCellValue(sheetName, 136, 2, 1194d),
					new ExpectedCellValue(sheetName, 137, 2, null),
					new ExpectedCellValue(sheetName, 138, 2, null),
					new ExpectedCellValue(sheetName, 139, 2, null),
					new ExpectedCellValue(sheetName, 140, 2, 415.75),
					new ExpectedCellValue(sheetName, 141, 2, 415.75),
					new ExpectedCellValue(sheetName, 142, 2, 415.75),
					new ExpectedCellValue(sheetName, 143, 2, 415.75),
					new ExpectedCellValue(sheetName, 144, 2, null),
					new ExpectedCellValue(sheetName, 145, 2, null),
					new ExpectedCellValue(sheetName, 146, 2, null),
					new ExpectedCellValue(sheetName, 147, 2, 24.99),
					new ExpectedCellValue(sheetName, 148, 2, 24.99),
					new ExpectedCellValue(sheetName, 149, 2, 24.99),
					new ExpectedCellValue(sheetName, 150, 2, 24.99),
					new ExpectedCellValue(sheetName, 151, 2, null),
					new ExpectedCellValue(sheetName, 152, 2, null),
					new ExpectedCellValue(sheetName, 153, 2, null),
					new ExpectedCellValue(sheetName, 154, 2, 99d),
					new ExpectedCellValue(sheetName, 155, 2, 99d),
					new ExpectedCellValue(sheetName, 156, 2, 99d),
					new ExpectedCellValue(sheetName, 157, 2, 99d),
					new ExpectedCellValue(sheetName, 158, 2, null),
					new ExpectedCellValue(sheetName, 159, 2, null),
					new ExpectedCellValue(sheetName, 160, 2, null),
					new ExpectedCellValue(sheetName, 161, 2, 831.5),
					new ExpectedCellValue(sheetName, 162, 2, 831.5),
					new ExpectedCellValue(sheetName, 163, 2, 831.5),
					new ExpectedCellValue(sheetName, 164, 2, 831.5),
					new ExpectedCellValue(sheetName, 165, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsThirdFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("D115:F144"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 4, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 4, 20100007),
					new ExpectedCellValue(sheetName, 117, 4, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 4, "January"),
					new ExpectedCellValue(sheetName, 119, 4, null),
					new ExpectedCellValue(sheetName, 120, 4, 20100017),
					new ExpectedCellValue(sheetName, 121, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 122, 4, "March"),
					new ExpectedCellValue(sheetName, 123, 4, null),
					new ExpectedCellValue(sheetName, 124, 4, 20100070),
					new ExpectedCellValue(sheetName, 125, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 4, "February"),
					new ExpectedCellValue(sheetName, 127, 4, null),
					new ExpectedCellValue(sheetName, 128, 4, 20100076),
					new ExpectedCellValue(sheetName, 129, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 130, 4, "January"),
					new ExpectedCellValue(sheetName, 131, 4, null),
					new ExpectedCellValue(sheetName, 132, 4, 20100083),
					new ExpectedCellValue(sheetName, 133, 4, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 4, "March"),
					new ExpectedCellValue(sheetName, 135, 4, null),
					new ExpectedCellValue(sheetName, 136, 4, 20100085),
					new ExpectedCellValue(sheetName, 137, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 4, "February"),
					new ExpectedCellValue(sheetName, 139, 4, null),
					new ExpectedCellValue(sheetName, 140, 4, 20100090),
					new ExpectedCellValue(sheetName, 141, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 142, 4, "January"),
					new ExpectedCellValue(sheetName, 143, 4, null),
					new ExpectedCellValue(sheetName, 144, 4, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 5, "Item"),
					new ExpectedCellValue(sheetName, 116, 5, null),
					new ExpectedCellValue(sheetName, 117, 5, null),
					new ExpectedCellValue(sheetName, 118, 5, null),
					new ExpectedCellValue(sheetName, 119, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 5, null),
					new ExpectedCellValue(sheetName, 121, 5, null),
					new ExpectedCellValue(sheetName, 122, 5, null),
					new ExpectedCellValue(sheetName, 123, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 5, null),
					new ExpectedCellValue(sheetName, 125, 5, null),
					new ExpectedCellValue(sheetName, 126, 5, null),
					new ExpectedCellValue(sheetName, 127, 5, "Tent"),
					new ExpectedCellValue(sheetName, 128, 5, null),
					new ExpectedCellValue(sheetName, 129, 5, null),
					new ExpectedCellValue(sheetName, 130, 5, null),
					new ExpectedCellValue(sheetName, 131, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 5, null),
					new ExpectedCellValue(sheetName, 133, 5, null),
					new ExpectedCellValue(sheetName, 134, 5, null),
					new ExpectedCellValue(sheetName, 135, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 5, null),
					new ExpectedCellValue(sheetName, 137, 5, null),
					new ExpectedCellValue(sheetName, 138, 5, null),
					new ExpectedCellValue(sheetName, 139, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 140, 5, null),
					new ExpectedCellValue(sheetName, 141, 5, null),
					new ExpectedCellValue(sheetName, 142, 5, null),
					new ExpectedCellValue(sheetName, 143, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 5, null),
					new ExpectedCellValue(sheetName, 115, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 6, 831.5),
					new ExpectedCellValue(sheetName, 117, 6, 831.5),
					new ExpectedCellValue(sheetName, 118, 6, 831.5),
					new ExpectedCellValue(sheetName, 119, 6, 831.5),
					new ExpectedCellValue(sheetName, 120, 6, 831.5),
					new ExpectedCellValue(sheetName, 121, 6, 831.5),
					new ExpectedCellValue(sheetName, 122, 6, 831.5),
					new ExpectedCellValue(sheetName, 123, 6, 831.5),
					new ExpectedCellValue(sheetName, 124, 6, 1194d),
					new ExpectedCellValue(sheetName, 125, 6, 1194d),
					new ExpectedCellValue(sheetName, 126, 6, 1194d),
					new ExpectedCellValue(sheetName, 127, 6, 1194d),
					new ExpectedCellValue(sheetName, 128, 6, 415.75),
					new ExpectedCellValue(sheetName, 129, 6, 415.75),
					new ExpectedCellValue(sheetName, 130, 6, 415.75),
					new ExpectedCellValue(sheetName, 131, 6, 415.75),
					new ExpectedCellValue(sheetName, 132, 6, 24.99),
					new ExpectedCellValue(sheetName, 133, 6, 24.99),
					new ExpectedCellValue(sheetName, 134, 6, 24.99),
					new ExpectedCellValue(sheetName, 135, 6, 24.99),
					new ExpectedCellValue(sheetName, 136, 6, 99d),
					new ExpectedCellValue(sheetName, 137, 6, 99d),
					new ExpectedCellValue(sheetName, 138, 6, 99d),
					new ExpectedCellValue(sheetName, 139, 6, 99d),
					new ExpectedCellValue(sheetName, 140, 6, 831.5),
					new ExpectedCellValue(sheetName, 141, 6, 831.5),
					new ExpectedCellValue(sheetName, 142, 6, 831.5),
					new ExpectedCellValue(sheetName, 143, 6, 831.5),
					new ExpectedCellValue(sheetName, 144, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsThirdFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("D115:F165"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 4, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 4, 20100007),
					new ExpectedCellValue(sheetName, 117, 4, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 4, "January"),
					new ExpectedCellValue(sheetName, 119, 4, null),
					new ExpectedCellValue(sheetName, 120, 4, "January Total"),
					new ExpectedCellValue(sheetName, 121, 4, "Chicago Total"),
					new ExpectedCellValue(sheetName, 122, 4, "20100007 Total"),
					new ExpectedCellValue(sheetName, 123, 4, 20100017),
					new ExpectedCellValue(sheetName, 124, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 4, "March"),
					new ExpectedCellValue(sheetName, 126, 4, null),
					new ExpectedCellValue(sheetName, 127, 4, "March Total"),
					new ExpectedCellValue(sheetName, 128, 4, "Nashville Total"),
					new ExpectedCellValue(sheetName, 129, 4, "20100017 Total"),
					new ExpectedCellValue(sheetName, 130, 4, 20100070),
					new ExpectedCellValue(sheetName, 131, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 4, "February"),
					new ExpectedCellValue(sheetName, 133, 4, null),
					new ExpectedCellValue(sheetName, 134, 4, "February Total"),
					new ExpectedCellValue(sheetName, 135, 4, "Nashville Total"),
					new ExpectedCellValue(sheetName, 136, 4, "20100070 Total"),
					new ExpectedCellValue(sheetName, 137, 4, 20100076),
					new ExpectedCellValue(sheetName, 138, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 139, 4, "January"),
					new ExpectedCellValue(sheetName, 140, 4, null),
					new ExpectedCellValue(sheetName, 141, 4, "January Total"),
					new ExpectedCellValue(sheetName, 142, 4, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 143, 4, "20100076 Total"),
					new ExpectedCellValue(sheetName, 144, 4, 20100083),
					new ExpectedCellValue(sheetName, 145, 4, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 4, "March"),
					new ExpectedCellValue(sheetName, 147, 4, null),
					new ExpectedCellValue(sheetName, 148, 4, "March Total"),
					new ExpectedCellValue(sheetName, 149, 4, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 4, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 4, 20100085),
					new ExpectedCellValue(sheetName, 152, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 4, "February"),
					new ExpectedCellValue(sheetName, 154, 4, null),
					new ExpectedCellValue(sheetName, 155, 4, "February Total"),
					new ExpectedCellValue(sheetName, 156, 4, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 157, 4, "20100085 Total"),
					new ExpectedCellValue(sheetName, 158, 4, 20100090),
					new ExpectedCellValue(sheetName, 159, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 160, 4, "January"),
					new ExpectedCellValue(sheetName, 161, 4, null),
					new ExpectedCellValue(sheetName, 162, 4, "January Total"),
					new ExpectedCellValue(sheetName, 163, 4, "Nashville Total"),
					new ExpectedCellValue(sheetName, 164, 4, "20100090 Total"),
					new ExpectedCellValue(sheetName, 165, 4, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 5, "Item"),
					new ExpectedCellValue(sheetName, 116, 5, null),
					new ExpectedCellValue(sheetName, 117, 5, null),
					new ExpectedCellValue(sheetName, 118, 5, null),
					new ExpectedCellValue(sheetName, 119, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 5, null),
					new ExpectedCellValue(sheetName, 121, 5, null),
					new ExpectedCellValue(sheetName, 122, 5, null),
					new ExpectedCellValue(sheetName, 123, 5, null),
					new ExpectedCellValue(sheetName, 124, 5, null),
					new ExpectedCellValue(sheetName, 125, 5, null),
					new ExpectedCellValue(sheetName, 126, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 5, null),
					new ExpectedCellValue(sheetName, 128, 5, null),
					new ExpectedCellValue(sheetName, 129, 5, null),
					new ExpectedCellValue(sheetName, 130, 5, null),
					new ExpectedCellValue(sheetName, 131, 5, null),
					new ExpectedCellValue(sheetName, 132, 5, null),
					new ExpectedCellValue(sheetName, 133, 5, "Tent"),
					new ExpectedCellValue(sheetName, 134, 5, null),
					new ExpectedCellValue(sheetName, 135, 5, null),
					new ExpectedCellValue(sheetName, 136, 5, null),
					new ExpectedCellValue(sheetName, 137, 5, null),
					new ExpectedCellValue(sheetName, 138, 5, null),
					new ExpectedCellValue(sheetName, 139, 5, null),
					new ExpectedCellValue(sheetName, 140, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 5, null),
					new ExpectedCellValue(sheetName, 142, 5, null),
					new ExpectedCellValue(sheetName, 143, 5, null),
					new ExpectedCellValue(sheetName, 144, 5, null),
					new ExpectedCellValue(sheetName, 145, 5, null),
					new ExpectedCellValue(sheetName, 146, 5, null),
					new ExpectedCellValue(sheetName, 147, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 5, null),
					new ExpectedCellValue(sheetName, 149, 5, null),
					new ExpectedCellValue(sheetName, 150, 5, null),
					new ExpectedCellValue(sheetName, 151, 5, null),
					new ExpectedCellValue(sheetName, 152, 5, null),
					new ExpectedCellValue(sheetName, 153, 5, null),
					new ExpectedCellValue(sheetName, 154, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 155, 5, null),
					new ExpectedCellValue(sheetName, 156, 5, null),
					new ExpectedCellValue(sheetName, 157, 5, null),
					new ExpectedCellValue(sheetName, 158, 5, null),
					new ExpectedCellValue(sheetName, 159, 5, null),
					new ExpectedCellValue(sheetName, 160, 5, null),
					new ExpectedCellValue(sheetName, 161, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 162, 5, null),
					new ExpectedCellValue(sheetName, 163, 5, null),
					new ExpectedCellValue(sheetName, 164, 5, null),
					new ExpectedCellValue(sheetName, 165, 5, null),
					new ExpectedCellValue(sheetName, 115, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 6, null),
					new ExpectedCellValue(sheetName, 117, 6, null),
					new ExpectedCellValue(sheetName, 118, 6, null),
					new ExpectedCellValue(sheetName, 119, 6, 831.5),
					new ExpectedCellValue(sheetName, 120, 6, 831.5),
					new ExpectedCellValue(sheetName, 121, 6, 831.5),
					new ExpectedCellValue(sheetName, 122, 6, 831.5),
					new ExpectedCellValue(sheetName, 123, 6, null),
					new ExpectedCellValue(sheetName, 124, 6, null),
					new ExpectedCellValue(sheetName, 125, 6, null),
					new ExpectedCellValue(sheetName, 126, 6, 831.5),
					new ExpectedCellValue(sheetName, 127, 6, 831.5),
					new ExpectedCellValue(sheetName, 128, 6, 831.5),
					new ExpectedCellValue(sheetName, 129, 6, 831.5),
					new ExpectedCellValue(sheetName, 130, 6, null),
					new ExpectedCellValue(sheetName, 131, 6, null),
					new ExpectedCellValue(sheetName, 132, 6, null),
					new ExpectedCellValue(sheetName, 133, 6, 1194d),
					new ExpectedCellValue(sheetName, 134, 6, 1194d),
					new ExpectedCellValue(sheetName, 135, 6, 1194d),
					new ExpectedCellValue(sheetName, 136, 6, 1194d),
					new ExpectedCellValue(sheetName, 137, 6, null),
					new ExpectedCellValue(sheetName, 138, 6, null),
					new ExpectedCellValue(sheetName, 139, 6, null),
					new ExpectedCellValue(sheetName, 140, 6, 415.75),
					new ExpectedCellValue(sheetName, 141, 6, 415.75),
					new ExpectedCellValue(sheetName, 142, 6, 415.75),
					new ExpectedCellValue(sheetName, 143, 6, 415.75),
					new ExpectedCellValue(sheetName, 144, 6, null),
					new ExpectedCellValue(sheetName, 145, 6, null),
					new ExpectedCellValue(sheetName, 146, 6, null),
					new ExpectedCellValue(sheetName, 147, 6, 24.99),
					new ExpectedCellValue(sheetName, 148, 6, 24.99),
					new ExpectedCellValue(sheetName, 149, 6, 24.99),
					new ExpectedCellValue(sheetName, 150, 6, 24.99),
					new ExpectedCellValue(sheetName, 151, 6, null),
					new ExpectedCellValue(sheetName, 152, 6, null),
					new ExpectedCellValue(sheetName, 153, 6, null),
					new ExpectedCellValue(sheetName, 154, 6, 99d),
					new ExpectedCellValue(sheetName, 155, 6, 99d),
					new ExpectedCellValue(sheetName, 156, 6, 99d),
					new ExpectedCellValue(sheetName, 157, 6, 99d),
					new ExpectedCellValue(sheetName, 158, 6, null),
					new ExpectedCellValue(sheetName, 159, 6, null),
					new ExpectedCellValue(sheetName, 160, 6, null),
					new ExpectedCellValue(sheetName, 161, 6, 831.5),
					new ExpectedCellValue(sheetName, 162, 6, 831.5),
					new ExpectedCellValue(sheetName, 163, 6, 831.5),
					new ExpectedCellValue(sheetName, 164, 6, 831.5),
					new ExpectedCellValue(sheetName, 165, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H115:J144"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 8, 20100007),
					new ExpectedCellValue(sheetName, 117, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 8, "January"),
					new ExpectedCellValue(sheetName, 119, 8, null),
					new ExpectedCellValue(sheetName, 120, 8, 20100017),
					new ExpectedCellValue(sheetName, 121, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 122, 8, "March"),
					new ExpectedCellValue(sheetName, 123, 8, null),
					new ExpectedCellValue(sheetName, 124, 8, 20100070),
					new ExpectedCellValue(sheetName, 125, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 8, "February"),
					new ExpectedCellValue(sheetName, 127, 8, null),
					new ExpectedCellValue(sheetName, 128, 8, 20100076),
					new ExpectedCellValue(sheetName, 129, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 130, 8, "January"),
					new ExpectedCellValue(sheetName, 131, 8, null),
					new ExpectedCellValue(sheetName, 132, 8, 20100083),
					new ExpectedCellValue(sheetName, 133, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 8, "March"),
					new ExpectedCellValue(sheetName, 135, 8, null),
					new ExpectedCellValue(sheetName, 136, 8, 20100085),
					new ExpectedCellValue(sheetName, 137, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 8, "February"),
					new ExpectedCellValue(sheetName, 139, 8, null),
					new ExpectedCellValue(sheetName, 140, 8, 20100090),
					new ExpectedCellValue(sheetName, 141, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 142, 8, "January"),
					new ExpectedCellValue(sheetName, 143, 8, null),
					new ExpectedCellValue(sheetName, 144, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 9, "Item"),
					new ExpectedCellValue(sheetName, 116, 9, null),
					new ExpectedCellValue(sheetName, 117, 9, null),
					new ExpectedCellValue(sheetName, 118, 9, null),
					new ExpectedCellValue(sheetName, 119, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 9, null),
					new ExpectedCellValue(sheetName, 121, 9, null),
					new ExpectedCellValue(sheetName, 122, 9, null),
					new ExpectedCellValue(sheetName, 123, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 9, null),
					new ExpectedCellValue(sheetName, 125, 9, null),
					new ExpectedCellValue(sheetName, 126, 9, null),
					new ExpectedCellValue(sheetName, 127, 9, "Tent"),
					new ExpectedCellValue(sheetName, 128, 9, null),
					new ExpectedCellValue(sheetName, 129, 9, null),
					new ExpectedCellValue(sheetName, 130, 9, null),
					new ExpectedCellValue(sheetName, 131, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 9, null),
					new ExpectedCellValue(sheetName, 133, 9, null),
					new ExpectedCellValue(sheetName, 134, 9, null),
					new ExpectedCellValue(sheetName, 135, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 9, null),
					new ExpectedCellValue(sheetName, 137, 9, null),
					new ExpectedCellValue(sheetName, 138, 9, null),
					new ExpectedCellValue(sheetName, 139, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 140, 9, null),
					new ExpectedCellValue(sheetName, 141, 9, null),
					new ExpectedCellValue(sheetName, 142, 9, null),
					new ExpectedCellValue(sheetName, 143, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 9, null),
					new ExpectedCellValue(sheetName, 115, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 10, 831.5),
					new ExpectedCellValue(sheetName, 117, 10, 831.5),
					new ExpectedCellValue(sheetName, 118, 10, 831.5),
					new ExpectedCellValue(sheetName, 119, 10, 831.5),
					new ExpectedCellValue(sheetName, 120, 10, 831.5),
					new ExpectedCellValue(sheetName, 121, 10, 831.5),
					new ExpectedCellValue(sheetName, 122, 10, 831.5),
					new ExpectedCellValue(sheetName, 123, 10, 831.5),
					new ExpectedCellValue(sheetName, 124, 10, 1194d),
					new ExpectedCellValue(sheetName, 125, 10, 1194d),
					new ExpectedCellValue(sheetName, 126, 10, 1194d),
					new ExpectedCellValue(sheetName, 127, 10, 1194d),
					new ExpectedCellValue(sheetName, 128, 10, 415.75),
					new ExpectedCellValue(sheetName, 129, 10, 415.75),
					new ExpectedCellValue(sheetName, 130, 10, 415.75),
					new ExpectedCellValue(sheetName, 131, 10, 415.75),
					new ExpectedCellValue(sheetName, 132, 10, 24.99),
					new ExpectedCellValue(sheetName, 133, 10, 24.99),
					new ExpectedCellValue(sheetName, 134, 10, 24.99),
					new ExpectedCellValue(sheetName, 135, 10, 24.99),
					new ExpectedCellValue(sheetName, 136, 10, 99d),
					new ExpectedCellValue(sheetName, 137, 10, 99d),
					new ExpectedCellValue(sheetName, 138, 10, 99d),
					new ExpectedCellValue(sheetName, 139, 10, 99d),
					new ExpectedCellValue(sheetName, 140, 10, 831.5),
					new ExpectedCellValue(sheetName, 141, 10, 831.5),
					new ExpectedCellValue(sheetName, 142, 10, 831.5),
					new ExpectedCellValue(sheetName, 143, 10, 831.5),
					new ExpectedCellValue(sheetName, 144, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsThirdAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H115:J165"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 8, 20100007),
					new ExpectedCellValue(sheetName, 117, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 8, "January"),
					new ExpectedCellValue(sheetName, 119, 8, null),
					new ExpectedCellValue(sheetName, 120, 8, "January Total"),
					new ExpectedCellValue(sheetName, 121, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 122, 8, "20100007 Total"),
					new ExpectedCellValue(sheetName, 123, 8, 20100017),
					new ExpectedCellValue(sheetName, 124, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 8, "March"),
					new ExpectedCellValue(sheetName, 126, 8, null),
					new ExpectedCellValue(sheetName, 127, 8, "March Total"),
					new ExpectedCellValue(sheetName, 128, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 129, 8, "20100017 Total"),
					new ExpectedCellValue(sheetName, 130, 8, 20100070),
					new ExpectedCellValue(sheetName, 131, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 8, "February"),
					new ExpectedCellValue(sheetName, 133, 8, null),
					new ExpectedCellValue(sheetName, 134, 8, "February Total"),
					new ExpectedCellValue(sheetName, 135, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 136, 8, "20100070 Total"),
					new ExpectedCellValue(sheetName, 137, 8, 20100076),
					new ExpectedCellValue(sheetName, 138, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 139, 8, "January"),
					new ExpectedCellValue(sheetName, 140, 8, null),
					new ExpectedCellValue(sheetName, 141, 8, "January Total"),
					new ExpectedCellValue(sheetName, 142, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 143, 8, "20100076 Total"),
					new ExpectedCellValue(sheetName, 144, 8, 20100083),
					new ExpectedCellValue(sheetName, 145, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 8, "March"),
					new ExpectedCellValue(sheetName, 147, 8, null),
					new ExpectedCellValue(sheetName, 148, 8, "March Total"),
					new ExpectedCellValue(sheetName, 149, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 8, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 8, 20100085),
					new ExpectedCellValue(sheetName, 152, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 8, "February"),
					new ExpectedCellValue(sheetName, 154, 8, null),
					new ExpectedCellValue(sheetName, 155, 8, "February Total"),
					new ExpectedCellValue(sheetName, 156, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 157, 8, "20100085 Total"),
					new ExpectedCellValue(sheetName, 158, 8, 20100090),
					new ExpectedCellValue(sheetName, 159, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 160, 8, "January"),
					new ExpectedCellValue(sheetName, 161, 8, null),
					new ExpectedCellValue(sheetName, 162, 8, "January Total"),
					new ExpectedCellValue(sheetName, 163, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 164, 8, "20100090 Total"),
					new ExpectedCellValue(sheetName, 165, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 9, "Item"),
					new ExpectedCellValue(sheetName, 116, 9, null),
					new ExpectedCellValue(sheetName, 117, 9, null),
					new ExpectedCellValue(sheetName, 118, 9, null),
					new ExpectedCellValue(sheetName, 119, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 9, null),
					new ExpectedCellValue(sheetName, 121, 9, null),
					new ExpectedCellValue(sheetName, 122, 9, null),
					new ExpectedCellValue(sheetName, 123, 9, null),
					new ExpectedCellValue(sheetName, 124, 9, null),
					new ExpectedCellValue(sheetName, 125, 9, null),
					new ExpectedCellValue(sheetName, 126, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 9, null),
					new ExpectedCellValue(sheetName, 128, 9, null),
					new ExpectedCellValue(sheetName, 129, 9, null),
					new ExpectedCellValue(sheetName, 130, 9, null),
					new ExpectedCellValue(sheetName, 131, 9, null),
					new ExpectedCellValue(sheetName, 132, 9, null),
					new ExpectedCellValue(sheetName, 133, 9, "Tent"),
					new ExpectedCellValue(sheetName, 134, 9, null),
					new ExpectedCellValue(sheetName, 135, 9, null),
					new ExpectedCellValue(sheetName, 136, 9, null),
					new ExpectedCellValue(sheetName, 137, 9, null),
					new ExpectedCellValue(sheetName, 138, 9, null),
					new ExpectedCellValue(sheetName, 139, 9, null),
					new ExpectedCellValue(sheetName, 140, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 9, null),
					new ExpectedCellValue(sheetName, 142, 9, null),
					new ExpectedCellValue(sheetName, 143, 9, null),
					new ExpectedCellValue(sheetName, 144, 9, null),
					new ExpectedCellValue(sheetName, 145, 9, null),
					new ExpectedCellValue(sheetName, 146, 9, null),
					new ExpectedCellValue(sheetName, 147, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 9, null),
					new ExpectedCellValue(sheetName, 149, 9, null),
					new ExpectedCellValue(sheetName, 150, 9, null),
					new ExpectedCellValue(sheetName, 151, 9, null),
					new ExpectedCellValue(sheetName, 152, 9, null),
					new ExpectedCellValue(sheetName, 153, 9, null),
					new ExpectedCellValue(sheetName, 154, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 155, 9, null),
					new ExpectedCellValue(sheetName, 156, 9, null),
					new ExpectedCellValue(sheetName, 157, 9, null),
					new ExpectedCellValue(sheetName, 158, 9, null),
					new ExpectedCellValue(sheetName, 159, 9, null),
					new ExpectedCellValue(sheetName, 160, 9, null),
					new ExpectedCellValue(sheetName, 161, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 162, 9, null),
					new ExpectedCellValue(sheetName, 163, 9, null),
					new ExpectedCellValue(sheetName, 164, 9, null),
					new ExpectedCellValue(sheetName, 165, 9, null),
					new ExpectedCellValue(sheetName, 115, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 10, null),
					new ExpectedCellValue(sheetName, 117, 10, null),
					new ExpectedCellValue(sheetName, 118, 10, null),
					new ExpectedCellValue(sheetName, 119, 10, 831.5),
					new ExpectedCellValue(sheetName, 120, 10, 831.5),
					new ExpectedCellValue(sheetName, 121, 10, 831.5),
					new ExpectedCellValue(sheetName, 122, 10, 831.5),
					new ExpectedCellValue(sheetName, 123, 10, null),
					new ExpectedCellValue(sheetName, 124, 10, null),
					new ExpectedCellValue(sheetName, 125, 10, null),
					new ExpectedCellValue(sheetName, 126, 10, 831.5),
					new ExpectedCellValue(sheetName, 127, 10, 831.5),
					new ExpectedCellValue(sheetName, 128, 10, 831.5),
					new ExpectedCellValue(sheetName, 129, 10, 831.5),
					new ExpectedCellValue(sheetName, 130, 10, null),
					new ExpectedCellValue(sheetName, 131, 10, null),
					new ExpectedCellValue(sheetName, 132, 10, null),
					new ExpectedCellValue(sheetName, 133, 10, 1194d),
					new ExpectedCellValue(sheetName, 134, 10, 1194d),
					new ExpectedCellValue(sheetName, 135, 10, 1194d),
					new ExpectedCellValue(sheetName, 136, 10, 1194d),
					new ExpectedCellValue(sheetName, 137, 10, null),
					new ExpectedCellValue(sheetName, 138, 10, null),
					new ExpectedCellValue(sheetName, 139, 10, null),
					new ExpectedCellValue(sheetName, 140, 10, 415.75),
					new ExpectedCellValue(sheetName, 141, 10, 415.75),
					new ExpectedCellValue(sheetName, 142, 10, 415.75),
					new ExpectedCellValue(sheetName, 143, 10, 415.75),
					new ExpectedCellValue(sheetName, 144, 10, null),
					new ExpectedCellValue(sheetName, 145, 10, null),
					new ExpectedCellValue(sheetName, 146, 10, null),
					new ExpectedCellValue(sheetName, 147, 10, 24.99),
					new ExpectedCellValue(sheetName, 148, 10, 24.99),
					new ExpectedCellValue(sheetName, 149, 10, 24.99),
					new ExpectedCellValue(sheetName, 150, 10, 24.99),
					new ExpectedCellValue(sheetName, 151, 10, null),
					new ExpectedCellValue(sheetName, 152, 10, null),
					new ExpectedCellValue(sheetName, 153, 10, null),
					new ExpectedCellValue(sheetName, 154, 10, 99d),
					new ExpectedCellValue(sheetName, 155, 10, 99d),
					new ExpectedCellValue(sheetName, 156, 10, 99d),
					new ExpectedCellValue(sheetName, 157, 10, 99d),
					new ExpectedCellValue(sheetName, 158, 10, null),
					new ExpectedCellValue(sheetName, 159, 10, null),
					new ExpectedCellValue(sheetName, 160, 10, null),
					new ExpectedCellValue(sheetName, 161, 10, 831.5),
					new ExpectedCellValue(sheetName, 162, 10, 831.5),
					new ExpectedCellValue(sheetName, 163, 10, 831.5),
					new ExpectedCellValue(sheetName, 164, 10, 831.5),
					new ExpectedCellValue(sheetName, 165, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L115:N144"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 12, 20100007),
					new ExpectedCellValue(sheetName, 117, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 12, null),
					new ExpectedCellValue(sheetName, 119, 12, null),
					new ExpectedCellValue(sheetName, 120, 12, 20100017),
					new ExpectedCellValue(sheetName, 121, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 122, 12, null),
					new ExpectedCellValue(sheetName, 123, 12, null),
					new ExpectedCellValue(sheetName, 124, 12, 20100070),
					new ExpectedCellValue(sheetName, 125, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 12, null),
					new ExpectedCellValue(sheetName, 127, 12, null),
					new ExpectedCellValue(sheetName, 128, 12, 20100076),
					new ExpectedCellValue(sheetName, 129, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 130, 12, null),
					new ExpectedCellValue(sheetName, 131, 12, null),
					new ExpectedCellValue(sheetName, 132, 12, 20100083),
					new ExpectedCellValue(sheetName, 133, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 12, null),
					new ExpectedCellValue(sheetName, 135, 12, null),
					new ExpectedCellValue(sheetName, 136, 12, 20100085),
					new ExpectedCellValue(sheetName, 137, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 12, null),
					new ExpectedCellValue(sheetName, 139, 12, null),
					new ExpectedCellValue(sheetName, 140, 12, 20100090),
					new ExpectedCellValue(sheetName, 141, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 142, 12, null),
					new ExpectedCellValue(sheetName, 143, 12, null),
					new ExpectedCellValue(sheetName, 144, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 13, "Month"),
					new ExpectedCellValue(sheetName, 116, 13, null),
					new ExpectedCellValue(sheetName, 117, 13, null),
					new ExpectedCellValue(sheetName, 118, 13, "January"),
					new ExpectedCellValue(sheetName, 119, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 13, null),
					new ExpectedCellValue(sheetName, 121, 13, null),
					new ExpectedCellValue(sheetName, 122, 13, "March"),
					new ExpectedCellValue(sheetName, 123, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 13, null),
					new ExpectedCellValue(sheetName, 125, 13, null),
					new ExpectedCellValue(sheetName, 126, 13, "February"),
					new ExpectedCellValue(sheetName, 127, 13, "Tent"),
					new ExpectedCellValue(sheetName, 128, 13, null),
					new ExpectedCellValue(sheetName, 129, 13, null),
					new ExpectedCellValue(sheetName, 130, 13, "January"),
					new ExpectedCellValue(sheetName, 131, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 13, null),
					new ExpectedCellValue(sheetName, 133, 13, null),
					new ExpectedCellValue(sheetName, 134, 13, "March"),
					new ExpectedCellValue(sheetName, 135, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 13, null),
					new ExpectedCellValue(sheetName, 137, 13, null),
					new ExpectedCellValue(sheetName, 138, 13, "February"),
					new ExpectedCellValue(sheetName, 139, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 140, 13, null),
					new ExpectedCellValue(sheetName, 141, 13, null),
					new ExpectedCellValue(sheetName, 142, 13, "January"),
					new ExpectedCellValue(sheetName, 143, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 13, null),
					new ExpectedCellValue(sheetName, 115, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 14, 831.5),
					new ExpectedCellValue(sheetName, 117, 14, 831.5),
					new ExpectedCellValue(sheetName, 118, 14, 831.5),
					new ExpectedCellValue(sheetName, 119, 14, 831.5),
					new ExpectedCellValue(sheetName, 120, 14, 831.5),
					new ExpectedCellValue(sheetName, 121, 14, 831.5),
					new ExpectedCellValue(sheetName, 122, 14, 831.5),
					new ExpectedCellValue(sheetName, 123, 14, 831.5),
					new ExpectedCellValue(sheetName, 124, 14, 1194d),
					new ExpectedCellValue(sheetName, 125, 14, 1194d),
					new ExpectedCellValue(sheetName, 126, 14, 1194d),
					new ExpectedCellValue(sheetName, 127, 14, 1194d),
					new ExpectedCellValue(sheetName, 128, 14, 415.75),
					new ExpectedCellValue(sheetName, 129, 14, 415.75),
					new ExpectedCellValue(sheetName, 130, 14, 415.75),
					new ExpectedCellValue(sheetName, 131, 14, 415.75),
					new ExpectedCellValue(sheetName, 132, 14, 24.99),
					new ExpectedCellValue(sheetName, 133, 14, 24.99),
					new ExpectedCellValue(sheetName, 134, 14, 24.99),
					new ExpectedCellValue(sheetName, 135, 14, 24.99),
					new ExpectedCellValue(sheetName, 136, 14, 99d),
					new ExpectedCellValue(sheetName, 137, 14, 99d),
					new ExpectedCellValue(sheetName, 138, 14, 99d),
					new ExpectedCellValue(sheetName, 139, 14, 99d),
					new ExpectedCellValue(sheetName, 140, 14, 831.5),
					new ExpectedCellValue(sheetName, 141, 14, 831.5),
					new ExpectedCellValue(sheetName, 142, 14, 831.5),
					new ExpectedCellValue(sheetName, 143, 14, 831.5),
					new ExpectedCellValue(sheetName, 144, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondFieldCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L115:N165"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 12, 20100007),
					new ExpectedCellValue(sheetName, 117, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 12, null),
					new ExpectedCellValue(sheetName, 119, 12, null),
					new ExpectedCellValue(sheetName, 120, 12, null),
					new ExpectedCellValue(sheetName, 121, 12, "Chicago Total"),
					new ExpectedCellValue(sheetName, 122, 12, "20100007 Total"),
					new ExpectedCellValue(sheetName, 123, 12, 20100017),
					new ExpectedCellValue(sheetName, 124, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 12, null),
					new ExpectedCellValue(sheetName, 126, 12, null),
					new ExpectedCellValue(sheetName, 127, 12, null),
					new ExpectedCellValue(sheetName, 128, 12, "Nashville Total"),
					new ExpectedCellValue(sheetName, 129, 12, "20100017 Total"),
					new ExpectedCellValue(sheetName, 130, 12, 20100070),
					new ExpectedCellValue(sheetName, 131, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 12, null),
					new ExpectedCellValue(sheetName, 133, 12, null),
					new ExpectedCellValue(sheetName, 134, 12, null),
					new ExpectedCellValue(sheetName, 135, 12, "Nashville Total"),
					new ExpectedCellValue(sheetName, 136, 12, "20100070 Total"),
					new ExpectedCellValue(sheetName, 137, 12, 20100076),
					new ExpectedCellValue(sheetName, 138, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 139, 12, null),
					new ExpectedCellValue(sheetName, 140, 12, null),
					new ExpectedCellValue(sheetName, 141, 12, null),
					new ExpectedCellValue(sheetName, 142, 12, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 143, 12, "20100076 Total"),
					new ExpectedCellValue(sheetName, 144, 12, 20100083),
					new ExpectedCellValue(sheetName, 145, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 12, null),
					new ExpectedCellValue(sheetName, 147, 12, null),
					new ExpectedCellValue(sheetName, 148, 12, null),
					new ExpectedCellValue(sheetName, 149, 12, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 12, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 12, 20100085),
					new ExpectedCellValue(sheetName, 152, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 12, null),
					new ExpectedCellValue(sheetName, 154, 12, null),
					new ExpectedCellValue(sheetName, 155, 12, null),
					new ExpectedCellValue(sheetName, 156, 12, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 157, 12, "20100085 Total"),
					new ExpectedCellValue(sheetName, 158, 12, 20100090),
					new ExpectedCellValue(sheetName, 159, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 160, 12, null),
					new ExpectedCellValue(sheetName, 161, 12, null),
					new ExpectedCellValue(sheetName, 162, 12, null),
					new ExpectedCellValue(sheetName, 163, 12, "Nashville Total"),
					new ExpectedCellValue(sheetName, 164, 12, "20100090 Total"),
					new ExpectedCellValue(sheetName, 165, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 13, "Month"),
					new ExpectedCellValue(sheetName, 116, 13, null),
					new ExpectedCellValue(sheetName, 117, 13, null),
					new ExpectedCellValue(sheetName, 118, 13, "January"),
					new ExpectedCellValue(sheetName, 119, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 13, "January Total"),
					new ExpectedCellValue(sheetName, 121, 13, null),
					new ExpectedCellValue(sheetName, 122, 13, null),
					new ExpectedCellValue(sheetName, 123, 13, null),
					new ExpectedCellValue(sheetName, 124, 13, null),
					new ExpectedCellValue(sheetName, 125, 13, "March"),
					new ExpectedCellValue(sheetName, 126, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 13, "March Total"),
					new ExpectedCellValue(sheetName, 128, 13, null),
					new ExpectedCellValue(sheetName, 129, 13, null),
					new ExpectedCellValue(sheetName, 130, 13, null),
					new ExpectedCellValue(sheetName, 131, 13, null),
					new ExpectedCellValue(sheetName, 132, 13, "February"),
					new ExpectedCellValue(sheetName, 133, 13, "Tent"),
					new ExpectedCellValue(sheetName, 134, 13, "February Total"),
					new ExpectedCellValue(sheetName, 135, 13, null),
					new ExpectedCellValue(sheetName, 136, 13, null),
					new ExpectedCellValue(sheetName, 137, 13, null),
					new ExpectedCellValue(sheetName, 138, 13, null),
					new ExpectedCellValue(sheetName, 139, 13, "January"),
					new ExpectedCellValue(sheetName, 140, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 13, "January Total"),
					new ExpectedCellValue(sheetName, 142, 13, null),
					new ExpectedCellValue(sheetName, 143, 13, null),
					new ExpectedCellValue(sheetName, 144, 13, null),
					new ExpectedCellValue(sheetName, 145, 13, null),
					new ExpectedCellValue(sheetName, 146, 13, "March"),
					new ExpectedCellValue(sheetName, 147, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 13, "March Total"),
					new ExpectedCellValue(sheetName, 149, 13, null),
					new ExpectedCellValue(sheetName, 150, 13, null),
					new ExpectedCellValue(sheetName, 151, 13, null),
					new ExpectedCellValue(sheetName, 152, 13, null),
					new ExpectedCellValue(sheetName, 153, 13, "February"),
					new ExpectedCellValue(sheetName, 154, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 155, 13, "February Total"),
					new ExpectedCellValue(sheetName, 156, 13, null),
					new ExpectedCellValue(sheetName, 157, 13, null),
					new ExpectedCellValue(sheetName, 158, 13, null),
					new ExpectedCellValue(sheetName, 159, 13, null),
					new ExpectedCellValue(sheetName, 160, 13, "January"),
					new ExpectedCellValue(sheetName, 161, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 162, 13, "January Total"),
					new ExpectedCellValue(sheetName, 163, 13, null),
					new ExpectedCellValue(sheetName, 164, 13, null),
					new ExpectedCellValue(sheetName, 165, 13, null),
					new ExpectedCellValue(sheetName, 115, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 14, null),
					new ExpectedCellValue(sheetName, 117, 14, null),
					new ExpectedCellValue(sheetName, 118, 14, null),
					new ExpectedCellValue(sheetName, 119, 14, 831.5),
					new ExpectedCellValue(sheetName, 120, 14, 831.5),
					new ExpectedCellValue(sheetName, 121, 14, 831.5),
					new ExpectedCellValue(sheetName, 122, 14, 831.5),
					new ExpectedCellValue(sheetName, 123, 14, null),
					new ExpectedCellValue(sheetName, 124, 14, null),
					new ExpectedCellValue(sheetName, 125, 14, null),
					new ExpectedCellValue(sheetName, 126, 14, 831.5),
					new ExpectedCellValue(sheetName, 127, 14, 831.5),
					new ExpectedCellValue(sheetName, 128, 14, 831.5),
					new ExpectedCellValue(sheetName, 129, 14, 831.5),
					new ExpectedCellValue(sheetName, 130, 14, null),
					new ExpectedCellValue(sheetName, 131, 14, null),
					new ExpectedCellValue(sheetName, 132, 14, null),
					new ExpectedCellValue(sheetName, 133, 14, 1194d),
					new ExpectedCellValue(sheetName, 134, 14, 1194d),
					new ExpectedCellValue(sheetName, 135, 14, 1194d),
					new ExpectedCellValue(sheetName, 136, 14, 1194d),
					new ExpectedCellValue(sheetName, 137, 14, null),
					new ExpectedCellValue(sheetName, 138, 14, null),
					new ExpectedCellValue(sheetName, 139, 14, null),
					new ExpectedCellValue(sheetName, 140, 14, 415.75),
					new ExpectedCellValue(sheetName, 141, 14, 415.75),
					new ExpectedCellValue(sheetName, 142, 14, 415.75),
					new ExpectedCellValue(sheetName, 143, 14, 415.75),
					new ExpectedCellValue(sheetName, 144, 14, null),
					new ExpectedCellValue(sheetName, 145, 14, null),
					new ExpectedCellValue(sheetName, 146, 14, null),
					new ExpectedCellValue(sheetName, 147, 14, 24.99),
					new ExpectedCellValue(sheetName, 148, 14, 24.99),
					new ExpectedCellValue(sheetName, 149, 14, 24.99),
					new ExpectedCellValue(sheetName, 150, 14, 24.99),
					new ExpectedCellValue(sheetName, 151, 14, null),
					new ExpectedCellValue(sheetName, 152, 14, null),
					new ExpectedCellValue(sheetName, 153, 14, null),
					new ExpectedCellValue(sheetName, 154, 14, 99d),
					new ExpectedCellValue(sheetName, 155, 14, 99d),
					new ExpectedCellValue(sheetName, 156, 14, 99d),
					new ExpectedCellValue(sheetName, 157, 14, 99d),
					new ExpectedCellValue(sheetName, 158, 14, null),
					new ExpectedCellValue(sheetName, 159, 14, null),
					new ExpectedCellValue(sheetName, 160, 14, null),
					new ExpectedCellValue(sheetName, 161, 14, 831.5),
					new ExpectedCellValue(sheetName, 162, 14, 831.5),
					new ExpectedCellValue(sheetName, 163, 14, 831.5),
					new ExpectedCellValue(sheetName, 164, 14, 831.5),
					new ExpectedCellValue(sheetName, 165, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P115:R144"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 16, 20100007),
					new ExpectedCellValue(sheetName, 117, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 16, null),
					new ExpectedCellValue(sheetName, 119, 16, null),
					new ExpectedCellValue(sheetName, 120, 16, 20100017),
					new ExpectedCellValue(sheetName, 121, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 122, 16, null),
					new ExpectedCellValue(sheetName, 123, 16, null),
					new ExpectedCellValue(sheetName, 124, 16, 20100070),
					new ExpectedCellValue(sheetName, 125, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 16, null),
					new ExpectedCellValue(sheetName, 127, 16, null),
					new ExpectedCellValue(sheetName, 128, 16, 20100076),
					new ExpectedCellValue(sheetName, 129, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 130, 16, null),
					new ExpectedCellValue(sheetName, 131, 16, null),
					new ExpectedCellValue(sheetName, 132, 16, 20100083),
					new ExpectedCellValue(sheetName, 133, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 16, null),
					new ExpectedCellValue(sheetName, 135, 16, null),
					new ExpectedCellValue(sheetName, 136, 16, 20100085),
					new ExpectedCellValue(sheetName, 137, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 16, null),
					new ExpectedCellValue(sheetName, 139, 16, null),
					new ExpectedCellValue(sheetName, 140, 16, 20100090),
					new ExpectedCellValue(sheetName, 141, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 142, 16, null),
					new ExpectedCellValue(sheetName, 143, 16, null),
					new ExpectedCellValue(sheetName, 144, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 17, "Month"),
					new ExpectedCellValue(sheetName, 116, 17, null),
					new ExpectedCellValue(sheetName, 117, 17, null),
					new ExpectedCellValue(sheetName, 118, 17, "January"),
					new ExpectedCellValue(sheetName, 119, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 17, null),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, "March"),
					new ExpectedCellValue(sheetName, 123, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 17, null),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, "February"),
					new ExpectedCellValue(sheetName, 127, 17, "Tent"),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, "January"),
					new ExpectedCellValue(sheetName, 131, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 17, null),
					new ExpectedCellValue(sheetName, 133, 17, null),
					new ExpectedCellValue(sheetName, 134, 17, "March"),
					new ExpectedCellValue(sheetName, 135, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 17, null),
					new ExpectedCellValue(sheetName, 137, 17, null),
					new ExpectedCellValue(sheetName, 138, 17, "February"),
					new ExpectedCellValue(sheetName, 139, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 140, 17, null),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, "January"),
					new ExpectedCellValue(sheetName, 143, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 17, null),
					new ExpectedCellValue(sheetName, 115, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 18, 831.5),
					new ExpectedCellValue(sheetName, 117, 18, 831.5),
					new ExpectedCellValue(sheetName, 118, 18, 831.5),
					new ExpectedCellValue(sheetName, 119, 18, 831.5),
					new ExpectedCellValue(sheetName, 120, 18, 831.5),
					new ExpectedCellValue(sheetName, 121, 18, 831.5),
					new ExpectedCellValue(sheetName, 122, 18, 831.5),
					new ExpectedCellValue(sheetName, 123, 18, 831.5),
					new ExpectedCellValue(sheetName, 124, 18, 1194d),
					new ExpectedCellValue(sheetName, 125, 18, 1194d),
					new ExpectedCellValue(sheetName, 126, 18, 1194d),
					new ExpectedCellValue(sheetName, 127, 18, 1194d),
					new ExpectedCellValue(sheetName, 128, 18, 415.75),
					new ExpectedCellValue(sheetName, 129, 18, 415.75),
					new ExpectedCellValue(sheetName, 130, 18, 415.75),
					new ExpectedCellValue(sheetName, 131, 18, 415.75),
					new ExpectedCellValue(sheetName, 132, 18, 24.99),
					new ExpectedCellValue(sheetName, 133, 18, 24.99),
					new ExpectedCellValue(sheetName, 134, 18, 24.99),
					new ExpectedCellValue(sheetName, 135, 18, 24.99),
					new ExpectedCellValue(sheetName, 136, 18, 99d),
					new ExpectedCellValue(sheetName, 137, 18, 99d),
					new ExpectedCellValue(sheetName, 138, 18, 99d),
					new ExpectedCellValue(sheetName, 139, 18, 99d),
					new ExpectedCellValue(sheetName, 140, 18, 831.5),
					new ExpectedCellValue(sheetName, 141, 18, 831.5),
					new ExpectedCellValue(sheetName, 142, 18, 831.5),
					new ExpectedCellValue(sheetName, 143, 18, 831.5),
					new ExpectedCellValue(sheetName, 144, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P115:R165"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 115, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 116, 16, 20100007),
					new ExpectedCellValue(sheetName, 117, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 16, null),
					new ExpectedCellValue(sheetName, 119, 16, null),
					new ExpectedCellValue(sheetName, 120, 16, null),
					new ExpectedCellValue(sheetName, 121, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 122, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 123, 16, 20100017),
					new ExpectedCellValue(sheetName, 124, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 16, null),
					new ExpectedCellValue(sheetName, 126, 16, null),
					new ExpectedCellValue(sheetName, 127, 16, null),
					new ExpectedCellValue(sheetName, 128, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 129, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 130, 16, 20100070),
					new ExpectedCellValue(sheetName, 131, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 16, null),
					new ExpectedCellValue(sheetName, 133, 16, null),
					new ExpectedCellValue(sheetName, 134, 16, null),
					new ExpectedCellValue(sheetName, 135, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 136, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 137, 16, 20100076),
					new ExpectedCellValue(sheetName, 138, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 139, 16, null),
					new ExpectedCellValue(sheetName, 140, 16, null),
					new ExpectedCellValue(sheetName, 141, 16, null),
					new ExpectedCellValue(sheetName, 142, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 143, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 144, 16, 20100083),
					new ExpectedCellValue(sheetName, 145, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 16, null),
					new ExpectedCellValue(sheetName, 147, 16, null),
					new ExpectedCellValue(sheetName, 148, 16, null),
					new ExpectedCellValue(sheetName, 149, 16, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 16, 20100085),
					new ExpectedCellValue(sheetName, 152, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 153, 16, null),
					new ExpectedCellValue(sheetName, 154, 16, null),
					new ExpectedCellValue(sheetName, 155, 16, null),
					new ExpectedCellValue(sheetName, 156, 16, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 157, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 158, 16, 20100090),
					new ExpectedCellValue(sheetName, 159, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 160, 16, null),
					new ExpectedCellValue(sheetName, 161, 16, null),
					new ExpectedCellValue(sheetName, 162, 16, null),
					new ExpectedCellValue(sheetName, 163, 16, "Nashville Total"),
					new ExpectedCellValue(sheetName, 164, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 165, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 115, 17, "Month"),
					new ExpectedCellValue(sheetName, 116, 17, null),
					new ExpectedCellValue(sheetName, 117, 17, null),
					new ExpectedCellValue(sheetName, 118, 17, "January"),
					new ExpectedCellValue(sheetName, 119, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 17, "January Total"),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, null),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, null),
					new ExpectedCellValue(sheetName, 125, 17, "March"),
					new ExpectedCellValue(sheetName, 126, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 17, "March Total"),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, null),
					new ExpectedCellValue(sheetName, 131, 17, null),
					new ExpectedCellValue(sheetName, 132, 17, "February"),
					new ExpectedCellValue(sheetName, 133, 17, "Tent"),
					new ExpectedCellValue(sheetName, 134, 17, "February Total"),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, null),
					new ExpectedCellValue(sheetName, 137, 17, null),
					new ExpectedCellValue(sheetName, 138, 17, null),
					new ExpectedCellValue(sheetName, 139, 17, "January"),
					new ExpectedCellValue(sheetName, 140, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 17, "January Total"),
					new ExpectedCellValue(sheetName, 142, 17, null),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, null),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, "March"),
					new ExpectedCellValue(sheetName, 147, 17, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 17, "March Total"),
					new ExpectedCellValue(sheetName, 149, 17, null),
					new ExpectedCellValue(sheetName, 150, 17, null),
					new ExpectedCellValue(sheetName, 151, 17, null),
					new ExpectedCellValue(sheetName, 152, 17, null),
					new ExpectedCellValue(sheetName, 153, 17, "February"),
					new ExpectedCellValue(sheetName, 154, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 155, 17, "February Total"),
					new ExpectedCellValue(sheetName, 156, 17, null),
					new ExpectedCellValue(sheetName, 157, 17, null),
					new ExpectedCellValue(sheetName, 158, 17, null),
					new ExpectedCellValue(sheetName, 159, 17, null),
					new ExpectedCellValue(sheetName, 160, 17, "January"),
					new ExpectedCellValue(sheetName, 161, 17, "Car Rack"),
					new ExpectedCellValue(sheetName, 162, 17, "January Total"),
					new ExpectedCellValue(sheetName, 163, 17, null),
					new ExpectedCellValue(sheetName, 164, 17, null),
					new ExpectedCellValue(sheetName, 165, 17, null),
					new ExpectedCellValue(sheetName, 115, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 18, null),
					new ExpectedCellValue(sheetName, 117, 18, null),
					new ExpectedCellValue(sheetName, 118, 18, null),
					new ExpectedCellValue(sheetName, 119, 18, 831.5),
					new ExpectedCellValue(sheetName, 120, 18, 831.5),
					new ExpectedCellValue(sheetName, 121, 18, 831.5),
					new ExpectedCellValue(sheetName, 122, 18, 831.5),
					new ExpectedCellValue(sheetName, 123, 18, null),
					new ExpectedCellValue(sheetName, 124, 18, null),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, 831.5),
					new ExpectedCellValue(sheetName, 127, 18, 831.5),
					new ExpectedCellValue(sheetName, 128, 18, 831.5),
					new ExpectedCellValue(sheetName, 129, 18, 831.5),
					new ExpectedCellValue(sheetName, 130, 18, null),
					new ExpectedCellValue(sheetName, 131, 18, null),
					new ExpectedCellValue(sheetName, 132, 18, null),
					new ExpectedCellValue(sheetName, 133, 18, 1194d),
					new ExpectedCellValue(sheetName, 134, 18, 1194d),
					new ExpectedCellValue(sheetName, 135, 18, 1194d),
					new ExpectedCellValue(sheetName, 136, 18, 1194d),
					new ExpectedCellValue(sheetName, 137, 18, null),
					new ExpectedCellValue(sheetName, 138, 18, null),
					new ExpectedCellValue(sheetName, 139, 18, null),
					new ExpectedCellValue(sheetName, 140, 18, 415.75),
					new ExpectedCellValue(sheetName, 141, 18, 415.75),
					new ExpectedCellValue(sheetName, 142, 18, 415.75),
					new ExpectedCellValue(sheetName, 143, 18, 415.75),
					new ExpectedCellValue(sheetName, 144, 18, null),
					new ExpectedCellValue(sheetName, 145, 18, null),
					new ExpectedCellValue(sheetName, 146, 18, null),
					new ExpectedCellValue(sheetName, 147, 18, 24.99),
					new ExpectedCellValue(sheetName, 148, 18, 24.99),
					new ExpectedCellValue(sheetName, 149, 18, 24.99),
					new ExpectedCellValue(sheetName, 150, 18, 24.99),
					new ExpectedCellValue(sheetName, 151, 18, null),
					new ExpectedCellValue(sheetName, 152, 18, null),
					new ExpectedCellValue(sheetName, 153, 18, null),
					new ExpectedCellValue(sheetName, 154, 18, 99d),
					new ExpectedCellValue(sheetName, 155, 18, 99d),
					new ExpectedCellValue(sheetName, 156, 18, 99d),
					new ExpectedCellValue(sheetName, 157, 18, 99d),
					new ExpectedCellValue(sheetName, 158, 18, null),
					new ExpectedCellValue(sheetName, 159, 18, null),
					new ExpectedCellValue(sheetName, 160, 18, null),
					new ExpectedCellValue(sheetName, 161, 18, 831.5),
					new ExpectedCellValue(sheetName, 162, 18, 831.5),
					new ExpectedCellValue(sheetName, 163, 18, 831.5),
					new ExpectedCellValue(sheetName, 164, 18, 831.5),
					new ExpectedCellValue(sheetName, 165, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A180:D209"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 180, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 181, 1, 20100007),
					new ExpectedCellValue(sheetName, 182, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 183, 1, null),
					new ExpectedCellValue(sheetName, 184, 1, null),
					new ExpectedCellValue(sheetName, 185, 1, 20100017),
					new ExpectedCellValue(sheetName, 186, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 187, 1, null),
					new ExpectedCellValue(sheetName, 188, 1, null),
					new ExpectedCellValue(sheetName, 189, 1, 20100070),
					new ExpectedCellValue(sheetName, 190, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 191, 1, null),
					new ExpectedCellValue(sheetName, 192, 1, null),
					new ExpectedCellValue(sheetName, 193, 1, 20100076),
					new ExpectedCellValue(sheetName, 194, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 195, 1, null),
					new ExpectedCellValue(sheetName, 196, 1, null),
					new ExpectedCellValue(sheetName, 197, 1, 20100083),
					new ExpectedCellValue(sheetName, 198, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 199, 1, null),
					new ExpectedCellValue(sheetName, 200, 1, null),
					new ExpectedCellValue(sheetName, 201, 1, 20100085),
					new ExpectedCellValue(sheetName, 202, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 203, 1, null),
					new ExpectedCellValue(sheetName, 204, 1, null),
					new ExpectedCellValue(sheetName, 205, 1, 20100090),
					new ExpectedCellValue(sheetName, 206, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 207, 1, null),
					new ExpectedCellValue(sheetName, 208, 1, null),
					new ExpectedCellValue(sheetName, 209, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 180, 2, "Month"),
					new ExpectedCellValue(sheetName, 181, 2, null),
					new ExpectedCellValue(sheetName, 182, 2, null),
					new ExpectedCellValue(sheetName, 183, 2, "January"),
					new ExpectedCellValue(sheetName, 184, 2, null),
					new ExpectedCellValue(sheetName, 185, 2, null),
					new ExpectedCellValue(sheetName, 186, 2, null),
					new ExpectedCellValue(sheetName, 187, 2, "March"),
					new ExpectedCellValue(sheetName, 188, 2, null),
					new ExpectedCellValue(sheetName, 189, 2, null),
					new ExpectedCellValue(sheetName, 190, 2, null),
					new ExpectedCellValue(sheetName, 191, 2, "February"),
					new ExpectedCellValue(sheetName, 192, 2, null),
					new ExpectedCellValue(sheetName, 193, 2, null),
					new ExpectedCellValue(sheetName, 194, 2, null),
					new ExpectedCellValue(sheetName, 195, 2, "January"),
					new ExpectedCellValue(sheetName, 196, 2, null),
					new ExpectedCellValue(sheetName, 197, 2, null),
					new ExpectedCellValue(sheetName, 198, 2, null),
					new ExpectedCellValue(sheetName, 199, 2, "March"),
					new ExpectedCellValue(sheetName, 200, 2, null),
					new ExpectedCellValue(sheetName, 201, 2, null),
					new ExpectedCellValue(sheetName, 202, 2, null),
					new ExpectedCellValue(sheetName, 203, 2, "February"),
					new ExpectedCellValue(sheetName, 204, 2, null),
					new ExpectedCellValue(sheetName, 205, 2, null),
					new ExpectedCellValue(sheetName, 206, 2, null),
					new ExpectedCellValue(sheetName, 207, 2, "January"),
					new ExpectedCellValue(sheetName, 208, 2, null),
					new ExpectedCellValue(sheetName, 209, 2, null),
					new ExpectedCellValue(sheetName, 180, 3, "Item"),
					new ExpectedCellValue(sheetName, 181, 3, null),
					new ExpectedCellValue(sheetName, 182, 3, null),
					new ExpectedCellValue(sheetName, 183, 3, null),
					new ExpectedCellValue(sheetName, 184, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 3, null),
					new ExpectedCellValue(sheetName, 186, 3, null),
					new ExpectedCellValue(sheetName, 187, 3, null),
					new ExpectedCellValue(sheetName, 188, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 189, 3, null),
					new ExpectedCellValue(sheetName, 190, 3, null),
					new ExpectedCellValue(sheetName, 191, 3, null),
					new ExpectedCellValue(sheetName, 192, 3, "Tent"),
					new ExpectedCellValue(sheetName, 193, 3, null),
					new ExpectedCellValue(sheetName, 194, 3, null),
					new ExpectedCellValue(sheetName, 195, 3, null),
					new ExpectedCellValue(sheetName, 196, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, null),
					new ExpectedCellValue(sheetName, 199, 3, null),
					new ExpectedCellValue(sheetName, 200, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, null),
					new ExpectedCellValue(sheetName, 203, 3, null),
					new ExpectedCellValue(sheetName, 204, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 205, 3, null),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, null),
					new ExpectedCellValue(sheetName, 208, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 180, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 181, 4, 831.5),
					new ExpectedCellValue(sheetName, 182, 4, 831.5),
					new ExpectedCellValue(sheetName, 183, 4, 831.5),
					new ExpectedCellValue(sheetName, 184, 4, 831.5),
					new ExpectedCellValue(sheetName, 185, 4, 831.5),
					new ExpectedCellValue(sheetName, 186, 4, 831.5),
					new ExpectedCellValue(sheetName, 187, 4, 831.5),
					new ExpectedCellValue(sheetName, 188, 4, 831.5),
					new ExpectedCellValue(sheetName, 189, 4, 1194d),
					new ExpectedCellValue(sheetName, 190, 4, 1194d),
					new ExpectedCellValue(sheetName, 191, 4, 1194d),
					new ExpectedCellValue(sheetName, 192, 4, 1194d),
					new ExpectedCellValue(sheetName, 193, 4, 415.75),
					new ExpectedCellValue(sheetName, 194, 4, 415.75),
					new ExpectedCellValue(sheetName, 195, 4, 415.75),
					new ExpectedCellValue(sheetName, 196, 4, 415.75),
					new ExpectedCellValue(sheetName, 197, 4, 24.99),
					new ExpectedCellValue(sheetName, 198, 4, 24.99),
					new ExpectedCellValue(sheetName, 199, 4, 24.99),
					new ExpectedCellValue(sheetName, 200, 4, 24.99),
					new ExpectedCellValue(sheetName, 201, 4, 99d),
					new ExpectedCellValue(sheetName, 202, 4, 99d),
					new ExpectedCellValue(sheetName, 203, 4, 99d),
					new ExpectedCellValue(sheetName, 204, 4, 99d),
					new ExpectedCellValue(sheetName, 205, 4, 831.5),
					new ExpectedCellValue(sheetName, 206, 4, 831.5),
					new ExpectedCellValue(sheetName, 207, 4, 831.5),
					new ExpectedCellValue(sheetName, 208, 4, 831.5),
					new ExpectedCellValue(sheetName, 209, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondAndThirdFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A180:D230"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 180, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 181, 1, 20100007),
					new ExpectedCellValue(sheetName, 182, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 183, 1, null),
					new ExpectedCellValue(sheetName, 184, 1, null),
					new ExpectedCellValue(sheetName, 185, 1, null),
					new ExpectedCellValue(sheetName, 186, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 187, 1, "20100007 Total"),
					new ExpectedCellValue(sheetName, 188, 1, 20100017),
					new ExpectedCellValue(sheetName, 189, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 190, 1, null),
					new ExpectedCellValue(sheetName, 191, 1, null),
					new ExpectedCellValue(sheetName, 192, 1, null),
					new ExpectedCellValue(sheetName, 193, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 194, 1, "20100017 Total"),
					new ExpectedCellValue(sheetName, 195, 1, 20100070),
					new ExpectedCellValue(sheetName, 196, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 197, 1, null),
					new ExpectedCellValue(sheetName, 198, 1, null),
					new ExpectedCellValue(sheetName, 199, 1, null),
					new ExpectedCellValue(sheetName, 200, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 201, 1, "20100070 Total"),
					new ExpectedCellValue(sheetName, 202, 1, 20100076),
					new ExpectedCellValue(sheetName, 203, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 204, 1, null),
					new ExpectedCellValue(sheetName, 205, 1, null),
					new ExpectedCellValue(sheetName, 206, 1, null),
					new ExpectedCellValue(sheetName, 207, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 208, 1, "20100076 Total"),
					new ExpectedCellValue(sheetName, 209, 1, 20100083),
					new ExpectedCellValue(sheetName, 210, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 211, 1, null),
					new ExpectedCellValue(sheetName, 212, 1, null),
					new ExpectedCellValue(sheetName, 213, 1, null),
					new ExpectedCellValue(sheetName, 214, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 215, 1, "20100083 Total"),
					new ExpectedCellValue(sheetName, 216, 1, 20100085),
					new ExpectedCellValue(sheetName, 217, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 218, 1, null),
					new ExpectedCellValue(sheetName, 219, 1, null),
					new ExpectedCellValue(sheetName, 220, 1, null),
					new ExpectedCellValue(sheetName, 221, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 222, 1, "20100085 Total"),
					new ExpectedCellValue(sheetName, 223, 1, 20100090),
					new ExpectedCellValue(sheetName, 224, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 225, 1, null),
					new ExpectedCellValue(sheetName, 226, 1, null),
					new ExpectedCellValue(sheetName, 227, 1, null),
					new ExpectedCellValue(sheetName, 228, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 229, 1, "20100090 Total"),
					new ExpectedCellValue(sheetName, 230, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 180, 2, "Month"),
					new ExpectedCellValue(sheetName, 181, 2, null),
					new ExpectedCellValue(sheetName, 182, 2, null),
					new ExpectedCellValue(sheetName, 183, 2, "January"),
					new ExpectedCellValue(sheetName, 184, 2, null),
					new ExpectedCellValue(sheetName, 185, 2, "January Total"),
					new ExpectedCellValue(sheetName, 186, 2, null),
					new ExpectedCellValue(sheetName, 187, 2, null),
					new ExpectedCellValue(sheetName, 188, 2, null),
					new ExpectedCellValue(sheetName, 189, 2, null),
					new ExpectedCellValue(sheetName, 190, 2, "March"),
					new ExpectedCellValue(sheetName, 191, 2, null),
					new ExpectedCellValue(sheetName, 192, 2, "March Total"),
					new ExpectedCellValue(sheetName, 193, 2, null),
					new ExpectedCellValue(sheetName, 194, 2, null),
					new ExpectedCellValue(sheetName, 195, 2, null),
					new ExpectedCellValue(sheetName, 196, 2, null),
					new ExpectedCellValue(sheetName, 197, 2, "February"),
					new ExpectedCellValue(sheetName, 198, 2, null),
					new ExpectedCellValue(sheetName, 199, 2, "February Total"),
					new ExpectedCellValue(sheetName, 200, 2, null),
					new ExpectedCellValue(sheetName, 201, 2, null),
					new ExpectedCellValue(sheetName, 202, 2, null),
					new ExpectedCellValue(sheetName, 203, 2, null),
					new ExpectedCellValue(sheetName, 204, 2, "January"),
					new ExpectedCellValue(sheetName, 205, 2, null),
					new ExpectedCellValue(sheetName, 206, 2, "January Total"),
					new ExpectedCellValue(sheetName, 207, 2, null),
					new ExpectedCellValue(sheetName, 208, 2, null),
					new ExpectedCellValue(sheetName, 209, 2, null),
					new ExpectedCellValue(sheetName, 210, 2, null),
					new ExpectedCellValue(sheetName, 211, 2, "March"),
					new ExpectedCellValue(sheetName, 212, 2, null),
					new ExpectedCellValue(sheetName, 213, 2, "March Total"),
					new ExpectedCellValue(sheetName, 214, 2, null),
					new ExpectedCellValue(sheetName, 215, 2, null),
					new ExpectedCellValue(sheetName, 216, 2, null),
					new ExpectedCellValue(sheetName, 217, 2, null),
					new ExpectedCellValue(sheetName, 218, 2, "February"),
					new ExpectedCellValue(sheetName, 219, 2, null),
					new ExpectedCellValue(sheetName, 220, 2, "February Total"),
					new ExpectedCellValue(sheetName, 221, 2, null),
					new ExpectedCellValue(sheetName, 222, 2, null),
					new ExpectedCellValue(sheetName, 223, 2, null),
					new ExpectedCellValue(sheetName, 224, 2, null),
					new ExpectedCellValue(sheetName, 225, 2, "January"),
					new ExpectedCellValue(sheetName, 226, 2, null),
					new ExpectedCellValue(sheetName, 227, 2, "January Total"),
					new ExpectedCellValue(sheetName, 228, 2, null),
					new ExpectedCellValue(sheetName, 229, 2, null),
					new ExpectedCellValue(sheetName, 230, 2, null),
					new ExpectedCellValue(sheetName, 180, 3, "Item"),
					new ExpectedCellValue(sheetName, 181, 3, null),
					new ExpectedCellValue(sheetName, 182, 3, null),
					new ExpectedCellValue(sheetName, 183, 3, null),
					new ExpectedCellValue(sheetName, 184, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 3, null),
					new ExpectedCellValue(sheetName, 186, 3, null),
					new ExpectedCellValue(sheetName, 187, 3, null),
					new ExpectedCellValue(sheetName, 188, 3, null),
					new ExpectedCellValue(sheetName, 189, 3, null),
					new ExpectedCellValue(sheetName, 190, 3, null),
					new ExpectedCellValue(sheetName, 191, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 3, null),
					new ExpectedCellValue(sheetName, 193, 3, null),
					new ExpectedCellValue(sheetName, 194, 3, null),
					new ExpectedCellValue(sheetName, 195, 3, null),
					new ExpectedCellValue(sheetName, 196, 3, null),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, "Tent"),
					new ExpectedCellValue(sheetName, 199, 3, null),
					new ExpectedCellValue(sheetName, 200, 3, null),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, null),
					new ExpectedCellValue(sheetName, 203, 3, null),
					new ExpectedCellValue(sheetName, 204, 3, null),
					new ExpectedCellValue(sheetName, 205, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, null),
					new ExpectedCellValue(sheetName, 208, 3, null),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 210, 3, null),
					new ExpectedCellValue(sheetName, 211, 3, null),
					new ExpectedCellValue(sheetName, 212, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 213, 3, null),
					new ExpectedCellValue(sheetName, 214, 3, null),
					new ExpectedCellValue(sheetName, 215, 3, null),
					new ExpectedCellValue(sheetName, 216, 3, null),
					new ExpectedCellValue(sheetName, 217, 3, null),
					new ExpectedCellValue(sheetName, 218, 3, null),
					new ExpectedCellValue(sheetName, 219, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 220, 3, null),
					new ExpectedCellValue(sheetName, 221, 3, null),
					new ExpectedCellValue(sheetName, 222, 3, null),
					new ExpectedCellValue(sheetName, 223, 3, null),
					new ExpectedCellValue(sheetName, 224, 3, null),
					new ExpectedCellValue(sheetName, 225, 3, null),
					new ExpectedCellValue(sheetName, 226, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 227, 3, null),
					new ExpectedCellValue(sheetName, 228, 3, null),
					new ExpectedCellValue(sheetName, 229, 3, null),
					new ExpectedCellValue(sheetName, 230, 3, null),
					new ExpectedCellValue(sheetName, 180, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 181, 4, null),
					new ExpectedCellValue(sheetName, 182, 4, null),
					new ExpectedCellValue(sheetName, 183, 4, null),
					new ExpectedCellValue(sheetName, 184, 4, 831.5),
					new ExpectedCellValue(sheetName, 185, 4, 831.5),
					new ExpectedCellValue(sheetName, 186, 4, 831.5),
					new ExpectedCellValue(sheetName, 187, 4, 831.5),
					new ExpectedCellValue(sheetName, 188, 4, null),
					new ExpectedCellValue(sheetName, 189, 4, null),
					new ExpectedCellValue(sheetName, 190, 4, null),
					new ExpectedCellValue(sheetName, 191, 4, 831.5),
					new ExpectedCellValue(sheetName, 192, 4, 831.5),
					new ExpectedCellValue(sheetName, 193, 4, 831.5),
					new ExpectedCellValue(sheetName, 194, 4, 831.5),
					new ExpectedCellValue(sheetName, 195, 4, null),
					new ExpectedCellValue(sheetName, 196, 4, null),
					new ExpectedCellValue(sheetName, 197, 4, null),
					new ExpectedCellValue(sheetName, 198, 4, 1194d),
					new ExpectedCellValue(sheetName, 199, 4, 1194d),
					new ExpectedCellValue(sheetName, 200, 4, 1194d),
					new ExpectedCellValue(sheetName, 201, 4, 1194d),
					new ExpectedCellValue(sheetName, 202, 4, null),
					new ExpectedCellValue(sheetName, 203, 4, null),
					new ExpectedCellValue(sheetName, 204, 4, null),
					new ExpectedCellValue(sheetName, 205, 4, 415.75),
					new ExpectedCellValue(sheetName, 206, 4, 415.75),
					new ExpectedCellValue(sheetName, 207, 4, 415.75),
					new ExpectedCellValue(sheetName, 208, 4, 415.75),
					new ExpectedCellValue(sheetName, 209, 4, null),
					new ExpectedCellValue(sheetName, 210, 4, null),
					new ExpectedCellValue(sheetName, 211, 4, null),
					new ExpectedCellValue(sheetName, 212, 4, 24.99),
					new ExpectedCellValue(sheetName, 213, 4, 24.99),
					new ExpectedCellValue(sheetName, 214, 4, 24.99),
					new ExpectedCellValue(sheetName, 215, 4, 24.99),
					new ExpectedCellValue(sheetName, 216, 4, null),
					new ExpectedCellValue(sheetName, 217, 4, null),
					new ExpectedCellValue(sheetName, 218, 4, null),
					new ExpectedCellValue(sheetName, 219, 4, 99d),
					new ExpectedCellValue(sheetName, 220, 4, 99d),
					new ExpectedCellValue(sheetName, 221, 4, 99d),
					new ExpectedCellValue(sheetName, 222, 4, 99d),
					new ExpectedCellValue(sheetName, 223, 4, null),
					new ExpectedCellValue(sheetName, 224, 4, null),
					new ExpectedCellValue(sheetName, 225, 4, null),
					new ExpectedCellValue(sheetName, 226, 4, 831.5),
					new ExpectedCellValue(sheetName, 227, 4, 831.5),
					new ExpectedCellValue(sheetName, 228, 4, 831.5),
					new ExpectedCellValue(sheetName, 229, 4, 831.5),
					new ExpectedCellValue(sheetName, 230, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F180:I209"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 180, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 181, 6, 20100007),
					new ExpectedCellValue(sheetName, 182, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 183, 6, null),
					new ExpectedCellValue(sheetName, 184, 6, null),
					new ExpectedCellValue(sheetName, 185, 6, 20100017),
					new ExpectedCellValue(sheetName, 186, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 187, 6, null),
					new ExpectedCellValue(sheetName, 188, 6, null),
					new ExpectedCellValue(sheetName, 189, 6, 20100070),
					new ExpectedCellValue(sheetName, 190, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 191, 6, null),
					new ExpectedCellValue(sheetName, 192, 6, null),
					new ExpectedCellValue(sheetName, 193, 6, 20100076),
					new ExpectedCellValue(sheetName, 194, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 195, 6, null),
					new ExpectedCellValue(sheetName, 196, 6, null),
					new ExpectedCellValue(sheetName, 197, 6, 20100083),
					new ExpectedCellValue(sheetName, 198, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 199, 6, null),
					new ExpectedCellValue(sheetName, 200, 6, null),
					new ExpectedCellValue(sheetName, 201, 6, 20100085),
					new ExpectedCellValue(sheetName, 202, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 203, 6, null),
					new ExpectedCellValue(sheetName, 204, 6, null),
					new ExpectedCellValue(sheetName, 205, 6, 20100090),
					new ExpectedCellValue(sheetName, 206, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 207, 6, null),
					new ExpectedCellValue(sheetName, 208, 6, null),
					new ExpectedCellValue(sheetName, 209, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 180, 7, "Month"),
					new ExpectedCellValue(sheetName, 181, 7, null),
					new ExpectedCellValue(sheetName, 182, 7, null),
					new ExpectedCellValue(sheetName, 183, 7, "January"),
					new ExpectedCellValue(sheetName, 184, 7, null),
					new ExpectedCellValue(sheetName, 185, 7, null),
					new ExpectedCellValue(sheetName, 186, 7, null),
					new ExpectedCellValue(sheetName, 187, 7, "March"),
					new ExpectedCellValue(sheetName, 188, 7, null),
					new ExpectedCellValue(sheetName, 189, 7, null),
					new ExpectedCellValue(sheetName, 190, 7, null),
					new ExpectedCellValue(sheetName, 191, 7, "February"),
					new ExpectedCellValue(sheetName, 192, 7, null),
					new ExpectedCellValue(sheetName, 193, 7, null),
					new ExpectedCellValue(sheetName, 194, 7, null),
					new ExpectedCellValue(sheetName, 195, 7, "January"),
					new ExpectedCellValue(sheetName, 196, 7, null),
					new ExpectedCellValue(sheetName, 197, 7, null),
					new ExpectedCellValue(sheetName, 198, 7, null),
					new ExpectedCellValue(sheetName, 199, 7, "March"),
					new ExpectedCellValue(sheetName, 200, 7, null),
					new ExpectedCellValue(sheetName, 201, 7, null),
					new ExpectedCellValue(sheetName, 202, 7, null),
					new ExpectedCellValue(sheetName, 203, 7, "February"),
					new ExpectedCellValue(sheetName, 204, 7, null),
					new ExpectedCellValue(sheetName, 205, 7, null),
					new ExpectedCellValue(sheetName, 206, 7, null),
					new ExpectedCellValue(sheetName, 207, 7, "January"),
					new ExpectedCellValue(sheetName, 208, 7, null),
					new ExpectedCellValue(sheetName, 209, 7, null),
					new ExpectedCellValue(sheetName, 180, 8, "Item"),
					new ExpectedCellValue(sheetName, 181, 8, null),
					new ExpectedCellValue(sheetName, 182, 8, null),
					new ExpectedCellValue(sheetName, 183, 8, null),
					new ExpectedCellValue(sheetName, 184, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 8, null),
					new ExpectedCellValue(sheetName, 186, 8, null),
					new ExpectedCellValue(sheetName, 187, 8, null),
					new ExpectedCellValue(sheetName, 188, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 189, 8, null),
					new ExpectedCellValue(sheetName, 190, 8, null),
					new ExpectedCellValue(sheetName, 191, 8, null),
					new ExpectedCellValue(sheetName, 192, 8, "Tent"),
					new ExpectedCellValue(sheetName, 193, 8, null),
					new ExpectedCellValue(sheetName, 194, 8, null),
					new ExpectedCellValue(sheetName, 195, 8, null),
					new ExpectedCellValue(sheetName, 196, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 8, null),
					new ExpectedCellValue(sheetName, 198, 8, null),
					new ExpectedCellValue(sheetName, 199, 8, null),
					new ExpectedCellValue(sheetName, 200, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 201, 8, null),
					new ExpectedCellValue(sheetName, 202, 8, null),
					new ExpectedCellValue(sheetName, 203, 8, null),
					new ExpectedCellValue(sheetName, 204, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 205, 8, null),
					new ExpectedCellValue(sheetName, 206, 8, null),
					new ExpectedCellValue(sheetName, 207, 8, null),
					new ExpectedCellValue(sheetName, 208, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 209, 8, null),
					new ExpectedCellValue(sheetName, 180, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 181, 9, 831.5),
					new ExpectedCellValue(sheetName, 182, 9, 831.5),
					new ExpectedCellValue(sheetName, 183, 9, 831.5),
					new ExpectedCellValue(sheetName, 184, 9, 831.5),
					new ExpectedCellValue(sheetName, 185, 9, 831.5),
					new ExpectedCellValue(sheetName, 186, 9, 831.5),
					new ExpectedCellValue(sheetName, 187, 9, 831.5),
					new ExpectedCellValue(sheetName, 188, 9, 831.5),
					new ExpectedCellValue(sheetName, 189, 9, 1194d),
					new ExpectedCellValue(sheetName, 190, 9, 1194d),
					new ExpectedCellValue(sheetName, 191, 9, 1194d),
					new ExpectedCellValue(sheetName, 192, 9, 1194d),
					new ExpectedCellValue(sheetName, 193, 9, 415.75),
					new ExpectedCellValue(sheetName, 194, 9, 415.75),
					new ExpectedCellValue(sheetName, 195, 9, 415.75),
					new ExpectedCellValue(sheetName, 196, 9, 415.75),
					new ExpectedCellValue(sheetName, 197, 9, 24.99),
					new ExpectedCellValue(sheetName, 198, 9, 24.99),
					new ExpectedCellValue(sheetName, 199, 9, 24.99),
					new ExpectedCellValue(sheetName, 200, 9, 24.99),
					new ExpectedCellValue(sheetName, 201, 9, 99d),
					new ExpectedCellValue(sheetName, 202, 9, 99d),
					new ExpectedCellValue(sheetName, 203, 9, 99d),
					new ExpectedCellValue(sheetName, 204, 9, 99d),
					new ExpectedCellValue(sheetName, 205, 9, 831.5),
					new ExpectedCellValue(sheetName, 206, 9, 831.5),
					new ExpectedCellValue(sheetName, 207, 9, 831.5),
					new ExpectedCellValue(sheetName, 208, 9, 831.5),
					new ExpectedCellValue(sheetName, 209, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactForm.xlsx")]
		public void PivotTableCompactFormFourRowFieldsSecondThirdAndLastFieldsCompactFormFalseSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F180:I230"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 180, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 181, 6, 20100007),
					new ExpectedCellValue(sheetName, 182, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 183, 6, null),
					new ExpectedCellValue(sheetName, 184, 6, null),
					new ExpectedCellValue(sheetName, 185, 6, null),
					new ExpectedCellValue(sheetName, 186, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 187, 6, "20100007 Total"),
					new ExpectedCellValue(sheetName, 188, 6, 20100017),
					new ExpectedCellValue(sheetName, 189, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 190, 6, null),
					new ExpectedCellValue(sheetName, 191, 6, null),
					new ExpectedCellValue(sheetName, 192, 6, null),
					new ExpectedCellValue(sheetName, 193, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 194, 6, "20100017 Total"),
					new ExpectedCellValue(sheetName, 195, 6, 20100070),
					new ExpectedCellValue(sheetName, 196, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 197, 6, null),
					new ExpectedCellValue(sheetName, 198, 6, null),
					new ExpectedCellValue(sheetName, 199, 6, null),
					new ExpectedCellValue(sheetName, 200, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 201, 6, "20100070 Total"),
					new ExpectedCellValue(sheetName, 202, 6, 20100076),
					new ExpectedCellValue(sheetName, 203, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 204, 6, null),
					new ExpectedCellValue(sheetName, 205, 6, null),
					new ExpectedCellValue(sheetName, 206, 6, null),
					new ExpectedCellValue(sheetName, 207, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 208, 6, "20100076 Total"),
					new ExpectedCellValue(sheetName, 209, 6, 20100083),
					new ExpectedCellValue(sheetName, 210, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 211, 6, null),
					new ExpectedCellValue(sheetName, 212, 6, null),
					new ExpectedCellValue(sheetName, 213, 6, null),
					new ExpectedCellValue(sheetName, 214, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 215, 6, "20100083 Total"),
					new ExpectedCellValue(sheetName, 216, 6, 20100085),
					new ExpectedCellValue(sheetName, 217, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 218, 6, null),
					new ExpectedCellValue(sheetName, 219, 6, null),
					new ExpectedCellValue(sheetName, 220, 6, null),
					new ExpectedCellValue(sheetName, 221, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 222, 6, "20100085 Total"),
					new ExpectedCellValue(sheetName, 223, 6, 20100090),
					new ExpectedCellValue(sheetName, 224, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 225, 6, null),
					new ExpectedCellValue(sheetName, 226, 6, null),
					new ExpectedCellValue(sheetName, 227, 6, null),
					new ExpectedCellValue(sheetName, 228, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 229, 6, "20100090 Total"),
					new ExpectedCellValue(sheetName, 230, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 180, 7, "Month"),
					new ExpectedCellValue(sheetName, 181, 7, null),
					new ExpectedCellValue(sheetName, 182, 7, null),
					new ExpectedCellValue(sheetName, 183, 7, "January"),
					new ExpectedCellValue(sheetName, 184, 7, null),
					new ExpectedCellValue(sheetName, 185, 7, "January Total"),
					new ExpectedCellValue(sheetName, 186, 7, null),
					new ExpectedCellValue(sheetName, 187, 7, null),
					new ExpectedCellValue(sheetName, 188, 7, null),
					new ExpectedCellValue(sheetName, 189, 7, null),
					new ExpectedCellValue(sheetName, 190, 7, "March"),
					new ExpectedCellValue(sheetName, 191, 7, null),
					new ExpectedCellValue(sheetName, 192, 7, "March Total"),
					new ExpectedCellValue(sheetName, 193, 7, null),
					new ExpectedCellValue(sheetName, 194, 7, null),
					new ExpectedCellValue(sheetName, 195, 7, null),
					new ExpectedCellValue(sheetName, 196, 7, null),
					new ExpectedCellValue(sheetName, 197, 7, "February"),
					new ExpectedCellValue(sheetName, 198, 7, null),
					new ExpectedCellValue(sheetName, 199, 7, "February Total"),
					new ExpectedCellValue(sheetName, 200, 7, null),
					new ExpectedCellValue(sheetName, 201, 7, null),
					new ExpectedCellValue(sheetName, 202, 7, null),
					new ExpectedCellValue(sheetName, 203, 7, null),
					new ExpectedCellValue(sheetName, 204, 7, "January"),
					new ExpectedCellValue(sheetName, 205, 7, null),
					new ExpectedCellValue(sheetName, 206, 7, "January Total"),
					new ExpectedCellValue(sheetName, 207, 7, null),
					new ExpectedCellValue(sheetName, 208, 7, null),
					new ExpectedCellValue(sheetName, 209, 7, null),
					new ExpectedCellValue(sheetName, 210, 7, null),
					new ExpectedCellValue(sheetName, 211, 7, "March"),
					new ExpectedCellValue(sheetName, 212, 7, null),
					new ExpectedCellValue(sheetName, 213, 7, "March Total"),
					new ExpectedCellValue(sheetName, 214, 7, null),
					new ExpectedCellValue(sheetName, 215, 7, null),
					new ExpectedCellValue(sheetName, 216, 7, null),
					new ExpectedCellValue(sheetName, 217, 7, null),
					new ExpectedCellValue(sheetName, 218, 7, "February"),
					new ExpectedCellValue(sheetName, 219, 7, null),
					new ExpectedCellValue(sheetName, 220, 7, "February Total"),
					new ExpectedCellValue(sheetName, 221, 7, null),
					new ExpectedCellValue(sheetName, 222, 7, null),
					new ExpectedCellValue(sheetName, 223, 7, null),
					new ExpectedCellValue(sheetName, 224, 7, null),
					new ExpectedCellValue(sheetName, 225, 7, "January"),
					new ExpectedCellValue(sheetName, 226, 7, null),
					new ExpectedCellValue(sheetName, 227, 7, "January Total"),
					new ExpectedCellValue(sheetName, 228, 7, null),
					new ExpectedCellValue(sheetName, 229, 7, null),
					new ExpectedCellValue(sheetName, 230, 7, null),
					new ExpectedCellValue(sheetName, 180, 8, "Item"),
					new ExpectedCellValue(sheetName, 181, 8, null),
					new ExpectedCellValue(sheetName, 182, 8, null),
					new ExpectedCellValue(sheetName, 183, 8, null),
					new ExpectedCellValue(sheetName, 184, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 8, null),
					new ExpectedCellValue(sheetName, 186, 8, null),
					new ExpectedCellValue(sheetName, 187, 8, null),
					new ExpectedCellValue(sheetName, 188, 8, null),
					new ExpectedCellValue(sheetName, 189, 8, null),
					new ExpectedCellValue(sheetName, 190, 8, null),
					new ExpectedCellValue(sheetName, 191, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 8, null),
					new ExpectedCellValue(sheetName, 193, 8, null),
					new ExpectedCellValue(sheetName, 194, 8, null),
					new ExpectedCellValue(sheetName, 195, 8, null),
					new ExpectedCellValue(sheetName, 196, 8, null),
					new ExpectedCellValue(sheetName, 197, 8, null),
					new ExpectedCellValue(sheetName, 198, 8, "Tent"),
					new ExpectedCellValue(sheetName, 199, 8, null),
					new ExpectedCellValue(sheetName, 200, 8, null),
					new ExpectedCellValue(sheetName, 201, 8, null),
					new ExpectedCellValue(sheetName, 202, 8, null),
					new ExpectedCellValue(sheetName, 203, 8, null),
					new ExpectedCellValue(sheetName, 204, 8, null),
					new ExpectedCellValue(sheetName, 205, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 206, 8, null),
					new ExpectedCellValue(sheetName, 207, 8, null),
					new ExpectedCellValue(sheetName, 208, 8, null),
					new ExpectedCellValue(sheetName, 209, 8, null),
					new ExpectedCellValue(sheetName, 210, 8, null),
					new ExpectedCellValue(sheetName, 211, 8, null),
					new ExpectedCellValue(sheetName, 212, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 213, 8, null),
					new ExpectedCellValue(sheetName, 214, 8, null),
					new ExpectedCellValue(sheetName, 215, 8, null),
					new ExpectedCellValue(sheetName, 216, 8, null),
					new ExpectedCellValue(sheetName, 217, 8, null),
					new ExpectedCellValue(sheetName, 218, 8, null),
					new ExpectedCellValue(sheetName, 219, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 220, 8, null),
					new ExpectedCellValue(sheetName, 221, 8, null),
					new ExpectedCellValue(sheetName, 222, 8, null),
					new ExpectedCellValue(sheetName, 223, 8, null),
					new ExpectedCellValue(sheetName, 224, 8, null),
					new ExpectedCellValue(sheetName, 225, 8, null),
					new ExpectedCellValue(sheetName, 226, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 227, 8, null),
					new ExpectedCellValue(sheetName, 228, 8, null),
					new ExpectedCellValue(sheetName, 229, 8, null),
					new ExpectedCellValue(sheetName, 230, 8, null),
					new ExpectedCellValue(sheetName, 180, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 181, 9, null),
					new ExpectedCellValue(sheetName, 182, 9, null),
					new ExpectedCellValue(sheetName, 183, 9, null),
					new ExpectedCellValue(sheetName, 184, 9, 831.5),
					new ExpectedCellValue(sheetName, 185, 9, 831.5),
					new ExpectedCellValue(sheetName, 186, 9, 831.5),
					new ExpectedCellValue(sheetName, 187, 9, 831.5),
					new ExpectedCellValue(sheetName, 188, 9, null),
					new ExpectedCellValue(sheetName, 189, 9, null),
					new ExpectedCellValue(sheetName, 190, 9, null),
					new ExpectedCellValue(sheetName, 191, 9, 831.5),
					new ExpectedCellValue(sheetName, 192, 9, 831.5),
					new ExpectedCellValue(sheetName, 193, 9, 831.5),
					new ExpectedCellValue(sheetName, 194, 9, 831.5),
					new ExpectedCellValue(sheetName, 195, 9, null),
					new ExpectedCellValue(sheetName, 196, 9, null),
					new ExpectedCellValue(sheetName, 197, 9, null),
					new ExpectedCellValue(sheetName, 198, 9, 1194d),
					new ExpectedCellValue(sheetName, 199, 9, 1194d),
					new ExpectedCellValue(sheetName, 200, 9, 1194d),
					new ExpectedCellValue(sheetName, 201, 9, 1194d),
					new ExpectedCellValue(sheetName, 202, 9, null),
					new ExpectedCellValue(sheetName, 203, 9, null),
					new ExpectedCellValue(sheetName, 204, 9, null),
					new ExpectedCellValue(sheetName, 205, 9, 415.75),
					new ExpectedCellValue(sheetName, 206, 9, 415.75),
					new ExpectedCellValue(sheetName, 207, 9, 415.75),
					new ExpectedCellValue(sheetName, 208, 9, 415.75),
					new ExpectedCellValue(sheetName, 209, 9, null),
					new ExpectedCellValue(sheetName, 210, 9, null),
					new ExpectedCellValue(sheetName, 211, 9, null),
					new ExpectedCellValue(sheetName, 212, 9, 24.99),
					new ExpectedCellValue(sheetName, 213, 9, 24.99),
					new ExpectedCellValue(sheetName, 214, 9, 24.99),
					new ExpectedCellValue(sheetName, 215, 9, 24.99),
					new ExpectedCellValue(sheetName, 216, 9, null),
					new ExpectedCellValue(sheetName, 217, 9, null),
					new ExpectedCellValue(sheetName, 218, 9, null),
					new ExpectedCellValue(sheetName, 219, 9, 99d),
					new ExpectedCellValue(sheetName, 220, 9, 99d),
					new ExpectedCellValue(sheetName, 221, 9, 99d),
					new ExpectedCellValue(sheetName, 222, 9, 99d),
					new ExpectedCellValue(sheetName, 223, 9, null),
					new ExpectedCellValue(sheetName, 224, 9, null),
					new ExpectedCellValue(sheetName, 225, 9, null),
					new ExpectedCellValue(sheetName, 226, 9, 831.5),
					new ExpectedCellValue(sheetName, 227, 9, 831.5),
					new ExpectedCellValue(sheetName, 228, 9, 831.5),
					new ExpectedCellValue(sheetName, 229, 9, 831.5),
					new ExpectedCellValue(sheetName, 230, 9, 4228.24)
				});
			}
		}

		// One Row Field Multiple Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormOneRowFieldMultipleRowDataFieldsLeafDataFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "OneRowField";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:C13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 2, "Values"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, null),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, 856.49),
					new ExpectedCellValue(sheetName, 5, 3, 3d),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, 2857d),
					new ExpectedCellValue(sheetName, 8, 3, 10d),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, 514.75),
					new ExpectedCellValue(sheetName, 11, 3, 2d),
					new ExpectedCellValue(sheetName, 12, 3, 4228.24),
					new ExpectedCellValue(sheetName, 13, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormOneRowFieldMultipleRowDataFieldsRootDataFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "OneRowField";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E2:F12"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 4, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 11, 5, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 5, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 6, null),
					new ExpectedCellValue(sheetName, 3, 6, null),
					new ExpectedCellValue(sheetName, 4, 6, 856.49),
					new ExpectedCellValue(sheetName, 5, 6, 2857d),
					new ExpectedCellValue(sheetName, 6, 6, 514.75),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, 3d),
					new ExpectedCellValue(sheetName, 9, 6, 10d),
					new ExpectedCellValue(sheetName, 10, 6, 2d),
					new ExpectedCellValue(sheetName, 11, 6, 4228.24),
					new ExpectedCellValue(sheetName, 12, 6, 15d)
				});
			}
		}

		// Two Row Fields Multiple Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsLeafDataFieldBothFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:D34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, null),
					new ExpectedCellValue(sheetName, 16, 1, null),
					new ExpectedCellValue(sheetName, 17, 1, null),
					new ExpectedCellValue(sheetName, 18, 1, null),
					new ExpectedCellValue(sheetName, 19, 1, null),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, null),
					new ExpectedCellValue(sheetName, 22, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 1, null),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, null),
					new ExpectedCellValue(sheetName, 28, 1, null),
					new ExpectedCellValue(sheetName, 29, 1, null),
					new ExpectedCellValue(sheetName, 30, 1, null),
					new ExpectedCellValue(sheetName, 31, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "March"),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, "January"),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, "February"),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, "March"),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, "January"),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, "February"),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Values"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 27, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, null),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, 2d),
					new ExpectedCellValue(sheetName, 6, 4, 831.5),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, 1d),
					new ExpectedCellValue(sheetName, 9, 4, 24.99),
					new ExpectedCellValue(sheetName, 10, 4, 3d),
					new ExpectedCellValue(sheetName, 11, 4, 856.49),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, 2d),
					new ExpectedCellValue(sheetName, 15, 4, 831.5),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, 6d),
					new ExpectedCellValue(sheetName, 18, 4, 1194d),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, 2d),
					new ExpectedCellValue(sheetName, 21, 4, 831.5),
					new ExpectedCellValue(sheetName, 22, 4, 10d),
					new ExpectedCellValue(sheetName, 23, 4, 2857d),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, 1d),
					new ExpectedCellValue(sheetName, 27, 4, 415.75),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, 1d),
					new ExpectedCellValue(sheetName, 30, 4, 99d),
					new ExpectedCellValue(sheetName, 31, 4, 2d),
					new ExpectedCellValue(sheetName, 32, 4, 514.75),
					new ExpectedCellValue(sheetName, 33, 4, 15d),
					new ExpectedCellValue(sheetName, 34, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsLeafDataFieldFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:H34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 6, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 6, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 6, null),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 32, 6, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 6, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 7, "Month"),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, "January"),
					new ExpectedCellValue(sheetName, 5, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 6, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 7, "March"),
					new ExpectedCellValue(sheetName, 8, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, "January"),
					new ExpectedCellValue(sheetName, 14, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 7, "February"),
					new ExpectedCellValue(sheetName, 17, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 7, "March"),
					new ExpectedCellValue(sheetName, 20, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, "January"),
					new ExpectedCellValue(sheetName, 26, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 27, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 7, "February"),
					new ExpectedCellValue(sheetName, 29, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 2, 8, null),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, 2d),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, 1d),
					new ExpectedCellValue(sheetName, 9, 8, 24.99),
					new ExpectedCellValue(sheetName, 10, 8, 3d),
					new ExpectedCellValue(sheetName, 11, 8, 856.49),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, 2d),
					new ExpectedCellValue(sheetName, 15, 8, 831.5),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, 6d),
					new ExpectedCellValue(sheetName, 18, 8, 1194d),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, 2d),
					new ExpectedCellValue(sheetName, 21, 8, 831.5),
					new ExpectedCellValue(sheetName, 22, 8, 10d),
					new ExpectedCellValue(sheetName, 23, 8, 2857d),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, 1d),
					new ExpectedCellValue(sheetName, 27, 8, 415.75),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, 1d),
					new ExpectedCellValue(sheetName, 30, 8, 99d),
					new ExpectedCellValue(sheetName, 31, 8, 2d),
					new ExpectedCellValue(sheetName, 32, 8, 514.75),
					new ExpectedCellValue(sheetName, 33, 8, 15d),
					new ExpectedCellValue(sheetName, 34, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsInnerDataFieldFirstAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A41:C72"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 1, null),
					new ExpectedCellValue(sheetName, 44, 1, null),
					new ExpectedCellValue(sheetName, 45, 1, null),
					new ExpectedCellValue(sheetName, 46, 1, null),
					new ExpectedCellValue(sheetName, 47, 1, null),
					new ExpectedCellValue(sheetName, 48, 1, null),
					new ExpectedCellValue(sheetName, 49, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 52, 1, null),
					new ExpectedCellValue(sheetName, 53, 1, null),
					new ExpectedCellValue(sheetName, 54, 1, null),
					new ExpectedCellValue(sheetName, 55, 1, null),
					new ExpectedCellValue(sheetName, 56, 1, null),
					new ExpectedCellValue(sheetName, 57, 1, null),
					new ExpectedCellValue(sheetName, 58, 1, null),
					new ExpectedCellValue(sheetName, 59, 1, null),
					new ExpectedCellValue(sheetName, 60, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 61, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 1, null),
					new ExpectedCellValue(sheetName, 64, 1, null),
					new ExpectedCellValue(sheetName, 65, 1, null),
					new ExpectedCellValue(sheetName, 66, 1, null),
					new ExpectedCellValue(sheetName, 67, 1, null),
					new ExpectedCellValue(sheetName, 68, 1, null),
					new ExpectedCellValue(sheetName, 69, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 70, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 72, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 2, "Values"),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 44, 2, "January"),
					new ExpectedCellValue(sheetName, 45, 2, "March"),
					new ExpectedCellValue(sheetName, 46, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 2, "January"),
					new ExpectedCellValue(sheetName, 48, 2, "March"),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, null),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 53, 2, "January"),
					new ExpectedCellValue(sheetName, 54, 2, "February"),
					new ExpectedCellValue(sheetName, 55, 2, "March"),
					new ExpectedCellValue(sheetName, 56, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 2, "January"),
					new ExpectedCellValue(sheetName, 58, 2, "February"),
					new ExpectedCellValue(sheetName, 59, 2, "March"),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 2, "January"),
					new ExpectedCellValue(sheetName, 65, 2, "February"),
					new ExpectedCellValue(sheetName, 66, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 67, 2, "January"),
					new ExpectedCellValue(sheetName, 68, 2, "February"),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, null),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, 2d),
					new ExpectedCellValue(sheetName, 45, 3, 1d),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, 831.5),
					new ExpectedCellValue(sheetName, 48, 3, 24.99),
					new ExpectedCellValue(sheetName, 49, 3, 3d),
					new ExpectedCellValue(sheetName, 50, 3, 856.49),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, 2d),
					new ExpectedCellValue(sheetName, 54, 3, 6d),
					new ExpectedCellValue(sheetName, 55, 3, 2d),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, 831.5),
					new ExpectedCellValue(sheetName, 58, 3, 1194d),
					new ExpectedCellValue(sheetName, 59, 3, 831.5),
					new ExpectedCellValue(sheetName, 60, 3, 10d),
					new ExpectedCellValue(sheetName, 61, 3, 2857d),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, 1d),
					new ExpectedCellValue(sheetName, 65, 3, 1d),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, 415.75),
					new ExpectedCellValue(sheetName, 68, 3, 99d),
					new ExpectedCellValue(sheetName, 69, 3, 2d),
					new ExpectedCellValue(sheetName, 70, 3, 514.75),
					new ExpectedCellValue(sheetName, 71, 3, 15d),
					new ExpectedCellValue(sheetName, 72, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsInnerDataFieldFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F41:H72"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, null),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, null),
					new ExpectedCellValue(sheetName, 47, 6, null),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 6, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, null),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, null),
					new ExpectedCellValue(sheetName, 60, 6, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 61, 6, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, null),
					new ExpectedCellValue(sheetName, 68, 6, null),
					new ExpectedCellValue(sheetName, 69, 6, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 70, 6, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 72, 6, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 7, "Values"),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 44, 7, "January"),
					new ExpectedCellValue(sheetName, 45, 7, "March"),
					new ExpectedCellValue(sheetName, 46, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 7, "January"),
					new ExpectedCellValue(sheetName, 48, 7, "March"),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, null),
					new ExpectedCellValue(sheetName, 52, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 53, 7, "January"),
					new ExpectedCellValue(sheetName, 54, 7, "February"),
					new ExpectedCellValue(sheetName, 55, 7, "March"),
					new ExpectedCellValue(sheetName, 56, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 7, "January"),
					new ExpectedCellValue(sheetName, 58, 7, "February"),
					new ExpectedCellValue(sheetName, 59, 7, "March"),
					new ExpectedCellValue(sheetName, 60, 7, null),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 64, 7, "January"),
					new ExpectedCellValue(sheetName, 65, 7, "February"),
					new ExpectedCellValue(sheetName, 66, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 67, 7, "January"),
					new ExpectedCellValue(sheetName, 68, 7, "February"),
					new ExpectedCellValue(sheetName, 69, 7, null),
					new ExpectedCellValue(sheetName, 70, 7, null),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, null),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, 2d),
					new ExpectedCellValue(sheetName, 45, 8, 1d),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, 831.5),
					new ExpectedCellValue(sheetName, 48, 8, 24.99),
					new ExpectedCellValue(sheetName, 49, 8, 3d),
					new ExpectedCellValue(sheetName, 50, 8, 856.49),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, 2d),
					new ExpectedCellValue(sheetName, 54, 8, 6d),
					new ExpectedCellValue(sheetName, 55, 8, 2d),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, 831.5),
					new ExpectedCellValue(sheetName, 58, 8, 1194d),
					new ExpectedCellValue(sheetName, 59, 8, 831.5),
					new ExpectedCellValue(sheetName, 60, 8, 10d),
					new ExpectedCellValue(sheetName, 61, 8, 2857d),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, 1d),
					new ExpectedCellValue(sheetName, 65, 8, 1d),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, 415.75),
					new ExpectedCellValue(sheetName, 68, 8, 99d),
					new ExpectedCellValue(sheetName, 69, 8, 2d),
					new ExpectedCellValue(sheetName, 70, 8, 514.75),
					new ExpectedCellValue(sheetName, 71, 8, 15d),
					new ExpectedCellValue(sheetName, 72, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsLeafDataFieldSecondFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A77:C109"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 77, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 78, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 1, "January"),
					new ExpectedCellValue(sheetName, 80, 1, null),
					new ExpectedCellValue(sheetName, 81, 1, null),
					new ExpectedCellValue(sheetName, 82, 1, "March"),
					new ExpectedCellValue(sheetName, 83, 1, null),
					new ExpectedCellValue(sheetName, 84, 1, null),
					new ExpectedCellValue(sheetName, 85, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 86, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 87, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 88, 1, "January"),
					new ExpectedCellValue(sheetName, 89, 1, null),
					new ExpectedCellValue(sheetName, 90, 1, null),
					new ExpectedCellValue(sheetName, 91, 1, "February"),
					new ExpectedCellValue(sheetName, 92, 1, null),
					new ExpectedCellValue(sheetName, 93, 1, null),
					new ExpectedCellValue(sheetName, 94, 1, "March"),
					new ExpectedCellValue(sheetName, 95, 1, null),
					new ExpectedCellValue(sheetName, 96, 1, null),
					new ExpectedCellValue(sheetName, 97, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 98, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 1, "January"),
					new ExpectedCellValue(sheetName, 101, 1, null),
					new ExpectedCellValue(sheetName, 102, 1, null),
					new ExpectedCellValue(sheetName, 103, 1, "February"),
					new ExpectedCellValue(sheetName, 104, 1, null),
					new ExpectedCellValue(sheetName, 105, 1, null),
					new ExpectedCellValue(sheetName, 106, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 107, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 109, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 2, "Values"),
					new ExpectedCellValue(sheetName, 78, 2, null),
					new ExpectedCellValue(sheetName, 79, 2, null),
					new ExpectedCellValue(sheetName, 80, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 81, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 82, 2, null),
					new ExpectedCellValue(sheetName, 83, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 84, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, null),
					new ExpectedCellValue(sheetName, 87, 2, null),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 90, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 91, 2, null),
					new ExpectedCellValue(sheetName, 92, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 93, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 94, 2, null),
					new ExpectedCellValue(sheetName, 95, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 96, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 2, null),
					new ExpectedCellValue(sheetName, 98, 2, null),
					new ExpectedCellValue(sheetName, 99, 2, null),
					new ExpectedCellValue(sheetName, 100, 2, null),
					new ExpectedCellValue(sheetName, 101, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 102, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 2, null),
					new ExpectedCellValue(sheetName, 104, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 105, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 2, null),
					new ExpectedCellValue(sheetName, 107, 2, null),
					new ExpectedCellValue(sheetName, 108, 2, null),
					new ExpectedCellValue(sheetName, 109, 2, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, 2d),
					new ExpectedCellValue(sheetName, 81, 3, 831.5),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, 1d),
					new ExpectedCellValue(sheetName, 84, 3, 24.99),
					new ExpectedCellValue(sheetName, 85, 3, 3d),
					new ExpectedCellValue(sheetName, 86, 3, 856.49),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, null),
					new ExpectedCellValue(sheetName, 89, 3, 2d),
					new ExpectedCellValue(sheetName, 90, 3, 831.5),
					new ExpectedCellValue(sheetName, 91, 3, null),
					new ExpectedCellValue(sheetName, 92, 3, 6d),
					new ExpectedCellValue(sheetName, 93, 3, 1194d),
					new ExpectedCellValue(sheetName, 94, 3, null),
					new ExpectedCellValue(sheetName, 95, 3, 2d),
					new ExpectedCellValue(sheetName, 96, 3, 831.5),
					new ExpectedCellValue(sheetName, 97, 3, 10d),
					new ExpectedCellValue(sheetName, 98, 3, 2857d),
					new ExpectedCellValue(sheetName, 99, 3, null),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 101, 3, 1d),
					new ExpectedCellValue(sheetName, 102, 3, 415.75),
					new ExpectedCellValue(sheetName, 103, 3, null),
					new ExpectedCellValue(sheetName, 104, 3, 1d),
					new ExpectedCellValue(sheetName, 105, 3, 99d),
					new ExpectedCellValue(sheetName, 106, 3, 2d),
					new ExpectedCellValue(sheetName, 107, 3, 514.75),
					new ExpectedCellValue(sheetName, 108, 3, 15d),
					new ExpectedCellValue(sheetName, 109, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsInnerDataFieldLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F77:G108"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 77, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 78, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 80, 6, "January"),
					new ExpectedCellValue(sheetName, 81, 6, "March"),
					new ExpectedCellValue(sheetName, 82, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 6, "January"),
					new ExpectedCellValue(sheetName, 84, 6, "March"),
					new ExpectedCellValue(sheetName, 85, 6, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 86, 6, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 87, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 88, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 89, 6, "January"),
					new ExpectedCellValue(sheetName, 90, 6, "February"),
					new ExpectedCellValue(sheetName, 91, 6, "March"),
					new ExpectedCellValue(sheetName, 92, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 93, 6, "January"),
					new ExpectedCellValue(sheetName, 94, 6, "February"),
					new ExpectedCellValue(sheetName, 95, 6, "March"),
					new ExpectedCellValue(sheetName, 96, 6, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 97, 6, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 98, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 99, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 100, 6, "January"),
					new ExpectedCellValue(sheetName, 101, 6, "February"),
					new ExpectedCellValue(sheetName, 102, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 6, "January"),
					new ExpectedCellValue(sheetName, 104, 6, "February"),
					new ExpectedCellValue(sheetName, 105, 6, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 106, 6, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 107, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 108, 6, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, null),
					new ExpectedCellValue(sheetName, 79, 7, null),
					new ExpectedCellValue(sheetName, 80, 7, 2d),
					new ExpectedCellValue(sheetName, 81, 7, 1d),
					new ExpectedCellValue(sheetName, 82, 7, null),
					new ExpectedCellValue(sheetName, 83, 7, 831.5),
					new ExpectedCellValue(sheetName, 84, 7, 24.99),
					new ExpectedCellValue(sheetName, 85, 7, 3d),
					new ExpectedCellValue(sheetName, 86, 7, 856.49),
					new ExpectedCellValue(sheetName, 87, 7, null),
					new ExpectedCellValue(sheetName, 88, 7, null),
					new ExpectedCellValue(sheetName, 89, 7, 2d),
					new ExpectedCellValue(sheetName, 90, 7, 6d),
					new ExpectedCellValue(sheetName, 91, 7, 2d),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, 831.5),
					new ExpectedCellValue(sheetName, 94, 7, 1194d),
					new ExpectedCellValue(sheetName, 95, 7, 831.5),
					new ExpectedCellValue(sheetName, 96, 7, 10d),
					new ExpectedCellValue(sheetName, 97, 7, 2857d),
					new ExpectedCellValue(sheetName, 98, 7, null),
					new ExpectedCellValue(sheetName, 99, 7, null),
					new ExpectedCellValue(sheetName, 100, 7, 1d),
					new ExpectedCellValue(sheetName, 101, 7, 1d),
					new ExpectedCellValue(sheetName, 102, 7, null),
					new ExpectedCellValue(sheetName, 103, 7, 415.75),
					new ExpectedCellValue(sheetName, 104, 7, 99d),
					new ExpectedCellValue(sheetName, 105, 7, 2d),
					new ExpectedCellValue(sheetName, 106, 7, 514.75),
					new ExpectedCellValue(sheetName, 107, 7, 15d),
					new ExpectedCellValue(sheetName, 108, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsFirstDataFieldSecondAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A114:C138"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 114, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 115, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 116, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 117, 1, null),
					new ExpectedCellValue(sheetName, 118, 1, null),
					new ExpectedCellValue(sheetName, 119, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 120, 1, null),
					new ExpectedCellValue(sheetName, 121, 1, null),
					new ExpectedCellValue(sheetName, 122, 1, null),
					new ExpectedCellValue(sheetName, 123, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 124, 1, null),
					new ExpectedCellValue(sheetName, 125, 1, null),
					new ExpectedCellValue(sheetName, 126, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 127, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 128, 1, null),
					new ExpectedCellValue(sheetName, 129, 1, null),
					new ExpectedCellValue(sheetName, 130, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 131, 1, null),
					new ExpectedCellValue(sheetName, 132, 1, null),
					new ExpectedCellValue(sheetName, 133, 1, null),
					new ExpectedCellValue(sheetName, 134, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 1, null),
					new ExpectedCellValue(sheetName, 136, 1, null),
					new ExpectedCellValue(sheetName, 137, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 138, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 2, "Month"),
					new ExpectedCellValue(sheetName, 115, 2, null),
					new ExpectedCellValue(sheetName, 116, 2, null),
					new ExpectedCellValue(sheetName, 117, 2, "January"),
					new ExpectedCellValue(sheetName, 118, 2, "March"),
					new ExpectedCellValue(sheetName, 119, 2, null),
					new ExpectedCellValue(sheetName, 120, 2, "January"),
					new ExpectedCellValue(sheetName, 121, 2, "February"),
					new ExpectedCellValue(sheetName, 122, 2, "March"),
					new ExpectedCellValue(sheetName, 123, 2, null),
					new ExpectedCellValue(sheetName, 124, 2, "January"),
					new ExpectedCellValue(sheetName, 125, 2, "February"),
					new ExpectedCellValue(sheetName, 126, 2, null),
					new ExpectedCellValue(sheetName, 127, 2, null),
					new ExpectedCellValue(sheetName, 128, 2, "January"),
					new ExpectedCellValue(sheetName, 129, 2, "March"),
					new ExpectedCellValue(sheetName, 130, 2, null),
					new ExpectedCellValue(sheetName, 131, 2, "January"),
					new ExpectedCellValue(sheetName, 132, 2, "February"),
					new ExpectedCellValue(sheetName, 133, 2, "March"),
					new ExpectedCellValue(sheetName, 134, 2, null),
					new ExpectedCellValue(sheetName, 135, 2, "January"),
					new ExpectedCellValue(sheetName, 136, 2, "February"),
					new ExpectedCellValue(sheetName, 137, 2, null),
					new ExpectedCellValue(sheetName, 138, 2, null),
					new ExpectedCellValue(sheetName, 114, 3, null),
					new ExpectedCellValue(sheetName, 115, 3, null),
					new ExpectedCellValue(sheetName, 116, 3, 3d),
					new ExpectedCellValue(sheetName, 117, 3, 2d),
					new ExpectedCellValue(sheetName, 118, 3, 1d),
					new ExpectedCellValue(sheetName, 119, 3, 10d),
					new ExpectedCellValue(sheetName, 120, 3, 2d),
					new ExpectedCellValue(sheetName, 121, 3, 6d),
					new ExpectedCellValue(sheetName, 122, 3, 2d),
					new ExpectedCellValue(sheetName, 123, 3, 2d),
					new ExpectedCellValue(sheetName, 124, 3, 1d),
					new ExpectedCellValue(sheetName, 125, 3, 1d),
					new ExpectedCellValue(sheetName, 126, 3, null),
					new ExpectedCellValue(sheetName, 127, 3, 856.49),
					new ExpectedCellValue(sheetName, 128, 3, 831.5),
					new ExpectedCellValue(sheetName, 129, 3, 24.99),
					new ExpectedCellValue(sheetName, 130, 3, 2857d),
					new ExpectedCellValue(sheetName, 131, 3, 831.5),
					new ExpectedCellValue(sheetName, 132, 3, 1194d),
					new ExpectedCellValue(sheetName, 133, 3, 831.5),
					new ExpectedCellValue(sheetName, 134, 3, 514.75),
					new ExpectedCellValue(sheetName, 135, 3, 415.75),
					new ExpectedCellValue(sheetName, 136, 3, 99d),
					new ExpectedCellValue(sheetName, 137, 3, 15d),
					new ExpectedCellValue(sheetName, 138, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsFirstDataFieldSecondFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F114:H138"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 114, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 115, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 116, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 117, 6, null),
					new ExpectedCellValue(sheetName, 118, 6, null),
					new ExpectedCellValue(sheetName, 119, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 120, 6, null),
					new ExpectedCellValue(sheetName, 121, 6, null),
					new ExpectedCellValue(sheetName, 122, 6, null),
					new ExpectedCellValue(sheetName, 123, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 124, 6, null),
					new ExpectedCellValue(sheetName, 125, 6, null),
					new ExpectedCellValue(sheetName, 126, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 127, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 128, 6, null),
					new ExpectedCellValue(sheetName, 129, 6, null),
					new ExpectedCellValue(sheetName, 130, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 131, 6, null),
					new ExpectedCellValue(sheetName, 132, 6, null),
					new ExpectedCellValue(sheetName, 133, 6, null),
					new ExpectedCellValue(sheetName, 134, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 6, null),
					new ExpectedCellValue(sheetName, 136, 6, null),
					new ExpectedCellValue(sheetName, 137, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 138, 6, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 7, "Month"),
					new ExpectedCellValue(sheetName, 115, 7, null),
					new ExpectedCellValue(sheetName, 116, 7, null),
					new ExpectedCellValue(sheetName, 117, 7, "January"),
					new ExpectedCellValue(sheetName, 118, 7, "March"),
					new ExpectedCellValue(sheetName, 119, 7, null),
					new ExpectedCellValue(sheetName, 120, 7, "January"),
					new ExpectedCellValue(sheetName, 121, 7, "February"),
					new ExpectedCellValue(sheetName, 122, 7, "March"),
					new ExpectedCellValue(sheetName, 123, 7, null),
					new ExpectedCellValue(sheetName, 124, 7, "January"),
					new ExpectedCellValue(sheetName, 125, 7, "February"),
					new ExpectedCellValue(sheetName, 126, 7, null),
					new ExpectedCellValue(sheetName, 127, 7, null),
					new ExpectedCellValue(sheetName, 128, 7, "January"),
					new ExpectedCellValue(sheetName, 129, 7, "March"),
					new ExpectedCellValue(sheetName, 130, 7, null),
					new ExpectedCellValue(sheetName, 131, 7, "January"),
					new ExpectedCellValue(sheetName, 132, 7, "February"),
					new ExpectedCellValue(sheetName, 133, 7, "March"),
					new ExpectedCellValue(sheetName, 134, 7, null),
					new ExpectedCellValue(sheetName, 135, 7, "January"),
					new ExpectedCellValue(sheetName, 136, 7, "February"),
					new ExpectedCellValue(sheetName, 137, 7, null),
					new ExpectedCellValue(sheetName, 138, 7, null),
					new ExpectedCellValue(sheetName, 114, 8, null),
					new ExpectedCellValue(sheetName, 115, 8, null),
					new ExpectedCellValue(sheetName, 116, 8, 3d),
					new ExpectedCellValue(sheetName, 117, 8, 2d),
					new ExpectedCellValue(sheetName, 118, 8, 1d),
					new ExpectedCellValue(sheetName, 119, 8, 10d),
					new ExpectedCellValue(sheetName, 120, 8, 2d),
					new ExpectedCellValue(sheetName, 121, 8, 6d),
					new ExpectedCellValue(sheetName, 122, 8, 2d),
					new ExpectedCellValue(sheetName, 123, 8, 2d),
					new ExpectedCellValue(sheetName, 124, 8, 1d),
					new ExpectedCellValue(sheetName, 125, 8, 1d),
					new ExpectedCellValue(sheetName, 126, 8, null),
					new ExpectedCellValue(sheetName, 127, 8, 856.49),
					new ExpectedCellValue(sheetName, 128, 8, 831.5),
					new ExpectedCellValue(sheetName, 129, 8, 24.99),
					new ExpectedCellValue(sheetName, 130, 8, 2857d),
					new ExpectedCellValue(sheetName, 131, 8, 831.5),
					new ExpectedCellValue(sheetName, 132, 8, 1194d),
					new ExpectedCellValue(sheetName, 133, 8, 831.5),
					new ExpectedCellValue(sheetName, 134, 8, 514.75),
					new ExpectedCellValue(sheetName, 135, 8, 415.75),
					new ExpectedCellValue(sheetName, 136, 8, 99d),
					new ExpectedCellValue(sheetName, 137, 8, 15d),
					new ExpectedCellValue(sheetName, 138, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormTwoRowFieldsMultipleRowDataFieldsFirstDataFieldLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J114:K138"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 114, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 115, 10, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 116, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 117, 10, "January"),
					new ExpectedCellValue(sheetName, 118, 10, "March"),
					new ExpectedCellValue(sheetName, 119, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 120, 10, "January"),
					new ExpectedCellValue(sheetName, 121, 10, "February"),
					new ExpectedCellValue(sheetName, 122, 10, "March"),
					new ExpectedCellValue(sheetName, 123, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 124, 10, "January"),
					new ExpectedCellValue(sheetName, 125, 10, "February"),
					new ExpectedCellValue(sheetName, 126, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 127, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 128, 10, "January"),
					new ExpectedCellValue(sheetName, 129, 10, "March"),
					new ExpectedCellValue(sheetName, 130, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 131, 10, "January"),
					new ExpectedCellValue(sheetName, 132, 10, "February"),
					new ExpectedCellValue(sheetName, 133, 10, "March"),
					new ExpectedCellValue(sheetName, 134, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 10, "January"),
					new ExpectedCellValue(sheetName, 136, 10, "February"),
					new ExpectedCellValue(sheetName, 137, 10, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 138, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 11, null),
					new ExpectedCellValue(sheetName, 115, 11, null),
					new ExpectedCellValue(sheetName, 116, 11, 3d),
					new ExpectedCellValue(sheetName, 117, 11, 2d),
					new ExpectedCellValue(sheetName, 118, 11, 1d),
					new ExpectedCellValue(sheetName, 119, 11, 10d),
					new ExpectedCellValue(sheetName, 120, 11, 2d),
					new ExpectedCellValue(sheetName, 121, 11, 6d),
					new ExpectedCellValue(sheetName, 122, 11, 2d),
					new ExpectedCellValue(sheetName, 123, 11, 2d),
					new ExpectedCellValue(sheetName, 124, 11, 1d),
					new ExpectedCellValue(sheetName, 125, 11, 1d),
					new ExpectedCellValue(sheetName, 126, 11, null),
					new ExpectedCellValue(sheetName, 127, 11, 856.49),
					new ExpectedCellValue(sheetName, 128, 11, 831.5),
					new ExpectedCellValue(sheetName, 129, 11, 24.99),
					new ExpectedCellValue(sheetName, 130, 11, 2857d),
					new ExpectedCellValue(sheetName, 131, 11, 831.5),
					new ExpectedCellValue(sheetName, 132, 11, 1194d),
					new ExpectedCellValue(sheetName, 133, 11, 831.5),
					new ExpectedCellValue(sheetName, 134, 11, 514.75),
					new ExpectedCellValue(sheetName, 135, 11, 415.75),
					new ExpectedCellValue(sheetName, 136, 11, 99d),
					new ExpectedCellValue(sheetName, 137, 11, 15d),
					new ExpectedCellValue(sheetName, 138, 11, 4228.24)
				});
			}
		}

		// Three Row Fields Multiple Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldAllFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:E55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 1, null),
					new ExpectedCellValue(sheetName, 5, 1, null),
					new ExpectedCellValue(sheetName, 6, 1, null),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, null),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, null),
					new ExpectedCellValue(sheetName, 16, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 1, null),
					new ExpectedCellValue(sheetName, 20, 1, null),
					new ExpectedCellValue(sheetName, 21, 1, null),
					new ExpectedCellValue(sheetName, 22, 1, null),
					new ExpectedCellValue(sheetName, 23, 1, null),
					new ExpectedCellValue(sheetName, 24, 1, null),
					new ExpectedCellValue(sheetName, 25, 1, null),
					new ExpectedCellValue(sheetName, 26, 1, null),
					new ExpectedCellValue(sheetName, 27, 1, null),
					new ExpectedCellValue(sheetName, 28, 1, null),
					new ExpectedCellValue(sheetName, 29, 1, null),
					new ExpectedCellValue(sheetName, 30, 1, null),
					new ExpectedCellValue(sheetName, 31, 1, null),
					new ExpectedCellValue(sheetName, 32, 1, null),
					new ExpectedCellValue(sheetName, 33, 1, null),
					new ExpectedCellValue(sheetName, 34, 1, null),
					new ExpectedCellValue(sheetName, 35, 1, null),
					new ExpectedCellValue(sheetName, 36, 1, null),
					new ExpectedCellValue(sheetName, 37, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 1, null),
					new ExpectedCellValue(sheetName, 41, 1, null),
					new ExpectedCellValue(sheetName, 42, 1, null),
					new ExpectedCellValue(sheetName, 43, 1, null),
					new ExpectedCellValue(sheetName, 44, 1, null),
					new ExpectedCellValue(sheetName, 45, 1, null),
					new ExpectedCellValue(sheetName, 46, 1, null),
					new ExpectedCellValue(sheetName, 47, 1, null),
					new ExpectedCellValue(sheetName, 48, 1, null),
					new ExpectedCellValue(sheetName, 49, 1, null),
					new ExpectedCellValue(sheetName, 50, 1, null),
					new ExpectedCellValue(sheetName, 51, 1, null),
					new ExpectedCellValue(sheetName, 52, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 53, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 54, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 55, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Month"),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, "January"),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 2, "March"),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, "January"),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 2, "February"),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 2, "March"),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, "January"),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 45, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 2, "February"),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 51, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, null),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 2, 3, "Item"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, null),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "Tent"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, null),
					new ExpectedCellValue(sheetName, 2, 4, "Values"),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 43, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, null),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, null),
					new ExpectedCellValue(sheetName, 2, 5, null),
					new ExpectedCellValue(sheetName, 3, 5, null),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, 2d),
					new ExpectedCellValue(sheetName, 7, 5, 831.5),
					new ExpectedCellValue(sheetName, 8, 5, 2d),
					new ExpectedCellValue(sheetName, 9, 5, 831.5),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, 1d),
					new ExpectedCellValue(sheetName, 13, 5, 24.99),
					new ExpectedCellValue(sheetName, 14, 5, 1d),
					new ExpectedCellValue(sheetName, 15, 5, 24.99),
					new ExpectedCellValue(sheetName, 16, 5, 3d),
					new ExpectedCellValue(sheetName, 17, 5, 856.49),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, 2d),
					new ExpectedCellValue(sheetName, 22, 5, 831.5),
					new ExpectedCellValue(sheetName, 23, 5, 2d),
					new ExpectedCellValue(sheetName, 24, 5, 831.5),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, 6d),
					new ExpectedCellValue(sheetName, 28, 5, 1194d),
					new ExpectedCellValue(sheetName, 29, 5, 6d),
					new ExpectedCellValue(sheetName, 30, 5, 1194d),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, 2d),
					new ExpectedCellValue(sheetName, 34, 5, 831.5),
					new ExpectedCellValue(sheetName, 35, 5, 2d),
					new ExpectedCellValue(sheetName, 36, 5, 831.5),
					new ExpectedCellValue(sheetName, 37, 5, 10d),
					new ExpectedCellValue(sheetName, 38, 5, 2857d),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, 1d),
					new ExpectedCellValue(sheetName, 43, 5, 415.75),
					new ExpectedCellValue(sheetName, 44, 5, 1d),
					new ExpectedCellValue(sheetName, 45, 5, 415.75),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, 1d),
					new ExpectedCellValue(sheetName, 49, 5, 99d),
					new ExpectedCellValue(sheetName, 50, 5, 1d),
					new ExpectedCellValue(sheetName, 51, 5, 99d),
					new ExpectedCellValue(sheetName, 52, 5, 2d),
					new ExpectedCellValue(sheetName, 53, 5, 514.75),
					new ExpectedCellValue(sheetName, 54, 5, 15d),
					new ExpectedCellValue(sheetName, 55, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldFirstAndSecondFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G2:J55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, null),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, null),
					new ExpectedCellValue(sheetName, 47, 7, null),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, null),
					new ExpectedCellValue(sheetName, 52, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 53, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 54, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 55, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 8, "Month"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, "January"),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 8, "March"),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, "January"),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 8, "February"),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 8, "March"),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, null),
					new ExpectedCellValue(sheetName, 35, 8, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, "January"),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 45, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 8, "February"),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 51, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 2, 9, "Item"),
					new ExpectedCellValue(sheetName, 3, 9, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 9, null),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, "Tent"),
					new ExpectedCellValue(sheetName, 27, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 43, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, 2d),
					new ExpectedCellValue(sheetName, 7, 10, 831.5),
					new ExpectedCellValue(sheetName, 8, 10, 2d),
					new ExpectedCellValue(sheetName, 9, 10, 831.5),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, 1d),
					new ExpectedCellValue(sheetName, 13, 10, 24.99),
					new ExpectedCellValue(sheetName, 14, 10, 1d),
					new ExpectedCellValue(sheetName, 15, 10, 24.99),
					new ExpectedCellValue(sheetName, 16, 10, 3d),
					new ExpectedCellValue(sheetName, 17, 10, 856.49),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, 2d),
					new ExpectedCellValue(sheetName, 22, 10, 831.5),
					new ExpectedCellValue(sheetName, 23, 10, 2d),
					new ExpectedCellValue(sheetName, 24, 10, 831.5),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, 6d),
					new ExpectedCellValue(sheetName, 28, 10, 1194d),
					new ExpectedCellValue(sheetName, 29, 10, 6d),
					new ExpectedCellValue(sheetName, 30, 10, 1194d),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, 2d),
					new ExpectedCellValue(sheetName, 34, 10, 831.5),
					new ExpectedCellValue(sheetName, 35, 10, 2d),
					new ExpectedCellValue(sheetName, 36, 10, 831.5),
					new ExpectedCellValue(sheetName, 37, 10, 10d),
					new ExpectedCellValue(sheetName, 38, 10, 2857d),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, 1d),
					new ExpectedCellValue(sheetName, 43, 10, 415.75),
					new ExpectedCellValue(sheetName, 44, 10, 1d),
					new ExpectedCellValue(sheetName, 45, 10, 415.75),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, 1d),
					new ExpectedCellValue(sheetName, 49, 10, 99d),
					new ExpectedCellValue(sheetName, 50, 10, 1d),
					new ExpectedCellValue(sheetName, 51, 10, 99d),
					new ExpectedCellValue(sheetName, 52, 10, 2d),
					new ExpectedCellValue(sheetName, 53, 10, 514.75),
					new ExpectedCellValue(sheetName, 54, 10, 15d),
					new ExpectedCellValue(sheetName, 55, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldFirstAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L2:O55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 12, null),
					new ExpectedCellValue(sheetName, 5, 12, null),
					new ExpectedCellValue(sheetName, 6, 12, null),
					new ExpectedCellValue(sheetName, 7, 12, null),
					new ExpectedCellValue(sheetName, 8, 12, null),
					new ExpectedCellValue(sheetName, 9, 12, null),
					new ExpectedCellValue(sheetName, 10, 12, null),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, null),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, null),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, null),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 33, 12, null),
					new ExpectedCellValue(sheetName, 34, 12, null),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 37, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, null),
					new ExpectedCellValue(sheetName, 42, 12, null),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, null),
					new ExpectedCellValue(sheetName, 47, 12, null),
					new ExpectedCellValue(sheetName, 48, 12, null),
					new ExpectedCellValue(sheetName, 49, 12, null),
					new ExpectedCellValue(sheetName, 50, 12, null),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 53, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 54, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 55, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 13, "Month"),
					new ExpectedCellValue(sheetName, 3, 13, null),
					new ExpectedCellValue(sheetName, 4, 13, "January"),
					new ExpectedCellValue(sheetName, 5, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 13, null),
					new ExpectedCellValue(sheetName, 7, 13, null),
					new ExpectedCellValue(sheetName, 8, 13, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 13, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 13, "March"),
					new ExpectedCellValue(sheetName, 11, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 13, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, "January"),
					new ExpectedCellValue(sheetName, 20, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 13, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 13, "February"),
					new ExpectedCellValue(sheetName, 26, 13, "Tent"),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 29, 13, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 13, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 13, "March"),
					new ExpectedCellValue(sheetName, 32, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 34, 13, null),
					new ExpectedCellValue(sheetName, 35, 13, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 13, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, "January"),
					new ExpectedCellValue(sheetName, 41, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 13, null),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 45, 13, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 13, "February"),
					new ExpectedCellValue(sheetName, 47, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 13, null),
					new ExpectedCellValue(sheetName, 49, 13, null),
					new ExpectedCellValue(sheetName, 50, 13, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 51, 13, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 13, null),
					new ExpectedCellValue(sheetName, 53, 13, null),
					new ExpectedCellValue(sheetName, 54, 13, null),
					new ExpectedCellValue(sheetName, 55, 13, null),
					new ExpectedCellValue(sheetName, 2, 14, "Values"),
					new ExpectedCellValue(sheetName, 3, 14, null),
					new ExpectedCellValue(sheetName, 4, 14, null),
					new ExpectedCellValue(sheetName, 5, 14, null),
					new ExpectedCellValue(sheetName, 6, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 14, null),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 14, null),
					new ExpectedCellValue(sheetName, 30, 14, null),
					new ExpectedCellValue(sheetName, 31, 14, null),
					new ExpectedCellValue(sheetName, 32, 14, null),
					new ExpectedCellValue(sheetName, 33, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 14, null),
					new ExpectedCellValue(sheetName, 36, 14, null),
					new ExpectedCellValue(sheetName, 37, 14, null),
					new ExpectedCellValue(sheetName, 38, 14, null),
					new ExpectedCellValue(sheetName, 39, 14, null),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, null),
					new ExpectedCellValue(sheetName, 42, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 43, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, null),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 2, 15, null),
					new ExpectedCellValue(sheetName, 3, 15, null),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, null),
					new ExpectedCellValue(sheetName, 6, 15, 2d),
					new ExpectedCellValue(sheetName, 7, 15, 831.5),
					new ExpectedCellValue(sheetName, 8, 15, 2d),
					new ExpectedCellValue(sheetName, 9, 15, 831.5),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, 1d),
					new ExpectedCellValue(sheetName, 13, 15, 24.99),
					new ExpectedCellValue(sheetName, 14, 15, 1d),
					new ExpectedCellValue(sheetName, 15, 15, 24.99),
					new ExpectedCellValue(sheetName, 16, 15, 3d),
					new ExpectedCellValue(sheetName, 17, 15, 856.49),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, 2d),
					new ExpectedCellValue(sheetName, 22, 15, 831.5),
					new ExpectedCellValue(sheetName, 23, 15, 2d),
					new ExpectedCellValue(sheetName, 24, 15, 831.5),
					new ExpectedCellValue(sheetName, 25, 15, null),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, 6d),
					new ExpectedCellValue(sheetName, 28, 15, 1194d),
					new ExpectedCellValue(sheetName, 29, 15, 6d),
					new ExpectedCellValue(sheetName, 30, 15, 1194d),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 33, 15, 2d),
					new ExpectedCellValue(sheetName, 34, 15, 831.5),
					new ExpectedCellValue(sheetName, 35, 15, 2d),
					new ExpectedCellValue(sheetName, 36, 15, 831.5),
					new ExpectedCellValue(sheetName, 37, 15, 10d),
					new ExpectedCellValue(sheetName, 38, 15, 2857d),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 40, 15, null),
					new ExpectedCellValue(sheetName, 41, 15, null),
					new ExpectedCellValue(sheetName, 42, 15, 1d),
					new ExpectedCellValue(sheetName, 43, 15, 415.75),
					new ExpectedCellValue(sheetName, 44, 15, 1d),
					new ExpectedCellValue(sheetName, 45, 15, 415.75),
					new ExpectedCellValue(sheetName, 46, 15, null),
					new ExpectedCellValue(sheetName, 47, 15, null),
					new ExpectedCellValue(sheetName, 48, 15, 1d),
					new ExpectedCellValue(sheetName, 49, 15, 99d),
					new ExpectedCellValue(sheetName, 50, 15, 1d),
					new ExpectedCellValue(sheetName, 51, 15, 99d),
					new ExpectedCellValue(sheetName, 52, 15, 2d),
					new ExpectedCellValue(sheetName, 53, 15, 514.75),
					new ExpectedCellValue(sheetName, 54, 15, 15d),
					new ExpectedCellValue(sheetName, 55, 15, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q2:S55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 17, null),
					new ExpectedCellValue(sheetName, 5, 17, null),
					new ExpectedCellValue(sheetName, 6, 17, null),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, null),
					new ExpectedCellValue(sheetName, 10, 17, null),
					new ExpectedCellValue(sheetName, 11, 17, null),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, null),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 40, 17, null),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, null),
					new ExpectedCellValue(sheetName, 43, 17, null),
					new ExpectedCellValue(sheetName, 44, 17, null),
					new ExpectedCellValue(sheetName, 45, 17, null),
					new ExpectedCellValue(sheetName, 46, 17, null),
					new ExpectedCellValue(sheetName, 47, 17, null),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 53, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 54, 17, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 55, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 18, "Month"),
					new ExpectedCellValue(sheetName, 3, 18, null),
					new ExpectedCellValue(sheetName, 4, 18, "January"),
					new ExpectedCellValue(sheetName, 5, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 7, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 8, 18, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 9, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 18, "March"),
					new ExpectedCellValue(sheetName, 11, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 18, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, null),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, "January"),
					new ExpectedCellValue(sheetName, 20, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 18, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 18, "February"),
					new ExpectedCellValue(sheetName, 26, 18, "Tent"),
					new ExpectedCellValue(sheetName, 27, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 18, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 18, "March"),
					new ExpectedCellValue(sheetName, 32, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 18, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 36, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 18, null),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, "January"),
					new ExpectedCellValue(sheetName, 41, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 43, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 44, 18, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 45, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 18, "February"),
					new ExpectedCellValue(sheetName, 47, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 18, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 51, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, null),
					new ExpectedCellValue(sheetName, 54, 18, null),
					new ExpectedCellValue(sheetName, 55, 18, null),
					new ExpectedCellValue(sheetName, 2, 19, null),
					new ExpectedCellValue(sheetName, 3, 19, null),
					new ExpectedCellValue(sheetName, 4, 19, null),
					new ExpectedCellValue(sheetName, 5, 19, null),
					new ExpectedCellValue(sheetName, 6, 19, 2d),
					new ExpectedCellValue(sheetName, 7, 19, 831.5),
					new ExpectedCellValue(sheetName, 8, 19, 2d),
					new ExpectedCellValue(sheetName, 9, 19, 831.5),
					new ExpectedCellValue(sheetName, 10, 19, null),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, 1d),
					new ExpectedCellValue(sheetName, 13, 19, 24.99),
					new ExpectedCellValue(sheetName, 14, 19, 1d),
					new ExpectedCellValue(sheetName, 15, 19, 24.99),
					new ExpectedCellValue(sheetName, 16, 19, 3d),
					new ExpectedCellValue(sheetName, 17, 19, 856.49),
					new ExpectedCellValue(sheetName, 18, 19, null),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, 2d),
					new ExpectedCellValue(sheetName, 22, 19, 831.5),
					new ExpectedCellValue(sheetName, 23, 19, 2d),
					new ExpectedCellValue(sheetName, 24, 19, 831.5),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, 6d),
					new ExpectedCellValue(sheetName, 28, 19, 1194d),
					new ExpectedCellValue(sheetName, 29, 19, 6d),
					new ExpectedCellValue(sheetName, 30, 19, 1194d),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, null),
					new ExpectedCellValue(sheetName, 33, 19, 2d),
					new ExpectedCellValue(sheetName, 34, 19, 831.5),
					new ExpectedCellValue(sheetName, 35, 19, 2d),
					new ExpectedCellValue(sheetName, 36, 19, 831.5),
					new ExpectedCellValue(sheetName, 37, 19, 10d),
					new ExpectedCellValue(sheetName, 38, 19, 2857d),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, 1d),
					new ExpectedCellValue(sheetName, 43, 19, 415.75),
					new ExpectedCellValue(sheetName, 44, 19, 1d),
					new ExpectedCellValue(sheetName, 45, 19, 415.75),
					new ExpectedCellValue(sheetName, 46, 19, null),
					new ExpectedCellValue(sheetName, 47, 19, null),
					new ExpectedCellValue(sheetName, 48, 19, 1d),
					new ExpectedCellValue(sheetName, 49, 19, 99d),
					new ExpectedCellValue(sheetName, 50, 19, 1d),
					new ExpectedCellValue(sheetName, 51, 19, 99d),
					new ExpectedCellValue(sheetName, 52, 19, 2d),
					new ExpectedCellValue(sheetName, 53, 19, 514.75),
					new ExpectedCellValue(sheetName, 54, 19, 15d),
					new ExpectedCellValue(sheetName, 55, 19, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldSecondAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A62:D115"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 62, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 63, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 64, 1, "January"),
					new ExpectedCellValue(sheetName, 65, 1, null),
					new ExpectedCellValue(sheetName, 66, 1, null),
					new ExpectedCellValue(sheetName, 67, 1, null),
					new ExpectedCellValue(sheetName, 68, 1, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 69, 1, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 1, "March"),
					new ExpectedCellValue(sheetName, 71, 1, null),
					new ExpectedCellValue(sheetName, 72, 1, null),
					new ExpectedCellValue(sheetName, 73, 1, null),
					new ExpectedCellValue(sheetName, 74, 1, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 75, 1, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 77, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 78, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 1, "January"),
					new ExpectedCellValue(sheetName, 80, 1, null),
					new ExpectedCellValue(sheetName, 81, 1, null),
					new ExpectedCellValue(sheetName, 82, 1, null),
					new ExpectedCellValue(sheetName, 83, 1, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 84, 1, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 1, "February"),
					new ExpectedCellValue(sheetName, 86, 1, null),
					new ExpectedCellValue(sheetName, 87, 1, null),
					new ExpectedCellValue(sheetName, 88, 1, null),
					new ExpectedCellValue(sheetName, 89, 1, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 90, 1, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 91, 1, "March"),
					new ExpectedCellValue(sheetName, 92, 1, null),
					new ExpectedCellValue(sheetName, 93, 1, null),
					new ExpectedCellValue(sheetName, 94, 1, null),
					new ExpectedCellValue(sheetName, 95, 1, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 96, 1, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 98, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 1, "January"),
					new ExpectedCellValue(sheetName, 101, 1, null),
					new ExpectedCellValue(sheetName, 102, 1, null),
					new ExpectedCellValue(sheetName, 103, 1, null),
					new ExpectedCellValue(sheetName, 104, 1, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 105, 1, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 1, "February"),
					new ExpectedCellValue(sheetName, 107, 1, null),
					new ExpectedCellValue(sheetName, 108, 1, null),
					new ExpectedCellValue(sheetName, 109, 1, null),
					new ExpectedCellValue(sheetName, 110, 1, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 111, 1, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 112, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 113, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 115, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 2, "Item"),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, null),
					new ExpectedCellValue(sheetName, 71, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, null),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, null),
					new ExpectedCellValue(sheetName, 78, 2, null),
					new ExpectedCellValue(sheetName, 79, 2, null),
					new ExpectedCellValue(sheetName, 80, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 2, null),
					new ExpectedCellValue(sheetName, 82, 2, null),
					new ExpectedCellValue(sheetName, 83, 2, null),
					new ExpectedCellValue(sheetName, 84, 2, null),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, "Tent"),
					new ExpectedCellValue(sheetName, 87, 2, null),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 90, 2, null),
					new ExpectedCellValue(sheetName, 91, 2, null),
					new ExpectedCellValue(sheetName, 92, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 93, 2, null),
					new ExpectedCellValue(sheetName, 94, 2, null),
					new ExpectedCellValue(sheetName, 95, 2, null),
					new ExpectedCellValue(sheetName, 96, 2, null),
					new ExpectedCellValue(sheetName, 97, 2, null),
					new ExpectedCellValue(sheetName, 98, 2, null),
					new ExpectedCellValue(sheetName, 99, 2, null),
					new ExpectedCellValue(sheetName, 100, 2, null),
					new ExpectedCellValue(sheetName, 101, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 102, 2, null),
					new ExpectedCellValue(sheetName, 103, 2, null),
					new ExpectedCellValue(sheetName, 104, 2, null),
					new ExpectedCellValue(sheetName, 105, 2, null),
					new ExpectedCellValue(sheetName, 106, 2, null),
					new ExpectedCellValue(sheetName, 107, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 108, 2, null),
					new ExpectedCellValue(sheetName, 109, 2, null),
					new ExpectedCellValue(sheetName, 110, 2, null),
					new ExpectedCellValue(sheetName, 111, 2, null),
					new ExpectedCellValue(sheetName, 112, 2, null),
					new ExpectedCellValue(sheetName, 113, 2, null),
					new ExpectedCellValue(sheetName, 114, 2, null),
					new ExpectedCellValue(sheetName, 115, 2, null),
					new ExpectedCellValue(sheetName, 62, 3, "Values"),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 67, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, null),
					new ExpectedCellValue(sheetName, 72, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 73, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 82, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, null),
					new ExpectedCellValue(sheetName, 85, 3, null),
					new ExpectedCellValue(sheetName, 86, 3, null),
					new ExpectedCellValue(sheetName, 87, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 88, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 90, 3, null),
					new ExpectedCellValue(sheetName, 91, 3, null),
					new ExpectedCellValue(sheetName, 92, 3, null),
					new ExpectedCellValue(sheetName, 93, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 94, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null),
					new ExpectedCellValue(sheetName, 97, 3, null),
					new ExpectedCellValue(sheetName, 98, 3, null),
					new ExpectedCellValue(sheetName, 99, 3, null),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 101, 3, null),
					new ExpectedCellValue(sheetName, 102, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 103, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 104, 3, null),
					new ExpectedCellValue(sheetName, 105, 3, null),
					new ExpectedCellValue(sheetName, 106, 3, null),
					new ExpectedCellValue(sheetName, 107, 3, null),
					new ExpectedCellValue(sheetName, 108, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 109, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 3, null),
					new ExpectedCellValue(sheetName, 111, 3, null),
					new ExpectedCellValue(sheetName, 112, 3, null),
					new ExpectedCellValue(sheetName, 113, 3, null),
					new ExpectedCellValue(sheetName, 114, 3, null),
					new ExpectedCellValue(sheetName, 115, 3, null),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, null),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 66, 4, 2d),
					new ExpectedCellValue(sheetName, 67, 4, 831.5),
					new ExpectedCellValue(sheetName, 68, 4, 2d),
					new ExpectedCellValue(sheetName, 69, 4, 831.5),
					new ExpectedCellValue(sheetName, 70, 4, null),
					new ExpectedCellValue(sheetName, 71, 4, null),
					new ExpectedCellValue(sheetName, 72, 4, 1d),
					new ExpectedCellValue(sheetName, 73, 4, 24.99),
					new ExpectedCellValue(sheetName, 74, 4, 1d),
					new ExpectedCellValue(sheetName, 75, 4, 24.99),
					new ExpectedCellValue(sheetName, 76, 4, 3d),
					new ExpectedCellValue(sheetName, 77, 4, 856.49),
					new ExpectedCellValue(sheetName, 78, 4, null),
					new ExpectedCellValue(sheetName, 79, 4, null),
					new ExpectedCellValue(sheetName, 80, 4, null),
					new ExpectedCellValue(sheetName, 81, 4, 2d),
					new ExpectedCellValue(sheetName, 82, 4, 831.5),
					new ExpectedCellValue(sheetName, 83, 4, 2d),
					new ExpectedCellValue(sheetName, 84, 4, 831.5),
					new ExpectedCellValue(sheetName, 85, 4, null),
					new ExpectedCellValue(sheetName, 86, 4, null),
					new ExpectedCellValue(sheetName, 87, 4, 6d),
					new ExpectedCellValue(sheetName, 88, 4, 1194d),
					new ExpectedCellValue(sheetName, 89, 4, 6d),
					new ExpectedCellValue(sheetName, 90, 4, 1194d),
					new ExpectedCellValue(sheetName, 91, 4, null),
					new ExpectedCellValue(sheetName, 92, 4, null),
					new ExpectedCellValue(sheetName, 93, 4, 2d),
					new ExpectedCellValue(sheetName, 94, 4, 831.5),
					new ExpectedCellValue(sheetName, 95, 4, 2d),
					new ExpectedCellValue(sheetName, 96, 4, 831.5),
					new ExpectedCellValue(sheetName, 97, 4, 10d),
					new ExpectedCellValue(sheetName, 98, 4, 2857d),
					new ExpectedCellValue(sheetName, 99, 4, null),
					new ExpectedCellValue(sheetName, 100, 4, null),
					new ExpectedCellValue(sheetName, 101, 4, null),
					new ExpectedCellValue(sheetName, 102, 4, 1d),
					new ExpectedCellValue(sheetName, 103, 4, 415.75),
					new ExpectedCellValue(sheetName, 104, 4, 1d),
					new ExpectedCellValue(sheetName, 105, 4, 415.75),
					new ExpectedCellValue(sheetName, 106, 4, null),
					new ExpectedCellValue(sheetName, 107, 4, null),
					new ExpectedCellValue(sheetName, 108, 4, 1d),
					new ExpectedCellValue(sheetName, 109, 4, 99d),
					new ExpectedCellValue(sheetName, 110, 4, 1d),
					new ExpectedCellValue(sheetName, 111, 4, 99d),
					new ExpectedCellValue(sheetName, 112, 4, 2d),
					new ExpectedCellValue(sheetName, 113, 4, 514.75),
					new ExpectedCellValue(sheetName, 114, 4, 15d),
					new ExpectedCellValue(sheetName, 115, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldSecondFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G62:I115"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 62, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 63, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 64, 7, "January"),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, null),
					new ExpectedCellValue(sheetName, 68, 7, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 69, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 7, "March"),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, null),
					new ExpectedCellValue(sheetName, 73, 7, null),
					new ExpectedCellValue(sheetName, 74, 7, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 75, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 7, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 77, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 78, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 7, "January"),
					new ExpectedCellValue(sheetName, 80, 7, null),
					new ExpectedCellValue(sheetName, 81, 7, null),
					new ExpectedCellValue(sheetName, 82, 7, null),
					new ExpectedCellValue(sheetName, 83, 7, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 84, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 7, "February"),
					new ExpectedCellValue(sheetName, 86, 7, null),
					new ExpectedCellValue(sheetName, 87, 7, null),
					new ExpectedCellValue(sheetName, 88, 7, null),
					new ExpectedCellValue(sheetName, 89, 7, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 90, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 91, 7, "March"),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, null),
					new ExpectedCellValue(sheetName, 94, 7, null),
					new ExpectedCellValue(sheetName, 95, 7, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 96, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 7, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 98, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 7, "January"),
					new ExpectedCellValue(sheetName, 101, 7, null),
					new ExpectedCellValue(sheetName, 102, 7, null),
					new ExpectedCellValue(sheetName, 103, 7, null),
					new ExpectedCellValue(sheetName, 104, 7, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 105, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 7, "February"),
					new ExpectedCellValue(sheetName, 107, 7, null),
					new ExpectedCellValue(sheetName, 108, 7, null),
					new ExpectedCellValue(sheetName, 109, 7, null),
					new ExpectedCellValue(sheetName, 110, 7, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 111, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 112, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 113, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 115, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 8, "Item"),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 67, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, null),
					new ExpectedCellValue(sheetName, 70, 8, null),
					new ExpectedCellValue(sheetName, 71, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 73, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, null),
					new ExpectedCellValue(sheetName, 77, 8, null),
					new ExpectedCellValue(sheetName, 78, 8, null),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 82, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, null),
					new ExpectedCellValue(sheetName, 85, 8, null),
					new ExpectedCellValue(sheetName, 86, 8, "Tent"),
					new ExpectedCellValue(sheetName, 87, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 88, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 8, null),
					new ExpectedCellValue(sheetName, 90, 8, null),
					new ExpectedCellValue(sheetName, 91, 8, null),
					new ExpectedCellValue(sheetName, 92, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 93, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 94, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 8, null),
					new ExpectedCellValue(sheetName, 96, 8, null),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, null),
					new ExpectedCellValue(sheetName, 99, 8, null),
					new ExpectedCellValue(sheetName, 100, 8, null),
					new ExpectedCellValue(sheetName, 101, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 102, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 103, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 104, 8, null),
					new ExpectedCellValue(sheetName, 105, 8, null),
					new ExpectedCellValue(sheetName, 106, 8, null),
					new ExpectedCellValue(sheetName, 107, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 108, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 109, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 8, null),
					new ExpectedCellValue(sheetName, 111, 8, null),
					new ExpectedCellValue(sheetName, 112, 8, null),
					new ExpectedCellValue(sheetName, 113, 8, null),
					new ExpectedCellValue(sheetName, 114, 8, null),
					new ExpectedCellValue(sheetName, 115, 8, null),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, 2d),
					new ExpectedCellValue(sheetName, 67, 9, 831.5),
					new ExpectedCellValue(sheetName, 68, 9, 2d),
					new ExpectedCellValue(sheetName, 69, 9, 831.5),
					new ExpectedCellValue(sheetName, 70, 9, null),
					new ExpectedCellValue(sheetName, 71, 9, null),
					new ExpectedCellValue(sheetName, 72, 9, 1d),
					new ExpectedCellValue(sheetName, 73, 9, 24.99),
					new ExpectedCellValue(sheetName, 74, 9, 1d),
					new ExpectedCellValue(sheetName, 75, 9, 24.99),
					new ExpectedCellValue(sheetName, 76, 9, 3d),
					new ExpectedCellValue(sheetName, 77, 9, 856.49),
					new ExpectedCellValue(sheetName, 78, 9, null),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 80, 9, null),
					new ExpectedCellValue(sheetName, 81, 9, 2d),
					new ExpectedCellValue(sheetName, 82, 9, 831.5),
					new ExpectedCellValue(sheetName, 83, 9, 2d),
					new ExpectedCellValue(sheetName, 84, 9, 831.5),
					new ExpectedCellValue(sheetName, 85, 9, null),
					new ExpectedCellValue(sheetName, 86, 9, null),
					new ExpectedCellValue(sheetName, 87, 9, 6d),
					new ExpectedCellValue(sheetName, 88, 9, 1194d),
					new ExpectedCellValue(sheetName, 89, 9, 6d),
					new ExpectedCellValue(sheetName, 90, 9, 1194d),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, null),
					new ExpectedCellValue(sheetName, 93, 9, 2d),
					new ExpectedCellValue(sheetName, 94, 9, 831.5),
					new ExpectedCellValue(sheetName, 95, 9, 2d),
					new ExpectedCellValue(sheetName, 96, 9, 831.5),
					new ExpectedCellValue(sheetName, 97, 9, 10d),
					new ExpectedCellValue(sheetName, 98, 9, 2857d),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, null),
					new ExpectedCellValue(sheetName, 101, 9, null),
					new ExpectedCellValue(sheetName, 102, 9, 1d),
					new ExpectedCellValue(sheetName, 103, 9, 415.75),
					new ExpectedCellValue(sheetName, 104, 9, 1d),
					new ExpectedCellValue(sheetName, 105, 9, 415.75),
					new ExpectedCellValue(sheetName, 106, 9, null),
					new ExpectedCellValue(sheetName, 107, 9, null),
					new ExpectedCellValue(sheetName, 108, 9, 1d),
					new ExpectedCellValue(sheetName, 109, 9, 99d),
					new ExpectedCellValue(sheetName, 110, 9, 1d),
					new ExpectedCellValue(sheetName, 111, 9, 99d),
					new ExpectedCellValue(sheetName, 112, 9, 2d),
					new ExpectedCellValue(sheetName, 113, 9, 514.75),
					new ExpectedCellValue(sheetName, 114, 9, 15d),
					new ExpectedCellValue(sheetName, 115, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsLeafDataFieldThirdFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L62:N115"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 62, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 63, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 64, 12, "January"),
					new ExpectedCellValue(sheetName, 65, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, null),
					new ExpectedCellValue(sheetName, 68, 12, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 69, 12, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 12, "March"),
					new ExpectedCellValue(sheetName, 71, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 12, null),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 75, 12, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 12, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 77, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 78, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 12, "January"),
					new ExpectedCellValue(sheetName, 80, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, null),
					new ExpectedCellValue(sheetName, 83, 12, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 84, 12, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 12, "February"),
					new ExpectedCellValue(sheetName, 86, 12, "Tent"),
					new ExpectedCellValue(sheetName, 87, 12, null),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 90, 12, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 91, 12, "March"),
					new ExpectedCellValue(sheetName, 92, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 93, 12, null),
					new ExpectedCellValue(sheetName, 94, 12, null),
					new ExpectedCellValue(sheetName, 95, 12, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 96, 12, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 98, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 100, 12, "January"),
					new ExpectedCellValue(sheetName, 101, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 102, 12, null),
					new ExpectedCellValue(sheetName, 103, 12, null),
					new ExpectedCellValue(sheetName, 104, 12, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 105, 12, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 12, "February"),
					new ExpectedCellValue(sheetName, 107, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 108, 12, null),
					new ExpectedCellValue(sheetName, 109, 12, null),
					new ExpectedCellValue(sheetName, 110, 12, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 111, 12, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 112, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 113, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 115, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 13, "Values"),
					new ExpectedCellValue(sheetName, 63, 13, null),
					new ExpectedCellValue(sheetName, 64, 13, null),
					new ExpectedCellValue(sheetName, 65, 13, null),
					new ExpectedCellValue(sheetName, 66, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 67, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 68, 13, null),
					new ExpectedCellValue(sheetName, 69, 13, null),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, null),
					new ExpectedCellValue(sheetName, 72, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 73, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 74, 13, null),
					new ExpectedCellValue(sheetName, 75, 13, null),
					new ExpectedCellValue(sheetName, 76, 13, null),
					new ExpectedCellValue(sheetName, 77, 13, null),
					new ExpectedCellValue(sheetName, 78, 13, null),
					new ExpectedCellValue(sheetName, 79, 13, null),
					new ExpectedCellValue(sheetName, 80, 13, null),
					new ExpectedCellValue(sheetName, 81, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 82, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 13, null),
					new ExpectedCellValue(sheetName, 84, 13, null),
					new ExpectedCellValue(sheetName, 85, 13, null),
					new ExpectedCellValue(sheetName, 86, 13, null),
					new ExpectedCellValue(sheetName, 87, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 88, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 13, null),
					new ExpectedCellValue(sheetName, 90, 13, null),
					new ExpectedCellValue(sheetName, 91, 13, null),
					new ExpectedCellValue(sheetName, 92, 13, null),
					new ExpectedCellValue(sheetName, 93, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 94, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 13, null),
					new ExpectedCellValue(sheetName, 96, 13, null),
					new ExpectedCellValue(sheetName, 97, 13, null),
					new ExpectedCellValue(sheetName, 98, 13, null),
					new ExpectedCellValue(sheetName, 99, 13, null),
					new ExpectedCellValue(sheetName, 100, 13, null),
					new ExpectedCellValue(sheetName, 101, 13, null),
					new ExpectedCellValue(sheetName, 102, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 103, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 104, 13, null),
					new ExpectedCellValue(sheetName, 105, 13, null),
					new ExpectedCellValue(sheetName, 106, 13, null),
					new ExpectedCellValue(sheetName, 107, 13, null),
					new ExpectedCellValue(sheetName, 108, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 109, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 13, null),
					new ExpectedCellValue(sheetName, 111, 13, null),
					new ExpectedCellValue(sheetName, 112, 13, null),
					new ExpectedCellValue(sheetName, 113, 13, null),
					new ExpectedCellValue(sheetName, 114, 13, null),
					new ExpectedCellValue(sheetName, 115, 13, null),
					new ExpectedCellValue(sheetName, 62, 14, null),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, 2d),
					new ExpectedCellValue(sheetName, 67, 14, 831.5),
					new ExpectedCellValue(sheetName, 68, 14, 2d),
					new ExpectedCellValue(sheetName, 69, 14, 831.5),
					new ExpectedCellValue(sheetName, 70, 14, null),
					new ExpectedCellValue(sheetName, 71, 14, null),
					new ExpectedCellValue(sheetName, 72, 14, 1d),
					new ExpectedCellValue(sheetName, 73, 14, 24.99),
					new ExpectedCellValue(sheetName, 74, 14, 1d),
					new ExpectedCellValue(sheetName, 75, 14, 24.99),
					new ExpectedCellValue(sheetName, 76, 14, 3d),
					new ExpectedCellValue(sheetName, 77, 14, 856.49),
					new ExpectedCellValue(sheetName, 78, 14, null),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, 2d),
					new ExpectedCellValue(sheetName, 82, 14, 831.5),
					new ExpectedCellValue(sheetName, 83, 14, 2d),
					new ExpectedCellValue(sheetName, 84, 14, 831.5),
					new ExpectedCellValue(sheetName, 85, 14, null),
					new ExpectedCellValue(sheetName, 86, 14, null),
					new ExpectedCellValue(sheetName, 87, 14, 6d),
					new ExpectedCellValue(sheetName, 88, 14, 1194d),
					new ExpectedCellValue(sheetName, 89, 14, 6d),
					new ExpectedCellValue(sheetName, 90, 14, 1194d),
					new ExpectedCellValue(sheetName, 91, 14, null),
					new ExpectedCellValue(sheetName, 92, 14, null),
					new ExpectedCellValue(sheetName, 93, 14, 2d),
					new ExpectedCellValue(sheetName, 94, 14, 831.5),
					new ExpectedCellValue(sheetName, 95, 14, 2d),
					new ExpectedCellValue(sheetName, 96, 14, 831.5),
					new ExpectedCellValue(sheetName, 97, 14, 10d),
					new ExpectedCellValue(sheetName, 98, 14, 2857d),
					new ExpectedCellValue(sheetName, 99, 14, null),
					new ExpectedCellValue(sheetName, 100, 14, null),
					new ExpectedCellValue(sheetName, 101, 14, null),
					new ExpectedCellValue(sheetName, 102, 14, 1d),
					new ExpectedCellValue(sheetName, 103, 14, 415.75),
					new ExpectedCellValue(sheetName, 104, 14, 1d),
					new ExpectedCellValue(sheetName, 105, 14, 415.75),
					new ExpectedCellValue(sheetName, 106, 14, null),
					new ExpectedCellValue(sheetName, 107, 14, null),
					new ExpectedCellValue(sheetName, 108, 14, 1d),
					new ExpectedCellValue(sheetName, 109, 14, 99d),
					new ExpectedCellValue(sheetName, 110, 14, 1d),
					new ExpectedCellValue(sheetName, 111, 14, 99d),
					new ExpectedCellValue(sheetName, 112, 14, 2d),
					new ExpectedCellValue(sheetName, 113, 14, 514.75),
					new ExpectedCellValue(sheetName, 114, 14, 15d),
					new ExpectedCellValue(sheetName, 115, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldFirstSecondAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A120:D180"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 1, null),
					new ExpectedCellValue(sheetName, 123, 1, null),
					new ExpectedCellValue(sheetName, 124, 1, null),
					new ExpectedCellValue(sheetName, 125, 1, null),
					new ExpectedCellValue(sheetName, 126, 1, null),
					new ExpectedCellValue(sheetName, 127, 1, null),
					new ExpectedCellValue(sheetName, 128, 1, null),
					new ExpectedCellValue(sheetName, 129, 1, null),
					new ExpectedCellValue(sheetName, 130, 1, null),
					new ExpectedCellValue(sheetName, 131, 1, null),
					new ExpectedCellValue(sheetName, 132, 1, null),
					new ExpectedCellValue(sheetName, 133, 1, null),
					new ExpectedCellValue(sheetName, 134, 1, null),
					new ExpectedCellValue(sheetName, 135, 1, null),
					new ExpectedCellValue(sheetName, 136, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 137, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 138, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 139, 1, null),
					new ExpectedCellValue(sheetName, 140, 1, null),
					new ExpectedCellValue(sheetName, 141, 1, null),
					new ExpectedCellValue(sheetName, 142, 1, null),
					new ExpectedCellValue(sheetName, 143, 1, null),
					new ExpectedCellValue(sheetName, 144, 1, null),
					new ExpectedCellValue(sheetName, 145, 1, null),
					new ExpectedCellValue(sheetName, 146, 1, null),
					new ExpectedCellValue(sheetName, 147, 1, null),
					new ExpectedCellValue(sheetName, 148, 1, null),
					new ExpectedCellValue(sheetName, 149, 1, null),
					new ExpectedCellValue(sheetName, 150, 1, null),
					new ExpectedCellValue(sheetName, 151, 1, null),
					new ExpectedCellValue(sheetName, 152, 1, null),
					new ExpectedCellValue(sheetName, 153, 1, null),
					new ExpectedCellValue(sheetName, 154, 1, null),
					new ExpectedCellValue(sheetName, 155, 1, null),
					new ExpectedCellValue(sheetName, 156, 1, null),
					new ExpectedCellValue(sheetName, 157, 1, null),
					new ExpectedCellValue(sheetName, 158, 1, null),
					new ExpectedCellValue(sheetName, 159, 1, null),
					new ExpectedCellValue(sheetName, 160, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 161, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 162, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 163, 1, null),
					new ExpectedCellValue(sheetName, 164, 1, null),
					new ExpectedCellValue(sheetName, 165, 1, null),
					new ExpectedCellValue(sheetName, 166, 1, null),
					new ExpectedCellValue(sheetName, 167, 1, null),
					new ExpectedCellValue(sheetName, 168, 1, null),
					new ExpectedCellValue(sheetName, 169, 1, null),
					new ExpectedCellValue(sheetName, 170, 1, null),
					new ExpectedCellValue(sheetName, 171, 1, null),
					new ExpectedCellValue(sheetName, 172, 1, null),
					new ExpectedCellValue(sheetName, 173, 1, null),
					new ExpectedCellValue(sheetName, 174, 1, null),
					new ExpectedCellValue(sheetName, 175, 1, null),
					new ExpectedCellValue(sheetName, 176, 1, null),
					new ExpectedCellValue(sheetName, 177, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 178, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 180, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 2, "Month"),
					new ExpectedCellValue(sheetName, 121, 2, null),
					new ExpectedCellValue(sheetName, 122, 2, "January"),
					new ExpectedCellValue(sheetName, 123, 2, null),
					new ExpectedCellValue(sheetName, 124, 2, null),
					new ExpectedCellValue(sheetName, 125, 2, null),
					new ExpectedCellValue(sheetName, 126, 2, null),
					new ExpectedCellValue(sheetName, 127, 2, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 128, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 129, 2, "March"),
					new ExpectedCellValue(sheetName, 130, 2, null),
					new ExpectedCellValue(sheetName, 131, 2, null),
					new ExpectedCellValue(sheetName, 132, 2, null),
					new ExpectedCellValue(sheetName, 133, 2, null),
					new ExpectedCellValue(sheetName, 134, 2, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 135, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 2, null),
					new ExpectedCellValue(sheetName, 137, 2, null),
					new ExpectedCellValue(sheetName, 138, 2, null),
					new ExpectedCellValue(sheetName, 139, 2, "January"),
					new ExpectedCellValue(sheetName, 140, 2, null),
					new ExpectedCellValue(sheetName, 141, 2, null),
					new ExpectedCellValue(sheetName, 142, 2, null),
					new ExpectedCellValue(sheetName, 143, 2, null),
					new ExpectedCellValue(sheetName, 144, 2, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 145, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 2, "February"),
					new ExpectedCellValue(sheetName, 147, 2, null),
					new ExpectedCellValue(sheetName, 148, 2, null),
					new ExpectedCellValue(sheetName, 149, 2, null),
					new ExpectedCellValue(sheetName, 150, 2, null),
					new ExpectedCellValue(sheetName, 151, 2, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 152, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 153, 2, "March"),
					new ExpectedCellValue(sheetName, 154, 2, null),
					new ExpectedCellValue(sheetName, 155, 2, null),
					new ExpectedCellValue(sheetName, 156, 2, null),
					new ExpectedCellValue(sheetName, 157, 2, null),
					new ExpectedCellValue(sheetName, 158, 2, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 159, 2, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 2, null),
					new ExpectedCellValue(sheetName, 161, 2, null),
					new ExpectedCellValue(sheetName, 162, 2, null),
					new ExpectedCellValue(sheetName, 163, 2, "January"),
					new ExpectedCellValue(sheetName, 164, 2, null),
					new ExpectedCellValue(sheetName, 165, 2, null),
					new ExpectedCellValue(sheetName, 166, 2, null),
					new ExpectedCellValue(sheetName, 167, 2, null),
					new ExpectedCellValue(sheetName, 168, 2, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 169, 2, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 2, "February"),
					new ExpectedCellValue(sheetName, 171, 2, null),
					new ExpectedCellValue(sheetName, 172, 2, null),
					new ExpectedCellValue(sheetName, 173, 2, null),
					new ExpectedCellValue(sheetName, 174, 2, null),
					new ExpectedCellValue(sheetName, 175, 2, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 176, 2, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 177, 2, null),
					new ExpectedCellValue(sheetName, 178, 2, null),
					new ExpectedCellValue(sheetName, 179, 2, null),
					new ExpectedCellValue(sheetName, 180, 2, null),
					new ExpectedCellValue(sheetName, 120, 3, "Values"),
					new ExpectedCellValue(sheetName, 121, 3, null),
					new ExpectedCellValue(sheetName, 122, 3, null),
					new ExpectedCellValue(sheetName, 123, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 124, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 125, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 3, null),
					new ExpectedCellValue(sheetName, 128, 3, null),
					new ExpectedCellValue(sheetName, 129, 3, null),
					new ExpectedCellValue(sheetName, 130, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 131, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 132, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, null),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, null),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 140, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 141, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 3, null),
					new ExpectedCellValue(sheetName, 145, 3, null),
					new ExpectedCellValue(sheetName, 146, 3, null),
					new ExpectedCellValue(sheetName, 147, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 148, 3, "Tent"),
					new ExpectedCellValue(sheetName, 149, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 150, 3, "Tent"),
					new ExpectedCellValue(sheetName, 151, 3, null),
					new ExpectedCellValue(sheetName, 152, 3, null),
					new ExpectedCellValue(sheetName, 153, 3, null),
					new ExpectedCellValue(sheetName, 154, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 155, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 156, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 158, 3, null),
					new ExpectedCellValue(sheetName, 159, 3, null),
					new ExpectedCellValue(sheetName, 160, 3, null),
					new ExpectedCellValue(sheetName, 161, 3, null),
					new ExpectedCellValue(sheetName, 162, 3, null),
					new ExpectedCellValue(sheetName, 163, 3, null),
					new ExpectedCellValue(sheetName, 164, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 165, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 166, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 168, 3, null),
					new ExpectedCellValue(sheetName, 169, 3, null),
					new ExpectedCellValue(sheetName, 170, 3, null),
					new ExpectedCellValue(sheetName, 171, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 172, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 173, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 174, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 175, 3, null),
					new ExpectedCellValue(sheetName, 176, 3, null),
					new ExpectedCellValue(sheetName, 177, 3, null),
					new ExpectedCellValue(sheetName, 178, 3, null),
					new ExpectedCellValue(sheetName, 179, 3, null),
					new ExpectedCellValue(sheetName, 180, 3, null),
					new ExpectedCellValue(sheetName, 120, 4, null),
					new ExpectedCellValue(sheetName, 121, 4, null),
					new ExpectedCellValue(sheetName, 122, 4, null),
					new ExpectedCellValue(sheetName, 123, 4, null),
					new ExpectedCellValue(sheetName, 124, 4, 2d),
					new ExpectedCellValue(sheetName, 125, 4, null),
					new ExpectedCellValue(sheetName, 126, 4, 831.5),
					new ExpectedCellValue(sheetName, 127, 4, 2d),
					new ExpectedCellValue(sheetName, 128, 4, 831.5),
					new ExpectedCellValue(sheetName, 129, 4, null),
					new ExpectedCellValue(sheetName, 130, 4, null),
					new ExpectedCellValue(sheetName, 131, 4, 1d),
					new ExpectedCellValue(sheetName, 132, 4, null),
					new ExpectedCellValue(sheetName, 133, 4, 24.99),
					new ExpectedCellValue(sheetName, 134, 4, 1d),
					new ExpectedCellValue(sheetName, 135, 4, 24.99),
					new ExpectedCellValue(sheetName, 136, 4, 3d),
					new ExpectedCellValue(sheetName, 137, 4, 856.49),
					new ExpectedCellValue(sheetName, 138, 4, null),
					new ExpectedCellValue(sheetName, 139, 4, null),
					new ExpectedCellValue(sheetName, 140, 4, null),
					new ExpectedCellValue(sheetName, 141, 4, 2d),
					new ExpectedCellValue(sheetName, 142, 4, null),
					new ExpectedCellValue(sheetName, 143, 4, 831.5),
					new ExpectedCellValue(sheetName, 144, 4, 2d),
					new ExpectedCellValue(sheetName, 145, 4, 831.5),
					new ExpectedCellValue(sheetName, 146, 4, null),
					new ExpectedCellValue(sheetName, 147, 4, null),
					new ExpectedCellValue(sheetName, 148, 4, 6d),
					new ExpectedCellValue(sheetName, 149, 4, null),
					new ExpectedCellValue(sheetName, 150, 4, 1194d),
					new ExpectedCellValue(sheetName, 151, 4, 6d),
					new ExpectedCellValue(sheetName, 152, 4, 1194d),
					new ExpectedCellValue(sheetName, 153, 4, null),
					new ExpectedCellValue(sheetName, 154, 4, null),
					new ExpectedCellValue(sheetName, 155, 4, 2d),
					new ExpectedCellValue(sheetName, 156, 4, null),
					new ExpectedCellValue(sheetName, 157, 4, 831.5),
					new ExpectedCellValue(sheetName, 158, 4, 2d),
					new ExpectedCellValue(sheetName, 159, 4, 831.5),
					new ExpectedCellValue(sheetName, 160, 4, 10d),
					new ExpectedCellValue(sheetName, 161, 4, 2857d),
					new ExpectedCellValue(sheetName, 162, 4, null),
					new ExpectedCellValue(sheetName, 163, 4, null),
					new ExpectedCellValue(sheetName, 164, 4, null),
					new ExpectedCellValue(sheetName, 165, 4, 1d),
					new ExpectedCellValue(sheetName, 166, 4, null),
					new ExpectedCellValue(sheetName, 167, 4, 415.75),
					new ExpectedCellValue(sheetName, 168, 4, 1d),
					new ExpectedCellValue(sheetName, 169, 4, 415.75),
					new ExpectedCellValue(sheetName, 170, 4, null),
					new ExpectedCellValue(sheetName, 171, 4, null),
					new ExpectedCellValue(sheetName, 172, 4, 1d),
					new ExpectedCellValue(sheetName, 173, 4, null),
					new ExpectedCellValue(sheetName, 174, 4, 99d),
					new ExpectedCellValue(sheetName, 175, 4, 1d),
					new ExpectedCellValue(sheetName, 176, 4, 99d),
					new ExpectedCellValue(sheetName, 177, 4, 2d),
					new ExpectedCellValue(sheetName, 178, 4, 514.75),
					new ExpectedCellValue(sheetName, 179, 4, 15d),
					new ExpectedCellValue(sheetName, 180, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldFirstAndSecondFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G120:J180"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 7, null),
					new ExpectedCellValue(sheetName, 123, 7, null),
					new ExpectedCellValue(sheetName, 124, 7, null),
					new ExpectedCellValue(sheetName, 125, 7, null),
					new ExpectedCellValue(sheetName, 126, 7, null),
					new ExpectedCellValue(sheetName, 127, 7, null),
					new ExpectedCellValue(sheetName, 128, 7, null),
					new ExpectedCellValue(sheetName, 129, 7, null),
					new ExpectedCellValue(sheetName, 130, 7, null),
					new ExpectedCellValue(sheetName, 131, 7, null),
					new ExpectedCellValue(sheetName, 132, 7, null),
					new ExpectedCellValue(sheetName, 133, 7, null),
					new ExpectedCellValue(sheetName, 134, 7, null),
					new ExpectedCellValue(sheetName, 135, 7, null),
					new ExpectedCellValue(sheetName, 136, 7, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 137, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 138, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 139, 7, null),
					new ExpectedCellValue(sheetName, 140, 7, null),
					new ExpectedCellValue(sheetName, 141, 7, null),
					new ExpectedCellValue(sheetName, 142, 7, null),
					new ExpectedCellValue(sheetName, 143, 7, null),
					new ExpectedCellValue(sheetName, 144, 7, null),
					new ExpectedCellValue(sheetName, 145, 7, null),
					new ExpectedCellValue(sheetName, 146, 7, null),
					new ExpectedCellValue(sheetName, 147, 7, null),
					new ExpectedCellValue(sheetName, 148, 7, null),
					new ExpectedCellValue(sheetName, 149, 7, null),
					new ExpectedCellValue(sheetName, 150, 7, null),
					new ExpectedCellValue(sheetName, 151, 7, null),
					new ExpectedCellValue(sheetName, 152, 7, null),
					new ExpectedCellValue(sheetName, 153, 7, null),
					new ExpectedCellValue(sheetName, 154, 7, null),
					new ExpectedCellValue(sheetName, 155, 7, null),
					new ExpectedCellValue(sheetName, 156, 7, null),
					new ExpectedCellValue(sheetName, 157, 7, null),
					new ExpectedCellValue(sheetName, 158, 7, null),
					new ExpectedCellValue(sheetName, 159, 7, null),
					new ExpectedCellValue(sheetName, 160, 7, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 161, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 162, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 163, 7, null),
					new ExpectedCellValue(sheetName, 164, 7, null),
					new ExpectedCellValue(sheetName, 165, 7, null),
					new ExpectedCellValue(sheetName, 166, 7, null),
					new ExpectedCellValue(sheetName, 167, 7, null),
					new ExpectedCellValue(sheetName, 168, 7, null),
					new ExpectedCellValue(sheetName, 169, 7, null),
					new ExpectedCellValue(sheetName, 170, 7, null),
					new ExpectedCellValue(sheetName, 171, 7, null),
					new ExpectedCellValue(sheetName, 172, 7, null),
					new ExpectedCellValue(sheetName, 173, 7, null),
					new ExpectedCellValue(sheetName, 174, 7, null),
					new ExpectedCellValue(sheetName, 175, 7, null),
					new ExpectedCellValue(sheetName, 176, 7, null),
					new ExpectedCellValue(sheetName, 177, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 178, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 180, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 8, "Month"),
					new ExpectedCellValue(sheetName, 121, 8, null),
					new ExpectedCellValue(sheetName, 122, 8, "January"),
					new ExpectedCellValue(sheetName, 123, 8, null),
					new ExpectedCellValue(sheetName, 124, 8, null),
					new ExpectedCellValue(sheetName, 125, 8, null),
					new ExpectedCellValue(sheetName, 126, 8, null),
					new ExpectedCellValue(sheetName, 127, 8, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 128, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 129, 8, "March"),
					new ExpectedCellValue(sheetName, 130, 8, null),
					new ExpectedCellValue(sheetName, 131, 8, null),
					new ExpectedCellValue(sheetName, 132, 8, null),
					new ExpectedCellValue(sheetName, 133, 8, null),
					new ExpectedCellValue(sheetName, 134, 8, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 135, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 8, null),
					new ExpectedCellValue(sheetName, 137, 8, null),
					new ExpectedCellValue(sheetName, 138, 8, null),
					new ExpectedCellValue(sheetName, 139, 8, "January"),
					new ExpectedCellValue(sheetName, 140, 8, null),
					new ExpectedCellValue(sheetName, 141, 8, null),
					new ExpectedCellValue(sheetName, 142, 8, null),
					new ExpectedCellValue(sheetName, 143, 8, null),
					new ExpectedCellValue(sheetName, 144, 8, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 145, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 8, "February"),
					new ExpectedCellValue(sheetName, 147, 8, null),
					new ExpectedCellValue(sheetName, 148, 8, null),
					new ExpectedCellValue(sheetName, 149, 8, null),
					new ExpectedCellValue(sheetName, 150, 8, null),
					new ExpectedCellValue(sheetName, 151, 8, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 152, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 153, 8, "March"),
					new ExpectedCellValue(sheetName, 154, 8, null),
					new ExpectedCellValue(sheetName, 155, 8, null),
					new ExpectedCellValue(sheetName, 156, 8, null),
					new ExpectedCellValue(sheetName, 157, 8, null),
					new ExpectedCellValue(sheetName, 158, 8, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 159, 8, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 8, null),
					new ExpectedCellValue(sheetName, 161, 8, null),
					new ExpectedCellValue(sheetName, 162, 8, null),
					new ExpectedCellValue(sheetName, 163, 8, "January"),
					new ExpectedCellValue(sheetName, 164, 8, null),
					new ExpectedCellValue(sheetName, 165, 8, null),
					new ExpectedCellValue(sheetName, 166, 8, null),
					new ExpectedCellValue(sheetName, 167, 8, null),
					new ExpectedCellValue(sheetName, 168, 8, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 169, 8, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 8, "February"),
					new ExpectedCellValue(sheetName, 171, 8, null),
					new ExpectedCellValue(sheetName, 172, 8, null),
					new ExpectedCellValue(sheetName, 173, 8, null),
					new ExpectedCellValue(sheetName, 174, 8, null),
					new ExpectedCellValue(sheetName, 175, 8, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 176, 8, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 177, 8, null),
					new ExpectedCellValue(sheetName, 178, 8, null),
					new ExpectedCellValue(sheetName, 179, 8, null),
					new ExpectedCellValue(sheetName, 180, 8, null),
					new ExpectedCellValue(sheetName, 120, 9, "Values"),
					new ExpectedCellValue(sheetName, 121, 9, null),
					new ExpectedCellValue(sheetName, 122, 9, null),
					new ExpectedCellValue(sheetName, 123, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 124, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 125, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 9, null),
					new ExpectedCellValue(sheetName, 128, 9, null),
					new ExpectedCellValue(sheetName, 129, 9, null),
					new ExpectedCellValue(sheetName, 130, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 131, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 132, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 134, 9, null),
					new ExpectedCellValue(sheetName, 135, 9, null),
					new ExpectedCellValue(sheetName, 136, 9, null),
					new ExpectedCellValue(sheetName, 137, 9, null),
					new ExpectedCellValue(sheetName, 138, 9, null),
					new ExpectedCellValue(sheetName, 139, 9, null),
					new ExpectedCellValue(sheetName, 140, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 141, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 9, null),
					new ExpectedCellValue(sheetName, 145, 9, null),
					new ExpectedCellValue(sheetName, 146, 9, null),
					new ExpectedCellValue(sheetName, 147, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 148, 9, "Tent"),
					new ExpectedCellValue(sheetName, 149, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 150, 9, "Tent"),
					new ExpectedCellValue(sheetName, 151, 9, null),
					new ExpectedCellValue(sheetName, 152, 9, null),
					new ExpectedCellValue(sheetName, 153, 9, null),
					new ExpectedCellValue(sheetName, 154, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 155, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 156, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 158, 9, null),
					new ExpectedCellValue(sheetName, 159, 9, null),
					new ExpectedCellValue(sheetName, 160, 9, null),
					new ExpectedCellValue(sheetName, 161, 9, null),
					new ExpectedCellValue(sheetName, 162, 9, null),
					new ExpectedCellValue(sheetName, 163, 9, null),
					new ExpectedCellValue(sheetName, 164, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 165, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 166, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 168, 9, null),
					new ExpectedCellValue(sheetName, 169, 9, null),
					new ExpectedCellValue(sheetName, 170, 9, null),
					new ExpectedCellValue(sheetName, 171, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 172, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 173, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 174, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 175, 9, null),
					new ExpectedCellValue(sheetName, 176, 9, null),
					new ExpectedCellValue(sheetName, 177, 9, null),
					new ExpectedCellValue(sheetName, 178, 9, null),
					new ExpectedCellValue(sheetName, 179, 9, null),
					new ExpectedCellValue(sheetName, 180, 9, null),
					new ExpectedCellValue(sheetName, 120, 10, null),
					new ExpectedCellValue(sheetName, 121, 10, null),
					new ExpectedCellValue(sheetName, 122, 10, null),
					new ExpectedCellValue(sheetName, 123, 10, null),
					new ExpectedCellValue(sheetName, 124, 10, 2d),
					new ExpectedCellValue(sheetName, 125, 10, null),
					new ExpectedCellValue(sheetName, 126, 10, 831.5),
					new ExpectedCellValue(sheetName, 127, 10, 2d),
					new ExpectedCellValue(sheetName, 128, 10, 831.5),
					new ExpectedCellValue(sheetName, 129, 10, null),
					new ExpectedCellValue(sheetName, 130, 10, null),
					new ExpectedCellValue(sheetName, 131, 10, 1d),
					new ExpectedCellValue(sheetName, 132, 10, null),
					new ExpectedCellValue(sheetName, 133, 10, 24.99),
					new ExpectedCellValue(sheetName, 134, 10, 1d),
					new ExpectedCellValue(sheetName, 135, 10, 24.99),
					new ExpectedCellValue(sheetName, 136, 10, 3d),
					new ExpectedCellValue(sheetName, 137, 10, 856.49),
					new ExpectedCellValue(sheetName, 138, 10, null),
					new ExpectedCellValue(sheetName, 139, 10, null),
					new ExpectedCellValue(sheetName, 140, 10, null),
					new ExpectedCellValue(sheetName, 141, 10, 2d),
					new ExpectedCellValue(sheetName, 142, 10, null),
					new ExpectedCellValue(sheetName, 143, 10, 831.5),
					new ExpectedCellValue(sheetName, 144, 10, 2d),
					new ExpectedCellValue(sheetName, 145, 10, 831.5),
					new ExpectedCellValue(sheetName, 146, 10, null),
					new ExpectedCellValue(sheetName, 147, 10, null),
					new ExpectedCellValue(sheetName, 148, 10, 6d),
					new ExpectedCellValue(sheetName, 149, 10, null),
					new ExpectedCellValue(sheetName, 150, 10, 1194d),
					new ExpectedCellValue(sheetName, 151, 10, 6d),
					new ExpectedCellValue(sheetName, 152, 10, 1194d),
					new ExpectedCellValue(sheetName, 153, 10, null),
					new ExpectedCellValue(sheetName, 154, 10, null),
					new ExpectedCellValue(sheetName, 155, 10, 2d),
					new ExpectedCellValue(sheetName, 156, 10, null),
					new ExpectedCellValue(sheetName, 157, 10, 831.5),
					new ExpectedCellValue(sheetName, 158, 10, 2d),
					new ExpectedCellValue(sheetName, 159, 10, 831.5),
					new ExpectedCellValue(sheetName, 160, 10, 10d),
					new ExpectedCellValue(sheetName, 161, 10, 2857d),
					new ExpectedCellValue(sheetName, 162, 10, null),
					new ExpectedCellValue(sheetName, 163, 10, null),
					new ExpectedCellValue(sheetName, 164, 10, null),
					new ExpectedCellValue(sheetName, 165, 10, 1d),
					new ExpectedCellValue(sheetName, 166, 10, null),
					new ExpectedCellValue(sheetName, 167, 10, 415.75),
					new ExpectedCellValue(sheetName, 168, 10, 1d),
					new ExpectedCellValue(sheetName, 169, 10, 415.75),
					new ExpectedCellValue(sheetName, 170, 10, null),
					new ExpectedCellValue(sheetName, 171, 10, null),
					new ExpectedCellValue(sheetName, 172, 10, 1d),
					new ExpectedCellValue(sheetName, 173, 10, null),
					new ExpectedCellValue(sheetName, 174, 10, 99d),
					new ExpectedCellValue(sheetName, 175, 10, 1d),
					new ExpectedCellValue(sheetName, 176, 10, 99d),
					new ExpectedCellValue(sheetName, 177, 10, 2d),
					new ExpectedCellValue(sheetName, 178, 10, 514.75),
					new ExpectedCellValue(sheetName, 179, 10, 15d),
					new ExpectedCellValue(sheetName, 180, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldFirstAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L120:N180"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 12, null),
					new ExpectedCellValue(sheetName, 123, 12, null),
					new ExpectedCellValue(sheetName, 124, 12, null),
					new ExpectedCellValue(sheetName, 125, 12, null),
					new ExpectedCellValue(sheetName, 126, 12, null),
					new ExpectedCellValue(sheetName, 127, 12, null),
					new ExpectedCellValue(sheetName, 128, 12, null),
					new ExpectedCellValue(sheetName, 129, 12, null),
					new ExpectedCellValue(sheetName, 130, 12, null),
					new ExpectedCellValue(sheetName, 131, 12, null),
					new ExpectedCellValue(sheetName, 132, 12, null),
					new ExpectedCellValue(sheetName, 133, 12, null),
					new ExpectedCellValue(sheetName, 134, 12, null),
					new ExpectedCellValue(sheetName, 135, 12, null),
					new ExpectedCellValue(sheetName, 136, 12, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 137, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 138, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 139, 12, null),
					new ExpectedCellValue(sheetName, 140, 12, null),
					new ExpectedCellValue(sheetName, 141, 12, null),
					new ExpectedCellValue(sheetName, 142, 12, null),
					new ExpectedCellValue(sheetName, 143, 12, null),
					new ExpectedCellValue(sheetName, 144, 12, null),
					new ExpectedCellValue(sheetName, 145, 12, null),
					new ExpectedCellValue(sheetName, 146, 12, null),
					new ExpectedCellValue(sheetName, 147, 12, null),
					new ExpectedCellValue(sheetName, 148, 12, null),
					new ExpectedCellValue(sheetName, 149, 12, null),
					new ExpectedCellValue(sheetName, 150, 12, null),
					new ExpectedCellValue(sheetName, 151, 12, null),
					new ExpectedCellValue(sheetName, 152, 12, null),
					new ExpectedCellValue(sheetName, 153, 12, null),
					new ExpectedCellValue(sheetName, 154, 12, null),
					new ExpectedCellValue(sheetName, 155, 12, null),
					new ExpectedCellValue(sheetName, 156, 12, null),
					new ExpectedCellValue(sheetName, 157, 12, null),
					new ExpectedCellValue(sheetName, 158, 12, null),
					new ExpectedCellValue(sheetName, 159, 12, null),
					new ExpectedCellValue(sheetName, 160, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 161, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 162, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 163, 12, null),
					new ExpectedCellValue(sheetName, 164, 12, null),
					new ExpectedCellValue(sheetName, 165, 12, null),
					new ExpectedCellValue(sheetName, 166, 12, null),
					new ExpectedCellValue(sheetName, 167, 12, null),
					new ExpectedCellValue(sheetName, 168, 12, null),
					new ExpectedCellValue(sheetName, 169, 12, null),
					new ExpectedCellValue(sheetName, 170, 12, null),
					new ExpectedCellValue(sheetName, 171, 12, null),
					new ExpectedCellValue(sheetName, 172, 12, null),
					new ExpectedCellValue(sheetName, 173, 12, null),
					new ExpectedCellValue(sheetName, 174, 12, null),
					new ExpectedCellValue(sheetName, 175, 12, null),
					new ExpectedCellValue(sheetName, 176, 12, null),
					new ExpectedCellValue(sheetName, 177, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 178, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 180, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 13, "Month"),
					new ExpectedCellValue(sheetName, 121, 13, null),
					new ExpectedCellValue(sheetName, 122, 13, "January"),
					new ExpectedCellValue(sheetName, 123, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 124, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 125, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 13, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 128, 13, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 129, 13, "March"),
					new ExpectedCellValue(sheetName, 130, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 131, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 132, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 134, 13, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 135, 13, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 13, null),
					new ExpectedCellValue(sheetName, 137, 13, null),
					new ExpectedCellValue(sheetName, 138, 13, null),
					new ExpectedCellValue(sheetName, 139, 13, "January"),
					new ExpectedCellValue(sheetName, 140, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 141, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 13, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 145, 13, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 13, "February"),
					new ExpectedCellValue(sheetName, 147, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 148, 13, "Tent"),
					new ExpectedCellValue(sheetName, 149, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 150, 13, "Tent"),
					new ExpectedCellValue(sheetName, 151, 13, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 152, 13, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 153, 13, "March"),
					new ExpectedCellValue(sheetName, 154, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 155, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 156, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 158, 13, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 159, 13, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 13, null),
					new ExpectedCellValue(sheetName, 161, 13, null),
					new ExpectedCellValue(sheetName, 162, 13, null),
					new ExpectedCellValue(sheetName, 163, 13, "January"),
					new ExpectedCellValue(sheetName, 164, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 165, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 166, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 168, 13, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 169, 13, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 13, "February"),
					new ExpectedCellValue(sheetName, 171, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 172, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 173, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 174, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 175, 13, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 176, 13, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 177, 13, null),
					new ExpectedCellValue(sheetName, 178, 13, null),
					new ExpectedCellValue(sheetName, 179, 13, null),
					new ExpectedCellValue(sheetName, 180, 13, null),
					new ExpectedCellValue(sheetName, 120, 14, null),
					new ExpectedCellValue(sheetName, 121, 14, null),
					new ExpectedCellValue(sheetName, 122, 14, null),
					new ExpectedCellValue(sheetName, 123, 14, null),
					new ExpectedCellValue(sheetName, 124, 14, 2d),
					new ExpectedCellValue(sheetName, 125, 14, null),
					new ExpectedCellValue(sheetName, 126, 14, 831.5),
					new ExpectedCellValue(sheetName, 127, 14, 2d),
					new ExpectedCellValue(sheetName, 128, 14, 831.5),
					new ExpectedCellValue(sheetName, 129, 14, null),
					new ExpectedCellValue(sheetName, 130, 14, null),
					new ExpectedCellValue(sheetName, 131, 14, 1d),
					new ExpectedCellValue(sheetName, 132, 14, null),
					new ExpectedCellValue(sheetName, 133, 14, 24.99),
					new ExpectedCellValue(sheetName, 134, 14, 1d),
					new ExpectedCellValue(sheetName, 135, 14, 24.99),
					new ExpectedCellValue(sheetName, 136, 14, 3d),
					new ExpectedCellValue(sheetName, 137, 14, 856.49),
					new ExpectedCellValue(sheetName, 138, 14, null),
					new ExpectedCellValue(sheetName, 139, 14, null),
					new ExpectedCellValue(sheetName, 140, 14, null),
					new ExpectedCellValue(sheetName, 141, 14, 2d),
					new ExpectedCellValue(sheetName, 142, 14, null),
					new ExpectedCellValue(sheetName, 143, 14, 831.5),
					new ExpectedCellValue(sheetName, 144, 14, 2d),
					new ExpectedCellValue(sheetName, 145, 14, 831.5),
					new ExpectedCellValue(sheetName, 146, 14, null),
					new ExpectedCellValue(sheetName, 147, 14, null),
					new ExpectedCellValue(sheetName, 148, 14, 6d),
					new ExpectedCellValue(sheetName, 149, 14, null),
					new ExpectedCellValue(sheetName, 150, 14, 1194d),
					new ExpectedCellValue(sheetName, 151, 14, 6d),
					new ExpectedCellValue(sheetName, 152, 14, 1194d),
					new ExpectedCellValue(sheetName, 153, 14, null),
					new ExpectedCellValue(sheetName, 154, 14, null),
					new ExpectedCellValue(sheetName, 155, 14, 2d),
					new ExpectedCellValue(sheetName, 156, 14, null),
					new ExpectedCellValue(sheetName, 157, 14, 831.5),
					new ExpectedCellValue(sheetName, 158, 14, 2d),
					new ExpectedCellValue(sheetName, 159, 14, 831.5),
					new ExpectedCellValue(sheetName, 160, 14, 10d),
					new ExpectedCellValue(sheetName, 161, 14, 2857d),
					new ExpectedCellValue(sheetName, 162, 14, null),
					new ExpectedCellValue(sheetName, 163, 14, null),
					new ExpectedCellValue(sheetName, 164, 14, null),
					new ExpectedCellValue(sheetName, 165, 14, 1d),
					new ExpectedCellValue(sheetName, 166, 14, null),
					new ExpectedCellValue(sheetName, 167, 14, 415.75),
					new ExpectedCellValue(sheetName, 168, 14, 1d),
					new ExpectedCellValue(sheetName, 169, 14, 415.75),
					new ExpectedCellValue(sheetName, 170, 14, null),
					new ExpectedCellValue(sheetName, 171, 14, null),
					new ExpectedCellValue(sheetName, 172, 14, 1d),
					new ExpectedCellValue(sheetName, 173, 14, null),
					new ExpectedCellValue(sheetName, 174, 14, 99d),
					new ExpectedCellValue(sheetName, 175, 14, 1d),
					new ExpectedCellValue(sheetName, 176, 14, 99d),
					new ExpectedCellValue(sheetName, 177, 14, 2d),
					new ExpectedCellValue(sheetName, 178, 14, 514.75),
					new ExpectedCellValue(sheetName, 179, 14, 15d),
					new ExpectedCellValue(sheetName, 180, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q120:S180"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 17, null),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, null),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, null),
					new ExpectedCellValue(sheetName, 127, 17, null),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, null),
					new ExpectedCellValue(sheetName, 131, 17, null),
					new ExpectedCellValue(sheetName, 132, 17, null),
					new ExpectedCellValue(sheetName, 133, 17, null),
					new ExpectedCellValue(sheetName, 134, 17, null),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 137, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 138, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 139, 17, null),
					new ExpectedCellValue(sheetName, 140, 17, null),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, null),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, null),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, null),
					new ExpectedCellValue(sheetName, 147, 17, null),
					new ExpectedCellValue(sheetName, 148, 17, null),
					new ExpectedCellValue(sheetName, 149, 17, null),
					new ExpectedCellValue(sheetName, 150, 17, null),
					new ExpectedCellValue(sheetName, 151, 17, null),
					new ExpectedCellValue(sheetName, 152, 17, null),
					new ExpectedCellValue(sheetName, 153, 17, null),
					new ExpectedCellValue(sheetName, 154, 17, null),
					new ExpectedCellValue(sheetName, 155, 17, null),
					new ExpectedCellValue(sheetName, 156, 17, null),
					new ExpectedCellValue(sheetName, 157, 17, null),
					new ExpectedCellValue(sheetName, 158, 17, null),
					new ExpectedCellValue(sheetName, 159, 17, null),
					new ExpectedCellValue(sheetName, 160, 17, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 161, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 162, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 163, 17, null),
					new ExpectedCellValue(sheetName, 164, 17, null),
					new ExpectedCellValue(sheetName, 165, 17, null),
					new ExpectedCellValue(sheetName, 166, 17, null),
					new ExpectedCellValue(sheetName, 167, 17, null),
					new ExpectedCellValue(sheetName, 168, 17, null),
					new ExpectedCellValue(sheetName, 169, 17, null),
					new ExpectedCellValue(sheetName, 170, 17, null),
					new ExpectedCellValue(sheetName, 171, 17, null),
					new ExpectedCellValue(sheetName, 172, 17, null),
					new ExpectedCellValue(sheetName, 173, 17, null),
					new ExpectedCellValue(sheetName, 174, 17, null),
					new ExpectedCellValue(sheetName, 175, 17, null),
					new ExpectedCellValue(sheetName, 176, 17, null),
					new ExpectedCellValue(sheetName, 177, 17, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 178, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 17, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 180, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 18, "Month"),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "January"),
					new ExpectedCellValue(sheetName, 123, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 124, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 125, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 18, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 128, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 129, 18, "March"),
					new ExpectedCellValue(sheetName, 130, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 131, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 132, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 134, 18, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 135, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 18, null),
					new ExpectedCellValue(sheetName, 137, 18, null),
					new ExpectedCellValue(sheetName, 138, 18, null),
					new ExpectedCellValue(sheetName, 139, 18, "January"),
					new ExpectedCellValue(sheetName, 140, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 141, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 144, 18, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 145, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 18, "February"),
					new ExpectedCellValue(sheetName, 147, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 148, 18, "Tent"),
					new ExpectedCellValue(sheetName, 149, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 150, 18, "Tent"),
					new ExpectedCellValue(sheetName, 151, 18, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 152, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 153, 18, "March"),
					new ExpectedCellValue(sheetName, 154, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 155, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 156, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 158, 18, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 159, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 18, null),
					new ExpectedCellValue(sheetName, 161, 18, null),
					new ExpectedCellValue(sheetName, 162, 18, null),
					new ExpectedCellValue(sheetName, 163, 18, "January"),
					new ExpectedCellValue(sheetName, 164, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 165, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 166, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 168, 18, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 169, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 18, "February"),
					new ExpectedCellValue(sheetName, 171, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 172, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 173, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 174, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 175, 18, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 176, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 177, 18, null),
					new ExpectedCellValue(sheetName, 178, 18, null),
					new ExpectedCellValue(sheetName, 179, 18, null),
					new ExpectedCellValue(sheetName, 180, 18, null),
					new ExpectedCellValue(sheetName, 120, 19, null),
					new ExpectedCellValue(sheetName, 121, 19, null),
					new ExpectedCellValue(sheetName, 122, 19, null),
					new ExpectedCellValue(sheetName, 123, 19, null),
					new ExpectedCellValue(sheetName, 124, 19, 2d),
					new ExpectedCellValue(sheetName, 125, 19, null),
					new ExpectedCellValue(sheetName, 126, 19, 831.5),
					new ExpectedCellValue(sheetName, 127, 19, 2d),
					new ExpectedCellValue(sheetName, 128, 19, 831.5),
					new ExpectedCellValue(sheetName, 129, 19, null),
					new ExpectedCellValue(sheetName, 130, 19, null),
					new ExpectedCellValue(sheetName, 131, 19, 1d),
					new ExpectedCellValue(sheetName, 132, 19, null),
					new ExpectedCellValue(sheetName, 133, 19, 24.99),
					new ExpectedCellValue(sheetName, 134, 19, 1d),
					new ExpectedCellValue(sheetName, 135, 19, 24.99),
					new ExpectedCellValue(sheetName, 136, 19, 3d),
					new ExpectedCellValue(sheetName, 137, 19, 856.49),
					new ExpectedCellValue(sheetName, 138, 19, null),
					new ExpectedCellValue(sheetName, 139, 19, null),
					new ExpectedCellValue(sheetName, 140, 19, null),
					new ExpectedCellValue(sheetName, 141, 19, 2d),
					new ExpectedCellValue(sheetName, 142, 19, null),
					new ExpectedCellValue(sheetName, 143, 19, 831.5),
					new ExpectedCellValue(sheetName, 144, 19, 2d),
					new ExpectedCellValue(sheetName, 145, 19, 831.5),
					new ExpectedCellValue(sheetName, 146, 19, null),
					new ExpectedCellValue(sheetName, 147, 19, null),
					new ExpectedCellValue(sheetName, 148, 19, 6d),
					new ExpectedCellValue(sheetName, 149, 19, null),
					new ExpectedCellValue(sheetName, 150, 19, 1194d),
					new ExpectedCellValue(sheetName, 151, 19, 6d),
					new ExpectedCellValue(sheetName, 152, 19, 1194d),
					new ExpectedCellValue(sheetName, 153, 19, null),
					new ExpectedCellValue(sheetName, 154, 19, null),
					new ExpectedCellValue(sheetName, 155, 19, 2d),
					new ExpectedCellValue(sheetName, 156, 19, null),
					new ExpectedCellValue(sheetName, 157, 19, 831.5),
					new ExpectedCellValue(sheetName, 158, 19, 2d),
					new ExpectedCellValue(sheetName, 159, 19, 831.5),
					new ExpectedCellValue(sheetName, 160, 19, 10d),
					new ExpectedCellValue(sheetName, 161, 19, 2857d),
					new ExpectedCellValue(sheetName, 162, 19, null),
					new ExpectedCellValue(sheetName, 163, 19, null),
					new ExpectedCellValue(sheetName, 164, 19, null),
					new ExpectedCellValue(sheetName, 165, 19, 1d),
					new ExpectedCellValue(sheetName, 166, 19, null),
					new ExpectedCellValue(sheetName, 167, 19, 415.75),
					new ExpectedCellValue(sheetName, 168, 19, 1d),
					new ExpectedCellValue(sheetName, 169, 19, 415.75),
					new ExpectedCellValue(sheetName, 170, 19, null),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, 1d),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 174, 19, 99d),
					new ExpectedCellValue(sheetName, 175, 19, 1d),
					new ExpectedCellValue(sheetName, 176, 19, 99d),
					new ExpectedCellValue(sheetName, 177, 19, 2d),
					new ExpectedCellValue(sheetName, 178, 19, 514.75),
					new ExpectedCellValue(sheetName, 179, 19, 15d),
					new ExpectedCellValue(sheetName, 180, 19, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldSecondAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A186:C246"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 186, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 187, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 188, 1, "January"),
					new ExpectedCellValue(sheetName, 189, 1, null),
					new ExpectedCellValue(sheetName, 190, 1, null),
					new ExpectedCellValue(sheetName, 191, 1, null),
					new ExpectedCellValue(sheetName, 192, 1, null),
					new ExpectedCellValue(sheetName, 193, 1, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 194, 1, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 1, "March"),
					new ExpectedCellValue(sheetName, 196, 1, null),
					new ExpectedCellValue(sheetName, 197, 1, null),
					new ExpectedCellValue(sheetName, 198, 1, null),
					new ExpectedCellValue(sheetName, 199, 1, null),
					new ExpectedCellValue(sheetName, 200, 1, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 201, 1, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 203, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 204, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 205, 1, "January"),
					new ExpectedCellValue(sheetName, 206, 1, null),
					new ExpectedCellValue(sheetName, 207, 1, null),
					new ExpectedCellValue(sheetName, 208, 1, null),
					new ExpectedCellValue(sheetName, 209, 1, null),
					new ExpectedCellValue(sheetName, 210, 1, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 211, 1, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 212, 1, "February"),
					new ExpectedCellValue(sheetName, 213, 1, null),
					new ExpectedCellValue(sheetName, 214, 1, null),
					new ExpectedCellValue(sheetName, 215, 1, null),
					new ExpectedCellValue(sheetName, 216, 1, null),
					new ExpectedCellValue(sheetName, 217, 1, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 218, 1, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 219, 1, "March"),
					new ExpectedCellValue(sheetName, 220, 1, null),
					new ExpectedCellValue(sheetName, 221, 1, null),
					new ExpectedCellValue(sheetName, 222, 1, null),
					new ExpectedCellValue(sheetName, 223, 1, null),
					new ExpectedCellValue(sheetName, 224, 1, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 225, 1, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 227, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 228, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 229, 1, "January"),
					new ExpectedCellValue(sheetName, 230, 1, null),
					new ExpectedCellValue(sheetName, 231, 1, null),
					new ExpectedCellValue(sheetName, 232, 1, null),
					new ExpectedCellValue(sheetName, 233, 1, null),
					new ExpectedCellValue(sheetName, 234, 1, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 235, 1, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 236, 1, "February"),
					new ExpectedCellValue(sheetName, 237, 1, null),
					new ExpectedCellValue(sheetName, 238, 1, null),
					new ExpectedCellValue(sheetName, 239, 1, null),
					new ExpectedCellValue(sheetName, 240, 1, null),
					new ExpectedCellValue(sheetName, 241, 1, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 242, 1, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 243, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 244, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 245, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 246, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 186, 2, "Values"),
					new ExpectedCellValue(sheetName, 187, 2, null),
					new ExpectedCellValue(sheetName, 188, 2, null),
					new ExpectedCellValue(sheetName, 189, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 190, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 191, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 193, 2, null),
					new ExpectedCellValue(sheetName, 194, 2, null),
					new ExpectedCellValue(sheetName, 195, 2, null),
					new ExpectedCellValue(sheetName, 196, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 197, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 198, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 200, 2, null),
					new ExpectedCellValue(sheetName, 201, 2, null),
					new ExpectedCellValue(sheetName, 202, 2, null),
					new ExpectedCellValue(sheetName, 203, 2, null),
					new ExpectedCellValue(sheetName, 204, 2, null),
					new ExpectedCellValue(sheetName, 205, 2, null),
					new ExpectedCellValue(sheetName, 206, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 207, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 208, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 209, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 2, null),
					new ExpectedCellValue(sheetName, 211, 2, null),
					new ExpectedCellValue(sheetName, 212, 2, null),
					new ExpectedCellValue(sheetName, 213, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 214, 2, "Tent"),
					new ExpectedCellValue(sheetName, 215, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 2, "Tent"),
					new ExpectedCellValue(sheetName, 217, 2, null),
					new ExpectedCellValue(sheetName, 218, 2, null),
					new ExpectedCellValue(sheetName, 219, 2, null),
					new ExpectedCellValue(sheetName, 220, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 221, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 222, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 224, 2, null),
					new ExpectedCellValue(sheetName, 225, 2, null),
					new ExpectedCellValue(sheetName, 226, 2, null),
					new ExpectedCellValue(sheetName, 227, 2, null),
					new ExpectedCellValue(sheetName, 228, 2, null),
					new ExpectedCellValue(sheetName, 229, 2, null),
					new ExpectedCellValue(sheetName, 230, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 231, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 232, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 233, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 234, 2, null),
					new ExpectedCellValue(sheetName, 235, 2, null),
					new ExpectedCellValue(sheetName, 236, 2, null),
					new ExpectedCellValue(sheetName, 237, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 238, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 239, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 240, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 241, 2, null),
					new ExpectedCellValue(sheetName, 242, 2, null),
					new ExpectedCellValue(sheetName, 243, 2, null),
					new ExpectedCellValue(sheetName, 244, 2, null),
					new ExpectedCellValue(sheetName, 245, 2, null),
					new ExpectedCellValue(sheetName, 246, 2, null),
					new ExpectedCellValue(sheetName, 186, 3, null),
					new ExpectedCellValue(sheetName, 187, 3, null),
					new ExpectedCellValue(sheetName, 188, 3, null),
					new ExpectedCellValue(sheetName, 189, 3, null),
					new ExpectedCellValue(sheetName, 190, 3, 2d),
					new ExpectedCellValue(sheetName, 191, 3, null),
					new ExpectedCellValue(sheetName, 192, 3, 831.5),
					new ExpectedCellValue(sheetName, 193, 3, 2d),
					new ExpectedCellValue(sheetName, 194, 3, 831.5),
					new ExpectedCellValue(sheetName, 195, 3, null),
					new ExpectedCellValue(sheetName, 196, 3, null),
					new ExpectedCellValue(sheetName, 197, 3, 1d),
					new ExpectedCellValue(sheetName, 198, 3, null),
					new ExpectedCellValue(sheetName, 199, 3, 24.99),
					new ExpectedCellValue(sheetName, 200, 3, 1d),
					new ExpectedCellValue(sheetName, 201, 3, 24.99),
					new ExpectedCellValue(sheetName, 202, 3, 3d),
					new ExpectedCellValue(sheetName, 203, 3, 856.49),
					new ExpectedCellValue(sheetName, 204, 3, null),
					new ExpectedCellValue(sheetName, 205, 3, null),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, 2d),
					new ExpectedCellValue(sheetName, 208, 3, null),
					new ExpectedCellValue(sheetName, 209, 3, 831.5),
					new ExpectedCellValue(sheetName, 210, 3, 2d),
					new ExpectedCellValue(sheetName, 211, 3, 831.5),
					new ExpectedCellValue(sheetName, 212, 3, null),
					new ExpectedCellValue(sheetName, 213, 3, null),
					new ExpectedCellValue(sheetName, 214, 3, 6d),
					new ExpectedCellValue(sheetName, 215, 3, null),
					new ExpectedCellValue(sheetName, 216, 3, 1194d),
					new ExpectedCellValue(sheetName, 217, 3, 6d),
					new ExpectedCellValue(sheetName, 218, 3, 1194d),
					new ExpectedCellValue(sheetName, 219, 3, null),
					new ExpectedCellValue(sheetName, 220, 3, null),
					new ExpectedCellValue(sheetName, 221, 3, 2d),
					new ExpectedCellValue(sheetName, 222, 3, null),
					new ExpectedCellValue(sheetName, 223, 3, 831.5),
					new ExpectedCellValue(sheetName, 224, 3, 2d),
					new ExpectedCellValue(sheetName, 225, 3, 831.5),
					new ExpectedCellValue(sheetName, 226, 3, 10d),
					new ExpectedCellValue(sheetName, 227, 3, 2857d),
					new ExpectedCellValue(sheetName, 228, 3, null),
					new ExpectedCellValue(sheetName, 229, 3, null),
					new ExpectedCellValue(sheetName, 230, 3, null),
					new ExpectedCellValue(sheetName, 231, 3, 1d),
					new ExpectedCellValue(sheetName, 232, 3, null),
					new ExpectedCellValue(sheetName, 233, 3, 415.75),
					new ExpectedCellValue(sheetName, 234, 3, 1d),
					new ExpectedCellValue(sheetName, 235, 3, 415.75),
					new ExpectedCellValue(sheetName, 236, 3, null),
					new ExpectedCellValue(sheetName, 237, 3, null),
					new ExpectedCellValue(sheetName, 238, 3, 1d),
					new ExpectedCellValue(sheetName, 239, 3, null),
					new ExpectedCellValue(sheetName, 240, 3, 99d),
					new ExpectedCellValue(sheetName, 241, 3, 1d),
					new ExpectedCellValue(sheetName, 242, 3, 99d),
					new ExpectedCellValue(sheetName, 243, 3, 2d),
					new ExpectedCellValue(sheetName, 244, 3, 514.75),
					new ExpectedCellValue(sheetName, 245, 3, 15d),
					new ExpectedCellValue(sheetName, 246, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldSecondFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G186:I246"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 186, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 187, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 188, 7, "January"),
					new ExpectedCellValue(sheetName, 189, 7, null),
					new ExpectedCellValue(sheetName, 190, 7, null),
					new ExpectedCellValue(sheetName, 191, 7, null),
					new ExpectedCellValue(sheetName, 192, 7, null),
					new ExpectedCellValue(sheetName, 193, 7, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 194, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 7, "March"),
					new ExpectedCellValue(sheetName, 196, 7, null),
					new ExpectedCellValue(sheetName, 197, 7, null),
					new ExpectedCellValue(sheetName, 198, 7, null),
					new ExpectedCellValue(sheetName, 199, 7, null),
					new ExpectedCellValue(sheetName, 200, 7, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 201, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 7, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 203, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 204, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 205, 7, "January"),
					new ExpectedCellValue(sheetName, 206, 7, null),
					new ExpectedCellValue(sheetName, 207, 7, null),
					new ExpectedCellValue(sheetName, 208, 7, null),
					new ExpectedCellValue(sheetName, 209, 7, null),
					new ExpectedCellValue(sheetName, 210, 7, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 211, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 212, 7, "February"),
					new ExpectedCellValue(sheetName, 213, 7, null),
					new ExpectedCellValue(sheetName, 214, 7, null),
					new ExpectedCellValue(sheetName, 215, 7, null),
					new ExpectedCellValue(sheetName, 216, 7, null),
					new ExpectedCellValue(sheetName, 217, 7, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 218, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 219, 7, "March"),
					new ExpectedCellValue(sheetName, 220, 7, null),
					new ExpectedCellValue(sheetName, 221, 7, null),
					new ExpectedCellValue(sheetName, 222, 7, null),
					new ExpectedCellValue(sheetName, 223, 7, null),
					new ExpectedCellValue(sheetName, 224, 7, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 225, 7, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 7, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 227, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 228, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 229, 7, "January"),
					new ExpectedCellValue(sheetName, 230, 7, null),
					new ExpectedCellValue(sheetName, 231, 7, null),
					new ExpectedCellValue(sheetName, 232, 7, null),
					new ExpectedCellValue(sheetName, 233, 7, null),
					new ExpectedCellValue(sheetName, 234, 7, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 235, 7, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 236, 7, "February"),
					new ExpectedCellValue(sheetName, 237, 7, null),
					new ExpectedCellValue(sheetName, 238, 7, null),
					new ExpectedCellValue(sheetName, 239, 7, null),
					new ExpectedCellValue(sheetName, 240, 7, null),
					new ExpectedCellValue(sheetName, 241, 7, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 242, 7, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 243, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 244, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 245, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 246, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 186, 8, "Values"),
					new ExpectedCellValue(sheetName, 187, 8, null),
					new ExpectedCellValue(sheetName, 188, 8, null),
					new ExpectedCellValue(sheetName, 189, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 190, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 191, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 193, 8, null),
					new ExpectedCellValue(sheetName, 194, 8, null),
					new ExpectedCellValue(sheetName, 195, 8, null),
					new ExpectedCellValue(sheetName, 196, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 197, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 198, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 200, 8, null),
					new ExpectedCellValue(sheetName, 201, 8, null),
					new ExpectedCellValue(sheetName, 202, 8, null),
					new ExpectedCellValue(sheetName, 203, 8, null),
					new ExpectedCellValue(sheetName, 204, 8, null),
					new ExpectedCellValue(sheetName, 205, 8, null),
					new ExpectedCellValue(sheetName, 206, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 207, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 208, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 209, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 8, null),
					new ExpectedCellValue(sheetName, 211, 8, null),
					new ExpectedCellValue(sheetName, 212, 8, null),
					new ExpectedCellValue(sheetName, 213, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 214, 8, "Tent"),
					new ExpectedCellValue(sheetName, 215, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 8, "Tent"),
					new ExpectedCellValue(sheetName, 217, 8, null),
					new ExpectedCellValue(sheetName, 218, 8, null),
					new ExpectedCellValue(sheetName, 219, 8, null),
					new ExpectedCellValue(sheetName, 220, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 221, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 222, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 224, 8, null),
					new ExpectedCellValue(sheetName, 225, 8, null),
					new ExpectedCellValue(sheetName, 226, 8, null),
					new ExpectedCellValue(sheetName, 227, 8, null),
					new ExpectedCellValue(sheetName, 228, 8, null),
					new ExpectedCellValue(sheetName, 229, 8, null),
					new ExpectedCellValue(sheetName, 230, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 231, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 232, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 233, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 234, 8, null),
					new ExpectedCellValue(sheetName, 235, 8, null),
					new ExpectedCellValue(sheetName, 236, 8, null),
					new ExpectedCellValue(sheetName, 237, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 238, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 239, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 240, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 241, 8, null),
					new ExpectedCellValue(sheetName, 242, 8, null),
					new ExpectedCellValue(sheetName, 243, 8, null),
					new ExpectedCellValue(sheetName, 244, 8, null),
					new ExpectedCellValue(sheetName, 245, 8, null),
					new ExpectedCellValue(sheetName, 246, 8, null),
					new ExpectedCellValue(sheetName, 186, 9, null),
					new ExpectedCellValue(sheetName, 187, 9, null),
					new ExpectedCellValue(sheetName, 188, 9, null),
					new ExpectedCellValue(sheetName, 189, 9, null),
					new ExpectedCellValue(sheetName, 190, 9, 2d),
					new ExpectedCellValue(sheetName, 191, 9, null),
					new ExpectedCellValue(sheetName, 192, 9, 831.5),
					new ExpectedCellValue(sheetName, 193, 9, 2d),
					new ExpectedCellValue(sheetName, 194, 9, 831.5),
					new ExpectedCellValue(sheetName, 195, 9, null),
					new ExpectedCellValue(sheetName, 196, 9, null),
					new ExpectedCellValue(sheetName, 197, 9, 1d),
					new ExpectedCellValue(sheetName, 198, 9, null),
					new ExpectedCellValue(sheetName, 199, 9, 24.99),
					new ExpectedCellValue(sheetName, 200, 9, 1d),
					new ExpectedCellValue(sheetName, 201, 9, 24.99),
					new ExpectedCellValue(sheetName, 202, 9, 3d),
					new ExpectedCellValue(sheetName, 203, 9, 856.49),
					new ExpectedCellValue(sheetName, 204, 9, null),
					new ExpectedCellValue(sheetName, 205, 9, null),
					new ExpectedCellValue(sheetName, 206, 9, null),
					new ExpectedCellValue(sheetName, 207, 9, 2d),
					new ExpectedCellValue(sheetName, 208, 9, null),
					new ExpectedCellValue(sheetName, 209, 9, 831.5),
					new ExpectedCellValue(sheetName, 210, 9, 2d),
					new ExpectedCellValue(sheetName, 211, 9, 831.5),
					new ExpectedCellValue(sheetName, 212, 9, null),
					new ExpectedCellValue(sheetName, 213, 9, null),
					new ExpectedCellValue(sheetName, 214, 9, 6d),
					new ExpectedCellValue(sheetName, 215, 9, null),
					new ExpectedCellValue(sheetName, 216, 9, 1194d),
					new ExpectedCellValue(sheetName, 217, 9, 6d),
					new ExpectedCellValue(sheetName, 218, 9, 1194d),
					new ExpectedCellValue(sheetName, 219, 9, null),
					new ExpectedCellValue(sheetName, 220, 9, null),
					new ExpectedCellValue(sheetName, 221, 9, 2d),
					new ExpectedCellValue(sheetName, 222, 9, null),
					new ExpectedCellValue(sheetName, 223, 9, 831.5),
					new ExpectedCellValue(sheetName, 224, 9, 2d),
					new ExpectedCellValue(sheetName, 225, 9, 831.5),
					new ExpectedCellValue(sheetName, 226, 9, 10d),
					new ExpectedCellValue(sheetName, 227, 9, 2857d),
					new ExpectedCellValue(sheetName, 228, 9, null),
					new ExpectedCellValue(sheetName, 229, 9, null),
					new ExpectedCellValue(sheetName, 230, 9, null),
					new ExpectedCellValue(sheetName, 231, 9, 1d),
					new ExpectedCellValue(sheetName, 232, 9, null),
					new ExpectedCellValue(sheetName, 233, 9, 415.75),
					new ExpectedCellValue(sheetName, 234, 9, 1d),
					new ExpectedCellValue(sheetName, 235, 9, 415.75),
					new ExpectedCellValue(sheetName, 236, 9, null),
					new ExpectedCellValue(sheetName, 237, 9, null),
					new ExpectedCellValue(sheetName, 238, 9, 1d),
					new ExpectedCellValue(sheetName, 239, 9, null),
					new ExpectedCellValue(sheetName, 240, 9, 99d),
					new ExpectedCellValue(sheetName, 241, 9, 1d),
					new ExpectedCellValue(sheetName, 242, 9, 99d),
					new ExpectedCellValue(sheetName, 243, 9, 2d),
					new ExpectedCellValue(sheetName, 244, 9, 514.75),
					new ExpectedCellValue(sheetName, 245, 9, 15d),
					new ExpectedCellValue(sheetName, 246, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsThirdFieldDataFieldLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L186:M246"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 186, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 187, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 188, 12, "January"),
					new ExpectedCellValue(sheetName, 189, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 190, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 191, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 193, 12, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 194, 12, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 12, "March"),
					new ExpectedCellValue(sheetName, 196, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 197, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 198, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 200, 12, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 201, 12, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 12, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 203, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 204, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 205, 12, "January"),
					new ExpectedCellValue(sheetName, 206, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 207, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 208, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 209, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 12, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 211, 12, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 212, 12, "February"),
					new ExpectedCellValue(sheetName, 213, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 214, 12, "Tent"),
					new ExpectedCellValue(sheetName, 215, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 12, "Tent"),
					new ExpectedCellValue(sheetName, 217, 12, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 218, 12, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 219, 12, "March"),
					new ExpectedCellValue(sheetName, 220, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 221, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 222, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 224, 12, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 225, 12, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 227, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 228, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 229, 12, "January"),
					new ExpectedCellValue(sheetName, 230, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 231, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 232, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 233, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 234, 12, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 235, 12, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 236, 12, "February"),
					new ExpectedCellValue(sheetName, 237, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 238, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 239, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 240, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 241, 12, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 242, 12, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 243, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 244, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 245, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 246, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 186, 13, null),
					new ExpectedCellValue(sheetName, 187, 13, null),
					new ExpectedCellValue(sheetName, 188, 13, null),
					new ExpectedCellValue(sheetName, 189, 13, null),
					new ExpectedCellValue(sheetName, 190, 13, 2d),
					new ExpectedCellValue(sheetName, 191, 13, null),
					new ExpectedCellValue(sheetName, 192, 13, 831.5),
					new ExpectedCellValue(sheetName, 193, 13, 2d),
					new ExpectedCellValue(sheetName, 194, 13, 831.5),
					new ExpectedCellValue(sheetName, 195, 13, null),
					new ExpectedCellValue(sheetName, 196, 13, null),
					new ExpectedCellValue(sheetName, 197, 13, 1d),
					new ExpectedCellValue(sheetName, 198, 13, null),
					new ExpectedCellValue(sheetName, 199, 13, 24.99),
					new ExpectedCellValue(sheetName, 200, 13, 1d),
					new ExpectedCellValue(sheetName, 201, 13, 24.99),
					new ExpectedCellValue(sheetName, 202, 13, 3d),
					new ExpectedCellValue(sheetName, 203, 13, 856.49),
					new ExpectedCellValue(sheetName, 204, 13, null),
					new ExpectedCellValue(sheetName, 205, 13, null),
					new ExpectedCellValue(sheetName, 206, 13, null),
					new ExpectedCellValue(sheetName, 207, 13, 2d),
					new ExpectedCellValue(sheetName, 208, 13, null),
					new ExpectedCellValue(sheetName, 209, 13, 831.5),
					new ExpectedCellValue(sheetName, 210, 13, 2d),
					new ExpectedCellValue(sheetName, 211, 13, 831.5),
					new ExpectedCellValue(sheetName, 212, 13, null),
					new ExpectedCellValue(sheetName, 213, 13, null),
					new ExpectedCellValue(sheetName, 214, 13, 6d),
					new ExpectedCellValue(sheetName, 215, 13, null),
					new ExpectedCellValue(sheetName, 216, 13, 1194d),
					new ExpectedCellValue(sheetName, 217, 13, 6d),
					new ExpectedCellValue(sheetName, 218, 13, 1194d),
					new ExpectedCellValue(sheetName, 219, 13, null),
					new ExpectedCellValue(sheetName, 220, 13, null),
					new ExpectedCellValue(sheetName, 221, 13, 2d),
					new ExpectedCellValue(sheetName, 222, 13, null),
					new ExpectedCellValue(sheetName, 223, 13, 831.5),
					new ExpectedCellValue(sheetName, 224, 13, 2d),
					new ExpectedCellValue(sheetName, 225, 13, 831.5),
					new ExpectedCellValue(sheetName, 226, 13, 10d),
					new ExpectedCellValue(sheetName, 227, 13, 2857d),
					new ExpectedCellValue(sheetName, 228, 13, null),
					new ExpectedCellValue(sheetName, 229, 13, null),
					new ExpectedCellValue(sheetName, 230, 13, null),
					new ExpectedCellValue(sheetName, 231, 13, 1d),
					new ExpectedCellValue(sheetName, 232, 13, null),
					new ExpectedCellValue(sheetName, 233, 13, 415.75),
					new ExpectedCellValue(sheetName, 234, 13, 1d),
					new ExpectedCellValue(sheetName, 235, 13, 415.75),
					new ExpectedCellValue(sheetName, 236, 13, null),
					new ExpectedCellValue(sheetName, 237, 13, null),
					new ExpectedCellValue(sheetName, 238, 13, 1d),
					new ExpectedCellValue(sheetName, 239, 13, null),
					new ExpectedCellValue(sheetName, 240, 13, 99d),
					new ExpectedCellValue(sheetName, 241, 13, 1d),
					new ExpectedCellValue(sheetName, 242, 13, 99d),
					new ExpectedCellValue(sheetName, 243, 13, 2d),
					new ExpectedCellValue(sheetName, 244, 13, 514.75),
					new ExpectedCellValue(sheetName, 245, 13, 15d),
					new ExpectedCellValue(sheetName, 246, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldFirstThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A253:D298"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 253, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 254, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 255, 1, null),
					new ExpectedCellValue(sheetName, 256, 1, null),
					new ExpectedCellValue(sheetName, 257, 1, null),
					new ExpectedCellValue(sheetName, 258, 1, null),
					new ExpectedCellValue(sheetName, 259, 1, null),
					new ExpectedCellValue(sheetName, 260, 1, null),
					new ExpectedCellValue(sheetName, 261, 1, null),
					new ExpectedCellValue(sheetName, 262, 1, null),
					new ExpectedCellValue(sheetName, 263, 1, null),
					new ExpectedCellValue(sheetName, 264, 1, null),
					new ExpectedCellValue(sheetName, 265, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 266, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 267, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 268, 1, null),
					new ExpectedCellValue(sheetName, 269, 1, null),
					new ExpectedCellValue(sheetName, 270, 1, null),
					new ExpectedCellValue(sheetName, 271, 1, null),
					new ExpectedCellValue(sheetName, 272, 1, null),
					new ExpectedCellValue(sheetName, 273, 1, null),
					new ExpectedCellValue(sheetName, 274, 1, null),
					new ExpectedCellValue(sheetName, 275, 1, null),
					new ExpectedCellValue(sheetName, 276, 1, null),
					new ExpectedCellValue(sheetName, 277, 1, null),
					new ExpectedCellValue(sheetName, 278, 1, null),
					new ExpectedCellValue(sheetName, 279, 1, null),
					new ExpectedCellValue(sheetName, 280, 1, null),
					new ExpectedCellValue(sheetName, 281, 1, null),
					new ExpectedCellValue(sheetName, 282, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 283, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 284, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 285, 1, null),
					new ExpectedCellValue(sheetName, 286, 1, null),
					new ExpectedCellValue(sheetName, 287, 1, null),
					new ExpectedCellValue(sheetName, 288, 1, null),
					new ExpectedCellValue(sheetName, 289, 1, null),
					new ExpectedCellValue(sheetName, 290, 1, null),
					new ExpectedCellValue(sheetName, 291, 1, null),
					new ExpectedCellValue(sheetName, 292, 1, null),
					new ExpectedCellValue(sheetName, 293, 1, null),
					new ExpectedCellValue(sheetName, 294, 1, null),
					new ExpectedCellValue(sheetName, 295, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 296, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 298, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 2, "Values"),
					new ExpectedCellValue(sheetName, 254, 2, null),
					new ExpectedCellValue(sheetName, 255, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 256, 2, "January"),
					new ExpectedCellValue(sheetName, 257, 2, null),
					new ExpectedCellValue(sheetName, 258, 2, "March"),
					new ExpectedCellValue(sheetName, 259, 2, null),
					new ExpectedCellValue(sheetName, 260, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 261, 2, "January"),
					new ExpectedCellValue(sheetName, 262, 2, null),
					new ExpectedCellValue(sheetName, 263, 2, "March"),
					new ExpectedCellValue(sheetName, 264, 2, null),
					new ExpectedCellValue(sheetName, 265, 2, null),
					new ExpectedCellValue(sheetName, 266, 2, null),
					new ExpectedCellValue(sheetName, 267, 2, null),
					new ExpectedCellValue(sheetName, 268, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 269, 2, "January"),
					new ExpectedCellValue(sheetName, 270, 2, null),
					new ExpectedCellValue(sheetName, 271, 2, "February"),
					new ExpectedCellValue(sheetName, 272, 2, null),
					new ExpectedCellValue(sheetName, 273, 2, "March"),
					new ExpectedCellValue(sheetName, 274, 2, null),
					new ExpectedCellValue(sheetName, 275, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 276, 2, "January"),
					new ExpectedCellValue(sheetName, 277, 2, null),
					new ExpectedCellValue(sheetName, 278, 2, "February"),
					new ExpectedCellValue(sheetName, 279, 2, null),
					new ExpectedCellValue(sheetName, 280, 2, "March"),
					new ExpectedCellValue(sheetName, 281, 2, null),
					new ExpectedCellValue(sheetName, 282, 2, null),
					new ExpectedCellValue(sheetName, 283, 2, null),
					new ExpectedCellValue(sheetName, 284, 2, null),
					new ExpectedCellValue(sheetName, 285, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 286, 2, "January"),
					new ExpectedCellValue(sheetName, 287, 2, null),
					new ExpectedCellValue(sheetName, 288, 2, "February"),
					new ExpectedCellValue(sheetName, 289, 2, null),
					new ExpectedCellValue(sheetName, 290, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 2, "January"),
					new ExpectedCellValue(sheetName, 292, 2, null),
					new ExpectedCellValue(sheetName, 293, 2, "February"),
					new ExpectedCellValue(sheetName, 294, 2, null),
					new ExpectedCellValue(sheetName, 295, 2, null),
					new ExpectedCellValue(sheetName, 296, 2, null),
					new ExpectedCellValue(sheetName, 297, 2, null),
					new ExpectedCellValue(sheetName, 298, 2, null),
					new ExpectedCellValue(sheetName, 253, 3, "Item"),
					new ExpectedCellValue(sheetName, 254, 3, null),
					new ExpectedCellValue(sheetName, 255, 3, null),
					new ExpectedCellValue(sheetName, 256, 3, null),
					new ExpectedCellValue(sheetName, 257, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 258, 3, null),
					new ExpectedCellValue(sheetName, 259, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 260, 3, null),
					new ExpectedCellValue(sheetName, 261, 3, null),
					new ExpectedCellValue(sheetName, 262, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 3, null),
					new ExpectedCellValue(sheetName, 264, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 265, 3, null),
					new ExpectedCellValue(sheetName, 266, 3, null),
					new ExpectedCellValue(sheetName, 267, 3, null),
					new ExpectedCellValue(sheetName, 268, 3, null),
					new ExpectedCellValue(sheetName, 269, 3, null),
					new ExpectedCellValue(sheetName, 270, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 3, null),
					new ExpectedCellValue(sheetName, 272, 3, "Tent"),
					new ExpectedCellValue(sheetName, 273, 3, null),
					new ExpectedCellValue(sheetName, 274, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 3, null),
					new ExpectedCellValue(sheetName, 276, 3, null),
					new ExpectedCellValue(sheetName, 277, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 278, 3, null),
					new ExpectedCellValue(sheetName, 279, 3, "Tent"),
					new ExpectedCellValue(sheetName, 280, 3, null),
					new ExpectedCellValue(sheetName, 281, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 282, 3, null),
					new ExpectedCellValue(sheetName, 283, 3, null),
					new ExpectedCellValue(sheetName, 284, 3, null),
					new ExpectedCellValue(sheetName, 285, 3, null),
					new ExpectedCellValue(sheetName, 286, 3, null),
					new ExpectedCellValue(sheetName, 287, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 288, 3, null),
					new ExpectedCellValue(sheetName, 289, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 290, 3, null),
					new ExpectedCellValue(sheetName, 291, 3, null),
					new ExpectedCellValue(sheetName, 292, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 293, 3, null),
					new ExpectedCellValue(sheetName, 294, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 295, 3, null),
					new ExpectedCellValue(sheetName, 296, 3, null),
					new ExpectedCellValue(sheetName, 297, 3, null),
					new ExpectedCellValue(sheetName, 298, 3, null),
					new ExpectedCellValue(sheetName, 253, 4, null),
					new ExpectedCellValue(sheetName, 254, 4, null),
					new ExpectedCellValue(sheetName, 255, 4, null),
					new ExpectedCellValue(sheetName, 256, 4, 2d),
					new ExpectedCellValue(sheetName, 257, 4, 2d),
					new ExpectedCellValue(sheetName, 258, 4, 1d),
					new ExpectedCellValue(sheetName, 259, 4, 1d),
					new ExpectedCellValue(sheetName, 260, 4, null),
					new ExpectedCellValue(sheetName, 261, 4, 831.5),
					new ExpectedCellValue(sheetName, 262, 4, 831.5),
					new ExpectedCellValue(sheetName, 263, 4, 24.99),
					new ExpectedCellValue(sheetName, 264, 4, 24.99),
					new ExpectedCellValue(sheetName, 265, 4, 3d),
					new ExpectedCellValue(sheetName, 266, 4, 856.49),
					new ExpectedCellValue(sheetName, 267, 4, null),
					new ExpectedCellValue(sheetName, 268, 4, null),
					new ExpectedCellValue(sheetName, 269, 4, 2d),
					new ExpectedCellValue(sheetName, 270, 4, 2d),
					new ExpectedCellValue(sheetName, 271, 4, 6d),
					new ExpectedCellValue(sheetName, 272, 4, 6d),
					new ExpectedCellValue(sheetName, 273, 4, 2d),
					new ExpectedCellValue(sheetName, 274, 4, 2d),
					new ExpectedCellValue(sheetName, 275, 4, null),
					new ExpectedCellValue(sheetName, 276, 4, 831.5),
					new ExpectedCellValue(sheetName, 277, 4, 831.5),
					new ExpectedCellValue(sheetName, 278, 4, 1194d),
					new ExpectedCellValue(sheetName, 279, 4, 1194d),
					new ExpectedCellValue(sheetName, 280, 4, 831.5),
					new ExpectedCellValue(sheetName, 281, 4, 831.5),
					new ExpectedCellValue(sheetName, 282, 4, 10d),
					new ExpectedCellValue(sheetName, 283, 4, 2857d),
					new ExpectedCellValue(sheetName, 284, 4, null),
					new ExpectedCellValue(sheetName, 285, 4, null),
					new ExpectedCellValue(sheetName, 286, 4, 1d),
					new ExpectedCellValue(sheetName, 287, 4, 1d),
					new ExpectedCellValue(sheetName, 288, 4, 1d),
					new ExpectedCellValue(sheetName, 289, 4, 1d),
					new ExpectedCellValue(sheetName, 290, 4, null),
					new ExpectedCellValue(sheetName, 291, 4, 415.75),
					new ExpectedCellValue(sheetName, 292, 4, 415.75),
					new ExpectedCellValue(sheetName, 293, 4, 99d),
					new ExpectedCellValue(sheetName, 294, 4, 99d),
					new ExpectedCellValue(sheetName, 295, 4, 2d),
					new ExpectedCellValue(sheetName, 296, 4, 514.75),
					new ExpectedCellValue(sheetName, 297, 4, 15d),
					new ExpectedCellValue(sheetName, 298, 4, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldFirstAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable16"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G253:J298"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 253, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 254, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 255, 7, null),
					new ExpectedCellValue(sheetName, 256, 7, null),
					new ExpectedCellValue(sheetName, 257, 7, null),
					new ExpectedCellValue(sheetName, 258, 7, null),
					new ExpectedCellValue(sheetName, 259, 7, null),
					new ExpectedCellValue(sheetName, 260, 7, null),
					new ExpectedCellValue(sheetName, 261, 7, null),
					new ExpectedCellValue(sheetName, 262, 7, null),
					new ExpectedCellValue(sheetName, 263, 7, null),
					new ExpectedCellValue(sheetName, 264, 7, null),
					new ExpectedCellValue(sheetName, 265, 7, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 266, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 267, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 268, 7, null),
					new ExpectedCellValue(sheetName, 269, 7, null),
					new ExpectedCellValue(sheetName, 270, 7, null),
					new ExpectedCellValue(sheetName, 271, 7, null),
					new ExpectedCellValue(sheetName, 272, 7, null),
					new ExpectedCellValue(sheetName, 273, 7, null),
					new ExpectedCellValue(sheetName, 274, 7, null),
					new ExpectedCellValue(sheetName, 275, 7, null),
					new ExpectedCellValue(sheetName, 276, 7, null),
					new ExpectedCellValue(sheetName, 277, 7, null),
					new ExpectedCellValue(sheetName, 278, 7, null),
					new ExpectedCellValue(sheetName, 279, 7, null),
					new ExpectedCellValue(sheetName, 280, 7, null),
					new ExpectedCellValue(sheetName, 281, 7, null),
					new ExpectedCellValue(sheetName, 282, 7, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 283, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 284, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 285, 7, null),
					new ExpectedCellValue(sheetName, 286, 7, null),
					new ExpectedCellValue(sheetName, 287, 7, null),
					new ExpectedCellValue(sheetName, 288, 7, null),
					new ExpectedCellValue(sheetName, 289, 7, null),
					new ExpectedCellValue(sheetName, 290, 7, null),
					new ExpectedCellValue(sheetName, 291, 7, null),
					new ExpectedCellValue(sheetName, 292, 7, null),
					new ExpectedCellValue(sheetName, 293, 7, null),
					new ExpectedCellValue(sheetName, 294, 7, null),
					new ExpectedCellValue(sheetName, 295, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 296, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 298, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 8, "Values"),
					new ExpectedCellValue(sheetName, 254, 8, null),
					new ExpectedCellValue(sheetName, 255, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 256, 8, "January"),
					new ExpectedCellValue(sheetName, 257, 8, null),
					new ExpectedCellValue(sheetName, 258, 8, "March"),
					new ExpectedCellValue(sheetName, 259, 8, null),
					new ExpectedCellValue(sheetName, 260, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 261, 8, "January"),
					new ExpectedCellValue(sheetName, 262, 8, null),
					new ExpectedCellValue(sheetName, 263, 8, "March"),
					new ExpectedCellValue(sheetName, 264, 8, null),
					new ExpectedCellValue(sheetName, 265, 8, null),
					new ExpectedCellValue(sheetName, 266, 8, null),
					new ExpectedCellValue(sheetName, 267, 8, null),
					new ExpectedCellValue(sheetName, 268, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 269, 8, "January"),
					new ExpectedCellValue(sheetName, 270, 8, null),
					new ExpectedCellValue(sheetName, 271, 8, "February"),
					new ExpectedCellValue(sheetName, 272, 8, null),
					new ExpectedCellValue(sheetName, 273, 8, "March"),
					new ExpectedCellValue(sheetName, 274, 8, null),
					new ExpectedCellValue(sheetName, 275, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 276, 8, "January"),
					new ExpectedCellValue(sheetName, 277, 8, null),
					new ExpectedCellValue(sheetName, 278, 8, "February"),
					new ExpectedCellValue(sheetName, 279, 8, null),
					new ExpectedCellValue(sheetName, 280, 8, "March"),
					new ExpectedCellValue(sheetName, 281, 8, null),
					new ExpectedCellValue(sheetName, 282, 8, null),
					new ExpectedCellValue(sheetName, 283, 8, null),
					new ExpectedCellValue(sheetName, 284, 8, null),
					new ExpectedCellValue(sheetName, 285, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 286, 8, "January"),
					new ExpectedCellValue(sheetName, 287, 8, null),
					new ExpectedCellValue(sheetName, 288, 8, "February"),
					new ExpectedCellValue(sheetName, 289, 8, null),
					new ExpectedCellValue(sheetName, 290, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 8, "January"),
					new ExpectedCellValue(sheetName, 292, 8, null),
					new ExpectedCellValue(sheetName, 293, 8, "February"),
					new ExpectedCellValue(sheetName, 294, 8, null),
					new ExpectedCellValue(sheetName, 295, 8, null),
					new ExpectedCellValue(sheetName, 296, 8, null),
					new ExpectedCellValue(sheetName, 297, 8, null),
					new ExpectedCellValue(sheetName, 298, 8, null),
					new ExpectedCellValue(sheetName, 253, 9, "Item"),
					new ExpectedCellValue(sheetName, 254, 9, null),
					new ExpectedCellValue(sheetName, 255, 9, null),
					new ExpectedCellValue(sheetName, 256, 9, null),
					new ExpectedCellValue(sheetName, 257, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 258, 9, null),
					new ExpectedCellValue(sheetName, 259, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 260, 9, null),
					new ExpectedCellValue(sheetName, 261, 9, null),
					new ExpectedCellValue(sheetName, 262, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 9, null),
					new ExpectedCellValue(sheetName, 264, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 265, 9, null),
					new ExpectedCellValue(sheetName, 266, 9, null),
					new ExpectedCellValue(sheetName, 267, 9, null),
					new ExpectedCellValue(sheetName, 268, 9, null),
					new ExpectedCellValue(sheetName, 269, 9, null),
					new ExpectedCellValue(sheetName, 270, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 9, null),
					new ExpectedCellValue(sheetName, 272, 9, "Tent"),
					new ExpectedCellValue(sheetName, 273, 9, null),
					new ExpectedCellValue(sheetName, 274, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 9, null),
					new ExpectedCellValue(sheetName, 276, 9, null),
					new ExpectedCellValue(sheetName, 277, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 278, 9, null),
					new ExpectedCellValue(sheetName, 279, 9, "Tent"),
					new ExpectedCellValue(sheetName, 280, 9, null),
					new ExpectedCellValue(sheetName, 281, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 282, 9, null),
					new ExpectedCellValue(sheetName, 283, 9, null),
					new ExpectedCellValue(sheetName, 284, 9, null),
					new ExpectedCellValue(sheetName, 285, 9, null),
					new ExpectedCellValue(sheetName, 286, 9, null),
					new ExpectedCellValue(sheetName, 287, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 288, 9, null),
					new ExpectedCellValue(sheetName, 289, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 290, 9, null),
					new ExpectedCellValue(sheetName, 291, 9, null),
					new ExpectedCellValue(sheetName, 292, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 293, 9, null),
					new ExpectedCellValue(sheetName, 294, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 295, 9, null),
					new ExpectedCellValue(sheetName, 296, 9, null),
					new ExpectedCellValue(sheetName, 297, 9, null),
					new ExpectedCellValue(sheetName, 298, 9, null),
					new ExpectedCellValue(sheetName, 253, 10, null),
					new ExpectedCellValue(sheetName, 254, 10, null),
					new ExpectedCellValue(sheetName, 255, 10, null),
					new ExpectedCellValue(sheetName, 256, 10, 2d),
					new ExpectedCellValue(sheetName, 257, 10, 2d),
					new ExpectedCellValue(sheetName, 258, 10, 1d),
					new ExpectedCellValue(sheetName, 259, 10, 1d),
					new ExpectedCellValue(sheetName, 260, 10, null),
					new ExpectedCellValue(sheetName, 261, 10, 831.5),
					new ExpectedCellValue(sheetName, 262, 10, 831.5),
					new ExpectedCellValue(sheetName, 263, 10, 24.99),
					new ExpectedCellValue(sheetName, 264, 10, 24.99),
					new ExpectedCellValue(sheetName, 265, 10, 3d),
					new ExpectedCellValue(sheetName, 266, 10, 856.49),
					new ExpectedCellValue(sheetName, 267, 10, null),
					new ExpectedCellValue(sheetName, 268, 10, null),
					new ExpectedCellValue(sheetName, 269, 10, 2d),
					new ExpectedCellValue(sheetName, 270, 10, 2d),
					new ExpectedCellValue(sheetName, 271, 10, 6d),
					new ExpectedCellValue(sheetName, 272, 10, 6d),
					new ExpectedCellValue(sheetName, 273, 10, 2d),
					new ExpectedCellValue(sheetName, 274, 10, 2d),
					new ExpectedCellValue(sheetName, 275, 10, null),
					new ExpectedCellValue(sheetName, 276, 10, 831.5),
					new ExpectedCellValue(sheetName, 277, 10, 831.5),
					new ExpectedCellValue(sheetName, 278, 10, 1194d),
					new ExpectedCellValue(sheetName, 279, 10, 1194d),
					new ExpectedCellValue(sheetName, 280, 10, 831.5),
					new ExpectedCellValue(sheetName, 281, 10, 831.5),
					new ExpectedCellValue(sheetName, 282, 10, 10d),
					new ExpectedCellValue(sheetName, 283, 10, 2857d),
					new ExpectedCellValue(sheetName, 284, 10, null),
					new ExpectedCellValue(sheetName, 285, 10, null),
					new ExpectedCellValue(sheetName, 286, 10, 1d),
					new ExpectedCellValue(sheetName, 287, 10, 1d),
					new ExpectedCellValue(sheetName, 288, 10, 1d),
					new ExpectedCellValue(sheetName, 289, 10, 1d),
					new ExpectedCellValue(sheetName, 290, 10, null),
					new ExpectedCellValue(sheetName, 291, 10, 415.75),
					new ExpectedCellValue(sheetName, 292, 10, 415.75),
					new ExpectedCellValue(sheetName, 293, 10, 99d),
					new ExpectedCellValue(sheetName, 294, 10, 99d),
					new ExpectedCellValue(sheetName, 295, 10, 2d),
					new ExpectedCellValue(sheetName, 296, 10, 514.75),
					new ExpectedCellValue(sheetName, 297, 10, 15d),
					new ExpectedCellValue(sheetName, 298, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldFirstAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable17"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L253:N298"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 253, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 254, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 255, 12, null),
					new ExpectedCellValue(sheetName, 256, 12, null),
					new ExpectedCellValue(sheetName, 257, 12, null),
					new ExpectedCellValue(sheetName, 258, 12, null),
					new ExpectedCellValue(sheetName, 259, 12, null),
					new ExpectedCellValue(sheetName, 260, 12, null),
					new ExpectedCellValue(sheetName, 261, 12, null),
					new ExpectedCellValue(sheetName, 262, 12, null),
					new ExpectedCellValue(sheetName, 263, 12, null),
					new ExpectedCellValue(sheetName, 264, 12, null),
					new ExpectedCellValue(sheetName, 265, 12, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 266, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 267, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 268, 12, null),
					new ExpectedCellValue(sheetName, 269, 12, null),
					new ExpectedCellValue(sheetName, 270, 12, null),
					new ExpectedCellValue(sheetName, 271, 12, null),
					new ExpectedCellValue(sheetName, 272, 12, null),
					new ExpectedCellValue(sheetName, 273, 12, null),
					new ExpectedCellValue(sheetName, 274, 12, null),
					new ExpectedCellValue(sheetName, 275, 12, null),
					new ExpectedCellValue(sheetName, 276, 12, null),
					new ExpectedCellValue(sheetName, 277, 12, null),
					new ExpectedCellValue(sheetName, 278, 12, null),
					new ExpectedCellValue(sheetName, 279, 12, null),
					new ExpectedCellValue(sheetName, 280, 12, null),
					new ExpectedCellValue(sheetName, 281, 12, null),
					new ExpectedCellValue(sheetName, 282, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 283, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 284, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 285, 12, null),
					new ExpectedCellValue(sheetName, 286, 12, null),
					new ExpectedCellValue(sheetName, 287, 12, null),
					new ExpectedCellValue(sheetName, 288, 12, null),
					new ExpectedCellValue(sheetName, 289, 12, null),
					new ExpectedCellValue(sheetName, 290, 12, null),
					new ExpectedCellValue(sheetName, 291, 12, null),
					new ExpectedCellValue(sheetName, 292, 12, null),
					new ExpectedCellValue(sheetName, 293, 12, null),
					new ExpectedCellValue(sheetName, 294, 12, null),
					new ExpectedCellValue(sheetName, 295, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 296, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 298, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 13, "Values"),
					new ExpectedCellValue(sheetName, 254, 13, null),
					new ExpectedCellValue(sheetName, 255, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 256, 13, "January"),
					new ExpectedCellValue(sheetName, 257, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 258, 13, "March"),
					new ExpectedCellValue(sheetName, 259, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 260, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 261, 13, "January"),
					new ExpectedCellValue(sheetName, 262, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 13, "March"),
					new ExpectedCellValue(sheetName, 264, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 265, 13, null),
					new ExpectedCellValue(sheetName, 266, 13, null),
					new ExpectedCellValue(sheetName, 267, 13, null),
					new ExpectedCellValue(sheetName, 268, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 269, 13, "January"),
					new ExpectedCellValue(sheetName, 270, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 13, "February"),
					new ExpectedCellValue(sheetName, 272, 13, "Tent"),
					new ExpectedCellValue(sheetName, 273, 13, "March"),
					new ExpectedCellValue(sheetName, 274, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 276, 13, "January"),
					new ExpectedCellValue(sheetName, 277, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 278, 13, "February"),
					new ExpectedCellValue(sheetName, 279, 13, "Tent"),
					new ExpectedCellValue(sheetName, 280, 13, "March"),
					new ExpectedCellValue(sheetName, 281, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 282, 13, null),
					new ExpectedCellValue(sheetName, 283, 13, null),
					new ExpectedCellValue(sheetName, 284, 13, null),
					new ExpectedCellValue(sheetName, 285, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 286, 13, "January"),
					new ExpectedCellValue(sheetName, 287, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 288, 13, "February"),
					new ExpectedCellValue(sheetName, 289, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 290, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 13, "January"),
					new ExpectedCellValue(sheetName, 292, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 293, 13, "February"),
					new ExpectedCellValue(sheetName, 294, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 295, 13, null),
					new ExpectedCellValue(sheetName, 296, 13, null),
					new ExpectedCellValue(sheetName, 297, 13, null),
					new ExpectedCellValue(sheetName, 298, 13, null),
					new ExpectedCellValue(sheetName, 253, 14, null),
					new ExpectedCellValue(sheetName, 254, 14, null),
					new ExpectedCellValue(sheetName, 255, 14, null),
					new ExpectedCellValue(sheetName, 256, 14, 2d),
					new ExpectedCellValue(sheetName, 257, 14, 2d),
					new ExpectedCellValue(sheetName, 258, 14, 1d),
					new ExpectedCellValue(sheetName, 259, 14, 1d),
					new ExpectedCellValue(sheetName, 260, 14, null),
					new ExpectedCellValue(sheetName, 261, 14, 831.5),
					new ExpectedCellValue(sheetName, 262, 14, 831.5),
					new ExpectedCellValue(sheetName, 263, 14, 24.99),
					new ExpectedCellValue(sheetName, 264, 14, 24.99),
					new ExpectedCellValue(sheetName, 265, 14, 3d),
					new ExpectedCellValue(sheetName, 266, 14, 856.49),
					new ExpectedCellValue(sheetName, 267, 14, null),
					new ExpectedCellValue(sheetName, 268, 14, null),
					new ExpectedCellValue(sheetName, 269, 14, 2d),
					new ExpectedCellValue(sheetName, 270, 14, 2d),
					new ExpectedCellValue(sheetName, 271, 14, 6d),
					new ExpectedCellValue(sheetName, 272, 14, 6d),
					new ExpectedCellValue(sheetName, 273, 14, 2d),
					new ExpectedCellValue(sheetName, 274, 14, 2d),
					new ExpectedCellValue(sheetName, 275, 14, null),
					new ExpectedCellValue(sheetName, 276, 14, 831.5),
					new ExpectedCellValue(sheetName, 277, 14, 831.5),
					new ExpectedCellValue(sheetName, 278, 14, 1194d),
					new ExpectedCellValue(sheetName, 279, 14, 1194d),
					new ExpectedCellValue(sheetName, 280, 14, 831.5),
					new ExpectedCellValue(sheetName, 281, 14, 831.5),
					new ExpectedCellValue(sheetName, 282, 14, 10d),
					new ExpectedCellValue(sheetName, 283, 14, 2857d),
					new ExpectedCellValue(sheetName, 284, 14, null),
					new ExpectedCellValue(sheetName, 285, 14, null),
					new ExpectedCellValue(sheetName, 286, 14, 1d),
					new ExpectedCellValue(sheetName, 287, 14, 1d),
					new ExpectedCellValue(sheetName, 288, 14, 1d),
					new ExpectedCellValue(sheetName, 289, 14, 1d),
					new ExpectedCellValue(sheetName, 290, 14, null),
					new ExpectedCellValue(sheetName, 291, 14, 415.75),
					new ExpectedCellValue(sheetName, 292, 14, 415.75),
					new ExpectedCellValue(sheetName, 293, 14, 99d),
					new ExpectedCellValue(sheetName, 294, 14, 99d),
					new ExpectedCellValue(sheetName, 295, 14, 2d),
					new ExpectedCellValue(sheetName, 296, 14, 514.75),
					new ExpectedCellValue(sheetName, 297, 14, 15d),
					new ExpectedCellValue(sheetName, 298, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldFirstFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable18"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q253:S298"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 253, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 254, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 255, 17, null),
					new ExpectedCellValue(sheetName, 256, 17, null),
					new ExpectedCellValue(sheetName, 257, 17, null),
					new ExpectedCellValue(sheetName, 258, 17, null),
					new ExpectedCellValue(sheetName, 259, 17, null),
					new ExpectedCellValue(sheetName, 260, 17, null),
					new ExpectedCellValue(sheetName, 261, 17, null),
					new ExpectedCellValue(sheetName, 262, 17, null),
					new ExpectedCellValue(sheetName, 263, 17, null),
					new ExpectedCellValue(sheetName, 264, 17, null),
					new ExpectedCellValue(sheetName, 265, 17, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 266, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 267, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 268, 17, null),
					new ExpectedCellValue(sheetName, 269, 17, null),
					new ExpectedCellValue(sheetName, 270, 17, null),
					new ExpectedCellValue(sheetName, 271, 17, null),
					new ExpectedCellValue(sheetName, 272, 17, null),
					new ExpectedCellValue(sheetName, 273, 17, null),
					new ExpectedCellValue(sheetName, 274, 17, null),
					new ExpectedCellValue(sheetName, 275, 17, null),
					new ExpectedCellValue(sheetName, 276, 17, null),
					new ExpectedCellValue(sheetName, 277, 17, null),
					new ExpectedCellValue(sheetName, 278, 17, null),
					new ExpectedCellValue(sheetName, 279, 17, null),
					new ExpectedCellValue(sheetName, 280, 17, null),
					new ExpectedCellValue(sheetName, 281, 17, null),
					new ExpectedCellValue(sheetName, 282, 17, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 283, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 284, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 285, 17, null),
					new ExpectedCellValue(sheetName, 286, 17, null),
					new ExpectedCellValue(sheetName, 287, 17, null),
					new ExpectedCellValue(sheetName, 288, 17, null),
					new ExpectedCellValue(sheetName, 289, 17, null),
					new ExpectedCellValue(sheetName, 290, 17, null),
					new ExpectedCellValue(sheetName, 291, 17, null),
					new ExpectedCellValue(sheetName, 292, 17, null),
					new ExpectedCellValue(sheetName, 293, 17, null),
					new ExpectedCellValue(sheetName, 294, 17, null),
					new ExpectedCellValue(sheetName, 295, 17, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 296, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 297, 17, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 298, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 18, "Values"),
					new ExpectedCellValue(sheetName, 254, 18, null),
					new ExpectedCellValue(sheetName, 255, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 256, 18, "January"),
					new ExpectedCellValue(sheetName, 257, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 258, 18, "March"),
					new ExpectedCellValue(sheetName, 259, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 260, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 261, 18, "January"),
					new ExpectedCellValue(sheetName, 262, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 18, "March"),
					new ExpectedCellValue(sheetName, 264, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 265, 18, null),
					new ExpectedCellValue(sheetName, 266, 18, null),
					new ExpectedCellValue(sheetName, 267, 18, null),
					new ExpectedCellValue(sheetName, 268, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 269, 18, "January"),
					new ExpectedCellValue(sheetName, 270, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 18, "February"),
					new ExpectedCellValue(sheetName, 272, 18, "Tent"),
					new ExpectedCellValue(sheetName, 273, 18, "March"),
					new ExpectedCellValue(sheetName, 274, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 276, 18, "January"),
					new ExpectedCellValue(sheetName, 277, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 278, 18, "February"),
					new ExpectedCellValue(sheetName, 279, 18, "Tent"),
					new ExpectedCellValue(sheetName, 280, 18, "March"),
					new ExpectedCellValue(sheetName, 281, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 282, 18, null),
					new ExpectedCellValue(sheetName, 283, 18, null),
					new ExpectedCellValue(sheetName, 284, 18, null),
					new ExpectedCellValue(sheetName, 285, 18, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 286, 18, "January"),
					new ExpectedCellValue(sheetName, 287, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 288, 18, "February"),
					new ExpectedCellValue(sheetName, 289, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 290, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 18, "January"),
					new ExpectedCellValue(sheetName, 292, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 293, 18, "February"),
					new ExpectedCellValue(sheetName, 294, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 295, 18, null),
					new ExpectedCellValue(sheetName, 296, 18, null),
					new ExpectedCellValue(sheetName, 297, 18, null),
					new ExpectedCellValue(sheetName, 298, 18, null),
					new ExpectedCellValue(sheetName, 253, 19, null),
					new ExpectedCellValue(sheetName, 254, 19, null),
					new ExpectedCellValue(sheetName, 255, 19, null),
					new ExpectedCellValue(sheetName, 256, 19, 2d),
					new ExpectedCellValue(sheetName, 257, 19, 2d),
					new ExpectedCellValue(sheetName, 258, 19, 1d),
					new ExpectedCellValue(sheetName, 259, 19, 1d),
					new ExpectedCellValue(sheetName, 260, 19, null),
					new ExpectedCellValue(sheetName, 261, 19, 831.5),
					new ExpectedCellValue(sheetName, 262, 19, 831.5),
					new ExpectedCellValue(sheetName, 263, 19, 24.99),
					new ExpectedCellValue(sheetName, 264, 19, 24.99),
					new ExpectedCellValue(sheetName, 265, 19, 3d),
					new ExpectedCellValue(sheetName, 266, 19, 856.49),
					new ExpectedCellValue(sheetName, 267, 19, null),
					new ExpectedCellValue(sheetName, 268, 19, null),
					new ExpectedCellValue(sheetName, 269, 19, 2d),
					new ExpectedCellValue(sheetName, 270, 19, 2d),
					new ExpectedCellValue(sheetName, 271, 19, 6d),
					new ExpectedCellValue(sheetName, 272, 19, 6d),
					new ExpectedCellValue(sheetName, 273, 19, 2d),
					new ExpectedCellValue(sheetName, 274, 19, 2d),
					new ExpectedCellValue(sheetName, 275, 19, null),
					new ExpectedCellValue(sheetName, 276, 19, 831.5),
					new ExpectedCellValue(sheetName, 277, 19, 831.5),
					new ExpectedCellValue(sheetName, 278, 19, 1194d),
					new ExpectedCellValue(sheetName, 279, 19, 1194d),
					new ExpectedCellValue(sheetName, 280, 19, 831.5),
					new ExpectedCellValue(sheetName, 281, 19, 831.5),
					new ExpectedCellValue(sheetName, 282, 19, 10d),
					new ExpectedCellValue(sheetName, 283, 19, 2857d),
					new ExpectedCellValue(sheetName, 284, 19, null),
					new ExpectedCellValue(sheetName, 285, 19, null),
					new ExpectedCellValue(sheetName, 286, 19, 1d),
					new ExpectedCellValue(sheetName, 287, 19, 1d),
					new ExpectedCellValue(sheetName, 288, 19, 1d),
					new ExpectedCellValue(sheetName, 289, 19, 1d),
					new ExpectedCellValue(sheetName, 290, 19, null),
					new ExpectedCellValue(sheetName, 291, 19, 415.75),
					new ExpectedCellValue(sheetName, 292, 19, 415.75),
					new ExpectedCellValue(sheetName, 293, 19, 99d),
					new ExpectedCellValue(sheetName, 294, 19, 99d),
					new ExpectedCellValue(sheetName, 295, 19, 2d),
					new ExpectedCellValue(sheetName, 296, 19, 514.75),
					new ExpectedCellValue(sheetName, 297, 19, 15d),
					new ExpectedCellValue(sheetName, 298, 19, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable19"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A304:C349"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 304, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 305, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 306, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 307, 1, "January"),
					new ExpectedCellValue(sheetName, 308, 1, null),
					new ExpectedCellValue(sheetName, 309, 1, "March"),
					new ExpectedCellValue(sheetName, 310, 1, null),
					new ExpectedCellValue(sheetName, 311, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 312, 1, "January"),
					new ExpectedCellValue(sheetName, 313, 1, null),
					new ExpectedCellValue(sheetName, 314, 1, "March"),
					new ExpectedCellValue(sheetName, 315, 1, null),
					new ExpectedCellValue(sheetName, 316, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 317, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 318, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 319, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 320, 1, "January"),
					new ExpectedCellValue(sheetName, 321, 1, null),
					new ExpectedCellValue(sheetName, 322, 1, "February"),
					new ExpectedCellValue(sheetName, 323, 1, null),
					new ExpectedCellValue(sheetName, 324, 1, "March"),
					new ExpectedCellValue(sheetName, 325, 1, null),
					new ExpectedCellValue(sheetName, 326, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 327, 1, "January"),
					new ExpectedCellValue(sheetName, 328, 1, null),
					new ExpectedCellValue(sheetName, 329, 1, "February"),
					new ExpectedCellValue(sheetName, 330, 1, null),
					new ExpectedCellValue(sheetName, 331, 1, "March"),
					new ExpectedCellValue(sheetName, 332, 1, null),
					new ExpectedCellValue(sheetName, 333, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 334, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 335, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 336, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 337, 1, "January"),
					new ExpectedCellValue(sheetName, 338, 1, null),
					new ExpectedCellValue(sheetName, 339, 1, "February"),
					new ExpectedCellValue(sheetName, 340, 1, null),
					new ExpectedCellValue(sheetName, 341, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 342, 1, "January"),
					new ExpectedCellValue(sheetName, 343, 1, null),
					new ExpectedCellValue(sheetName, 344, 1, "February"),
					new ExpectedCellValue(sheetName, 345, 1, null),
					new ExpectedCellValue(sheetName, 346, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 347, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 348, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 349, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 304, 2, "Item"),
					new ExpectedCellValue(sheetName, 305, 2, null),
					new ExpectedCellValue(sheetName, 306, 2, null),
					new ExpectedCellValue(sheetName, 307, 2, null),
					new ExpectedCellValue(sheetName, 308, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 2, null),
					new ExpectedCellValue(sheetName, 310, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 2, null),
					new ExpectedCellValue(sheetName, 312, 2, null),
					new ExpectedCellValue(sheetName, 313, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 2, null),
					new ExpectedCellValue(sheetName, 315, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 2, null),
					new ExpectedCellValue(sheetName, 317, 2, null),
					new ExpectedCellValue(sheetName, 318, 2, null),
					new ExpectedCellValue(sheetName, 319, 2, null),
					new ExpectedCellValue(sheetName, 320, 2, null),
					new ExpectedCellValue(sheetName, 321, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 2, null),
					new ExpectedCellValue(sheetName, 323, 2, "Tent"),
					new ExpectedCellValue(sheetName, 324, 2, null),
					new ExpectedCellValue(sheetName, 325, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 2, null),
					new ExpectedCellValue(sheetName, 327, 2, null),
					new ExpectedCellValue(sheetName, 328, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 2, null),
					new ExpectedCellValue(sheetName, 330, 2, "Tent"),
					new ExpectedCellValue(sheetName, 331, 2, null),
					new ExpectedCellValue(sheetName, 332, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 2, null),
					new ExpectedCellValue(sheetName, 334, 2, null),
					new ExpectedCellValue(sheetName, 335, 2, null),
					new ExpectedCellValue(sheetName, 336, 2, null),
					new ExpectedCellValue(sheetName, 337, 2, null),
					new ExpectedCellValue(sheetName, 338, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 2, null),
					new ExpectedCellValue(sheetName, 340, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 2, null),
					new ExpectedCellValue(sheetName, 342, 2, null),
					new ExpectedCellValue(sheetName, 343, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 2, null),
					new ExpectedCellValue(sheetName, 345, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 2, null),
					new ExpectedCellValue(sheetName, 347, 2, null),
					new ExpectedCellValue(sheetName, 348, 2, null),
					new ExpectedCellValue(sheetName, 349, 2, null),
					new ExpectedCellValue(sheetName, 304, 3, null),
					new ExpectedCellValue(sheetName, 305, 3, null),
					new ExpectedCellValue(sheetName, 306, 3, null),
					new ExpectedCellValue(sheetName, 307, 3, 2d),
					new ExpectedCellValue(sheetName, 308, 3, 2d),
					new ExpectedCellValue(sheetName, 309, 3, 1d),
					new ExpectedCellValue(sheetName, 310, 3, 1d),
					new ExpectedCellValue(sheetName, 311, 3, null),
					new ExpectedCellValue(sheetName, 312, 3, 831.5),
					new ExpectedCellValue(sheetName, 313, 3, 831.5),
					new ExpectedCellValue(sheetName, 314, 3, 24.99),
					new ExpectedCellValue(sheetName, 315, 3, 24.99),
					new ExpectedCellValue(sheetName, 316, 3, 3d),
					new ExpectedCellValue(sheetName, 317, 3, 856.49),
					new ExpectedCellValue(sheetName, 318, 3, null),
					new ExpectedCellValue(sheetName, 319, 3, null),
					new ExpectedCellValue(sheetName, 320, 3, 2d),
					new ExpectedCellValue(sheetName, 321, 3, 2d),
					new ExpectedCellValue(sheetName, 322, 3, 6d),
					new ExpectedCellValue(sheetName, 323, 3, 6d),
					new ExpectedCellValue(sheetName, 324, 3, 2d),
					new ExpectedCellValue(sheetName, 325, 3, 2d),
					new ExpectedCellValue(sheetName, 326, 3, null),
					new ExpectedCellValue(sheetName, 327, 3, 831.5),
					new ExpectedCellValue(sheetName, 328, 3, 831.5),
					new ExpectedCellValue(sheetName, 329, 3, 1194d),
					new ExpectedCellValue(sheetName, 330, 3, 1194d),
					new ExpectedCellValue(sheetName, 331, 3, 831.5),
					new ExpectedCellValue(sheetName, 332, 3, 831.5),
					new ExpectedCellValue(sheetName, 333, 3, 10d),
					new ExpectedCellValue(sheetName, 334, 3, 2857d),
					new ExpectedCellValue(sheetName, 335, 3, null),
					new ExpectedCellValue(sheetName, 336, 3, null),
					new ExpectedCellValue(sheetName, 337, 3, 1d),
					new ExpectedCellValue(sheetName, 338, 3, 1d),
					new ExpectedCellValue(sheetName, 339, 3, 1d),
					new ExpectedCellValue(sheetName, 340, 3, 1d),
					new ExpectedCellValue(sheetName, 341, 3, null),
					new ExpectedCellValue(sheetName, 342, 3, 415.75),
					new ExpectedCellValue(sheetName, 343, 3, 415.75),
					new ExpectedCellValue(sheetName, 344, 3, 99d),
					new ExpectedCellValue(sheetName, 345, 3, 99d),
					new ExpectedCellValue(sheetName, 346, 3, 2d),
					new ExpectedCellValue(sheetName, 347, 3, 514.75),
					new ExpectedCellValue(sheetName, 348, 3, 15d),
					new ExpectedCellValue(sheetName, 349, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldThirdFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable20"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G304:I349"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 304, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 305, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 306, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 307, 7, "January"),
					new ExpectedCellValue(sheetName, 308, 7, null),
					new ExpectedCellValue(sheetName, 309, 7, "March"),
					new ExpectedCellValue(sheetName, 310, 7, null),
					new ExpectedCellValue(sheetName, 311, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 312, 7, "January"),
					new ExpectedCellValue(sheetName, 313, 7, null),
					new ExpectedCellValue(sheetName, 314, 7, "March"),
					new ExpectedCellValue(sheetName, 315, 7, null),
					new ExpectedCellValue(sheetName, 316, 7, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 317, 7, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 318, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 319, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 320, 7, "January"),
					new ExpectedCellValue(sheetName, 321, 7, null),
					new ExpectedCellValue(sheetName, 322, 7, "February"),
					new ExpectedCellValue(sheetName, 323, 7, null),
					new ExpectedCellValue(sheetName, 324, 7, "March"),
					new ExpectedCellValue(sheetName, 325, 7, null),
					new ExpectedCellValue(sheetName, 326, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 327, 7, "January"),
					new ExpectedCellValue(sheetName, 328, 7, null),
					new ExpectedCellValue(sheetName, 329, 7, "February"),
					new ExpectedCellValue(sheetName, 330, 7, null),
					new ExpectedCellValue(sheetName, 331, 7, "March"),
					new ExpectedCellValue(sheetName, 332, 7, null),
					new ExpectedCellValue(sheetName, 333, 7, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 334, 7, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 335, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 336, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 337, 7, "January"),
					new ExpectedCellValue(sheetName, 338, 7, null),
					new ExpectedCellValue(sheetName, 339, 7, "February"),
					new ExpectedCellValue(sheetName, 340, 7, null),
					new ExpectedCellValue(sheetName, 341, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 342, 7, "January"),
					new ExpectedCellValue(sheetName, 343, 7, null),
					new ExpectedCellValue(sheetName, 344, 7, "February"),
					new ExpectedCellValue(sheetName, 345, 7, null),
					new ExpectedCellValue(sheetName, 346, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 347, 7, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 348, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 349, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 304, 8, "Item"),
					new ExpectedCellValue(sheetName, 305, 8, null),
					new ExpectedCellValue(sheetName, 306, 8, null),
					new ExpectedCellValue(sheetName, 307, 8, null),
					new ExpectedCellValue(sheetName, 308, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 8, null),
					new ExpectedCellValue(sheetName, 310, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 8, null),
					new ExpectedCellValue(sheetName, 312, 8, null),
					new ExpectedCellValue(sheetName, 313, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 8, null),
					new ExpectedCellValue(sheetName, 315, 8, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 8, null),
					new ExpectedCellValue(sheetName, 317, 8, null),
					new ExpectedCellValue(sheetName, 318, 8, null),
					new ExpectedCellValue(sheetName, 319, 8, null),
					new ExpectedCellValue(sheetName, 320, 8, null),
					new ExpectedCellValue(sheetName, 321, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 8, null),
					new ExpectedCellValue(sheetName, 323, 8, "Tent"),
					new ExpectedCellValue(sheetName, 324, 8, null),
					new ExpectedCellValue(sheetName, 325, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 8, null),
					new ExpectedCellValue(sheetName, 327, 8, null),
					new ExpectedCellValue(sheetName, 328, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 8, null),
					new ExpectedCellValue(sheetName, 330, 8, "Tent"),
					new ExpectedCellValue(sheetName, 331, 8, null),
					new ExpectedCellValue(sheetName, 332, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 8, null),
					new ExpectedCellValue(sheetName, 334, 8, null),
					new ExpectedCellValue(sheetName, 335, 8, null),
					new ExpectedCellValue(sheetName, 336, 8, null),
					new ExpectedCellValue(sheetName, 337, 8, null),
					new ExpectedCellValue(sheetName, 338, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 8, null),
					new ExpectedCellValue(sheetName, 340, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 8, null),
					new ExpectedCellValue(sheetName, 342, 8, null),
					new ExpectedCellValue(sheetName, 343, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 8, null),
					new ExpectedCellValue(sheetName, 345, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 8, null),
					new ExpectedCellValue(sheetName, 347, 8, null),
					new ExpectedCellValue(sheetName, 348, 8, null),
					new ExpectedCellValue(sheetName, 349, 8, null),
					new ExpectedCellValue(sheetName, 304, 9, null),
					new ExpectedCellValue(sheetName, 305, 9, null),
					new ExpectedCellValue(sheetName, 306, 9, null),
					new ExpectedCellValue(sheetName, 307, 9, 2d),
					new ExpectedCellValue(sheetName, 308, 9, 2d),
					new ExpectedCellValue(sheetName, 309, 9, 1d),
					new ExpectedCellValue(sheetName, 310, 9, 1d),
					new ExpectedCellValue(sheetName, 311, 9, null),
					new ExpectedCellValue(sheetName, 312, 9, 831.5),
					new ExpectedCellValue(sheetName, 313, 9, 831.5),
					new ExpectedCellValue(sheetName, 314, 9, 24.99),
					new ExpectedCellValue(sheetName, 315, 9, 24.99),
					new ExpectedCellValue(sheetName, 316, 9, 3d),
					new ExpectedCellValue(sheetName, 317, 9, 856.49),
					new ExpectedCellValue(sheetName, 318, 9, null),
					new ExpectedCellValue(sheetName, 319, 9, null),
					new ExpectedCellValue(sheetName, 320, 9, 2d),
					new ExpectedCellValue(sheetName, 321, 9, 2d),
					new ExpectedCellValue(sheetName, 322, 9, 6d),
					new ExpectedCellValue(sheetName, 323, 9, 6d),
					new ExpectedCellValue(sheetName, 324, 9, 2d),
					new ExpectedCellValue(sheetName, 325, 9, 2d),
					new ExpectedCellValue(sheetName, 326, 9, null),
					new ExpectedCellValue(sheetName, 327, 9, 831.5),
					new ExpectedCellValue(sheetName, 328, 9, 831.5),
					new ExpectedCellValue(sheetName, 329, 9, 1194d),
					new ExpectedCellValue(sheetName, 330, 9, 1194d),
					new ExpectedCellValue(sheetName, 331, 9, 831.5),
					new ExpectedCellValue(sheetName, 332, 9, 831.5),
					new ExpectedCellValue(sheetName, 333, 9, 10d),
					new ExpectedCellValue(sheetName, 334, 9, 2857d),
					new ExpectedCellValue(sheetName, 335, 9, null),
					new ExpectedCellValue(sheetName, 336, 9, null),
					new ExpectedCellValue(sheetName, 337, 9, 1d),
					new ExpectedCellValue(sheetName, 338, 9, 1d),
					new ExpectedCellValue(sheetName, 339, 9, 1d),
					new ExpectedCellValue(sheetName, 340, 9, 1d),
					new ExpectedCellValue(sheetName, 341, 9, null),
					new ExpectedCellValue(sheetName, 342, 9, 415.75),
					new ExpectedCellValue(sheetName, 343, 9, 415.75),
					new ExpectedCellValue(sheetName, 344, 9, 99d),
					new ExpectedCellValue(sheetName, 345, 9, 99d),
					new ExpectedCellValue(sheetName, 346, 9, 2d),
					new ExpectedCellValue(sheetName, 347, 9, 514.75),
					new ExpectedCellValue(sheetName, 348, 9, 15d),
					new ExpectedCellValue(sheetName, 349, 9, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsSecondFieldDataFieldLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable21"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L304:M349"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 304, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 305, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 306, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 307, 12, "January"),
					new ExpectedCellValue(sheetName, 308, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 12, "March"),
					new ExpectedCellValue(sheetName, 310, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 312, 12, "January"),
					new ExpectedCellValue(sheetName, 313, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 12, "March"),
					new ExpectedCellValue(sheetName, 315, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 12, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 317, 12, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 318, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 319, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 320, 12, "January"),
					new ExpectedCellValue(sheetName, 321, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 12, "February"),
					new ExpectedCellValue(sheetName, 323, 12, "Tent"),
					new ExpectedCellValue(sheetName, 324, 12, "March"),
					new ExpectedCellValue(sheetName, 325, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 327, 12, "January"),
					new ExpectedCellValue(sheetName, 328, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 12, "February"),
					new ExpectedCellValue(sheetName, 330, 12, "Tent"),
					new ExpectedCellValue(sheetName, 331, 12, "March"),
					new ExpectedCellValue(sheetName, 332, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 334, 12, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 335, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 336, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 337, 12, "January"),
					new ExpectedCellValue(sheetName, 338, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 12, "February"),
					new ExpectedCellValue(sheetName, 340, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 342, 12, "January"),
					new ExpectedCellValue(sheetName, 343, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 12, "February"),
					new ExpectedCellValue(sheetName, 345, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 12, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 347, 12, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 348, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 349, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 304, 13, null),
					new ExpectedCellValue(sheetName, 305, 13, null),
					new ExpectedCellValue(sheetName, 306, 13, null),
					new ExpectedCellValue(sheetName, 307, 13, 2d),
					new ExpectedCellValue(sheetName, 308, 13, 2d),
					new ExpectedCellValue(sheetName, 309, 13, 1d),
					new ExpectedCellValue(sheetName, 310, 13, 1d),
					new ExpectedCellValue(sheetName, 311, 13, null),
					new ExpectedCellValue(sheetName, 312, 13, 831.5),
					new ExpectedCellValue(sheetName, 313, 13, 831.5),
					new ExpectedCellValue(sheetName, 314, 13, 24.99),
					new ExpectedCellValue(sheetName, 315, 13, 24.99),
					new ExpectedCellValue(sheetName, 316, 13, 3d),
					new ExpectedCellValue(sheetName, 317, 13, 856.49),
					new ExpectedCellValue(sheetName, 318, 13, null),
					new ExpectedCellValue(sheetName, 319, 13, null),
					new ExpectedCellValue(sheetName, 320, 13, 2d),
					new ExpectedCellValue(sheetName, 321, 13, 2d),
					new ExpectedCellValue(sheetName, 322, 13, 6d),
					new ExpectedCellValue(sheetName, 323, 13, 6d),
					new ExpectedCellValue(sheetName, 324, 13, 2d),
					new ExpectedCellValue(sheetName, 325, 13, 2d),
					new ExpectedCellValue(sheetName, 326, 13, null),
					new ExpectedCellValue(sheetName, 327, 13, 831.5),
					new ExpectedCellValue(sheetName, 328, 13, 831.5),
					new ExpectedCellValue(sheetName, 329, 13, 1194d),
					new ExpectedCellValue(sheetName, 330, 13, 1194d),
					new ExpectedCellValue(sheetName, 331, 13, 831.5),
					new ExpectedCellValue(sheetName, 332, 13, 831.5),
					new ExpectedCellValue(sheetName, 333, 13, 10d),
					new ExpectedCellValue(sheetName, 334, 13, 2857d),
					new ExpectedCellValue(sheetName, 335, 13, null),
					new ExpectedCellValue(sheetName, 336, 13, null),
					new ExpectedCellValue(sheetName, 337, 13, 1d),
					new ExpectedCellValue(sheetName, 338, 13, 1d),
					new ExpectedCellValue(sheetName, 339, 13, 1d),
					new ExpectedCellValue(sheetName, 340, 13, 1d),
					new ExpectedCellValue(sheetName, 341, 13, null),
					new ExpectedCellValue(sheetName, 342, 13, 415.75),
					new ExpectedCellValue(sheetName, 343, 13, 415.75),
					new ExpectedCellValue(sheetName, 344, 13, 99d),
					new ExpectedCellValue(sheetName, 345, 13, 99d),
					new ExpectedCellValue(sheetName, 346, 13, 2d),
					new ExpectedCellValue(sheetName, 347, 13, 514.75),
					new ExpectedCellValue(sheetName, 348, 13, 15d),
					new ExpectedCellValue(sheetName, 349, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsFirstFieldDataFieldSecondThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable22"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A356:D394"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 356, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 357, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 358, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 359, 1, null),
					new ExpectedCellValue(sheetName, 360, 1, null),
					new ExpectedCellValue(sheetName, 361, 1, null),
					new ExpectedCellValue(sheetName, 362, 1, null),
					new ExpectedCellValue(sheetName, 363, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 364, 1, null),
					new ExpectedCellValue(sheetName, 365, 1, null),
					new ExpectedCellValue(sheetName, 366, 1, null),
					new ExpectedCellValue(sheetName, 367, 1, null),
					new ExpectedCellValue(sheetName, 368, 1, null),
					new ExpectedCellValue(sheetName, 369, 1, null),
					new ExpectedCellValue(sheetName, 370, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 371, 1, null),
					new ExpectedCellValue(sheetName, 372, 1, null),
					new ExpectedCellValue(sheetName, 373, 1, null),
					new ExpectedCellValue(sheetName, 374, 1, null),
					new ExpectedCellValue(sheetName, 375, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 376, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 377, 1, null),
					new ExpectedCellValue(sheetName, 378, 1, null),
					new ExpectedCellValue(sheetName, 379, 1, null),
					new ExpectedCellValue(sheetName, 380, 1, null),
					new ExpectedCellValue(sheetName, 381, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 382, 1, null),
					new ExpectedCellValue(sheetName, 383, 1, null),
					new ExpectedCellValue(sheetName, 384, 1, null),
					new ExpectedCellValue(sheetName, 385, 1, null),
					new ExpectedCellValue(sheetName, 386, 1, null),
					new ExpectedCellValue(sheetName, 387, 1, null),
					new ExpectedCellValue(sheetName, 388, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 389, 1, null),
					new ExpectedCellValue(sheetName, 390, 1, null),
					new ExpectedCellValue(sheetName, 391, 1, null),
					new ExpectedCellValue(sheetName, 392, 1, null),
					new ExpectedCellValue(sheetName, 393, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 394, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 356, 2, "Month"),
					new ExpectedCellValue(sheetName, 357, 2, null),
					new ExpectedCellValue(sheetName, 358, 2, null),
					new ExpectedCellValue(sheetName, 359, 2, "January"),
					new ExpectedCellValue(sheetName, 360, 2, null),
					new ExpectedCellValue(sheetName, 361, 2, "March"),
					new ExpectedCellValue(sheetName, 362, 2, null),
					new ExpectedCellValue(sheetName, 363, 2, null),
					new ExpectedCellValue(sheetName, 364, 2, "January"),
					new ExpectedCellValue(sheetName, 365, 2, null),
					new ExpectedCellValue(sheetName, 366, 2, "February"),
					new ExpectedCellValue(sheetName, 367, 2, null),
					new ExpectedCellValue(sheetName, 368, 2, "March"),
					new ExpectedCellValue(sheetName, 369, 2, null),
					new ExpectedCellValue(sheetName, 370, 2, null),
					new ExpectedCellValue(sheetName, 371, 2, "January"),
					new ExpectedCellValue(sheetName, 372, 2, null),
					new ExpectedCellValue(sheetName, 373, 2, "February"),
					new ExpectedCellValue(sheetName, 374, 2, null),
					new ExpectedCellValue(sheetName, 375, 2, null),
					new ExpectedCellValue(sheetName, 376, 2, null),
					new ExpectedCellValue(sheetName, 377, 2, "January"),
					new ExpectedCellValue(sheetName, 378, 2, null),
					new ExpectedCellValue(sheetName, 379, 2, "March"),
					new ExpectedCellValue(sheetName, 380, 2, null),
					new ExpectedCellValue(sheetName, 381, 2, null),
					new ExpectedCellValue(sheetName, 382, 2, "January"),
					new ExpectedCellValue(sheetName, 383, 2, null),
					new ExpectedCellValue(sheetName, 384, 2, "February"),
					new ExpectedCellValue(sheetName, 385, 2, null),
					new ExpectedCellValue(sheetName, 386, 2, "March"),
					new ExpectedCellValue(sheetName, 387, 2, null),
					new ExpectedCellValue(sheetName, 388, 2, null),
					new ExpectedCellValue(sheetName, 389, 2, "January"),
					new ExpectedCellValue(sheetName, 390, 2, null),
					new ExpectedCellValue(sheetName, 391, 2, "February"),
					new ExpectedCellValue(sheetName, 392, 2, null),
					new ExpectedCellValue(sheetName, 393, 2, null),
					new ExpectedCellValue(sheetName, 394, 2, null),
					new ExpectedCellValue(sheetName, 356, 3, "Item"),
					new ExpectedCellValue(sheetName, 357, 3, null),
					new ExpectedCellValue(sheetName, 358, 3, null),
					new ExpectedCellValue(sheetName, 359, 3, null),
					new ExpectedCellValue(sheetName, 360, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 361, 3, null),
					new ExpectedCellValue(sheetName, 362, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 363, 3, null),
					new ExpectedCellValue(sheetName, 364, 3, null),
					new ExpectedCellValue(sheetName, 365, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 366, 3, null),
					new ExpectedCellValue(sheetName, 367, 3, "Tent"),
					new ExpectedCellValue(sheetName, 368, 3, null),
					new ExpectedCellValue(sheetName, 369, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 370, 3, null),
					new ExpectedCellValue(sheetName, 371, 3, null),
					new ExpectedCellValue(sheetName, 372, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 3, null),
					new ExpectedCellValue(sheetName, 374, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 375, 3, null),
					new ExpectedCellValue(sheetName, 376, 3, null),
					new ExpectedCellValue(sheetName, 377, 3, null),
					new ExpectedCellValue(sheetName, 378, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 3, null),
					new ExpectedCellValue(sheetName, 380, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 381, 3, null),
					new ExpectedCellValue(sheetName, 382, 3, null),
					new ExpectedCellValue(sheetName, 383, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 3, null),
					new ExpectedCellValue(sheetName, 385, 3, "Tent"),
					new ExpectedCellValue(sheetName, 386, 3, null),
					new ExpectedCellValue(sheetName, 387, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 3, null),
					new ExpectedCellValue(sheetName, 389, 3, null),
					new ExpectedCellValue(sheetName, 390, 3, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 3, null),
					new ExpectedCellValue(sheetName, 392, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 393, 3, null),
					new ExpectedCellValue(sheetName, 394, 3, null),
					new ExpectedCellValue(sheetName, 356, 4, null),
					new ExpectedCellValue(sheetName, 357, 4, null),
					new ExpectedCellValue(sheetName, 358, 4, 3d),
					new ExpectedCellValue(sheetName, 359, 4, 2d),
					new ExpectedCellValue(sheetName, 360, 4, 2d),
					new ExpectedCellValue(sheetName, 361, 4, 1d),
					new ExpectedCellValue(sheetName, 362, 4, 1d),
					new ExpectedCellValue(sheetName, 363, 4, 10d),
					new ExpectedCellValue(sheetName, 364, 4, 2d),
					new ExpectedCellValue(sheetName, 365, 4, 2d),
					new ExpectedCellValue(sheetName, 366, 4, 6d),
					new ExpectedCellValue(sheetName, 367, 4, 6d),
					new ExpectedCellValue(sheetName, 368, 4, 2d),
					new ExpectedCellValue(sheetName, 369, 4, 2d),
					new ExpectedCellValue(sheetName, 370, 4, 2d),
					new ExpectedCellValue(sheetName, 371, 4, 1d),
					new ExpectedCellValue(sheetName, 372, 4, 1d),
					new ExpectedCellValue(sheetName, 373, 4, 1d),
					new ExpectedCellValue(sheetName, 374, 4, 1d),
					new ExpectedCellValue(sheetName, 375, 4, null),
					new ExpectedCellValue(sheetName, 376, 4, 856.49),
					new ExpectedCellValue(sheetName, 377, 4, 831.5),
					new ExpectedCellValue(sheetName, 378, 4, 831.5),
					new ExpectedCellValue(sheetName, 379, 4, 24.99),
					new ExpectedCellValue(sheetName, 380, 4, 24.99),
					new ExpectedCellValue(sheetName, 381, 4, 2857d),
					new ExpectedCellValue(sheetName, 382, 4, 831.5),
					new ExpectedCellValue(sheetName, 383, 4, 831.5),
					new ExpectedCellValue(sheetName, 384, 4, 1194d),
					new ExpectedCellValue(sheetName, 385, 4, 1194d),
					new ExpectedCellValue(sheetName, 386, 4, 831.5),
					new ExpectedCellValue(sheetName, 387, 4, 831.5),
					new ExpectedCellValue(sheetName, 388, 4, 514.75),
					new ExpectedCellValue(sheetName, 389, 4, 415.75),
					new ExpectedCellValue(sheetName, 390, 4, 415.75),
					new ExpectedCellValue(sheetName, 391, 4, 99d),
					new ExpectedCellValue(sheetName, 392, 4, 99d),
					new ExpectedCellValue(sheetName, 393, 4, 15d),
					new ExpectedCellValue(sheetName, 394, 4, 4228.24),
				});
			}
		}
		
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsFirstFieldDataFieldSecondAndThirdFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable23"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("G356:J394"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 356, 7, "Row Labels"),
					new ExpectedCellValue(sheetName, 357, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 358, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 359, 7, null),
					new ExpectedCellValue(sheetName, 360, 7, null),
					new ExpectedCellValue(sheetName, 361, 7, null),
					new ExpectedCellValue(sheetName, 362, 7, null),
					new ExpectedCellValue(sheetName, 363, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 364, 7, null),
					new ExpectedCellValue(sheetName, 365, 7, null),
					new ExpectedCellValue(sheetName, 366, 7, null),
					new ExpectedCellValue(sheetName, 367, 7, null),
					new ExpectedCellValue(sheetName, 368, 7, null),
					new ExpectedCellValue(sheetName, 369, 7, null),
					new ExpectedCellValue(sheetName, 370, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 371, 7, null),
					new ExpectedCellValue(sheetName, 372, 7, null),
					new ExpectedCellValue(sheetName, 373, 7, null),
					new ExpectedCellValue(sheetName, 374, 7, null),
					new ExpectedCellValue(sheetName, 375, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 376, 7, "Chicago"),
					new ExpectedCellValue(sheetName, 377, 7, null),
					new ExpectedCellValue(sheetName, 378, 7, null),
					new ExpectedCellValue(sheetName, 379, 7, null),
					new ExpectedCellValue(sheetName, 380, 7, null),
					new ExpectedCellValue(sheetName, 381, 7, "Nashville"),
					new ExpectedCellValue(sheetName, 382, 7, null),
					new ExpectedCellValue(sheetName, 383, 7, null),
					new ExpectedCellValue(sheetName, 384, 7, null),
					new ExpectedCellValue(sheetName, 385, 7, null),
					new ExpectedCellValue(sheetName, 386, 7, null),
					new ExpectedCellValue(sheetName, 387, 7, null),
					new ExpectedCellValue(sheetName, 388, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 389, 7, null),
					new ExpectedCellValue(sheetName, 390, 7, null),
					new ExpectedCellValue(sheetName, 391, 7, null),
					new ExpectedCellValue(sheetName, 392, 7, null),
					new ExpectedCellValue(sheetName, 393, 7, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 394, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 356, 8, "Month"),
					new ExpectedCellValue(sheetName, 357, 8, null),
					new ExpectedCellValue(sheetName, 358, 8, null),
					new ExpectedCellValue(sheetName, 359, 8, "January"),
					new ExpectedCellValue(sheetName, 360, 8, null),
					new ExpectedCellValue(sheetName, 361, 8, "March"),
					new ExpectedCellValue(sheetName, 362, 8, null),
					new ExpectedCellValue(sheetName, 363, 8, null),
					new ExpectedCellValue(sheetName, 364, 8, "January"),
					new ExpectedCellValue(sheetName, 365, 8, null),
					new ExpectedCellValue(sheetName, 366, 8, "February"),
					new ExpectedCellValue(sheetName, 367, 8, null),
					new ExpectedCellValue(sheetName, 368, 8, "March"),
					new ExpectedCellValue(sheetName, 369, 8, null),
					new ExpectedCellValue(sheetName, 370, 8, null),
					new ExpectedCellValue(sheetName, 371, 8, "January"),
					new ExpectedCellValue(sheetName, 372, 8, null),
					new ExpectedCellValue(sheetName, 373, 8, "February"),
					new ExpectedCellValue(sheetName, 374, 8, null),
					new ExpectedCellValue(sheetName, 375, 8, null),
					new ExpectedCellValue(sheetName, 376, 8, null),
					new ExpectedCellValue(sheetName, 377, 8, "January"),
					new ExpectedCellValue(sheetName, 378, 8, null),
					new ExpectedCellValue(sheetName, 379, 8, "March"),
					new ExpectedCellValue(sheetName, 380, 8, null),
					new ExpectedCellValue(sheetName, 381, 8, null),
					new ExpectedCellValue(sheetName, 382, 8, "January"),
					new ExpectedCellValue(sheetName, 383, 8, null),
					new ExpectedCellValue(sheetName, 384, 8, "February"),
					new ExpectedCellValue(sheetName, 385, 8, null),
					new ExpectedCellValue(sheetName, 386, 8, "March"),
					new ExpectedCellValue(sheetName, 387, 8, null),
					new ExpectedCellValue(sheetName, 388, 8, null),
					new ExpectedCellValue(sheetName, 389, 8, "January"),
					new ExpectedCellValue(sheetName, 390, 8, null),
					new ExpectedCellValue(sheetName, 391, 8, "February"),
					new ExpectedCellValue(sheetName, 392, 8, null),
					new ExpectedCellValue(sheetName, 393, 8, null),
					new ExpectedCellValue(sheetName, 394, 8, null),
					new ExpectedCellValue(sheetName, 356, 9, "Item"),
					new ExpectedCellValue(sheetName, 357, 9, null),
					new ExpectedCellValue(sheetName, 358, 9, null),
					new ExpectedCellValue(sheetName, 359, 9, null),
					new ExpectedCellValue(sheetName, 360, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 361, 9, null),
					new ExpectedCellValue(sheetName, 362, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 363, 9, null),
					new ExpectedCellValue(sheetName, 364, 9, null),
					new ExpectedCellValue(sheetName, 365, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 366, 9, null),
					new ExpectedCellValue(sheetName, 367, 9, "Tent"),
					new ExpectedCellValue(sheetName, 368, 9, null),
					new ExpectedCellValue(sheetName, 369, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 370, 9, null),
					new ExpectedCellValue(sheetName, 371, 9, null),
					new ExpectedCellValue(sheetName, 372, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 9, null),
					new ExpectedCellValue(sheetName, 374, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 375, 9, null),
					new ExpectedCellValue(sheetName, 376, 9, null),
					new ExpectedCellValue(sheetName, 377, 9, null),
					new ExpectedCellValue(sheetName, 378, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 9, null),
					new ExpectedCellValue(sheetName, 380, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 381, 9, null),
					new ExpectedCellValue(sheetName, 382, 9, null),
					new ExpectedCellValue(sheetName, 383, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 9, null),
					new ExpectedCellValue(sheetName, 385, 9, "Tent"),
					new ExpectedCellValue(sheetName, 386, 9, null),
					new ExpectedCellValue(sheetName, 387, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 9, null),
					new ExpectedCellValue(sheetName, 389, 9, null),
					new ExpectedCellValue(sheetName, 390, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 9, null),
					new ExpectedCellValue(sheetName, 392, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 393, 9, null),
					new ExpectedCellValue(sheetName, 394, 9, null),
					new ExpectedCellValue(sheetName, 356, 10, null),
					new ExpectedCellValue(sheetName, 357, 10, null),
					new ExpectedCellValue(sheetName, 358, 10, 3d),
					new ExpectedCellValue(sheetName, 359, 10, 2d),
					new ExpectedCellValue(sheetName, 360, 10, 2d),
					new ExpectedCellValue(sheetName, 361, 10, 1d),
					new ExpectedCellValue(sheetName, 362, 10, 1d),
					new ExpectedCellValue(sheetName, 363, 10, 10d),
					new ExpectedCellValue(sheetName, 364, 10, 2d),
					new ExpectedCellValue(sheetName, 365, 10, 2d),
					new ExpectedCellValue(sheetName, 366, 10, 6d),
					new ExpectedCellValue(sheetName, 367, 10, 6d),
					new ExpectedCellValue(sheetName, 368, 10, 2d),
					new ExpectedCellValue(sheetName, 369, 10, 2d),
					new ExpectedCellValue(sheetName, 370, 10, 2d),
					new ExpectedCellValue(sheetName, 371, 10, 1d),
					new ExpectedCellValue(sheetName, 372, 10, 1d),
					new ExpectedCellValue(sheetName, 373, 10, 1d),
					new ExpectedCellValue(sheetName, 374, 10, 1d),
					new ExpectedCellValue(sheetName, 375, 10, null),
					new ExpectedCellValue(sheetName, 376, 10, 856.49),
					new ExpectedCellValue(sheetName, 377, 10, 831.5),
					new ExpectedCellValue(sheetName, 378, 10, 831.5),
					new ExpectedCellValue(sheetName, 379, 10, 24.99),
					new ExpectedCellValue(sheetName, 380, 10, 24.99),
					new ExpectedCellValue(sheetName, 381, 10, 2857d),
					new ExpectedCellValue(sheetName, 382, 10, 831.5),
					new ExpectedCellValue(sheetName, 383, 10, 831.5),
					new ExpectedCellValue(sheetName, 384, 10, 1194d),
					new ExpectedCellValue(sheetName, 385, 10, 1194d),
					new ExpectedCellValue(sheetName, 386, 10, 831.5),
					new ExpectedCellValue(sheetName, 387, 10, 831.5),
					new ExpectedCellValue(sheetName, 388, 10, 514.75),
					new ExpectedCellValue(sheetName, 389, 10, 415.75),
					new ExpectedCellValue(sheetName, 390, 10, 415.75),
					new ExpectedCellValue(sheetName, 391, 10, 99d),
					new ExpectedCellValue(sheetName, 392, 10, 99d),
					new ExpectedCellValue(sheetName, 393, 10, 15d),
					new ExpectedCellValue(sheetName, 394, 10, 4228.24),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsFirstFieldDataFieldThirdAndLastFieldsCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable24"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("L356:N394"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 356, 12, "Row Labels"),
					new ExpectedCellValue(sheetName, 357, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 358, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 359, 12, "January"),
					new ExpectedCellValue(sheetName, 360, 12, null),
					new ExpectedCellValue(sheetName, 361, 12, "March"),
					new ExpectedCellValue(sheetName, 362, 12, null),
					new ExpectedCellValue(sheetName, 363, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 364, 12, "January"),
					new ExpectedCellValue(sheetName, 365, 12, null),
					new ExpectedCellValue(sheetName, 366, 12, "February"),
					new ExpectedCellValue(sheetName, 367, 12, null),
					new ExpectedCellValue(sheetName, 368, 12, "March"),
					new ExpectedCellValue(sheetName, 369, 12, null),
					new ExpectedCellValue(sheetName, 370, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 371, 12, "January"),
					new ExpectedCellValue(sheetName, 372, 12, null),
					new ExpectedCellValue(sheetName, 373, 12, "February"),
					new ExpectedCellValue(sheetName, 374, 12, null),
					new ExpectedCellValue(sheetName, 375, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 376, 12, "Chicago"),
					new ExpectedCellValue(sheetName, 377, 12, "January"),
					new ExpectedCellValue(sheetName, 378, 12, null),
					new ExpectedCellValue(sheetName, 379, 12, "March"),
					new ExpectedCellValue(sheetName, 380, 12, null),
					new ExpectedCellValue(sheetName, 381, 12, "Nashville"),
					new ExpectedCellValue(sheetName, 382, 12, "January"),
					new ExpectedCellValue(sheetName, 383, 12, null),
					new ExpectedCellValue(sheetName, 384, 12, "February"),
					new ExpectedCellValue(sheetName, 385, 12, null),
					new ExpectedCellValue(sheetName, 386, 12, "March"),
					new ExpectedCellValue(sheetName, 387, 12, null),
					new ExpectedCellValue(sheetName, 388, 12, "San Francisco"),
					new ExpectedCellValue(sheetName, 389, 12, "January"),
					new ExpectedCellValue(sheetName, 390, 12, null),
					new ExpectedCellValue(sheetName, 391, 12, "February"),
					new ExpectedCellValue(sheetName, 392, 12, null),
					new ExpectedCellValue(sheetName, 393, 12, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 394, 12, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 356, 13, "Item"),
					new ExpectedCellValue(sheetName, 357, 13, null),
					new ExpectedCellValue(sheetName, 358, 13, null),
					new ExpectedCellValue(sheetName, 359, 13, null),
					new ExpectedCellValue(sheetName, 360, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 361, 13, null),
					new ExpectedCellValue(sheetName, 362, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 363, 13, null),
					new ExpectedCellValue(sheetName, 364, 13, null),
					new ExpectedCellValue(sheetName, 365, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 366, 13, null),
					new ExpectedCellValue(sheetName, 367, 13, "Tent"),
					new ExpectedCellValue(sheetName, 368, 13, null),
					new ExpectedCellValue(sheetName, 369, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 370, 13, null),
					new ExpectedCellValue(sheetName, 371, 13, null),
					new ExpectedCellValue(sheetName, 372, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 13, null),
					new ExpectedCellValue(sheetName, 374, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 375, 13, null),
					new ExpectedCellValue(sheetName, 376, 13, null),
					new ExpectedCellValue(sheetName, 377, 13, null),
					new ExpectedCellValue(sheetName, 378, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 13, null),
					new ExpectedCellValue(sheetName, 380, 13, "Headlamp"),
					new ExpectedCellValue(sheetName, 381, 13, null),
					new ExpectedCellValue(sheetName, 382, 13, null),
					new ExpectedCellValue(sheetName, 383, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 13, null),
					new ExpectedCellValue(sheetName, 385, 13, "Tent"),
					new ExpectedCellValue(sheetName, 386, 13, null),
					new ExpectedCellValue(sheetName, 387, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 13, null),
					new ExpectedCellValue(sheetName, 389, 13, null),
					new ExpectedCellValue(sheetName, 390, 13, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 13, null),
					new ExpectedCellValue(sheetName, 392, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 393, 13, null),
					new ExpectedCellValue(sheetName, 394, 13, null),
					new ExpectedCellValue(sheetName, 356, 14, null),
					new ExpectedCellValue(sheetName, 357, 14, null),
					new ExpectedCellValue(sheetName, 358, 14, 3d),
					new ExpectedCellValue(sheetName, 359, 14, 2d),
					new ExpectedCellValue(sheetName, 360, 14, 2d),
					new ExpectedCellValue(sheetName, 361, 14, 1d),
					new ExpectedCellValue(sheetName, 362, 14, 1d),
					new ExpectedCellValue(sheetName, 363, 14, 10d),
					new ExpectedCellValue(sheetName, 364, 14, 2d),
					new ExpectedCellValue(sheetName, 365, 14, 2d),
					new ExpectedCellValue(sheetName, 366, 14, 6d),
					new ExpectedCellValue(sheetName, 367, 14, 6d),
					new ExpectedCellValue(sheetName, 368, 14, 2d),
					new ExpectedCellValue(sheetName, 369, 14, 2d),
					new ExpectedCellValue(sheetName, 370, 14, 2d),
					new ExpectedCellValue(sheetName, 371, 14, 1d),
					new ExpectedCellValue(sheetName, 372, 14, 1d),
					new ExpectedCellValue(sheetName, 373, 14, 1d),
					new ExpectedCellValue(sheetName, 374, 14, 1d),
					new ExpectedCellValue(sheetName, 375, 14, null),
					new ExpectedCellValue(sheetName, 376, 14, 856.49),
					new ExpectedCellValue(sheetName, 377, 14, 831.5),
					new ExpectedCellValue(sheetName, 378, 14, 831.5),
					new ExpectedCellValue(sheetName, 379, 14, 24.99),
					new ExpectedCellValue(sheetName, 380, 14, 24.99),
					new ExpectedCellValue(sheetName, 381, 14, 2857d),
					new ExpectedCellValue(sheetName, 382, 14, 831.5),
					new ExpectedCellValue(sheetName, 383, 14, 831.5),
					new ExpectedCellValue(sheetName, 384, 14, 1194d),
					new ExpectedCellValue(sheetName, 385, 14, 1194d),
					new ExpectedCellValue(sheetName, 386, 14, 831.5),
					new ExpectedCellValue(sheetName, 387, 14, 831.5),
					new ExpectedCellValue(sheetName, 388, 14, 514.75),
					new ExpectedCellValue(sheetName, 389, 14, 415.75),
					new ExpectedCellValue(sheetName, 390, 14, 415.75),
					new ExpectedCellValue(sheetName, 391, 14, 99d),
					new ExpectedCellValue(sheetName, 392, 14, 99d),
					new ExpectedCellValue(sheetName, 393, 14, 15d),
					new ExpectedCellValue(sheetName, 394, 14, 4228.24),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsFirstFieldDataFieldThirdFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable25"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q356:S394"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 356, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 357, 17, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 358, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 359, 17, "January"),
					new ExpectedCellValue(sheetName, 360, 17, null),
					new ExpectedCellValue(sheetName, 361, 17, "March"),
					new ExpectedCellValue(sheetName, 362, 17, null),
					new ExpectedCellValue(sheetName, 363, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 364, 17, "January"),
					new ExpectedCellValue(sheetName, 365, 17, null),
					new ExpectedCellValue(sheetName, 366, 17, "February"),
					new ExpectedCellValue(sheetName, 367, 17, null),
					new ExpectedCellValue(sheetName, 368, 17, "March"),
					new ExpectedCellValue(sheetName, 369, 17, null),
					new ExpectedCellValue(sheetName, 370, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 371, 17, "January"),
					new ExpectedCellValue(sheetName, 372, 17, null),
					new ExpectedCellValue(sheetName, 373, 17, "February"),
					new ExpectedCellValue(sheetName, 374, 17, null),
					new ExpectedCellValue(sheetName, 375, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 376, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 377, 17, "January"),
					new ExpectedCellValue(sheetName, 378, 17, null),
					new ExpectedCellValue(sheetName, 379, 17, "March"),
					new ExpectedCellValue(sheetName, 380, 17, null),
					new ExpectedCellValue(sheetName, 381, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 382, 17, "January"),
					new ExpectedCellValue(sheetName, 383, 17, null),
					new ExpectedCellValue(sheetName, 384, 17, "February"),
					new ExpectedCellValue(sheetName, 385, 17, null),
					new ExpectedCellValue(sheetName, 386, 17, "March"),
					new ExpectedCellValue(sheetName, 387, 17, null),
					new ExpectedCellValue(sheetName, 388, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 389, 17, "January"),
					new ExpectedCellValue(sheetName, 390, 17, null),
					new ExpectedCellValue(sheetName, 391, 17, "February"),
					new ExpectedCellValue(sheetName, 392, 17, null),
					new ExpectedCellValue(sheetName, 393, 17, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 394, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 356, 18, "Item"),
					new ExpectedCellValue(sheetName, 357, 18, null),
					new ExpectedCellValue(sheetName, 358, 18, null),
					new ExpectedCellValue(sheetName, 359, 18, null),
					new ExpectedCellValue(sheetName, 360, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 361, 18, null),
					new ExpectedCellValue(sheetName, 362, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 363, 18, null),
					new ExpectedCellValue(sheetName, 364, 18, null),
					new ExpectedCellValue(sheetName, 365, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 366, 18, null),
					new ExpectedCellValue(sheetName, 367, 18, "Tent"),
					new ExpectedCellValue(sheetName, 368, 18, null),
					new ExpectedCellValue(sheetName, 369, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 370, 18, null),
					new ExpectedCellValue(sheetName, 371, 18, null),
					new ExpectedCellValue(sheetName, 372, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 18, null),
					new ExpectedCellValue(sheetName, 374, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 375, 18, null),
					new ExpectedCellValue(sheetName, 376, 18, null),
					new ExpectedCellValue(sheetName, 377, 18, null),
					new ExpectedCellValue(sheetName, 378, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 18, null),
					new ExpectedCellValue(sheetName, 380, 18, "Headlamp"),
					new ExpectedCellValue(sheetName, 381, 18, null),
					new ExpectedCellValue(sheetName, 382, 18, null),
					new ExpectedCellValue(sheetName, 383, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 18, null),
					new ExpectedCellValue(sheetName, 385, 18, "Tent"),
					new ExpectedCellValue(sheetName, 386, 18, null),
					new ExpectedCellValue(sheetName, 387, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 18, null),
					new ExpectedCellValue(sheetName, 389, 18, null),
					new ExpectedCellValue(sheetName, 390, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 18, null),
					new ExpectedCellValue(sheetName, 392, 18, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 393, 18, null),
					new ExpectedCellValue(sheetName, 394, 18, null),
					new ExpectedCellValue(sheetName, 356, 19, null),
					new ExpectedCellValue(sheetName, 357, 19, null),
					new ExpectedCellValue(sheetName, 358, 19, 3d),
					new ExpectedCellValue(sheetName, 359, 19, 2d),
					new ExpectedCellValue(sheetName, 360, 19, 2d),
					new ExpectedCellValue(sheetName, 361, 19, 1d),
					new ExpectedCellValue(sheetName, 362, 19, 1d),
					new ExpectedCellValue(sheetName, 363, 19, 10d),
					new ExpectedCellValue(sheetName, 364, 19, 2d),
					new ExpectedCellValue(sheetName, 365, 19, 2d),
					new ExpectedCellValue(sheetName, 366, 19, 6d),
					new ExpectedCellValue(sheetName, 367, 19, 6d),
					new ExpectedCellValue(sheetName, 368, 19, 2d),
					new ExpectedCellValue(sheetName, 369, 19, 2d),
					new ExpectedCellValue(sheetName, 370, 19, 2d),
					new ExpectedCellValue(sheetName, 371, 19, 1d),
					new ExpectedCellValue(sheetName, 372, 19, 1d),
					new ExpectedCellValue(sheetName, 373, 19, 1d),
					new ExpectedCellValue(sheetName, 374, 19, 1d),
					new ExpectedCellValue(sheetName, 375, 19, null),
					new ExpectedCellValue(sheetName, 376, 19, 856.49),
					new ExpectedCellValue(sheetName, 377, 19, 831.5),
					new ExpectedCellValue(sheetName, 378, 19, 831.5),
					new ExpectedCellValue(sheetName, 379, 19, 24.99),
					new ExpectedCellValue(sheetName, 380, 19, 24.99),
					new ExpectedCellValue(sheetName, 381, 19, 2857d),
					new ExpectedCellValue(sheetName, 382, 19, 831.5),
					new ExpectedCellValue(sheetName, 383, 19, 831.5),
					new ExpectedCellValue(sheetName, 384, 19, 1194d),
					new ExpectedCellValue(sheetName, 385, 19, 1194d),
					new ExpectedCellValue(sheetName, 386, 19, 831.5),
					new ExpectedCellValue(sheetName, 387, 19, 831.5),
					new ExpectedCellValue(sheetName, 388, 19, 514.75),
					new ExpectedCellValue(sheetName, 389, 19, 415.75),
					new ExpectedCellValue(sheetName, 390, 19, 415.75),
					new ExpectedCellValue(sheetName, 391, 19, 99d),
					new ExpectedCellValue(sheetName, 392, 19, 99d),
					new ExpectedCellValue(sheetName, 393, 19, 15d),
					new ExpectedCellValue(sheetName, 394, 19, 4228.24),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactFormMultipleDataFields.xlsx")]
		public void PivotTableCompactFormThreeRowFieldsMultipleRowDataFieldsFirstFieldDataFieldLastFieldCompactFormFalse()
		{
			var file = new FileInfo("PivotTableCompactFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable26"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("V356:W394"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 356, 22, "Row Labels"),
					new ExpectedCellValue(sheetName, 357, 22, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 358, 22, "Chicago"),
					new ExpectedCellValue(sheetName, 359, 22, "January"),
					new ExpectedCellValue(sheetName, 360, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 361, 22, "March"),
					new ExpectedCellValue(sheetName, 362, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 363, 22, "Nashville"),
					new ExpectedCellValue(sheetName, 364, 22, "January"),
					new ExpectedCellValue(sheetName, 365, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 366, 22, "February"),
					new ExpectedCellValue(sheetName, 367, 22, "Tent"),
					new ExpectedCellValue(sheetName, 368, 22, "March"),
					new ExpectedCellValue(sheetName, 369, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 370, 22, "San Francisco"),
					new ExpectedCellValue(sheetName, 371, 22, "January"),
					new ExpectedCellValue(sheetName, 372, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 22, "February"),
					new ExpectedCellValue(sheetName, 374, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 375, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 376, 22, "Chicago"),
					new ExpectedCellValue(sheetName, 377, 22, "January"),
					new ExpectedCellValue(sheetName, 378, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 22, "March"),
					new ExpectedCellValue(sheetName, 380, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 381, 22, "Nashville"),
					new ExpectedCellValue(sheetName, 382, 22, "January"),
					new ExpectedCellValue(sheetName, 383, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 22, "February"),
					new ExpectedCellValue(sheetName, 385, 22, "Tent"),
					new ExpectedCellValue(sheetName, 386, 22, "March"),
					new ExpectedCellValue(sheetName, 387, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 388, 22, "San Francisco"),
					new ExpectedCellValue(sheetName, 389, 22, "January"),
					new ExpectedCellValue(sheetName, 390, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 22, "February"),
					new ExpectedCellValue(sheetName, 392, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 393, 22, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 394, 22, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 356, 23, null),
					new ExpectedCellValue(sheetName, 357, 23, null),
					new ExpectedCellValue(sheetName, 358, 23, 3d),
					new ExpectedCellValue(sheetName, 359, 23, 2d),
					new ExpectedCellValue(sheetName, 360, 23, 2d),
					new ExpectedCellValue(sheetName, 361, 23, 1d),
					new ExpectedCellValue(sheetName, 362, 23, 1d),
					new ExpectedCellValue(sheetName, 363, 23, 10d),
					new ExpectedCellValue(sheetName, 364, 23, 2d),
					new ExpectedCellValue(sheetName, 365, 23, 2d),
					new ExpectedCellValue(sheetName, 366, 23, 6d),
					new ExpectedCellValue(sheetName, 367, 23, 6d),
					new ExpectedCellValue(sheetName, 368, 23, 2d),
					new ExpectedCellValue(sheetName, 369, 23, 2d),
					new ExpectedCellValue(sheetName, 370, 23, 2d),
					new ExpectedCellValue(sheetName, 371, 23, 1d),
					new ExpectedCellValue(sheetName, 372, 23, 1d),
					new ExpectedCellValue(sheetName, 373, 23, 1d),
					new ExpectedCellValue(sheetName, 374, 23, 1d),
					new ExpectedCellValue(sheetName, 375, 23, null),
					new ExpectedCellValue(sheetName, 376, 23, 856.49),
					new ExpectedCellValue(sheetName, 377, 23, 831.5),
					new ExpectedCellValue(sheetName, 378, 23, 831.5),
					new ExpectedCellValue(sheetName, 379, 23, 24.99),
					new ExpectedCellValue(sheetName, 380, 23, 24.99),
					new ExpectedCellValue(sheetName, 381, 23, 2857d),
					new ExpectedCellValue(sheetName, 382, 23, 831.5),
					new ExpectedCellValue(sheetName, 383, 23, 831.5),
					new ExpectedCellValue(sheetName, 384, 23, 1194d),
					new ExpectedCellValue(sheetName, 385, 23, 1194d),
					new ExpectedCellValue(sheetName, 386, 23, 831.5),
					new ExpectedCellValue(sheetName, 387, 23, 831.5),
					new ExpectedCellValue(sheetName, 388, 23, 514.75),
					new ExpectedCellValue(sheetName, 389, 23, 415.75),
					new ExpectedCellValue(sheetName, 390, 23, 415.75),
					new ExpectedCellValue(sheetName, 391, 23, 99d),
					new ExpectedCellValue(sheetName, 392, 23, 99d),
					new ExpectedCellValue(sheetName, 393, 23, 15d),
					new ExpectedCellValue(sheetName, 394, 23, 4228.24)
				});
			}
		}
		#endregion

		#region Tabular & Compact Form
		#region Single Multiple Data Fields
		// Two Row Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsNonCompactFormFirstFieldAndTabularLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A5:C16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, null),
					new ExpectedCellValue(sheetName, 16, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 2, "Month"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "January"),
					new ExpectedCellValue(sheetName, 8, 2, "March"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "January"),
					new ExpectedCellValue(sheetName, 11, 2, "February"),
					new ExpectedCellValue(sheetName, 12, 2, "March"),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, "January"),
					new ExpectedCellValue(sheetName, 15, 2, "February"),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 5, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, 831.5),
					new ExpectedCellValue(sheetName, 8, 3, 24.99),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, 831.5),
					new ExpectedCellValue(sheetName, 11, 3, 1194d),
					new ExpectedCellValue(sheetName, 12, 3, 831.5),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, 415.75),
					new ExpectedCellValue(sheetName, 15, 3, 99d),
					new ExpectedCellValue(sheetName, 16, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsNonCompactFormFirstFieldAndTabularLastFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Top;
						field.SubTotalFunctions = eSubTotalFunctions.Default;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A5:C16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 1, null),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 1, null),
					new ExpectedCellValue(sheetName, 15, 1, null),
					new ExpectedCellValue(sheetName, 16, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 2, "Month"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "January"),
					new ExpectedCellValue(sheetName, 8, 2, "March"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, "January"),
					new ExpectedCellValue(sheetName, 11, 2, "February"),
					new ExpectedCellValue(sheetName, 12, 2, "March"),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, "January"),
					new ExpectedCellValue(sheetName, 15, 2, "February"),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 5, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 3, 856.49),
					new ExpectedCellValue(sheetName, 7, 3, 831.5),
					new ExpectedCellValue(sheetName, 8, 3, 24.99),
					new ExpectedCellValue(sheetName, 9, 3, 2857d),
					new ExpectedCellValue(sheetName, 10, 3, 831.5),
					new ExpectedCellValue(sheetName, 11, 3, 1194d),
					new ExpectedCellValue(sheetName, 12, 3, 831.5),
					new ExpectedCellValue(sheetName, 13, 3, 514.75),
					new ExpectedCellValue(sheetName, 14, 3, 415.75),
					new ExpectedCellValue(sheetName, 15, 3, 99d),
					new ExpectedCellValue(sheetName, 16, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsNonCompactFormFirstFieldAndTabularLastFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A5:C19"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 1, null),
					new ExpectedCellValue(sheetName, 8, 1, null),
					new ExpectedCellValue(sheetName, 9, 1, "Chicago Total"),
					new ExpectedCellValue(sheetName, 10, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 1, null),
					new ExpectedCellValue(sheetName, 12, 1, null),
					new ExpectedCellValue(sheetName, 13, 1, null),
					new ExpectedCellValue(sheetName, 14, 1, "Nashville Total"),
					new ExpectedCellValue(sheetName, 15, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 1, null),
					new ExpectedCellValue(sheetName, 17, 1, null),
					new ExpectedCellValue(sheetName, 18, 1, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 19, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 2, "Month"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, "January"),
					new ExpectedCellValue(sheetName, 8, 2, "March"),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, "January"),
					new ExpectedCellValue(sheetName, 12, 2, "February"),
					new ExpectedCellValue(sheetName, 13, 2, "March"),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, "January"),
					new ExpectedCellValue(sheetName, 17, 2, "February"),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 5, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, 831.5),
					new ExpectedCellValue(sheetName, 8, 3, 24.99),
					new ExpectedCellValue(sheetName, 9, 3, 856.49),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, 831.5),
					new ExpectedCellValue(sheetName, 12, 3, 1194d),
					new ExpectedCellValue(sheetName, 13, 3, 831.5),
					new ExpectedCellValue(sheetName, 14, 3, 2857d),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, 415.75),
					new ExpectedCellValue(sheetName, 17, 3, 99d),
					new ExpectedCellValue(sheetName, 18, 3, 514.75),
					new ExpectedCellValue(sheetName, 19, 3, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsTabularFirstFieldAndNonCompactFormLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F5:H13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 7, "Month"),
					new ExpectedCellValue(sheetName, 6, 7, "January"),
					new ExpectedCellValue(sheetName, 7, 7, "March"),
					new ExpectedCellValue(sheetName, 8, 7, "January"),
					new ExpectedCellValue(sheetName, 9, 7, "February"),
					new ExpectedCellValue(sheetName, 10, 7, "March"),
					new ExpectedCellValue(sheetName, 11, 7, "January"),
					new ExpectedCellValue(sheetName, 12, 7, "February"),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 5, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 7, 8, 24.99),
					new ExpectedCellValue(sheetName, 8, 8, 831.5),
					new ExpectedCellValue(sheetName, 9, 8, 1194d),
					new ExpectedCellValue(sheetName, 10, 8, 831.5),
					new ExpectedCellValue(sheetName, 11, 8, 415.75),
					new ExpectedCellValue(sheetName, 12, 8, 99d),
					new ExpectedCellValue(sheetName, 13, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsTabularFirstFieldAndNonCompactFormLastFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F5:H16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 13, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 16, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 7, "Month"),
					new ExpectedCellValue(sheetName, 6, 7, "January"),
					new ExpectedCellValue(sheetName, 7, 7, "March"),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, "January"),
					new ExpectedCellValue(sheetName, 10, 7, "February"),
					new ExpectedCellValue(sheetName, 11, 7, "March"),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, "January"),
					new ExpectedCellValue(sheetName, 14, 7, "February"),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 5, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 7, 8, 24.99),
					new ExpectedCellValue(sheetName, 8, 8, 856.49),
					new ExpectedCellValue(sheetName, 9, 8, 831.5),
					new ExpectedCellValue(sheetName, 10, 8, 1194d),
					new ExpectedCellValue(sheetName, 11, 8, 831.5),
					new ExpectedCellValue(sheetName, 12, 8, 2857d),
					new ExpectedCellValue(sheetName, 13, 8, 415.75),
					new ExpectedCellValue(sheetName, 14, 8, 99d),
					new ExpectedCellValue(sheetName, 15, 8, 514.75),
					new ExpectedCellValue(sheetName, 16, 8, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsTabularFirstFieldAndNonCompactFormLastFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F5:H16"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 6, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, "Chicago Total"),
					new ExpectedCellValue(sheetName, 9, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 13, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 16, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 5, 7, "Month"),
					new ExpectedCellValue(sheetName, 6, 7, "January"),
					new ExpectedCellValue(sheetName, 7, 7, "March"),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, "January"),
					new ExpectedCellValue(sheetName, 10, 7, "February"),
					new ExpectedCellValue(sheetName, 11, 7, "March"),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, "January"),
					new ExpectedCellValue(sheetName, 14, 7, "February"),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 5, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 8, 831.5),
					new ExpectedCellValue(sheetName, 7, 8, 24.99),
					new ExpectedCellValue(sheetName, 8, 8, 856.49),
					new ExpectedCellValue(sheetName, 9, 8, 831.5),
					new ExpectedCellValue(sheetName, 10, 8, 1194d),
					new ExpectedCellValue(sheetName, 11, 8, 831.5),
					new ExpectedCellValue(sheetName, 12, 8, 2857d),
					new ExpectedCellValue(sheetName, 13, 8, 415.75),
					new ExpectedCellValue(sheetName, 14, 8, 99d),
					new ExpectedCellValue(sheetName, 15, 8, 514.75),
					new ExpectedCellValue(sheetName, 16, 8, 4228.24)
				});
			}
		}

		// Three Row Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstAndSecondFieldsAndTabularLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H6:K24"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 9, "Month"),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, "January"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, "March"),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, "January"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, "February"),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, "March"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, "January"),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, "February"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 6, 10, "Item"),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, "Tent"),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 6, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, 831.5),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, 24.99),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, 831.5),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, 1194d),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, 831.5),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, 415.75),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, 99d),
					new ExpectedCellValue(sheetName, 24, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstAndSecondFieldsAndTabularLastFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H6:K24"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 9, "Month"),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, "January"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, "March"),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, "January"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, "February"),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, "March"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, "January"),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, "February"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 6, 10, "Item"),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, "Tent"),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 6, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 11, 856.49),
					new ExpectedCellValue(sheetName, 8, 11, 831.5),
					new ExpectedCellValue(sheetName, 9, 11, 831.5),
					new ExpectedCellValue(sheetName, 10, 11, 24.99),
					new ExpectedCellValue(sheetName, 11, 11, 24.99),
					new ExpectedCellValue(sheetName, 12, 11, 2857d),
					new ExpectedCellValue(sheetName, 13, 11, 831.5),
					new ExpectedCellValue(sheetName, 14, 11, 831.5),
					new ExpectedCellValue(sheetName, 15, 11, 1194d),
					new ExpectedCellValue(sheetName, 16, 11, 1194d),
					new ExpectedCellValue(sheetName, 17, 11, 831.5),
					new ExpectedCellValue(sheetName, 18, 11, 831.5),
					new ExpectedCellValue(sheetName, 19, 11, 514.75),
					new ExpectedCellValue(sheetName, 20, 11, 415.75),
					new ExpectedCellValue(sheetName, 21, 11, 415.75),
					new ExpectedCellValue(sheetName, 22, 11, 99d),
					new ExpectedCellValue(sheetName, 23, 11, 99d),
					new ExpectedCellValue(sheetName, 24, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstAndSecondFieldsAndTabularLastFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H6:K34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 15, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 26, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 33, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 34, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 9, "Month"),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, "January"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, "January Total"),
					new ExpectedCellValue(sheetName, 11, 9, "March"),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, "March Total"),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, "January"),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, "January Total"),
					new ExpectedCellValue(sheetName, 19, 9, "February"),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, "February Total"),
					new ExpectedCellValue(sheetName, 22, 9, "March"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, "March Total"),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, "January"),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, "January Total"),
					new ExpectedCellValue(sheetName, 30, 9, "February"),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, "February Total"),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 6, 10, "Item"),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, "Tent"),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 6, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, 831.5),
					new ExpectedCellValue(sheetName, 10, 11, 831.5),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, 24.99),
					new ExpectedCellValue(sheetName, 13, 11, 24.99),
					new ExpectedCellValue(sheetName, 14, 11, 856.49),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, 831.5),
					new ExpectedCellValue(sheetName, 18, 11, 831.5),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, 1194d),
					new ExpectedCellValue(sheetName, 21, 11, 1194d),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, 831.5),
					new ExpectedCellValue(sheetName, 24, 11, 831.5),
					new ExpectedCellValue(sheetName, 25, 11, 2857d),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, 415.75),
					new ExpectedCellValue(sheetName, 29, 11, 415.75),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, 99d),
					new ExpectedCellValue(sheetName, 32, 11, 99d),
					new ExpectedCellValue(sheetName, 33, 11, 514.75),
					new ExpectedCellValue(sheetName, 34, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstAndLastFieldsAndTabularSecondFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N6:Q17"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 14, null),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 15, "Month"),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, "January"),
					new ExpectedCellValue(sheetName, 9, 15, "March"),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, "January"),
					new ExpectedCellValue(sheetName, 12, 15, "February"),
					new ExpectedCellValue(sheetName, 13, 15, "March"),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, "January"),
					new ExpectedCellValue(sheetName, 16, 15, "February"),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 6, 16, "Item"),
					new ExpectedCellValue(sheetName, 7, 16, null),
					new ExpectedCellValue(sheetName, 8, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 10, 16, null),
					new ExpectedCellValue(sheetName, 11, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 16, "Tent"),
					new ExpectedCellValue(sheetName, 13, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 6, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, 831.5),
					new ExpectedCellValue(sheetName, 9, 17, 24.99),
					new ExpectedCellValue(sheetName, 10, 17, null),
					new ExpectedCellValue(sheetName, 11, 17, 831.5),
					new ExpectedCellValue(sheetName, 12, 17, 1194d),
					new ExpectedCellValue(sheetName, 13, 17, 831.5),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, 415.75),
					new ExpectedCellValue(sheetName, 16, 17, 99d),
					new ExpectedCellValue(sheetName, 17, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstAndLastFieldsAndTabularSecondFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N6:Q24"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 14, null),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 15, "Month"),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, "January"),
					new ExpectedCellValue(sheetName, 9, 15, "January Total"),
					new ExpectedCellValue(sheetName, 10, 15, "March"),
					new ExpectedCellValue(sheetName, 11, 15, "March Total"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, "January"),
					new ExpectedCellValue(sheetName, 14, 15, "January Total"),
					new ExpectedCellValue(sheetName, 15, 15, "February"),
					new ExpectedCellValue(sheetName, 16, 15, "February Total"),
					new ExpectedCellValue(sheetName, 17, 15, "March"),
					new ExpectedCellValue(sheetName, 18, 15, "March Total"),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, "January"),
					new ExpectedCellValue(sheetName, 21, 15, "January Total"),
					new ExpectedCellValue(sheetName, 22, 15, "February"),
					new ExpectedCellValue(sheetName, 23, 15, "February Total"),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 6, 16, "Item"),
					new ExpectedCellValue(sheetName, 7, 16, null),
					new ExpectedCellValue(sheetName, 8, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 16, null),
					new ExpectedCellValue(sheetName, 10, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, "Tent"),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 20, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 6, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 17, 856.49),
					new ExpectedCellValue(sheetName, 8, 17, 831.5),
					new ExpectedCellValue(sheetName, 9, 17, 831.5),
					new ExpectedCellValue(sheetName, 10, 17, 24.99),
					new ExpectedCellValue(sheetName, 11, 17, 24.99),
					new ExpectedCellValue(sheetName, 12, 17, 2857d),
					new ExpectedCellValue(sheetName, 13, 17, 831.5),
					new ExpectedCellValue(sheetName, 14, 17, 831.5),
					new ExpectedCellValue(sheetName, 15, 17, 1194d),
					new ExpectedCellValue(sheetName, 16, 17, 1194d),
					new ExpectedCellValue(sheetName, 17, 17, 831.5),
					new ExpectedCellValue(sheetName, 18, 17, 831.5),
					new ExpectedCellValue(sheetName, 19, 17, 514.75),
					new ExpectedCellValue(sheetName, 20, 17, 415.75),
					new ExpectedCellValue(sheetName, 21, 17, 415.75),
					new ExpectedCellValue(sheetName, 22, 17, 99d),
					new ExpectedCellValue(sheetName, 23, 17, 99d),
					new ExpectedCellValue(sheetName, 24, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstAndLastFieldsAndTabularSecondFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N6:Q27"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 14, null),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 13, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 21, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 27, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 15, "Month"),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, "January"),
					new ExpectedCellValue(sheetName, 9, 15, "January Total"),
					new ExpectedCellValue(sheetName, 10, 15, "March"),
					new ExpectedCellValue(sheetName, 11, 15, "March Total"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, "January"),
					new ExpectedCellValue(sheetName, 15, 15, "January Total"),
					new ExpectedCellValue(sheetName, 16, 15, "February"),
					new ExpectedCellValue(sheetName, 17, 15, "February Total"),
					new ExpectedCellValue(sheetName, 18, 15, "March"),
					new ExpectedCellValue(sheetName, 19, 15, "March Total"),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, null),
					new ExpectedCellValue(sheetName, 22, 15, "January"),
					new ExpectedCellValue(sheetName, 23, 15, "January Total"),
					new ExpectedCellValue(sheetName, 24, 15, "February"),
					new ExpectedCellValue(sheetName, 25, 15, "February Total"),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 6, 16, "Item"),
					new ExpectedCellValue(sheetName, 7, 16, null),
					new ExpectedCellValue(sheetName, 8, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 16, null),
					new ExpectedCellValue(sheetName, 10, 16, "Headlamp"),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, "Tent"),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, null),
					new ExpectedCellValue(sheetName, 6, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, 831.5),
					new ExpectedCellValue(sheetName, 9, 17, 831.5),
					new ExpectedCellValue(sheetName, 10, 17, 24.99),
					new ExpectedCellValue(sheetName, 11, 17, 24.99),
					new ExpectedCellValue(sheetName, 12, 17, 856.49),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, 831.5),
					new ExpectedCellValue(sheetName, 15, 17, 831.5),
					new ExpectedCellValue(sheetName, 16, 17, 1194d),
					new ExpectedCellValue(sheetName, 17, 17, 1194d),
					new ExpectedCellValue(sheetName, 18, 17, 831.5),
					new ExpectedCellValue(sheetName, 19, 17, 831.5),
					new ExpectedCellValue(sheetName, 20, 17, 2857d),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, 415.75),
					new ExpectedCellValue(sheetName, 23, 17, 415.75),
					new ExpectedCellValue(sheetName, 24, 17, 99d),
					new ExpectedCellValue(sheetName, 25, 17, 99d),
					new ExpectedCellValue(sheetName, 26, 17, 514.75),
					new ExpectedCellValue(sheetName, 27, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstFieldAndTabularSecondAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("T6:W17"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 20, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 20, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 20, null),
					new ExpectedCellValue(sheetName, 9, 20, null),
					new ExpectedCellValue(sheetName, 10, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, null),
					new ExpectedCellValue(sheetName, 14, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 21, "Month"),
					new ExpectedCellValue(sheetName, 7, 21, null),
					new ExpectedCellValue(sheetName, 8, 21, "January"),
					new ExpectedCellValue(sheetName, 9, 21, "March"),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, "January"),
					new ExpectedCellValue(sheetName, 12, 21, "February"),
					new ExpectedCellValue(sheetName, 13, 21, "March"),
					new ExpectedCellValue(sheetName, 14, 21, null),
					new ExpectedCellValue(sheetName, 15, 21, "January"),
					new ExpectedCellValue(sheetName, 16, 21, "February"),
					new ExpectedCellValue(sheetName, 17, 21, null),
					new ExpectedCellValue(sheetName, 6, 22, "Item"),
					new ExpectedCellValue(sheetName, 7, 22, null),
					new ExpectedCellValue(sheetName, 8, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 10, 22, null),
					new ExpectedCellValue(sheetName, 11, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 22, "Tent"),
					new ExpectedCellValue(sheetName, 13, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 22, null),
					new ExpectedCellValue(sheetName, 15, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 16, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 17, 22, null),
					new ExpectedCellValue(sheetName, 6, 23, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 23, null),
					new ExpectedCellValue(sheetName, 8, 23, 831.5),
					new ExpectedCellValue(sheetName, 9, 23, 24.99),
					new ExpectedCellValue(sheetName, 10, 23, null),
					new ExpectedCellValue(sheetName, 11, 23, 831.5),
					new ExpectedCellValue(sheetName, 12, 23, 1194d),
					new ExpectedCellValue(sheetName, 13, 23, 831.5),
					new ExpectedCellValue(sheetName, 14, 23, null),
					new ExpectedCellValue(sheetName, 15, 23, 415.75),
					new ExpectedCellValue(sheetName, 16, 23, 99d),
					new ExpectedCellValue(sheetName, 17, 23, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstFieldAndTabularSecondAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("T6:W24"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 20, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 20, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 20, null),
					new ExpectedCellValue(sheetName, 9, 20, null),
					new ExpectedCellValue(sheetName, 10, 20, null),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 20, null),
					new ExpectedCellValue(sheetName, 14, 20, null),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, null),
					new ExpectedCellValue(sheetName, 22, 20, null),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 21, "Month"),
					new ExpectedCellValue(sheetName, 7, 21, null),
					new ExpectedCellValue(sheetName, 8, 21, "January"),
					new ExpectedCellValue(sheetName, 9, 21, "January Total"),
					new ExpectedCellValue(sheetName, 10, 21, "March"),
					new ExpectedCellValue(sheetName, 11, 21, "March Total"),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, "January"),
					new ExpectedCellValue(sheetName, 14, 21, "January Total"),
					new ExpectedCellValue(sheetName, 15, 21, "February"),
					new ExpectedCellValue(sheetName, 16, 21, "February Total"),
					new ExpectedCellValue(sheetName, 17, 21, "March"),
					new ExpectedCellValue(sheetName, 18, 21, "March Total"),
					new ExpectedCellValue(sheetName, 19, 21, null),
					new ExpectedCellValue(sheetName, 20, 21, "January"),
					new ExpectedCellValue(sheetName, 21, 21, "January Total"),
					new ExpectedCellValue(sheetName, 22, 21, "February"),
					new ExpectedCellValue(sheetName, 23, 21, "February Total"),
					new ExpectedCellValue(sheetName, 24, 21, null),
					new ExpectedCellValue(sheetName, 6, 22, "Item"),
					new ExpectedCellValue(sheetName, 7, 22, null),
					new ExpectedCellValue(sheetName, 8, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 22, null),
					new ExpectedCellValue(sheetName, 10, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 11, 22, null),
					new ExpectedCellValue(sheetName, 12, 22, null),
					new ExpectedCellValue(sheetName, 13, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 22, null),
					new ExpectedCellValue(sheetName, 15, 22, "Tent"),
					new ExpectedCellValue(sheetName, 16, 22, null),
					new ExpectedCellValue(sheetName, 17, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 22, null),
					new ExpectedCellValue(sheetName, 19, 22, null),
					new ExpectedCellValue(sheetName, 20, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 22, null),
					new ExpectedCellValue(sheetName, 22, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 23, 22, null),
					new ExpectedCellValue(sheetName, 24, 22, null),
					new ExpectedCellValue(sheetName, 6, 23, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 23, 856.49),
					new ExpectedCellValue(sheetName, 8, 23, 831.5),
					new ExpectedCellValue(sheetName, 9, 23, 831.5),
					new ExpectedCellValue(sheetName, 10, 23, 24.99),
					new ExpectedCellValue(sheetName, 11, 23, 24.99),
					new ExpectedCellValue(sheetName, 12, 23, 2857d),
					new ExpectedCellValue(sheetName, 13, 23, 831.5),
					new ExpectedCellValue(sheetName, 14, 23, 831.5),
					new ExpectedCellValue(sheetName, 15, 23, 1194d),
					new ExpectedCellValue(sheetName, 16, 23, 1194d),
					new ExpectedCellValue(sheetName, 17, 23, 831.5),
					new ExpectedCellValue(sheetName, 18, 23, 831.5),
					new ExpectedCellValue(sheetName, 19, 23, 514.75),
					new ExpectedCellValue(sheetName, 20, 23, 415.75),
					new ExpectedCellValue(sheetName, 21, 23, 415.75),
					new ExpectedCellValue(sheetName, 22, 23, 99d),
					new ExpectedCellValue(sheetName, 23, 23, 99d),
					new ExpectedCellValue(sheetName, 24, 23, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsNonCompactFormFirstFieldAndTabularSecondAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("T6:W27"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 20, "Row Labels"),
					new ExpectedCellValue(sheetName, 7, 20, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 20, null),
					new ExpectedCellValue(sheetName, 9, 20, null),
					new ExpectedCellValue(sheetName, 10, 20, null),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, "Chicago Total"),
					new ExpectedCellValue(sheetName, 13, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 14, 20, null),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, null),
					new ExpectedCellValue(sheetName, 20, 20, "Nashville Total"),
					new ExpectedCellValue(sheetName, 21, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 20, null),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 27, 20, "Grand Total"),
					new ExpectedCellValue(sheetName, 6, 21, "Month"),
					new ExpectedCellValue(sheetName, 7, 21, null),
					new ExpectedCellValue(sheetName, 8, 21, "January"),
					new ExpectedCellValue(sheetName, 9, 21, "January Total"),
					new ExpectedCellValue(sheetName, 10, 21, "March"),
					new ExpectedCellValue(sheetName, 11, 21, "March Total"),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, null),
					new ExpectedCellValue(sheetName, 14, 21, "January"),
					new ExpectedCellValue(sheetName, 15, 21, "January Total"),
					new ExpectedCellValue(sheetName, 16, 21, "February"),
					new ExpectedCellValue(sheetName, 17, 21, "February Total"),
					new ExpectedCellValue(sheetName, 18, 21, "March"),
					new ExpectedCellValue(sheetName, 19, 21, "March Total"),
					new ExpectedCellValue(sheetName, 20, 21, null),
					new ExpectedCellValue(sheetName, 21, 21, null),
					new ExpectedCellValue(sheetName, 22, 21, "January"),
					new ExpectedCellValue(sheetName, 23, 21, "January Total"),
					new ExpectedCellValue(sheetName, 24, 21, "February"),
					new ExpectedCellValue(sheetName, 25, 21, "February Total"),
					new ExpectedCellValue(sheetName, 26, 21, null),
					new ExpectedCellValue(sheetName, 27, 21, null),
					new ExpectedCellValue(sheetName, 6, 22, "Item"),
					new ExpectedCellValue(sheetName, 7, 22, null),
					new ExpectedCellValue(sheetName, 8, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 9, 22, null),
					new ExpectedCellValue(sheetName, 10, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 11, 22, null),
					new ExpectedCellValue(sheetName, 12, 22, null),
					new ExpectedCellValue(sheetName, 13, 22, null),
					new ExpectedCellValue(sheetName, 14, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 22, null),
					new ExpectedCellValue(sheetName, 16, 22, "Tent"),
					new ExpectedCellValue(sheetName, 17, 22, null),
					new ExpectedCellValue(sheetName, 18, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 22, null),
					new ExpectedCellValue(sheetName, 20, 22, null),
					new ExpectedCellValue(sheetName, 21, 22, null),
					new ExpectedCellValue(sheetName, 22, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 22, null),
					new ExpectedCellValue(sheetName, 24, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 25, 22, null),
					new ExpectedCellValue(sheetName, 26, 22, null),
					new ExpectedCellValue(sheetName, 27, 22, null),
					new ExpectedCellValue(sheetName, 6, 23, "Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 23, null),
					new ExpectedCellValue(sheetName, 8, 23, 831.5),
					new ExpectedCellValue(sheetName, 9, 23, 831.5),
					new ExpectedCellValue(sheetName, 10, 23, 24.99),
					new ExpectedCellValue(sheetName, 11, 23, 24.99),
					new ExpectedCellValue(sheetName, 12, 23, 856.49),
					new ExpectedCellValue(sheetName, 13, 23, null),
					new ExpectedCellValue(sheetName, 14, 23, 831.5),
					new ExpectedCellValue(sheetName, 15, 23, 831.5),
					new ExpectedCellValue(sheetName, 16, 23, 1194d),
					new ExpectedCellValue(sheetName, 17, 23, 1194d),
					new ExpectedCellValue(sheetName, 18, 23, 831.5),
					new ExpectedCellValue(sheetName, 19, 23, 831.5),
					new ExpectedCellValue(sheetName, 20, 23, 2857d),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, 415.75),
					new ExpectedCellValue(sheetName, 23, 23, 415.75),
					new ExpectedCellValue(sheetName, 24, 23, 99d),
					new ExpectedCellValue(sheetName, 25, 23, 99d),
					new ExpectedCellValue(sheetName, 26, 23, 514.75),
					new ExpectedCellValue(sheetName, 27, 23, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstFieldAndNonCompactSecondAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H40:K55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 9, "Month"),
					new ExpectedCellValue(sheetName, 41, 9, "January"),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, "March"),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, "January"),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, "February"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, "March"),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, "January"),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, "February"),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 40, 10, "Item"),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10,"Headlamp"),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, "Tent"),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 55, 10, null),
					new ExpectedCellValue(sheetName, 40, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, 831.5),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, 24.99),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, 831.5),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, 1194d),
					new ExpectedCellValue(sheetName, 49, 11, null),
					new ExpectedCellValue(sheetName, 50, 11, 831.5),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, 415.75),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 54, 11, 99d),
					new ExpectedCellValue(sheetName, 55, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstFieldAndNonCompactSecondAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H40:K58"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 46, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 53, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 58, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 9, "Month"),
					new ExpectedCellValue(sheetName, 41, 9, "January"),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, "March"),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, "January"),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, "February"),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, "March"),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, "January"),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, "February"),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 40, 10, "Item"),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10,"Headlamp"),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, "Tent"),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 10, null),
					new ExpectedCellValue(sheetName, 56, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 57, 10, null),
					new ExpectedCellValue(sheetName, 58, 10, null),
					new ExpectedCellValue(sheetName, 40, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 11, 831.5),
					new ExpectedCellValue(sheetName, 42, 11, 831.5),
					new ExpectedCellValue(sheetName, 43, 11, 24.99),
					new ExpectedCellValue(sheetName, 44, 11, 24.99),
					new ExpectedCellValue(sheetName, 45, 11, 856.49),
					new ExpectedCellValue(sheetName, 46, 11, 831.5),
					new ExpectedCellValue(sheetName, 47, 11, 831.5),
					new ExpectedCellValue(sheetName, 48, 11, 1194d),
					new ExpectedCellValue(sheetName, 49, 11, 1194d),
					new ExpectedCellValue(sheetName, 50, 11, 831.5),
					new ExpectedCellValue(sheetName, 51, 11, 831.5),
					new ExpectedCellValue(sheetName, 52, 11, 2857d),
					new ExpectedCellValue(sheetName, 53, 11, 415.75),
					new ExpectedCellValue(sheetName, 54, 11, 415.75),
					new ExpectedCellValue(sheetName, 55, 11, 99d),
					new ExpectedCellValue(sheetName, 56, 11, 99d),
					new ExpectedCellValue(sheetName, 57, 11, 514.75),
					new ExpectedCellValue(sheetName, 58, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstFieldAndNonCompactSecondAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H40:K65"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 48, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 58, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, null),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 65, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 9, "Month"),
					new ExpectedCellValue(sheetName, 41, 9, "January"),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, "January Total"),
					new ExpectedCellValue(sheetName, 44, 9, "March"),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, "March Total"),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, "January"),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, "January Total"),
					new ExpectedCellValue(sheetName, 51, 9, "February"),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, "February Total"),
					new ExpectedCellValue(sheetName, 54, 9, "March"),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, "March Total"),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, "January"),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, "January Total"),
					new ExpectedCellValue(sheetName, 61, 9, "February"),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, "February Total"),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 40, 10, "Item"),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10,"Headlamp"),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, "Tent"),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, null),
					new ExpectedCellValue(sheetName, 58, 10, null),
					new ExpectedCellValue(sheetName, 59, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, null),
					new ExpectedCellValue(sheetName, 62, 10, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 40, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, 831.5),
					new ExpectedCellValue(sheetName, 43, 11, 831.5),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, 24.99),
					new ExpectedCellValue(sheetName, 46, 11, 24.99),
					new ExpectedCellValue(sheetName, 47, 11, 856.49),
					new ExpectedCellValue(sheetName, 48, 11, null),
					new ExpectedCellValue(sheetName, 49, 11, 831.5),
					new ExpectedCellValue(sheetName, 50, 11, 831.5),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, 1194d),
					new ExpectedCellValue(sheetName, 53, 11, 1194d),
					new ExpectedCellValue(sheetName, 54, 11, null),
					new ExpectedCellValue(sheetName, 55, 11, 831.5),
					new ExpectedCellValue(sheetName, 56, 11, 831.5),
					new ExpectedCellValue(sheetName, 57, 11, 2857d),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, 415.75),
					new ExpectedCellValue(sheetName, 60, 11, 415.75),
					new ExpectedCellValue(sheetName, 61, 11, null),
					new ExpectedCellValue(sheetName, 62, 11, 99d),
					new ExpectedCellValue(sheetName, 63, 11, 99d),
					new ExpectedCellValue(sheetName, 64, 11, 514.75),
					new ExpectedCellValue(sheetName, 65, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstAndLastFieldsAndNonCompactSecondFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N40:Q55"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 14, null),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, null),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 15, "Month"),
					new ExpectedCellValue(sheetName, 41, 15, "January"),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, "March"),
					new ExpectedCellValue(sheetName, 44, 15, null),
					new ExpectedCellValue(sheetName, 45, 15, "January"),
					new ExpectedCellValue(sheetName, 46, 15, null),
					new ExpectedCellValue(sheetName, 47, 15, "February"),
					new ExpectedCellValue(sheetName, 48, 15, null),
					new ExpectedCellValue(sheetName, 49, 15, "March"),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, "January"),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 53, 15, "February"),
					new ExpectedCellValue(sheetName, 54, 15, null),
					new ExpectedCellValue(sheetName, 55, 15, null),
					new ExpectedCellValue(sheetName, 40, 16, "Item"),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16,"Headlamp"),
					new ExpectedCellValue(sheetName, 45, 16, null),
					new ExpectedCellValue(sheetName, 46, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 16, null),
					new ExpectedCellValue(sheetName, 48, 16, "Tent"),
					new ExpectedCellValue(sheetName, 49, 16, null),
					new ExpectedCellValue(sheetName, 50, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 16, null),
					new ExpectedCellValue(sheetName, 54, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 55, 16, null),
					new ExpectedCellValue(sheetName, 40, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, 831.5),
					new ExpectedCellValue(sheetName, 43, 17, null),
					new ExpectedCellValue(sheetName, 44, 17, 24.99),
					new ExpectedCellValue(sheetName, 45, 17, null),
					new ExpectedCellValue(sheetName, 46, 17, 831.5),
					new ExpectedCellValue(sheetName, 47, 17, null),
					new ExpectedCellValue(sheetName, 48, 17, 1194d),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, 831.5),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, 415.75),
					new ExpectedCellValue(sheetName, 53, 17, null),
					new ExpectedCellValue(sheetName, 54, 17, 99d),
					new ExpectedCellValue(sheetName, 55, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstAndLastFieldsAndNonCompactSecondFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N40:Q58"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 14, null),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 46, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, null),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, null),
					new ExpectedCellValue(sheetName, 52, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 53, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 58, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 15, "Month"),
					new ExpectedCellValue(sheetName, 41, 15, "January"),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, "March"),
					new ExpectedCellValue(sheetName, 44, 15, null),
					new ExpectedCellValue(sheetName, 45, 15, null),
					new ExpectedCellValue(sheetName, 46, 15, "January"),
					new ExpectedCellValue(sheetName, 47, 15, null),
					new ExpectedCellValue(sheetName, 48, 15, "February"),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, "March"),
					new ExpectedCellValue(sheetName, 51, 15, null),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 53, 15, "January"),
					new ExpectedCellValue(sheetName, 54, 15, null),
					new ExpectedCellValue(sheetName, 55, 15, "February"),
					new ExpectedCellValue(sheetName, 56, 15, null),
					new ExpectedCellValue(sheetName, 57, 15, null),
					new ExpectedCellValue(sheetName, 58, 15, null),
					new ExpectedCellValue(sheetName, 40, 16, "Item"),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16,"Headlamp"),
					new ExpectedCellValue(sheetName, 45, 16, null),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 48, 16, null),
					new ExpectedCellValue(sheetName, 49, 16, "Tent"),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 52, 16, null),
					new ExpectedCellValue(sheetName, 53, 16, null),
					new ExpectedCellValue(sheetName, 54, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 55, 16, null),
					new ExpectedCellValue(sheetName, 56, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 57, 16, null),
					new ExpectedCellValue(sheetName, 58, 16, null),
					new ExpectedCellValue(sheetName, 40, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 17, 831.5),
					new ExpectedCellValue(sheetName, 42, 17, 831.5),
					new ExpectedCellValue(sheetName, 43, 17, 24.99),
					new ExpectedCellValue(sheetName, 44, 17, 24.99),
					new ExpectedCellValue(sheetName, 45, 17, 856.49),
					new ExpectedCellValue(sheetName, 46, 17, 831.5),
					new ExpectedCellValue(sheetName, 47, 17, 831.5),
					new ExpectedCellValue(sheetName, 48, 17, 1194d),
					new ExpectedCellValue(sheetName, 49, 17, 1194d),
					new ExpectedCellValue(sheetName, 50, 17, 831.5),
					new ExpectedCellValue(sheetName, 51, 17, 831.5),
					new ExpectedCellValue(sheetName, 52, 17, 2857d),
					new ExpectedCellValue(sheetName, 53, 17, 415.75),
					new ExpectedCellValue(sheetName, 54, 17, 415.75),
					new ExpectedCellValue(sheetName, 55, 17, 99d),
					new ExpectedCellValue(sheetName, 56, 17, 99d),
					new ExpectedCellValue(sheetName, 57, 17, 514.75),
					new ExpectedCellValue(sheetName, 58, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstAndLastFieldsAndNonCompactSecondFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N40:Q65"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 14, null),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 48, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 14, null),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, null),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 58, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, null),
					new ExpectedCellValue(sheetName, 61, 14, null),
					new ExpectedCellValue(sheetName, 62, 14, null),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 65, 14, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 15, "Month"),
					new ExpectedCellValue(sheetName, 41, 15, "January"),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, "January Total"),
					new ExpectedCellValue(sheetName, 44, 15, "March"),
					new ExpectedCellValue(sheetName, 45, 15, null),
					new ExpectedCellValue(sheetName, 46, 15, "March Total"),
					new ExpectedCellValue(sheetName, 47, 15, null),
					new ExpectedCellValue(sheetName, 48, 15, "January"),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, "January Total"),
					new ExpectedCellValue(sheetName, 51, 15, "February"),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 53, 15, "February Total"),
					new ExpectedCellValue(sheetName, 54, 15, "March"),
					new ExpectedCellValue(sheetName, 55, 15, null),
					new ExpectedCellValue(sheetName, 56, 15, "March Total"),
					new ExpectedCellValue(sheetName, 57, 15, null),
					new ExpectedCellValue(sheetName, 58, 15, "January"),
					new ExpectedCellValue(sheetName, 59, 15, null),
					new ExpectedCellValue(sheetName, 60, 15, "January Total"),
					new ExpectedCellValue(sheetName, 61, 15, "February"),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, "February Total"),
					new ExpectedCellValue(sheetName, 64, 15, null),
					new ExpectedCellValue(sheetName, 65, 15, null),
					new ExpectedCellValue(sheetName, 40, 16, "Item"),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, null),
					new ExpectedCellValue(sheetName, 45, 16,"Headlamp"),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, null),
					new ExpectedCellValue(sheetName, 48, 16, null),
					new ExpectedCellValue(sheetName, 49, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, "Tent"),
					new ExpectedCellValue(sheetName, 53, 16, null),
					new ExpectedCellValue(sheetName, 54, 16, null),
					new ExpectedCellValue(sheetName, 55, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 56, 16, null),
					new ExpectedCellValue(sheetName, 57, 16, null),
					new ExpectedCellValue(sheetName, 58, 16, null),
					new ExpectedCellValue(sheetName, 59, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 16, null),
					new ExpectedCellValue(sheetName, 61, 16, null),
					new ExpectedCellValue(sheetName, 62, 16, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 63, 16, null),
					new ExpectedCellValue(sheetName, 64, 16, null),
					new ExpectedCellValue(sheetName, 65, 16, null),
					new ExpectedCellValue(sheetName, 40, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, 831.5),
					new ExpectedCellValue(sheetName, 43, 17, 831.5),
					new ExpectedCellValue(sheetName, 44, 17, null),
					new ExpectedCellValue(sheetName, 45, 17, 24.99),
					new ExpectedCellValue(sheetName, 46, 17, 24.99),
					new ExpectedCellValue(sheetName, 47, 17, 856.49),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, 831.5),
					new ExpectedCellValue(sheetName, 50, 17, 831.5),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, 1194d),
					new ExpectedCellValue(sheetName, 53, 17, 1194d),
					new ExpectedCellValue(sheetName, 54, 17, null),
					new ExpectedCellValue(sheetName, 55, 17, 831.5),
					new ExpectedCellValue(sheetName, 56, 17, 831.5),
					new ExpectedCellValue(sheetName, 57, 17, 2857d),
					new ExpectedCellValue(sheetName, 58, 17, null),
					new ExpectedCellValue(sheetName, 59, 17, 415.75),
					new ExpectedCellValue(sheetName, 60, 17, 415.75),
					new ExpectedCellValue(sheetName, 61, 17, null),
					new ExpectedCellValue(sheetName, 62, 17, 99d),
					new ExpectedCellValue(sheetName, 63, 17, 99d),
					new ExpectedCellValue(sheetName, 64, 17, 514.75),
					new ExpectedCellValue(sheetName, 65, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstAndSecondFieldsAndNonCompactLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("T40:W48"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 20, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 20, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 20, null),
					new ExpectedCellValue(sheetName, 43, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 44, 20, null),
					new ExpectedCellValue(sheetName, 45, 20, null),
					new ExpectedCellValue(sheetName, 46, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 47, 20, null),
					new ExpectedCellValue(sheetName, 48, 20, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 21, "Month"),
					new ExpectedCellValue(sheetName, 41, 21, "January"),
					new ExpectedCellValue(sheetName, 42, 21, "March"),
					new ExpectedCellValue(sheetName, 43, 21, "January"),
					new ExpectedCellValue(sheetName, 44, 21, "February"),
					new ExpectedCellValue(sheetName, 45, 21, "March"),
					new ExpectedCellValue(sheetName, 46, 21, "January"),
					new ExpectedCellValue(sheetName, 47, 21, "February"),
					new ExpectedCellValue(sheetName, 48, 21, null),
					new ExpectedCellValue(sheetName, 40, 22, "Item"),
					new ExpectedCellValue(sheetName, 41, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 43, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 44, 22, "Tent"),
					new ExpectedCellValue(sheetName, 45, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 46, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 48, 22, null),
					new ExpectedCellValue(sheetName, 40, 23, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 23, 831.5),
					new ExpectedCellValue(sheetName, 42, 23, 24.99),
					new ExpectedCellValue(sheetName, 43, 23, 831.5),
					new ExpectedCellValue(sheetName, 44, 23, 1194d),
					new ExpectedCellValue(sheetName, 45, 23, 831.5),
					new ExpectedCellValue(sheetName, 46, 23, 415.75),
					new ExpectedCellValue(sheetName, 47, 23, 99d),
					new ExpectedCellValue(sheetName, 48, 23, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstAndSecondFieldsAndNonCompactLastFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("T40:W58"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 20, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 20, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 20, null),
					new ExpectedCellValue(sheetName, 43, 20, null),
					new ExpectedCellValue(sheetName, 44, 20, null),
					new ExpectedCellValue(sheetName, 45, 20, "Chicago Total"),
					new ExpectedCellValue(sheetName, 46, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 20, null),
					new ExpectedCellValue(sheetName, 48, 20, null),
					new ExpectedCellValue(sheetName, 49, 20, null),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, "Nashville Total"),
					new ExpectedCellValue(sheetName, 53, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 54, 20, null),
					new ExpectedCellValue(sheetName, 55, 20, null),
					new ExpectedCellValue(sheetName, 56, 20, null),
					new ExpectedCellValue(sheetName, 57, 20, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 58, 20, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 21, "Month"),
					new ExpectedCellValue(sheetName, 41, 21, "January"),
					new ExpectedCellValue(sheetName, 42, 21, "January Total"),
					new ExpectedCellValue(sheetName, 43, 21, "March"),
					new ExpectedCellValue(sheetName, 44, 21, "March Total"),
					new ExpectedCellValue(sheetName, 45, 21, null),
					new ExpectedCellValue(sheetName, 46, 21, "January"),
					new ExpectedCellValue(sheetName, 47, 21, "January Total"),
					new ExpectedCellValue(sheetName, 48, 21, "February"),
					new ExpectedCellValue(sheetName, 49, 21, "February Total"),
					new ExpectedCellValue(sheetName, 50, 21, "March"),
					new ExpectedCellValue(sheetName, 51, 21, "March Total"),
					new ExpectedCellValue(sheetName, 52, 21, null),
					new ExpectedCellValue(sheetName, 53, 21, "January"),
					new ExpectedCellValue(sheetName, 54, 21, "January Total"),
					new ExpectedCellValue(sheetName, 55, 21, "February"),
					new ExpectedCellValue(sheetName, 56, 21, "February Total"),
					new ExpectedCellValue(sheetName, 57, 21, null),
					new ExpectedCellValue(sheetName, 58, 21, null),
					new ExpectedCellValue(sheetName, 40, 22, "Item"),
					new ExpectedCellValue(sheetName, 41, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 22, null),
					new ExpectedCellValue(sheetName, 43, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 44, 22, null),
					new ExpectedCellValue(sheetName, 45, 22, null),
					new ExpectedCellValue(sheetName, 46, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 22, null),
					new ExpectedCellValue(sheetName, 48, 22, "Tent"),
					new ExpectedCellValue(sheetName, 49, 22, null),
					new ExpectedCellValue(sheetName, 50, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 51, 22, null),
					new ExpectedCellValue(sheetName, 52, 22, null),
					new ExpectedCellValue(sheetName, 53, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 54, 22, null),
					new ExpectedCellValue(sheetName, 55, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 56, 22, null),
					new ExpectedCellValue(sheetName, 57, 22, null),
					new ExpectedCellValue(sheetName, 58, 22, null),
					new ExpectedCellValue(sheetName, 40, 23, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 23, 831.5),
					new ExpectedCellValue(sheetName, 42, 23, 831.5),
					new ExpectedCellValue(sheetName, 43, 23, 24.99),
					new ExpectedCellValue(sheetName, 44, 23, 24.99),
					new ExpectedCellValue(sheetName, 45, 23, 856.49),
					new ExpectedCellValue(sheetName, 46, 23, 831.5),
					new ExpectedCellValue(sheetName, 47, 23, 831.5),
					new ExpectedCellValue(sheetName, 48, 23, 1194d),
					new ExpectedCellValue(sheetName, 49, 23, 1194d),
					new ExpectedCellValue(sheetName, 50, 23, 831.5),
					new ExpectedCellValue(sheetName, 51, 23, 831.5),
					new ExpectedCellValue(sheetName, 52, 23, 2857d),
					new ExpectedCellValue(sheetName, 53, 23, 415.75),
					new ExpectedCellValue(sheetName, 54, 23, 415.75),
					new ExpectedCellValue(sheetName, 55, 23, 99d),
					new ExpectedCellValue(sheetName, 56, 23, 99d),
					new ExpectedCellValue(sheetName, 57, 23, 514.75),
					new ExpectedCellValue(sheetName, 58, 23, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsTabularFirstAndSecondFieldsAndNonCompactLastFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("T40:W58"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 40, 20, "Row Labels"),
					new ExpectedCellValue(sheetName, 41, 20, "Chicago"),
					new ExpectedCellValue(sheetName, 42, 20, null),
					new ExpectedCellValue(sheetName, 43, 20, null),
					new ExpectedCellValue(sheetName, 44, 20, null),
					new ExpectedCellValue(sheetName, 45, 20, "Chicago Total"),
					new ExpectedCellValue(sheetName, 46, 20, "Nashville"),
					new ExpectedCellValue(sheetName, 47, 20, null),
					new ExpectedCellValue(sheetName, 48, 20, null),
					new ExpectedCellValue(sheetName, 49, 20, null),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, "Nashville Total"),
					new ExpectedCellValue(sheetName, 53, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 54, 20, null),
					new ExpectedCellValue(sheetName, 55, 20, null),
					new ExpectedCellValue(sheetName, 56, 20, null),
					new ExpectedCellValue(sheetName, 57, 20, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 58, 20, "Grand Total"),
					new ExpectedCellValue(sheetName, 40, 21, "Month"),
					new ExpectedCellValue(sheetName, 41, 21, "January"),
					new ExpectedCellValue(sheetName, 42, 21, "January Total"),
					new ExpectedCellValue(sheetName, 43, 21, "March"),
					new ExpectedCellValue(sheetName, 44, 21, "March Total"),
					new ExpectedCellValue(sheetName, 45, 21, null),
					new ExpectedCellValue(sheetName, 46, 21, "January"),
					new ExpectedCellValue(sheetName, 47, 21, "January Total"),
					new ExpectedCellValue(sheetName, 48, 21, "February"),
					new ExpectedCellValue(sheetName, 49, 21, "February Total"),
					new ExpectedCellValue(sheetName, 50, 21, "March"),
					new ExpectedCellValue(sheetName, 51, 21, "March Total"),
					new ExpectedCellValue(sheetName, 52, 21, null),
					new ExpectedCellValue(sheetName, 53, 21, "January"),
					new ExpectedCellValue(sheetName, 54, 21, "January Total"),
					new ExpectedCellValue(sheetName, 55, 21, "February"),
					new ExpectedCellValue(sheetName, 56, 21, "February Total"),
					new ExpectedCellValue(sheetName, 57, 21, null),
					new ExpectedCellValue(sheetName, 58, 21, null),
					new ExpectedCellValue(sheetName, 40, 22, "Item"),
					new ExpectedCellValue(sheetName, 41, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 22, null),
					new ExpectedCellValue(sheetName, 43, 22, "Headlamp"),
					new ExpectedCellValue(sheetName, 44, 22, null),
					new ExpectedCellValue(sheetName, 45, 22, null),
					new ExpectedCellValue(sheetName, 46, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 22, null),
					new ExpectedCellValue(sheetName, 48, 22, "Tent"),
					new ExpectedCellValue(sheetName, 49, 22, null),
					new ExpectedCellValue(sheetName, 50, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 51, 22, null),
					new ExpectedCellValue(sheetName, 52, 22, null),
					new ExpectedCellValue(sheetName, 53, 22, "Car Rack"),
					new ExpectedCellValue(sheetName, 54, 22, null),
					new ExpectedCellValue(sheetName, 55, 22, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 56, 22, null),
					new ExpectedCellValue(sheetName, 57, 22, null),
					new ExpectedCellValue(sheetName, 58, 22, null),
					new ExpectedCellValue(sheetName, 40, 23, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 23, 831.5),
					new ExpectedCellValue(sheetName, 42, 23, 831.5),
					new ExpectedCellValue(sheetName, 43, 23, 24.99),
					new ExpectedCellValue(sheetName, 44, 23, 24.99),
					new ExpectedCellValue(sheetName, 45, 23, 856.49),
					new ExpectedCellValue(sheetName, 46, 23, 831.5),
					new ExpectedCellValue(sheetName, 47, 23, 831.5),
					new ExpectedCellValue(sheetName, 48, 23, 1194d),
					new ExpectedCellValue(sheetName, 49, 23, 1194d),
					new ExpectedCellValue(sheetName, 50, 23, 831.5),
					new ExpectedCellValue(sheetName, 51, 23, 831.5),
					new ExpectedCellValue(sheetName, 52, 23, 2857d),
					new ExpectedCellValue(sheetName, 53, 23, 415.75),
					new ExpectedCellValue(sheetName, 54, 23, 415.75),
					new ExpectedCellValue(sheetName, 55, 23, 99d),
					new ExpectedCellValue(sheetName, 56, 23, 99d),
					new ExpectedCellValue(sheetName, 57, 23, 514.75),
					new ExpectedCellValue(sheetName, 58, 23, 4228.24)
				});
			}
		}

		// Four Row Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstSecondAndThirdFieldsTabularLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P10:T39"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 16, 20100007),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, 20100017),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, 20100070),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, 20100076),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, 20100083),
					new ExpectedCellValue(sheetName, 28, 16, null),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 31, 16, 20100085),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 34, 16, null),
					new ExpectedCellValue(sheetName, 35, 16, 20100090),
					new ExpectedCellValue(sheetName, 36, 16, null),
					new ExpectedCellValue(sheetName, 37, 16, null),
					new ExpectedCellValue(sheetName, 38, 16, null),
					new ExpectedCellValue(sheetName, 39, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 17, "Location"),
					new ExpectedCellValue(sheetName, 11, 17, null),
					new ExpectedCellValue(sheetName, 12, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 10, 18, "Month"),
					new ExpectedCellValue(sheetName, 11, 18, null),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, "January"),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, "March"),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, "February"),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, "January"),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, "March"),
					new ExpectedCellValue(sheetName, 30, 18, null),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, "February"),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, null),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, "January"),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 10, 19, "Item"),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, null),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, "Tent"),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, null),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, null),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 10, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, null),
					new ExpectedCellValue(sheetName, 14, 20, 831.5),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, 831.5),
					new ExpectedCellValue(sheetName, 19, 20, null),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, null),
					new ExpectedCellValue(sheetName, 22, 20, 1194d),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, 415.75),
					new ExpectedCellValue(sheetName, 27, 20, null),
					new ExpectedCellValue(sheetName, 28, 20, null),
					new ExpectedCellValue(sheetName, 29, 20, null),
					new ExpectedCellValue(sheetName, 30, 20, 24.99),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, null),
					new ExpectedCellValue(sheetName, 34, 20, 99d),
					new ExpectedCellValue(sheetName, 35, 20, null),
					new ExpectedCellValue(sheetName, 36, 20, null),
					new ExpectedCellValue(sheetName, 37, 20, null),
					new ExpectedCellValue(sheetName, 38, 20, 831.5),
					new ExpectedCellValue(sheetName, 39, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstSecondAndThirdFieldsTabularLastFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P10:T39"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 16, 20100007),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, 20100017),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, 20100070),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, 20100076),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, 20100083),
					new ExpectedCellValue(sheetName, 28, 16, null),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 31, 16, 20100085),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 34, 16, null),
					new ExpectedCellValue(sheetName, 35, 16, 20100090),
					new ExpectedCellValue(sheetName, 36, 16, null),
					new ExpectedCellValue(sheetName, 37, 16, null),
					new ExpectedCellValue(sheetName, 38, 16, null),
					new ExpectedCellValue(sheetName, 39, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 17, "Location"),
					new ExpectedCellValue(sheetName, 11, 17, null),
					new ExpectedCellValue(sheetName, 12, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 10, 18, "Month"),
					new ExpectedCellValue(sheetName, 11, 18, null),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, "January"),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, "March"),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, "February"),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, "January"),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, "March"),
					new ExpectedCellValue(sheetName, 30, 18, null),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, "February"),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, null),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, "January"),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 10, 19, "Item"),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, null),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, "Tent"),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, null),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, null),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 10, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 20, 831.5),
					new ExpectedCellValue(sheetName, 12, 20, 831.5),
					new ExpectedCellValue(sheetName, 13, 20, 831.5),
					new ExpectedCellValue(sheetName, 14, 20, 831.5),
					new ExpectedCellValue(sheetName, 15, 20, 831.5),
					new ExpectedCellValue(sheetName, 16, 20, 831.5),
					new ExpectedCellValue(sheetName, 17, 20, 831.5),
					new ExpectedCellValue(sheetName, 18, 20, 831.5),
					new ExpectedCellValue(sheetName, 19, 20, 1194d),
					new ExpectedCellValue(sheetName, 20, 20, 1194d),
					new ExpectedCellValue(sheetName, 21, 20, 1194d),
					new ExpectedCellValue(sheetName, 22, 20, 1194d),
					new ExpectedCellValue(sheetName, 23, 20, 415.75),
					new ExpectedCellValue(sheetName, 24, 20, 415.75),
					new ExpectedCellValue(sheetName, 25, 20, 415.75),
					new ExpectedCellValue(sheetName, 26, 20, 415.75),
					new ExpectedCellValue(sheetName, 27, 20, 24.99),
					new ExpectedCellValue(sheetName, 28, 20, 24.99),
					new ExpectedCellValue(sheetName, 29, 20, 24.99),
					new ExpectedCellValue(sheetName, 30, 20, 24.99),
					new ExpectedCellValue(sheetName, 31, 20, 99d),
					new ExpectedCellValue(sheetName, 32, 20, 99d),
					new ExpectedCellValue(sheetName, 33, 20, 99d),
					new ExpectedCellValue(sheetName, 34, 20, 99d),
					new ExpectedCellValue(sheetName, 35, 20, 831.5),
					new ExpectedCellValue(sheetName, 36, 20, 831.5),
					new ExpectedCellValue(sheetName, 37, 20, 831.5),
					new ExpectedCellValue(sheetName, 38, 20, 831.5),
					new ExpectedCellValue(sheetName, 39, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstSecondAndThirdFieldsTabularLastFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P10:T60"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 16, 20100007),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 18, 16, 20100017),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 25, 16, 20100070),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, null),
					new ExpectedCellValue(sheetName, 28, 16, null),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 31, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 32, 16, 20100076),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 34, 16, null),
					new ExpectedCellValue(sheetName, 35, 16, null),
					new ExpectedCellValue(sheetName, 36, 16, null),
					new ExpectedCellValue(sheetName, 37, 16, null),
					new ExpectedCellValue(sheetName, 38, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 39, 16, 20100083),
					new ExpectedCellValue(sheetName, 40, 16, null),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, null),
					new ExpectedCellValue(sheetName, 45, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 46, 16, 20100085),
					new ExpectedCellValue(sheetName, 47, 16, null),
					new ExpectedCellValue(sheetName, 48, 16, null),
					new ExpectedCellValue(sheetName, 49, 16, null),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 53, 16, 20100090),
					new ExpectedCellValue(sheetName, 54, 16, null),
					new ExpectedCellValue(sheetName, 55, 16, null),
					new ExpectedCellValue(sheetName, 56, 16, null),
					new ExpectedCellValue(sheetName, 57, 16, null),
					new ExpectedCellValue(sheetName, 58, 16, null),
					new ExpectedCellValue(sheetName, 59, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 60, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 17, "Location"),
					new ExpectedCellValue(sheetName, 11, 17, null),
					new ExpectedCellValue(sheetName, 12, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, null),
					new ExpectedCellValue(sheetName, 33, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 40, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, null),
					new ExpectedCellValue(sheetName, 43, 17, null),
					new ExpectedCellValue(sheetName, 44, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 45, 17, null),
					new ExpectedCellValue(sheetName, 46, 17, null),
					new ExpectedCellValue(sheetName, 47, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 52, 17, null),
					new ExpectedCellValue(sheetName, 53, 17, null),
					new ExpectedCellValue(sheetName, 54, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 55, 17, null),
					new ExpectedCellValue(sheetName, 56, 17, null),
					new ExpectedCellValue(sheetName, 57, 17, null),
					new ExpectedCellValue(sheetName, 58, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 59, 17, null),
					new ExpectedCellValue(sheetName, 60, 17, null),
					new ExpectedCellValue(sheetName, 10, 18, "Month"),
					new ExpectedCellValue(sheetName, 11, 18, null),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, "January"),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, "January Total"),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, null),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, "March"),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, "March Total"),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, "February"),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, "February Total"),
					new ExpectedCellValue(sheetName, 30, 18, null),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, null),
					new ExpectedCellValue(sheetName, 34, 18, "January"),
					new ExpectedCellValue(sheetName, 35, 18, null),
					new ExpectedCellValue(sheetName, 36, 18, "January Total"),
					new ExpectedCellValue(sheetName, 37, 18, null),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, null),
					new ExpectedCellValue(sheetName, 41, 18, "March"),
					new ExpectedCellValue(sheetName, 42, 18, null),
					new ExpectedCellValue(sheetName, 43, 18, "March Total"),
					new ExpectedCellValue(sheetName, 44, 18, null),
					new ExpectedCellValue(sheetName, 45, 18, null),
					new ExpectedCellValue(sheetName, 46, 18, null),
					new ExpectedCellValue(sheetName, 47, 18, null),
					new ExpectedCellValue(sheetName, 48, 18, "February"),
					new ExpectedCellValue(sheetName, 49, 18, null),
					new ExpectedCellValue(sheetName, 50, 18, "February Total"),
					new ExpectedCellValue(sheetName, 51, 18, null),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, null),
					new ExpectedCellValue(sheetName, 54, 18, null),
					new ExpectedCellValue(sheetName, 55, 18, "January"),
					new ExpectedCellValue(sheetName, 56, 18, null),
					new ExpectedCellValue(sheetName, 57, 18, "January Total"),
					new ExpectedCellValue(sheetName, 58, 18, null),
					new ExpectedCellValue(sheetName, 59, 18, null),
					new ExpectedCellValue(sheetName, 60, 18, null),
					new ExpectedCellValue(sheetName, 10, 19, "Item"),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, null),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, null),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 22, 19, null),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, "Tent"),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, null),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, null),
					new ExpectedCellValue(sheetName, 35, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, null),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 43, 19, null),
					new ExpectedCellValue(sheetName, 44, 19, null),
					new ExpectedCellValue(sheetName, 45, 19, null),
					new ExpectedCellValue(sheetName, 46, 19, null),
					new ExpectedCellValue(sheetName, 47, 19, null),
					new ExpectedCellValue(sheetName, 48, 19, null),
					new ExpectedCellValue(sheetName, 49, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 50, 19, null),
					new ExpectedCellValue(sheetName, 51, 19, null),
					new ExpectedCellValue(sheetName, 52, 19, null),
					new ExpectedCellValue(sheetName, 53, 19, null),
					new ExpectedCellValue(sheetName, 54, 19, null),
					new ExpectedCellValue(sheetName, 55, 19, null),
					new ExpectedCellValue(sheetName, 56, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 57, 19, null),
					new ExpectedCellValue(sheetName, 58, 19, null),
					new ExpectedCellValue(sheetName, 59, 19, null),
					new ExpectedCellValue(sheetName, 60, 19, null),
					new ExpectedCellValue(sheetName, 10, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, null),
					new ExpectedCellValue(sheetName, 14, 20, 831.5),
					new ExpectedCellValue(sheetName, 15, 20, 831.5),
					new ExpectedCellValue(sheetName, 16, 20, 831.5),
					new ExpectedCellValue(sheetName, 17, 20, 831.5),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, null),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, 831.5),
					new ExpectedCellValue(sheetName, 22, 20, 831.5),
					new ExpectedCellValue(sheetName, 23, 20, 831.5),
					new ExpectedCellValue(sheetName, 24, 20, 831.5),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, null),
					new ExpectedCellValue(sheetName, 27, 20, null),
					new ExpectedCellValue(sheetName, 28, 20, 1194d),
					new ExpectedCellValue(sheetName, 29, 20, 1194d),
					new ExpectedCellValue(sheetName, 30, 20, 1194d),
					new ExpectedCellValue(sheetName, 31, 20, 1194d),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, null),
					new ExpectedCellValue(sheetName, 34, 20, null),
					new ExpectedCellValue(sheetName, 35, 20, 415.75),
					new ExpectedCellValue(sheetName, 36, 20, 415.75),
					new ExpectedCellValue(sheetName, 37, 20, 415.75),
					new ExpectedCellValue(sheetName, 38, 20, 415.75),
					new ExpectedCellValue(sheetName, 39, 20, null),
					new ExpectedCellValue(sheetName, 40, 20, null),
					new ExpectedCellValue(sheetName, 41, 20, null),
					new ExpectedCellValue(sheetName, 42, 20, 24.99),
					new ExpectedCellValue(sheetName, 43, 20, 24.99),
					new ExpectedCellValue(sheetName, 44, 20, 24.99),
					new ExpectedCellValue(sheetName, 45, 20, 24.99),
					new ExpectedCellValue(sheetName, 46, 20, null),
					new ExpectedCellValue(sheetName, 47, 20, null),
					new ExpectedCellValue(sheetName, 48, 20, null),
					new ExpectedCellValue(sheetName, 49, 20, 99d),
					new ExpectedCellValue(sheetName, 50, 20, 99d),
					new ExpectedCellValue(sheetName, 51, 20, 99d),
					new ExpectedCellValue(sheetName, 52, 20, 99d),
					new ExpectedCellValue(sheetName, 53, 20, null),
					new ExpectedCellValue(sheetName, 54, 20, null),
					new ExpectedCellValue(sheetName, 55, 20, null),
					new ExpectedCellValue(sheetName, 56, 20, 831.5),
					new ExpectedCellValue(sheetName, 57, 20, 831.5),
					new ExpectedCellValue(sheetName, 58, 20, 831.5),
					new ExpectedCellValue(sheetName, 59, 20, 831.5),
					new ExpectedCellValue(sheetName, 60, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstSecondAndLastFieldsTabularThirdFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W10:AA32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 23, 20100007),
					new ExpectedCellValue(sheetName, 12, 23, null),
					new ExpectedCellValue(sheetName, 13, 23, null),
					new ExpectedCellValue(sheetName, 14, 23, 20100017),
					new ExpectedCellValue(sheetName, 15, 23, null),
					new ExpectedCellValue(sheetName, 16, 23, null),
					new ExpectedCellValue(sheetName, 17, 23, 20100070),
					new ExpectedCellValue(sheetName, 18, 23, null),
					new ExpectedCellValue(sheetName, 19, 23, null),
					new ExpectedCellValue(sheetName, 20, 23, 20100076),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, null),
					new ExpectedCellValue(sheetName, 23, 23, 20100083),
					new ExpectedCellValue(sheetName, 24, 23, null),
					new ExpectedCellValue(sheetName, 25, 23, null),
					new ExpectedCellValue(sheetName, 26, 23, 20100085),
					new ExpectedCellValue(sheetName, 27, 23, null),
					new ExpectedCellValue(sheetName, 28, 23, null),
					new ExpectedCellValue(sheetName, 29, 23, 20100090),
					new ExpectedCellValue(sheetName, 30, 23, null),
					new ExpectedCellValue(sheetName, 31, 23, null),
					new ExpectedCellValue(sheetName, 32, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 24, "Location"),
					new ExpectedCellValue(sheetName, 11, 24, null),
					new ExpectedCellValue(sheetName, 12, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 24, null),
					new ExpectedCellValue(sheetName, 14, 24, null),
					new ExpectedCellValue(sheetName, 15, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 24, null),
					new ExpectedCellValue(sheetName, 17, 24, null),
					new ExpectedCellValue(sheetName, 18, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 24, null),
					new ExpectedCellValue(sheetName, 20, 24, null),
					new ExpectedCellValue(sheetName, 21, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 24, null),
					new ExpectedCellValue(sheetName, 23, 24, null),
					new ExpectedCellValue(sheetName, 24, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 24, null),
					new ExpectedCellValue(sheetName, 26, 24, null),
					new ExpectedCellValue(sheetName, 27, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 24, null),
					new ExpectedCellValue(sheetName, 29, 24, null),
					new ExpectedCellValue(sheetName, 30, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 31, 24, null),
					new ExpectedCellValue(sheetName, 32, 24, null),
					new ExpectedCellValue(sheetName, 10, 25, "Month"),
					new ExpectedCellValue(sheetName, 11, 25, null),
					new ExpectedCellValue(sheetName, 12, 25, null),
					new ExpectedCellValue(sheetName, 13, 25, "January"),
					new ExpectedCellValue(sheetName, 14, 25, null),
					new ExpectedCellValue(sheetName, 15, 25, null),
					new ExpectedCellValue(sheetName, 16, 25, "March"),
					new ExpectedCellValue(sheetName, 17, 25, null),
					new ExpectedCellValue(sheetName, 18, 25, null),
					new ExpectedCellValue(sheetName, 19, 25, "February"),
					new ExpectedCellValue(sheetName, 20, 25, null),
					new ExpectedCellValue(sheetName, 21, 25, null),
					new ExpectedCellValue(sheetName, 22, 25, "January"),
					new ExpectedCellValue(sheetName, 23, 25, null),
					new ExpectedCellValue(sheetName, 24, 25, null),
					new ExpectedCellValue(sheetName, 25, 25, "March"),
					new ExpectedCellValue(sheetName, 26, 25, null),
					new ExpectedCellValue(sheetName, 27, 25, null),
					new ExpectedCellValue(sheetName, 28, 25, "February"),
					new ExpectedCellValue(sheetName, 29, 25, null),
					new ExpectedCellValue(sheetName, 30, 25, null),
					new ExpectedCellValue(sheetName, 31, 25, "January"),
					new ExpectedCellValue(sheetName, 32, 25, null),
					new ExpectedCellValue(sheetName, 10, 26, "Item"),
					new ExpectedCellValue(sheetName, 11, 26, null),
					new ExpectedCellValue(sheetName, 12, 26, null),
					new ExpectedCellValue(sheetName, 13, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 26, null),
					new ExpectedCellValue(sheetName, 15, 26, null),
					new ExpectedCellValue(sheetName, 16, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 26, null),
					new ExpectedCellValue(sheetName, 18, 26, null),
					new ExpectedCellValue(sheetName, 19, 26, "Tent"),
					new ExpectedCellValue(sheetName, 20, 26, null),
					new ExpectedCellValue(sheetName, 21, 26, null),
					new ExpectedCellValue(sheetName, 22, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 26, null),
					new ExpectedCellValue(sheetName, 24, 26, null),
					new ExpectedCellValue(sheetName, 25, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 26, 26, null),
					new ExpectedCellValue(sheetName, 27, 26, null),
					new ExpectedCellValue(sheetName, 28, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 29, 26, null),
					new ExpectedCellValue(sheetName, 30, 26, null),
					new ExpectedCellValue(sheetName, 31, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 32, 26, null),
					new ExpectedCellValue(sheetName, 10, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 27, null),
					new ExpectedCellValue(sheetName, 12, 27, null),
					new ExpectedCellValue(sheetName, 13, 27, 831.5),
					new ExpectedCellValue(sheetName, 14, 27, null),
					new ExpectedCellValue(sheetName, 15, 27, null),
					new ExpectedCellValue(sheetName, 16, 27, 831.5),
					new ExpectedCellValue(sheetName, 17, 27, null),
					new ExpectedCellValue(sheetName, 18, 27, null),
					new ExpectedCellValue(sheetName, 19, 27, 1194d),
					new ExpectedCellValue(sheetName, 20, 27, null),
					new ExpectedCellValue(sheetName, 21, 27, null),
					new ExpectedCellValue(sheetName, 22, 27, 415.75),
					new ExpectedCellValue(sheetName, 23, 27, null),
					new ExpectedCellValue(sheetName, 24, 27, null),
					new ExpectedCellValue(sheetName, 25, 27, 24.99),
					new ExpectedCellValue(sheetName, 26, 27, null),
					new ExpectedCellValue(sheetName, 27, 27, null),
					new ExpectedCellValue(sheetName, 28, 27, 99d),
					new ExpectedCellValue(sheetName, 29, 27, null),
					new ExpectedCellValue(sheetName, 30, 27, null),
					new ExpectedCellValue(sheetName, 31, 27, 831.5),
					new ExpectedCellValue(sheetName, 32, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstSecondAndLastFieldsTabularThirdFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W10:AA39"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 23, 20100007),
					new ExpectedCellValue(sheetName, 12, 23, null),
					new ExpectedCellValue(sheetName, 13, 23, null),
					new ExpectedCellValue(sheetName, 14, 23, null),
					new ExpectedCellValue(sheetName, 15, 23, 20100017),
					new ExpectedCellValue(sheetName, 16, 23, null),
					new ExpectedCellValue(sheetName, 17, 23, null),
					new ExpectedCellValue(sheetName, 18, 23, null),
					new ExpectedCellValue(sheetName, 19, 23, 20100070),
					new ExpectedCellValue(sheetName, 20, 23, null),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, null),
					new ExpectedCellValue(sheetName, 23, 23, 20100076),
					new ExpectedCellValue(sheetName, 24, 23, null),
					new ExpectedCellValue(sheetName, 25, 23, null),
					new ExpectedCellValue(sheetName, 26, 23, null),
					new ExpectedCellValue(sheetName, 27, 23, 20100083),
					new ExpectedCellValue(sheetName, 28, 23, null),
					new ExpectedCellValue(sheetName, 29, 23, null),
					new ExpectedCellValue(sheetName, 30, 23, null),
					new ExpectedCellValue(sheetName, 31, 23, 20100085),
					new ExpectedCellValue(sheetName, 32, 23, null),
					new ExpectedCellValue(sheetName, 33, 23, null),
					new ExpectedCellValue(sheetName, 34, 23, null),
					new ExpectedCellValue(sheetName, 35, 23, 20100090),
					new ExpectedCellValue(sheetName, 36, 23, null),
					new ExpectedCellValue(sheetName, 37, 23, null),
					new ExpectedCellValue(sheetName, 38, 23, null),
					new ExpectedCellValue(sheetName, 39, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 24, "Location"),
					new ExpectedCellValue(sheetName, 11, 24, null),
					new ExpectedCellValue(sheetName, 12, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 24, null),
					new ExpectedCellValue(sheetName, 14, 24, null),
					new ExpectedCellValue(sheetName, 15, 24, null),
					new ExpectedCellValue(sheetName, 16, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 24, null),
					new ExpectedCellValue(sheetName, 18, 24, null),
					new ExpectedCellValue(sheetName, 19, 24, null),
					new ExpectedCellValue(sheetName, 20, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 24, null),
					new ExpectedCellValue(sheetName, 22, 24, null),
					new ExpectedCellValue(sheetName, 23, 24, null),
					new ExpectedCellValue(sheetName, 24, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 24, null),
					new ExpectedCellValue(sheetName, 26, 24, null),
					new ExpectedCellValue(sheetName, 27, 24, null),
					new ExpectedCellValue(sheetName, 28, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 29, 24, null),
					new ExpectedCellValue(sheetName, 30, 24, null),
					new ExpectedCellValue(sheetName, 31, 24, null),
					new ExpectedCellValue(sheetName, 32, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 33, 24, null),
					new ExpectedCellValue(sheetName, 34, 24, null),
					new ExpectedCellValue(sheetName, 35, 24, null),
					new ExpectedCellValue(sheetName, 36, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 24, null),
					new ExpectedCellValue(sheetName, 38, 24, null),
					new ExpectedCellValue(sheetName, 39, 24, null),
					new ExpectedCellValue(sheetName, 10, 25, "Month"),
					new ExpectedCellValue(sheetName, 11, 25, null),
					new ExpectedCellValue(sheetName, 12, 25, null),
					new ExpectedCellValue(sheetName, 13, 25, "January"),
					new ExpectedCellValue(sheetName, 14, 25, "January Total"),
					new ExpectedCellValue(sheetName, 15, 25, null),
					new ExpectedCellValue(sheetName, 16, 25, null),
					new ExpectedCellValue(sheetName, 17, 25, "March"),
					new ExpectedCellValue(sheetName, 18, 25, "March Total"),
					new ExpectedCellValue(sheetName, 19, 25, null),
					new ExpectedCellValue(sheetName, 20, 25, null),
					new ExpectedCellValue(sheetName, 21, 25, "February"),
					new ExpectedCellValue(sheetName, 22, 25, "February Total"),
					new ExpectedCellValue(sheetName, 23, 25, null),
					new ExpectedCellValue(sheetName, 24, 25, null),
					new ExpectedCellValue(sheetName, 25, 25, "January"),
					new ExpectedCellValue(sheetName, 26, 25, "January Total"),
					new ExpectedCellValue(sheetName, 27, 25, null),
					new ExpectedCellValue(sheetName, 28, 25, null),
					new ExpectedCellValue(sheetName, 29, 25, "March"),
					new ExpectedCellValue(sheetName, 30, 25, "March Total"),
					new ExpectedCellValue(sheetName, 31, 25, null),
					new ExpectedCellValue(sheetName, 32, 25, null),
					new ExpectedCellValue(sheetName, 33, 25, "February"),
					new ExpectedCellValue(sheetName, 34, 25, "February Total"),
					new ExpectedCellValue(sheetName, 35, 25, null),
					new ExpectedCellValue(sheetName, 36, 25, null),
					new ExpectedCellValue(sheetName, 37, 25, "January"),
					new ExpectedCellValue(sheetName, 38, 25, "January Total"),
					new ExpectedCellValue(sheetName, 39, 25, null),
					new ExpectedCellValue(sheetName, 10, 26, "Item"),
					new ExpectedCellValue(sheetName, 11, 26, null),
					new ExpectedCellValue(sheetName, 12, 26, null),
					new ExpectedCellValue(sheetName, 13, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 26, null),
					new ExpectedCellValue(sheetName, 15, 26, null),
					new ExpectedCellValue(sheetName, 16, 26, null),
					new ExpectedCellValue(sheetName, 17, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 26, null),
					new ExpectedCellValue(sheetName, 19, 26, null),
					new ExpectedCellValue(sheetName, 20, 26, null),
					new ExpectedCellValue(sheetName, 21, 26, "Tent"),
					new ExpectedCellValue(sheetName, 22, 26, null),
					new ExpectedCellValue(sheetName, 23, 26, null),
					new ExpectedCellValue(sheetName, 24, 26, null),
					new ExpectedCellValue(sheetName, 25, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 26, null),
					new ExpectedCellValue(sheetName, 27, 26, null),
					new ExpectedCellValue(sheetName, 28, 26, null),
					new ExpectedCellValue(sheetName, 29, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 30, 26, null),
					new ExpectedCellValue(sheetName, 31, 26, null),
					new ExpectedCellValue(sheetName, 32, 26, null),
					new ExpectedCellValue(sheetName, 33, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 34, 26, null),
					new ExpectedCellValue(sheetName, 35, 26, null),
					new ExpectedCellValue(sheetName, 36, 26, null),
					new ExpectedCellValue(sheetName, 37, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 26, null),
					new ExpectedCellValue(sheetName, 39, 26, null),
					new ExpectedCellValue(sheetName, 10, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 27, 831.5),
					new ExpectedCellValue(sheetName, 12, 27, 831.5),
					new ExpectedCellValue(sheetName, 13, 27, 831.5),
					new ExpectedCellValue(sheetName, 14, 27, 831.5),
					new ExpectedCellValue(sheetName, 15, 27, 831.5),
					new ExpectedCellValue(sheetName, 16, 27, 831.5),
					new ExpectedCellValue(sheetName, 17, 27, 831.5),
					new ExpectedCellValue(sheetName, 18, 27, 831.5),
					new ExpectedCellValue(sheetName, 19, 27, 1194d),
					new ExpectedCellValue(sheetName, 20, 27, 1194d),
					new ExpectedCellValue(sheetName, 21, 27, 1194d),
					new ExpectedCellValue(sheetName, 22, 27, 1194d),
					new ExpectedCellValue(sheetName, 23, 27, 415.75),
					new ExpectedCellValue(sheetName, 24, 27, 415.75),
					new ExpectedCellValue(sheetName, 25, 27, 415.75),
					new ExpectedCellValue(sheetName, 26, 27, 415.75),
					new ExpectedCellValue(sheetName, 27, 27, 24.99),
					new ExpectedCellValue(sheetName, 28, 27, 24.99),
					new ExpectedCellValue(sheetName, 29, 27, 24.99),
					new ExpectedCellValue(sheetName, 30, 27, 24.99),
					new ExpectedCellValue(sheetName, 31, 27, 99d),
					new ExpectedCellValue(sheetName, 32, 27, 99d),
					new ExpectedCellValue(sheetName, 33, 27, 99d),
					new ExpectedCellValue(sheetName, 34, 27, 99d),
					new ExpectedCellValue(sheetName, 35, 27, 831.5),
					new ExpectedCellValue(sheetName, 36, 27, 831.5),
					new ExpectedCellValue(sheetName, 37, 27, 831.5),
					new ExpectedCellValue(sheetName, 38, 27, 831.5),
					new ExpectedCellValue(sheetName, 39, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstSecondAndLastFieldsTabularThirdFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W10:AA53"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 23, 20100007),
					new ExpectedCellValue(sheetName, 12, 23, null),
					new ExpectedCellValue(sheetName, 13, 23, null),
					new ExpectedCellValue(sheetName, 14, 23, null),
					new ExpectedCellValue(sheetName, 15, 23, null),
					new ExpectedCellValue(sheetName, 16, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 17, 23, 20100017),
					new ExpectedCellValue(sheetName, 18, 23, null),
					new ExpectedCellValue(sheetName, 19, 23, null),
					new ExpectedCellValue(sheetName, 20, 23, null),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 23, 23, 20100070),
					new ExpectedCellValue(sheetName, 24, 23, null),
					new ExpectedCellValue(sheetName, 25, 23, null),
					new ExpectedCellValue(sheetName, 26, 23, null),
					new ExpectedCellValue(sheetName, 27, 23, null),
					new ExpectedCellValue(sheetName, 28, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 29, 23, 20100076),
					new ExpectedCellValue(sheetName, 30, 23, null),
					new ExpectedCellValue(sheetName, 31, 23, null),
					new ExpectedCellValue(sheetName, 32, 23, null),
					new ExpectedCellValue(sheetName, 33, 23, null),
					new ExpectedCellValue(sheetName, 34, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 35, 23, 20100083),
					new ExpectedCellValue(sheetName, 36, 23, null),
					new ExpectedCellValue(sheetName, 37, 23, null),
					new ExpectedCellValue(sheetName, 38, 23, null),
					new ExpectedCellValue(sheetName, 39, 23, null),
					new ExpectedCellValue(sheetName, 40, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 41, 23, 20100085),
					new ExpectedCellValue(sheetName, 42, 23, null),
					new ExpectedCellValue(sheetName, 43, 23, null),
					new ExpectedCellValue(sheetName, 44, 23, null),
					new ExpectedCellValue(sheetName, 45, 23, null),
					new ExpectedCellValue(sheetName, 46, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 47, 23, 20100090),
					new ExpectedCellValue(sheetName, 48, 23, null),
					new ExpectedCellValue(sheetName, 49, 23, null),
					new ExpectedCellValue(sheetName, 50, 23, null),
					new ExpectedCellValue(sheetName, 51, 23, null),
					new ExpectedCellValue(sheetName, 52, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 53, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 24, "Location"),
					new ExpectedCellValue(sheetName, 11, 24, null),
					new ExpectedCellValue(sheetName, 12, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 24, null),
					new ExpectedCellValue(sheetName, 14, 24, null),
					new ExpectedCellValue(sheetName, 15, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 16, 24, null),
					new ExpectedCellValue(sheetName, 17, 24, null),
					new ExpectedCellValue(sheetName, 18, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 24, null),
					new ExpectedCellValue(sheetName, 20, 24, null),
					new ExpectedCellValue(sheetName, 21, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 24, null),
					new ExpectedCellValue(sheetName, 23, 24, null),
					new ExpectedCellValue(sheetName, 24, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 25, 24, null),
					new ExpectedCellValue(sheetName, 26, 24, null),
					new ExpectedCellValue(sheetName, 27, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 28, 24, null),
					new ExpectedCellValue(sheetName, 29, 24, null),
					new ExpectedCellValue(sheetName, 30, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 31, 24, null),
					new ExpectedCellValue(sheetName, 32, 24, null),
					new ExpectedCellValue(sheetName, 33, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 34, 24, null),
					new ExpectedCellValue(sheetName, 35, 24, null),
					new ExpectedCellValue(sheetName, 36, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 37, 24, null),
					new ExpectedCellValue(sheetName, 38, 24, null),
					new ExpectedCellValue(sheetName, 39, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 40, 24, null),
					new ExpectedCellValue(sheetName, 41, 24, null),
					new ExpectedCellValue(sheetName, 42, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 43, 24, null),
					new ExpectedCellValue(sheetName, 44, 24, null),
					new ExpectedCellValue(sheetName, 45, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 46, 24, null),
					new ExpectedCellValue(sheetName, 47, 24, null),
					new ExpectedCellValue(sheetName, 48, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 24, null),
					new ExpectedCellValue(sheetName, 50, 24, null),
					new ExpectedCellValue(sheetName, 51, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 52, 24, null),
					new ExpectedCellValue(sheetName, 53, 24, null),
					new ExpectedCellValue(sheetName, 10, 25, "Month"),
					new ExpectedCellValue(sheetName, 11, 25, null),
					new ExpectedCellValue(sheetName, 12, 25, null),
					new ExpectedCellValue(sheetName, 13, 25, "January"),
					new ExpectedCellValue(sheetName, 14, 25, "January Total"),
					new ExpectedCellValue(sheetName, 15, 25, null),
					new ExpectedCellValue(sheetName, 16, 25, null),
					new ExpectedCellValue(sheetName, 17, 25, null),
					new ExpectedCellValue(sheetName, 18, 25, null),
					new ExpectedCellValue(sheetName, 19, 25, "March"),
					new ExpectedCellValue(sheetName, 20, 25, "March Total"),
					new ExpectedCellValue(sheetName, 21, 25, null),
					new ExpectedCellValue(sheetName, 22, 25, null),
					new ExpectedCellValue(sheetName, 23, 25, null),
					new ExpectedCellValue(sheetName, 24, 25, null),
					new ExpectedCellValue(sheetName, 25, 25, "February"),
					new ExpectedCellValue(sheetName, 26, 25, "February Total"),
					new ExpectedCellValue(sheetName, 27, 25, null),
					new ExpectedCellValue(sheetName, 28, 25, null),
					new ExpectedCellValue(sheetName, 29, 25, null),
					new ExpectedCellValue(sheetName, 30, 25, null),
					new ExpectedCellValue(sheetName, 31, 25, "January"),
					new ExpectedCellValue(sheetName, 32, 25, "January Total"),
					new ExpectedCellValue(sheetName, 33, 25, null),
					new ExpectedCellValue(sheetName, 34, 25, null),
					new ExpectedCellValue(sheetName, 35, 25, null),
					new ExpectedCellValue(sheetName, 36, 25, null),
					new ExpectedCellValue(sheetName, 37, 25, "March"),
					new ExpectedCellValue(sheetName, 38, 25, "March Total"),
					new ExpectedCellValue(sheetName, 39, 25, null),
					new ExpectedCellValue(sheetName, 40, 25, null),
					new ExpectedCellValue(sheetName, 41, 25, null),
					new ExpectedCellValue(sheetName, 42, 25, null),
					new ExpectedCellValue(sheetName, 43, 25, "February"),
					new ExpectedCellValue(sheetName, 44, 25, "February Total"),
					new ExpectedCellValue(sheetName, 45, 25, null),
					new ExpectedCellValue(sheetName, 46, 25, null),
					new ExpectedCellValue(sheetName, 47, 25, null),
					new ExpectedCellValue(sheetName, 48, 25, null),
					new ExpectedCellValue(sheetName, 49, 25, "January"),
					new ExpectedCellValue(sheetName, 50, 25, "January Total"),
					new ExpectedCellValue(sheetName, 51, 25, null),
					new ExpectedCellValue(sheetName, 52, 25, null),
					new ExpectedCellValue(sheetName, 53, 25, null),
					new ExpectedCellValue(sheetName, 10, 26, "Item"),
					new ExpectedCellValue(sheetName, 11, 26, null),
					new ExpectedCellValue(sheetName, 12, 26, null),
					new ExpectedCellValue(sheetName, 13, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 26, null),
					new ExpectedCellValue(sheetName, 15, 26, null),
					new ExpectedCellValue(sheetName, 16, 26, null),
					new ExpectedCellValue(sheetName, 17, 26, null),
					new ExpectedCellValue(sheetName, 18, 26, null),
					new ExpectedCellValue(sheetName, 19, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 26, null),
					new ExpectedCellValue(sheetName, 21, 26, null),
					new ExpectedCellValue(sheetName, 22, 26, null),
					new ExpectedCellValue(sheetName, 23, 26, null),
					new ExpectedCellValue(sheetName, 24, 26, null),
					new ExpectedCellValue(sheetName, 25, 26, "Tent"),
					new ExpectedCellValue(sheetName, 26, 26, null),
					new ExpectedCellValue(sheetName, 27, 26, null),
					new ExpectedCellValue(sheetName, 28, 26, null),
					new ExpectedCellValue(sheetName, 29, 26, null),
					new ExpectedCellValue(sheetName, 30, 26, null),
					new ExpectedCellValue(sheetName, 31, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 32, 26, null),
					new ExpectedCellValue(sheetName, 33, 26, null),
					new ExpectedCellValue(sheetName, 34, 26, null),
					new ExpectedCellValue(sheetName, 35, 26, null),
					new ExpectedCellValue(sheetName, 36, 26, null),
					new ExpectedCellValue(sheetName, 37, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 38, 26, null),
					new ExpectedCellValue(sheetName, 39, 26, null),
					new ExpectedCellValue(sheetName, 40, 26, null),
					new ExpectedCellValue(sheetName, 41, 26, null),
					new ExpectedCellValue(sheetName, 42, 26, null),
					new ExpectedCellValue(sheetName, 43, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 44, 26, null),
					new ExpectedCellValue(sheetName, 45, 26, null),
					new ExpectedCellValue(sheetName, 46, 26, null),
					new ExpectedCellValue(sheetName, 47, 26, null),
					new ExpectedCellValue(sheetName, 48, 26, null),
					new ExpectedCellValue(sheetName, 49, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 26, null),
					new ExpectedCellValue(sheetName, 51, 26, null),
					new ExpectedCellValue(sheetName, 52, 26, null),
					new ExpectedCellValue(sheetName, 53, 26, null),
					new ExpectedCellValue(sheetName, 10, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 27, null),
					new ExpectedCellValue(sheetName, 12, 27, null),
					new ExpectedCellValue(sheetName, 13, 27, 831.5),
					new ExpectedCellValue(sheetName, 14, 27, 831.5),
					new ExpectedCellValue(sheetName, 15, 27, 831.5),
					new ExpectedCellValue(sheetName, 16, 27, 831.5),
					new ExpectedCellValue(sheetName, 17, 27, null),
					new ExpectedCellValue(sheetName, 18, 27, null),
					new ExpectedCellValue(sheetName, 19, 27, 831.5),
					new ExpectedCellValue(sheetName, 20, 27, 831.5),
					new ExpectedCellValue(sheetName, 21, 27, 831.5),
					new ExpectedCellValue(sheetName, 22, 27, 831.5),
					new ExpectedCellValue(sheetName, 23, 27, null),
					new ExpectedCellValue(sheetName, 24, 27, null),
					new ExpectedCellValue(sheetName, 25, 27, 1194d),
					new ExpectedCellValue(sheetName, 26, 27, 1194d),
					new ExpectedCellValue(sheetName, 27, 27, 1194d),
					new ExpectedCellValue(sheetName, 28, 27, 1194d),
					new ExpectedCellValue(sheetName, 29, 27, null),
					new ExpectedCellValue(sheetName, 30, 27, null),
					new ExpectedCellValue(sheetName, 31, 27, 415.75),
					new ExpectedCellValue(sheetName, 32, 27, 415.75),
					new ExpectedCellValue(sheetName, 33, 27, 415.75),
					new ExpectedCellValue(sheetName, 34, 27, 415.75),
					new ExpectedCellValue(sheetName, 35, 27, null),
					new ExpectedCellValue(sheetName, 36, 27, null),
					new ExpectedCellValue(sheetName, 37, 27, 24.99),
					new ExpectedCellValue(sheetName, 38, 27, 24.99),
					new ExpectedCellValue(sheetName, 39, 27, 24.99),
					new ExpectedCellValue(sheetName, 40, 27, 24.99),
					new ExpectedCellValue(sheetName, 41, 27, null),
					new ExpectedCellValue(sheetName, 42, 27, null),
					new ExpectedCellValue(sheetName, 43, 27, 99d),
					new ExpectedCellValue(sheetName, 44, 27, 99d),
					new ExpectedCellValue(sheetName, 45, 27, 99d),
					new ExpectedCellValue(sheetName, 46, 27, 99d),
					new ExpectedCellValue(sheetName, 47, 27, null),
					new ExpectedCellValue(sheetName, 48, 27, null),
					new ExpectedCellValue(sheetName, 49, 27, 831.5),
					new ExpectedCellValue(sheetName, 50, 27, 831.5),
					new ExpectedCellValue(sheetName, 51, 27, 831.5),
					new ExpectedCellValue(sheetName, 52, 27, 831.5),
					new ExpectedCellValue(sheetName, 53, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndSecondFieldsTabularThirdAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD10:AH32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 30, 20100007),
					new ExpectedCellValue(sheetName, 12, 30, null),
					new ExpectedCellValue(sheetName, 13, 30, null),
					new ExpectedCellValue(sheetName, 14, 30, 20100017),
					new ExpectedCellValue(sheetName, 15, 30, null),
					new ExpectedCellValue(sheetName, 16, 30, null),
					new ExpectedCellValue(sheetName, 17, 30, 20100070),
					new ExpectedCellValue(sheetName, 18, 30, null),
					new ExpectedCellValue(sheetName, 19, 30, null),
					new ExpectedCellValue(sheetName, 20, 30, 20100076),
					new ExpectedCellValue(sheetName, 21, 30, null),
					new ExpectedCellValue(sheetName, 22, 30, null),
					new ExpectedCellValue(sheetName, 23, 30, 20100083),
					new ExpectedCellValue(sheetName, 24, 30, null),
					new ExpectedCellValue(sheetName, 25, 30, null),
					new ExpectedCellValue(sheetName, 26, 30, 20100085),
					new ExpectedCellValue(sheetName, 27, 30, null),
					new ExpectedCellValue(sheetName, 28, 30, null),
					new ExpectedCellValue(sheetName, 29, 30, 20100090),
					new ExpectedCellValue(sheetName, 30, 30, null),
					new ExpectedCellValue(sheetName, 31, 30, null),
					new ExpectedCellValue(sheetName, 32, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 31, "Location"),
					new ExpectedCellValue(sheetName, 11, 31, null),
					new ExpectedCellValue(sheetName, 12, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 31, null),
					new ExpectedCellValue(sheetName, 14, 31, null),
					new ExpectedCellValue(sheetName, 15, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 31, null),
					new ExpectedCellValue(sheetName, 17, 31, null),
					new ExpectedCellValue(sheetName, 18, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 31, null),
					new ExpectedCellValue(sheetName, 20, 31, null),
					new ExpectedCellValue(sheetName, 21, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 31, null),
					new ExpectedCellValue(sheetName, 23, 31, null),
					new ExpectedCellValue(sheetName, 24, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 31, null),
					new ExpectedCellValue(sheetName, 26, 31, null),
					new ExpectedCellValue(sheetName, 27, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 31, null),
					new ExpectedCellValue(sheetName, 29, 31, null),
					new ExpectedCellValue(sheetName, 30, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 31, 31, null),
					new ExpectedCellValue(sheetName, 32, 31, null),
					new ExpectedCellValue(sheetName, 10, 32, "Month"),
					new ExpectedCellValue(sheetName, 11, 32, null),
					new ExpectedCellValue(sheetName, 12, 32, null),
					new ExpectedCellValue(sheetName, 13, 32, "January"),
					new ExpectedCellValue(sheetName, 14, 32, null),
					new ExpectedCellValue(sheetName, 15, 32, null),
					new ExpectedCellValue(sheetName, 16, 32, "March"),
					new ExpectedCellValue(sheetName, 17, 32, null),
					new ExpectedCellValue(sheetName, 18, 32, null),
					new ExpectedCellValue(sheetName, 19, 32, "February"),
					new ExpectedCellValue(sheetName, 20, 32, null),
					new ExpectedCellValue(sheetName, 21, 32, null),
					new ExpectedCellValue(sheetName, 22, 32, "January"),
					new ExpectedCellValue(sheetName, 23, 32, null),
					new ExpectedCellValue(sheetName, 24, 32, null),
					new ExpectedCellValue(sheetName, 25, 32, "March"),
					new ExpectedCellValue(sheetName, 26, 32, null),
					new ExpectedCellValue(sheetName, 27, 32, null),
					new ExpectedCellValue(sheetName, 28, 32, "February"),
					new ExpectedCellValue(sheetName, 29, 32, null),
					new ExpectedCellValue(sheetName, 30, 32, null),
					new ExpectedCellValue(sheetName, 31, 32, "January"),
					new ExpectedCellValue(sheetName, 32, 32, null),
					new ExpectedCellValue(sheetName, 10, 33, "Item"),
					new ExpectedCellValue(sheetName, 11, 33, null),
					new ExpectedCellValue(sheetName, 12, 33, null),
					new ExpectedCellValue(sheetName, 13, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 33, null),
					new ExpectedCellValue(sheetName, 15, 33, null),
					new ExpectedCellValue(sheetName, 16, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 17, 33, null),
					new ExpectedCellValue(sheetName, 18, 33, null),
					new ExpectedCellValue(sheetName, 19, 33, "Tent"),
					new ExpectedCellValue(sheetName, 20, 33, null),
					new ExpectedCellValue(sheetName, 21, 33, null),
					new ExpectedCellValue(sheetName, 22, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 33, null),
					new ExpectedCellValue(sheetName, 24, 33, null),
					new ExpectedCellValue(sheetName, 25, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 26, 33, null),
					new ExpectedCellValue(sheetName, 27, 33, null),
					new ExpectedCellValue(sheetName, 28, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 29, 33, null),
					new ExpectedCellValue(sheetName, 30, 33, null),
					new ExpectedCellValue(sheetName, 31, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 32, 33, null),
					new ExpectedCellValue(sheetName, 10, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 34, null),
					new ExpectedCellValue(sheetName, 12, 34, null),
					new ExpectedCellValue(sheetName, 13, 34, 831.5),
					new ExpectedCellValue(sheetName, 14, 34, null),
					new ExpectedCellValue(sheetName, 15, 34, null),
					new ExpectedCellValue(sheetName, 16, 34, 831.5),
					new ExpectedCellValue(sheetName, 17, 34, null),
					new ExpectedCellValue(sheetName, 18, 34, null),
					new ExpectedCellValue(sheetName, 19, 34, 1194d),
					new ExpectedCellValue(sheetName, 20, 34, null),
					new ExpectedCellValue(sheetName, 21, 34, null),
					new ExpectedCellValue(sheetName, 22, 34, 415.75),
					new ExpectedCellValue(sheetName, 23, 34, null),
					new ExpectedCellValue(sheetName, 24, 34, null),
					new ExpectedCellValue(sheetName, 25, 34, 24.99),
					new ExpectedCellValue(sheetName, 26, 34, null),
					new ExpectedCellValue(sheetName, 27, 34, null),
					new ExpectedCellValue(sheetName, 28, 34, 99d),
					new ExpectedCellValue(sheetName, 29, 34, null),
					new ExpectedCellValue(sheetName, 30, 34, null),
					new ExpectedCellValue(sheetName, 31, 34, 831.5),
					new ExpectedCellValue(sheetName, 32, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndSecondFieldsTabularThirdAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD10:AH39"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 30, 20100007),
					new ExpectedCellValue(sheetName, 12, 30, null),
					new ExpectedCellValue(sheetName, 13, 30, null),
					new ExpectedCellValue(sheetName, 14, 30, null),
					new ExpectedCellValue(sheetName, 15, 30, 20100017),
					new ExpectedCellValue(sheetName, 16, 30, null),
					new ExpectedCellValue(sheetName, 17, 30, null),
					new ExpectedCellValue(sheetName, 18, 30, null),
					new ExpectedCellValue(sheetName, 19, 30, 20100070),
					new ExpectedCellValue(sheetName, 20, 30, null),
					new ExpectedCellValue(sheetName, 21, 30, null),
					new ExpectedCellValue(sheetName, 22, 30, null),
					new ExpectedCellValue(sheetName, 23, 30, 20100076),
					new ExpectedCellValue(sheetName, 24, 30, null),
					new ExpectedCellValue(sheetName, 25, 30, null),
					new ExpectedCellValue(sheetName, 26, 30, null),
					new ExpectedCellValue(sheetName, 27, 30, 20100083),
					new ExpectedCellValue(sheetName, 28, 30, null),
					new ExpectedCellValue(sheetName, 29, 30, null),
					new ExpectedCellValue(sheetName, 30, 30, null),
					new ExpectedCellValue(sheetName, 31, 30, 20100085),
					new ExpectedCellValue(sheetName, 32, 30, null),
					new ExpectedCellValue(sheetName, 33, 30, null),
					new ExpectedCellValue(sheetName, 34, 30, null),
					new ExpectedCellValue(sheetName, 35, 30, 20100090),
					new ExpectedCellValue(sheetName, 36, 30, null),
					new ExpectedCellValue(sheetName, 37, 30, null),
					new ExpectedCellValue(sheetName, 38, 30, null),
					new ExpectedCellValue(sheetName, 39, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 31, "Location"),
					new ExpectedCellValue(sheetName, 11, 31, null),
					new ExpectedCellValue(sheetName, 12, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 31, null),
					new ExpectedCellValue(sheetName, 14, 31, null),
					new ExpectedCellValue(sheetName, 15, 31, null),
					new ExpectedCellValue(sheetName, 16, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 31, null),
					new ExpectedCellValue(sheetName, 18, 31, null),
					new ExpectedCellValue(sheetName, 19, 31, null),
					new ExpectedCellValue(sheetName, 20, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 31, null),
					new ExpectedCellValue(sheetName, 22, 31, null),
					new ExpectedCellValue(sheetName, 23, 31, null),
					new ExpectedCellValue(sheetName, 24, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 31, null),
					new ExpectedCellValue(sheetName, 26, 31, null),
					new ExpectedCellValue(sheetName, 27, 31, null),
					new ExpectedCellValue(sheetName, 28, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 29, 31, null),
					new ExpectedCellValue(sheetName, 30, 31, null),
					new ExpectedCellValue(sheetName, 31, 31, null),
					new ExpectedCellValue(sheetName, 32, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 33, 31, null),
					new ExpectedCellValue(sheetName, 34, 31, null),
					new ExpectedCellValue(sheetName, 35, 31, null),
					new ExpectedCellValue(sheetName, 36, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 31, null),
					new ExpectedCellValue(sheetName, 38, 31, null),
					new ExpectedCellValue(sheetName, 39, 31, null),
					new ExpectedCellValue(sheetName, 10, 32, "Month"),
					new ExpectedCellValue(sheetName, 11, 32, null),
					new ExpectedCellValue(sheetName, 12, 32, null),
					new ExpectedCellValue(sheetName, 13, 32, "January"),
					new ExpectedCellValue(sheetName, 14, 32, "January Total"),
					new ExpectedCellValue(sheetName, 15, 32, null),
					new ExpectedCellValue(sheetName, 16, 32, null),
					new ExpectedCellValue(sheetName, 17, 32, "March"),
					new ExpectedCellValue(sheetName, 18, 32, "March Total"),
					new ExpectedCellValue(sheetName, 19, 32, null),
					new ExpectedCellValue(sheetName, 20, 32, null),
					new ExpectedCellValue(sheetName, 21, 32, "February"),
					new ExpectedCellValue(sheetName, 22, 32, "February Total"),
					new ExpectedCellValue(sheetName, 23, 32, null),
					new ExpectedCellValue(sheetName, 24, 32, null),
					new ExpectedCellValue(sheetName, 25, 32, "January"),
					new ExpectedCellValue(sheetName, 26, 32, "January Total"),
					new ExpectedCellValue(sheetName, 27, 32, null),
					new ExpectedCellValue(sheetName, 28, 32, null),
					new ExpectedCellValue(sheetName, 29, 32, "March"),
					new ExpectedCellValue(sheetName, 30, 32, "March Total"),
					new ExpectedCellValue(sheetName, 31, 32, null),
					new ExpectedCellValue(sheetName, 32, 32, null),
					new ExpectedCellValue(sheetName, 33, 32, "February"),
					new ExpectedCellValue(sheetName, 34, 32, "February Total"),
					new ExpectedCellValue(sheetName, 35, 32, null),
					new ExpectedCellValue(sheetName, 36, 32, null),
					new ExpectedCellValue(sheetName, 37, 32, "January"),
					new ExpectedCellValue(sheetName, 38, 32, "January Total"),
					new ExpectedCellValue(sheetName, 39, 32, null),
					new ExpectedCellValue(sheetName, 10, 33, "Item"),
					new ExpectedCellValue(sheetName, 11, 33, null),
					new ExpectedCellValue(sheetName, 12, 33, null),
					new ExpectedCellValue(sheetName, 13, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 33, null),
					new ExpectedCellValue(sheetName, 15, 33, null),
					new ExpectedCellValue(sheetName, 16, 33, null),
					new ExpectedCellValue(sheetName, 17, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 33, null),
					new ExpectedCellValue(sheetName, 19, 33, null),
					new ExpectedCellValue(sheetName, 20, 33, null),
					new ExpectedCellValue(sheetName, 21, 33, "Tent"),
					new ExpectedCellValue(sheetName, 22, 33, null),
					new ExpectedCellValue(sheetName, 23, 33, null),
					new ExpectedCellValue(sheetName, 24, 33, null),
					new ExpectedCellValue(sheetName, 25, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 26, 33, null),
					new ExpectedCellValue(sheetName, 27, 33, null),
					new ExpectedCellValue(sheetName, 28, 33, null),
					new ExpectedCellValue(sheetName, 29, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 30, 33, null),
					new ExpectedCellValue(sheetName, 31, 33, null),
					new ExpectedCellValue(sheetName, 32, 33, null),
					new ExpectedCellValue(sheetName, 33, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 34, 33, null),
					new ExpectedCellValue(sheetName, 35, 33, null),
					new ExpectedCellValue(sheetName, 36, 33, null),
					new ExpectedCellValue(sheetName, 37, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 33, null),
					new ExpectedCellValue(sheetName, 39, 33, null),
					new ExpectedCellValue(sheetName, 10, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 34, 831.5),
					new ExpectedCellValue(sheetName, 12, 34, 831.5),
					new ExpectedCellValue(sheetName, 13, 34, 831.5),
					new ExpectedCellValue(sheetName, 14, 34, 831.5),
					new ExpectedCellValue(sheetName, 15, 34, 831.5),
					new ExpectedCellValue(sheetName, 16, 34, 831.5),
					new ExpectedCellValue(sheetName, 17, 34, 831.5),
					new ExpectedCellValue(sheetName, 18, 34, 831.5),
					new ExpectedCellValue(sheetName, 19, 34, 1194d),
					new ExpectedCellValue(sheetName, 20, 34, 1194d),
					new ExpectedCellValue(sheetName, 21, 34, 1194d),
					new ExpectedCellValue(sheetName, 22, 34, 1194d),
					new ExpectedCellValue(sheetName, 23, 34, 415.75),
					new ExpectedCellValue(sheetName, 24, 34, 415.75),
					new ExpectedCellValue(sheetName, 25, 34, 415.75),
					new ExpectedCellValue(sheetName, 26, 34, 415.75),
					new ExpectedCellValue(sheetName, 27, 34, 24.99),
					new ExpectedCellValue(sheetName, 28, 34, 24.99),
					new ExpectedCellValue(sheetName, 29, 34, 24.99),
					new ExpectedCellValue(sheetName, 30, 34, 24.99),
					new ExpectedCellValue(sheetName, 31, 34, 99d),
					new ExpectedCellValue(sheetName, 32, 34, 99d),
					new ExpectedCellValue(sheetName, 33, 34, 99d),
					new ExpectedCellValue(sheetName, 34, 34, 99d),
					new ExpectedCellValue(sheetName, 35, 34, 831.5),
					new ExpectedCellValue(sheetName, 36, 34, 831.5),
					new ExpectedCellValue(sheetName, 37, 34, 831.5),
					new ExpectedCellValue(sheetName, 38, 34, 831.5),
					new ExpectedCellValue(sheetName, 39, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndSecondFieldsTabularThirdAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD10:AH53"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 30, 20100007),
					new ExpectedCellValue(sheetName, 12, 30, null),
					new ExpectedCellValue(sheetName, 13, 30, null),
					new ExpectedCellValue(sheetName, 14, 30, null),
					new ExpectedCellValue(sheetName, 15, 30, null),
					new ExpectedCellValue(sheetName, 16, 30, "20100007 Total"),
					new ExpectedCellValue(sheetName, 17, 30, 20100017),
					new ExpectedCellValue(sheetName, 18, 30, null),
					new ExpectedCellValue(sheetName, 19, 30, null),
					new ExpectedCellValue(sheetName, 20, 30, null),
					new ExpectedCellValue(sheetName, 21, 30, null),
					new ExpectedCellValue(sheetName, 22, 30, "20100017 Total"),
					new ExpectedCellValue(sheetName, 23, 30, 20100070),
					new ExpectedCellValue(sheetName, 24, 30, null),
					new ExpectedCellValue(sheetName, 25, 30, null),
					new ExpectedCellValue(sheetName, 26, 30, null),
					new ExpectedCellValue(sheetName, 27, 30, null),
					new ExpectedCellValue(sheetName, 28, 30, "20100070 Total"),
					new ExpectedCellValue(sheetName, 29, 30, 20100076),
					new ExpectedCellValue(sheetName, 30, 30, null),
					new ExpectedCellValue(sheetName, 31, 30, null),
					new ExpectedCellValue(sheetName, 32, 30, null),
					new ExpectedCellValue(sheetName, 33, 30, null),
					new ExpectedCellValue(sheetName, 34, 30, "20100076 Total"),
					new ExpectedCellValue(sheetName, 35, 30, 20100083),
					new ExpectedCellValue(sheetName, 36, 30, null),
					new ExpectedCellValue(sheetName, 37, 30, null),
					new ExpectedCellValue(sheetName, 38, 30, null),
					new ExpectedCellValue(sheetName, 39, 30, null),
					new ExpectedCellValue(sheetName, 40, 30, "20100083 Total"),
					new ExpectedCellValue(sheetName, 41, 30, 20100085),
					new ExpectedCellValue(sheetName, 42, 30, null),
					new ExpectedCellValue(sheetName, 43, 30, null),
					new ExpectedCellValue(sheetName, 44, 30, null),
					new ExpectedCellValue(sheetName, 45, 30, null),
					new ExpectedCellValue(sheetName, 46, 30, "20100085 Total"),
					new ExpectedCellValue(sheetName, 47, 30, 20100090),
					new ExpectedCellValue(sheetName, 48, 30, null),
					new ExpectedCellValue(sheetName, 49, 30, null),
					new ExpectedCellValue(sheetName, 50, 30, null),
					new ExpectedCellValue(sheetName, 51, 30, null),
					new ExpectedCellValue(sheetName, 52, 30, "20100090 Total"),
					new ExpectedCellValue(sheetName, 53, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 10, 31, "Location"),
					new ExpectedCellValue(sheetName, 11, 31, null),
					new ExpectedCellValue(sheetName, 12, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 13, 31, null),
					new ExpectedCellValue(sheetName, 14, 31, null),
					new ExpectedCellValue(sheetName, 15, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 16, 31, null),
					new ExpectedCellValue(sheetName, 17, 31, null),
					new ExpectedCellValue(sheetName, 18, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 19, 31, null),
					new ExpectedCellValue(sheetName, 20, 31, null),
					new ExpectedCellValue(sheetName, 21, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 22, 31, null),
					new ExpectedCellValue(sheetName, 23, 31, null),
					new ExpectedCellValue(sheetName, 24, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 25, 31, null),
					new ExpectedCellValue(sheetName, 26, 31, null),
					new ExpectedCellValue(sheetName, 27, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 28, 31, null),
					new ExpectedCellValue(sheetName, 29, 31, null),
					new ExpectedCellValue(sheetName, 30, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 31, 31, null),
					new ExpectedCellValue(sheetName, 32, 31, null),
					new ExpectedCellValue(sheetName, 33, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 34, 31, null),
					new ExpectedCellValue(sheetName, 35, 31, null),
					new ExpectedCellValue(sheetName, 36, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 37, 31, null),
					new ExpectedCellValue(sheetName, 38, 31, null),
					new ExpectedCellValue(sheetName, 39, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 40, 31, null),
					new ExpectedCellValue(sheetName, 41, 31, null),
					new ExpectedCellValue(sheetName, 42, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 43, 31, null),
					new ExpectedCellValue(sheetName, 44, 31, null),
					new ExpectedCellValue(sheetName, 45, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 46, 31, null),
					new ExpectedCellValue(sheetName, 47, 31, null),
					new ExpectedCellValue(sheetName, 48, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 31, null),
					new ExpectedCellValue(sheetName, 50, 31, null),
					new ExpectedCellValue(sheetName, 51, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 52, 31, null),
					new ExpectedCellValue(sheetName, 53, 31, null),
					new ExpectedCellValue(sheetName, 10, 32, "Month"),
					new ExpectedCellValue(sheetName, 11, 32, null),
					new ExpectedCellValue(sheetName, 12, 32, null),
					new ExpectedCellValue(sheetName, 13, 32, "January"),
					new ExpectedCellValue(sheetName, 14, 32, "January Total"),
					new ExpectedCellValue(sheetName, 15, 32, null),
					new ExpectedCellValue(sheetName, 16, 32, null),
					new ExpectedCellValue(sheetName, 17, 32, null),
					new ExpectedCellValue(sheetName, 18, 32, null),
					new ExpectedCellValue(sheetName, 19, 32, "March"),
					new ExpectedCellValue(sheetName, 20, 32, "March Total"),
					new ExpectedCellValue(sheetName, 21, 32, null),
					new ExpectedCellValue(sheetName, 22, 32, null),
					new ExpectedCellValue(sheetName, 23, 32, null),
					new ExpectedCellValue(sheetName, 24, 32, null),
					new ExpectedCellValue(sheetName, 25, 32, "February"),
					new ExpectedCellValue(sheetName, 26, 32, "February Total"),
					new ExpectedCellValue(sheetName, 27, 32, null),
					new ExpectedCellValue(sheetName, 28, 32, null),
					new ExpectedCellValue(sheetName, 29, 32, null),
					new ExpectedCellValue(sheetName, 30, 32, null),
					new ExpectedCellValue(sheetName, 31, 32, "January"),
					new ExpectedCellValue(sheetName, 32, 32, "January Total"),
					new ExpectedCellValue(sheetName, 33, 32, null),
					new ExpectedCellValue(sheetName, 34, 32, null),
					new ExpectedCellValue(sheetName, 35, 32, null),
					new ExpectedCellValue(sheetName, 36, 32, null),
					new ExpectedCellValue(sheetName, 37, 32, "March"),
					new ExpectedCellValue(sheetName, 38, 32, "March Total"),
					new ExpectedCellValue(sheetName, 39, 32, null),
					new ExpectedCellValue(sheetName, 40, 32, null),
					new ExpectedCellValue(sheetName, 41, 32, null),
					new ExpectedCellValue(sheetName, 42, 32, null),
					new ExpectedCellValue(sheetName, 43, 32, "February"),
					new ExpectedCellValue(sheetName, 44, 32, "February Total"),
					new ExpectedCellValue(sheetName, 45, 32, null),
					new ExpectedCellValue(sheetName, 46, 32, null),
					new ExpectedCellValue(sheetName, 47, 32, null),
					new ExpectedCellValue(sheetName, 48, 32, null),
					new ExpectedCellValue(sheetName, 49, 32, "January"),
					new ExpectedCellValue(sheetName, 50, 32, "January Total"),
					new ExpectedCellValue(sheetName, 51, 32, null),
					new ExpectedCellValue(sheetName, 52, 32, null),
					new ExpectedCellValue(sheetName, 53, 32, null),
					new ExpectedCellValue(sheetName, 10, 33, "Item"),
					new ExpectedCellValue(sheetName, 11, 33, null),
					new ExpectedCellValue(sheetName, 12, 33, null),
					new ExpectedCellValue(sheetName, 13, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 14, 33, null),
					new ExpectedCellValue(sheetName, 15, 33, null),
					new ExpectedCellValue(sheetName, 16, 33, null),
					new ExpectedCellValue(sheetName, 17, 33, null),
					new ExpectedCellValue(sheetName, 18, 33, null),
					new ExpectedCellValue(sheetName, 19, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 20, 33, null),
					new ExpectedCellValue(sheetName, 21, 33, null),
					new ExpectedCellValue(sheetName, 22, 33, null),
					new ExpectedCellValue(sheetName, 23, 33, null),
					new ExpectedCellValue(sheetName, 24, 33, null),
					new ExpectedCellValue(sheetName, 25, 33, "Tent"),
					new ExpectedCellValue(sheetName, 26, 33, null),
					new ExpectedCellValue(sheetName, 27, 33, null),
					new ExpectedCellValue(sheetName, 28, 33, null),
					new ExpectedCellValue(sheetName, 29, 33, null),
					new ExpectedCellValue(sheetName, 30, 33, null),
					new ExpectedCellValue(sheetName, 31, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 32, 33, null),
					new ExpectedCellValue(sheetName, 33, 33, null),
					new ExpectedCellValue(sheetName, 34, 33, null),
					new ExpectedCellValue(sheetName, 35, 33, null),
					new ExpectedCellValue(sheetName, 36, 33, null),
					new ExpectedCellValue(sheetName, 37, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 38, 33, null),
					new ExpectedCellValue(sheetName, 39, 33, null),
					new ExpectedCellValue(sheetName, 40, 33, null),
					new ExpectedCellValue(sheetName, 41, 33, null),
					new ExpectedCellValue(sheetName, 42, 33, null),
					new ExpectedCellValue(sheetName, 43, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 44, 33, null),
					new ExpectedCellValue(sheetName, 45, 33, null),
					new ExpectedCellValue(sheetName, 46, 33, null),
					new ExpectedCellValue(sheetName, 47, 33, null),
					new ExpectedCellValue(sheetName, 48, 33, null),
					new ExpectedCellValue(sheetName, 49, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 33, null),
					new ExpectedCellValue(sheetName, 51, 33, null),
					new ExpectedCellValue(sheetName, 52, 33, null),
					new ExpectedCellValue(sheetName, 53, 33, null),
					new ExpectedCellValue(sheetName, 10, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 34, null),
					new ExpectedCellValue(sheetName, 12, 34, null),
					new ExpectedCellValue(sheetName, 13, 34, 831.5),
					new ExpectedCellValue(sheetName, 14, 34, 831.5),
					new ExpectedCellValue(sheetName, 15, 34, 831.5),
					new ExpectedCellValue(sheetName, 16, 34, 831.5),
					new ExpectedCellValue(sheetName, 17, 34, null),
					new ExpectedCellValue(sheetName, 18, 34, null),
					new ExpectedCellValue(sheetName, 19, 34, 831.5),
					new ExpectedCellValue(sheetName, 20, 34, 831.5),
					new ExpectedCellValue(sheetName, 21, 34, 831.5),
					new ExpectedCellValue(sheetName, 22, 34, 831.5),
					new ExpectedCellValue(sheetName, 23, 34, null),
					new ExpectedCellValue(sheetName, 24, 34, null),
					new ExpectedCellValue(sheetName, 25, 34, 1194d),
					new ExpectedCellValue(sheetName, 26, 34, 1194d),
					new ExpectedCellValue(sheetName, 27, 34, 1194d),
					new ExpectedCellValue(sheetName, 28, 34, 1194d),
					new ExpectedCellValue(sheetName, 29, 34, null),
					new ExpectedCellValue(sheetName, 30, 34, null),
					new ExpectedCellValue(sheetName, 31, 34, 415.75),
					new ExpectedCellValue(sheetName, 32, 34, 415.75),
					new ExpectedCellValue(sheetName, 33, 34, 415.75),
					new ExpectedCellValue(sheetName, 34, 34, 415.75),
					new ExpectedCellValue(sheetName, 35, 34, null),
					new ExpectedCellValue(sheetName, 36, 34, null),
					new ExpectedCellValue(sheetName, 37, 34, 24.99),
					new ExpectedCellValue(sheetName, 38, 34, 24.99),
					new ExpectedCellValue(sheetName, 39, 34, 24.99),
					new ExpectedCellValue(sheetName, 40, 34, 24.99),
					new ExpectedCellValue(sheetName, 41, 34, null),
					new ExpectedCellValue(sheetName, 42, 34, null),
					new ExpectedCellValue(sheetName, 43, 34, 99d),
					new ExpectedCellValue(sheetName, 44, 34, 99d),
					new ExpectedCellValue(sheetName, 45, 34, 99d),
					new ExpectedCellValue(sheetName, 46, 34, 99d),
					new ExpectedCellValue(sheetName, 47, 34, null),
					new ExpectedCellValue(sheetName, 48, 34, null),
					new ExpectedCellValue(sheetName, 49, 34, 831.5),
					new ExpectedCellValue(sheetName, 50, 34, 831.5),
					new ExpectedCellValue(sheetName, 51, 34, 831.5),
					new ExpectedCellValue(sheetName, 52, 34, 831.5),
					new ExpectedCellValue(sheetName, 53, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstThirdAndLastFieldsTabularSecondFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P70:T92"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 16, 20100007),
					new ExpectedCellValue(sheetName, 72, 16, null),
					new ExpectedCellValue(sheetName, 73, 16, null),
					new ExpectedCellValue(sheetName, 74, 16, 20100017),
					new ExpectedCellValue(sheetName, 75, 16, null),
					new ExpectedCellValue(sheetName, 76, 16, null),
					new ExpectedCellValue(sheetName, 77, 16, 20100070),
					new ExpectedCellValue(sheetName, 78, 16, null),
					new ExpectedCellValue(sheetName, 79, 16, null),
					new ExpectedCellValue(sheetName, 80, 16, 20100076),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, null),
					new ExpectedCellValue(sheetName, 83, 16, 20100083),
					new ExpectedCellValue(sheetName, 84, 16, null),
					new ExpectedCellValue(sheetName, 85, 16, null),
					new ExpectedCellValue(sheetName, 86, 16, 20100085),
					new ExpectedCellValue(sheetName, 87, 16, null),
					new ExpectedCellValue(sheetName, 88, 16, null),
					new ExpectedCellValue(sheetName, 89, 16, 20100090),
					new ExpectedCellValue(sheetName, 90, 16, null),
					new ExpectedCellValue(sheetName, 91, 16, null),
					new ExpectedCellValue(sheetName, 92, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 17, "Location"),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 17, null),
					new ExpectedCellValue(sheetName, 74, 17, null),
					new ExpectedCellValue(sheetName, 75, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 76, 17, null),
					new ExpectedCellValue(sheetName, 77, 17, null),
					new ExpectedCellValue(sheetName, 78, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 17, null),
					new ExpectedCellValue(sheetName, 80, 17, null),
					new ExpectedCellValue(sheetName, 81, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 82, 17, null),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 85, 17, null),
					new ExpectedCellValue(sheetName, 86, 17, null),
					new ExpectedCellValue(sheetName, 87, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 88, 17, null),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 91, 17, null),
					new ExpectedCellValue(sheetName, 92, 17, null),
					new ExpectedCellValue(sheetName, 70, 18, "Month"),
					new ExpectedCellValue(sheetName, 71, 18, null),
					new ExpectedCellValue(sheetName, 72, 18, "January"),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, null),
					new ExpectedCellValue(sheetName, 75, 18, "March"),
					new ExpectedCellValue(sheetName, 76, 18, null),
					new ExpectedCellValue(sheetName, 77, 18, null),
					new ExpectedCellValue(sheetName, 78, 18, "February"),
					new ExpectedCellValue(sheetName, 79, 18, null),
					new ExpectedCellValue(sheetName, 80, 18, null),
					new ExpectedCellValue(sheetName, 81, 18, "January"),
					new ExpectedCellValue(sheetName, 82, 18, null),
					new ExpectedCellValue(sheetName, 83, 18, null),
					new ExpectedCellValue(sheetName, 84, 18, "March"),
					new ExpectedCellValue(sheetName, 85, 18, null),
					new ExpectedCellValue(sheetName, 86, 18, null),
					new ExpectedCellValue(sheetName, 87, 18, "February"),
					new ExpectedCellValue(sheetName, 88, 18, null),
					new ExpectedCellValue(sheetName, 89, 18, null),
					new ExpectedCellValue(sheetName, 90, 18, "January"),
					new ExpectedCellValue(sheetName, 91, 18, null),
					new ExpectedCellValue(sheetName, 92, 18, null),
					new ExpectedCellValue(sheetName, 70, 19, "Item"),
					new ExpectedCellValue(sheetName, 71, 19, null),
					new ExpectedCellValue(sheetName, 72, 19, null),
					new ExpectedCellValue(sheetName, 73, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 19, null),
					new ExpectedCellValue(sheetName, 75, 19, null),
					new ExpectedCellValue(sheetName, 76, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 19, null),
					new ExpectedCellValue(sheetName, 78, 19, null),
					new ExpectedCellValue(sheetName, 79, 19, "Tent"),
					new ExpectedCellValue(sheetName, 80, 19, null),
					new ExpectedCellValue(sheetName, 81, 19, null),
					new ExpectedCellValue(sheetName, 82, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 83, 19, null),
					new ExpectedCellValue(sheetName, 84, 19, null),
					new ExpectedCellValue(sheetName, 85, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 86, 19, null),
					new ExpectedCellValue(sheetName, 87, 19, null),
					new ExpectedCellValue(sheetName, 88, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 89, 19, null),
					new ExpectedCellValue(sheetName, 90, 19, null),
					new ExpectedCellValue(sheetName, 91, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 92, 19, null),
					new ExpectedCellValue(sheetName, 70, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 20, null),
					new ExpectedCellValue(sheetName, 72, 20, null),
					new ExpectedCellValue(sheetName, 73, 20, 831.5),
					new ExpectedCellValue(sheetName, 74, 20, null),
					new ExpectedCellValue(sheetName, 75, 20, null),
					new ExpectedCellValue(sheetName, 76, 20, 831.5),
					new ExpectedCellValue(sheetName, 77, 20, null),
					new ExpectedCellValue(sheetName, 78, 20, null),
					new ExpectedCellValue(sheetName, 79, 20, 1194d),
					new ExpectedCellValue(sheetName, 80, 20, null),
					new ExpectedCellValue(sheetName, 81, 20, null),
					new ExpectedCellValue(sheetName, 82, 20, 415.75),
					new ExpectedCellValue(sheetName, 83, 20, null),
					new ExpectedCellValue(sheetName, 84, 20, null),
					new ExpectedCellValue(sheetName, 85, 20, 24.99),
					new ExpectedCellValue(sheetName, 86, 20, null),
					new ExpectedCellValue(sheetName, 87, 20, null),
					new ExpectedCellValue(sheetName, 88, 20, 99d),
					new ExpectedCellValue(sheetName, 89, 20, null),
					new ExpectedCellValue(sheetName, 90, 20, null),
					new ExpectedCellValue(sheetName, 91, 20, 831.5),
					new ExpectedCellValue(sheetName, 92, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstThirdAndLastFieldsTabularSecondFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P70:T99"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 16, 20100007),
					new ExpectedCellValue(sheetName, 72, 16, null),
					new ExpectedCellValue(sheetName, 73, 16, null),
					new ExpectedCellValue(sheetName, 74, 16, null),
					new ExpectedCellValue(sheetName, 75, 16, 20100017),
					new ExpectedCellValue(sheetName, 76, 16, null),
					new ExpectedCellValue(sheetName, 77, 16, null),
					new ExpectedCellValue(sheetName, 78, 16, null),
					new ExpectedCellValue(sheetName, 79, 16, 20100070),
					new ExpectedCellValue(sheetName, 80, 16, null),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, null),
					new ExpectedCellValue(sheetName, 83, 16, 20100076),
					new ExpectedCellValue(sheetName, 84, 16, null),
					new ExpectedCellValue(sheetName, 85, 16, null),
					new ExpectedCellValue(sheetName, 86, 16, null),
					new ExpectedCellValue(sheetName, 87, 16, 20100083),
					new ExpectedCellValue(sheetName, 88, 16, null),
					new ExpectedCellValue(sheetName, 89, 16, null),
					new ExpectedCellValue(sheetName, 90, 16, null),
					new ExpectedCellValue(sheetName, 91, 16, 20100085),
					new ExpectedCellValue(sheetName, 92, 16, null),
					new ExpectedCellValue(sheetName, 93, 16, null),
					new ExpectedCellValue(sheetName, 94, 16, null),
					new ExpectedCellValue(sheetName, 95, 16, 20100090),
					new ExpectedCellValue(sheetName, 96, 16, null),
					new ExpectedCellValue(sheetName, 97, 16, null),
					new ExpectedCellValue(sheetName, 98, 16, null),
					new ExpectedCellValue(sheetName, 99, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 17, "Location"),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 17, null),
					new ExpectedCellValue(sheetName, 74, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 75, 17, null),
					new ExpectedCellValue(sheetName, 76, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 17, null),
					new ExpectedCellValue(sheetName, 78, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 79, 17, null),
					new ExpectedCellValue(sheetName, 80, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 81, 17, null),
					new ExpectedCellValue(sheetName, 82, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 85, 17, null),
					new ExpectedCellValue(sheetName, 86, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 87, 17, null),
					new ExpectedCellValue(sheetName, 88, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 91, 17, null),
					new ExpectedCellValue(sheetName, 92, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 93, 17, null),
					new ExpectedCellValue(sheetName, 94, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 95, 17, null),
					new ExpectedCellValue(sheetName, 96, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 97, 17, null),
					new ExpectedCellValue(sheetName, 98, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 99, 17, null),
					new ExpectedCellValue(sheetName, 70, 18, "Month"),
					new ExpectedCellValue(sheetName, 71, 18, null),
					new ExpectedCellValue(sheetName, 72, 18, "January"),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, null),
					new ExpectedCellValue(sheetName, 75, 18, null),
					new ExpectedCellValue(sheetName, 76, 18, "March"),
					new ExpectedCellValue(sheetName, 77, 18, null),
					new ExpectedCellValue(sheetName, 78, 18, null),
					new ExpectedCellValue(sheetName, 79, 18, null),
					new ExpectedCellValue(sheetName, 80, 18, "February"),
					new ExpectedCellValue(sheetName, 81, 18, null),
					new ExpectedCellValue(sheetName, 82, 18, null),
					new ExpectedCellValue(sheetName, 83, 18, null),
					new ExpectedCellValue(sheetName, 84, 18, "January"),
					new ExpectedCellValue(sheetName, 85, 18, null),
					new ExpectedCellValue(sheetName, 86, 18, null),
					new ExpectedCellValue(sheetName, 87, 18, null),
					new ExpectedCellValue(sheetName, 88, 18, "March"),
					new ExpectedCellValue(sheetName, 89, 18, null),
					new ExpectedCellValue(sheetName, 90, 18, null),
					new ExpectedCellValue(sheetName, 91, 18, null),
					new ExpectedCellValue(sheetName, 92, 18, "February"),
					new ExpectedCellValue(sheetName, 93, 18, null),
					new ExpectedCellValue(sheetName, 94, 18, null),
					new ExpectedCellValue(sheetName, 95, 18, null),
					new ExpectedCellValue(sheetName, 96, 18, "January"),
					new ExpectedCellValue(sheetName, 97, 18, null),
					new ExpectedCellValue(sheetName, 98, 18, null),
					new ExpectedCellValue(sheetName, 99, 18, null),
					new ExpectedCellValue(sheetName, 70, 19, "Item"),
					new ExpectedCellValue(sheetName, 71, 19, null),
					new ExpectedCellValue(sheetName, 72, 19, null),
					new ExpectedCellValue(sheetName, 73, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 19, null),
					new ExpectedCellValue(sheetName, 75, 19, null),
					new ExpectedCellValue(sheetName, 76, 19, null),
					new ExpectedCellValue(sheetName, 77, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 78, 19, null),
					new ExpectedCellValue(sheetName, 79, 19, null),
					new ExpectedCellValue(sheetName, 80, 19, null),
					new ExpectedCellValue(sheetName, 81, 19, "Tent"),
					new ExpectedCellValue(sheetName, 82, 19, null),
					new ExpectedCellValue(sheetName, 83, 19, null),
					new ExpectedCellValue(sheetName, 84, 19, null),
					new ExpectedCellValue(sheetName, 85, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 19, null),
					new ExpectedCellValue(sheetName, 87, 19, null),
					new ExpectedCellValue(sheetName, 88, 19, null),
					new ExpectedCellValue(sheetName, 89, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 90, 19, null),
					new ExpectedCellValue(sheetName, 91, 19, null),
					new ExpectedCellValue(sheetName, 92, 19, null),
					new ExpectedCellValue(sheetName, 93, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 94, 19, null),
					new ExpectedCellValue(sheetName, 95, 19, null),
					new ExpectedCellValue(sheetName, 96, 19, null),
					new ExpectedCellValue(sheetName, 97, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 98, 19, null),
					new ExpectedCellValue(sheetName, 99, 19, null),
					new ExpectedCellValue(sheetName, 70, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 20, 831.5),
					new ExpectedCellValue(sheetName, 72, 20, 831.5),
					new ExpectedCellValue(sheetName, 73, 20, 831.5),
					new ExpectedCellValue(sheetName, 74, 20, 831.5),
					new ExpectedCellValue(sheetName, 75, 20, 831.5),
					new ExpectedCellValue(sheetName, 76, 20, 831.5),
					new ExpectedCellValue(sheetName, 77, 20, 831.5),
					new ExpectedCellValue(sheetName, 78, 20, 831.5),
					new ExpectedCellValue(sheetName, 79, 20, 1194d),
					new ExpectedCellValue(sheetName, 80, 20, 1194d),
					new ExpectedCellValue(sheetName, 81, 20, 1194d),
					new ExpectedCellValue(sheetName, 82, 20, 1194d),
					new ExpectedCellValue(sheetName, 83, 20, 415.75),
					new ExpectedCellValue(sheetName, 84, 20, 415.75),
					new ExpectedCellValue(sheetName, 85, 20, 415.75),
					new ExpectedCellValue(sheetName, 86, 20, 415.75),
					new ExpectedCellValue(sheetName, 87, 20, 24.99),
					new ExpectedCellValue(sheetName, 88, 20, 24.99),
					new ExpectedCellValue(sheetName, 89, 20, 24.99),
					new ExpectedCellValue(sheetName, 90, 20, 24.99),
					new ExpectedCellValue(sheetName, 91, 20, 99d),
					new ExpectedCellValue(sheetName, 92, 20, 99d),
					new ExpectedCellValue(sheetName, 93, 20, 99d),
					new ExpectedCellValue(sheetName, 94, 20, 99d),
					new ExpectedCellValue(sheetName, 95, 20, 831.5),
					new ExpectedCellValue(sheetName, 96, 20, 831.5),
					new ExpectedCellValue(sheetName, 97, 20, 831.5),
					new ExpectedCellValue(sheetName, 98, 20, 831.5),
					new ExpectedCellValue(sheetName, 99, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstThirdAndLastFieldsTabularSecondFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P70:T113"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 16, 20100007),
					new ExpectedCellValue(sheetName, 72, 16, null),
					new ExpectedCellValue(sheetName, 73, 16, null),
					new ExpectedCellValue(sheetName, 74, 16, null),
					new ExpectedCellValue(sheetName, 75, 16, null),
					new ExpectedCellValue(sheetName, 76, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 77, 16, 20100017),
					new ExpectedCellValue(sheetName, 78, 16, null),
					new ExpectedCellValue(sheetName, 79, 16, null),
					new ExpectedCellValue(sheetName, 80, 16, null),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 83, 16, 20100070),
					new ExpectedCellValue(sheetName, 84, 16, null),
					new ExpectedCellValue(sheetName, 85, 16, null),
					new ExpectedCellValue(sheetName, 86, 16, null),
					new ExpectedCellValue(sheetName, 87, 16, null),
					new ExpectedCellValue(sheetName, 88, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 89, 16, 20100076),
					new ExpectedCellValue(sheetName, 90, 16, null),
					new ExpectedCellValue(sheetName, 91, 16, null),
					new ExpectedCellValue(sheetName, 92, 16, null),
					new ExpectedCellValue(sheetName, 93, 16, null),
					new ExpectedCellValue(sheetName, 94, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 95, 16, 20100083),
					new ExpectedCellValue(sheetName, 96, 16, null),
					new ExpectedCellValue(sheetName, 97, 16, null),
					new ExpectedCellValue(sheetName, 98, 16, null),
					new ExpectedCellValue(sheetName, 99, 16, null),
					new ExpectedCellValue(sheetName, 100, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 101, 16, 20100085),
					new ExpectedCellValue(sheetName, 102, 16, null),
					new ExpectedCellValue(sheetName, 103, 16, null),
					new ExpectedCellValue(sheetName, 104, 16, null),
					new ExpectedCellValue(sheetName, 105, 16, null),
					new ExpectedCellValue(sheetName, 106, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 107, 16, 20100090),
					new ExpectedCellValue(sheetName, 108, 16, null),
					new ExpectedCellValue(sheetName, 109, 16, null),
					new ExpectedCellValue(sheetName, 110, 16, null),
					new ExpectedCellValue(sheetName, 111, 16, null),
					new ExpectedCellValue(sheetName, 112, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 113, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 17, "Location"),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 17, null),
					new ExpectedCellValue(sheetName, 74, 17, null),
					new ExpectedCellValue(sheetName, 75, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 76, 17, null),
					new ExpectedCellValue(sheetName, 77, 17, null),
					new ExpectedCellValue(sheetName, 78, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 17, null),
					new ExpectedCellValue(sheetName, 80, 17, null),
					new ExpectedCellValue(sheetName, 81, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 82, 17, null),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 85, 17, null),
					new ExpectedCellValue(sheetName, 86, 17, null),
					new ExpectedCellValue(sheetName, 87, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 88, 17, null),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 91, 17, null),
					new ExpectedCellValue(sheetName, 92, 17, null),
					new ExpectedCellValue(sheetName, 93, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 94, 17, null),
					new ExpectedCellValue(sheetName, 95, 17, null),
					new ExpectedCellValue(sheetName, 96, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 97, 17, null),
					new ExpectedCellValue(sheetName, 98, 17, null),
					new ExpectedCellValue(sheetName, 99, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 100, 17, null),
					new ExpectedCellValue(sheetName, 101, 17, null),
					new ExpectedCellValue(sheetName, 102, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 103, 17, null),
					new ExpectedCellValue(sheetName, 104, 17, null),
					new ExpectedCellValue(sheetName, 105, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 106, 17, null),
					new ExpectedCellValue(sheetName, 107, 17, null),
					new ExpectedCellValue(sheetName, 108, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 109, 17, null),
					new ExpectedCellValue(sheetName, 110, 17, null),
					new ExpectedCellValue(sheetName, 111, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 112, 17, null),
					new ExpectedCellValue(sheetName, 113, 17, null),
					new ExpectedCellValue(sheetName, 70, 18, "Month"),
					new ExpectedCellValue(sheetName, 71, 18, null),
					new ExpectedCellValue(sheetName, 72, 18, "January"),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, "January Total"),
					new ExpectedCellValue(sheetName, 75, 18, null),
					new ExpectedCellValue(sheetName, 76, 18, null),
					new ExpectedCellValue(sheetName, 77, 18, null),
					new ExpectedCellValue(sheetName, 78, 18, "March"),
					new ExpectedCellValue(sheetName, 79, 18, null),
					new ExpectedCellValue(sheetName, 80, 18, "March Total"),
					new ExpectedCellValue(sheetName, 81, 18, null),
					new ExpectedCellValue(sheetName, 82, 18, null),
					new ExpectedCellValue(sheetName, 83, 18, null),
					new ExpectedCellValue(sheetName, 84, 18, "February"),
					new ExpectedCellValue(sheetName, 85, 18, null),
					new ExpectedCellValue(sheetName, 86, 18, "February Total"),
					new ExpectedCellValue(sheetName, 87, 18, null),
					new ExpectedCellValue(sheetName, 88, 18, null),
					new ExpectedCellValue(sheetName, 89, 18, null),
					new ExpectedCellValue(sheetName, 90, 18, "January"),
					new ExpectedCellValue(sheetName, 91, 18, null),
					new ExpectedCellValue(sheetName, 92, 18, "January Total"),
					new ExpectedCellValue(sheetName, 93, 18, null),
					new ExpectedCellValue(sheetName, 94, 18, null),
					new ExpectedCellValue(sheetName, 95, 18, null),
					new ExpectedCellValue(sheetName, 96, 18, "March"),
					new ExpectedCellValue(sheetName, 97, 18, null),
					new ExpectedCellValue(sheetName, 98, 18, "March Total"),
					new ExpectedCellValue(sheetName, 99, 18, null),
					new ExpectedCellValue(sheetName, 100, 18, null),
					new ExpectedCellValue(sheetName, 101, 18, null),
					new ExpectedCellValue(sheetName, 102, 18, "February"),
					new ExpectedCellValue(sheetName, 103, 18, null),
					new ExpectedCellValue(sheetName, 104, 18, "February Total"),
					new ExpectedCellValue(sheetName, 105, 18, null),
					new ExpectedCellValue(sheetName, 106, 18, null),
					new ExpectedCellValue(sheetName, 107, 18, null),
					new ExpectedCellValue(sheetName, 108, 18, "January"),
					new ExpectedCellValue(sheetName, 109, 18, null),
					new ExpectedCellValue(sheetName, 110, 18, "January Total"),
					new ExpectedCellValue(sheetName, 111, 18, null),
					new ExpectedCellValue(sheetName, 112, 18, null),
					new ExpectedCellValue(sheetName, 113, 18, null),
					new ExpectedCellValue(sheetName, 70, 19, "Item"),
					new ExpectedCellValue(sheetName, 71, 19, null),
					new ExpectedCellValue(sheetName, 72, 19, null),
					new ExpectedCellValue(sheetName, 73, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 19, null),
					new ExpectedCellValue(sheetName, 75, 19, null),
					new ExpectedCellValue(sheetName, 76, 19, null),
					new ExpectedCellValue(sheetName, 77, 19, null),
					new ExpectedCellValue(sheetName, 78, 19, null),
					new ExpectedCellValue(sheetName, 79, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 80, 19, null),
					new ExpectedCellValue(sheetName, 81, 19, null),
					new ExpectedCellValue(sheetName, 82, 19, null),
					new ExpectedCellValue(sheetName, 83, 19, null),
					new ExpectedCellValue(sheetName, 84, 19, null),
					new ExpectedCellValue(sheetName, 85, 19, "Tent"),
					new ExpectedCellValue(sheetName, 86, 19, null),
					new ExpectedCellValue(sheetName, 87, 19, null),
					new ExpectedCellValue(sheetName, 88, 19, null),
					new ExpectedCellValue(sheetName, 89, 19, null),
					new ExpectedCellValue(sheetName, 90, 19, null),
					new ExpectedCellValue(sheetName, 91, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 92, 19, null),
					new ExpectedCellValue(sheetName, 93, 19, null),
					new ExpectedCellValue(sheetName, 94, 19, null),
					new ExpectedCellValue(sheetName, 95, 19, null),
					new ExpectedCellValue(sheetName, 96, 19, null),
					new ExpectedCellValue(sheetName, 97, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 98, 19, null),
					new ExpectedCellValue(sheetName, 99, 19, null),
					new ExpectedCellValue(sheetName, 100, 19, null),
					new ExpectedCellValue(sheetName, 101, 19, null),
					new ExpectedCellValue(sheetName, 102, 19, null),
					new ExpectedCellValue(sheetName, 103, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 104, 19, null),
					new ExpectedCellValue(sheetName, 105, 19, null),
					new ExpectedCellValue(sheetName, 106, 19, null),
					new ExpectedCellValue(sheetName, 107, 19, null),
					new ExpectedCellValue(sheetName, 108, 19, null),
					new ExpectedCellValue(sheetName, 109, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 110, 19, null),
					new ExpectedCellValue(sheetName, 111, 19, null),
					new ExpectedCellValue(sheetName, 112, 19, null),
					new ExpectedCellValue(sheetName, 113, 19, null),
					new ExpectedCellValue(sheetName, 70, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 20, null),
					new ExpectedCellValue(sheetName, 72, 20, null),
					new ExpectedCellValue(sheetName, 73, 20, 831.5),
					new ExpectedCellValue(sheetName, 74, 20, 831.5),
					new ExpectedCellValue(sheetName, 75, 20, 831.5),
					new ExpectedCellValue(sheetName, 76, 20, 831.5),
					new ExpectedCellValue(sheetName, 77, 20, null),
					new ExpectedCellValue(sheetName, 78, 20, null),
					new ExpectedCellValue(sheetName, 79, 20, 831.5),
					new ExpectedCellValue(sheetName, 80, 20, 831.5),
					new ExpectedCellValue(sheetName, 81, 20, 831.5),
					new ExpectedCellValue(sheetName, 82, 20, 831.5),
					new ExpectedCellValue(sheetName, 83, 20, null),
					new ExpectedCellValue(sheetName, 84, 20, null),
					new ExpectedCellValue(sheetName, 85, 20, 1194d),
					new ExpectedCellValue(sheetName, 86, 20, 1194d),
					new ExpectedCellValue(sheetName, 87, 20, 1194d),
					new ExpectedCellValue(sheetName, 88, 20, 1194d),
					new ExpectedCellValue(sheetName, 89, 20, null),
					new ExpectedCellValue(sheetName, 90, 20, null),
					new ExpectedCellValue(sheetName, 91, 20, 415.75),
					new ExpectedCellValue(sheetName, 92, 20, 415.75),
					new ExpectedCellValue(sheetName, 93, 20, 415.75),
					new ExpectedCellValue(sheetName, 94, 20, 415.75),
					new ExpectedCellValue(sheetName, 95, 20, null),
					new ExpectedCellValue(sheetName, 96, 20, null),
					new ExpectedCellValue(sheetName, 97, 20, 24.99),
					new ExpectedCellValue(sheetName, 98, 20, 24.99),
					new ExpectedCellValue(sheetName, 99, 20, 24.99),
					new ExpectedCellValue(sheetName, 100, 20, 24.99),
					new ExpectedCellValue(sheetName, 101, 20, null),
					new ExpectedCellValue(sheetName, 102, 20, null),
					new ExpectedCellValue(sheetName, 103, 20, 99d),
					new ExpectedCellValue(sheetName, 104, 20, 99d),
					new ExpectedCellValue(sheetName, 105, 20, 99d),
					new ExpectedCellValue(sheetName, 106, 20, 99d),
					new ExpectedCellValue(sheetName, 107, 20, null),
					new ExpectedCellValue(sheetName, 108, 20, null),
					new ExpectedCellValue(sheetName, 109, 20, 831.5),
					new ExpectedCellValue(sheetName, 110, 20, 831.5),
					new ExpectedCellValue(sheetName, 111, 20, 831.5),
					new ExpectedCellValue(sheetName, 112, 20, 831.5),
					new ExpectedCellValue(sheetName, 113, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndThirdFieldsTabularSecondAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W70:AA92"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 23, 20100007),
					new ExpectedCellValue(sheetName, 72, 23, null),
					new ExpectedCellValue(sheetName, 73, 23, null),
					new ExpectedCellValue(sheetName, 74, 23, 20100017),
					new ExpectedCellValue(sheetName, 75, 23, null),
					new ExpectedCellValue(sheetName, 76, 23, null),
					new ExpectedCellValue(sheetName, 77, 23, 20100070),
					new ExpectedCellValue(sheetName, 78, 23, null),
					new ExpectedCellValue(sheetName, 79, 23, null),
					new ExpectedCellValue(sheetName, 80, 23, 20100076),
					new ExpectedCellValue(sheetName, 81, 23, null),
					new ExpectedCellValue(sheetName, 82, 23, null),
					new ExpectedCellValue(sheetName, 83, 23, 20100083),
					new ExpectedCellValue(sheetName, 84, 23, null),
					new ExpectedCellValue(sheetName, 85, 23, null),
					new ExpectedCellValue(sheetName, 86, 23, 20100085),
					new ExpectedCellValue(sheetName, 87, 23, null),
					new ExpectedCellValue(sheetName, 88, 23, null),
					new ExpectedCellValue(sheetName, 89, 23, 20100090),
					new ExpectedCellValue(sheetName, 90, 23, null),
					new ExpectedCellValue(sheetName, 91, 23, null),
					new ExpectedCellValue(sheetName, 92, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 24, "Location"),
					new ExpectedCellValue(sheetName, 71, 24, null),
					new ExpectedCellValue(sheetName, 72, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 24, null),
					new ExpectedCellValue(sheetName, 74, 24, null),
					new ExpectedCellValue(sheetName, 75, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 76, 24, null),
					new ExpectedCellValue(sheetName, 77, 24, null),
					new ExpectedCellValue(sheetName, 78, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 24, null),
					new ExpectedCellValue(sheetName, 80, 24, null),
					new ExpectedCellValue(sheetName, 81, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 82, 24, null),
					new ExpectedCellValue(sheetName, 83, 24, null),
					new ExpectedCellValue(sheetName, 84, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 85, 24, null),
					new ExpectedCellValue(sheetName, 86, 24, null),
					new ExpectedCellValue(sheetName, 87, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 88, 24, null),
					new ExpectedCellValue(sheetName, 89, 24, null),
					new ExpectedCellValue(sheetName, 90, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 91, 24, null),
					new ExpectedCellValue(sheetName, 92, 24, null),
					new ExpectedCellValue(sheetName, 70, 25, "Month"),
					new ExpectedCellValue(sheetName, 71, 25, null),
					new ExpectedCellValue(sheetName, 72, 25, "January"),
					new ExpectedCellValue(sheetName, 73, 25, null),
					new ExpectedCellValue(sheetName, 74, 25, null),
					new ExpectedCellValue(sheetName, 75, 25, "March"),
					new ExpectedCellValue(sheetName, 76, 25, null),
					new ExpectedCellValue(sheetName, 77, 25, null),
					new ExpectedCellValue(sheetName, 78, 25, "February"),
					new ExpectedCellValue(sheetName, 79, 25, null),
					new ExpectedCellValue(sheetName, 80, 25, null),
					new ExpectedCellValue(sheetName, 81, 25, "January"),
					new ExpectedCellValue(sheetName, 82, 25, null),
					new ExpectedCellValue(sheetName, 83, 25, null),
					new ExpectedCellValue(sheetName, 84, 25, "March"),
					new ExpectedCellValue(sheetName, 85, 25, null),
					new ExpectedCellValue(sheetName, 86, 25, null),
					new ExpectedCellValue(sheetName, 87, 25, "February"),
					new ExpectedCellValue(sheetName, 88, 25, null),
					new ExpectedCellValue(sheetName, 89, 25, null),
					new ExpectedCellValue(sheetName, 90, 25, "January"),
					new ExpectedCellValue(sheetName, 91, 25, null),
					new ExpectedCellValue(sheetName, 92, 25, null),
					new ExpectedCellValue(sheetName, 70, 26, "Item"),
					new ExpectedCellValue(sheetName, 71, 26, null),
					new ExpectedCellValue(sheetName, 72, 26, null),
					new ExpectedCellValue(sheetName, 73, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 26, null),
					new ExpectedCellValue(sheetName, 75, 26, null),
					new ExpectedCellValue(sheetName, 76, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 26, null),
					new ExpectedCellValue(sheetName, 78, 26, null),
					new ExpectedCellValue(sheetName, 79, 26, "Tent"),
					new ExpectedCellValue(sheetName, 80, 26, null),
					new ExpectedCellValue(sheetName, 81, 26, null),
					new ExpectedCellValue(sheetName, 82, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 83, 26, null),
					new ExpectedCellValue(sheetName, 84, 26, null),
					new ExpectedCellValue(sheetName, 85, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 86, 26, null),
					new ExpectedCellValue(sheetName, 87, 26, null),
					new ExpectedCellValue(sheetName, 88, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 89, 26, null),
					new ExpectedCellValue(sheetName, 90, 26, null),
					new ExpectedCellValue(sheetName, 91, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 92, 26, null),
					new ExpectedCellValue(sheetName, 70, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 27, null),
					new ExpectedCellValue(sheetName, 72, 27, null),
					new ExpectedCellValue(sheetName, 73, 27, 831.5),
					new ExpectedCellValue(sheetName, 74, 27, null),
					new ExpectedCellValue(sheetName, 75, 27, null),
					new ExpectedCellValue(sheetName, 76, 27, 831.5),
					new ExpectedCellValue(sheetName, 77, 27, null),
					new ExpectedCellValue(sheetName, 78, 27, null),
					new ExpectedCellValue(sheetName, 79, 27, 1194d),
					new ExpectedCellValue(sheetName, 80, 27, null),
					new ExpectedCellValue(sheetName, 81, 27, null),
					new ExpectedCellValue(sheetName, 82, 27, 415.75),
					new ExpectedCellValue(sheetName, 83, 27, null),
					new ExpectedCellValue(sheetName, 84, 27, null),
					new ExpectedCellValue(sheetName, 85, 27, 24.99),
					new ExpectedCellValue(sheetName, 86, 27, null),
					new ExpectedCellValue(sheetName, 87, 27, null),
					new ExpectedCellValue(sheetName, 88, 27, 99d),
					new ExpectedCellValue(sheetName, 89, 27, null),
					new ExpectedCellValue(sheetName, 90, 27, null),
					new ExpectedCellValue(sheetName, 91, 27, 831.5),
					new ExpectedCellValue(sheetName, 92, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndThirdFieldsTabularSecondAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W70:AA99"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 23, 20100007),
					new ExpectedCellValue(sheetName, 72, 23, null),
					new ExpectedCellValue(sheetName, 73, 23, null),
					new ExpectedCellValue(sheetName, 74, 23, null),
					new ExpectedCellValue(sheetName, 75, 23, 20100017),
					new ExpectedCellValue(sheetName, 76, 23, null),
					new ExpectedCellValue(sheetName, 77, 23, null),
					new ExpectedCellValue(sheetName, 78, 23, null),
					new ExpectedCellValue(sheetName, 79, 23, 20100070),
					new ExpectedCellValue(sheetName, 80, 23, null),
					new ExpectedCellValue(sheetName, 81, 23, null),
					new ExpectedCellValue(sheetName, 82, 23, null),
					new ExpectedCellValue(sheetName, 83, 23, 20100076),
					new ExpectedCellValue(sheetName, 84, 23, null),
					new ExpectedCellValue(sheetName, 85, 23, null),
					new ExpectedCellValue(sheetName, 86, 23, null),
					new ExpectedCellValue(sheetName, 87, 23, 20100083),
					new ExpectedCellValue(sheetName, 88, 23, null),
					new ExpectedCellValue(sheetName, 89, 23, null),
					new ExpectedCellValue(sheetName, 90, 23, null),
					new ExpectedCellValue(sheetName, 91, 23, 20100085),
					new ExpectedCellValue(sheetName, 92, 23, null),
					new ExpectedCellValue(sheetName, 93, 23, null),
					new ExpectedCellValue(sheetName, 94, 23, null),
					new ExpectedCellValue(sheetName, 95, 23, 20100090),
					new ExpectedCellValue(sheetName, 96, 23, null),
					new ExpectedCellValue(sheetName, 97, 23, null),
					new ExpectedCellValue(sheetName, 98, 23, null),
					new ExpectedCellValue(sheetName, 99, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 24, "Location"),
					new ExpectedCellValue(sheetName, 71, 24, null),
					new ExpectedCellValue(sheetName, 72, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 24, null),
					new ExpectedCellValue(sheetName, 74, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 75, 24, null),
					new ExpectedCellValue(sheetName, 76, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 24, null),
					new ExpectedCellValue(sheetName, 78, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 79, 24, null),
					new ExpectedCellValue(sheetName, 80, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 81, 24, null),
					new ExpectedCellValue(sheetName, 82, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 83, 24, null),
					new ExpectedCellValue(sheetName, 84, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 85, 24, null),
					new ExpectedCellValue(sheetName, 86, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 87, 24, null),
					new ExpectedCellValue(sheetName, 88, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 89, 24, null),
					new ExpectedCellValue(sheetName, 90, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 91, 24, null),
					new ExpectedCellValue(sheetName, 92, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 93, 24, null),
					new ExpectedCellValue(sheetName, 94, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 95, 24, null),
					new ExpectedCellValue(sheetName, 96, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 97, 24, null),
					new ExpectedCellValue(sheetName, 98, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 99, 24, null),
					new ExpectedCellValue(sheetName, 70, 25, "Month"),
					new ExpectedCellValue(sheetName, 71, 25, null),
					new ExpectedCellValue(sheetName, 72, 25, "January"),
					new ExpectedCellValue(sheetName, 73, 25, null),
					new ExpectedCellValue(sheetName, 74, 25, null),
					new ExpectedCellValue(sheetName, 75, 25, null),
					new ExpectedCellValue(sheetName, 76, 25, "March"),
					new ExpectedCellValue(sheetName, 77, 25, null),
					new ExpectedCellValue(sheetName, 78, 25, null),
					new ExpectedCellValue(sheetName, 79, 25, null),
					new ExpectedCellValue(sheetName, 80, 25, "February"),
					new ExpectedCellValue(sheetName, 81, 25, null),
					new ExpectedCellValue(sheetName, 82, 25, null),
					new ExpectedCellValue(sheetName, 83, 25, null),
					new ExpectedCellValue(sheetName, 84, 25, "January"),
					new ExpectedCellValue(sheetName, 85, 25, null),
					new ExpectedCellValue(sheetName, 86, 25, null),
					new ExpectedCellValue(sheetName, 87, 25, null),
					new ExpectedCellValue(sheetName, 88, 25, "March"),
					new ExpectedCellValue(sheetName, 89, 25, null),
					new ExpectedCellValue(sheetName, 90, 25, null),
					new ExpectedCellValue(sheetName, 91, 25, null),
					new ExpectedCellValue(sheetName, 92, 25, "February"),
					new ExpectedCellValue(sheetName, 93, 25, null),
					new ExpectedCellValue(sheetName, 94, 25, null),
					new ExpectedCellValue(sheetName, 95, 25, null),
					new ExpectedCellValue(sheetName, 96, 25, "January"),
					new ExpectedCellValue(sheetName, 97, 25, null),
					new ExpectedCellValue(sheetName, 98, 25, null),
					new ExpectedCellValue(sheetName, 99, 25, null),
					new ExpectedCellValue(sheetName, 70, 26, "Item"),
					new ExpectedCellValue(sheetName, 71, 26, null),
					new ExpectedCellValue(sheetName, 72, 26, null),
					new ExpectedCellValue(sheetName, 73, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 26, null),
					new ExpectedCellValue(sheetName, 75, 26, null),
					new ExpectedCellValue(sheetName, 76, 26, null),
					new ExpectedCellValue(sheetName, 77, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 78, 26, null),
					new ExpectedCellValue(sheetName, 79, 26, null),
					new ExpectedCellValue(sheetName, 80, 26, null),
					new ExpectedCellValue(sheetName, 81, 26, "Tent"),
					new ExpectedCellValue(sheetName, 82, 26, null),
					new ExpectedCellValue(sheetName, 83, 26, null),
					new ExpectedCellValue(sheetName, 84, 26, null),
					new ExpectedCellValue(sheetName, 85, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 26, null),
					new ExpectedCellValue(sheetName, 87, 26, null),
					new ExpectedCellValue(sheetName, 88, 26, null),
					new ExpectedCellValue(sheetName, 89, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 90, 26, null),
					new ExpectedCellValue(sheetName, 91, 26, null),
					new ExpectedCellValue(sheetName, 92, 26, null),
					new ExpectedCellValue(sheetName, 93, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 94, 26, null),
					new ExpectedCellValue(sheetName, 95, 26, null),
					new ExpectedCellValue(sheetName, 96, 26, null),
					new ExpectedCellValue(sheetName, 97, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 98, 26, null),
					new ExpectedCellValue(sheetName, 99, 26, null),
					new ExpectedCellValue(sheetName, 70, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 27, 831.5),
					new ExpectedCellValue(sheetName, 72, 27, 831.5),
					new ExpectedCellValue(sheetName, 73, 27, 831.5),
					new ExpectedCellValue(sheetName, 74, 27, 831.5),
					new ExpectedCellValue(sheetName, 75, 27, 831.5),
					new ExpectedCellValue(sheetName, 76, 27, 831.5),
					new ExpectedCellValue(sheetName, 77, 27, 831.5),
					new ExpectedCellValue(sheetName, 78, 27, 831.5),
					new ExpectedCellValue(sheetName, 79, 27, 1194d),
					new ExpectedCellValue(sheetName, 80, 27, 1194d),
					new ExpectedCellValue(sheetName, 81, 27, 1194d),
					new ExpectedCellValue(sheetName, 82, 27, 1194d),
					new ExpectedCellValue(sheetName, 83, 27, 415.75),
					new ExpectedCellValue(sheetName, 84, 27, 415.75),
					new ExpectedCellValue(sheetName, 85, 27, 415.75),
					new ExpectedCellValue(sheetName, 86, 27, 415.75),
					new ExpectedCellValue(sheetName, 87, 27, 24.99),
					new ExpectedCellValue(sheetName, 88, 27, 24.99),
					new ExpectedCellValue(sheetName, 89, 27, 24.99),
					new ExpectedCellValue(sheetName, 90, 27, 24.99),
					new ExpectedCellValue(sheetName, 91, 27, 99d),
					new ExpectedCellValue(sheetName, 92, 27, 99d),
					new ExpectedCellValue(sheetName, 93, 27, 99d),
					new ExpectedCellValue(sheetName, 94, 27, 99d),
					new ExpectedCellValue(sheetName, 95, 27, 831.5),
					new ExpectedCellValue(sheetName, 96, 27, 831.5),
					new ExpectedCellValue(sheetName, 97, 27, 831.5),
					new ExpectedCellValue(sheetName, 98, 27, 831.5),
					new ExpectedCellValue(sheetName, 99, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndThirdFieldsTabularSecondAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W70:AA113"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 23, 20100007),
					new ExpectedCellValue(sheetName, 72, 23, null),
					new ExpectedCellValue(sheetName, 73, 23, null),
					new ExpectedCellValue(sheetName, 74, 23, null),
					new ExpectedCellValue(sheetName, 75, 23, null),
					new ExpectedCellValue(sheetName, 76, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 77, 23, 20100017),
					new ExpectedCellValue(sheetName, 78, 23, null),
					new ExpectedCellValue(sheetName, 79, 23, null),
					new ExpectedCellValue(sheetName, 80, 23, null),
					new ExpectedCellValue(sheetName, 81, 23, null),
					new ExpectedCellValue(sheetName, 82, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 83, 23, 20100070),
					new ExpectedCellValue(sheetName, 84, 23, null),
					new ExpectedCellValue(sheetName, 85, 23, null),
					new ExpectedCellValue(sheetName, 86, 23, null),
					new ExpectedCellValue(sheetName, 87, 23, null),
					new ExpectedCellValue(sheetName, 88, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 89, 23, 20100076),
					new ExpectedCellValue(sheetName, 90, 23, null),
					new ExpectedCellValue(sheetName, 91, 23, null),
					new ExpectedCellValue(sheetName, 92, 23, null),
					new ExpectedCellValue(sheetName, 93, 23, null),
					new ExpectedCellValue(sheetName, 94, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 95, 23, 20100083),
					new ExpectedCellValue(sheetName, 96, 23, null),
					new ExpectedCellValue(sheetName, 97, 23, null),
					new ExpectedCellValue(sheetName, 98, 23, null),
					new ExpectedCellValue(sheetName, 99, 23, null),
					new ExpectedCellValue(sheetName, 100, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 101, 23, 20100085),
					new ExpectedCellValue(sheetName, 102, 23, null),
					new ExpectedCellValue(sheetName, 103, 23, null),
					new ExpectedCellValue(sheetName, 104, 23, null),
					new ExpectedCellValue(sheetName, 105, 23, null),
					new ExpectedCellValue(sheetName, 106, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 107, 23, 20100090),
					new ExpectedCellValue(sheetName, 108, 23, null),
					new ExpectedCellValue(sheetName, 109, 23, null),
					new ExpectedCellValue(sheetName, 110, 23, null),
					new ExpectedCellValue(sheetName, 111, 23, null),
					new ExpectedCellValue(sheetName, 112, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 113, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 24, "Location"),
					new ExpectedCellValue(sheetName, 71, 24, null),
					new ExpectedCellValue(sheetName, 72, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 24, null),
					new ExpectedCellValue(sheetName, 74, 24, null),
					new ExpectedCellValue(sheetName, 75, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 76, 24, null),
					new ExpectedCellValue(sheetName, 77, 24, null),
					new ExpectedCellValue(sheetName, 78, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 79, 24, null),
					new ExpectedCellValue(sheetName, 80, 24, null),
					new ExpectedCellValue(sheetName, 81, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 82, 24, null),
					new ExpectedCellValue(sheetName, 83, 24, null),
					new ExpectedCellValue(sheetName, 84, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 85, 24, null),
					new ExpectedCellValue(sheetName, 86, 24, null),
					new ExpectedCellValue(sheetName, 87, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 88, 24, null),
					new ExpectedCellValue(sheetName, 89, 24, null),
					new ExpectedCellValue(sheetName, 90, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 91, 24, null),
					new ExpectedCellValue(sheetName, 92, 24, null),
					new ExpectedCellValue(sheetName, 93, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 94, 24, null),
					new ExpectedCellValue(sheetName, 95, 24, null),
					new ExpectedCellValue(sheetName, 96, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 97, 24, null),
					new ExpectedCellValue(sheetName, 98, 24, null),
					new ExpectedCellValue(sheetName, 99, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 100, 24, null),
					new ExpectedCellValue(sheetName, 101, 24, null),
					new ExpectedCellValue(sheetName, 102, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 103, 24, null),
					new ExpectedCellValue(sheetName, 104, 24, null),
					new ExpectedCellValue(sheetName, 105, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 106, 24, null),
					new ExpectedCellValue(sheetName, 107, 24, null),
					new ExpectedCellValue(sheetName, 108, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 109, 24, null),
					new ExpectedCellValue(sheetName, 110, 24, null),
					new ExpectedCellValue(sheetName, 111, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 112, 24, null),
					new ExpectedCellValue(sheetName, 113, 24, null),
					new ExpectedCellValue(sheetName, 70, 25, "Month"),
					new ExpectedCellValue(sheetName, 71, 25, null),
					new ExpectedCellValue(sheetName, 72, 25, "January"),
					new ExpectedCellValue(sheetName, 73, 25, null),
					new ExpectedCellValue(sheetName, 74, 25, "January Total"),
					new ExpectedCellValue(sheetName, 75, 25, null),
					new ExpectedCellValue(sheetName, 76, 25, null),
					new ExpectedCellValue(sheetName, 77, 25, null),
					new ExpectedCellValue(sheetName, 78, 25, "March"),
					new ExpectedCellValue(sheetName, 79, 25, null),
					new ExpectedCellValue(sheetName, 80, 25, "March Total"),
					new ExpectedCellValue(sheetName, 81, 25, null),
					new ExpectedCellValue(sheetName, 82, 25, null),
					new ExpectedCellValue(sheetName, 83, 25, null),
					new ExpectedCellValue(sheetName, 84, 25, "February"),
					new ExpectedCellValue(sheetName, 85, 25, null),
					new ExpectedCellValue(sheetName, 86, 25, "February Total"),
					new ExpectedCellValue(sheetName, 87, 25, null),
					new ExpectedCellValue(sheetName, 88, 25, null),
					new ExpectedCellValue(sheetName, 89, 25, null),
					new ExpectedCellValue(sheetName, 90, 25, "January"),
					new ExpectedCellValue(sheetName, 91, 25, null),
					new ExpectedCellValue(sheetName, 92, 25, "January Total"),
					new ExpectedCellValue(sheetName, 93, 25, null),
					new ExpectedCellValue(sheetName, 94, 25, null),
					new ExpectedCellValue(sheetName, 95, 25, null),
					new ExpectedCellValue(sheetName, 96, 25, "March"),
					new ExpectedCellValue(sheetName, 97, 25, null),
					new ExpectedCellValue(sheetName, 98, 25, "March Total"),
					new ExpectedCellValue(sheetName, 99, 25, null),
					new ExpectedCellValue(sheetName, 100, 25, null),
					new ExpectedCellValue(sheetName, 101, 25, null),
					new ExpectedCellValue(sheetName, 102, 25, "February"),
					new ExpectedCellValue(sheetName, 103, 25, null),
					new ExpectedCellValue(sheetName, 104, 25, "February Total"),
					new ExpectedCellValue(sheetName, 105, 25, null),
					new ExpectedCellValue(sheetName, 106, 25, null),
					new ExpectedCellValue(sheetName, 107, 25, null),
					new ExpectedCellValue(sheetName, 108, 25, "January"),
					new ExpectedCellValue(sheetName, 109, 25, null),
					new ExpectedCellValue(sheetName, 110, 25, "January Total"),
					new ExpectedCellValue(sheetName, 111, 25, null),
					new ExpectedCellValue(sheetName, 112, 25, null),
					new ExpectedCellValue(sheetName, 113, 25, null),
					new ExpectedCellValue(sheetName, 70, 26, "Item"),
					new ExpectedCellValue(sheetName, 71, 26, null),
					new ExpectedCellValue(sheetName, 72, 26, null),
					new ExpectedCellValue(sheetName, 73, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 74, 26, null),
					new ExpectedCellValue(sheetName, 75, 26, null),
					new ExpectedCellValue(sheetName, 76, 26, null),
					new ExpectedCellValue(sheetName, 77, 26, null),
					new ExpectedCellValue(sheetName, 78, 26, null),
					new ExpectedCellValue(sheetName, 79, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 80, 26, null),
					new ExpectedCellValue(sheetName, 81, 26, null),
					new ExpectedCellValue(sheetName, 82, 26, null),
					new ExpectedCellValue(sheetName, 83, 26, null),
					new ExpectedCellValue(sheetName, 84, 26, null),
					new ExpectedCellValue(sheetName, 85, 26, "Tent"),
					new ExpectedCellValue(sheetName, 86, 26, null),
					new ExpectedCellValue(sheetName, 87, 26, null),
					new ExpectedCellValue(sheetName, 88, 26, null),
					new ExpectedCellValue(sheetName, 89, 26, null),
					new ExpectedCellValue(sheetName, 90, 26, null),
					new ExpectedCellValue(sheetName, 91, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 92, 26, null),
					new ExpectedCellValue(sheetName, 93, 26, null),
					new ExpectedCellValue(sheetName, 94, 26, null),
					new ExpectedCellValue(sheetName, 95, 26, null),
					new ExpectedCellValue(sheetName, 96, 26, null),
					new ExpectedCellValue(sheetName, 97, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 98, 26, null),
					new ExpectedCellValue(sheetName, 99, 26, null),
					new ExpectedCellValue(sheetName, 100, 26, null),
					new ExpectedCellValue(sheetName, 101, 26, null),
					new ExpectedCellValue(sheetName, 102, 26, null),
					new ExpectedCellValue(sheetName, 103, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 104, 26, null),
					new ExpectedCellValue(sheetName, 105, 26, null),
					new ExpectedCellValue(sheetName, 106, 26, null),
					new ExpectedCellValue(sheetName, 107, 26, null),
					new ExpectedCellValue(sheetName, 108, 26, null),
					new ExpectedCellValue(sheetName, 109, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 110, 26, null),
					new ExpectedCellValue(sheetName, 111, 26, null),
					new ExpectedCellValue(sheetName, 112, 26, null),
					new ExpectedCellValue(sheetName, 113, 26, null),
					new ExpectedCellValue(sheetName, 70, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 27, null),
					new ExpectedCellValue(sheetName, 72, 27, null),
					new ExpectedCellValue(sheetName, 73, 27, 831.5),
					new ExpectedCellValue(sheetName, 74, 27, 831.5),
					new ExpectedCellValue(sheetName, 75, 27, 831.5),
					new ExpectedCellValue(sheetName, 76, 27, 831.5),
					new ExpectedCellValue(sheetName, 77, 27, null),
					new ExpectedCellValue(sheetName, 78, 27, null),
					new ExpectedCellValue(sheetName, 79, 27, 831.5),
					new ExpectedCellValue(sheetName, 80, 27, 831.5),
					new ExpectedCellValue(sheetName, 81, 27, 831.5),
					new ExpectedCellValue(sheetName, 82, 27, 831.5),
					new ExpectedCellValue(sheetName, 83, 27, null),
					new ExpectedCellValue(sheetName, 84, 27, null),
					new ExpectedCellValue(sheetName, 85, 27, 1194d),
					new ExpectedCellValue(sheetName, 86, 27, 1194d),
					new ExpectedCellValue(sheetName, 87, 27, 1194d),
					new ExpectedCellValue(sheetName, 88, 27, 1194d),
					new ExpectedCellValue(sheetName, 89, 27, null),
					new ExpectedCellValue(sheetName, 90, 27, null),
					new ExpectedCellValue(sheetName, 91, 27, 415.75),
					new ExpectedCellValue(sheetName, 92, 27, 415.75),
					new ExpectedCellValue(sheetName, 93, 27, 415.75),
					new ExpectedCellValue(sheetName, 94, 27, 415.75),
					new ExpectedCellValue(sheetName, 95, 27, null),
					new ExpectedCellValue(sheetName, 96, 27, null),
					new ExpectedCellValue(sheetName, 97, 27, 24.99),
					new ExpectedCellValue(sheetName, 98, 27, 24.99),
					new ExpectedCellValue(sheetName, 99, 27, 24.99),
					new ExpectedCellValue(sheetName, 100, 27, 24.99),
					new ExpectedCellValue(sheetName, 101, 27, null),
					new ExpectedCellValue(sheetName, 102, 27, null),
					new ExpectedCellValue(sheetName, 103, 27, 99d),
					new ExpectedCellValue(sheetName, 104, 27, 99d),
					new ExpectedCellValue(sheetName, 105, 27, 99d),
					new ExpectedCellValue(sheetName, 106, 27, 99d),
					new ExpectedCellValue(sheetName, 107, 27, null),
					new ExpectedCellValue(sheetName, 108, 27, null),
					new ExpectedCellValue(sheetName, 109, 27, 831.5),
					new ExpectedCellValue(sheetName, 110, 27, 831.5),
					new ExpectedCellValue(sheetName, 111, 27, 831.5),
					new ExpectedCellValue(sheetName, 112, 27, 831.5),
					new ExpectedCellValue(sheetName, 113, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndLastFieldsTabularSecondAndThirdFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD70:AH85"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 30, 20100007),
					new ExpectedCellValue(sheetName, 72, 30, null),
					new ExpectedCellValue(sheetName, 73, 30, 20100017),
					new ExpectedCellValue(sheetName, 74, 30, null),
					new ExpectedCellValue(sheetName, 75, 30, 20100070),
					new ExpectedCellValue(sheetName, 76, 30, null),
					new ExpectedCellValue(sheetName, 77, 30, 20100076),
					new ExpectedCellValue(sheetName, 78, 30, null),
					new ExpectedCellValue(sheetName, 79, 30, 20100083),
					new ExpectedCellValue(sheetName, 80, 30, null),
					new ExpectedCellValue(sheetName, 81, 30, 20100085),
					new ExpectedCellValue(sheetName, 82, 30, null),
					new ExpectedCellValue(sheetName, 83, 30, 20100090),
					new ExpectedCellValue(sheetName, 84, 30, null),
					new ExpectedCellValue(sheetName, 85, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 31, "Location"),
					new ExpectedCellValue(sheetName, 71, 31, null),
					new ExpectedCellValue(sheetName, 72, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 31, null),
					new ExpectedCellValue(sheetName, 74, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 75, 31, null),
					new ExpectedCellValue(sheetName, 76, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 31, null),
					new ExpectedCellValue(sheetName, 78, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 79, 31, null),
					new ExpectedCellValue(sheetName, 80, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 81, 31, null),
					new ExpectedCellValue(sheetName, 82, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 83, 31, null),
					new ExpectedCellValue(sheetName, 84, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 85, 31, null),
					new ExpectedCellValue(sheetName, 70, 32, "Month"),
					new ExpectedCellValue(sheetName, 71, 32, null),
					new ExpectedCellValue(sheetName, 72, 32, "January"),
					new ExpectedCellValue(sheetName, 73, 32, null),
					new ExpectedCellValue(sheetName, 74, 32, "March"),
					new ExpectedCellValue(sheetName, 75, 32, null),
					new ExpectedCellValue(sheetName, 76, 32, "February"),
					new ExpectedCellValue(sheetName, 77, 32, null),
					new ExpectedCellValue(sheetName, 78, 32, "January"),
					new ExpectedCellValue(sheetName, 79, 32, null),
					new ExpectedCellValue(sheetName, 80, 32, "March"),
					new ExpectedCellValue(sheetName, 81, 32, null),
					new ExpectedCellValue(sheetName, 82, 32, "February"),
					new ExpectedCellValue(sheetName, 83, 32, null),
					new ExpectedCellValue(sheetName, 84, 32, "January"),
					new ExpectedCellValue(sheetName, 85, 32, null),
					new ExpectedCellValue(sheetName, 70, 33, "Item"),
					new ExpectedCellValue(sheetName, 71, 33, null),
					new ExpectedCellValue(sheetName, 72, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 73, 33, null),
					new ExpectedCellValue(sheetName, 74, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 75, 33, null),
					new ExpectedCellValue(sheetName, 76, 33, "Tent"),
					new ExpectedCellValue(sheetName, 77, 33, null),
					new ExpectedCellValue(sheetName, 78, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 33, null),
					new ExpectedCellValue(sheetName, 80, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 81, 33, null),
					new ExpectedCellValue(sheetName, 82, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 83, 33, null),
					new ExpectedCellValue(sheetName, 84, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 85, 33, null),
					new ExpectedCellValue(sheetName, 70, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 34, null),
					new ExpectedCellValue(sheetName, 72, 34, 831.5),
					new ExpectedCellValue(sheetName, 73, 34, null),
					new ExpectedCellValue(sheetName, 74, 34, 831.5),
					new ExpectedCellValue(sheetName, 75, 34, null),
					new ExpectedCellValue(sheetName, 76, 34, 1194d),
					new ExpectedCellValue(sheetName, 77, 34, null),
					new ExpectedCellValue(sheetName, 78, 34, 415.75),
					new ExpectedCellValue(sheetName, 79, 34, null),
					new ExpectedCellValue(sheetName, 80, 34, 24.99),
					new ExpectedCellValue(sheetName, 81, 34, null),
					new ExpectedCellValue(sheetName, 82, 34, 99d),
					new ExpectedCellValue(sheetName, 83, 34, null),
					new ExpectedCellValue(sheetName, 84, 34, 831.5),
					new ExpectedCellValue(sheetName, 85, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndLastFieldsTabularSecondAndThirdFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD70:AH99"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 30, 20100007),
					new ExpectedCellValue(sheetName, 72, 30, null),
					new ExpectedCellValue(sheetName, 73, 30, null),
					new ExpectedCellValue(sheetName, 74, 30, null),
					new ExpectedCellValue(sheetName, 75, 30, 20100017),
					new ExpectedCellValue(sheetName, 76, 30, null),
					new ExpectedCellValue(sheetName, 77, 30, null),
					new ExpectedCellValue(sheetName, 78, 30, null),
					new ExpectedCellValue(sheetName, 79, 30, 20100070),
					new ExpectedCellValue(sheetName, 80, 30, null),
					new ExpectedCellValue(sheetName, 81, 30, null),
					new ExpectedCellValue(sheetName, 82, 30, null),
					new ExpectedCellValue(sheetName, 83, 30, 20100076),
					new ExpectedCellValue(sheetName, 84, 30, null),
					new ExpectedCellValue(sheetName, 85, 30, null),
					new ExpectedCellValue(sheetName, 86, 30, null),
					new ExpectedCellValue(sheetName, 87, 30, 20100083),
					new ExpectedCellValue(sheetName, 88, 30, null),
					new ExpectedCellValue(sheetName, 89, 30, null),
					new ExpectedCellValue(sheetName, 90, 30, null),
					new ExpectedCellValue(sheetName, 91, 30, 20100085),
					new ExpectedCellValue(sheetName, 92, 30, null),
					new ExpectedCellValue(sheetName, 93, 30, null),
					new ExpectedCellValue(sheetName, 94, 30, null),
					new ExpectedCellValue(sheetName, 95, 30, 20100090),
					new ExpectedCellValue(sheetName, 96, 30, null),
					new ExpectedCellValue(sheetName, 97, 30, null),
					new ExpectedCellValue(sheetName, 98, 30, null),
					new ExpectedCellValue(sheetName, 99, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 31, "Location"),
					new ExpectedCellValue(sheetName, 71, 31, null),
					new ExpectedCellValue(sheetName, 72, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 31, null),
					new ExpectedCellValue(sheetName, 74, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 75, 31, null),
					new ExpectedCellValue(sheetName, 76, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 77, 31, null),
					new ExpectedCellValue(sheetName, 78, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 79, 31, null),
					new ExpectedCellValue(sheetName, 80, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 81, 31, null),
					new ExpectedCellValue(sheetName, 82, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 83, 31, null),
					new ExpectedCellValue(sheetName, 84, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 85, 31, null),
					new ExpectedCellValue(sheetName, 86, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 87, 31, null),
					new ExpectedCellValue(sheetName, 88, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 89, 31, null),
					new ExpectedCellValue(sheetName, 90, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 91, 31, null),
					new ExpectedCellValue(sheetName, 92, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 93, 31, null),
					new ExpectedCellValue(sheetName, 94, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 95, 31, null),
					new ExpectedCellValue(sheetName, 96, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 97, 31, null),
					new ExpectedCellValue(sheetName, 98, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 99, 31, null),
					new ExpectedCellValue(sheetName, 70, 32, "Month"),
					new ExpectedCellValue(sheetName, 71, 32, null),
					new ExpectedCellValue(sheetName, 72, 32, "January"),
					new ExpectedCellValue(sheetName, 73, 32, "January Total"),
					new ExpectedCellValue(sheetName, 74, 32, null),
					new ExpectedCellValue(sheetName, 75, 32, null),
					new ExpectedCellValue(sheetName, 76, 32, "March"),
					new ExpectedCellValue(sheetName, 77, 32, "March Total"),
					new ExpectedCellValue(sheetName, 78, 32, null),
					new ExpectedCellValue(sheetName, 79, 32, null),
					new ExpectedCellValue(sheetName, 80, 32, "February"),
					new ExpectedCellValue(sheetName, 81, 32, "February Total"),
					new ExpectedCellValue(sheetName, 82, 32, null),
					new ExpectedCellValue(sheetName, 83, 32, null),
					new ExpectedCellValue(sheetName, 84, 32, "January"),
					new ExpectedCellValue(sheetName, 85, 32, "January Total"),
					new ExpectedCellValue(sheetName, 86, 32, null),
					new ExpectedCellValue(sheetName, 87, 32, null),
					new ExpectedCellValue(sheetName, 88, 32, "March"),
					new ExpectedCellValue(sheetName, 89, 32, "March Total"),
					new ExpectedCellValue(sheetName, 90, 32, null),
					new ExpectedCellValue(sheetName, 91, 32, null),
					new ExpectedCellValue(sheetName, 92, 32, "February"),
					new ExpectedCellValue(sheetName, 93, 32, "February Total"),
					new ExpectedCellValue(sheetName, 94, 32, null),
					new ExpectedCellValue(sheetName, 95, 32, null),
					new ExpectedCellValue(sheetName, 96, 32, "January"),
					new ExpectedCellValue(sheetName, 97, 32, "January Total"),
					new ExpectedCellValue(sheetName, 98, 32, null),
					new ExpectedCellValue(sheetName, 99, 32, null),
					new ExpectedCellValue(sheetName, 70, 33, "Item"),
					new ExpectedCellValue(sheetName, 71, 33, null),
					new ExpectedCellValue(sheetName, 72, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 73, 33, null),
					new ExpectedCellValue(sheetName, 74, 33, null),
					new ExpectedCellValue(sheetName, 75, 33, null),
					new ExpectedCellValue(sheetName, 76, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 33, null),
					new ExpectedCellValue(sheetName, 78, 33, null),
					new ExpectedCellValue(sheetName, 79, 33, null),
					new ExpectedCellValue(sheetName, 80, 33, "Tent"),
					new ExpectedCellValue(sheetName, 81, 33, null),
					new ExpectedCellValue(sheetName, 82, 33, null),
					new ExpectedCellValue(sheetName, 83, 33, null),
					new ExpectedCellValue(sheetName, 84, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 85, 33, null),
					new ExpectedCellValue(sheetName, 86, 33, null),
					new ExpectedCellValue(sheetName, 87, 33, null),
					new ExpectedCellValue(sheetName, 88, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 89, 33, null),
					new ExpectedCellValue(sheetName, 90, 33, null),
					new ExpectedCellValue(sheetName, 91, 33, null),
					new ExpectedCellValue(sheetName, 92, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 93, 33, null),
					new ExpectedCellValue(sheetName, 94, 33, null),
					new ExpectedCellValue(sheetName, 95, 33, null),
					new ExpectedCellValue(sheetName, 96, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 97, 33, null),
					new ExpectedCellValue(sheetName, 98, 33, null),
					new ExpectedCellValue(sheetName, 99, 33, null),
					new ExpectedCellValue(sheetName, 70, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 34, 831.5),
					new ExpectedCellValue(sheetName, 72, 34, 831.5),
					new ExpectedCellValue(sheetName, 73, 34, 831.5),
					new ExpectedCellValue(sheetName, 74, 34, 831.5),
					new ExpectedCellValue(sheetName, 75, 34, 831.5),
					new ExpectedCellValue(sheetName, 76, 34, 831.5),
					new ExpectedCellValue(sheetName, 77, 34, 831.5),
					new ExpectedCellValue(sheetName, 78, 34, 831.5),
					new ExpectedCellValue(sheetName, 79, 34, 1194d),
					new ExpectedCellValue(sheetName, 80, 34, 1194d),
					new ExpectedCellValue(sheetName, 81, 34, 1194d),
					new ExpectedCellValue(sheetName, 82, 34, 1194d),
					new ExpectedCellValue(sheetName, 83, 34, 415.75),
					new ExpectedCellValue(sheetName, 84, 34, 415.75),
					new ExpectedCellValue(sheetName, 85, 34, 415.75),
					new ExpectedCellValue(sheetName, 86, 34, 415.75),
					new ExpectedCellValue(sheetName, 87, 34, 24.99),
					new ExpectedCellValue(sheetName, 88, 34, 24.99),
					new ExpectedCellValue(sheetName, 89, 34, 24.99),
					new ExpectedCellValue(sheetName, 90, 34, 24.99),
					new ExpectedCellValue(sheetName, 91, 34, 99d),
					new ExpectedCellValue(sheetName, 92, 34, 99d),
					new ExpectedCellValue(sheetName, 93, 34, 99d),
					new ExpectedCellValue(sheetName, 94, 34, 99d),
					new ExpectedCellValue(sheetName, 95, 34, 831.5),
					new ExpectedCellValue(sheetName, 96, 34, 831.5),
					new ExpectedCellValue(sheetName, 97, 34, 831.5),
					new ExpectedCellValue(sheetName, 98, 34, 831.5),
					new ExpectedCellValue(sheetName, 99, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstAndLastFieldsTabularSecondAndThirdFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD70:AH106"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 70, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 71, 30, 20100007),
					new ExpectedCellValue(sheetName, 72, 30, null),
					new ExpectedCellValue(sheetName, 73, 30, null),
					new ExpectedCellValue(sheetName, 74, 30, null),
					new ExpectedCellValue(sheetName, 75, 30, "20100007 Total"),
					new ExpectedCellValue(sheetName, 76, 30, 20100017),
					new ExpectedCellValue(sheetName, 77, 30, null),
					new ExpectedCellValue(sheetName, 78, 30, null),
					new ExpectedCellValue(sheetName, 79, 30, null),
					new ExpectedCellValue(sheetName, 80, 30, "20100017 Total"),
					new ExpectedCellValue(sheetName, 81, 30, 20100070),
					new ExpectedCellValue(sheetName, 82, 30, null),
					new ExpectedCellValue(sheetName, 83, 30, null),
					new ExpectedCellValue(sheetName, 84, 30, null),
					new ExpectedCellValue(sheetName, 85, 30, "20100070 Total"),
					new ExpectedCellValue(sheetName, 86, 30, 20100076),
					new ExpectedCellValue(sheetName, 87, 30, null),
					new ExpectedCellValue(sheetName, 88, 30, null),
					new ExpectedCellValue(sheetName, 89, 30, null),
					new ExpectedCellValue(sheetName, 90, 30, "20100076 Total"),
					new ExpectedCellValue(sheetName, 91, 30, 20100083),
					new ExpectedCellValue(sheetName, 92, 30, null),
					new ExpectedCellValue(sheetName, 93, 30, null),
					new ExpectedCellValue(sheetName, 94, 30, null),
					new ExpectedCellValue(sheetName, 95, 30, "20100083 Total"),
					new ExpectedCellValue(sheetName, 96, 30, 20100085),
					new ExpectedCellValue(sheetName, 97, 30, null),
					new ExpectedCellValue(sheetName, 98, 30, null),
					new ExpectedCellValue(sheetName, 99, 30, null),
					new ExpectedCellValue(sheetName, 100, 30, "20100085 Total"),
					new ExpectedCellValue(sheetName, 101, 30, 20100090),
					new ExpectedCellValue(sheetName, 102, 30, null),
					new ExpectedCellValue(sheetName, 103, 30, null),
					new ExpectedCellValue(sheetName, 104, 30, null),
					new ExpectedCellValue(sheetName, 105, 30, "20100090 Total"),
					new ExpectedCellValue(sheetName, 106, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 70, 31, "Location"),
					new ExpectedCellValue(sheetName, 71, 31, null),
					new ExpectedCellValue(sheetName, 72, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 73, 31, null),
					new ExpectedCellValue(sheetName, 74, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 75, 31, null),
					new ExpectedCellValue(sheetName, 76, 31, null),
					new ExpectedCellValue(sheetName, 77, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 78, 31, null),
					new ExpectedCellValue(sheetName, 79, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 80, 31, null),
					new ExpectedCellValue(sheetName, 81, 31, null),
					new ExpectedCellValue(sheetName, 82, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 83, 31, null),
					new ExpectedCellValue(sheetName, 84, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 85, 31, null),
					new ExpectedCellValue(sheetName, 86, 31, null),
					new ExpectedCellValue(sheetName, 87, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 88, 31, null),
					new ExpectedCellValue(sheetName, 89, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 90, 31, null),
					new ExpectedCellValue(sheetName, 91, 31, null),
					new ExpectedCellValue(sheetName, 92, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 93, 31, null),
					new ExpectedCellValue(sheetName, 94, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 95, 31, null),
					new ExpectedCellValue(sheetName, 96, 31, null),
					new ExpectedCellValue(sheetName, 97, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 31, null),
					new ExpectedCellValue(sheetName, 99, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 100, 31, null),
					new ExpectedCellValue(sheetName, 101, 31, null),
					new ExpectedCellValue(sheetName, 102, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 103, 31, null),
					new ExpectedCellValue(sheetName, 104, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 105, 31, null),
					new ExpectedCellValue(sheetName, 106, 31, null),
					new ExpectedCellValue(sheetName, 70, 32, "Month"),
					new ExpectedCellValue(sheetName, 71, 32, null),
					new ExpectedCellValue(sheetName, 72, 32, "January"),
					new ExpectedCellValue(sheetName, 73, 32, "January Total"),
					new ExpectedCellValue(sheetName, 74, 32, null),
					new ExpectedCellValue(sheetName, 75, 32, null),
					new ExpectedCellValue(sheetName, 76, 32, null),
					new ExpectedCellValue(sheetName, 77, 32, "March"),
					new ExpectedCellValue(sheetName, 78, 32, "March Total"),
					new ExpectedCellValue(sheetName, 79, 32, null),
					new ExpectedCellValue(sheetName, 80, 32, null),
					new ExpectedCellValue(sheetName, 81, 32, null),
					new ExpectedCellValue(sheetName, 82, 32, "February"),
					new ExpectedCellValue(sheetName, 83, 32, "February Total"),
					new ExpectedCellValue(sheetName, 84, 32, null),
					new ExpectedCellValue(sheetName, 85, 32, null),
					new ExpectedCellValue(sheetName, 86, 32, null),
					new ExpectedCellValue(sheetName, 87, 32, "January"),
					new ExpectedCellValue(sheetName, 88, 32, "January Total"),
					new ExpectedCellValue(sheetName, 89, 32, null),
					new ExpectedCellValue(sheetName, 90, 32, null),
					new ExpectedCellValue(sheetName, 91, 32, null),
					new ExpectedCellValue(sheetName, 92, 32, "March"),
					new ExpectedCellValue(sheetName, 93, 32, "March Total"),
					new ExpectedCellValue(sheetName, 94, 32, null),
					new ExpectedCellValue(sheetName, 95, 32, null),
					new ExpectedCellValue(sheetName, 96, 32, null),
					new ExpectedCellValue(sheetName, 97, 32, "February"),
					new ExpectedCellValue(sheetName, 98, 32, "February Total"),
					new ExpectedCellValue(sheetName, 99, 32, null),
					new ExpectedCellValue(sheetName, 100, 32, null),
					new ExpectedCellValue(sheetName, 101, 32, null),
					new ExpectedCellValue(sheetName, 102, 32, "January"),
					new ExpectedCellValue(sheetName, 103, 32, "January Total"),
					new ExpectedCellValue(sheetName, 104, 32, null),
					new ExpectedCellValue(sheetName, 105, 32, null),
					new ExpectedCellValue(sheetName, 106, 32, null),
					new ExpectedCellValue(sheetName, 70, 33, "Item"),
					new ExpectedCellValue(sheetName, 71, 33, null),
					new ExpectedCellValue(sheetName, 72, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 73, 33, null),
					new ExpectedCellValue(sheetName, 74, 33, null),
					new ExpectedCellValue(sheetName, 75, 33, null),
					new ExpectedCellValue(sheetName, 76, 33, null),
					new ExpectedCellValue(sheetName, 77, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 78, 33, null),
					new ExpectedCellValue(sheetName, 79, 33, null),
					new ExpectedCellValue(sheetName, 80, 33, null),
					new ExpectedCellValue(sheetName, 81, 33, null),
					new ExpectedCellValue(sheetName, 82, 33, "Tent"),
					new ExpectedCellValue(sheetName, 83, 33, null),
					new ExpectedCellValue(sheetName, 84, 33, null),
					new ExpectedCellValue(sheetName, 85, 33, null),
					new ExpectedCellValue(sheetName, 86, 33, null),
					new ExpectedCellValue(sheetName, 87, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 88, 33, null),
					new ExpectedCellValue(sheetName, 89, 33, null),
					new ExpectedCellValue(sheetName, 90, 33, null),
					new ExpectedCellValue(sheetName, 91, 33, null),
					new ExpectedCellValue(sheetName, 92, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 93, 33, null),
					new ExpectedCellValue(sheetName, 94, 33, null),
					new ExpectedCellValue(sheetName, 95, 33, null),
					new ExpectedCellValue(sheetName, 96, 33, null),
					new ExpectedCellValue(sheetName, 97, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 98, 33, null),
					new ExpectedCellValue(sheetName, 99, 33, null),
					new ExpectedCellValue(sheetName, 100, 33, null),
					new ExpectedCellValue(sheetName, 101, 33, null),
					new ExpectedCellValue(sheetName, 102, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 103, 33, null),
					new ExpectedCellValue(sheetName, 104, 33, null),
					new ExpectedCellValue(sheetName, 105, 33, null),
					new ExpectedCellValue(sheetName, 106, 33, null),
					new ExpectedCellValue(sheetName, 70, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 34, null),
					new ExpectedCellValue(sheetName, 72, 34, 831.5),
					new ExpectedCellValue(sheetName, 73, 34, 831.5),
					new ExpectedCellValue(sheetName, 74, 34, 831.5),
					new ExpectedCellValue(sheetName, 75, 34, 831.5),
					new ExpectedCellValue(sheetName, 76, 34, null),
					new ExpectedCellValue(sheetName, 77, 34, 831.5),
					new ExpectedCellValue(sheetName, 78, 34, 831.5),
					new ExpectedCellValue(sheetName, 79, 34, 831.5),
					new ExpectedCellValue(sheetName, 80, 34, 831.5),
					new ExpectedCellValue(sheetName, 81, 34, null),
					new ExpectedCellValue(sheetName, 82, 34, 1194d),
					new ExpectedCellValue(sheetName, 83, 34, 1194d),
					new ExpectedCellValue(sheetName, 84, 34, 1194d),
					new ExpectedCellValue(sheetName, 85, 34, 1194d),
					new ExpectedCellValue(sheetName, 86, 34, null),
					new ExpectedCellValue(sheetName, 87, 34, 415.75),
					new ExpectedCellValue(sheetName, 88, 34, 415.75),
					new ExpectedCellValue(sheetName, 89, 34, 415.75),
					new ExpectedCellValue(sheetName, 90, 34, 415.75),
					new ExpectedCellValue(sheetName, 91, 34, null),
					new ExpectedCellValue(sheetName, 92, 34, 24.99),
					new ExpectedCellValue(sheetName, 93, 34, 24.99),
					new ExpectedCellValue(sheetName, 94, 34, 24.99),
					new ExpectedCellValue(sheetName, 95, 34, 24.99),
					new ExpectedCellValue(sheetName, 96, 34, null),
					new ExpectedCellValue(sheetName, 97, 34, 99d),
					new ExpectedCellValue(sheetName, 98, 34, 99d),
					new ExpectedCellValue(sheetName, 99, 34, 99d),
					new ExpectedCellValue(sheetName, 100, 34, 99d),
					new ExpectedCellValue(sheetName, 101, 34, null),
					new ExpectedCellValue(sheetName, 102, 34, 831.5),
					new ExpectedCellValue(sheetName, 103, 34, 831.5),
					new ExpectedCellValue(sheetName, 104, 34, 831.5),
					new ExpectedCellValue(sheetName, 105, 34, 831.5),
					new ExpectedCellValue(sheetName, 106, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstFieldTabularSecondThirdAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P120:T135"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 16, 20100007),
					new ExpectedCellValue(sheetName, 122, 16, null),
					new ExpectedCellValue(sheetName, 123, 16, 20100017),
					new ExpectedCellValue(sheetName, 124, 16, null),
					new ExpectedCellValue(sheetName, 125, 16, 20100070),
					new ExpectedCellValue(sheetName, 126, 16, null),
					new ExpectedCellValue(sheetName, 127, 16, 20100076),
					new ExpectedCellValue(sheetName, 128, 16, null),
					new ExpectedCellValue(sheetName, 129, 16, 20100083),
					new ExpectedCellValue(sheetName, 130, 16, null),
					new ExpectedCellValue(sheetName, 131, 16, 20100085),
					new ExpectedCellValue(sheetName, 132, 16, null),
					new ExpectedCellValue(sheetName, 133, 16, 20100090),
					new ExpectedCellValue(sheetName, 134, 16, null),
					new ExpectedCellValue(sheetName, 135, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 17, "Location"),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 127, 17, null),
					new ExpectedCellValue(sheetName, 128, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 131, 17, null),
					new ExpectedCellValue(sheetName, 132, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 133, 17, null),
					new ExpectedCellValue(sheetName, 134, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 120, 18, "Month"),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "January"),
					new ExpectedCellValue(sheetName, 123, 18, null),
					new ExpectedCellValue(sheetName, 124, 18, "March"),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, "February"),
					new ExpectedCellValue(sheetName, 127, 18, null),
					new ExpectedCellValue(sheetName, 128, 18, "January"),
					new ExpectedCellValue(sheetName, 129, 18, null),
					new ExpectedCellValue(sheetName, 130, 18, "March"),
					new ExpectedCellValue(sheetName, 131, 18, null),
					new ExpectedCellValue(sheetName, 132, 18, "February"),
					new ExpectedCellValue(sheetName, 133, 18, null),
					new ExpectedCellValue(sheetName, 134, 18, "January"),
					new ExpectedCellValue(sheetName, 135, 18, null),
					new ExpectedCellValue(sheetName, 120, 19, "Item"),
					new ExpectedCellValue(sheetName, 121, 19, null),
					new ExpectedCellValue(sheetName, 122, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 123, 19, null),
					new ExpectedCellValue(sheetName, 124, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 125, 19, null),
					new ExpectedCellValue(sheetName, 126, 19, "Tent"),
					new ExpectedCellValue(sheetName, 127, 19, null),
					new ExpectedCellValue(sheetName, 128, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 129, 19, null),
					new ExpectedCellValue(sheetName, 130, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 131, 19, null),
					new ExpectedCellValue(sheetName, 132, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 133, 19, null),
					new ExpectedCellValue(sheetName, 134, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 135, 19, null),
					new ExpectedCellValue(sheetName, 120, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 20, null),
					new ExpectedCellValue(sheetName, 122, 20, 831.5),
					new ExpectedCellValue(sheetName, 123, 20, null),
					new ExpectedCellValue(sheetName, 124, 20, 831.5),
					new ExpectedCellValue(sheetName, 125, 20, null),
					new ExpectedCellValue(sheetName, 126, 20, 1194d),
					new ExpectedCellValue(sheetName, 127, 20, null),
					new ExpectedCellValue(sheetName, 128, 20, 415.75),
					new ExpectedCellValue(sheetName, 129, 20, null),
					new ExpectedCellValue(sheetName, 130, 20, 24.99),
					new ExpectedCellValue(sheetName, 131, 20, null),
					new ExpectedCellValue(sheetName, 132, 20, 99d),
					new ExpectedCellValue(sheetName, 133, 20, null),
					new ExpectedCellValue(sheetName, 134, 20, 831.5),
					new ExpectedCellValue(sheetName, 135, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstFieldTabularSecondThirdAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P120:T149"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 16, 20100007),
					new ExpectedCellValue(sheetName, 122, 16, null),
					new ExpectedCellValue(sheetName, 123, 16, null),
					new ExpectedCellValue(sheetName, 124, 16, null),
					new ExpectedCellValue(sheetName, 125, 16, 20100017),
					new ExpectedCellValue(sheetName, 126, 16, null),
					new ExpectedCellValue(sheetName, 127, 16, null),
					new ExpectedCellValue(sheetName, 128, 16, null),
					new ExpectedCellValue(sheetName, 129, 16, 20100070),
					new ExpectedCellValue(sheetName, 130, 16, null),
					new ExpectedCellValue(sheetName, 131, 16, null),
					new ExpectedCellValue(sheetName, 132, 16, null),
					new ExpectedCellValue(sheetName, 133, 16, 20100076),
					new ExpectedCellValue(sheetName, 134, 16, null),
					new ExpectedCellValue(sheetName, 135, 16, null),
					new ExpectedCellValue(sheetName, 136, 16, null),
					new ExpectedCellValue(sheetName, 137, 16, 20100083),
					new ExpectedCellValue(sheetName, 138, 16, null),
					new ExpectedCellValue(sheetName, 139, 16, null),
					new ExpectedCellValue(sheetName, 140, 16, null),
					new ExpectedCellValue(sheetName, 141, 16, 20100085),
					new ExpectedCellValue(sheetName, 142, 16, null),
					new ExpectedCellValue(sheetName, 143, 16, null),
					new ExpectedCellValue(sheetName, 144, 16, null),
					new ExpectedCellValue(sheetName, 145, 16, 20100090),
					new ExpectedCellValue(sheetName, 146, 16, null),
					new ExpectedCellValue(sheetName, 147, 16, null),
					new ExpectedCellValue(sheetName, 148, 16, null),
					new ExpectedCellValue(sheetName, 149, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 17, "Location"),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 127, 17, null),
					new ExpectedCellValue(sheetName, 128, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 131, 17, null),
					new ExpectedCellValue(sheetName, 132, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 133, 17, null),
					new ExpectedCellValue(sheetName, 134, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 137, 17, null),
					new ExpectedCellValue(sheetName, 138, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 139, 17, null),
					new ExpectedCellValue(sheetName, 140, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 147, 17, null),
					new ExpectedCellValue(sheetName, 148, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 149, 17, null),
					new ExpectedCellValue(sheetName, 120, 18, "Month"),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "January"),
					new ExpectedCellValue(sheetName, 123, 18, "January Total"),
					new ExpectedCellValue(sheetName, 124, 18, null),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, "March"),
					new ExpectedCellValue(sheetName, 127, 18, "March Total"),
					new ExpectedCellValue(sheetName, 128, 18, null),
					new ExpectedCellValue(sheetName, 129, 18, null),
					new ExpectedCellValue(sheetName, 130, 18, "February"),
					new ExpectedCellValue(sheetName, 131, 18, "February Total"),
					new ExpectedCellValue(sheetName, 132, 18, null),
					new ExpectedCellValue(sheetName, 133, 18, null),
					new ExpectedCellValue(sheetName, 134, 18, "January"),
					new ExpectedCellValue(sheetName, 135, 18, "January Total"),
					new ExpectedCellValue(sheetName, 136, 18, null),
					new ExpectedCellValue(sheetName, 137, 18, null),
					new ExpectedCellValue(sheetName, 138, 18, "March"),
					new ExpectedCellValue(sheetName, 139, 18, "March Total"),
					new ExpectedCellValue(sheetName, 140, 18, null),
					new ExpectedCellValue(sheetName, 141, 18, null),
					new ExpectedCellValue(sheetName, 142, 18, "February"),
					new ExpectedCellValue(sheetName, 143, 18, "February Total"),
					new ExpectedCellValue(sheetName, 144, 18, null),
					new ExpectedCellValue(sheetName, 145, 18, null),
					new ExpectedCellValue(sheetName, 146, 18, "January"),
					new ExpectedCellValue(sheetName, 147, 18, "January Total"),
					new ExpectedCellValue(sheetName, 148, 18, null),
					new ExpectedCellValue(sheetName, 149, 18, null),
					new ExpectedCellValue(sheetName, 120, 19, "Item"),
					new ExpectedCellValue(sheetName, 121, 19, null),
					new ExpectedCellValue(sheetName, 122, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 123, 19, null),
					new ExpectedCellValue(sheetName, 124, 19, null),
					new ExpectedCellValue(sheetName, 125, 19, null),
					new ExpectedCellValue(sheetName, 126, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 19, null),
					new ExpectedCellValue(sheetName, 128, 19, null),
					new ExpectedCellValue(sheetName, 129, 19, null),
					new ExpectedCellValue(sheetName, 130, 19, "Tent"),
					new ExpectedCellValue(sheetName, 131, 19, null),
					new ExpectedCellValue(sheetName, 132, 19, null),
					new ExpectedCellValue(sheetName, 133, 19, null),
					new ExpectedCellValue(sheetName, 134, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 135, 19, null),
					new ExpectedCellValue(sheetName, 136, 19, null),
					new ExpectedCellValue(sheetName, 137, 19, null),
					new ExpectedCellValue(sheetName, 138, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 139, 19, null),
					new ExpectedCellValue(sheetName, 140, 19, null),
					new ExpectedCellValue(sheetName, 141, 19, null),
					new ExpectedCellValue(sheetName, 142, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 143, 19, null),
					new ExpectedCellValue(sheetName, 144, 19, null),
					new ExpectedCellValue(sheetName, 145, 19, null),
					new ExpectedCellValue(sheetName, 146, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 19, null),
					new ExpectedCellValue(sheetName, 148, 19, null),
					new ExpectedCellValue(sheetName, 149, 19, null),
					new ExpectedCellValue(sheetName, 120, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 20, 831.5),
					new ExpectedCellValue(sheetName, 122, 20, 831.5),
					new ExpectedCellValue(sheetName, 123, 20, 831.5),
					new ExpectedCellValue(sheetName, 124, 20, 831.5),
					new ExpectedCellValue(sheetName, 125, 20, 831.5),
					new ExpectedCellValue(sheetName, 126, 20, 831.5),
					new ExpectedCellValue(sheetName, 127, 20, 831.5),
					new ExpectedCellValue(sheetName, 128, 20, 831.5),
					new ExpectedCellValue(sheetName, 129, 20, 1194d),
					new ExpectedCellValue(sheetName, 130, 20, 1194d),
					new ExpectedCellValue(sheetName, 131, 20, 1194d),
					new ExpectedCellValue(sheetName, 132, 20, 1194d),
					new ExpectedCellValue(sheetName, 133, 20, 415.75),
					new ExpectedCellValue(sheetName, 134, 20, 415.75),
					new ExpectedCellValue(sheetName, 135, 20, 415.75),
					new ExpectedCellValue(sheetName, 136, 20, 415.75),
					new ExpectedCellValue(sheetName, 137, 20, 24.99),
					new ExpectedCellValue(sheetName, 138, 20, 24.99),
					new ExpectedCellValue(sheetName, 139, 20, 24.99),
					new ExpectedCellValue(sheetName, 140, 20, 24.99),
					new ExpectedCellValue(sheetName, 141, 20, 99d),
					new ExpectedCellValue(sheetName, 142, 20, 99d),
					new ExpectedCellValue(sheetName, 143, 20, 99d),
					new ExpectedCellValue(sheetName, 144, 20, 99d),
					new ExpectedCellValue(sheetName, 145, 20, 831.5),
					new ExpectedCellValue(sheetName, 146, 20, 831.5),
					new ExpectedCellValue(sheetName, 147, 20, 831.5),
					new ExpectedCellValue(sheetName, 148, 20, 831.5),
					new ExpectedCellValue(sheetName, 149, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsNonCompactFirstFieldTabularSecondThirdAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P120:T156"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 16, 20100007),
					new ExpectedCellValue(sheetName, 122, 16, null),
					new ExpectedCellValue(sheetName, 123, 16, null),
					new ExpectedCellValue(sheetName, 124, 16, null),
					new ExpectedCellValue(sheetName, 125, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 126, 16, 20100017),
					new ExpectedCellValue(sheetName, 127, 16, null),
					new ExpectedCellValue(sheetName, 128, 16, null),
					new ExpectedCellValue(sheetName, 129, 16, null),
					new ExpectedCellValue(sheetName, 130, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 131, 16, 20100070),
					new ExpectedCellValue(sheetName, 132, 16, null),
					new ExpectedCellValue(sheetName, 133, 16, null),
					new ExpectedCellValue(sheetName, 134, 16, null),
					new ExpectedCellValue(sheetName, 135, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 136, 16, 20100076),
					new ExpectedCellValue(sheetName, 137, 16, null),
					new ExpectedCellValue(sheetName, 138, 16, null),
					new ExpectedCellValue(sheetName, 139, 16, null),
					new ExpectedCellValue(sheetName, 140, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 141, 16, 20100083),
					new ExpectedCellValue(sheetName, 142, 16, null),
					new ExpectedCellValue(sheetName, 143, 16, null),
					new ExpectedCellValue(sheetName, 144, 16, null),
					new ExpectedCellValue(sheetName, 145, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 146, 16, 20100085),
					new ExpectedCellValue(sheetName, 147, 16, null),
					new ExpectedCellValue(sheetName, 148, 16, null),
					new ExpectedCellValue(sheetName, 149, 16, null),
					new ExpectedCellValue(sheetName, 150, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 151, 16, 20100090),
					new ExpectedCellValue(sheetName, 152, 16, null),
					new ExpectedCellValue(sheetName, 153, 16, null),
					new ExpectedCellValue(sheetName, 154, 16, null),
					new ExpectedCellValue(sheetName, 155, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 156, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 17, "Location"),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, null),
					new ExpectedCellValue(sheetName, 127, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 130, 17, null),
					new ExpectedCellValue(sheetName, 131, 17, null),
					new ExpectedCellValue(sheetName, 132, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 133, 17, null),
					new ExpectedCellValue(sheetName, 134, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, null),
					new ExpectedCellValue(sheetName, 137, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 17, null),
					new ExpectedCellValue(sheetName, 139, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 140, 17, null),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, null),
					new ExpectedCellValue(sheetName, 147, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 148, 17, null),
					new ExpectedCellValue(sheetName, 149, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 150, 17, null),
					new ExpectedCellValue(sheetName, 151, 17, null),
					new ExpectedCellValue(sheetName, 152, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 153, 17, null),
					new ExpectedCellValue(sheetName, 154, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 155, 17, null),
					new ExpectedCellValue(sheetName, 156, 17, null),
					new ExpectedCellValue(sheetName, 120, 18, "Month"),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "January"),
					new ExpectedCellValue(sheetName, 123, 18, "January Total"),
					new ExpectedCellValue(sheetName, 124, 18, null),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, null),
					new ExpectedCellValue(sheetName, 127, 18, "March"),
					new ExpectedCellValue(sheetName, 128, 18, "March Total"),
					new ExpectedCellValue(sheetName, 129, 18, null),
					new ExpectedCellValue(sheetName, 130, 18, null),
					new ExpectedCellValue(sheetName, 131, 18, null),
					new ExpectedCellValue(sheetName, 132, 18, "February"),
					new ExpectedCellValue(sheetName, 133, 18, "February Total"),
					new ExpectedCellValue(sheetName, 134, 18, null),
					new ExpectedCellValue(sheetName, 135, 18, null),
					new ExpectedCellValue(sheetName, 136, 18, null),
					new ExpectedCellValue(sheetName, 137, 18, "January"),
					new ExpectedCellValue(sheetName, 138, 18, "January Total"),
					new ExpectedCellValue(sheetName, 139, 18, null),
					new ExpectedCellValue(sheetName, 140, 18, null),
					new ExpectedCellValue(sheetName, 141, 18, null),
					new ExpectedCellValue(sheetName, 142, 18, "March"),
					new ExpectedCellValue(sheetName, 143, 18, "March Total"),
					new ExpectedCellValue(sheetName, 144, 18, null),
					new ExpectedCellValue(sheetName, 145, 18, null),
					new ExpectedCellValue(sheetName, 146, 18, null),
					new ExpectedCellValue(sheetName, 147, 18, "February"),
					new ExpectedCellValue(sheetName, 148, 18, "February Total"),
					new ExpectedCellValue(sheetName, 149, 18, null),
					new ExpectedCellValue(sheetName, 150, 18, null),
					new ExpectedCellValue(sheetName, 151, 18, null),
					new ExpectedCellValue(sheetName, 152, 18, "January"),
					new ExpectedCellValue(sheetName, 153, 18, "January Total"),
					new ExpectedCellValue(sheetName, 154, 18, null),
					new ExpectedCellValue(sheetName, 155, 18, null),
					new ExpectedCellValue(sheetName, 156, 18, null),
					new ExpectedCellValue(sheetName, 120, 19, "Item"),
					new ExpectedCellValue(sheetName, 121, 19, null),
					new ExpectedCellValue(sheetName, 122, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 123, 19, null),
					new ExpectedCellValue(sheetName, 124, 19, null),
					new ExpectedCellValue(sheetName, 125, 19, null),
					new ExpectedCellValue(sheetName, 126, 19, null),
					new ExpectedCellValue(sheetName, 127, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 128, 19, null),
					new ExpectedCellValue(sheetName, 129, 19, null),
					new ExpectedCellValue(sheetName, 130, 19, null),
					new ExpectedCellValue(sheetName, 131, 19, null),
					new ExpectedCellValue(sheetName, 132, 19, "Tent"),
					new ExpectedCellValue(sheetName, 133, 19, null),
					new ExpectedCellValue(sheetName, 134, 19, null),
					new ExpectedCellValue(sheetName, 135, 19, null),
					new ExpectedCellValue(sheetName, 136, 19, null),
					new ExpectedCellValue(sheetName, 137, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 138, 19, null),
					new ExpectedCellValue(sheetName, 139, 19, null),
					new ExpectedCellValue(sheetName, 140, 19, null),
					new ExpectedCellValue(sheetName, 141, 19, null),
					new ExpectedCellValue(sheetName, 142, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 143, 19, null),
					new ExpectedCellValue(sheetName, 144, 19, null),
					new ExpectedCellValue(sheetName, 145, 19, null),
					new ExpectedCellValue(sheetName, 146, 19, null),
					new ExpectedCellValue(sheetName, 147, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 148, 19, null),
					new ExpectedCellValue(sheetName, 149, 19, null),
					new ExpectedCellValue(sheetName, 150, 19, null),
					new ExpectedCellValue(sheetName, 151, 19, null),
					new ExpectedCellValue(sheetName, 152, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 153, 19, null),
					new ExpectedCellValue(sheetName, 154, 19, null),
					new ExpectedCellValue(sheetName, 155, 19, null),
					new ExpectedCellValue(sheetName, 156, 19, null),
					new ExpectedCellValue(sheetName, 120, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 20, null),
					new ExpectedCellValue(sheetName, 122, 20, 831.5),
					new ExpectedCellValue(sheetName, 123, 20, 831.5),
					new ExpectedCellValue(sheetName, 124, 20, 831.5),
					new ExpectedCellValue(sheetName, 125, 20, 831.5),
					new ExpectedCellValue(sheetName, 126, 20, null),
					new ExpectedCellValue(sheetName, 127, 20, 831.5),
					new ExpectedCellValue(sheetName, 128, 20, 831.5),
					new ExpectedCellValue(sheetName, 129, 20, 831.5),
					new ExpectedCellValue(sheetName, 130, 20, 831.5),
					new ExpectedCellValue(sheetName, 131, 20, null),
					new ExpectedCellValue(sheetName, 132, 20, 1194d),
					new ExpectedCellValue(sheetName, 133, 20, 1194d),
					new ExpectedCellValue(sheetName, 134, 20, 1194d),
					new ExpectedCellValue(sheetName, 135, 20, 1194d),
					new ExpectedCellValue(sheetName, 136, 20, null),
					new ExpectedCellValue(sheetName, 137, 20, 415.75),
					new ExpectedCellValue(sheetName, 138, 20, 415.75),
					new ExpectedCellValue(sheetName, 139, 20, 415.75),
					new ExpectedCellValue(sheetName, 140, 20, 415.75),
					new ExpectedCellValue(sheetName, 141, 20, null),
					new ExpectedCellValue(sheetName, 142, 20, 24.99),
					new ExpectedCellValue(sheetName, 143, 20, 24.99),
					new ExpectedCellValue(sheetName, 144, 20, 24.99),
					new ExpectedCellValue(sheetName, 145, 20, 24.99),
					new ExpectedCellValue(sheetName, 146, 20, null),
					new ExpectedCellValue(sheetName, 147, 20, 99d),
					new ExpectedCellValue(sheetName, 148, 20, 99d),
					new ExpectedCellValue(sheetName, 149, 20, 99d),
					new ExpectedCellValue(sheetName, 150, 20, 99d),
					new ExpectedCellValue(sheetName, 151, 20, null),
					new ExpectedCellValue(sheetName, 152, 20, 831.5),
					new ExpectedCellValue(sheetName, 153, 20, 831.5),
					new ExpectedCellValue(sheetName, 154, 20, 831.5),
					new ExpectedCellValue(sheetName, 155, 20, 831.5),
					new ExpectedCellValue(sheetName, 156, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstFieldNonCompactSecondThirdAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W120:AA142"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 23, 20100007),
					new ExpectedCellValue(sheetName, 122, 23, null),
					new ExpectedCellValue(sheetName, 123, 23, null),
					new ExpectedCellValue(sheetName, 124, 23, 20100017),
					new ExpectedCellValue(sheetName, 125, 23, null),
					new ExpectedCellValue(sheetName, 126, 23, null),
					new ExpectedCellValue(sheetName, 127, 23, 20100070),
					new ExpectedCellValue(sheetName, 128, 23, null),
					new ExpectedCellValue(sheetName, 129, 23, null),
					new ExpectedCellValue(sheetName, 130, 23, 20100076),
					new ExpectedCellValue(sheetName, 131, 23, null),
					new ExpectedCellValue(sheetName, 132, 23, null),
					new ExpectedCellValue(sheetName, 133, 23, 20100083),
					new ExpectedCellValue(sheetName, 134, 23, null),
					new ExpectedCellValue(sheetName, 135, 23, null),
					new ExpectedCellValue(sheetName, 136, 23, 20100085),
					new ExpectedCellValue(sheetName, 137, 23, null),
					new ExpectedCellValue(sheetName, 138, 23, null),
					new ExpectedCellValue(sheetName, 139, 23, 20100090),
					new ExpectedCellValue(sheetName, 140, 23, null),
					new ExpectedCellValue(sheetName, 141, 23, null),
					new ExpectedCellValue(sheetName, 142, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 24, "Location"),
					new ExpectedCellValue(sheetName, 121, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 24, null),
					new ExpectedCellValue(sheetName, 123, 24, null),
					new ExpectedCellValue(sheetName, 124, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 24, null),
					new ExpectedCellValue(sheetName, 126, 24, null),
					new ExpectedCellValue(sheetName, 127, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 24, null),
					new ExpectedCellValue(sheetName, 129, 24, null),
					new ExpectedCellValue(sheetName, 130, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 131, 24, null),
					new ExpectedCellValue(sheetName, 132, 24, null),
					new ExpectedCellValue(sheetName, 133, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 24, null),
					new ExpectedCellValue(sheetName, 135, 24, null),
					new ExpectedCellValue(sheetName, 136, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 137, 24, null),
					new ExpectedCellValue(sheetName, 138, 24, null),
					new ExpectedCellValue(sheetName, 139, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 140, 24, null),
					new ExpectedCellValue(sheetName, 141, 24, null),
					new ExpectedCellValue(sheetName, 142, 24, null),
					new ExpectedCellValue(sheetName, 120, 25, "Month"),
					new ExpectedCellValue(sheetName, 121, 25, null),
					new ExpectedCellValue(sheetName, 122, 25, "January"),
					new ExpectedCellValue(sheetName, 123, 25, null),
					new ExpectedCellValue(sheetName, 124, 25, null),
					new ExpectedCellValue(sheetName, 125, 25, "March"),
					new ExpectedCellValue(sheetName, 126, 25, null),
					new ExpectedCellValue(sheetName, 127, 25, null),
					new ExpectedCellValue(sheetName, 128, 25, "February"),
					new ExpectedCellValue(sheetName, 129, 25, null),
					new ExpectedCellValue(sheetName, 130, 25, null),
					new ExpectedCellValue(sheetName, 131, 25, "January"),
					new ExpectedCellValue(sheetName, 132, 25, null),
					new ExpectedCellValue(sheetName, 133, 25, null),
					new ExpectedCellValue(sheetName, 134, 25, "March"),
					new ExpectedCellValue(sheetName, 135, 25, null),
					new ExpectedCellValue(sheetName, 136, 25, null),
					new ExpectedCellValue(sheetName, 137, 25, "February"),
					new ExpectedCellValue(sheetName, 138, 25, null),
					new ExpectedCellValue(sheetName, 139, 25, null),
					new ExpectedCellValue(sheetName, 140, 25, "January"),
					new ExpectedCellValue(sheetName, 141, 25, null),
					new ExpectedCellValue(sheetName, 142, 25, null),
					new ExpectedCellValue(sheetName, 120, 26, "Item"),
					new ExpectedCellValue(sheetName, 121, 26, null),
					new ExpectedCellValue(sheetName, 122, 26, null),
					new ExpectedCellValue(sheetName, 123, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 26, null),
					new ExpectedCellValue(sheetName, 125, 26, null),
					new ExpectedCellValue(sheetName, 126, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 26, null),
					new ExpectedCellValue(sheetName, 128, 26, null),
					new ExpectedCellValue(sheetName, 129, 26, "Tent"),
					new ExpectedCellValue(sheetName, 130, 26, null),
					new ExpectedCellValue(sheetName, 131, 26, null),
					new ExpectedCellValue(sheetName, 132, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 133, 26, null),
					new ExpectedCellValue(sheetName, 134, 26, null),
					new ExpectedCellValue(sheetName, 135, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 26, null),
					new ExpectedCellValue(sheetName, 137, 26, null),
					new ExpectedCellValue(sheetName, 138, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 139, 26, null),
					new ExpectedCellValue(sheetName, 140, 26, null),
					new ExpectedCellValue(sheetName, 141, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 26, null),
					new ExpectedCellValue(sheetName, 120, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 27, null),
					new ExpectedCellValue(sheetName, 122, 27, null),
					new ExpectedCellValue(sheetName, 123, 27, 831.5),
					new ExpectedCellValue(sheetName, 124, 27, null),
					new ExpectedCellValue(sheetName, 125, 27, null),
					new ExpectedCellValue(sheetName, 126, 27, 831.5),
					new ExpectedCellValue(sheetName, 127, 27, null),
					new ExpectedCellValue(sheetName, 128, 27, null),
					new ExpectedCellValue(sheetName, 129, 27, 1194d),
					new ExpectedCellValue(sheetName, 130, 27, null),
					new ExpectedCellValue(sheetName, 131, 27, null),
					new ExpectedCellValue(sheetName, 132, 27, 415.75),
					new ExpectedCellValue(sheetName, 133, 27, null),
					new ExpectedCellValue(sheetName, 134, 27, null),
					new ExpectedCellValue(sheetName, 135, 27, 24.99),
					new ExpectedCellValue(sheetName, 136, 27, null),
					new ExpectedCellValue(sheetName, 137, 27, null),
					new ExpectedCellValue(sheetName, 138, 27, 99d),
					new ExpectedCellValue(sheetName, 139, 27, null),
					new ExpectedCellValue(sheetName, 140, 27, null),
					new ExpectedCellValue(sheetName, 141, 27, 831.5),
					new ExpectedCellValue(sheetName, 142, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstFieldNonCompactSecondThirdAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W120:AA149"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 23, 20100007),
					new ExpectedCellValue(sheetName, 122, 23, null),
					new ExpectedCellValue(sheetName, 123, 23, null),
					new ExpectedCellValue(sheetName, 124, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 125, 23, 20100017),
					new ExpectedCellValue(sheetName, 126, 23, null),
					new ExpectedCellValue(sheetName, 127, 23, null),
					new ExpectedCellValue(sheetName, 128, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 129, 23, 20100070),
					new ExpectedCellValue(sheetName, 130, 23, null),
					new ExpectedCellValue(sheetName, 131, 23, null),
					new ExpectedCellValue(sheetName, 132, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 133, 23, 20100076),
					new ExpectedCellValue(sheetName, 134, 23, null),
					new ExpectedCellValue(sheetName, 135, 23, null),
					new ExpectedCellValue(sheetName, 136, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 137, 23, 20100083),
					new ExpectedCellValue(sheetName, 138, 23, null),
					new ExpectedCellValue(sheetName, 139, 23, null),
					new ExpectedCellValue(sheetName, 140, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 141, 23, 20100085),
					new ExpectedCellValue(sheetName, 142, 23, null),
					new ExpectedCellValue(sheetName, 143, 23, null),
					new ExpectedCellValue(sheetName, 144, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 145, 23, 20100090),
					new ExpectedCellValue(sheetName, 146, 23, null),
					new ExpectedCellValue(sheetName, 147, 23, null),
					new ExpectedCellValue(sheetName, 148, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 149, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 24, "Location"),
					new ExpectedCellValue(sheetName, 121, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 24, null),
					new ExpectedCellValue(sheetName, 123, 24, null),
					new ExpectedCellValue(sheetName, 124, 24, null),
					new ExpectedCellValue(sheetName, 125, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 24, null),
					new ExpectedCellValue(sheetName, 127, 24, null),
					new ExpectedCellValue(sheetName, 128, 24, null),
					new ExpectedCellValue(sheetName, 129, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 130, 24, null),
					new ExpectedCellValue(sheetName, 131, 24, null),
					new ExpectedCellValue(sheetName, 132, 24, null),
					new ExpectedCellValue(sheetName, 133, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 134, 24, null),
					new ExpectedCellValue(sheetName, 135, 24, null),
					new ExpectedCellValue(sheetName, 136, 24, null),
					new ExpectedCellValue(sheetName, 137, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 138, 24, null),
					new ExpectedCellValue(sheetName, 139, 24, null),
					new ExpectedCellValue(sheetName, 140, 24, null),
					new ExpectedCellValue(sheetName, 141, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 142, 24, null),
					new ExpectedCellValue(sheetName, 143, 24, null),
					new ExpectedCellValue(sheetName, 144, 24, null),
					new ExpectedCellValue(sheetName, 145, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 146, 24, null),
					new ExpectedCellValue(sheetName, 147, 24, null),
					new ExpectedCellValue(sheetName, 148, 24, null),
					new ExpectedCellValue(sheetName, 149, 24, null),
					new ExpectedCellValue(sheetName, 120, 25, "Month"),
					new ExpectedCellValue(sheetName, 121, 25, null),
					new ExpectedCellValue(sheetName, 122, 25, "January"),
					new ExpectedCellValue(sheetName, 123, 25, null),
					new ExpectedCellValue(sheetName, 124, 25, null),
					new ExpectedCellValue(sheetName, 125, 25, null),
					new ExpectedCellValue(sheetName, 126, 25, "March"),
					new ExpectedCellValue(sheetName, 127, 25, null),
					new ExpectedCellValue(sheetName, 128, 25, null),
					new ExpectedCellValue(sheetName, 129, 25, null),
					new ExpectedCellValue(sheetName, 130, 25, "February"),
					new ExpectedCellValue(sheetName, 131, 25, null),
					new ExpectedCellValue(sheetName, 132, 25, null),
					new ExpectedCellValue(sheetName, 133, 25, null),
					new ExpectedCellValue(sheetName, 134, 25, "January"),
					new ExpectedCellValue(sheetName, 135, 25, null),
					new ExpectedCellValue(sheetName, 136, 25, null),
					new ExpectedCellValue(sheetName, 137, 25, null),
					new ExpectedCellValue(sheetName, 138, 25, "March"),
					new ExpectedCellValue(sheetName, 139, 25, null),
					new ExpectedCellValue(sheetName, 140, 25, null),
					new ExpectedCellValue(sheetName, 141, 25, null),
					new ExpectedCellValue(sheetName, 142, 25, "February"),
					new ExpectedCellValue(sheetName, 143, 25, null),
					new ExpectedCellValue(sheetName, 144, 25, null),
					new ExpectedCellValue(sheetName, 145, 25, null),
					new ExpectedCellValue(sheetName, 146, 25, "January"),
					new ExpectedCellValue(sheetName, 147, 25, null),
					new ExpectedCellValue(sheetName, 148, 25, null),
					new ExpectedCellValue(sheetName, 149, 25, null),
					new ExpectedCellValue(sheetName, 120, 26, "Item"),
					new ExpectedCellValue(sheetName, 121, 26, null),
					new ExpectedCellValue(sheetName, 122, 26, null),
					new ExpectedCellValue(sheetName, 123, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 26, null),
					new ExpectedCellValue(sheetName, 125, 26, null),
					new ExpectedCellValue(sheetName, 126, 26, null),
					new ExpectedCellValue(sheetName, 127, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 128, 26, null),
					new ExpectedCellValue(sheetName, 129, 26, null),
					new ExpectedCellValue(sheetName, 130, 26, null),
					new ExpectedCellValue(sheetName, 131, 26, "Tent"),
					new ExpectedCellValue(sheetName, 132, 26, null),
					new ExpectedCellValue(sheetName, 133, 26, null),
					new ExpectedCellValue(sheetName, 134, 26, null),
					new ExpectedCellValue(sheetName, 135, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 26, null),
					new ExpectedCellValue(sheetName, 137, 26, null),
					new ExpectedCellValue(sheetName, 138, 26, null),
					new ExpectedCellValue(sheetName, 139, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 140, 26, null),
					new ExpectedCellValue(sheetName, 141, 26, null),
					new ExpectedCellValue(sheetName, 142, 26, null),
					new ExpectedCellValue(sheetName, 143, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 144, 26, null),
					new ExpectedCellValue(sheetName, 145, 26, null),
					new ExpectedCellValue(sheetName, 146, 26, null),
					new ExpectedCellValue(sheetName, 147, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 148, 26, null),
					new ExpectedCellValue(sheetName, 149, 26, null),
					new ExpectedCellValue(sheetName, 120, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 27, 831.5),
					new ExpectedCellValue(sheetName, 122, 27, 831.5),
					new ExpectedCellValue(sheetName, 123, 27, 831.5),
					new ExpectedCellValue(sheetName, 124, 27, 831.5),
					new ExpectedCellValue(sheetName, 125, 27, 831.5),
					new ExpectedCellValue(sheetName, 126, 27, 831.5),
					new ExpectedCellValue(sheetName, 127, 27, 831.5),
					new ExpectedCellValue(sheetName, 128, 27, 831.5),
					new ExpectedCellValue(sheetName, 129, 27, 1194d),
					new ExpectedCellValue(sheetName, 130, 27, 1194d),
					new ExpectedCellValue(sheetName, 131, 27, 1194d),
					new ExpectedCellValue(sheetName, 132, 27, 1194d),
					new ExpectedCellValue(sheetName, 133, 27, 415.75),
					new ExpectedCellValue(sheetName, 134, 27, 415.75),
					new ExpectedCellValue(sheetName, 135, 27, 415.75),
					new ExpectedCellValue(sheetName, 136, 27, 415.75),
					new ExpectedCellValue(sheetName, 137, 27, 24.99),
					new ExpectedCellValue(sheetName, 138, 27, 24.99),
					new ExpectedCellValue(sheetName, 139, 27, 24.99),
					new ExpectedCellValue(sheetName, 140, 27, 24.99),
					new ExpectedCellValue(sheetName, 141, 27, 99d),
					new ExpectedCellValue(sheetName, 142, 27, 99d),
					new ExpectedCellValue(sheetName, 143, 27, 99d),
					new ExpectedCellValue(sheetName, 144, 27, 99d),
					new ExpectedCellValue(sheetName, 145, 27, 831.5),
					new ExpectedCellValue(sheetName, 146, 27, 831.5),
					new ExpectedCellValue(sheetName, 147, 27, 831.5),
					new ExpectedCellValue(sheetName, 148, 27, 831.5),
					new ExpectedCellValue(sheetName, 149, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstFieldNonCompactSecondThirdAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W120:AA163"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 23, 20100007),
					new ExpectedCellValue(sheetName, 122, 23, null),
					new ExpectedCellValue(sheetName, 123, 23, null),
					new ExpectedCellValue(sheetName, 124, 23, null),
					new ExpectedCellValue(sheetName, 125, 23, null),
					new ExpectedCellValue(sheetName, 126, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 127, 23, 20100017),
					new ExpectedCellValue(sheetName, 128, 23, null),
					new ExpectedCellValue(sheetName, 129, 23, null),
					new ExpectedCellValue(sheetName, 130, 23, null),
					new ExpectedCellValue(sheetName, 131, 23, null),
					new ExpectedCellValue(sheetName, 132, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 133, 23, 20100070),
					new ExpectedCellValue(sheetName, 134, 23, null),
					new ExpectedCellValue(sheetName, 135, 23, null),
					new ExpectedCellValue(sheetName, 136, 23, null),
					new ExpectedCellValue(sheetName, 137, 23, null),
					new ExpectedCellValue(sheetName, 138, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 139, 23, 20100076),
					new ExpectedCellValue(sheetName, 140, 23, null),
					new ExpectedCellValue(sheetName, 141, 23, null),
					new ExpectedCellValue(sheetName, 142, 23, null),
					new ExpectedCellValue(sheetName, 143, 23, null),
					new ExpectedCellValue(sheetName, 144, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 145, 23, 20100083),
					new ExpectedCellValue(sheetName, 146, 23, null),
					new ExpectedCellValue(sheetName, 147, 23, null),
					new ExpectedCellValue(sheetName, 148, 23, null),
					new ExpectedCellValue(sheetName, 149, 23, null),
					new ExpectedCellValue(sheetName, 150, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 23, 20100085),
					new ExpectedCellValue(sheetName, 152, 23, null),
					new ExpectedCellValue(sheetName, 153, 23, null),
					new ExpectedCellValue(sheetName, 154, 23, null),
					new ExpectedCellValue(sheetName, 155, 23, null),
					new ExpectedCellValue(sheetName, 156, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 157, 23, 20100090),
					new ExpectedCellValue(sheetName, 158, 23, null),
					new ExpectedCellValue(sheetName, 159, 23, null),
					new ExpectedCellValue(sheetName, 160, 23, null),
					new ExpectedCellValue(sheetName, 161, 23, null),
					new ExpectedCellValue(sheetName, 162, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 163, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 24, "Location"),
					new ExpectedCellValue(sheetName, 121, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 24, null),
					new ExpectedCellValue(sheetName, 123, 24, null),
					new ExpectedCellValue(sheetName, 124, 24, null),
					new ExpectedCellValue(sheetName, 125, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 126, 24, null),
					new ExpectedCellValue(sheetName, 127, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 24, null),
					new ExpectedCellValue(sheetName, 129, 24, null),
					new ExpectedCellValue(sheetName, 130, 24, null),
					new ExpectedCellValue(sheetName, 131, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 132, 24, null),
					new ExpectedCellValue(sheetName, 133, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 134, 24, null),
					new ExpectedCellValue(sheetName, 135, 24, null),
					new ExpectedCellValue(sheetName, 136, 24, null),
					new ExpectedCellValue(sheetName, 137, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 138, 24, null),
					new ExpectedCellValue(sheetName, 139, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 140, 24, null),
					new ExpectedCellValue(sheetName, 141, 24, null),
					new ExpectedCellValue(sheetName, 142, 24, null),
					new ExpectedCellValue(sheetName, 143, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 144, 24, null),
					new ExpectedCellValue(sheetName, 145, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 24, null),
					new ExpectedCellValue(sheetName, 147, 24, null),
					new ExpectedCellValue(sheetName, 148, 24, null),
					new ExpectedCellValue(sheetName, 149, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 24, null),
					new ExpectedCellValue(sheetName, 151, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 152, 24, null),
					new ExpectedCellValue(sheetName, 153, 24, null),
					new ExpectedCellValue(sheetName, 154, 24, null),
					new ExpectedCellValue(sheetName, 155, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 156, 24, null),
					new ExpectedCellValue(sheetName, 157, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 158, 24, null),
					new ExpectedCellValue(sheetName, 159, 24, null),
					new ExpectedCellValue(sheetName, 160, 24, null),
					new ExpectedCellValue(sheetName, 161, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 162, 24, null),
					new ExpectedCellValue(sheetName, 163, 24, null),
					new ExpectedCellValue(sheetName, 120, 25, "Month"),
					new ExpectedCellValue(sheetName, 121, 25, null),
					new ExpectedCellValue(sheetName, 122, 25, "January"),
					new ExpectedCellValue(sheetName, 123, 25, null),
					new ExpectedCellValue(sheetName, 124, 25, "January Total"),
					new ExpectedCellValue(sheetName, 125, 25, null),
					new ExpectedCellValue(sheetName, 126, 25, null),
					new ExpectedCellValue(sheetName, 127, 25, null),
					new ExpectedCellValue(sheetName, 128, 25, "March"),
					new ExpectedCellValue(sheetName, 129, 25, null),
					new ExpectedCellValue(sheetName, 130, 25, "March Total"),
					new ExpectedCellValue(sheetName, 131, 25, null),
					new ExpectedCellValue(sheetName, 132, 25, null),
					new ExpectedCellValue(sheetName, 133, 25, null),
					new ExpectedCellValue(sheetName, 134, 25, "February"),
					new ExpectedCellValue(sheetName, 135, 25, null),
					new ExpectedCellValue(sheetName, 136, 25, "February Total"),
					new ExpectedCellValue(sheetName, 137, 25, null),
					new ExpectedCellValue(sheetName, 138, 25, null),
					new ExpectedCellValue(sheetName, 139, 25, null),
					new ExpectedCellValue(sheetName, 140, 25, "January"),
					new ExpectedCellValue(sheetName, 141, 25, null),
					new ExpectedCellValue(sheetName, 142, 25, "January Total"),
					new ExpectedCellValue(sheetName, 143, 25, null),
					new ExpectedCellValue(sheetName, 144, 25, null),
					new ExpectedCellValue(sheetName, 145, 25, null),
					new ExpectedCellValue(sheetName, 146, 25, "March"),
					new ExpectedCellValue(sheetName, 147, 25, null),
					new ExpectedCellValue(sheetName, 148, 25, "March Total"),
					new ExpectedCellValue(sheetName, 149, 25, null),
					new ExpectedCellValue(sheetName, 150, 25, null),
					new ExpectedCellValue(sheetName, 151, 25, null),
					new ExpectedCellValue(sheetName, 152, 25, "February"),
					new ExpectedCellValue(sheetName, 153, 25, null),
					new ExpectedCellValue(sheetName, 154, 25, "February Total"),
					new ExpectedCellValue(sheetName, 155, 25, null),
					new ExpectedCellValue(sheetName, 156, 25, null),
					new ExpectedCellValue(sheetName, 157, 25, null),
					new ExpectedCellValue(sheetName, 158, 25, "January"),
					new ExpectedCellValue(sheetName, 159, 25, null),
					new ExpectedCellValue(sheetName, 160, 25, "January Total"),
					new ExpectedCellValue(sheetName, 161, 25, null),
					new ExpectedCellValue(sheetName, 162, 25, null),
					new ExpectedCellValue(sheetName, 163, 25, null),
					new ExpectedCellValue(sheetName, 120, 26, "Item"),
					new ExpectedCellValue(sheetName, 121, 26, null),
					new ExpectedCellValue(sheetName, 122, 26, null),
					new ExpectedCellValue(sheetName, 123, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 26, null),
					new ExpectedCellValue(sheetName, 125, 26, null),
					new ExpectedCellValue(sheetName, 126, 26, null),
					new ExpectedCellValue(sheetName, 127, 26, null),
					new ExpectedCellValue(sheetName, 128, 26, null),
					new ExpectedCellValue(sheetName, 129, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 130, 26, null),
					new ExpectedCellValue(sheetName, 131, 26, null),
					new ExpectedCellValue(sheetName, 132, 26, null),
					new ExpectedCellValue(sheetName, 133, 26, null),
					new ExpectedCellValue(sheetName, 134, 26, null),
					new ExpectedCellValue(sheetName, 135, 26, "Tent"),
					new ExpectedCellValue(sheetName, 136, 26, null),
					new ExpectedCellValue(sheetName, 137, 26, null),
					new ExpectedCellValue(sheetName, 138, 26, null),
					new ExpectedCellValue(sheetName, 139, 26, null),
					new ExpectedCellValue(sheetName, 140, 26, null),
					new ExpectedCellValue(sheetName, 141, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 26, null),
					new ExpectedCellValue(sheetName, 143, 26, null),
					new ExpectedCellValue(sheetName, 144, 26, null),
					new ExpectedCellValue(sheetName, 145, 26, null),
					new ExpectedCellValue(sheetName, 146, 26, null),
					new ExpectedCellValue(sheetName, 147, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 26, null),
					new ExpectedCellValue(sheetName, 149, 26, null),
					new ExpectedCellValue(sheetName, 150, 26, null),
					new ExpectedCellValue(sheetName, 151, 26, null),
					new ExpectedCellValue(sheetName, 152, 26, null),
					new ExpectedCellValue(sheetName, 153, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 154, 26, null),
					new ExpectedCellValue(sheetName, 155, 26, null),
					new ExpectedCellValue(sheetName, 156, 26, null),
					new ExpectedCellValue(sheetName, 157, 26, null),
					new ExpectedCellValue(sheetName, 158, 26, null),
					new ExpectedCellValue(sheetName, 159, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 160, 26, null),
					new ExpectedCellValue(sheetName, 161, 26, null),
					new ExpectedCellValue(sheetName, 162, 26, null),
					new ExpectedCellValue(sheetName, 163, 26, null),
					new ExpectedCellValue(sheetName, 120, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 27, null),
					new ExpectedCellValue(sheetName, 122, 27, null),
					new ExpectedCellValue(sheetName, 123, 27, 831.5),
					new ExpectedCellValue(sheetName, 124, 27, 831.5),
					new ExpectedCellValue(sheetName, 125, 27, 831.5),
					new ExpectedCellValue(sheetName, 126, 27, 831.5),
					new ExpectedCellValue(sheetName, 127, 27, null),
					new ExpectedCellValue(sheetName, 128, 27, null),
					new ExpectedCellValue(sheetName, 129, 27, 831.5),
					new ExpectedCellValue(sheetName, 130, 27, 831.5),
					new ExpectedCellValue(sheetName, 131, 27, 831.5),
					new ExpectedCellValue(sheetName, 132, 27, 831.5),
					new ExpectedCellValue(sheetName, 133, 27, null),
					new ExpectedCellValue(sheetName, 134, 27, null),
					new ExpectedCellValue(sheetName, 135, 27, 1194d),
					new ExpectedCellValue(sheetName, 136, 27, 1194d),
					new ExpectedCellValue(sheetName, 137, 27, 1194d),
					new ExpectedCellValue(sheetName, 138, 27, 1194d),
					new ExpectedCellValue(sheetName, 139, 27, null),
					new ExpectedCellValue(sheetName, 140, 27, null),
					new ExpectedCellValue(sheetName, 141, 27, 415.75),
					new ExpectedCellValue(sheetName, 142, 27, 415.75),
					new ExpectedCellValue(sheetName, 143, 27, 415.75),
					new ExpectedCellValue(sheetName, 144, 27, 415.75),
					new ExpectedCellValue(sheetName, 145, 27, null),
					new ExpectedCellValue(sheetName, 146, 27, null),
					new ExpectedCellValue(sheetName, 147, 27, 24.99),
					new ExpectedCellValue(sheetName, 148, 27, 24.99),
					new ExpectedCellValue(sheetName, 149, 27, 24.99),
					new ExpectedCellValue(sheetName, 150, 27, 24.99),
					new ExpectedCellValue(sheetName, 151, 27, null),
					new ExpectedCellValue(sheetName, 152, 27, null),
					new ExpectedCellValue(sheetName, 153, 27, 99d),
					new ExpectedCellValue(sheetName, 154, 27, 99d),
					new ExpectedCellValue(sheetName, 155, 27, 99d),
					new ExpectedCellValue(sheetName, 156, 27, 99d),
					new ExpectedCellValue(sheetName, 157, 27, null),
					new ExpectedCellValue(sheetName, 158, 27, null),
					new ExpectedCellValue(sheetName, 159, 27, 831.5),
					new ExpectedCellValue(sheetName, 160, 27, 831.5),
					new ExpectedCellValue(sheetName, 161, 27, 831.5),
					new ExpectedCellValue(sheetName, 162, 27, 831.5),
					new ExpectedCellValue(sheetName, 163, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndLastFieldsNonCompactSecondAndThirdFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD120:AH142"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 30, 20100007),
					new ExpectedCellValue(sheetName, 122, 30, null),
					new ExpectedCellValue(sheetName, 123, 30, null),
					new ExpectedCellValue(sheetName, 124, 30, 20100017),
					new ExpectedCellValue(sheetName, 125, 30, null),
					new ExpectedCellValue(sheetName, 126, 30, null),
					new ExpectedCellValue(sheetName, 127, 30, 20100070),
					new ExpectedCellValue(sheetName, 128, 30, null),
					new ExpectedCellValue(sheetName, 129, 30, null),
					new ExpectedCellValue(sheetName, 130, 30, 20100076),
					new ExpectedCellValue(sheetName, 131, 30, null),
					new ExpectedCellValue(sheetName, 132, 30, null),
					new ExpectedCellValue(sheetName, 133, 30, 20100083),
					new ExpectedCellValue(sheetName, 134, 30, null),
					new ExpectedCellValue(sheetName, 135, 30, null),
					new ExpectedCellValue(sheetName, 136, 30, 20100085),
					new ExpectedCellValue(sheetName, 137, 30, null),
					new ExpectedCellValue(sheetName, 138, 30, null),
					new ExpectedCellValue(sheetName, 139, 30, 20100090),
					new ExpectedCellValue(sheetName, 140, 30, null),
					new ExpectedCellValue(sheetName, 141, 30, null),
					new ExpectedCellValue(sheetName, 142, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 31, "Location"),
					new ExpectedCellValue(sheetName, 121, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 31, null),
					new ExpectedCellValue(sheetName, 123, 31, null),
					new ExpectedCellValue(sheetName, 124, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 125, 31, null),
					new ExpectedCellValue(sheetName, 126, 31, null),
					new ExpectedCellValue(sheetName, 127, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 31, null),
					new ExpectedCellValue(sheetName, 129, 31, null),
					new ExpectedCellValue(sheetName, 130, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 131, 31, null),
					new ExpectedCellValue(sheetName, 132, 31, null),
					new ExpectedCellValue(sheetName, 133, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 134, 31, null),
					new ExpectedCellValue(sheetName, 135, 31, null),
					new ExpectedCellValue(sheetName, 136, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 137, 31, null),
					new ExpectedCellValue(sheetName, 138, 31, null),
					new ExpectedCellValue(sheetName, 139, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 140, 31, null),
					new ExpectedCellValue(sheetName, 141, 31, null),
					new ExpectedCellValue(sheetName, 142, 31, null),
					new ExpectedCellValue(sheetName, 120, 32, "Month"),
					new ExpectedCellValue(sheetName, 121, 32, null),
					new ExpectedCellValue(sheetName, 122, 32, "January"),
					new ExpectedCellValue(sheetName, 123, 32, null),
					new ExpectedCellValue(sheetName, 124, 32, null),
					new ExpectedCellValue(sheetName, 125, 32, "March"),
					new ExpectedCellValue(sheetName, 126, 32, null),
					new ExpectedCellValue(sheetName, 127, 32, null),
					new ExpectedCellValue(sheetName, 128, 32, "February"),
					new ExpectedCellValue(sheetName, 129, 32, null),
					new ExpectedCellValue(sheetName, 130, 32, null),
					new ExpectedCellValue(sheetName, 131, 32, "January"),
					new ExpectedCellValue(sheetName, 132, 32, null),
					new ExpectedCellValue(sheetName, 133, 32, null),
					new ExpectedCellValue(sheetName, 134, 32, "March"),
					new ExpectedCellValue(sheetName, 135, 32, null),
					new ExpectedCellValue(sheetName, 136, 32, null),
					new ExpectedCellValue(sheetName, 137, 32, "February"),
					new ExpectedCellValue(sheetName, 138, 32, null),
					new ExpectedCellValue(sheetName, 139, 32, null),
					new ExpectedCellValue(sheetName, 140, 32, "January"),
					new ExpectedCellValue(sheetName, 141, 32, null),
					new ExpectedCellValue(sheetName, 142, 32, null),
					new ExpectedCellValue(sheetName, 120, 33, "Item"),
					new ExpectedCellValue(sheetName, 121, 33, null),
					new ExpectedCellValue(sheetName, 122, 33, null),
					new ExpectedCellValue(sheetName, 123, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 33, null),
					new ExpectedCellValue(sheetName, 125, 33, null),
					new ExpectedCellValue(sheetName, 126, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 33, null),
					new ExpectedCellValue(sheetName, 128, 33, null),
					new ExpectedCellValue(sheetName, 129, 33, "Tent"),
					new ExpectedCellValue(sheetName, 130, 33, null),
					new ExpectedCellValue(sheetName, 131, 33, null),
					new ExpectedCellValue(sheetName, 132, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 133, 33, null),
					new ExpectedCellValue(sheetName, 134, 33, null),
					new ExpectedCellValue(sheetName, 135, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 136, 33, null),
					new ExpectedCellValue(sheetName, 137, 33, null),
					new ExpectedCellValue(sheetName, 138, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 139, 33, null),
					new ExpectedCellValue(sheetName, 140, 33, null),
					new ExpectedCellValue(sheetName, 141, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 33, null),
					new ExpectedCellValue(sheetName, 120, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 34, null),
					new ExpectedCellValue(sheetName, 122, 34, null),
					new ExpectedCellValue(sheetName, 123, 34, 831.5),
					new ExpectedCellValue(sheetName, 124, 34, null),
					new ExpectedCellValue(sheetName, 125, 34, null),
					new ExpectedCellValue(sheetName, 126, 34, 831.5),
					new ExpectedCellValue(sheetName, 127, 34, null),
					new ExpectedCellValue(sheetName, 128, 34, null),
					new ExpectedCellValue(sheetName, 129, 34, 1194d),
					new ExpectedCellValue(sheetName, 130, 34, null),
					new ExpectedCellValue(sheetName, 131, 34, null),
					new ExpectedCellValue(sheetName, 132, 34, 415.75),
					new ExpectedCellValue(sheetName, 133, 34, null),
					new ExpectedCellValue(sheetName, 134, 34, null),
					new ExpectedCellValue(sheetName, 135, 34, 24.99),
					new ExpectedCellValue(sheetName, 136, 34, null),
					new ExpectedCellValue(sheetName, 137, 34, null),
					new ExpectedCellValue(sheetName, 138, 34, 99d),
					new ExpectedCellValue(sheetName, 139, 34, null),
					new ExpectedCellValue(sheetName, 140, 34, null),
					new ExpectedCellValue(sheetName, 141, 34, 831.5),
					new ExpectedCellValue(sheetName, 142, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndLastFieldsNonCompactSecondAndThirdFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD120:AH149"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 30, 20100007),
					new ExpectedCellValue(sheetName, 122, 30, null),
					new ExpectedCellValue(sheetName, 123, 30, null),
					new ExpectedCellValue(sheetName, 124, 30, "20100007 Total"),
					new ExpectedCellValue(sheetName, 125, 30, 20100017),
					new ExpectedCellValue(sheetName, 126, 30, null),
					new ExpectedCellValue(sheetName, 127, 30, null),
					new ExpectedCellValue(sheetName, 128, 30, "20100017 Total"),
					new ExpectedCellValue(sheetName, 129, 30, 20100070),
					new ExpectedCellValue(sheetName, 130, 30, null),
					new ExpectedCellValue(sheetName, 131, 30, null),
					new ExpectedCellValue(sheetName, 132, 30, "20100070 Total"),
					new ExpectedCellValue(sheetName, 133, 30, 20100076),
					new ExpectedCellValue(sheetName, 134, 30, null),
					new ExpectedCellValue(sheetName, 135, 30, null),
					new ExpectedCellValue(sheetName, 136, 30, "20100076 Total"),
					new ExpectedCellValue(sheetName, 137, 30, 20100083),
					new ExpectedCellValue(sheetName, 138, 30, null),
					new ExpectedCellValue(sheetName, 139, 30, null),
					new ExpectedCellValue(sheetName, 140, 30, "20100083 Total"),
					new ExpectedCellValue(sheetName, 141, 30, 20100085),
					new ExpectedCellValue(sheetName, 142, 30, null),
					new ExpectedCellValue(sheetName, 143, 30, null),
					new ExpectedCellValue(sheetName, 144, 30, "20100085 Total"),
					new ExpectedCellValue(sheetName, 145, 30, 20100090),
					new ExpectedCellValue(sheetName, 146, 30, null),
					new ExpectedCellValue(sheetName, 147, 30, null),
					new ExpectedCellValue(sheetName, 148, 30, "20100090 Total"),
					new ExpectedCellValue(sheetName, 149, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 31, "Location"),
					new ExpectedCellValue(sheetName, 121, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 31, null),
					new ExpectedCellValue(sheetName, 123, 31, null),
					new ExpectedCellValue(sheetName, 124, 31, null),
					new ExpectedCellValue(sheetName, 125, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 31, null),
					new ExpectedCellValue(sheetName, 127, 31, null),
					new ExpectedCellValue(sheetName, 128, 31, null),
					new ExpectedCellValue(sheetName, 129, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 130, 31, null),
					new ExpectedCellValue(sheetName, 131, 31, null),
					new ExpectedCellValue(sheetName, 132, 31, null),
					new ExpectedCellValue(sheetName, 133, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 134, 31, null),
					new ExpectedCellValue(sheetName, 135, 31, null),
					new ExpectedCellValue(sheetName, 136, 31, null),
					new ExpectedCellValue(sheetName, 137, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 138, 31, null),
					new ExpectedCellValue(sheetName, 139, 31, null),
					new ExpectedCellValue(sheetName, 140, 31, null),
					new ExpectedCellValue(sheetName, 141, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 142, 31, null),
					new ExpectedCellValue(sheetName, 143, 31, null),
					new ExpectedCellValue(sheetName, 144, 31, null),
					new ExpectedCellValue(sheetName, 145, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 146, 31, null),
					new ExpectedCellValue(sheetName, 147, 31, null),
					new ExpectedCellValue(sheetName, 148, 31, null),
					new ExpectedCellValue(sheetName, 149, 31, null),
					new ExpectedCellValue(sheetName, 120, 32, "Month"),
					new ExpectedCellValue(sheetName, 121, 32, null),
					new ExpectedCellValue(sheetName, 122, 32, "January"),
					new ExpectedCellValue(sheetName, 123, 32, null),
					new ExpectedCellValue(sheetName, 124, 32, null),
					new ExpectedCellValue(sheetName, 125, 32, null),
					new ExpectedCellValue(sheetName, 126, 32, "March"),
					new ExpectedCellValue(sheetName, 127, 32, null),
					new ExpectedCellValue(sheetName, 128, 32, null),
					new ExpectedCellValue(sheetName, 129, 32, null),
					new ExpectedCellValue(sheetName, 130, 32, "February"),
					new ExpectedCellValue(sheetName, 131, 32, null),
					new ExpectedCellValue(sheetName, 132, 32, null),
					new ExpectedCellValue(sheetName, 133, 32, null),
					new ExpectedCellValue(sheetName, 134, 32, "January"),
					new ExpectedCellValue(sheetName, 135, 32, null),
					new ExpectedCellValue(sheetName, 136, 32, null),
					new ExpectedCellValue(sheetName, 137, 32, null),
					new ExpectedCellValue(sheetName, 138, 32, "March"),
					new ExpectedCellValue(sheetName, 139, 32, null),
					new ExpectedCellValue(sheetName, 140, 32, null),
					new ExpectedCellValue(sheetName, 141, 32, null),
					new ExpectedCellValue(sheetName, 142, 32, "February"),
					new ExpectedCellValue(sheetName, 143, 32, null),
					new ExpectedCellValue(sheetName, 144, 32, null),
					new ExpectedCellValue(sheetName, 145, 32, null),
					new ExpectedCellValue(sheetName, 146, 32, "January"),
					new ExpectedCellValue(sheetName, 147, 32, null),
					new ExpectedCellValue(sheetName, 148, 32, null),
					new ExpectedCellValue(sheetName, 149, 32, null),
					new ExpectedCellValue(sheetName, 120, 33, "Item"),
					new ExpectedCellValue(sheetName, 121, 33, null),
					new ExpectedCellValue(sheetName, 122, 33, null),
					new ExpectedCellValue(sheetName, 123, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 33, null),
					new ExpectedCellValue(sheetName, 125, 33, null),
					new ExpectedCellValue(sheetName, 126, 33, null),
					new ExpectedCellValue(sheetName, 127, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 128, 33, null),
					new ExpectedCellValue(sheetName, 129, 33, null),
					new ExpectedCellValue(sheetName, 130, 33, null),
					new ExpectedCellValue(sheetName, 131, 33, "Tent"),
					new ExpectedCellValue(sheetName, 132, 33, null),
					new ExpectedCellValue(sheetName, 133, 33, null),
					new ExpectedCellValue(sheetName, 134, 33, null),
					new ExpectedCellValue(sheetName, 135, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 33, null),
					new ExpectedCellValue(sheetName, 137, 33, null),
					new ExpectedCellValue(sheetName, 138, 33, null),
					new ExpectedCellValue(sheetName, 139, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 140, 33, null),
					new ExpectedCellValue(sheetName, 141, 33, null),
					new ExpectedCellValue(sheetName, 142, 33, null),
					new ExpectedCellValue(sheetName, 143, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 144, 33, null),
					new ExpectedCellValue(sheetName, 145, 33, null),
					new ExpectedCellValue(sheetName, 146, 33, null),
					new ExpectedCellValue(sheetName, 147, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 148, 33, null),
					new ExpectedCellValue(sheetName, 149, 33, null),
					new ExpectedCellValue(sheetName, 120, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 34, 831.5),
					new ExpectedCellValue(sheetName, 122, 34, 831.5),
					new ExpectedCellValue(sheetName, 123, 34, 831.5),
					new ExpectedCellValue(sheetName, 124, 34, 831.5),
					new ExpectedCellValue(sheetName, 125, 34, 831.5),
					new ExpectedCellValue(sheetName, 126, 34, 831.5),
					new ExpectedCellValue(sheetName, 127, 34, 831.5),
					new ExpectedCellValue(sheetName, 128, 34, 831.5),
					new ExpectedCellValue(sheetName, 129, 34, 1194d),
					new ExpectedCellValue(sheetName, 130, 34, 1194d),
					new ExpectedCellValue(sheetName, 131, 34, 1194d),
					new ExpectedCellValue(sheetName, 132, 34, 1194d),
					new ExpectedCellValue(sheetName, 133, 34, 415.75),
					new ExpectedCellValue(sheetName, 134, 34, 415.75),
					new ExpectedCellValue(sheetName, 135, 34, 415.75),
					new ExpectedCellValue(sheetName, 136, 34, 415.75),
					new ExpectedCellValue(sheetName, 137, 34, 24.99),
					new ExpectedCellValue(sheetName, 138, 34, 24.99),
					new ExpectedCellValue(sheetName, 139, 34, 24.99),
					new ExpectedCellValue(sheetName, 140, 34, 24.99),
					new ExpectedCellValue(sheetName, 141, 34, 99d),
					new ExpectedCellValue(sheetName, 142, 34, 99d),
					new ExpectedCellValue(sheetName, 143, 34, 99d),
					new ExpectedCellValue(sheetName, 144, 34, 99d),
					new ExpectedCellValue(sheetName, 145, 34, 831.5),
					new ExpectedCellValue(sheetName, 146, 34, 831.5),
					new ExpectedCellValue(sheetName, 147, 34, 831.5),
					new ExpectedCellValue(sheetName, 148, 34, 831.5),
					new ExpectedCellValue(sheetName, 149, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndLastFieldsNonCompactSecondAndThirdFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD120:AH163"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 120, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 121, 30, 20100007),
					new ExpectedCellValue(sheetName, 122, 30, null),
					new ExpectedCellValue(sheetName, 123, 30, null),
					new ExpectedCellValue(sheetName, 124, 30, null),
					new ExpectedCellValue(sheetName, 125, 30, null),
					new ExpectedCellValue(sheetName, 126, 30, "20100007 Total"),
					new ExpectedCellValue(sheetName, 127, 30, 20100017),
					new ExpectedCellValue(sheetName, 128, 30, null),
					new ExpectedCellValue(sheetName, 129, 30, null),
					new ExpectedCellValue(sheetName, 130, 30, null),
					new ExpectedCellValue(sheetName, 131, 30, null),
					new ExpectedCellValue(sheetName, 132, 30, "20100017 Total"),
					new ExpectedCellValue(sheetName, 133, 30, 20100070),
					new ExpectedCellValue(sheetName, 134, 30, null),
					new ExpectedCellValue(sheetName, 135, 30, null),
					new ExpectedCellValue(sheetName, 136, 30, null),
					new ExpectedCellValue(sheetName, 137, 30, null),
					new ExpectedCellValue(sheetName, 138, 30, "20100070 Total"),
					new ExpectedCellValue(sheetName, 139, 30, 20100076),
					new ExpectedCellValue(sheetName, 140, 30, null),
					new ExpectedCellValue(sheetName, 141, 30, null),
					new ExpectedCellValue(sheetName, 142, 30, null),
					new ExpectedCellValue(sheetName, 143, 30, null),
					new ExpectedCellValue(sheetName, 144, 30, "20100076 Total"),
					new ExpectedCellValue(sheetName, 145, 30, 20100083),
					new ExpectedCellValue(sheetName, 146, 30, null),
					new ExpectedCellValue(sheetName, 147, 30, null),
					new ExpectedCellValue(sheetName, 148, 30, null),
					new ExpectedCellValue(sheetName, 149, 30, null),
					new ExpectedCellValue(sheetName, 150, 30, "20100083 Total"),
					new ExpectedCellValue(sheetName, 151, 30, 20100085),
					new ExpectedCellValue(sheetName, 152, 30, null),
					new ExpectedCellValue(sheetName, 153, 30, null),
					new ExpectedCellValue(sheetName, 154, 30, null),
					new ExpectedCellValue(sheetName, 155, 30, null),
					new ExpectedCellValue(sheetName, 156, 30, "20100085 Total"),
					new ExpectedCellValue(sheetName, 157, 30, 20100090),
					new ExpectedCellValue(sheetName, 158, 30, null),
					new ExpectedCellValue(sheetName, 159, 30, null),
					new ExpectedCellValue(sheetName, 160, 30, null),
					new ExpectedCellValue(sheetName, 161, 30, null),
					new ExpectedCellValue(sheetName, 162, 30, "20100090 Total"),
					new ExpectedCellValue(sheetName, 163, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 120, 31, "Location"),
					new ExpectedCellValue(sheetName, 121, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 122, 31, null),
					new ExpectedCellValue(sheetName, 123, 31, null),
					new ExpectedCellValue(sheetName, 124, 31, null),
					new ExpectedCellValue(sheetName, 125, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 126, 31, null),
					new ExpectedCellValue(sheetName, 127, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 31, null),
					new ExpectedCellValue(sheetName, 129, 31, null),
					new ExpectedCellValue(sheetName, 130, 31, null),
					new ExpectedCellValue(sheetName, 131, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 132, 31, null),
					new ExpectedCellValue(sheetName, 133, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 134, 31, null),
					new ExpectedCellValue(sheetName, 135, 31, null),
					new ExpectedCellValue(sheetName, 136, 31, null),
					new ExpectedCellValue(sheetName, 137, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 138, 31, null),
					new ExpectedCellValue(sheetName, 139, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 140, 31, null),
					new ExpectedCellValue(sheetName, 141, 31, null),
					new ExpectedCellValue(sheetName, 142, 31, null),
					new ExpectedCellValue(sheetName, 143, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 144, 31, null),
					new ExpectedCellValue(sheetName, 145, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 146, 31, null),
					new ExpectedCellValue(sheetName, 147, 31, null),
					new ExpectedCellValue(sheetName, 148, 31, null),
					new ExpectedCellValue(sheetName, 149, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 150, 31, null),
					new ExpectedCellValue(sheetName, 151, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 152, 31, null),
					new ExpectedCellValue(sheetName, 153, 31, null),
					new ExpectedCellValue(sheetName, 154, 31, null),
					new ExpectedCellValue(sheetName, 155, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 156, 31, null),
					new ExpectedCellValue(sheetName, 157, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 158, 31, null),
					new ExpectedCellValue(sheetName, 159, 31, null),
					new ExpectedCellValue(sheetName, 160, 31, null),
					new ExpectedCellValue(sheetName, 161, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 162, 31, null),
					new ExpectedCellValue(sheetName, 163, 31, null),
					new ExpectedCellValue(sheetName, 120, 32, "Month"),
					new ExpectedCellValue(sheetName, 121, 32, null),
					new ExpectedCellValue(sheetName, 122, 32, "January"),
					new ExpectedCellValue(sheetName, 123, 32, null),
					new ExpectedCellValue(sheetName, 124, 32, "January Total"),
					new ExpectedCellValue(sheetName, 125, 32, null),
					new ExpectedCellValue(sheetName, 126, 32, null),
					new ExpectedCellValue(sheetName, 127, 32, null),
					new ExpectedCellValue(sheetName, 128, 32, "March"),
					new ExpectedCellValue(sheetName, 129, 32, null),
					new ExpectedCellValue(sheetName, 130, 32, "March Total"),
					new ExpectedCellValue(sheetName, 131, 32, null),
					new ExpectedCellValue(sheetName, 132, 32, null),
					new ExpectedCellValue(sheetName, 133, 32, null),
					new ExpectedCellValue(sheetName, 134, 32, "February"),
					new ExpectedCellValue(sheetName, 135, 32, null),
					new ExpectedCellValue(sheetName, 136, 32, "February Total"),
					new ExpectedCellValue(sheetName, 137, 32, null),
					new ExpectedCellValue(sheetName, 138, 32, null),
					new ExpectedCellValue(sheetName, 139, 32, null),
					new ExpectedCellValue(sheetName, 140, 32, "January"),
					new ExpectedCellValue(sheetName, 141, 32, null),
					new ExpectedCellValue(sheetName, 142, 32, "January Total"),
					new ExpectedCellValue(sheetName, 143, 32, null),
					new ExpectedCellValue(sheetName, 144, 32, null),
					new ExpectedCellValue(sheetName, 145, 32, null),
					new ExpectedCellValue(sheetName, 146, 32, "March"),
					new ExpectedCellValue(sheetName, 147, 32, null),
					new ExpectedCellValue(sheetName, 148, 32, "March Total"),
					new ExpectedCellValue(sheetName, 149, 32, null),
					new ExpectedCellValue(sheetName, 150, 32, null),
					new ExpectedCellValue(sheetName, 151, 32, null),
					new ExpectedCellValue(sheetName, 152, 32, "February"),
					new ExpectedCellValue(sheetName, 153, 32, null),
					new ExpectedCellValue(sheetName, 154, 32, "February Total"),
					new ExpectedCellValue(sheetName, 155, 32, null),
					new ExpectedCellValue(sheetName, 156, 32, null),
					new ExpectedCellValue(sheetName, 157, 32, null),
					new ExpectedCellValue(sheetName, 158, 32, "January"),
					new ExpectedCellValue(sheetName, 159, 32, null),
					new ExpectedCellValue(sheetName, 160, 32, "January Total"),
					new ExpectedCellValue(sheetName, 161, 32, null),
					new ExpectedCellValue(sheetName, 162, 32, null),
					new ExpectedCellValue(sheetName, 163, 32, null),
					new ExpectedCellValue(sheetName, 120, 33, "Item"),
					new ExpectedCellValue(sheetName, 121, 33, null),
					new ExpectedCellValue(sheetName, 122, 33, null),
					new ExpectedCellValue(sheetName, 123, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 124, 33, null),
					new ExpectedCellValue(sheetName, 125, 33, null),
					new ExpectedCellValue(sheetName, 126, 33, null),
					new ExpectedCellValue(sheetName, 127, 33, null),
					new ExpectedCellValue(sheetName, 128, 33, null),
					new ExpectedCellValue(sheetName, 129, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 130, 33, null),
					new ExpectedCellValue(sheetName, 131, 33, null),
					new ExpectedCellValue(sheetName, 132, 33, null),
					new ExpectedCellValue(sheetName, 133, 33, null),
					new ExpectedCellValue(sheetName, 134, 33, null),
					new ExpectedCellValue(sheetName, 135, 33, "Tent"),
					new ExpectedCellValue(sheetName, 136, 33, null),
					new ExpectedCellValue(sheetName, 137, 33, null),
					new ExpectedCellValue(sheetName, 138, 33, null),
					new ExpectedCellValue(sheetName, 139, 33, null),
					new ExpectedCellValue(sheetName, 140, 33, null),
					new ExpectedCellValue(sheetName, 141, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 33, null),
					new ExpectedCellValue(sheetName, 143, 33, null),
					new ExpectedCellValue(sheetName, 144, 33, null),
					new ExpectedCellValue(sheetName, 145, 33, null),
					new ExpectedCellValue(sheetName, 146, 33, null),
					new ExpectedCellValue(sheetName, 147, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 148, 33, null),
					new ExpectedCellValue(sheetName, 149, 33, null),
					new ExpectedCellValue(sheetName, 150, 33, null),
					new ExpectedCellValue(sheetName, 151, 33, null),
					new ExpectedCellValue(sheetName, 152, 33, null),
					new ExpectedCellValue(sheetName, 153, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 154, 33, null),
					new ExpectedCellValue(sheetName, 155, 33, null),
					new ExpectedCellValue(sheetName, 156, 33, null),
					new ExpectedCellValue(sheetName, 157, 33, null),
					new ExpectedCellValue(sheetName, 158, 33, null),
					new ExpectedCellValue(sheetName, 159, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 160, 33, null),
					new ExpectedCellValue(sheetName, 161, 33, null),
					new ExpectedCellValue(sheetName, 162, 33, null),
					new ExpectedCellValue(sheetName, 163, 33, null),
					new ExpectedCellValue(sheetName, 120, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 34, null),
					new ExpectedCellValue(sheetName, 122, 34, null),
					new ExpectedCellValue(sheetName, 123, 34, 831.5),
					new ExpectedCellValue(sheetName, 124, 34, 831.5),
					new ExpectedCellValue(sheetName, 125, 34, 831.5),
					new ExpectedCellValue(sheetName, 126, 34, 831.5),
					new ExpectedCellValue(sheetName, 127, 34, null),
					new ExpectedCellValue(sheetName, 128, 34, null),
					new ExpectedCellValue(sheetName, 129, 34, 831.5),
					new ExpectedCellValue(sheetName, 130, 34, 831.5),
					new ExpectedCellValue(sheetName, 131, 34, 831.5),
					new ExpectedCellValue(sheetName, 132, 34, 831.5),
					new ExpectedCellValue(sheetName, 133, 34, null),
					new ExpectedCellValue(sheetName, 134, 34, null),
					new ExpectedCellValue(sheetName, 135, 34, 1194d),
					new ExpectedCellValue(sheetName, 136, 34, 1194d),
					new ExpectedCellValue(sheetName, 137, 34, 1194d),
					new ExpectedCellValue(sheetName, 138, 34, 1194d),
					new ExpectedCellValue(sheetName, 139, 34, null),
					new ExpectedCellValue(sheetName, 140, 34, null),
					new ExpectedCellValue(sheetName, 141, 34, 415.75),
					new ExpectedCellValue(sheetName, 142, 34, 415.75),
					new ExpectedCellValue(sheetName, 143, 34, 415.75),
					new ExpectedCellValue(sheetName, 144, 34, 415.75),
					new ExpectedCellValue(sheetName, 145, 34, null),
					new ExpectedCellValue(sheetName, 146, 34, null),
					new ExpectedCellValue(sheetName, 147, 34, 24.99),
					new ExpectedCellValue(sheetName, 148, 34, 24.99),
					new ExpectedCellValue(sheetName, 149, 34, 24.99),
					new ExpectedCellValue(sheetName, 150, 34, 24.99),
					new ExpectedCellValue(sheetName, 151, 34, null),
					new ExpectedCellValue(sheetName, 152, 34, null),
					new ExpectedCellValue(sheetName, 153, 34, 99d),
					new ExpectedCellValue(sheetName, 154, 34, 99d),
					new ExpectedCellValue(sheetName, 155, 34, 99d),
					new ExpectedCellValue(sheetName, 156, 34, 99d),
					new ExpectedCellValue(sheetName, 157, 34, null),
					new ExpectedCellValue(sheetName, 158, 34, null),
					new ExpectedCellValue(sheetName, 159, 34, 831.5),
					new ExpectedCellValue(sheetName, 160, 34, 831.5),
					new ExpectedCellValue(sheetName, 161, 34, 831.5),
					new ExpectedCellValue(sheetName, 162, 34, 831.5),
					new ExpectedCellValue(sheetName, 163, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndThirdFieldsNonCompactSecondAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P170:T185"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 16, 20100007),
					new ExpectedCellValue(sheetName, 172, 16, null),
					new ExpectedCellValue(sheetName, 173, 16, 20100017),
					new ExpectedCellValue(sheetName, 174, 16, null),
					new ExpectedCellValue(sheetName, 175, 16, 20100070),
					new ExpectedCellValue(sheetName, 176, 16, null),
					new ExpectedCellValue(sheetName, 177, 16, 20100076),
					new ExpectedCellValue(sheetName, 178, 16, null),
					new ExpectedCellValue(sheetName, 179, 16, 20100083),
					new ExpectedCellValue(sheetName, 180, 16, null),
					new ExpectedCellValue(sheetName, 181, 16, 20100085),
					new ExpectedCellValue(sheetName, 182, 16, null),
					new ExpectedCellValue(sheetName, 183, 16, 20100090),
					new ExpectedCellValue(sheetName, 184, 16, null),
					new ExpectedCellValue(sheetName, 185, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 17, "Location"),
					new ExpectedCellValue(sheetName, 171, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 17, null),
					new ExpectedCellValue(sheetName, 173, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 174, 17, null),
					new ExpectedCellValue(sheetName, 175, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 176, 17, null),
					new ExpectedCellValue(sheetName, 177, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 178, 17, null),
					new ExpectedCellValue(sheetName, 179, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 180, 17, null),
					new ExpectedCellValue(sheetName, 181, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 184, 17, null),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 170, 18, "Month"),
					new ExpectedCellValue(sheetName, 171, 18, null),
					new ExpectedCellValue(sheetName, 172, 18, "January"),
					new ExpectedCellValue(sheetName, 173, 18, null),
					new ExpectedCellValue(sheetName, 174, 18, "March"),
					new ExpectedCellValue(sheetName, 175, 18, null),
					new ExpectedCellValue(sheetName, 176, 18, "February"),
					new ExpectedCellValue(sheetName, 177, 18, null),
					new ExpectedCellValue(sheetName, 178, 18, "January"),
					new ExpectedCellValue(sheetName, 179, 18, null),
					new ExpectedCellValue(sheetName, 180, 18, "March"),
					new ExpectedCellValue(sheetName, 181, 18, null),
					new ExpectedCellValue(sheetName, 182, 18, "February"),
					new ExpectedCellValue(sheetName, 183, 18, null),
					new ExpectedCellValue(sheetName, 184, 18, "January"),
					new ExpectedCellValue(sheetName, 185, 18, null),
					new ExpectedCellValue(sheetName, 170, 19, "Item"),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 174, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 175, 19, null),
					new ExpectedCellValue(sheetName, 176, 19, "Tent"),
					new ExpectedCellValue(sheetName, 177, 19, null),
					new ExpectedCellValue(sheetName, 178, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 179, 19, null),
					new ExpectedCellValue(sheetName, 180, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 183, 19, null),
					new ExpectedCellValue(sheetName, 184, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 19, null),
					new ExpectedCellValue(sheetName, 170, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 20, null),
					new ExpectedCellValue(sheetName, 172, 20, 831.5),
					new ExpectedCellValue(sheetName, 173, 20, null),
					new ExpectedCellValue(sheetName, 174, 20, 831.5),
					new ExpectedCellValue(sheetName, 175, 20, null),
					new ExpectedCellValue(sheetName, 176, 20, 1194d),
					new ExpectedCellValue(sheetName, 177, 20, null),
					new ExpectedCellValue(sheetName, 178, 20, 415.75),
					new ExpectedCellValue(sheetName, 179, 20, null),
					new ExpectedCellValue(sheetName, 180, 20, 24.99),
					new ExpectedCellValue(sheetName, 181, 20, null),
					new ExpectedCellValue(sheetName, 182, 20, 99d),
					new ExpectedCellValue(sheetName, 183, 20, null),
					new ExpectedCellValue(sheetName, 184, 20, 831.5),
					new ExpectedCellValue(sheetName, 185, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndThirdFieldsNonCompactSecondAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P170:T199"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 16, 20100007),
					new ExpectedCellValue(sheetName, 172, 16, null),
					new ExpectedCellValue(sheetName, 173, 16, null),
					new ExpectedCellValue(sheetName, 174, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 175, 16, 20100017),
					new ExpectedCellValue(sheetName, 176, 16, null),
					new ExpectedCellValue(sheetName, 177, 16, null),
					new ExpectedCellValue(sheetName, 178, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 179, 16, 20100070),
					new ExpectedCellValue(sheetName, 180, 16, null),
					new ExpectedCellValue(sheetName, 181, 16, null),
					new ExpectedCellValue(sheetName, 182, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 183, 16, 20100076),
					new ExpectedCellValue(sheetName, 184, 16, null),
					new ExpectedCellValue(sheetName, 185, 16, null),
					new ExpectedCellValue(sheetName, 186, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 187, 16, 20100083),
					new ExpectedCellValue(sheetName, 188, 16, null),
					new ExpectedCellValue(sheetName, 189, 16, null),
					new ExpectedCellValue(sheetName, 190, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 191, 16, 20100085),
					new ExpectedCellValue(sheetName, 192, 16, null),
					new ExpectedCellValue(sheetName, 193, 16, null),
					new ExpectedCellValue(sheetName, 194, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 195, 16, 20100090),
					new ExpectedCellValue(sheetName, 196, 16, null),
					new ExpectedCellValue(sheetName, 197, 16, null),
					new ExpectedCellValue(sheetName, 198, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 199, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 17, "Location"),
					new ExpectedCellValue(sheetName, 171, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 17, null),
					new ExpectedCellValue(sheetName, 173, 17, null),
					new ExpectedCellValue(sheetName, 174, 17, null),
					new ExpectedCellValue(sheetName, 175, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 176, 17, null),
					new ExpectedCellValue(sheetName, 177, 17, null),
					new ExpectedCellValue(sheetName, 178, 17, null),
					new ExpectedCellValue(sheetName, 179, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 180, 17, null),
					new ExpectedCellValue(sheetName, 181, 17, null),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 184, 17, null),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 186, 17, null),
					new ExpectedCellValue(sheetName, 187, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 188, 17, null),
					new ExpectedCellValue(sheetName, 189, 17, null),
					new ExpectedCellValue(sheetName, 190, 17, null),
					new ExpectedCellValue(sheetName, 191, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 192, 17, null),
					new ExpectedCellValue(sheetName, 193, 17, null),
					new ExpectedCellValue(sheetName, 194, 17, null),
					new ExpectedCellValue(sheetName, 195, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 17, null),
					new ExpectedCellValue(sheetName, 197, 17, null),
					new ExpectedCellValue(sheetName, 198, 17, null),
					new ExpectedCellValue(sheetName, 199, 17, null),
					new ExpectedCellValue(sheetName, 170, 18, "Month"),
					new ExpectedCellValue(sheetName, 171, 18, null),
					new ExpectedCellValue(sheetName, 172, 18, "January"),
					new ExpectedCellValue(sheetName, 173, 18, "January Total"),
					new ExpectedCellValue(sheetName, 174, 18, null),
					new ExpectedCellValue(sheetName, 175, 18, null),
					new ExpectedCellValue(sheetName, 176, 18, "March"),
					new ExpectedCellValue(sheetName, 177, 18, "March Total"),
					new ExpectedCellValue(sheetName, 178, 18, null),
					new ExpectedCellValue(sheetName, 179, 18, null),
					new ExpectedCellValue(sheetName, 180, 18, "February"),
					new ExpectedCellValue(sheetName, 181, 18, "February Total"),
					new ExpectedCellValue(sheetName, 182, 18, null),
					new ExpectedCellValue(sheetName, 183, 18, null),
					new ExpectedCellValue(sheetName, 184, 18, "January"),
					new ExpectedCellValue(sheetName, 185, 18, "January Total"),
					new ExpectedCellValue(sheetName, 186, 18, null),
					new ExpectedCellValue(sheetName, 187, 18, null),
					new ExpectedCellValue(sheetName, 188, 18, "March"),
					new ExpectedCellValue(sheetName, 189, 18, "March Total"),
					new ExpectedCellValue(sheetName, 190, 18, null),
					new ExpectedCellValue(sheetName, 191, 18, null),
					new ExpectedCellValue(sheetName, 192, 18, "February"),
					new ExpectedCellValue(sheetName, 193, 18, "February Total"),
					new ExpectedCellValue(sheetName, 194, 18, null),
					new ExpectedCellValue(sheetName, 195, 18, null),
					new ExpectedCellValue(sheetName, 196, 18, "January"),
					new ExpectedCellValue(sheetName, 197, 18, "January Total"),
					new ExpectedCellValue(sheetName, 198, 18, null),
					new ExpectedCellValue(sheetName, 199, 18, null),
					new ExpectedCellValue(sheetName, 170, 19, "Item"),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 174, 19, null),
					new ExpectedCellValue(sheetName, 175, 19, null),
					new ExpectedCellValue(sheetName, 176, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 177, 19, null),
					new ExpectedCellValue(sheetName, 178, 19, null),
					new ExpectedCellValue(sheetName, 179, 19, null),
					new ExpectedCellValue(sheetName, 180, 19, "Tent"),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, null),
					new ExpectedCellValue(sheetName, 183, 19, null),
					new ExpectedCellValue(sheetName, 184, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 19, null),
					new ExpectedCellValue(sheetName, 186, 19, null),
					new ExpectedCellValue(sheetName, 187, 19, null),
					new ExpectedCellValue(sheetName, 188, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 19, null),
					new ExpectedCellValue(sheetName, 190, 19, null),
					new ExpectedCellValue(sheetName, 191, 19, null),
					new ExpectedCellValue(sheetName, 192, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 193, 19, null),
					new ExpectedCellValue(sheetName, 194, 19, null),
					new ExpectedCellValue(sheetName, 195, 19, null),
					new ExpectedCellValue(sheetName, 196, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 19, null),
					new ExpectedCellValue(sheetName, 198, 19, null),
					new ExpectedCellValue(sheetName, 199, 19, null),
					new ExpectedCellValue(sheetName, 170, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 20, 831.5),
					new ExpectedCellValue(sheetName, 172, 20, 831.5),
					new ExpectedCellValue(sheetName, 173, 20, 831.5),
					new ExpectedCellValue(sheetName, 174, 20, 831.5),
					new ExpectedCellValue(sheetName, 175, 20, 831.5),
					new ExpectedCellValue(sheetName, 176, 20, 831.5),
					new ExpectedCellValue(sheetName, 177, 20, 831.5),
					new ExpectedCellValue(sheetName, 178, 20, 831.5),
					new ExpectedCellValue(sheetName, 179, 20, 1194d),
					new ExpectedCellValue(sheetName, 180, 20, 1194d),
					new ExpectedCellValue(sheetName, 181, 20, 1194d),
					new ExpectedCellValue(sheetName, 182, 20, 1194d),
					new ExpectedCellValue(sheetName, 183, 20, 415.75),
					new ExpectedCellValue(sheetName, 184, 20, 415.75),
					new ExpectedCellValue(sheetName, 185, 20, 415.75),
					new ExpectedCellValue(sheetName, 186, 20, 415.75),
					new ExpectedCellValue(sheetName, 187, 20, 24.99),
					new ExpectedCellValue(sheetName, 188, 20, 24.99),
					new ExpectedCellValue(sheetName, 189, 20, 24.99),
					new ExpectedCellValue(sheetName, 190, 20, 24.99),
					new ExpectedCellValue(sheetName, 191, 20, 99d),
					new ExpectedCellValue(sheetName, 192, 20, 99d),
					new ExpectedCellValue(sheetName, 193, 20, 99d),
					new ExpectedCellValue(sheetName, 194, 20, 99d),
					new ExpectedCellValue(sheetName, 195, 20, 831.5),
					new ExpectedCellValue(sheetName, 196, 20, 831.5),
					new ExpectedCellValue(sheetName, 197, 20, 831.5),
					new ExpectedCellValue(sheetName, 198, 20, 831.5),
					new ExpectedCellValue(sheetName, 199, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndThirdFieldsNonCompactSecondAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P170:T206"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 16, 20100007),
					new ExpectedCellValue(sheetName, 172, 16, null),
					new ExpectedCellValue(sheetName, 173, 16, null),
					new ExpectedCellValue(sheetName, 174, 16, null),
					new ExpectedCellValue(sheetName, 175, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 176, 16, 20100017),
					new ExpectedCellValue(sheetName, 177, 16, null),
					new ExpectedCellValue(sheetName, 178, 16, null),
					new ExpectedCellValue(sheetName, 179, 16, null),
					new ExpectedCellValue(sheetName, 180, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 181, 16, 20100070),
					new ExpectedCellValue(sheetName, 182, 16, null),
					new ExpectedCellValue(sheetName, 183, 16, null),
					new ExpectedCellValue(sheetName, 184, 16, null),
					new ExpectedCellValue(sheetName, 185, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 186, 16, 20100076),
					new ExpectedCellValue(sheetName, 187, 16, null),
					new ExpectedCellValue(sheetName, 188, 16, null),
					new ExpectedCellValue(sheetName, 189, 16, null),
					new ExpectedCellValue(sheetName, 190, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 191, 16, 20100083),
					new ExpectedCellValue(sheetName, 192, 16, null),
					new ExpectedCellValue(sheetName, 193, 16, null),
					new ExpectedCellValue(sheetName, 194, 16, null),
					new ExpectedCellValue(sheetName, 195, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 196, 16, 20100085),
					new ExpectedCellValue(sheetName, 197, 16, null),
					new ExpectedCellValue(sheetName, 198, 16, null),
					new ExpectedCellValue(sheetName, 199, 16, null),
					new ExpectedCellValue(sheetName, 200, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 201, 16, 20100090),
					new ExpectedCellValue(sheetName, 202, 16, null),
					new ExpectedCellValue(sheetName, 203, 16, null),
					new ExpectedCellValue(sheetName, 204, 16, null),
					new ExpectedCellValue(sheetName, 205, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 206, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 17, "Location"),
					new ExpectedCellValue(sheetName, 171, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 17, null),
					new ExpectedCellValue(sheetName, 173, 17, null),
					new ExpectedCellValue(sheetName, 174, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 175, 17, null),
					new ExpectedCellValue(sheetName, 176, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 177, 17, null),
					new ExpectedCellValue(sheetName, 178, 17, null),
					new ExpectedCellValue(sheetName, 179, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 180, 17, null),
					new ExpectedCellValue(sheetName, 181, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, null),
					new ExpectedCellValue(sheetName, 184, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 186, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 187, 17, null),
					new ExpectedCellValue(sheetName, 188, 17, null),
					new ExpectedCellValue(sheetName, 189, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 190, 17, null),
					new ExpectedCellValue(sheetName, 191, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 192, 17, null),
					new ExpectedCellValue(sheetName, 193, 17, null),
					new ExpectedCellValue(sheetName, 194, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 195, 17, null),
					new ExpectedCellValue(sheetName, 196, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 197, 17, null),
					new ExpectedCellValue(sheetName, 198, 17, null),
					new ExpectedCellValue(sheetName, 199, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 200, 17, null),
					new ExpectedCellValue(sheetName, 201, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 202, 17, null),
					new ExpectedCellValue(sheetName, 203, 17, null),
					new ExpectedCellValue(sheetName, 204, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 205, 17, null),
					new ExpectedCellValue(sheetName, 206, 17, null),
					new ExpectedCellValue(sheetName, 170, 18, "Month"),
					new ExpectedCellValue(sheetName, 171, 18, null),
					new ExpectedCellValue(sheetName, 172, 18, "January"),
					new ExpectedCellValue(sheetName, 173, 18, "January Total"),
					new ExpectedCellValue(sheetName, 174, 18, null),
					new ExpectedCellValue(sheetName, 175, 18, null),
					new ExpectedCellValue(sheetName, 176, 18, null),
					new ExpectedCellValue(sheetName, 177, 18, "March"),
					new ExpectedCellValue(sheetName, 178, 18, "March Total"),
					new ExpectedCellValue(sheetName, 179, 18, null),
					new ExpectedCellValue(sheetName, 180, 18, null),
					new ExpectedCellValue(sheetName, 181, 18, null),
					new ExpectedCellValue(sheetName, 182, 18, "February"),
					new ExpectedCellValue(sheetName, 183, 18, "February Total"),
					new ExpectedCellValue(sheetName, 184, 18, null),
					new ExpectedCellValue(sheetName, 185, 18, null),
					new ExpectedCellValue(sheetName, 186, 18, null),
					new ExpectedCellValue(sheetName, 187, 18, "January"),
					new ExpectedCellValue(sheetName, 188, 18, "January Total"),
					new ExpectedCellValue(sheetName, 189, 18, null),
					new ExpectedCellValue(sheetName, 190, 18, null),
					new ExpectedCellValue(sheetName, 191, 18, null),
					new ExpectedCellValue(sheetName, 192, 18, "March"),
					new ExpectedCellValue(sheetName, 193, 18, "March Total"),
					new ExpectedCellValue(sheetName, 194, 18, null),
					new ExpectedCellValue(sheetName, 195, 18, null),
					new ExpectedCellValue(sheetName, 196, 18, null),
					new ExpectedCellValue(sheetName, 197, 18, "February"),
					new ExpectedCellValue(sheetName, 198, 18, "February Total"),
					new ExpectedCellValue(sheetName, 199, 18, null),
					new ExpectedCellValue(sheetName, 200, 18, null),
					new ExpectedCellValue(sheetName, 201, 18, null),
					new ExpectedCellValue(sheetName, 202, 18, "January"),
					new ExpectedCellValue(sheetName, 203, 18, "January Total"),
					new ExpectedCellValue(sheetName, 204, 18, null),
					new ExpectedCellValue(sheetName, 205, 18, null),
					new ExpectedCellValue(sheetName, 206, 18, null),
					new ExpectedCellValue(sheetName, 170, 19, "Item"),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 174, 19, null),
					new ExpectedCellValue(sheetName, 175, 19, null),
					new ExpectedCellValue(sheetName, 176, 19, null),
					new ExpectedCellValue(sheetName, 177, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 178, 19, null),
					new ExpectedCellValue(sheetName, 179, 19, null),
					new ExpectedCellValue(sheetName, 180, 19, null),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, "Tent"),
					new ExpectedCellValue(sheetName, 183, 19, null),
					new ExpectedCellValue(sheetName, 184, 19, null),
					new ExpectedCellValue(sheetName, 185, 19, null),
					new ExpectedCellValue(sheetName, 186, 19, null),
					new ExpectedCellValue(sheetName, 187, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 188, 19, null),
					new ExpectedCellValue(sheetName, 189, 19, null),
					new ExpectedCellValue(sheetName, 190, 19, null),
					new ExpectedCellValue(sheetName, 191, 19, null),
					new ExpectedCellValue(sheetName, 192, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 193, 19, null),
					new ExpectedCellValue(sheetName, 194, 19, null),
					new ExpectedCellValue(sheetName, 195, 19, null),
					new ExpectedCellValue(sheetName, 196, 19, null),
					new ExpectedCellValue(sheetName, 197, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 198, 19, null),
					new ExpectedCellValue(sheetName, 199, 19, null),
					new ExpectedCellValue(sheetName, 200, 19, null),
					new ExpectedCellValue(sheetName, 201, 19, null),
					new ExpectedCellValue(sheetName, 202, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 203, 19, null),
					new ExpectedCellValue(sheetName, 204, 19, null),
					new ExpectedCellValue(sheetName, 205, 19, null),
					new ExpectedCellValue(sheetName, 206, 19, null),
					new ExpectedCellValue(sheetName, 170, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 20, null),
					new ExpectedCellValue(sheetName, 172, 20, 831.5),
					new ExpectedCellValue(sheetName, 173, 20, 831.5),
					new ExpectedCellValue(sheetName, 174, 20, 831.5),
					new ExpectedCellValue(sheetName, 175, 20, 831.5),
					new ExpectedCellValue(sheetName, 176, 20, null),
					new ExpectedCellValue(sheetName, 177, 20, 831.5),
					new ExpectedCellValue(sheetName, 178, 20, 831.5),
					new ExpectedCellValue(sheetName, 179, 20, 831.5),
					new ExpectedCellValue(sheetName, 180, 20, 831.5),
					new ExpectedCellValue(sheetName, 181, 20, null),
					new ExpectedCellValue(sheetName, 182, 20, 1194d),
					new ExpectedCellValue(sheetName, 183, 20, 1194d),
					new ExpectedCellValue(sheetName, 184, 20, 1194d),
					new ExpectedCellValue(sheetName, 185, 20, 1194d),
					new ExpectedCellValue(sheetName, 186, 20, null),
					new ExpectedCellValue(sheetName, 187, 20, 415.75),
					new ExpectedCellValue(sheetName, 188, 20, 415.75),
					new ExpectedCellValue(sheetName, 189, 20, 415.75),
					new ExpectedCellValue(sheetName, 190, 20, 415.75),
					new ExpectedCellValue(sheetName, 191, 20, null),
					new ExpectedCellValue(sheetName, 192, 20, 24.99),
					new ExpectedCellValue(sheetName, 193, 20, 24.99),
					new ExpectedCellValue(sheetName, 194, 20, 24.99),
					new ExpectedCellValue(sheetName, 195, 20, 24.99),
					new ExpectedCellValue(sheetName, 196, 20, null),
					new ExpectedCellValue(sheetName, 197, 20, 99d),
					new ExpectedCellValue(sheetName, 198, 20, 99d),
					new ExpectedCellValue(sheetName, 199, 20, 99d),
					new ExpectedCellValue(sheetName, 200, 20, 99d),
					new ExpectedCellValue(sheetName, 201, 20, null),
					new ExpectedCellValue(sheetName, 202, 20, 831.5),
					new ExpectedCellValue(sheetName, 203, 20, 831.5),
					new ExpectedCellValue(sheetName, 204, 20, 831.5),
					new ExpectedCellValue(sheetName, 205, 20, 831.5),
					new ExpectedCellValue(sheetName, 206, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstThirdAndLastFieldsNonCompactSecondFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W170:AA185"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 16, 20100007),
					new ExpectedCellValue(sheetName, 172, 16, null),
					new ExpectedCellValue(sheetName, 173, 16, 20100017),
					new ExpectedCellValue(sheetName, 174, 16, null),
					new ExpectedCellValue(sheetName, 175, 16, 20100070),
					new ExpectedCellValue(sheetName, 176, 16, null),
					new ExpectedCellValue(sheetName, 177, 16, 20100076),
					new ExpectedCellValue(sheetName, 178, 16, null),
					new ExpectedCellValue(sheetName, 179, 16, 20100083),
					new ExpectedCellValue(sheetName, 180, 16, null),
					new ExpectedCellValue(sheetName, 181, 16, 20100085),
					new ExpectedCellValue(sheetName, 182, 16, null),
					new ExpectedCellValue(sheetName, 183, 16, 20100090),
					new ExpectedCellValue(sheetName, 184, 16, null),
					new ExpectedCellValue(sheetName, 185, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 17, "Location"),
					new ExpectedCellValue(sheetName, 171, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 17, null),
					new ExpectedCellValue(sheetName, 173, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 174, 17, null),
					new ExpectedCellValue(sheetName, 175, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 176, 17, null),
					new ExpectedCellValue(sheetName, 177, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 178, 17, null),
					new ExpectedCellValue(sheetName, 179, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 180, 17, null),
					new ExpectedCellValue(sheetName, 181, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 184, 17, null),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 170, 18, "Month"),
					new ExpectedCellValue(sheetName, 171, 18, null),
					new ExpectedCellValue(sheetName, 172, 18, "January"),
					new ExpectedCellValue(sheetName, 173, 18, null),
					new ExpectedCellValue(sheetName, 174, 18, "March"),
					new ExpectedCellValue(sheetName, 175, 18, null),
					new ExpectedCellValue(sheetName, 176, 18, "February"),
					new ExpectedCellValue(sheetName, 177, 18, null),
					new ExpectedCellValue(sheetName, 178, 18, "January"),
					new ExpectedCellValue(sheetName, 179, 18, null),
					new ExpectedCellValue(sheetName, 180, 18, "March"),
					new ExpectedCellValue(sheetName, 181, 18, null),
					new ExpectedCellValue(sheetName, 182, 18, "February"),
					new ExpectedCellValue(sheetName, 183, 18, null),
					new ExpectedCellValue(sheetName, 184, 18, "January"),
					new ExpectedCellValue(sheetName, 185, 18, null),
					new ExpectedCellValue(sheetName, 170, 19, "Item"),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 174, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 175, 19, null),
					new ExpectedCellValue(sheetName, 176, 19, "Tent"),
					new ExpectedCellValue(sheetName, 177, 19, null),
					new ExpectedCellValue(sheetName, 178, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 179, 19, null),
					new ExpectedCellValue(sheetName, 180, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 183, 19, null),
					new ExpectedCellValue(sheetName, 184, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 19, null),
					new ExpectedCellValue(sheetName, 170, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 20, null),
					new ExpectedCellValue(sheetName, 172, 20, 831.5),
					new ExpectedCellValue(sheetName, 173, 20, null),
					new ExpectedCellValue(sheetName, 174, 20, 831.5),
					new ExpectedCellValue(sheetName, 175, 20, null),
					new ExpectedCellValue(sheetName, 176, 20, 1194d),
					new ExpectedCellValue(sheetName, 177, 20, null),
					new ExpectedCellValue(sheetName, 178, 20, 415.75),
					new ExpectedCellValue(sheetName, 179, 20, null),
					new ExpectedCellValue(sheetName, 180, 20, 24.99),
					new ExpectedCellValue(sheetName, 181, 20, null),
					new ExpectedCellValue(sheetName, 182, 20, 99d),
					new ExpectedCellValue(sheetName, 183, 20, null),
					new ExpectedCellValue(sheetName, 184, 20, 831.5),
					new ExpectedCellValue(sheetName, 185, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstThirdAndLastFieldsNonCompactSecondFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W170:AA199"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 23, 20100007),
					new ExpectedCellValue(sheetName, 172, 23, null),
					new ExpectedCellValue(sheetName, 173, 23, null),
					new ExpectedCellValue(sheetName, 174, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 175, 23, 20100017),
					new ExpectedCellValue(sheetName, 176, 23, null),
					new ExpectedCellValue(sheetName, 177, 23, null),
					new ExpectedCellValue(sheetName, 178, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 179, 23, 20100070),
					new ExpectedCellValue(sheetName, 180, 23, null),
					new ExpectedCellValue(sheetName, 181, 23, null),
					new ExpectedCellValue(sheetName, 182, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 183, 23, 20100076),
					new ExpectedCellValue(sheetName, 184, 23, null),
					new ExpectedCellValue(sheetName, 185, 23, null),
					new ExpectedCellValue(sheetName, 186, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 187, 23, 20100083),
					new ExpectedCellValue(sheetName, 188, 23, null),
					new ExpectedCellValue(sheetName, 189, 23, null),
					new ExpectedCellValue(sheetName, 190, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 191, 23, 20100085),
					new ExpectedCellValue(sheetName, 192, 23, null),
					new ExpectedCellValue(sheetName, 193, 23, null),
					new ExpectedCellValue(sheetName, 194, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 195, 23, 20100090),
					new ExpectedCellValue(sheetName, 196, 23, null),
					new ExpectedCellValue(sheetName, 197, 23, null),
					new ExpectedCellValue(sheetName, 198, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 199, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 24, "Location"),
					new ExpectedCellValue(sheetName, 171, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 24, null),
					new ExpectedCellValue(sheetName, 173, 24, null),
					new ExpectedCellValue(sheetName, 174, 24, null),
					new ExpectedCellValue(sheetName, 175, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 176, 24, null),
					new ExpectedCellValue(sheetName, 177, 24, null),
					new ExpectedCellValue(sheetName, 178, 24, null),
					new ExpectedCellValue(sheetName, 179, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 180, 24, null),
					new ExpectedCellValue(sheetName, 181, 24, null),
					new ExpectedCellValue(sheetName, 182, 24, null),
					new ExpectedCellValue(sheetName, 183, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 184, 24, null),
					new ExpectedCellValue(sheetName, 185, 24, null),
					new ExpectedCellValue(sheetName, 186, 24, null),
					new ExpectedCellValue(sheetName, 187, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 188, 24, null),
					new ExpectedCellValue(sheetName, 189, 24, null),
					new ExpectedCellValue(sheetName, 190, 24, null),
					new ExpectedCellValue(sheetName, 191, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 192, 24, null),
					new ExpectedCellValue(sheetName, 193, 24, null),
					new ExpectedCellValue(sheetName, 194, 24, null),
					new ExpectedCellValue(sheetName, 195, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 24, null),
					new ExpectedCellValue(sheetName, 197, 24, null),
					new ExpectedCellValue(sheetName, 198, 24, null),
					new ExpectedCellValue(sheetName, 199, 24, null),
					new ExpectedCellValue(sheetName, 170, 25, "Month"),
					new ExpectedCellValue(sheetName, 171, 25, null),
					new ExpectedCellValue(sheetName, 172, 25, "January"),
					new ExpectedCellValue(sheetName, 173, 25, "January Total"),
					new ExpectedCellValue(sheetName, 174, 25, null),
					new ExpectedCellValue(sheetName, 175, 25, null),
					new ExpectedCellValue(sheetName, 176, 25, "March"),
					new ExpectedCellValue(sheetName, 177, 25, "March Total"),
					new ExpectedCellValue(sheetName, 178, 25, null),
					new ExpectedCellValue(sheetName, 179, 25, null),
					new ExpectedCellValue(sheetName, 180, 25, "February"),
					new ExpectedCellValue(sheetName, 181, 25, "February Total"),
					new ExpectedCellValue(sheetName, 182, 25, null),
					new ExpectedCellValue(sheetName, 183, 25, null),
					new ExpectedCellValue(sheetName, 184, 25, "January"),
					new ExpectedCellValue(sheetName, 185, 25, "January Total"),
					new ExpectedCellValue(sheetName, 186, 25, null),
					new ExpectedCellValue(sheetName, 187, 25, null),
					new ExpectedCellValue(sheetName, 188, 25, "March"),
					new ExpectedCellValue(sheetName, 189, 25, "March Total"),
					new ExpectedCellValue(sheetName, 190, 25, null),
					new ExpectedCellValue(sheetName, 191, 25, null),
					new ExpectedCellValue(sheetName, 192, 25, "February"),
					new ExpectedCellValue(sheetName, 193, 25, "February Total"),
					new ExpectedCellValue(sheetName, 194, 25, null),
					new ExpectedCellValue(sheetName, 195, 25, null),
					new ExpectedCellValue(sheetName, 196, 25, "January"),
					new ExpectedCellValue(sheetName, 197, 25, "January Total"),
					new ExpectedCellValue(sheetName, 198, 25, null),
					new ExpectedCellValue(sheetName, 199, 25, null),
					new ExpectedCellValue(sheetName, 170, 26, "Item"),
					new ExpectedCellValue(sheetName, 171, 26, null),
					new ExpectedCellValue(sheetName, 172, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 26, null),
					new ExpectedCellValue(sheetName, 174, 26, null),
					new ExpectedCellValue(sheetName, 175, 26, null),
					new ExpectedCellValue(sheetName, 176, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 177, 26, null),
					new ExpectedCellValue(sheetName, 178, 26, null),
					new ExpectedCellValue(sheetName, 179, 26, null),
					new ExpectedCellValue(sheetName, 180, 26, "Tent"),
					new ExpectedCellValue(sheetName, 181, 26, null),
					new ExpectedCellValue(sheetName, 182, 26, null),
					new ExpectedCellValue(sheetName, 183, 26, null),
					new ExpectedCellValue(sheetName, 184, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 26, null),
					new ExpectedCellValue(sheetName, 186, 26, null),
					new ExpectedCellValue(sheetName, 187, 26, null),
					new ExpectedCellValue(sheetName, 188, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 26, null),
					new ExpectedCellValue(sheetName, 190, 26, null),
					new ExpectedCellValue(sheetName, 191, 26, null),
					new ExpectedCellValue(sheetName, 192, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 193, 26, null),
					new ExpectedCellValue(sheetName, 194, 26, null),
					new ExpectedCellValue(sheetName, 195, 26, null),
					new ExpectedCellValue(sheetName, 196, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 26, null),
					new ExpectedCellValue(sheetName, 198, 26, null),
					new ExpectedCellValue(sheetName, 199, 26, null),
					new ExpectedCellValue(sheetName, 170, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 27, 831.5),
					new ExpectedCellValue(sheetName, 172, 27, 831.5),
					new ExpectedCellValue(sheetName, 173, 27, 831.5),
					new ExpectedCellValue(sheetName, 174, 27, 831.5),
					new ExpectedCellValue(sheetName, 175, 27, 831.5),
					new ExpectedCellValue(sheetName, 176, 27, 831.5),
					new ExpectedCellValue(sheetName, 177, 27, 831.5),
					new ExpectedCellValue(sheetName, 178, 27, 831.5),
					new ExpectedCellValue(sheetName, 179, 27, 1194d),
					new ExpectedCellValue(sheetName, 180, 27, 1194d),
					new ExpectedCellValue(sheetName, 181, 27, 1194d),
					new ExpectedCellValue(sheetName, 182, 27, 1194d),
					new ExpectedCellValue(sheetName, 183, 27, 415.75),
					new ExpectedCellValue(sheetName, 184, 27, 415.75),
					new ExpectedCellValue(sheetName, 185, 27, 415.75),
					new ExpectedCellValue(sheetName, 186, 27, 415.75),
					new ExpectedCellValue(sheetName, 187, 27, 24.99),
					new ExpectedCellValue(sheetName, 188, 27, 24.99),
					new ExpectedCellValue(sheetName, 189, 27, 24.99),
					new ExpectedCellValue(sheetName, 190, 27, 24.99),
					new ExpectedCellValue(sheetName, 191, 27, 99d),
					new ExpectedCellValue(sheetName, 192, 27, 99d),
					new ExpectedCellValue(sheetName, 193, 27, 99d),
					new ExpectedCellValue(sheetName, 194, 27, 99d),
					new ExpectedCellValue(sheetName, 195, 27, 831.5),
					new ExpectedCellValue(sheetName, 196, 27, 831.5),
					new ExpectedCellValue(sheetName, 197, 27, 831.5),
					new ExpectedCellValue(sheetName, 198, 27, 831.5),
					new ExpectedCellValue(sheetName, 199, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstThirdAndLastFieldsNonCompactSecondFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W170:AA206"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 23, 20100007),
					new ExpectedCellValue(sheetName, 172, 23, null),
					new ExpectedCellValue(sheetName, 173, 23, null),
					new ExpectedCellValue(sheetName, 174, 23, null),
					new ExpectedCellValue(sheetName, 175, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 176, 23, 20100017),
					new ExpectedCellValue(sheetName, 177, 23, null),
					new ExpectedCellValue(sheetName, 178, 23, null),
					new ExpectedCellValue(sheetName, 179, 23, null),
					new ExpectedCellValue(sheetName, 180, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 181, 23, 20100070),
					new ExpectedCellValue(sheetName, 182, 23, null),
					new ExpectedCellValue(sheetName, 183, 23, null),
					new ExpectedCellValue(sheetName, 184, 23, null),
					new ExpectedCellValue(sheetName, 185, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 186, 23, 20100076),
					new ExpectedCellValue(sheetName, 187, 23, null),
					new ExpectedCellValue(sheetName, 188, 23, null),
					new ExpectedCellValue(sheetName, 189, 23, null),
					new ExpectedCellValue(sheetName, 190, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 191, 23, 20100083),
					new ExpectedCellValue(sheetName, 192, 23, null),
					new ExpectedCellValue(sheetName, 193, 23, null),
					new ExpectedCellValue(sheetName, 194, 23, null),
					new ExpectedCellValue(sheetName, 195, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 196, 23, 20100085),
					new ExpectedCellValue(sheetName, 197, 23, null),
					new ExpectedCellValue(sheetName, 198, 23, null),
					new ExpectedCellValue(sheetName, 199, 23, null),
					new ExpectedCellValue(sheetName, 200, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 201, 23, 20100090),
					new ExpectedCellValue(sheetName, 202, 23, null),
					new ExpectedCellValue(sheetName, 203, 23, null),
					new ExpectedCellValue(sheetName, 204, 23, null),
					new ExpectedCellValue(sheetName, 205, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 206, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 24, "Location"),
					new ExpectedCellValue(sheetName, 171, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 24, null),
					new ExpectedCellValue(sheetName, 173, 24, null),
					new ExpectedCellValue(sheetName, 174, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 175, 24, null),
					new ExpectedCellValue(sheetName, 176, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 177, 24, null),
					new ExpectedCellValue(sheetName, 178, 24, null),
					new ExpectedCellValue(sheetName, 179, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 180, 24, null),
					new ExpectedCellValue(sheetName, 181, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 182, 24, null),
					new ExpectedCellValue(sheetName, 183, 24, null),
					new ExpectedCellValue(sheetName, 184, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 185, 24, null),
					new ExpectedCellValue(sheetName, 186, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 187, 24, null),
					new ExpectedCellValue(sheetName, 188, 24, null),
					new ExpectedCellValue(sheetName, 189, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 190, 24, null),
					new ExpectedCellValue(sheetName, 191, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 192, 24, null),
					new ExpectedCellValue(sheetName, 193, 24, null),
					new ExpectedCellValue(sheetName, 194, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 195, 24, null),
					new ExpectedCellValue(sheetName, 196, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 197, 24, null),
					new ExpectedCellValue(sheetName, 198, 24, null),
					new ExpectedCellValue(sheetName, 199, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 200, 24, null),
					new ExpectedCellValue(sheetName, 201, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 202, 24, null),
					new ExpectedCellValue(sheetName, 203, 24, null),
					new ExpectedCellValue(sheetName, 204, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 205, 24, null),
					new ExpectedCellValue(sheetName, 206, 24, null),
					new ExpectedCellValue(sheetName, 170, 25, "Month"),
					new ExpectedCellValue(sheetName, 171, 25, null),
					new ExpectedCellValue(sheetName, 172, 25, "January"),
					new ExpectedCellValue(sheetName, 173, 25, "January Total"),
					new ExpectedCellValue(sheetName, 174, 25, null),
					new ExpectedCellValue(sheetName, 175, 25, null),
					new ExpectedCellValue(sheetName, 176, 25, null),
					new ExpectedCellValue(sheetName, 177, 25, "March"),
					new ExpectedCellValue(sheetName, 178, 25, "March Total"),
					new ExpectedCellValue(sheetName, 179, 25, null),
					new ExpectedCellValue(sheetName, 180, 25, null),
					new ExpectedCellValue(sheetName, 181, 25, null),
					new ExpectedCellValue(sheetName, 182, 25, "February"),
					new ExpectedCellValue(sheetName, 183, 25, "February Total"),
					new ExpectedCellValue(sheetName, 184, 25, null),
					new ExpectedCellValue(sheetName, 185, 25, null),
					new ExpectedCellValue(sheetName, 186, 25, null),
					new ExpectedCellValue(sheetName, 187, 25, "January"),
					new ExpectedCellValue(sheetName, 188, 25, "January Total"),
					new ExpectedCellValue(sheetName, 189, 25, null),
					new ExpectedCellValue(sheetName, 190, 25, null),
					new ExpectedCellValue(sheetName, 191, 25, null),
					new ExpectedCellValue(sheetName, 192, 25, "March"),
					new ExpectedCellValue(sheetName, 193, 25, "March Total"),
					new ExpectedCellValue(sheetName, 194, 25, null),
					new ExpectedCellValue(sheetName, 195, 25, null),
					new ExpectedCellValue(sheetName, 196, 25, null),
					new ExpectedCellValue(sheetName, 197, 25, "February"),
					new ExpectedCellValue(sheetName, 198, 25, "February Total"),
					new ExpectedCellValue(sheetName, 199, 25, null),
					new ExpectedCellValue(sheetName, 200, 25, null),
					new ExpectedCellValue(sheetName, 201, 25, null),
					new ExpectedCellValue(sheetName, 202, 25, "January"),
					new ExpectedCellValue(sheetName, 203, 25, "January Total"),
					new ExpectedCellValue(sheetName, 204, 25, null),
					new ExpectedCellValue(sheetName, 205, 25, null),
					new ExpectedCellValue(sheetName, 206, 25, null),
					new ExpectedCellValue(sheetName, 170, 26, "Item"),
					new ExpectedCellValue(sheetName, 171, 26, null),
					new ExpectedCellValue(sheetName, 172, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 26, null),
					new ExpectedCellValue(sheetName, 174, 26, null),
					new ExpectedCellValue(sheetName, 175, 26, null),
					new ExpectedCellValue(sheetName, 176, 26, null),
					new ExpectedCellValue(sheetName, 177, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 178, 26, null),
					new ExpectedCellValue(sheetName, 179, 26, null),
					new ExpectedCellValue(sheetName, 180, 26, null),
					new ExpectedCellValue(sheetName, 181, 26, null),
					new ExpectedCellValue(sheetName, 182, 26, "Tent"),
					new ExpectedCellValue(sheetName, 183, 26, null),
					new ExpectedCellValue(sheetName, 184, 26, null),
					new ExpectedCellValue(sheetName, 185, 26, null),
					new ExpectedCellValue(sheetName, 186, 26, null),
					new ExpectedCellValue(sheetName, 187, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 188, 26, null),
					new ExpectedCellValue(sheetName, 189, 26, null),
					new ExpectedCellValue(sheetName, 190, 26, null),
					new ExpectedCellValue(sheetName, 191, 26, null),
					new ExpectedCellValue(sheetName, 192, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 193, 26, null),
					new ExpectedCellValue(sheetName, 194, 26, null),
					new ExpectedCellValue(sheetName, 195, 26, null),
					new ExpectedCellValue(sheetName, 196, 26, null),
					new ExpectedCellValue(sheetName, 197, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 198, 26, null),
					new ExpectedCellValue(sheetName, 199, 26, null),
					new ExpectedCellValue(sheetName, 200, 26, null),
					new ExpectedCellValue(sheetName, 201, 26, null),
					new ExpectedCellValue(sheetName, 202, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 203, 26, null),
					new ExpectedCellValue(sheetName, 204, 26, null),
					new ExpectedCellValue(sheetName, 205, 26, null),
					new ExpectedCellValue(sheetName, 206, 26, null),
					new ExpectedCellValue(sheetName, 170, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 27, null),
					new ExpectedCellValue(sheetName, 172, 27, 831.5),
					new ExpectedCellValue(sheetName, 173, 27, 831.5),
					new ExpectedCellValue(sheetName, 174, 27, 831.5),
					new ExpectedCellValue(sheetName, 175, 27, 831.5),
					new ExpectedCellValue(sheetName, 176, 27, null),
					new ExpectedCellValue(sheetName, 177, 27, 831.5),
					new ExpectedCellValue(sheetName, 178, 27, 831.5),
					new ExpectedCellValue(sheetName, 179, 27, 831.5),
					new ExpectedCellValue(sheetName, 180, 27, 831.5),
					new ExpectedCellValue(sheetName, 181, 27, null),
					new ExpectedCellValue(sheetName, 182, 27, 1194d),
					new ExpectedCellValue(sheetName, 183, 27, 1194d),
					new ExpectedCellValue(sheetName, 184, 27, 1194d),
					new ExpectedCellValue(sheetName, 185, 27, 1194d),
					new ExpectedCellValue(sheetName, 186, 27, null),
					new ExpectedCellValue(sheetName, 187, 27, 415.75),
					new ExpectedCellValue(sheetName, 188, 27, 415.75),
					new ExpectedCellValue(sheetName, 189, 27, 415.75),
					new ExpectedCellValue(sheetName, 190, 27, 415.75),
					new ExpectedCellValue(sheetName, 191, 27, null),
					new ExpectedCellValue(sheetName, 192, 27, 24.99),
					new ExpectedCellValue(sheetName, 193, 27, 24.99),
					new ExpectedCellValue(sheetName, 194, 27, 24.99),
					new ExpectedCellValue(sheetName, 195, 27, 24.99),
					new ExpectedCellValue(sheetName, 196, 27, null),
					new ExpectedCellValue(sheetName, 197, 27, 99d),
					new ExpectedCellValue(sheetName, 198, 27, 99d),
					new ExpectedCellValue(sheetName, 199, 27, 99d),
					new ExpectedCellValue(sheetName, 200, 27, 99d),
					new ExpectedCellValue(sheetName, 201, 27, null),
					new ExpectedCellValue(sheetName, 202, 27, 831.5),
					new ExpectedCellValue(sheetName, 203, 27, 831.5),
					new ExpectedCellValue(sheetName, 204, 27, 831.5),
					new ExpectedCellValue(sheetName, 205, 27, 831.5),
					new ExpectedCellValue(sheetName, 206, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndSecondFieldsNonCompactThirdAndLastFieldsSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD170:AH185"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 30, 20100007),
					new ExpectedCellValue(sheetName, 172, 30, null),
					new ExpectedCellValue(sheetName, 173, 30, 20100017),
					new ExpectedCellValue(sheetName, 174, 30, null),
					new ExpectedCellValue(sheetName, 175, 30, 20100070),
					new ExpectedCellValue(sheetName, 176, 30, null),
					new ExpectedCellValue(sheetName, 177, 30, 20100076),
					new ExpectedCellValue(sheetName, 178, 30, null),
					new ExpectedCellValue(sheetName, 179, 30, 20100083),
					new ExpectedCellValue(sheetName, 180, 30, null),
					new ExpectedCellValue(sheetName, 181, 30, 20100085),
					new ExpectedCellValue(sheetName, 182, 30, null),
					new ExpectedCellValue(sheetName, 183, 30, 20100090),
					new ExpectedCellValue(sheetName, 184, 30, null),
					new ExpectedCellValue(sheetName, 185, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 31, "Location"),
					new ExpectedCellValue(sheetName, 171, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 31, null),
					new ExpectedCellValue(sheetName, 173, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 174, 31, null),
					new ExpectedCellValue(sheetName, 175, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 176, 31, null),
					new ExpectedCellValue(sheetName, 177, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 178, 31, null),
					new ExpectedCellValue(sheetName, 179, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 180, 31, null),
					new ExpectedCellValue(sheetName, 181, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 182, 31, null),
					new ExpectedCellValue(sheetName, 183, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 184, 31, null),
					new ExpectedCellValue(sheetName, 185, 31, null),
					new ExpectedCellValue(sheetName, 170, 32, "Month"),
					new ExpectedCellValue(sheetName, 171, 32, "January"),
					new ExpectedCellValue(sheetName, 172, 32, null),
					new ExpectedCellValue(sheetName, 173, 32, "March"),
					new ExpectedCellValue(sheetName, 174, 32, null),
					new ExpectedCellValue(sheetName, 175, 32, "February"),
					new ExpectedCellValue(sheetName, 176, 32, null),
					new ExpectedCellValue(sheetName, 177, 32, "January"),
					new ExpectedCellValue(sheetName, 178, 32, null),
					new ExpectedCellValue(sheetName, 179, 32, "March"),
					new ExpectedCellValue(sheetName, 180, 32, null),
					new ExpectedCellValue(sheetName, 181, 32, "February"),
					new ExpectedCellValue(sheetName, 182, 32, null),
					new ExpectedCellValue(sheetName, 183, 32, "January"),
					new ExpectedCellValue(sheetName, 184, 32, null),
					new ExpectedCellValue(sheetName, 185, 32, null),
					new ExpectedCellValue(sheetName, 170, 33, "Item"),
					new ExpectedCellValue(sheetName, 171, 33, null),
					new ExpectedCellValue(sheetName, 172, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 33, null),
					new ExpectedCellValue(sheetName, 174, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 175, 33, null),
					new ExpectedCellValue(sheetName, 176, 33, "Tent"),
					new ExpectedCellValue(sheetName, 177, 33, null),
					new ExpectedCellValue(sheetName, 178, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 179, 33, null),
					new ExpectedCellValue(sheetName, 180, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 181, 33, null),
					new ExpectedCellValue(sheetName, 182, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 183, 33, null),
					new ExpectedCellValue(sheetName, 184, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 33, null),
					new ExpectedCellValue(sheetName, 170, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 34, null),
					new ExpectedCellValue(sheetName, 172, 34, 831.5),
					new ExpectedCellValue(sheetName, 173, 34, null),
					new ExpectedCellValue(sheetName, 174, 34, 831.5),
					new ExpectedCellValue(sheetName, 175, 34, null),
					new ExpectedCellValue(sheetName, 176, 34, 1194d),
					new ExpectedCellValue(sheetName, 177, 34, null),
					new ExpectedCellValue(sheetName, 178, 34, 415.75),
					new ExpectedCellValue(sheetName, 179, 34, null),
					new ExpectedCellValue(sheetName, 180, 34, 24.99),
					new ExpectedCellValue(sheetName, 181, 34, null),
					new ExpectedCellValue(sheetName, 182, 34, 99d),
					new ExpectedCellValue(sheetName, 183, 34, null),
					new ExpectedCellValue(sheetName, 184, 34, 831.5),
					new ExpectedCellValue(sheetName, 185, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndSecondFieldsNonCompactThirdAndLastFieldsSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD170:AH199"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 30, 20100007),
					new ExpectedCellValue(sheetName, 172, 30, null),
					new ExpectedCellValue(sheetName, 173, 30, null),
					new ExpectedCellValue(sheetName, 174, 30, "20100007 Total"),
					new ExpectedCellValue(sheetName, 175, 30, 20100017),
					new ExpectedCellValue(sheetName, 176, 30, null),
					new ExpectedCellValue(sheetName, 177, 30, null),
					new ExpectedCellValue(sheetName, 178, 30, "20100017 Total"),
					new ExpectedCellValue(sheetName, 179, 30, 20100070),
					new ExpectedCellValue(sheetName, 180, 30, null),
					new ExpectedCellValue(sheetName, 181, 30, null),
					new ExpectedCellValue(sheetName, 182, 30, "20100070 Total"),
					new ExpectedCellValue(sheetName, 183, 30, 20100076),
					new ExpectedCellValue(sheetName, 184, 30, null),
					new ExpectedCellValue(sheetName, 185, 30, null),
					new ExpectedCellValue(sheetName, 186, 30, "20100076 Total"),
					new ExpectedCellValue(sheetName, 187, 30, 20100083),
					new ExpectedCellValue(sheetName, 188, 30, null),
					new ExpectedCellValue(sheetName, 189, 30, null),
					new ExpectedCellValue(sheetName, 190, 30, "20100083 Total"),
					new ExpectedCellValue(sheetName, 191, 30, 20100085),
					new ExpectedCellValue(sheetName, 192, 30, null),
					new ExpectedCellValue(sheetName, 193, 30, null),
					new ExpectedCellValue(sheetName, 194, 30, "20100085 Total"),
					new ExpectedCellValue(sheetName, 195, 30, 20100090),
					new ExpectedCellValue(sheetName, 196, 30, null),
					new ExpectedCellValue(sheetName, 197, 30, null),
					new ExpectedCellValue(sheetName, 198, 30, "20100090 Total"),
					new ExpectedCellValue(sheetName, 199, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 31, "Location"),
					new ExpectedCellValue(sheetName, 171, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 31, null),
					new ExpectedCellValue(sheetName, 173, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 174, 31, null),
					new ExpectedCellValue(sheetName, 175, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 176, 31, null),
					new ExpectedCellValue(sheetName, 177, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 178, 31, null),
					new ExpectedCellValue(sheetName, 179, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 180, 31, null),
					new ExpectedCellValue(sheetName, 181, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 182, 31, null),
					new ExpectedCellValue(sheetName, 183, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 184, 31, null),
					new ExpectedCellValue(sheetName, 185, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 186, 31, null),
					new ExpectedCellValue(sheetName, 187, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 188, 31, null),
					new ExpectedCellValue(sheetName, 189, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 190, 31, null),
					new ExpectedCellValue(sheetName, 191, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 192, 31, null),
					new ExpectedCellValue(sheetName, 193, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 194, 31, null),
					new ExpectedCellValue(sheetName, 195, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 31, null),
					new ExpectedCellValue(sheetName, 197, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 198, 31, null),
					new ExpectedCellValue(sheetName, 199, 31, null),
					new ExpectedCellValue(sheetName, 170, 32, "Month"),
					new ExpectedCellValue(sheetName, 171, 32, "January"),
					new ExpectedCellValue(sheetName, 172, 32, null),
					new ExpectedCellValue(sheetName, 173, 32, null),
					new ExpectedCellValue(sheetName, 174, 32, null),
					new ExpectedCellValue(sheetName, 175, 32, "March"),
					new ExpectedCellValue(sheetName, 176, 32, null),
					new ExpectedCellValue(sheetName, 177, 32, null),
					new ExpectedCellValue(sheetName, 178, 32, null),
					new ExpectedCellValue(sheetName, 179, 32, "February"),
					new ExpectedCellValue(sheetName, 180, 32, null),
					new ExpectedCellValue(sheetName, 181, 32, null),
					new ExpectedCellValue(sheetName, 182, 32, null),
					new ExpectedCellValue(sheetName, 183, 32, "January"),
					new ExpectedCellValue(sheetName, 184, 32, null),
					new ExpectedCellValue(sheetName, 185, 32, null),
					new ExpectedCellValue(sheetName, 186, 32, null),
					new ExpectedCellValue(sheetName, 187, 32, "March"),
					new ExpectedCellValue(sheetName, 188, 32, null),
					new ExpectedCellValue(sheetName, 189, 32, null),
					new ExpectedCellValue(sheetName, 190, 32, null),
					new ExpectedCellValue(sheetName, 191, 32, "February"),
					new ExpectedCellValue(sheetName, 192, 32, null),
					new ExpectedCellValue(sheetName, 193, 32, null),
					new ExpectedCellValue(sheetName, 194, 32, null),
					new ExpectedCellValue(sheetName, 195, 32, "January"),
					new ExpectedCellValue(sheetName, 196, 32, null),
					new ExpectedCellValue(sheetName, 197, 32, null),
					new ExpectedCellValue(sheetName, 198, 32, null),
					new ExpectedCellValue(sheetName, 199, 32, null),
					new ExpectedCellValue(sheetName, 170, 33, "Item"),
					new ExpectedCellValue(sheetName, 171, 33, null),
					new ExpectedCellValue(sheetName, 172, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 33, null),
					new ExpectedCellValue(sheetName, 174, 33, null),
					new ExpectedCellValue(sheetName, 175, 33, null),
					new ExpectedCellValue(sheetName, 176, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 177, 33, null),
					new ExpectedCellValue(sheetName, 178, 33, null),
					new ExpectedCellValue(sheetName, 179, 33, null),
					new ExpectedCellValue(sheetName, 180, 33, "Tent"),
					new ExpectedCellValue(sheetName, 181, 33, null),
					new ExpectedCellValue(sheetName, 182, 33, null),
					new ExpectedCellValue(sheetName, 183, 33, null),
					new ExpectedCellValue(sheetName, 184, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 33, null),
					new ExpectedCellValue(sheetName, 186, 33, null),
					new ExpectedCellValue(sheetName, 187, 33, null),
					new ExpectedCellValue(sheetName, 188, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 33, null),
					new ExpectedCellValue(sheetName, 190, 33, null),
					new ExpectedCellValue(sheetName, 191, 33, null),
					new ExpectedCellValue(sheetName, 192, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 193, 33, null),
					new ExpectedCellValue(sheetName, 194, 33, null),
					new ExpectedCellValue(sheetName, 195, 33, null),
					new ExpectedCellValue(sheetName, 196, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 33, null),
					new ExpectedCellValue(sheetName, 198, 33, null),
					new ExpectedCellValue(sheetName, 199, 33, null),
					new ExpectedCellValue(sheetName, 170, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 34, 831.5),
					new ExpectedCellValue(sheetName, 172, 34, 831.5),
					new ExpectedCellValue(sheetName, 173, 34, 831.5),
					new ExpectedCellValue(sheetName, 174, 34, 831.5),
					new ExpectedCellValue(sheetName, 175, 34, 831.5),
					new ExpectedCellValue(sheetName, 176, 34, 831.5),
					new ExpectedCellValue(sheetName, 177, 34, 831.5),
					new ExpectedCellValue(sheetName, 178, 34, 831.5),
					new ExpectedCellValue(sheetName, 179, 34, 1194d),
					new ExpectedCellValue(sheetName, 180, 34, 1194d),
					new ExpectedCellValue(sheetName, 181, 34, 1194d),
					new ExpectedCellValue(sheetName, 182, 34, 1194d),
					new ExpectedCellValue(sheetName, 183, 34, 415.75),
					new ExpectedCellValue(sheetName, 184, 34, 415.75),
					new ExpectedCellValue(sheetName, 185, 34, 415.75),
					new ExpectedCellValue(sheetName, 186, 34, 415.75),
					new ExpectedCellValue(sheetName, 187, 34, 24.99),
					new ExpectedCellValue(sheetName, 188, 34, 24.99),
					new ExpectedCellValue(sheetName, 189, 34, 24.99),
					new ExpectedCellValue(sheetName, 190, 34, 24.99),
					new ExpectedCellValue(sheetName, 191, 34, 99d),
					new ExpectedCellValue(sheetName, 192, 34, 99d),
					new ExpectedCellValue(sheetName, 193, 34, 99d),
					new ExpectedCellValue(sheetName, 194, 34, 99d),
					new ExpectedCellValue(sheetName, 195, 34, 831.5),
					new ExpectedCellValue(sheetName, 196, 34, 831.5),
					new ExpectedCellValue(sheetName, 197, 34, 831.5),
					new ExpectedCellValue(sheetName, 198, 34, 831.5),
					new ExpectedCellValue(sheetName, 199, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstAndSecondFieldsNonCompactThirdAndLastFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("AD170:AH206"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 170, 30, "Row Labels"),
					new ExpectedCellValue(sheetName, 171, 30, 20100007),
					new ExpectedCellValue(sheetName, 172, 30, null),
					new ExpectedCellValue(sheetName, 173, 30, null),
					new ExpectedCellValue(sheetName, 174, 30, null),
					new ExpectedCellValue(sheetName, 175, 30, "20100007 Total"),
					new ExpectedCellValue(sheetName, 176, 30, 20100017),
					new ExpectedCellValue(sheetName, 177, 30, null),
					new ExpectedCellValue(sheetName, 178, 30, null),
					new ExpectedCellValue(sheetName, 179, 30, null),
					new ExpectedCellValue(sheetName, 180, 30, "20100017 Total"),
					new ExpectedCellValue(sheetName, 181, 30, 20100070),
					new ExpectedCellValue(sheetName, 182, 30, null),
					new ExpectedCellValue(sheetName, 183, 30, null),
					new ExpectedCellValue(sheetName, 184, 30, null),
					new ExpectedCellValue(sheetName, 185, 30, "20100070 Total"),
					new ExpectedCellValue(sheetName, 186, 30, 20100076),
					new ExpectedCellValue(sheetName, 187, 30, null),
					new ExpectedCellValue(sheetName, 188, 30, null),
					new ExpectedCellValue(sheetName, 189, 30, null),
					new ExpectedCellValue(sheetName, 190, 30, "20100076 Total"),
					new ExpectedCellValue(sheetName, 191, 30, 20100083),
					new ExpectedCellValue(sheetName, 192, 30, null),
					new ExpectedCellValue(sheetName, 193, 30, null),
					new ExpectedCellValue(sheetName, 194, 30, null),
					new ExpectedCellValue(sheetName, 195, 30, "20100083 Total"),
					new ExpectedCellValue(sheetName, 196, 30, 20100085),
					new ExpectedCellValue(sheetName, 197, 30, null),
					new ExpectedCellValue(sheetName, 198, 30, null),
					new ExpectedCellValue(sheetName, 199, 30, null),
					new ExpectedCellValue(sheetName, 200, 30, "20100085 Total"),
					new ExpectedCellValue(sheetName, 201, 30, 20100090),
					new ExpectedCellValue(sheetName, 202, 30, null),
					new ExpectedCellValue(sheetName, 203, 30, null),
					new ExpectedCellValue(sheetName, 204, 30, null),
					new ExpectedCellValue(sheetName, 205, 30, "20100090 Total"),
					new ExpectedCellValue(sheetName, 206, 30, "Grand Total"),
					new ExpectedCellValue(sheetName, 170, 31, "Location"),
					new ExpectedCellValue(sheetName, 171, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 172, 31, null),
					new ExpectedCellValue(sheetName, 173, 31, null),
					new ExpectedCellValue(sheetName, 174, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 175, 31, null),
					new ExpectedCellValue(sheetName, 176, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 177, 31, null),
					new ExpectedCellValue(sheetName, 178, 31, null),
					new ExpectedCellValue(sheetName, 179, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 180, 31, null),
					new ExpectedCellValue(sheetName, 181, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 182, 31, null),
					new ExpectedCellValue(sheetName, 183, 31, null),
					new ExpectedCellValue(sheetName, 184, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 185, 31, null),
					new ExpectedCellValue(sheetName, 186, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 187, 31, null),
					new ExpectedCellValue(sheetName, 188, 31, null),
					new ExpectedCellValue(sheetName, 189, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 190, 31, null),
					new ExpectedCellValue(sheetName, 191, 31, "Chicago"),
					new ExpectedCellValue(sheetName, 192, 31, null),
					new ExpectedCellValue(sheetName, 193, 31, null),
					new ExpectedCellValue(sheetName, 194, 31, "Chicago Total"),
					new ExpectedCellValue(sheetName, 195, 31, null),
					new ExpectedCellValue(sheetName, 196, 31, "San Francisco"),
					new ExpectedCellValue(sheetName, 197, 31, null),
					new ExpectedCellValue(sheetName, 198, 31, null),
					new ExpectedCellValue(sheetName, 199, 31, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 200, 31, null),
					new ExpectedCellValue(sheetName, 201, 31, "Nashville"),
					new ExpectedCellValue(sheetName, 202, 31, null),
					new ExpectedCellValue(sheetName, 203, 31, null),
					new ExpectedCellValue(sheetName, 204, 31, "Nashville Total"),
					new ExpectedCellValue(sheetName, 205, 31, null),
					new ExpectedCellValue(sheetName, 206, 31, null),
					new ExpectedCellValue(sheetName, 170, 32, "Month"),
					new ExpectedCellValue(sheetName, 171, 32, "January"),
					new ExpectedCellValue(sheetName, 172, 32, null),
					new ExpectedCellValue(sheetName, 173, 32, "January Total"),
					new ExpectedCellValue(sheetName, 174, 32, null),
					new ExpectedCellValue(sheetName, 175, 32, null),
					new ExpectedCellValue(sheetName, 176, 32, "March"),
					new ExpectedCellValue(sheetName, 177, 32, null),
					new ExpectedCellValue(sheetName, 178, 32, "March Total"),
					new ExpectedCellValue(sheetName, 179, 32, null),
					new ExpectedCellValue(sheetName, 180, 32, null),
					new ExpectedCellValue(sheetName, 181, 32, "February"),
					new ExpectedCellValue(sheetName, 182, 32, null),
					new ExpectedCellValue(sheetName, 183, 32, "February Total"),
					new ExpectedCellValue(sheetName, 184, 32, null),
					new ExpectedCellValue(sheetName, 185, 32, null),
					new ExpectedCellValue(sheetName, 186, 32, "January"),
					new ExpectedCellValue(sheetName, 187, 32, null),
					new ExpectedCellValue(sheetName, 188, 32, "January Total"),
					new ExpectedCellValue(sheetName, 189, 32, null),
					new ExpectedCellValue(sheetName, 190, 32, null),
					new ExpectedCellValue(sheetName, 191, 32, "March"),
					new ExpectedCellValue(sheetName, 192, 32, null),
					new ExpectedCellValue(sheetName, 193, 32, "March Total"),
					new ExpectedCellValue(sheetName, 194, 32, null),
					new ExpectedCellValue(sheetName, 195, 32, null),
					new ExpectedCellValue(sheetName, 196, 32, "February"),
					new ExpectedCellValue(sheetName, 197, 32, null),
					new ExpectedCellValue(sheetName, 198, 32, "February Total"),
					new ExpectedCellValue(sheetName, 199, 32, null),
					new ExpectedCellValue(sheetName, 200, 32, null),
					new ExpectedCellValue(sheetName, 201, 32, "January"),
					new ExpectedCellValue(sheetName, 202, 32, null),
					new ExpectedCellValue(sheetName, 203, 32, "January Total"),
					new ExpectedCellValue(sheetName, 204, 32, null),
					new ExpectedCellValue(sheetName, 205, 32, null),
					new ExpectedCellValue(sheetName, 206, 32, null),
					new ExpectedCellValue(sheetName, 170, 33, "Item"),
					new ExpectedCellValue(sheetName, 171, 33, null),
					new ExpectedCellValue(sheetName, 172, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 173, 33, null),
					new ExpectedCellValue(sheetName, 174, 33, null),
					new ExpectedCellValue(sheetName, 175, 33, null),
					new ExpectedCellValue(sheetName, 176, 33, null),
					new ExpectedCellValue(sheetName, 177, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 178, 33, null),
					new ExpectedCellValue(sheetName, 179, 33, null),
					new ExpectedCellValue(sheetName, 180, 33, null),
					new ExpectedCellValue(sheetName, 181, 33, null),
					new ExpectedCellValue(sheetName, 182, 33, "Tent"),
					new ExpectedCellValue(sheetName, 183, 33, null),
					new ExpectedCellValue(sheetName, 184, 33, null),
					new ExpectedCellValue(sheetName, 185, 33, null),
					new ExpectedCellValue(sheetName, 186, 33, null),
					new ExpectedCellValue(sheetName, 187, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 188, 33, null),
					new ExpectedCellValue(sheetName, 189, 33, null),
					new ExpectedCellValue(sheetName, 190, 33, null),
					new ExpectedCellValue(sheetName, 191, 33, null),
					new ExpectedCellValue(sheetName, 192, 33, "Headlamp"),
					new ExpectedCellValue(sheetName, 193, 33, null),
					new ExpectedCellValue(sheetName, 194, 33, null),
					new ExpectedCellValue(sheetName, 195, 33, null),
					new ExpectedCellValue(sheetName, 196, 33, null),
					new ExpectedCellValue(sheetName, 197, 33, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 198, 33, null),
					new ExpectedCellValue(sheetName, 199, 33, null),
					new ExpectedCellValue(sheetName, 200, 33, null),
					new ExpectedCellValue(sheetName, 201, 33, null),
					new ExpectedCellValue(sheetName, 202, 33, "Car Rack"),
					new ExpectedCellValue(sheetName, 203, 33, null),
					new ExpectedCellValue(sheetName, 204, 33, null),
					new ExpectedCellValue(sheetName, 205, 33, null),
					new ExpectedCellValue(sheetName, 206, 33, null),
					new ExpectedCellValue(sheetName, 170, 34, "Sum of Total"),
					new ExpectedCellValue(sheetName, 171, 34, null),
					new ExpectedCellValue(sheetName, 172, 34, 831.5),
					new ExpectedCellValue(sheetName, 173, 34, 831.5),
					new ExpectedCellValue(sheetName, 174, 34, 831.5),
					new ExpectedCellValue(sheetName, 175, 34, 831.5),
					new ExpectedCellValue(sheetName, 176, 34, null),
					new ExpectedCellValue(sheetName, 177, 34, 831.5),
					new ExpectedCellValue(sheetName, 178, 34, 831.5),
					new ExpectedCellValue(sheetName, 179, 34, 831.5),
					new ExpectedCellValue(sheetName, 180, 34, 831.5),
					new ExpectedCellValue(sheetName, 181, 34, null),
					new ExpectedCellValue(sheetName, 182, 34, 1194d),
					new ExpectedCellValue(sheetName, 183, 34, 1194d),
					new ExpectedCellValue(sheetName, 184, 34, 1194d),
					new ExpectedCellValue(sheetName, 185, 34, 1194d),
					new ExpectedCellValue(sheetName, 186, 34, null),
					new ExpectedCellValue(sheetName, 187, 34, 415.75),
					new ExpectedCellValue(sheetName, 188, 34, 415.75),
					new ExpectedCellValue(sheetName, 189, 34, 415.75),
					new ExpectedCellValue(sheetName, 190, 34, 415.75),
					new ExpectedCellValue(sheetName, 191, 34, null),
					new ExpectedCellValue(sheetName, 192, 34, 24.99),
					new ExpectedCellValue(sheetName, 193, 34, 24.99),
					new ExpectedCellValue(sheetName, 194, 34, 24.99),
					new ExpectedCellValue(sheetName, 195, 34, 24.99),
					new ExpectedCellValue(sheetName, 196, 34, null),
					new ExpectedCellValue(sheetName, 197, 34, 99d),
					new ExpectedCellValue(sheetName, 198, 34, 99d),
					new ExpectedCellValue(sheetName, 199, 34, 99d),
					new ExpectedCellValue(sheetName, 200, 34, 99d),
					new ExpectedCellValue(sheetName, 201, 34, null),
					new ExpectedCellValue(sheetName, 202, 34, 831.5),
					new ExpectedCellValue(sheetName, 203, 34, 831.5),
					new ExpectedCellValue(sheetName, 204, 34, 831.5),
					new ExpectedCellValue(sheetName, 205, 34, 831.5),
					new ExpectedCellValue(sheetName, 206, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstSecondAndLastFieldsNonCompactThirdFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P215:T230"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 215, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 216, 16, 20100007),
					new ExpectedCellValue(sheetName, 217, 16, null),
					new ExpectedCellValue(sheetName, 218, 16, 20100017),
					new ExpectedCellValue(sheetName, 219, 16, null),
					new ExpectedCellValue(sheetName, 220, 16, 20100070),
					new ExpectedCellValue(sheetName, 221, 16, null),
					new ExpectedCellValue(sheetName, 222, 16, 20100076),
					new ExpectedCellValue(sheetName, 223, 16, null),
					new ExpectedCellValue(sheetName, 224, 16, 20100083),
					new ExpectedCellValue(sheetName, 225, 16, null),
					new ExpectedCellValue(sheetName, 226, 16, 20100085),
					new ExpectedCellValue(sheetName, 227, 16, null),
					new ExpectedCellValue(sheetName, 228, 16, 20100090),
					new ExpectedCellValue(sheetName, 229, 16, null),
					new ExpectedCellValue(sheetName, 230, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 215, 17, "Location"),
					new ExpectedCellValue(sheetName, 216, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 218, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 219, 17, null),
					new ExpectedCellValue(sheetName, 220, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 221, 17, null),
					new ExpectedCellValue(sheetName, 222, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 223, 17, null),
					new ExpectedCellValue(sheetName, 224, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 225, 17, null),
					new ExpectedCellValue(sheetName, 226, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 227, 17, null),
					new ExpectedCellValue(sheetName, 228, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 229, 17, null),
					new ExpectedCellValue(sheetName, 230, 17, null),
					new ExpectedCellValue(sheetName, 215, 18, "Month"),
					new ExpectedCellValue(sheetName, 216, 18, "January"),
					new ExpectedCellValue(sheetName, 217, 18, null),
					new ExpectedCellValue(sheetName, 218, 18, "March"),
					new ExpectedCellValue(sheetName, 219, 18, null),
					new ExpectedCellValue(sheetName, 220, 18, "February"),
					new ExpectedCellValue(sheetName, 221, 18, null),
					new ExpectedCellValue(sheetName, 222, 18, "January"),
					new ExpectedCellValue(sheetName, 223, 18, null),
					new ExpectedCellValue(sheetName, 224, 18, "March"),
					new ExpectedCellValue(sheetName, 225, 18, null),
					new ExpectedCellValue(sheetName, 226, 18, "February"),
					new ExpectedCellValue(sheetName, 227, 18, null),
					new ExpectedCellValue(sheetName, 228, 18, "January"),
					new ExpectedCellValue(sheetName, 229, 18, null),
					new ExpectedCellValue(sheetName, 230, 18, null),
					new ExpectedCellValue(sheetName, 215, 19, "Item"),
					new ExpectedCellValue(sheetName, 216, 19, null),
					new ExpectedCellValue(sheetName, 217, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 218, 19, null),
					new ExpectedCellValue(sheetName, 219, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 220, 19, null),
					new ExpectedCellValue(sheetName, 221, 19, "Tent"),
					new ExpectedCellValue(sheetName, 222, 19, null),
					new ExpectedCellValue(sheetName, 223, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 224, 19, null),
					new ExpectedCellValue(sheetName, 225, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 226, 19, null),
					new ExpectedCellValue(sheetName, 227, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 228, 19, null),
					new ExpectedCellValue(sheetName, 229, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 230, 19, null),
					new ExpectedCellValue(sheetName, 215, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 20, null),
					new ExpectedCellValue(sheetName, 217, 20, 831.5),
					new ExpectedCellValue(sheetName, 218, 20, null),
					new ExpectedCellValue(sheetName, 219, 20, 831.5),
					new ExpectedCellValue(sheetName, 220, 20, null),
					new ExpectedCellValue(sheetName, 221, 20, 1194d),
					new ExpectedCellValue(sheetName, 222, 20, null),
					new ExpectedCellValue(sheetName, 223, 20, 415.75),
					new ExpectedCellValue(sheetName, 224, 20, null),
					new ExpectedCellValue(sheetName, 225, 20, 24.99),
					new ExpectedCellValue(sheetName, 226, 20, null),
					new ExpectedCellValue(sheetName, 227, 20, 99d),
					new ExpectedCellValue(sheetName, 228, 20, null),
					new ExpectedCellValue(sheetName, 229, 20, 831.5),
					new ExpectedCellValue(sheetName, 230, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstSecondAndLastFieldsNonCompactThirdFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P215:T244"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 215, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 216, 16, 20100007),
					new ExpectedCellValue(sheetName, 217, 16, null),
					new ExpectedCellValue(sheetName, 218, 16, null),
					new ExpectedCellValue(sheetName, 219, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 220, 16, 20100017),
					new ExpectedCellValue(sheetName, 221, 16, null),
					new ExpectedCellValue(sheetName, 222, 16, null),
					new ExpectedCellValue(sheetName, 223, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 224, 16, 20100070),
					new ExpectedCellValue(sheetName, 225, 16, null),
					new ExpectedCellValue(sheetName, 226, 16, null),
					new ExpectedCellValue(sheetName, 227, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 228, 16, 20100076),
					new ExpectedCellValue(sheetName, 229, 16, null),
					new ExpectedCellValue(sheetName, 230, 16, null),
					new ExpectedCellValue(sheetName, 231, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 232, 16, 20100083),
					new ExpectedCellValue(sheetName, 233, 16, null),
					new ExpectedCellValue(sheetName, 234, 16, null),
					new ExpectedCellValue(sheetName, 235, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 236, 16, 20100085),
					new ExpectedCellValue(sheetName, 237, 16, null),
					new ExpectedCellValue(sheetName, 238, 16, null),
					new ExpectedCellValue(sheetName, 239, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 240, 16, 20100090),
					new ExpectedCellValue(sheetName, 241, 16, null),
					new ExpectedCellValue(sheetName, 242, 16, null),
					new ExpectedCellValue(sheetName, 243, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 244, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 215, 17, "Location"),
					new ExpectedCellValue(sheetName, 216, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 218, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 219, 17, null),
					new ExpectedCellValue(sheetName, 220, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 221, 17, null),
					new ExpectedCellValue(sheetName, 222, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 223, 17, null),
					new ExpectedCellValue(sheetName, 224, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 225, 17, null),
					new ExpectedCellValue(sheetName, 226, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 227, 17, null),
					new ExpectedCellValue(sheetName, 228, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 229, 17, null),
					new ExpectedCellValue(sheetName, 230, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 231, 17, null),
					new ExpectedCellValue(sheetName, 232, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 233, 17, null),
					new ExpectedCellValue(sheetName, 234, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 235, 17, null),
					new ExpectedCellValue(sheetName, 236, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 237, 17, null),
					new ExpectedCellValue(sheetName, 238, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 239, 17, null),
					new ExpectedCellValue(sheetName, 240, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 241, 17, null),
					new ExpectedCellValue(sheetName, 242, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 243, 17, null),
					new ExpectedCellValue(sheetName, 244, 17, null),
					new ExpectedCellValue(sheetName, 215, 18, "Month"),
					new ExpectedCellValue(sheetName, 216, 18, "January"),
					new ExpectedCellValue(sheetName, 217, 18, null),
					new ExpectedCellValue(sheetName, 218, 18, null),
					new ExpectedCellValue(sheetName, 219, 18, null),
					new ExpectedCellValue(sheetName, 220, 18, "March"),
					new ExpectedCellValue(sheetName, 221, 18, null),
					new ExpectedCellValue(sheetName, 222, 18, null),
					new ExpectedCellValue(sheetName, 223, 18, null),
					new ExpectedCellValue(sheetName, 224, 18, "February"),
					new ExpectedCellValue(sheetName, 225, 18, null),
					new ExpectedCellValue(sheetName, 226, 18, null),
					new ExpectedCellValue(sheetName, 227, 18, null),
					new ExpectedCellValue(sheetName, 228, 18, "January"),
					new ExpectedCellValue(sheetName, 229, 18, null),
					new ExpectedCellValue(sheetName, 230, 18, null),
					new ExpectedCellValue(sheetName, 231, 18, null),
					new ExpectedCellValue(sheetName, 232, 18, "March"),
					new ExpectedCellValue(sheetName, 233, 18, null),
					new ExpectedCellValue(sheetName, 234, 18, null),
					new ExpectedCellValue(sheetName, 235, 18, null),
					new ExpectedCellValue(sheetName, 236, 18, "February"),
					new ExpectedCellValue(sheetName, 237, 18, null),
					new ExpectedCellValue(sheetName, 238, 18, null),
					new ExpectedCellValue(sheetName, 239, 18, null),
					new ExpectedCellValue(sheetName, 240, 18, "January"),
					new ExpectedCellValue(sheetName, 241, 18, null),
					new ExpectedCellValue(sheetName, 242, 18, null),
					new ExpectedCellValue(sheetName, 243, 18, null),
					new ExpectedCellValue(sheetName, 244, 18, null),
					new ExpectedCellValue(sheetName, 215, 19, "Item"),
					new ExpectedCellValue(sheetName, 216, 19, null),
					new ExpectedCellValue(sheetName, 217, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 218, 19, null),
					new ExpectedCellValue(sheetName, 219, 19, null),
					new ExpectedCellValue(sheetName, 220, 19, null),
					new ExpectedCellValue(sheetName, 221, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 222, 19, null),
					new ExpectedCellValue(sheetName, 223, 19, null),
					new ExpectedCellValue(sheetName, 224, 19, null),
					new ExpectedCellValue(sheetName, 225, 19, "Tent"),
					new ExpectedCellValue(sheetName, 226, 19, null),
					new ExpectedCellValue(sheetName, 227, 19, null),
					new ExpectedCellValue(sheetName, 228, 19, null),
					new ExpectedCellValue(sheetName, 229, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 230, 19, null),
					new ExpectedCellValue(sheetName, 231, 19, null),
					new ExpectedCellValue(sheetName, 232, 19, null),
					new ExpectedCellValue(sheetName, 233, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 234, 19, null),
					new ExpectedCellValue(sheetName, 235, 19, null),
					new ExpectedCellValue(sheetName, 236, 19, null),
					new ExpectedCellValue(sheetName, 237, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 238, 19, null),
					new ExpectedCellValue(sheetName, 239, 19, null),
					new ExpectedCellValue(sheetName, 240, 19, null),
					new ExpectedCellValue(sheetName, 241, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 242, 19, null),
					new ExpectedCellValue(sheetName, 243, 19, null),
					new ExpectedCellValue(sheetName, 244, 19, null),
					new ExpectedCellValue(sheetName, 215, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 20, 831.5),
					new ExpectedCellValue(sheetName, 217, 20, 831.5),
					new ExpectedCellValue(sheetName, 218, 20, 831.5),
					new ExpectedCellValue(sheetName, 219, 20, 831.5),
					new ExpectedCellValue(sheetName, 220, 20, 831.5),
					new ExpectedCellValue(sheetName, 221, 20, 831.5),
					new ExpectedCellValue(sheetName, 222, 20, 831.5),
					new ExpectedCellValue(sheetName, 223, 20, 831.5),
					new ExpectedCellValue(sheetName, 224, 20, 1194d),
					new ExpectedCellValue(sheetName, 225, 20, 1194d),
					new ExpectedCellValue(sheetName, 226, 20, 1194d),
					new ExpectedCellValue(sheetName, 227, 20, 1194d),
					new ExpectedCellValue(sheetName, 228, 20, 415.75),
					new ExpectedCellValue(sheetName, 229, 20, 415.75),
					new ExpectedCellValue(sheetName, 230, 20, 415.75),
					new ExpectedCellValue(sheetName, 231, 20, 415.75),
					new ExpectedCellValue(sheetName, 232, 20, 24.99),
					new ExpectedCellValue(sheetName, 233, 20, 24.99),
					new ExpectedCellValue(sheetName, 234, 20, 24.99),
					new ExpectedCellValue(sheetName, 235, 20, 24.99),
					new ExpectedCellValue(sheetName, 236, 20, 99d),
					new ExpectedCellValue(sheetName, 237, 20, 99d),
					new ExpectedCellValue(sheetName, 238, 20, 99d),
					new ExpectedCellValue(sheetName, 239, 20, 99d),
					new ExpectedCellValue(sheetName, 240, 20, 831.5),
					new ExpectedCellValue(sheetName, 241, 20, 831.5),
					new ExpectedCellValue(sheetName, 242, 20, 831.5),
					new ExpectedCellValue(sheetName, 243, 20, 831.5),
					new ExpectedCellValue(sheetName, 244, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstSecondAndLastFieldsNonCompactThirdFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("P215:T251"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 215, 16, "Row Labels"),
					new ExpectedCellValue(sheetName, 216, 16, 20100007),
					new ExpectedCellValue(sheetName, 217, 16, null),
					new ExpectedCellValue(sheetName, 218, 16, null),
					new ExpectedCellValue(sheetName, 219, 16, null),
					new ExpectedCellValue(sheetName, 220, 16, "20100007 Total"),
					new ExpectedCellValue(sheetName, 221, 16, 20100017),
					new ExpectedCellValue(sheetName, 222, 16, null),
					new ExpectedCellValue(sheetName, 223, 16, null),
					new ExpectedCellValue(sheetName, 224, 16, null),
					new ExpectedCellValue(sheetName, 225, 16, "20100017 Total"),
					new ExpectedCellValue(sheetName, 226, 16, 20100070),
					new ExpectedCellValue(sheetName, 227, 16, null),
					new ExpectedCellValue(sheetName, 228, 16, null),
					new ExpectedCellValue(sheetName, 229, 16, null),
					new ExpectedCellValue(sheetName, 230, 16, "20100070 Total"),
					new ExpectedCellValue(sheetName, 231, 16, 20100076),
					new ExpectedCellValue(sheetName, 232, 16, null),
					new ExpectedCellValue(sheetName, 233, 16, null),
					new ExpectedCellValue(sheetName, 234, 16, null),
					new ExpectedCellValue(sheetName, 235, 16, "20100076 Total"),
					new ExpectedCellValue(sheetName, 236, 16, 20100083),
					new ExpectedCellValue(sheetName, 237, 16, null),
					new ExpectedCellValue(sheetName, 238, 16, null),
					new ExpectedCellValue(sheetName, 239, 16, null),
					new ExpectedCellValue(sheetName, 240, 16, "20100083 Total"),
					new ExpectedCellValue(sheetName, 241, 16, 20100085),
					new ExpectedCellValue(sheetName, 242, 16, null),
					new ExpectedCellValue(sheetName, 243, 16, null),
					new ExpectedCellValue(sheetName, 244, 16, null),
					new ExpectedCellValue(sheetName, 245, 16, "20100085 Total"),
					new ExpectedCellValue(sheetName, 246, 16, 20100090),
					new ExpectedCellValue(sheetName, 247, 16, null),
					new ExpectedCellValue(sheetName, 248, 16, null),
					new ExpectedCellValue(sheetName, 249, 16, null),
					new ExpectedCellValue(sheetName, 250, 16, "20100090 Total"),
					new ExpectedCellValue(sheetName, 251, 16, "Grand Total"),
					new ExpectedCellValue(sheetName, 215, 17, "Location"),
					new ExpectedCellValue(sheetName, 216, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 218, 17, null),
					new ExpectedCellValue(sheetName, 219, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 220, 17, null),
					new ExpectedCellValue(sheetName, 221, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 222, 17, null),
					new ExpectedCellValue(sheetName, 223, 17, null),
					new ExpectedCellValue(sheetName, 224, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 225, 17, null),
					new ExpectedCellValue(sheetName, 226, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 227, 17, null),
					new ExpectedCellValue(sheetName, 228, 17, null),
					new ExpectedCellValue(sheetName, 229, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 230, 17, null),
					new ExpectedCellValue(sheetName, 231, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 232, 17, null),
					new ExpectedCellValue(sheetName, 233, 17, null),
					new ExpectedCellValue(sheetName, 234, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 235, 17, null),
					new ExpectedCellValue(sheetName, 236, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 237, 17, null),
					new ExpectedCellValue(sheetName, 238, 17, null),
					new ExpectedCellValue(sheetName, 239, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 240, 17, null),
					new ExpectedCellValue(sheetName, 241, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 242, 17, null),
					new ExpectedCellValue(sheetName, 243, 17, null),
					new ExpectedCellValue(sheetName, 244, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 245, 17, null),
					new ExpectedCellValue(sheetName, 246, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 247, 17, null),
					new ExpectedCellValue(sheetName, 248, 17, null),
					new ExpectedCellValue(sheetName, 249, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 250, 17, null),
					new ExpectedCellValue(sheetName, 251, 17, null),
					new ExpectedCellValue(sheetName, 215, 18, "Month"),
					new ExpectedCellValue(sheetName, 216, 18, "January"),
					new ExpectedCellValue(sheetName, 217, 18, null),
					new ExpectedCellValue(sheetName, 218, 18, "January Total"),
					new ExpectedCellValue(sheetName, 219, 18, null),
					new ExpectedCellValue(sheetName, 220, 18, null),
					new ExpectedCellValue(sheetName, 221, 18, "March"),
					new ExpectedCellValue(sheetName, 222, 18, null),
					new ExpectedCellValue(sheetName, 223, 18, "March Total"),
					new ExpectedCellValue(sheetName, 224, 18, null),
					new ExpectedCellValue(sheetName, 225, 18, null),
					new ExpectedCellValue(sheetName, 226, 18, "February"),
					new ExpectedCellValue(sheetName, 227, 18, null),
					new ExpectedCellValue(sheetName, 228, 18, "February Total"),
					new ExpectedCellValue(sheetName, 229, 18, null),
					new ExpectedCellValue(sheetName, 230, 18, null),
					new ExpectedCellValue(sheetName, 231, 18, "January"),
					new ExpectedCellValue(sheetName, 232, 18, null),
					new ExpectedCellValue(sheetName, 233, 18, "January Total"),
					new ExpectedCellValue(sheetName, 234, 18, null),
					new ExpectedCellValue(sheetName, 235, 18, null),
					new ExpectedCellValue(sheetName, 236, 18, "March"),
					new ExpectedCellValue(sheetName, 237, 18, null),
					new ExpectedCellValue(sheetName, 238, 18, "March Total"),
					new ExpectedCellValue(sheetName, 239, 18, null),
					new ExpectedCellValue(sheetName, 240, 18, null),
					new ExpectedCellValue(sheetName, 241, 18, "February"),
					new ExpectedCellValue(sheetName, 242, 18, null),
					new ExpectedCellValue(sheetName, 243, 18, "February Total"),
					new ExpectedCellValue(sheetName, 244, 18, null),
					new ExpectedCellValue(sheetName, 245, 18, null),
					new ExpectedCellValue(sheetName, 246, 18, "January"),
					new ExpectedCellValue(sheetName, 247, 18, null),
					new ExpectedCellValue(sheetName, 248, 18, "January Total"),
					new ExpectedCellValue(sheetName, 249, 18, null),
					new ExpectedCellValue(sheetName, 250, 18, null),
					new ExpectedCellValue(sheetName, 251, 18, null),
					new ExpectedCellValue(sheetName, 215, 19, "Item"),
					new ExpectedCellValue(sheetName, 216, 19, null),
					new ExpectedCellValue(sheetName, 217, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 218, 19, null),
					new ExpectedCellValue(sheetName, 219, 19, null),
					new ExpectedCellValue(sheetName, 220, 19, null),
					new ExpectedCellValue(sheetName, 221, 19, null),
					new ExpectedCellValue(sheetName, 222, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 223, 19, null),
					new ExpectedCellValue(sheetName, 224, 19, null),
					new ExpectedCellValue(sheetName, 225, 19, null),
					new ExpectedCellValue(sheetName, 226, 19, null),
					new ExpectedCellValue(sheetName, 227, 19, "Tent"),
					new ExpectedCellValue(sheetName, 228, 19, null),
					new ExpectedCellValue(sheetName, 229, 19, null),
					new ExpectedCellValue(sheetName, 230, 19, null),
					new ExpectedCellValue(sheetName, 231, 19, null),
					new ExpectedCellValue(sheetName, 232, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 233, 19, null),
					new ExpectedCellValue(sheetName, 234, 19, null),
					new ExpectedCellValue(sheetName, 235, 19, null),
					new ExpectedCellValue(sheetName, 236, 19, null),
					new ExpectedCellValue(sheetName, 237, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 238, 19, null),
					new ExpectedCellValue(sheetName, 239, 19, null),
					new ExpectedCellValue(sheetName, 240, 19, null),
					new ExpectedCellValue(sheetName, 241, 19, null),
					new ExpectedCellValue(sheetName, 242, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 243, 19, null),
					new ExpectedCellValue(sheetName, 244, 19, null),
					new ExpectedCellValue(sheetName, 245, 19, null),
					new ExpectedCellValue(sheetName, 246, 19, null),
					new ExpectedCellValue(sheetName, 247, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 19, null),
					new ExpectedCellValue(sheetName, 249, 19, null),
					new ExpectedCellValue(sheetName, 250, 19, null),
					new ExpectedCellValue(sheetName, 251, 19, null),
					new ExpectedCellValue(sheetName, 215, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 20, null),
					new ExpectedCellValue(sheetName, 217, 20, 831.5),
					new ExpectedCellValue(sheetName, 218, 20, 831.5),
					new ExpectedCellValue(sheetName, 219, 20, 831.5),
					new ExpectedCellValue(sheetName, 220, 20, 831.5),
					new ExpectedCellValue(sheetName, 221, 20, null),
					new ExpectedCellValue(sheetName, 222, 20, 831.5),
					new ExpectedCellValue(sheetName, 223, 20, 831.5),
					new ExpectedCellValue(sheetName, 224, 20, 831.5),
					new ExpectedCellValue(sheetName, 225, 20, 831.5),
					new ExpectedCellValue(sheetName, 226, 20, null),
					new ExpectedCellValue(sheetName, 227, 20, 1194d),
					new ExpectedCellValue(sheetName, 228, 20, 1194d),
					new ExpectedCellValue(sheetName, 229, 20, 1194d),
					new ExpectedCellValue(sheetName, 230, 20, 1194d),
					new ExpectedCellValue(sheetName, 231, 20, null),
					new ExpectedCellValue(sheetName, 232, 20, 415.75),
					new ExpectedCellValue(sheetName, 233, 20, 415.75),
					new ExpectedCellValue(sheetName, 234, 20, 415.75),
					new ExpectedCellValue(sheetName, 235, 20, 415.75),
					new ExpectedCellValue(sheetName, 236, 20, null),
					new ExpectedCellValue(sheetName, 237, 20, 24.99),
					new ExpectedCellValue(sheetName, 238, 20, 24.99),
					new ExpectedCellValue(sheetName, 239, 20, 24.99),
					new ExpectedCellValue(sheetName, 240, 20, 24.99),
					new ExpectedCellValue(sheetName, 241, 20, null),
					new ExpectedCellValue(sheetName, 242, 20, 99d),
					new ExpectedCellValue(sheetName, 243, 20, 99d),
					new ExpectedCellValue(sheetName, 244, 20, 99d),
					new ExpectedCellValue(sheetName, 245, 20, 99d),
					new ExpectedCellValue(sheetName, 246, 20, null),
					new ExpectedCellValue(sheetName, 247, 20, 831.5),
					new ExpectedCellValue(sheetName, 248, 20, 831.5),
					new ExpectedCellValue(sheetName, 249, 20, 831.5),
					new ExpectedCellValue(sheetName, 250, 20, 831.5),
					new ExpectedCellValue(sheetName, 251, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstSecondAndThidFieldsNonCompactLastFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W215:AA223"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 215, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 216, 23, 20100007),
					new ExpectedCellValue(sheetName, 217, 23, 20100017),
					new ExpectedCellValue(sheetName, 218, 23, 20100070),
					new ExpectedCellValue(sheetName, 219, 23, 20100076),
					new ExpectedCellValue(sheetName, 220, 23, 20100083),
					new ExpectedCellValue(sheetName, 221, 23, 20100085),
					new ExpectedCellValue(sheetName, 222, 23, 20100090),
					new ExpectedCellValue(sheetName, 223, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 215, 24, "Location"),
					new ExpectedCellValue(sheetName, 216, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 217, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 218, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 219, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 220, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 221, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 222, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 223, 24, null),
					new ExpectedCellValue(sheetName, 215, 25, "Month"),
					new ExpectedCellValue(sheetName, 216, 25, "January"),
					new ExpectedCellValue(sheetName, 217, 25, "March"),
					new ExpectedCellValue(sheetName, 218, 25, "February"),
					new ExpectedCellValue(sheetName, 219, 25, "January"),
					new ExpectedCellValue(sheetName, 220, 25, "March"),
					new ExpectedCellValue(sheetName, 221, 25, "February"),
					new ExpectedCellValue(sheetName, 222, 25, "January"),
					new ExpectedCellValue(sheetName, 223, 25, null),
					new ExpectedCellValue(sheetName, 215, 26, "Item"),
					new ExpectedCellValue(sheetName, 216, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 217, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 218, 26, "Tent"),
					new ExpectedCellValue(sheetName, 219, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 220, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 221, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 222, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 223, 26, null),
					new ExpectedCellValue(sheetName, 215, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 27, 831.5),
					new ExpectedCellValue(sheetName, 217, 27, 831.5),
					new ExpectedCellValue(sheetName, 218, 27, 1194d),
					new ExpectedCellValue(sheetName, 219, 27, 415.75),
					new ExpectedCellValue(sheetName, 220, 27, 24.99),
					new ExpectedCellValue(sheetName, 221, 27, 99d),
					new ExpectedCellValue(sheetName, 222, 27, 831.5),
					new ExpectedCellValue(sheetName, 223, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstSecondAndThidFieldsNonCompactLastFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W215:AA244"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 215, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 216, 23, 20100007),
					new ExpectedCellValue(sheetName, 217, 23, null),
					new ExpectedCellValue(sheetName, 218, 23, null),
					new ExpectedCellValue(sheetName, 219, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 220, 23, 20100017),
					new ExpectedCellValue(sheetName, 221, 23, null),
					new ExpectedCellValue(sheetName, 222, 23, null),
					new ExpectedCellValue(sheetName, 223, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 224, 23, 20100070),
					new ExpectedCellValue(sheetName, 225, 23, null),
					new ExpectedCellValue(sheetName, 226, 23, null),
					new ExpectedCellValue(sheetName, 227, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 228, 23, 20100076),
					new ExpectedCellValue(sheetName, 229, 23, null),
					new ExpectedCellValue(sheetName, 230, 23, null),
					new ExpectedCellValue(sheetName, 231, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 232, 23, 20100083),
					new ExpectedCellValue(sheetName, 233, 23, null),
					new ExpectedCellValue(sheetName, 234, 23, null),
					new ExpectedCellValue(sheetName, 235, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 236, 23, 20100085),
					new ExpectedCellValue(sheetName, 237, 23, null),
					new ExpectedCellValue(sheetName, 238, 23, null),
					new ExpectedCellValue(sheetName, 239, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 240, 23, 20100090),
					new ExpectedCellValue(sheetName, 241, 23, null),
					new ExpectedCellValue(sheetName, 242, 23, null),
					new ExpectedCellValue(sheetName, 243, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 244, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 215, 24, "Location"),
					new ExpectedCellValue(sheetName, 216, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 217, 24, null),
					new ExpectedCellValue(sheetName, 218, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 219, 24, null),
					new ExpectedCellValue(sheetName, 220, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 221, 24, null),
					new ExpectedCellValue(sheetName, 222, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 223, 24, null),
					new ExpectedCellValue(sheetName, 224, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 225, 24, null),
					new ExpectedCellValue(sheetName, 226, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 227, 24, null),
					new ExpectedCellValue(sheetName, 228, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 229, 24, null),
					new ExpectedCellValue(sheetName, 230, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 231, 24, null),
					new ExpectedCellValue(sheetName, 232, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 233, 24, null),
					new ExpectedCellValue(sheetName, 234, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 235, 24, null),
					new ExpectedCellValue(sheetName, 236, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 237, 24, null),
					new ExpectedCellValue(sheetName, 238, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 239, 24, null),
					new ExpectedCellValue(sheetName, 240, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 241, 24, null),
					new ExpectedCellValue(sheetName, 242, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 243, 24, null),
					new ExpectedCellValue(sheetName, 244, 24, null),
					new ExpectedCellValue(sheetName, 215, 25, "Month"),
					new ExpectedCellValue(sheetName, 216, 25, "January"),
					new ExpectedCellValue(sheetName, 217, 25, "January Total"),
					new ExpectedCellValue(sheetName, 218, 25, null),
					new ExpectedCellValue(sheetName, 219, 25, null),
					new ExpectedCellValue(sheetName, 220, 25, "March"),
					new ExpectedCellValue(sheetName, 221, 25, "March Total"),
					new ExpectedCellValue(sheetName, 222, 25, null),
					new ExpectedCellValue(sheetName, 223, 25, null),
					new ExpectedCellValue(sheetName, 224, 25, "February"),
					new ExpectedCellValue(sheetName, 225, 25, "February Total"),
					new ExpectedCellValue(sheetName, 226, 25, null),
					new ExpectedCellValue(sheetName, 227, 25, null),
					new ExpectedCellValue(sheetName, 228, 25, "January"),
					new ExpectedCellValue(sheetName, 229, 25, "January Total"),
					new ExpectedCellValue(sheetName, 230, 25, null),
					new ExpectedCellValue(sheetName, 231, 25, null),
					new ExpectedCellValue(sheetName, 232, 25, "March"),
					new ExpectedCellValue(sheetName, 233, 25, "March Total"),
					new ExpectedCellValue(sheetName, 234, 25, null),
					new ExpectedCellValue(sheetName, 235, 25, null),
					new ExpectedCellValue(sheetName, 236, 25, "February"),
					new ExpectedCellValue(sheetName, 237, 25, "February Total"),
					new ExpectedCellValue(sheetName, 238, 25, null),
					new ExpectedCellValue(sheetName, 239, 25, null),
					new ExpectedCellValue(sheetName, 240, 25, "January"),
					new ExpectedCellValue(sheetName, 241, 25, "January Total"),
					new ExpectedCellValue(sheetName, 242, 25, null),
					new ExpectedCellValue(sheetName, 243, 25, null),
					new ExpectedCellValue(sheetName, 244, 25, null),
					new ExpectedCellValue(sheetName, 215, 26, "Item"),
					new ExpectedCellValue(sheetName, 216, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 217, 26, null),
					new ExpectedCellValue(sheetName, 218, 26, null),
					new ExpectedCellValue(sheetName, 219, 26, null),
					new ExpectedCellValue(sheetName, 220, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 221, 26, null),
					new ExpectedCellValue(sheetName, 222, 26, null),
					new ExpectedCellValue(sheetName, 223, 26, null),
					new ExpectedCellValue(sheetName, 224, 26, "Tent"),
					new ExpectedCellValue(sheetName, 225, 26, null),
					new ExpectedCellValue(sheetName, 226, 26, null),
					new ExpectedCellValue(sheetName, 227, 26, null),
					new ExpectedCellValue(sheetName, 228, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 229, 26, null),
					new ExpectedCellValue(sheetName, 230, 26, null),
					new ExpectedCellValue(sheetName, 231, 26, null),
					new ExpectedCellValue(sheetName, 232, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 233, 26, null),
					new ExpectedCellValue(sheetName, 234, 26, null),
					new ExpectedCellValue(sheetName, 235, 26, null),
					new ExpectedCellValue(sheetName, 236, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 237, 26, null),
					new ExpectedCellValue(sheetName, 238, 26, null),
					new ExpectedCellValue(sheetName, 239, 26, null),
					new ExpectedCellValue(sheetName, 240, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 241, 26, null),
					new ExpectedCellValue(sheetName, 242, 26, null),
					new ExpectedCellValue(sheetName, 243, 26, null),
					new ExpectedCellValue(sheetName, 244, 26, null),
					new ExpectedCellValue(sheetName, 215, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 27, 831.5),
					new ExpectedCellValue(sheetName, 217, 27, 831.5),
					new ExpectedCellValue(sheetName, 218, 27, 831.5),
					new ExpectedCellValue(sheetName, 219, 27, 831.5),
					new ExpectedCellValue(sheetName, 220, 27, 831.5),
					new ExpectedCellValue(sheetName, 221, 27, 831.5),
					new ExpectedCellValue(sheetName, 222, 27, 831.5),
					new ExpectedCellValue(sheetName, 223, 27, 831.5),
					new ExpectedCellValue(sheetName, 224, 27, 1194d),
					new ExpectedCellValue(sheetName, 225, 27, 1194d),
					new ExpectedCellValue(sheetName, 226, 27, 1194d),
					new ExpectedCellValue(sheetName, 227, 27, 1194d),
					new ExpectedCellValue(sheetName, 228, 27, 415.75),
					new ExpectedCellValue(sheetName, 229, 27, 415.75),
					new ExpectedCellValue(sheetName, 230, 27, 415.75),
					new ExpectedCellValue(sheetName, 231, 27, 415.75),
					new ExpectedCellValue(sheetName, 232, 27, 24.99),
					new ExpectedCellValue(sheetName, 233, 27, 24.99),
					new ExpectedCellValue(sheetName, 234, 27, 24.99),
					new ExpectedCellValue(sheetName, 235, 27, 24.99),
					new ExpectedCellValue(sheetName, 236, 27, 99d),
					new ExpectedCellValue(sheetName, 237, 27, 99d),
					new ExpectedCellValue(sheetName, 238, 27, 99d),
					new ExpectedCellValue(sheetName, 239, 27, 99d),
					new ExpectedCellValue(sheetName, 240, 27, 831.5),
					new ExpectedCellValue(sheetName, 241, 27, 831.5),
					new ExpectedCellValue(sheetName, 242, 27, 831.5),
					new ExpectedCellValue(sheetName, 243, 27, 831.5),
					new ExpectedCellValue(sheetName, 244, 27, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularForm.xlsx")]
		public void PivotTableCompactAndTabularFormFourRowFieldsTabularFirstSecondAndThidFieldsNonCompactLastFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularForm.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "FourRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("W215:AA244"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 215, 23, "Row Labels"),
					new ExpectedCellValue(sheetName, 216, 23, 20100007),
					new ExpectedCellValue(sheetName, 217, 23, null),
					new ExpectedCellValue(sheetName, 218, 23, null),
					new ExpectedCellValue(sheetName, 219, 23, "20100007 Total"),
					new ExpectedCellValue(sheetName, 220, 23, 20100017),
					new ExpectedCellValue(sheetName, 221, 23, null),
					new ExpectedCellValue(sheetName, 222, 23, null),
					new ExpectedCellValue(sheetName, 223, 23, "20100017 Total"),
					new ExpectedCellValue(sheetName, 224, 23, 20100070),
					new ExpectedCellValue(sheetName, 225, 23, null),
					new ExpectedCellValue(sheetName, 226, 23, null),
					new ExpectedCellValue(sheetName, 227, 23, "20100070 Total"),
					new ExpectedCellValue(sheetName, 228, 23, 20100076),
					new ExpectedCellValue(sheetName, 229, 23, null),
					new ExpectedCellValue(sheetName, 230, 23, null),
					new ExpectedCellValue(sheetName, 231, 23, "20100076 Total"),
					new ExpectedCellValue(sheetName, 232, 23, 20100083),
					new ExpectedCellValue(sheetName, 233, 23, null),
					new ExpectedCellValue(sheetName, 234, 23, null),
					new ExpectedCellValue(sheetName, 235, 23, "20100083 Total"),
					new ExpectedCellValue(sheetName, 236, 23, 20100085),
					new ExpectedCellValue(sheetName, 237, 23, null),
					new ExpectedCellValue(sheetName, 238, 23, null),
					new ExpectedCellValue(sheetName, 239, 23, "20100085 Total"),
					new ExpectedCellValue(sheetName, 240, 23, 20100090),
					new ExpectedCellValue(sheetName, 241, 23, null),
					new ExpectedCellValue(sheetName, 242, 23, null),
					new ExpectedCellValue(sheetName, 243, 23, "20100090 Total"),
					new ExpectedCellValue(sheetName, 244, 23, "Grand Total"),
					new ExpectedCellValue(sheetName, 215, 24, "Location"),
					new ExpectedCellValue(sheetName, 216, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 217, 24, null),
					new ExpectedCellValue(sheetName, 218, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 219, 24, null),
					new ExpectedCellValue(sheetName, 220, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 221, 24, null),
					new ExpectedCellValue(sheetName, 222, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 223, 24, null),
					new ExpectedCellValue(sheetName, 224, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 225, 24, null),
					new ExpectedCellValue(sheetName, 226, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 227, 24, null),
					new ExpectedCellValue(sheetName, 228, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 229, 24, null),
					new ExpectedCellValue(sheetName, 230, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 231, 24, null),
					new ExpectedCellValue(sheetName, 232, 24, "Chicago"),
					new ExpectedCellValue(sheetName, 233, 24, null),
					new ExpectedCellValue(sheetName, 234, 24, "Chicago Total"),
					new ExpectedCellValue(sheetName, 235, 24, null),
					new ExpectedCellValue(sheetName, 236, 24, "San Francisco"),
					new ExpectedCellValue(sheetName, 237, 24, null),
					new ExpectedCellValue(sheetName, 238, 24, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 239, 24, null),
					new ExpectedCellValue(sheetName, 240, 24, "Nashville"),
					new ExpectedCellValue(sheetName, 241, 24, null),
					new ExpectedCellValue(sheetName, 242, 24, "Nashville Total"),
					new ExpectedCellValue(sheetName, 243, 24, null),
					new ExpectedCellValue(sheetName, 244, 24, null),
					new ExpectedCellValue(sheetName, 215, 25, "Month"),
					new ExpectedCellValue(sheetName, 216, 25, "January"),
					new ExpectedCellValue(sheetName, 217, 25, "January Total"),
					new ExpectedCellValue(sheetName, 218, 25, null),
					new ExpectedCellValue(sheetName, 219, 25, null),
					new ExpectedCellValue(sheetName, 220, 25, "March"),
					new ExpectedCellValue(sheetName, 221, 25, "March Total"),
					new ExpectedCellValue(sheetName, 222, 25, null),
					new ExpectedCellValue(sheetName, 223, 25, null),
					new ExpectedCellValue(sheetName, 224, 25, "February"),
					new ExpectedCellValue(sheetName, 225, 25, "February Total"),
					new ExpectedCellValue(sheetName, 226, 25, null),
					new ExpectedCellValue(sheetName, 227, 25, null),
					new ExpectedCellValue(sheetName, 228, 25, "January"),
					new ExpectedCellValue(sheetName, 229, 25, "January Total"),
					new ExpectedCellValue(sheetName, 230, 25, null),
					new ExpectedCellValue(sheetName, 231, 25, null),
					new ExpectedCellValue(sheetName, 232, 25, "March"),
					new ExpectedCellValue(sheetName, 233, 25, "March Total"),
					new ExpectedCellValue(sheetName, 234, 25, null),
					new ExpectedCellValue(sheetName, 235, 25, null),
					new ExpectedCellValue(sheetName, 236, 25, "February"),
					new ExpectedCellValue(sheetName, 237, 25, "February Total"),
					new ExpectedCellValue(sheetName, 238, 25, null),
					new ExpectedCellValue(sheetName, 239, 25, null),
					new ExpectedCellValue(sheetName, 240, 25, "January"),
					new ExpectedCellValue(sheetName, 241, 25, "January Total"),
					new ExpectedCellValue(sheetName, 242, 25, null),
					new ExpectedCellValue(sheetName, 243, 25, null),
					new ExpectedCellValue(sheetName, 244, 25, null),
					new ExpectedCellValue(sheetName, 215, 26, "Item"),
					new ExpectedCellValue(sheetName, 216, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 217, 26, null),
					new ExpectedCellValue(sheetName, 218, 26, null),
					new ExpectedCellValue(sheetName, 219, 26, null),
					new ExpectedCellValue(sheetName, 220, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 221, 26, null),
					new ExpectedCellValue(sheetName, 222, 26, null),
					new ExpectedCellValue(sheetName, 223, 26, null),
					new ExpectedCellValue(sheetName, 224, 26, "Tent"),
					new ExpectedCellValue(sheetName, 225, 26, null),
					new ExpectedCellValue(sheetName, 226, 26, null),
					new ExpectedCellValue(sheetName, 227, 26, null),
					new ExpectedCellValue(sheetName, 228, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 229, 26, null),
					new ExpectedCellValue(sheetName, 230, 26, null),
					new ExpectedCellValue(sheetName, 231, 26, null),
					new ExpectedCellValue(sheetName, 232, 26, "Headlamp"),
					new ExpectedCellValue(sheetName, 233, 26, null),
					new ExpectedCellValue(sheetName, 234, 26, null),
					new ExpectedCellValue(sheetName, 235, 26, null),
					new ExpectedCellValue(sheetName, 236, 26, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 237, 26, null),
					new ExpectedCellValue(sheetName, 238, 26, null),
					new ExpectedCellValue(sheetName, 239, 26, null),
					new ExpectedCellValue(sheetName, 240, 26, "Car Rack"),
					new ExpectedCellValue(sheetName, 241, 26, null),
					new ExpectedCellValue(sheetName, 242, 26, null),
					new ExpectedCellValue(sheetName, 243, 26, null),
					new ExpectedCellValue(sheetName, 244, 26, null),
					new ExpectedCellValue(sheetName, 215, 27, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 27, 831.5),
					new ExpectedCellValue(sheetName, 217, 27, 831.5),
					new ExpectedCellValue(sheetName, 218, 27, 831.5),
					new ExpectedCellValue(sheetName, 219, 27, 831.5),
					new ExpectedCellValue(sheetName, 220, 27, 831.5),
					new ExpectedCellValue(sheetName, 221, 27, 831.5),
					new ExpectedCellValue(sheetName, 222, 27, 831.5),
					new ExpectedCellValue(sheetName, 223, 27, 831.5),
					new ExpectedCellValue(sheetName, 224, 27, 1194d),
					new ExpectedCellValue(sheetName, 225, 27, 1194d),
					new ExpectedCellValue(sheetName, 226, 27, 1194d),
					new ExpectedCellValue(sheetName, 227, 27, 1194d),
					new ExpectedCellValue(sheetName, 228, 27, 415.75),
					new ExpectedCellValue(sheetName, 229, 27, 415.75),
					new ExpectedCellValue(sheetName, 230, 27, 415.75),
					new ExpectedCellValue(sheetName, 231, 27, 415.75),
					new ExpectedCellValue(sheetName, 232, 27, 24.99),
					new ExpectedCellValue(sheetName, 233, 27, 24.99),
					new ExpectedCellValue(sheetName, 234, 27, 24.99),
					new ExpectedCellValue(sheetName, 235, 27, 24.99),
					new ExpectedCellValue(sheetName, 236, 27, 99d),
					new ExpectedCellValue(sheetName, 237, 27, 99d),
					new ExpectedCellValue(sheetName, 238, 27, 99d),
					new ExpectedCellValue(sheetName, 239, 27, 99d),
					new ExpectedCellValue(sheetName, 240, 27, 831.5),
					new ExpectedCellValue(sheetName, 241, 27, 831.5),
					new ExpectedCellValue(sheetName, 242, 27, 831.5),
					new ExpectedCellValue(sheetName, 243, 27, 831.5),
					new ExpectedCellValue(sheetName, 244, 27, 4228.24)
				});
			}
		}
		#endregion
		
		#region Multiple Data Fields
		// Two Row Fields Multiple Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H7:K30"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 7, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 8, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 9, "Month"),
					new ExpectedCellValue(sheetName, 8, 9, "January"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "March"),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, null),
					new ExpectedCellValue(sheetName, 14, 9, "January"),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, "February"),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, "March"),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, "January"),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, "February"),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 7, 10, "Values"),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, 415.75),
					new ExpectedCellValue(sheetName, 10, 11, 831.5),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, 24.99),
					new ExpectedCellValue(sheetName, 13, 11, 24.99),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, 415.75),
					new ExpectedCellValue(sheetName, 16, 11, 831.5),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, 199d),
					new ExpectedCellValue(sheetName, 19, 11, 1194d),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, 415.75),
					new ExpectedCellValue(sheetName, 22, 11, 831.5),
					new ExpectedCellValue(sheetName, 23, 11, null),
					new ExpectedCellValue(sheetName, 24, 11, 415.75),
					new ExpectedCellValue(sheetName, 25, 11, 415.75),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, 99d),
					new ExpectedCellValue(sheetName, 28, 11, 99d),
					new ExpectedCellValue(sheetName, 29, 11, 1985.99),
					new ExpectedCellValue(sheetName, 30, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H7:K36"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 7, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 8, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 8, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 8, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 33, 8, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 8, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 9, "Month"),
					new ExpectedCellValue(sheetName, 8, 9, "January"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "March"),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, null),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, "January"),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, "February"),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, "March"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, "January"),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, "February"),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 7, 10, "Values"),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 21, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 29, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, 415.75),
					new ExpectedCellValue(sheetName, 10, 11, 831.5),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, 24.99),
					new ExpectedCellValue(sheetName, 13, 11, 24.99),
					new ExpectedCellValue(sheetName, 14, 11, 440.74),
					new ExpectedCellValue(sheetName, 15, 11, 856.49),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, 415.75),
					new ExpectedCellValue(sheetName, 18, 11, 831.5),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, 199d),
					new ExpectedCellValue(sheetName, 21, 11, 1194d),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, 415.75),
					new ExpectedCellValue(sheetName, 24, 11, 831.5),
					new ExpectedCellValue(sheetName, 25, 11, 1030.5),
					new ExpectedCellValue(sheetName, 26, 11, 2857d),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, 415.75),
					new ExpectedCellValue(sheetName, 29, 11, 415.75),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, 99d),
					new ExpectedCellValue(sheetName, 32, 11, 99d),
					new ExpectedCellValue(sheetName, 33, 11, 514.75),
					new ExpectedCellValue(sheetName, 34, 11, 514.75),
					new ExpectedCellValue(sheetName, 35, 11, 1985.99),
					new ExpectedCellValue(sheetName, 36, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H7:K36"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 7, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 8, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 8, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 8, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 33, 8, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 8, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 9, "Month"),
					new ExpectedCellValue(sheetName, 8, 9, "January"),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, "March"),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, null),
					new ExpectedCellValue(sheetName, 14, 9, null),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, "January"),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, "February"),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, "March"),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, "January"),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, "February"),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 7, 10, "Values"),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 21, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 29, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, 415.75),
					new ExpectedCellValue(sheetName, 10, 11, 831.5),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, 24.99),
					new ExpectedCellValue(sheetName, 13, 11, 24.99),
					new ExpectedCellValue(sheetName, 14, 11, 440.74),
					new ExpectedCellValue(sheetName, 15, 11, 856.49),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, 415.75),
					new ExpectedCellValue(sheetName, 18, 11, 831.5),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, 199d),
					new ExpectedCellValue(sheetName, 21, 11, 1194d),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, 415.75),
					new ExpectedCellValue(sheetName, 24, 11, 831.5),
					new ExpectedCellValue(sheetName, 25, 11, 1030.5),
					new ExpectedCellValue(sheetName, 26, 11, 2857d),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, 415.75),
					new ExpectedCellValue(sheetName, 29, 11, 415.75),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, 99d),
					new ExpectedCellValue(sheetName, 32, 11, 99d),
					new ExpectedCellValue(sheetName, 33, 11, 514.75),
					new ExpectedCellValue(sheetName, 34, 11, 514.75),
					new ExpectedCellValue(sheetName, 35, 11, 1985.99),
					new ExpectedCellValue(sheetName, 36, 11, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N7:Q26"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 7, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 8, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 25, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 15, "Month"),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, "January"),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, "March"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, "January"),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, "February"),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, "March"),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, "January"),
					new ExpectedCellValue(sheetName, 22, 15, null),
					new ExpectedCellValue(sheetName, 23, 15, "February"),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, null),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 7, 16, "Values"),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, 415.75),
					new ExpectedCellValue(sheetName, 10, 17, 831.5),
					new ExpectedCellValue(sheetName, 11, 17, 24.99),
					new ExpectedCellValue(sheetName, 12, 17, 24.99),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, 415.75),
					new ExpectedCellValue(sheetName, 15, 17, 831.5),
					new ExpectedCellValue(sheetName, 16, 17, 199d),
					new ExpectedCellValue(sheetName, 17, 17, 1194d),
					new ExpectedCellValue(sheetName, 18, 17, 415.75),
					new ExpectedCellValue(sheetName, 19, 17, 831.5),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, 415.75),
					new ExpectedCellValue(sheetName, 22, 17, 415.75),
					new ExpectedCellValue(sheetName, 23, 17, 99d),
					new ExpectedCellValue(sheetName, 24, 17, 99d),
					new ExpectedCellValue(sheetName, 25, 17, 1985.99),
					new ExpectedCellValue(sheetName, 26, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N7:Q32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 7, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 8, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 14, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 23, 14, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 29, 14, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 14, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 15, "Month"),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, "January"),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, "March"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, "January"),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, "February"),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, "March"),
					new ExpectedCellValue(sheetName, 21, 15, null),
					new ExpectedCellValue(sheetName, 22, 15, null),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, "January"),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, "February"),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 29, 15, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 7, 16, "Values"),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 21, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 31, 16, null),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, 415.75),
					new ExpectedCellValue(sheetName, 10, 17, 831.5),
					new ExpectedCellValue(sheetName, 11, 17, 24.99),
					new ExpectedCellValue(sheetName, 12, 17, 24.99),
					new ExpectedCellValue(sheetName, 13, 17, 440.74),
					new ExpectedCellValue(sheetName, 14, 17, 856.49),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, 415.75),
					new ExpectedCellValue(sheetName, 17, 17, 831.5),
					new ExpectedCellValue(sheetName, 18, 17, 199d),
					new ExpectedCellValue(sheetName, 19, 17, 1194d),
					new ExpectedCellValue(sheetName, 20, 17, 415.75),
					new ExpectedCellValue(sheetName, 21, 17, 831.5),
					new ExpectedCellValue(sheetName, 22, 17, 1030.5),
					new ExpectedCellValue(sheetName, 23, 17, 2857d),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, 415.75),
					new ExpectedCellValue(sheetName, 26, 17, 415.75),
					new ExpectedCellValue(sheetName, 27, 17, 99d),
					new ExpectedCellValue(sheetName, 28, 17, 99d),
					new ExpectedCellValue(sheetName, 29, 17, 514.75),
					new ExpectedCellValue(sheetName, 30, 17, 514.75),
					new ExpectedCellValue(sheetName, 31, 17, 1985.99),
					new ExpectedCellValue(sheetName, 32, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N7:Q32"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 7, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 8, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 14, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 23, 14, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 29, 14, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 14, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 7, 15, "Month"),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, "January"),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, "March"),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, "January"),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, "February"),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, "March"),
					new ExpectedCellValue(sheetName, 21, 15, null),
					new ExpectedCellValue(sheetName, 22, 15, null),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, "January"),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, "February"),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 29, 15, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 7, 16, "Values"),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 11, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 12, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 18, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 21, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, null),
					new ExpectedCellValue(sheetName, 31, 16, null),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, 415.75),
					new ExpectedCellValue(sheetName, 10, 17, 831.5),
					new ExpectedCellValue(sheetName, 11, 17, 24.99),
					new ExpectedCellValue(sheetName, 12, 17, 24.99),
					new ExpectedCellValue(sheetName, 13, 17, 440.74),
					new ExpectedCellValue(sheetName, 14, 17, 856.49),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, 415.75),
					new ExpectedCellValue(sheetName, 17, 17, 831.5),
					new ExpectedCellValue(sheetName, 18, 17, 199d),
					new ExpectedCellValue(sheetName, 19, 17, 1194d),
					new ExpectedCellValue(sheetName, 20, 17, 415.75),
					new ExpectedCellValue(sheetName, 21, 17, 831.5),
					new ExpectedCellValue(sheetName, 22, 17, 1030.5),
					new ExpectedCellValue(sheetName, 23, 17, 2857d),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, 415.75),
					new ExpectedCellValue(sheetName, 26, 17, 415.75),
					new ExpectedCellValue(sheetName, 27, 17, 99d),
					new ExpectedCellValue(sheetName, 28, 17, 99d),
					new ExpectedCellValue(sheetName, 29, 17, 514.75),
					new ExpectedCellValue(sheetName, 30, 17, 514.75),
					new ExpectedCellValue(sheetName, 31, 17, 1985.99),
					new ExpectedCellValue(sheetName, 32, 17, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactLastFieldInnerDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H41:J63"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, null),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 63, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 9, "Values"),
					new ExpectedCellValue(sheetName, 42, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 43, 9, "January"),
					new ExpectedCellValue(sheetName, 44, 9, "March"),
					new ExpectedCellValue(sheetName, 45, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 9, "January"),
					new ExpectedCellValue(sheetName, 47, 9, "March"),
					new ExpectedCellValue(sheetName, 48, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 9, "January"),
					new ExpectedCellValue(sheetName, 50, 9, "February"),
					new ExpectedCellValue(sheetName, 51, 9, "March"),
					new ExpectedCellValue(sheetName, 52, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 53, 9, "January"),
					new ExpectedCellValue(sheetName, 54, 9, "February"),
					new ExpectedCellValue(sheetName, 55, 9, "March"),
					new ExpectedCellValue(sheetName, 56, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 57, 9, "January"),
					new ExpectedCellValue(sheetName, 58, 9, "February"),
					new ExpectedCellValue(sheetName, 59, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 60, 9, "January"),
					new ExpectedCellValue(sheetName, 61, 9, "February"),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, 415.75),
					new ExpectedCellValue(sheetName, 44, 10, 24.99),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, 831.5),
					new ExpectedCellValue(sheetName, 47, 10, 24.99),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, 415.75),
					new ExpectedCellValue(sheetName, 50, 10, 199d),
					new ExpectedCellValue(sheetName, 51, 10, 415.75),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, 831.5),
					new ExpectedCellValue(sheetName, 54, 10, 1194d),
					new ExpectedCellValue(sheetName, 55, 10, 831.5),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, 415.75),
					new ExpectedCellValue(sheetName, 58, 10, 99d),
					new ExpectedCellValue(sheetName, 59, 10, null),
					new ExpectedCellValue(sheetName, 60, 10, 415.75),
					new ExpectedCellValue(sheetName, 61, 10, 99d),
					new ExpectedCellValue(sheetName, 62, 10, 1985.99),
					new ExpectedCellValue(sheetName, 63, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactLastFieldInnerDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H41:J69"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 8, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 59, 8, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 60, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 67, 8, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 68, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 9, "Values"),
					new ExpectedCellValue(sheetName, 42, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 43, 9, "January"),
					new ExpectedCellValue(sheetName, 44, 9, "March"),
					new ExpectedCellValue(sheetName, 45, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 9, "January"),
					new ExpectedCellValue(sheetName, 47, 9, "March"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 9, "January"),
					new ExpectedCellValue(sheetName, 52, 9, "February"),
					new ExpectedCellValue(sheetName, 53, 9, "March"),
					new ExpectedCellValue(sheetName, 54, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 55, 9, "January"),
					new ExpectedCellValue(sheetName, 56, 9, "February"),
					new ExpectedCellValue(sheetName, 57, 9, "March"),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 61, 9, "January"),
					new ExpectedCellValue(sheetName, 62, 9, "February"),
					new ExpectedCellValue(sheetName, 63, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 64, 9, "January"),
					new ExpectedCellValue(sheetName, 65, 9, "February"),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, null),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, 415.75),
					new ExpectedCellValue(sheetName, 44, 10, 24.99),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, 831.5),
					new ExpectedCellValue(sheetName, 47, 10, 24.99),
					new ExpectedCellValue(sheetName, 48, 10, 440.74),
					new ExpectedCellValue(sheetName, 49, 10, 856.49),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, 415.75),
					new ExpectedCellValue(sheetName, 52, 10, 199d),
					new ExpectedCellValue(sheetName, 53, 10, 415.75),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, 831.5),
					new ExpectedCellValue(sheetName, 56, 10, 1194d),
					new ExpectedCellValue(sheetName, 57, 10, 831.5),
					new ExpectedCellValue(sheetName, 58, 10, 1030.5),
					new ExpectedCellValue(sheetName, 59, 10, 2857d),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, 415.75),
					new ExpectedCellValue(sheetName, 62, 10, 99d),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, 415.75),
					new ExpectedCellValue(sheetName, 65, 10, 99d),
					new ExpectedCellValue(sheetName, 66, 10, 514.75),
					new ExpectedCellValue(sheetName, 67, 10, 514.75),
					new ExpectedCellValue(sheetName, 68, 10, 1985.99),
					new ExpectedCellValue(sheetName, 69, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactLastFieldInnerDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H41:J69"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 8, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 59, 8, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 60, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 67, 8, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 68, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 9, "Values"),
					new ExpectedCellValue(sheetName, 42, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 43, 9, "January"),
					new ExpectedCellValue(sheetName, 44, 9, "March"),
					new ExpectedCellValue(sheetName, 45, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 9, "January"),
					new ExpectedCellValue(sheetName, 47, 9, "March"),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 9, "January"),
					new ExpectedCellValue(sheetName, 52, 9, "February"),
					new ExpectedCellValue(sheetName, 53, 9, "March"),
					new ExpectedCellValue(sheetName, 54, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 55, 9, "January"),
					new ExpectedCellValue(sheetName, 56, 9, "February"),
					new ExpectedCellValue(sheetName, 57, 9, "March"),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 61, 9, "January"),
					new ExpectedCellValue(sheetName, 62, 9, "February"),
					new ExpectedCellValue(sheetName, 63, 9, "Sum of Total"),
					new ExpectedCellValue(sheetName, 64, 9, "January"),
					new ExpectedCellValue(sheetName, 65, 9, "February"),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, null),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, 415.75),
					new ExpectedCellValue(sheetName, 44, 10, 24.99),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, 831.5),
					new ExpectedCellValue(sheetName, 47, 10, 24.99),
					new ExpectedCellValue(sheetName, 48, 10, 440.74),
					new ExpectedCellValue(sheetName, 49, 10, 856.49),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, 415.75),
					new ExpectedCellValue(sheetName, 52, 10, 199d),
					new ExpectedCellValue(sheetName, 53, 10, 415.75),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, 831.5),
					new ExpectedCellValue(sheetName, 56, 10, 1194d),
					new ExpectedCellValue(sheetName, 57, 10, 831.5),
					new ExpectedCellValue(sheetName, 58, 10, 1030.5),
					new ExpectedCellValue(sheetName, 59, 10, 2857d),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, 415.75),
					new ExpectedCellValue(sheetName, 62, 10, 99d),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, 415.75),
					new ExpectedCellValue(sheetName, 65, 10, 99d),
					new ExpectedCellValue(sheetName, 66, 10, 514.75),
					new ExpectedCellValue(sheetName, 67, 10, 514.75),
					new ExpectedCellValue(sheetName, 68, 10, 1985.99),
					new ExpectedCellValue(sheetName, 69, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularLastFieldInnerDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N41:P66"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, null),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, null),
					new ExpectedCellValue(sheetName, 58, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, null),
					new ExpectedCellValue(sheetName, 61, 14, null),
					new ExpectedCellValue(sheetName, 62, 14, null),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, null),
					new ExpectedCellValue(sheetName, 65, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 66, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 15, "Values"),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 15, "January"),
					new ExpectedCellValue(sheetName, 45, 15, "March"),
					new ExpectedCellValue(sheetName, 46, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 15, "January"),
					new ExpectedCellValue(sheetName, 48, 15, "March"),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 15, "January"),
					new ExpectedCellValue(sheetName, 52, 15, "February"),
					new ExpectedCellValue(sheetName, 53, 15, "March"),
					new ExpectedCellValue(sheetName, 54, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 55, 15, "January"),
					new ExpectedCellValue(sheetName, 56, 15, "February"),
					new ExpectedCellValue(sheetName, 57, 15, "March"),
					new ExpectedCellValue(sheetName, 58, 15, null),
					new ExpectedCellValue(sheetName, 59, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 60, 15, "January"),
					new ExpectedCellValue(sheetName, 61, 15, "February"),
					new ExpectedCellValue(sheetName, 62, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 63, 15, "January"),
					new ExpectedCellValue(sheetName, 64, 15, "February"),
					new ExpectedCellValue(sheetName, 65, 15, null),
					new ExpectedCellValue(sheetName, 66, 15, null),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, 415.75),
					new ExpectedCellValue(sheetName, 45, 16, 24.99),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, 831.5),
					new ExpectedCellValue(sheetName, 48, 16, 24.99),
					new ExpectedCellValue(sheetName, 49, 16, null),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, 415.75),
					new ExpectedCellValue(sheetName, 52, 16, 199d),
					new ExpectedCellValue(sheetName, 53, 16, 415.75),
					new ExpectedCellValue(sheetName, 54, 16, null),
					new ExpectedCellValue(sheetName, 55, 16, 831.5),
					new ExpectedCellValue(sheetName, 56, 16, 1194d),
					new ExpectedCellValue(sheetName, 57, 16, 831.5),
					new ExpectedCellValue(sheetName, 58, 16, null),
					new ExpectedCellValue(sheetName, 59, 16, null),
					new ExpectedCellValue(sheetName, 60, 16, 415.75),
					new ExpectedCellValue(sheetName, 61, 16, 99d),
					new ExpectedCellValue(sheetName, 62, 16, null),
					new ExpectedCellValue(sheetName, 63, 16, 415.75),
					new ExpectedCellValue(sheetName, 64, 16, 99d),
					new ExpectedCellValue(sheetName, 65, 16, 1985.99),
					new ExpectedCellValue(sheetName, 66, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularLastFieldInnerDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N41:P72"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 14, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, null),
					new ExpectedCellValue(sheetName, 58, 14, null),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 61, 14, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, null),
					new ExpectedCellValue(sheetName, 68, 14, null),
					new ExpectedCellValue(sheetName, 69, 14, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 70, 14, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 15, "Values"),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 15, "January"),
					new ExpectedCellValue(sheetName, 45, 15, "March"),
					new ExpectedCellValue(sheetName, 46, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 15, "January"),
					new ExpectedCellValue(sheetName, 48, 15, "March"),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, null),
					new ExpectedCellValue(sheetName, 52, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 15, "January"),
					new ExpectedCellValue(sheetName, 54, 15, "February"),
					new ExpectedCellValue(sheetName, 55, 15, "March"),
					new ExpectedCellValue(sheetName, 56, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 15, "January"),
					new ExpectedCellValue(sheetName, 58, 15, "February"),
					new ExpectedCellValue(sheetName, 59, 15, "March"),
					new ExpectedCellValue(sheetName, 60, 15, null),
					new ExpectedCellValue(sheetName, 61, 15, null),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 15, "January"),
					new ExpectedCellValue(sheetName, 65, 15, "February"),
					new ExpectedCellValue(sheetName, 66, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 67, 15, "January"),
					new ExpectedCellValue(sheetName, 68, 15, "February"),
					new ExpectedCellValue(sheetName, 69, 15, null),
					new ExpectedCellValue(sheetName, 70, 15, null),
					new ExpectedCellValue(sheetName, 71, 15, null),
					new ExpectedCellValue(sheetName, 72, 15, null),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, 415.75),
					new ExpectedCellValue(sheetName, 45, 16, 24.99),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, 831.5),
					new ExpectedCellValue(sheetName, 48, 16, 24.99),
					new ExpectedCellValue(sheetName, 49, 16, 440.74),
					new ExpectedCellValue(sheetName, 50, 16, 856.49),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, null),
					new ExpectedCellValue(sheetName, 53, 16, 415.75),
					new ExpectedCellValue(sheetName, 54, 16, 199d),
					new ExpectedCellValue(sheetName, 55, 16, 415.75),
					new ExpectedCellValue(sheetName, 56, 16, null),
					new ExpectedCellValue(sheetName, 57, 16, 831.5),
					new ExpectedCellValue(sheetName, 58, 16, 1194d),
					new ExpectedCellValue(sheetName, 59, 16, 831.5),
					new ExpectedCellValue(sheetName, 60, 16, 1030.5),
					new ExpectedCellValue(sheetName, 61, 16, 2857d),
					new ExpectedCellValue(sheetName, 62, 16, null),
					new ExpectedCellValue(sheetName, 63, 16, null),
					new ExpectedCellValue(sheetName, 64, 16, 415.75),
					new ExpectedCellValue(sheetName, 65, 16, 99d),
					new ExpectedCellValue(sheetName, 66, 16, null),
					new ExpectedCellValue(sheetName, 67, 16, 415.75),
					new ExpectedCellValue(sheetName, 68, 16, 99d),
					new ExpectedCellValue(sheetName, 69, 16, 514.75),
					new ExpectedCellValue(sheetName, 70, 16, 514.75),
					new ExpectedCellValue(sheetName, 71, 16, 1985.99),
					new ExpectedCellValue(sheetName, 72, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularLastFieldInnerDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N41:P72"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 41, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 42, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 14, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, null),
					new ExpectedCellValue(sheetName, 58, 14, null),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 61, 14, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, null),
					new ExpectedCellValue(sheetName, 68, 14, null),
					new ExpectedCellValue(sheetName, 69, 14, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 70, 14, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 15, "Values"),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 15, "January"),
					new ExpectedCellValue(sheetName, 45, 15, "March"),
					new ExpectedCellValue(sheetName, 46, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 15, "January"),
					new ExpectedCellValue(sheetName, 48, 15, "March"),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, null),
					new ExpectedCellValue(sheetName, 52, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 15, "January"),
					new ExpectedCellValue(sheetName, 54, 15, "February"),
					new ExpectedCellValue(sheetName, 55, 15, "March"),
					new ExpectedCellValue(sheetName, 56, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 15, "January"),
					new ExpectedCellValue(sheetName, 58, 15, "February"),
					new ExpectedCellValue(sheetName, 59, 15, "March"),
					new ExpectedCellValue(sheetName, 60, 15, null),
					new ExpectedCellValue(sheetName, 61, 15, null),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 15, "January"),
					new ExpectedCellValue(sheetName, 65, 15, "February"),
					new ExpectedCellValue(sheetName, 66, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 67, 15, "January"),
					new ExpectedCellValue(sheetName, 68, 15, "February"),
					new ExpectedCellValue(sheetName, 69, 15, null),
					new ExpectedCellValue(sheetName, 70, 15, null),
					new ExpectedCellValue(sheetName, 71, 15, null),
					new ExpectedCellValue(sheetName, 72, 15, null),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, 415.75),
					new ExpectedCellValue(sheetName, 45, 16, 24.99),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, 831.5),
					new ExpectedCellValue(sheetName, 48, 16, 24.99),
					new ExpectedCellValue(sheetName, 49, 16, 440.74),
					new ExpectedCellValue(sheetName, 50, 16, 856.49),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, null),
					new ExpectedCellValue(sheetName, 53, 16, 415.75),
					new ExpectedCellValue(sheetName, 54, 16, 199d),
					new ExpectedCellValue(sheetName, 55, 16, 415.75),
					new ExpectedCellValue(sheetName, 56, 16, null),
					new ExpectedCellValue(sheetName, 57, 16, 831.5),
					new ExpectedCellValue(sheetName, 58, 16, 1194d),
					new ExpectedCellValue(sheetName, 59, 16, 831.5),
					new ExpectedCellValue(sheetName, 60, 16, 1030.5),
					new ExpectedCellValue(sheetName, 61, 16, 2857d),
					new ExpectedCellValue(sheetName, 62, 16, null),
					new ExpectedCellValue(sheetName, 63, 16, null),
					new ExpectedCellValue(sheetName, 64, 16, 415.75),
					new ExpectedCellValue(sheetName, 65, 16, 99d),
					new ExpectedCellValue(sheetName, 66, 16, null),
					new ExpectedCellValue(sheetName, 67, 16, 415.75),
					new ExpectedCellValue(sheetName, 68, 16, 99d),
					new ExpectedCellValue(sheetName, 69, 16, 514.75),
					new ExpectedCellValue(sheetName, 70, 16, 514.75),
					new ExpectedCellValue(sheetName, 71, 16, 1985.99),
					new ExpectedCellValue(sheetName, 72, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularSecondFieldNonCompactLastFieldFirstDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H76:J94"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 76, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 77, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 81, 8, null),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 8, null),
					new ExpectedCellValue(sheetName, 85, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 86, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 87, 8, null),
					new ExpectedCellValue(sheetName, 88, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 89, 8, null),
					new ExpectedCellValue(sheetName, 90, 8, null),
					new ExpectedCellValue(sheetName, 91, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 92, 8, null),
					new ExpectedCellValue(sheetName, 93, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 9, "Month"),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, "January"),
					new ExpectedCellValue(sheetName, 79, 9, "March"),
					new ExpectedCellValue(sheetName, 80, 9, "January"),
					new ExpectedCellValue(sheetName, 81, 9, "February"),
					new ExpectedCellValue(sheetName, 82, 9, "March"),
					new ExpectedCellValue(sheetName, 83, 9, "January"),
					new ExpectedCellValue(sheetName, 84, 9, "February"),
					new ExpectedCellValue(sheetName, 85, 9, null),
					new ExpectedCellValue(sheetName, 86, 9, "January"),
					new ExpectedCellValue(sheetName, 87, 9, "March"),
					new ExpectedCellValue(sheetName, 88, 9, "January"),
					new ExpectedCellValue(sheetName, 89, 9, "February"),
					new ExpectedCellValue(sheetName, 90, 9, "March"),
					new ExpectedCellValue(sheetName, 91, 9, "January"),
					new ExpectedCellValue(sheetName, 92, 9, "February"),
					new ExpectedCellValue(sheetName, 93, 9, null),
					new ExpectedCellValue(sheetName, 94, 9, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, null),
					new ExpectedCellValue(sheetName, 78, 10, 415.75),
					new ExpectedCellValue(sheetName, 79, 10, 24.99),
					new ExpectedCellValue(sheetName, 80, 10, 415.75),
					new ExpectedCellValue(sheetName, 81, 10, 199d),
					new ExpectedCellValue(sheetName, 82, 10, 415.75),
					new ExpectedCellValue(sheetName, 83, 10, 415.75),
					new ExpectedCellValue(sheetName, 84, 10, 99d),
					new ExpectedCellValue(sheetName, 85, 10, null),
					new ExpectedCellValue(sheetName, 86, 10, 831.5),
					new ExpectedCellValue(sheetName, 87, 10, 24.99),
					new ExpectedCellValue(sheetName, 88, 10, 831.5),
					new ExpectedCellValue(sheetName, 89, 10, 1194d),
					new ExpectedCellValue(sheetName, 90, 10, 831.5),
					new ExpectedCellValue(sheetName, 91, 10, 415.75),
					new ExpectedCellValue(sheetName, 92, 10, 99d),
					new ExpectedCellValue(sheetName, 93, 10, 1985.99),
					new ExpectedCellValue(sheetName, 94, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularSecondFieldNonCompactLastFieldFirstDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H76:J100"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 76, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 77, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 81, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 85, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 86, 8, null),
					new ExpectedCellValue(sheetName, 87, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 90, 8, null),
					new ExpectedCellValue(sheetName, 91, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 92, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 93, 8, null),
					new ExpectedCellValue(sheetName, 94, 8, null),
					new ExpectedCellValue(sheetName, 95, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 96, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 99, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 9, "Month"),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, "January"),
					new ExpectedCellValue(sheetName, 79, 9, "March"),
					new ExpectedCellValue(sheetName, 80, 9, null),
					new ExpectedCellValue(sheetName, 81, 9, "January"),
					new ExpectedCellValue(sheetName, 82, 9, "February"),
					new ExpectedCellValue(sheetName, 83, 9, "March"),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, "January"),
					new ExpectedCellValue(sheetName, 86, 9, "February"),
					new ExpectedCellValue(sheetName, 87, 9, null),
					new ExpectedCellValue(sheetName, 88, 9, null),
					new ExpectedCellValue(sheetName, 89, 9, "January"),
					new ExpectedCellValue(sheetName, 90, 9, "March"),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, "January"),
					new ExpectedCellValue(sheetName, 93, 9, "February"),
					new ExpectedCellValue(sheetName, 94, 9, "March"),
					new ExpectedCellValue(sheetName, 95, 9, null),
					new ExpectedCellValue(sheetName, 96, 9, "January"),
					new ExpectedCellValue(sheetName, 97, 9, "February"),
					new ExpectedCellValue(sheetName, 98, 9, null),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, null),
					new ExpectedCellValue(sheetName, 78, 10, 415.75),
					new ExpectedCellValue(sheetName, 79, 10, 24.99),
					new ExpectedCellValue(sheetName, 80, 10, 440.74),
					new ExpectedCellValue(sheetName, 81, 10, 415.75),
					new ExpectedCellValue(sheetName, 82, 10, 199d),
					new ExpectedCellValue(sheetName, 83, 10, 415.75),
					new ExpectedCellValue(sheetName, 84, 10, 1030.5),
					new ExpectedCellValue(sheetName, 85, 10, 415.75),
					new ExpectedCellValue(sheetName, 86, 10, 99d),
					new ExpectedCellValue(sheetName, 87, 10, 514.75),
					new ExpectedCellValue(sheetName, 88, 10, null),
					new ExpectedCellValue(sheetName, 89, 10, 831.5),
					new ExpectedCellValue(sheetName, 90, 10, 24.99),
					new ExpectedCellValue(sheetName, 91, 10, 856.49),
					new ExpectedCellValue(sheetName, 92, 10, 831.5),
					new ExpectedCellValue(sheetName, 93, 10, 1194d),
					new ExpectedCellValue(sheetName, 94, 10, 831.5),
					new ExpectedCellValue(sheetName, 95, 10, 2857d),
					new ExpectedCellValue(sheetName, 96, 10, 415.75),
					new ExpectedCellValue(sheetName, 97, 10, 99d),
					new ExpectedCellValue(sheetName, 98, 10, 514.75),
					new ExpectedCellValue(sheetName, 99, 10, 1985.99),
					new ExpectedCellValue(sheetName, 100, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsTabularSecondFieldNonCompactLastFieldFirstDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("H76:J100"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 76, 8, "Row Labels"),
					new ExpectedCellValue(sheetName, 77, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 81, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 85, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 86, 8, null),
					new ExpectedCellValue(sheetName, 87, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 88, 8, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 8, "Chicago"),
					new ExpectedCellValue(sheetName, 90, 8, null),
					new ExpectedCellValue(sheetName, 91, 8, "Chicago Total"),
					new ExpectedCellValue(sheetName, 92, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 93, 8, null),
					new ExpectedCellValue(sheetName, 94, 8, null),
					new ExpectedCellValue(sheetName, 95, 8, "Nashville Total"),
					new ExpectedCellValue(sheetName, 96, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 99, 8, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 8, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 9, "Month"),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, "January"),
					new ExpectedCellValue(sheetName, 79, 9, "March"),
					new ExpectedCellValue(sheetName, 80, 9, null),
					new ExpectedCellValue(sheetName, 81, 9, "January"),
					new ExpectedCellValue(sheetName, 82, 9, "February"),
					new ExpectedCellValue(sheetName, 83, 9, "March"),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, "January"),
					new ExpectedCellValue(sheetName, 86, 9, "February"),
					new ExpectedCellValue(sheetName, 87, 9, null),
					new ExpectedCellValue(sheetName, 88, 9, null),
					new ExpectedCellValue(sheetName, 89, 9, "January"),
					new ExpectedCellValue(sheetName, 90, 9, "March"),
					new ExpectedCellValue(sheetName, 91, 9, null),
					new ExpectedCellValue(sheetName, 92, 9, "January"),
					new ExpectedCellValue(sheetName, 93, 9, "February"),
					new ExpectedCellValue(sheetName, 94, 9, "March"),
					new ExpectedCellValue(sheetName, 95, 9, null),
					new ExpectedCellValue(sheetName, 96, 9, "January"),
					new ExpectedCellValue(sheetName, 97, 9, "February"),
					new ExpectedCellValue(sheetName, 98, 9, null),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, null),
					new ExpectedCellValue(sheetName, 78, 10, 415.75),
					new ExpectedCellValue(sheetName, 79, 10, 24.99),
					new ExpectedCellValue(sheetName, 80, 10, 440.74),
					new ExpectedCellValue(sheetName, 81, 10, 415.75),
					new ExpectedCellValue(sheetName, 82, 10, 199d),
					new ExpectedCellValue(sheetName, 83, 10, 415.75),
					new ExpectedCellValue(sheetName, 84, 10, 1030.5),
					new ExpectedCellValue(sheetName, 85, 10, 415.75),
					new ExpectedCellValue(sheetName, 86, 10, 99d),
					new ExpectedCellValue(sheetName, 87, 10, 514.75),
					new ExpectedCellValue(sheetName, 88, 10, null),
					new ExpectedCellValue(sheetName, 89, 10, 831.5),
					new ExpectedCellValue(sheetName, 90, 10, 24.99),
					new ExpectedCellValue(sheetName, 91, 10, 856.49),
					new ExpectedCellValue(sheetName, 92, 10, 831.5),
					new ExpectedCellValue(sheetName, 93, 10, 1194d),
					new ExpectedCellValue(sheetName, 94, 10, 831.5),
					new ExpectedCellValue(sheetName, 95, 10, 2857d),
					new ExpectedCellValue(sheetName, 96, 10, 415.75),
					new ExpectedCellValue(sheetName, 97, 10, 99d),
					new ExpectedCellValue(sheetName, 98, 10, 514.75),
					new ExpectedCellValue(sheetName, 99, 10, 1985.99),
					new ExpectedCellValue(sheetName, 100, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactSecondFieldTabularLastFieldFirstDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N76:P100"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 76, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 77, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 82, 14, null),
					new ExpectedCellValue(sheetName, 83, 14, null),
					new ExpectedCellValue(sheetName, 84, 14, null),
					new ExpectedCellValue(sheetName, 85, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 86, 14, null),
					new ExpectedCellValue(sheetName, 87, 14, null),
					new ExpectedCellValue(sheetName, 88, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 90, 14, null),
					new ExpectedCellValue(sheetName, 91, 14, null),
					new ExpectedCellValue(sheetName, 92, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 93, 14, null),
					new ExpectedCellValue(sheetName, 94, 14, null),
					new ExpectedCellValue(sheetName, 95, 14, null),
					new ExpectedCellValue(sheetName, 96, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 97, 14, null),
					new ExpectedCellValue(sheetName, 98, 14, null),
					new ExpectedCellValue(sheetName, 99, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 15, "Month"),
					new ExpectedCellValue(sheetName, 77, 15, null),
					new ExpectedCellValue(sheetName, 78, 15, null),
					new ExpectedCellValue(sheetName, 79, 15, "January"),
					new ExpectedCellValue(sheetName, 80, 15, "March"),
					new ExpectedCellValue(sheetName, 81, 15, null),
					new ExpectedCellValue(sheetName, 82, 15, "January"),
					new ExpectedCellValue(sheetName, 83, 15, "February"),
					new ExpectedCellValue(sheetName, 84, 15, "March"),
					new ExpectedCellValue(sheetName, 85, 15, null),
					new ExpectedCellValue(sheetName, 86, 15, "January"),
					new ExpectedCellValue(sheetName, 87, 15, "February"),
					new ExpectedCellValue(sheetName, 88, 15, null),
					new ExpectedCellValue(sheetName, 89, 15, null),
					new ExpectedCellValue(sheetName, 90, 15, "January"),
					new ExpectedCellValue(sheetName, 91, 15, "March"),
					new ExpectedCellValue(sheetName, 92, 15, null),
					new ExpectedCellValue(sheetName, 93, 15, "January"),
					new ExpectedCellValue(sheetName, 94, 15, "February"),
					new ExpectedCellValue(sheetName, 95, 15, "March"),
					new ExpectedCellValue(sheetName, 96, 15, null),
					new ExpectedCellValue(sheetName, 97, 15, "January"),
					new ExpectedCellValue(sheetName, 98, 15, "February"),
					new ExpectedCellValue(sheetName, 99, 15, null),
					new ExpectedCellValue(sheetName, 100, 15, null),
					new ExpectedCellValue(sheetName, 76, 16, null),
					new ExpectedCellValue(sheetName, 77, 16, null),
					new ExpectedCellValue(sheetName, 78, 16, null),
					new ExpectedCellValue(sheetName, 79, 16, 415.75),
					new ExpectedCellValue(sheetName, 80, 16, 24.99),
					new ExpectedCellValue(sheetName, 81, 16, null),
					new ExpectedCellValue(sheetName, 82, 16, 415.75),
					new ExpectedCellValue(sheetName, 83, 16, 199d),
					new ExpectedCellValue(sheetName, 84, 16, 415.75),
					new ExpectedCellValue(sheetName, 85, 16, null),
					new ExpectedCellValue(sheetName, 86, 16, 415.75),
					new ExpectedCellValue(sheetName, 87, 16, 99d),
					new ExpectedCellValue(sheetName, 88, 16, null),
					new ExpectedCellValue(sheetName, 89, 16, null),
					new ExpectedCellValue(sheetName, 90, 16, 831.5),
					new ExpectedCellValue(sheetName, 91, 16, 24.99),
					new ExpectedCellValue(sheetName, 92, 16, null),
					new ExpectedCellValue(sheetName, 93, 16, 831.5),
					new ExpectedCellValue(sheetName, 94, 16, 1194d),
					new ExpectedCellValue(sheetName, 95, 16, 831.5),
					new ExpectedCellValue(sheetName, 96, 16, null),
					new ExpectedCellValue(sheetName, 97, 16, 415.75),
					new ExpectedCellValue(sheetName, 98, 16, 99d),
					new ExpectedCellValue(sheetName, 99, 16, 1985.99),
					new ExpectedCellValue(sheetName, 100, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactSecondFieldTabularLastFieldFirstDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N76:P100"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 76, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 77, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 82, 14, null),
					new ExpectedCellValue(sheetName, 83, 14, null),
					new ExpectedCellValue(sheetName, 84, 14, null),
					new ExpectedCellValue(sheetName, 85, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 86, 14, null),
					new ExpectedCellValue(sheetName, 87, 14, null),
					new ExpectedCellValue(sheetName, 88, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 89, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 90, 14, null),
					new ExpectedCellValue(sheetName, 91, 14, null),
					new ExpectedCellValue(sheetName, 92, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 93, 14, null),
					new ExpectedCellValue(sheetName, 94, 14, null),
					new ExpectedCellValue(sheetName, 95, 14, null),
					new ExpectedCellValue(sheetName, 96, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 97, 14, null),
					new ExpectedCellValue(sheetName, 98, 14, null),
					new ExpectedCellValue(sheetName, 99, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 15, "Month"),
					new ExpectedCellValue(sheetName, 77, 15, null),
					new ExpectedCellValue(sheetName, 78, 15, null),
					new ExpectedCellValue(sheetName, 79, 15, "January"),
					new ExpectedCellValue(sheetName, 80, 15, "March"),
					new ExpectedCellValue(sheetName, 81, 15, null),
					new ExpectedCellValue(sheetName, 82, 15, "January"),
					new ExpectedCellValue(sheetName, 83, 15, "February"),
					new ExpectedCellValue(sheetName, 84, 15, "March"),
					new ExpectedCellValue(sheetName, 85, 15, null),
					new ExpectedCellValue(sheetName, 86, 15, "January"),
					new ExpectedCellValue(sheetName, 87, 15, "February"),
					new ExpectedCellValue(sheetName, 88, 15, null),
					new ExpectedCellValue(sheetName, 89, 15, null),
					new ExpectedCellValue(sheetName, 90, 15, "January"),
					new ExpectedCellValue(sheetName, 91, 15, "March"),
					new ExpectedCellValue(sheetName, 92, 15, null),
					new ExpectedCellValue(sheetName, 93, 15, "January"),
					new ExpectedCellValue(sheetName, 94, 15, "February"),
					new ExpectedCellValue(sheetName, 95, 15, "March"),
					new ExpectedCellValue(sheetName, 96, 15, null),
					new ExpectedCellValue(sheetName, 97, 15, "January"),
					new ExpectedCellValue(sheetName, 98, 15, "February"),
					new ExpectedCellValue(sheetName, 99, 15, null),
					new ExpectedCellValue(sheetName, 100, 15, null),
					new ExpectedCellValue(sheetName, 76, 16, null),
					new ExpectedCellValue(sheetName, 77, 16, null),
					new ExpectedCellValue(sheetName, 78, 16, 440.74),
					new ExpectedCellValue(sheetName, 79, 16, 415.75),
					new ExpectedCellValue(sheetName, 80, 16, 24.99),
					new ExpectedCellValue(sheetName, 81, 16, 1030.5),
					new ExpectedCellValue(sheetName, 82, 16, 415.75),
					new ExpectedCellValue(sheetName, 83, 16, 199d),
					new ExpectedCellValue(sheetName, 84, 16, 415.75),
					new ExpectedCellValue(sheetName, 85, 16, 514.75),
					new ExpectedCellValue(sheetName, 86, 16, 415.75),
					new ExpectedCellValue(sheetName, 87, 16, 99d),
					new ExpectedCellValue(sheetName, 88, 16, null),
					new ExpectedCellValue(sheetName, 89, 16, 856.49),
					new ExpectedCellValue(sheetName, 90, 16, 831.5),
					new ExpectedCellValue(sheetName, 91, 16, 24.99),
					new ExpectedCellValue(sheetName, 92, 16, 2857d),
					new ExpectedCellValue(sheetName, 93, 16, 831.5),
					new ExpectedCellValue(sheetName, 94, 16, 1194d),
					new ExpectedCellValue(sheetName, 95, 16, 831.5),
					new ExpectedCellValue(sheetName, 96, 16, 514.75),
					new ExpectedCellValue(sheetName, 97, 16, 415.75),
					new ExpectedCellValue(sheetName, 98, 16, 99d),
					new ExpectedCellValue(sheetName, 99, 16, 1985.99),
					new ExpectedCellValue(sheetName, 100, 16, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormTwoRowFieldsMultipleDataFieldsNonCompactSecondFieldTabularLastFieldFirstDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "TwoRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("N76:P106"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 76, 14, "Row Labels"),
					new ExpectedCellValue(sheetName, 77, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 82, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 83, 14, null),
					new ExpectedCellValue(sheetName, 84, 14, null),
					new ExpectedCellValue(sheetName, 85, 14, null),
					new ExpectedCellValue(sheetName, 86, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 87, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 88, 14, null),
					new ExpectedCellValue(sheetName, 89, 14, null),
					new ExpectedCellValue(sheetName, 90, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 91, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 92, 14, "Chicago"),
					new ExpectedCellValue(sheetName, 93, 14, null),
					new ExpectedCellValue(sheetName, 94, 14, null),
					new ExpectedCellValue(sheetName, 95, 14, "Chicago Total"),
					new ExpectedCellValue(sheetName, 96, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 97, 14, null),
					new ExpectedCellValue(sheetName, 98, 14, null),
					new ExpectedCellValue(sheetName, 99, 14, null),
					new ExpectedCellValue(sheetName, 100, 14, "Nashville Total"),
					new ExpectedCellValue(sheetName, 101, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 102, 14, null),
					new ExpectedCellValue(sheetName, 103, 14, null),
					new ExpectedCellValue(sheetName, 104, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 105, 14, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 106, 14, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 15, "Month"),
					new ExpectedCellValue(sheetName, 77, 15, null),
					new ExpectedCellValue(sheetName, 78, 15, null),
					new ExpectedCellValue(sheetName, 79, 15, "January"),
					new ExpectedCellValue(sheetName, 80, 15, "March"),
					new ExpectedCellValue(sheetName, 81, 15, null),
					new ExpectedCellValue(sheetName, 82, 15, null),
					new ExpectedCellValue(sheetName, 83, 15, "January"),
					new ExpectedCellValue(sheetName, 84, 15, "February"),
					new ExpectedCellValue(sheetName, 85, 15, "March"),
					new ExpectedCellValue(sheetName, 86, 15, null),
					new ExpectedCellValue(sheetName, 87, 15, null),
					new ExpectedCellValue(sheetName, 88, 15, "January"),
					new ExpectedCellValue(sheetName, 89, 15, "February"),
					new ExpectedCellValue(sheetName, 90, 15, null),
					new ExpectedCellValue(sheetName, 91, 15, null),
					new ExpectedCellValue(sheetName, 92, 15, null),
					new ExpectedCellValue(sheetName, 93, 15, "January"),
					new ExpectedCellValue(sheetName, 94, 15, "March"),
					new ExpectedCellValue(sheetName, 95, 15, null),
					new ExpectedCellValue(sheetName, 96, 15, null),
					new ExpectedCellValue(sheetName, 97, 15, "January"),
					new ExpectedCellValue(sheetName, 98, 15, "February"),
					new ExpectedCellValue(sheetName, 99, 15, "March"),
					new ExpectedCellValue(sheetName, 100, 15, null),
					new ExpectedCellValue(sheetName, 101, 15, null),
					new ExpectedCellValue(sheetName, 102, 15, "January"),
					new ExpectedCellValue(sheetName, 103, 15, "February"),
					new ExpectedCellValue(sheetName, 104, 15, null),
					new ExpectedCellValue(sheetName, 105, 15, null),
					new ExpectedCellValue(sheetName, 106, 15, null),
					new ExpectedCellValue(sheetName, 76, 16, null),
					new ExpectedCellValue(sheetName, 77, 16, null),
					new ExpectedCellValue(sheetName, 78, 16, null),
					new ExpectedCellValue(sheetName, 79, 16, 415.75),
					new ExpectedCellValue(sheetName, 80, 16, 24.99),
					new ExpectedCellValue(sheetName, 81, 16, 440.74),
					new ExpectedCellValue(sheetName, 82, 16, null),
					new ExpectedCellValue(sheetName, 83, 16, 415.75),
					new ExpectedCellValue(sheetName, 84, 16, 199d),
					new ExpectedCellValue(sheetName, 85, 16, 415.75),
					new ExpectedCellValue(sheetName, 86, 16, 1030.5),
					new ExpectedCellValue(sheetName, 87, 16, null),
					new ExpectedCellValue(sheetName, 88, 16, 415.75),
					new ExpectedCellValue(sheetName, 89, 16, 99d),
					new ExpectedCellValue(sheetName, 90, 16, 514.75),
					new ExpectedCellValue(sheetName, 91, 16, null),
					new ExpectedCellValue(sheetName, 92, 16, null),
					new ExpectedCellValue(sheetName, 93, 16, 831.5),
					new ExpectedCellValue(sheetName, 94, 16, 24.99),
					new ExpectedCellValue(sheetName, 95, 16, 856.49),
					new ExpectedCellValue(sheetName, 96, 16, null),
					new ExpectedCellValue(sheetName, 97, 16, 831.5),
					new ExpectedCellValue(sheetName, 98, 16, 1194d),
					new ExpectedCellValue(sheetName, 99, 16, 831.5),
					new ExpectedCellValue(sheetName, 100, 16, 2857d),
					new ExpectedCellValue(sheetName, 101, 16, null),
					new ExpectedCellValue(sheetName, 102, 16, 415.75),
					new ExpectedCellValue(sheetName, 103, 16, 99d),
					new ExpectedCellValue(sheetName, 104, 16, 514.75),
					new ExpectedCellValue(sheetName, 105, 16, 1985.99),
					new ExpectedCellValue(sheetName, 106, 16, 4228.24)
				});
			}
		}

		// Three Row Fields Multiple Data Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndSecondFieldsNonCompactThirdFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C10:G33"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 4, "Month"),
					new ExpectedCellValue(sheetName, 11, 4, "January"),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, "March"),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, "January"),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, "February"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, "March"),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, "January"),
					new ExpectedCellValue(sheetName, 27, 4, null),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, "February"),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 10, 5, "Item"),
					new ExpectedCellValue(sheetName, 11, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, "Tent"),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 10, 6, "Values"),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 31, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, 415.75),
					new ExpectedCellValue(sheetName, 13, 7, 831.5),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, 24.99),
					new ExpectedCellValue(sheetName, 16, 7, 24.99),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, 415.75),
					new ExpectedCellValue(sheetName, 19, 7, 831.5),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, 199d),
					new ExpectedCellValue(sheetName, 22, 7, 1194d),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, 415.75),
					new ExpectedCellValue(sheetName, 25, 7, 831.5),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, 415.75),
					new ExpectedCellValue(sheetName, 28, 7, 415.75),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, 99d),
					new ExpectedCellValue(sheetName, 31, 7, 99d),
					new ExpectedCellValue(sheetName, 32, 7, 1985.99),
					new ExpectedCellValue(sheetName, 33, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndSecondFieldsNonCompactThirdFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C10:G53"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 39, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 40, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, null),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 4, "Month"),
					new ExpectedCellValue(sheetName, 11, 4, "January"),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 4, "March"),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, "January"),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 4, "February"),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 4, "March"),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, "January"),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 4, "February"),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 10, 5, "Item"),
					new ExpectedCellValue(sheetName, 11, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, "Tent"),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, null),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, null),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, null),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 10, 6, "Values"),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, null),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 35, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 6, null),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, null),
					new ExpectedCellValue(sheetName, 41, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, null),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, null),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, 415.75),
					new ExpectedCellValue(sheetName, 13, 7, 831.5),
					new ExpectedCellValue(sheetName, 14, 7, 415.75),
					new ExpectedCellValue(sheetName, 15, 7, 831.5),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 17, 7, 24.99),
					new ExpectedCellValue(sheetName, 18, 7, 24.99),
					new ExpectedCellValue(sheetName, 19, 7, 24.99),
					new ExpectedCellValue(sheetName, 20, 7, 24.99),
					new ExpectedCellValue(sheetName, 21, 7, 440.74),
					new ExpectedCellValue(sheetName, 22, 7, 856.49),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, 415.75),
					new ExpectedCellValue(sheetName, 25, 7, 831.5),
					new ExpectedCellValue(sheetName, 26, 7, 415.75),
					new ExpectedCellValue(sheetName, 27, 7, 831.5),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, 199d),
					new ExpectedCellValue(sheetName, 30, 7, 1194d),
					new ExpectedCellValue(sheetName, 31, 7, 199d),
					new ExpectedCellValue(sheetName, 32, 7, 1194d),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, 415.75),
					new ExpectedCellValue(sheetName, 35, 7, 831.5),
					new ExpectedCellValue(sheetName, 36, 7, 415.75),
					new ExpectedCellValue(sheetName, 37, 7, 831.5),
					new ExpectedCellValue(sheetName, 38, 7, 1030.5),
					new ExpectedCellValue(sheetName, 39, 7, 2857d),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, 415.75),
					new ExpectedCellValue(sheetName, 42, 7, 415.75),
					new ExpectedCellValue(sheetName, 43, 7, 415.75),
					new ExpectedCellValue(sheetName, 44, 7, 415.75),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, 99d),
					new ExpectedCellValue(sheetName, 47, 7, 99d),
					new ExpectedCellValue(sheetName, 48, 7, 99d),
					new ExpectedCellValue(sheetName, 49, 7, 99d),
					new ExpectedCellValue(sheetName, 50, 7, 514.75),
					new ExpectedCellValue(sheetName, 51, 7, 514.75),
					new ExpectedCellValue(sheetName, 52, 7, 1985.99),
					new ExpectedCellValue(sheetName, 53, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndSecondFieldsNonCompactThirdFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C10:G53"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 39, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 40, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, null),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 4, "Month"),
					new ExpectedCellValue(sheetName, 11, 4, "January"),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 4, "March"),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, "January"),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 4, "February"),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 4, "March"),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, "January"),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 4, "February"),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 10, 5, "Item"),
					new ExpectedCellValue(sheetName, 11, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, "Tent"),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, null),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, null),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, null),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 10, 6, "Values"),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, null),
					new ExpectedCellValue(sheetName, 23, 6, null),
					new ExpectedCellValue(sheetName, 24, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 35, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 6, null),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, null),
					new ExpectedCellValue(sheetName, 41, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, null),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, null),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, 415.75),
					new ExpectedCellValue(sheetName, 13, 7, 831.5),
					new ExpectedCellValue(sheetName, 14, 7, 415.75),
					new ExpectedCellValue(sheetName, 15, 7, 831.5),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 17, 7, 24.99),
					new ExpectedCellValue(sheetName, 18, 7, 24.99),
					new ExpectedCellValue(sheetName, 19, 7, 24.99),
					new ExpectedCellValue(sheetName, 20, 7, 24.99),
					new ExpectedCellValue(sheetName, 21, 7, 440.74),
					new ExpectedCellValue(sheetName, 22, 7, 856.49),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, 415.75),
					new ExpectedCellValue(sheetName, 25, 7, 831.5),
					new ExpectedCellValue(sheetName, 26, 7, 415.75),
					new ExpectedCellValue(sheetName, 27, 7, 831.5),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, 199d),
					new ExpectedCellValue(sheetName, 30, 7, 1194d),
					new ExpectedCellValue(sheetName, 31, 7, 199d),
					new ExpectedCellValue(sheetName, 32, 7, 1194d),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, 415.75),
					new ExpectedCellValue(sheetName, 35, 7, 831.5),
					new ExpectedCellValue(sheetName, 36, 7, 415.75),
					new ExpectedCellValue(sheetName, 37, 7, 831.5),
					new ExpectedCellValue(sheetName, 38, 7, 1030.5),
					new ExpectedCellValue(sheetName, 39, 7, 2857d),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, 415.75),
					new ExpectedCellValue(sheetName, 42, 7, 415.75),
					new ExpectedCellValue(sheetName, 43, 7, 415.75),
					new ExpectedCellValue(sheetName, 44, 7, 415.75),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, 99d),
					new ExpectedCellValue(sheetName, 47, 7, 99d),
					new ExpectedCellValue(sheetName, 48, 7, 99d),
					new ExpectedCellValue(sheetName, 49, 7, 99d),
					new ExpectedCellValue(sheetName, 50, 7, 514.75),
					new ExpectedCellValue(sheetName, 51, 7, 514.75),
					new ExpectedCellValue(sheetName, 52, 7, 1985.99),
					new ExpectedCellValue(sheetName, 53, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndThirdFieldsNonCompactSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J10:N33"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 11, "Month"),
					new ExpectedCellValue(sheetName, 11, 11, "January"),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, "March"),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, "January"),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, "February"),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, "March"),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, "January"),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, "February"),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 32, 11, null),
					new ExpectedCellValue(sheetName, 33, 11, null),
					new ExpectedCellValue(sheetName, 10, 12, "Item"),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, "Tent"),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 27, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 28, 12, null),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 33, 12, null),
					new ExpectedCellValue(sheetName, 10, 13, "Values"),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 19, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 30, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 31, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 32, 13, null),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, 415.75),
					new ExpectedCellValue(sheetName, 13, 14, 831.5),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, 24.99),
					new ExpectedCellValue(sheetName, 16, 14, 24.99),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, 415.75),
					new ExpectedCellValue(sheetName, 19, 14, 831.5),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, 199d),
					new ExpectedCellValue(sheetName, 22, 14, 1194d),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, 415.75),
					new ExpectedCellValue(sheetName, 25, 14, 831.5),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, 415.75),
					new ExpectedCellValue(sheetName, 28, 14, 415.75),
					new ExpectedCellValue(sheetName, 29, 14, null),
					new ExpectedCellValue(sheetName, 30, 14, 99d),
					new ExpectedCellValue(sheetName, 31, 14, 99d),
					new ExpectedCellValue(sheetName, 32, 14, 1985.99),
					new ExpectedCellValue(sheetName, 33, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndThirdFieldsNonCompactSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J10:N53"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 39, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 40, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 11, "Month"),
					new ExpectedCellValue(sheetName, 11, 11, "January"),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 11, "March"),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, "January"),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 11, "February"),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 11, "March"),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 36, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, "January"),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 11, "February"),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 10, 12, "Item"),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, null),
					new ExpectedCellValue(sheetName, 29, 12, "Tent"),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 33, 12, null),
					new ExpectedCellValue(sheetName, 34, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, null),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 12, null),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 47, 12, null),
					new ExpectedCellValue(sheetName, 48, 12, null),
					new ExpectedCellValue(sheetName, 49, 12, null),
					new ExpectedCellValue(sheetName, 50, 12, null),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, null),
					new ExpectedCellValue(sheetName, 53, 12, null),
					new ExpectedCellValue(sheetName, 10, 13, "Values"),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 29, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 13, null),
					new ExpectedCellValue(sheetName, 32, 13, null),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 34, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 35, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 13, null),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 41, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, null),
					new ExpectedCellValue(sheetName, 45, 13, null),
					new ExpectedCellValue(sheetName, 46, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 48, 13, null),
					new ExpectedCellValue(sheetName, 49, 13, null),
					new ExpectedCellValue(sheetName, 50, 13, null),
					new ExpectedCellValue(sheetName, 51, 13, null),
					new ExpectedCellValue(sheetName, 52, 13, null),
					new ExpectedCellValue(sheetName, 53, 13, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, 415.75),
					new ExpectedCellValue(sheetName, 13, 14, 831.5),
					new ExpectedCellValue(sheetName, 14, 14, 415.75),
					new ExpectedCellValue(sheetName, 15, 14, 831.5),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, 24.99),
					new ExpectedCellValue(sheetName, 18, 14, 24.99),
					new ExpectedCellValue(sheetName, 19, 14, 24.99),
					new ExpectedCellValue(sheetName, 20, 14, 24.99),
					new ExpectedCellValue(sheetName, 21, 14, 440.74),
					new ExpectedCellValue(sheetName, 22, 14, 856.49),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, 415.75),
					new ExpectedCellValue(sheetName, 25, 14, 831.5),
					new ExpectedCellValue(sheetName, 26, 14, 415.75),
					new ExpectedCellValue(sheetName, 27, 14, 831.5),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 29, 14, 199d),
					new ExpectedCellValue(sheetName, 30, 14, 1194d),
					new ExpectedCellValue(sheetName, 31, 14, 199d),
					new ExpectedCellValue(sheetName, 32, 14, 1194d),
					new ExpectedCellValue(sheetName, 33, 14, null),
					new ExpectedCellValue(sheetName, 34, 14, 415.75),
					new ExpectedCellValue(sheetName, 35, 14, 831.5),
					new ExpectedCellValue(sheetName, 36, 14, 415.75),
					new ExpectedCellValue(sheetName, 37, 14, 831.5),
					new ExpectedCellValue(sheetName, 38, 14, 1030.5),
					new ExpectedCellValue(sheetName, 39, 14, 2857d),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, 415.75),
					new ExpectedCellValue(sheetName, 42, 14, 415.75),
					new ExpectedCellValue(sheetName, 43, 14, 415.75),
					new ExpectedCellValue(sheetName, 44, 14, 415.75),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, 99d),
					new ExpectedCellValue(sheetName, 47, 14, 99d),
					new ExpectedCellValue(sheetName, 48, 14, 99d),
					new ExpectedCellValue(sheetName, 49, 14, 99d),
					new ExpectedCellValue(sheetName, 50, 14, 514.75),
					new ExpectedCellValue(sheetName, 51, 14, 514.75),
					new ExpectedCellValue(sheetName, 52, 14, 1985.99),
					new ExpectedCellValue(sheetName, 53, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndThirdFieldsNonCompactSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J10:N53"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 39, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 40, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 51, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 53, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 11, "Month"),
					new ExpectedCellValue(sheetName, 11, 11, "January"),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 15, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 11, "March"),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, "January"),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 27, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 28, 11, "February"),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 32, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 11, "March"),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 36, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 37, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, "January"),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 11, "February"),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 49, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 10, 12, "Item"),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, null),
					new ExpectedCellValue(sheetName, 29, 12, "Tent"),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 33, 12, null),
					new ExpectedCellValue(sheetName, 34, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, null),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 42, 12, null),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 47, 12, null),
					new ExpectedCellValue(sheetName, 48, 12, null),
					new ExpectedCellValue(sheetName, 49, 12, null),
					new ExpectedCellValue(sheetName, 50, 12, null),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, null),
					new ExpectedCellValue(sheetName, 53, 12, null),
					new ExpectedCellValue(sheetName, 10, 13, "Values"),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 13, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 25, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 29, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 13, null),
					new ExpectedCellValue(sheetName, 32, 13, null),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 34, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 35, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 13, null),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 41, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, null),
					new ExpectedCellValue(sheetName, 45, 13, null),
					new ExpectedCellValue(sheetName, 46, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 47, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 48, 13, null),
					new ExpectedCellValue(sheetName, 49, 13, null),
					new ExpectedCellValue(sheetName, 50, 13, null),
					new ExpectedCellValue(sheetName, 51, 13, null),
					new ExpectedCellValue(sheetName, 52, 13, null),
					new ExpectedCellValue(sheetName, 53, 13, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, 415.75),
					new ExpectedCellValue(sheetName, 13, 14, 831.5),
					new ExpectedCellValue(sheetName, 14, 14, 415.75),
					new ExpectedCellValue(sheetName, 15, 14, 831.5),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, 24.99),
					new ExpectedCellValue(sheetName, 18, 14, 24.99),
					new ExpectedCellValue(sheetName, 19, 14, 24.99),
					new ExpectedCellValue(sheetName, 20, 14, 24.99),
					new ExpectedCellValue(sheetName, 21, 14, 440.74),
					new ExpectedCellValue(sheetName, 22, 14, 856.49),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, 415.75),
					new ExpectedCellValue(sheetName, 25, 14, 831.5),
					new ExpectedCellValue(sheetName, 26, 14, 415.75),
					new ExpectedCellValue(sheetName, 27, 14, 831.5),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 29, 14, 199d),
					new ExpectedCellValue(sheetName, 30, 14, 1194d),
					new ExpectedCellValue(sheetName, 31, 14, 199d),
					new ExpectedCellValue(sheetName, 32, 14, 1194d),
					new ExpectedCellValue(sheetName, 33, 14, null),
					new ExpectedCellValue(sheetName, 34, 14, 415.75),
					new ExpectedCellValue(sheetName, 35, 14, 831.5),
					new ExpectedCellValue(sheetName, 36, 14, 415.75),
					new ExpectedCellValue(sheetName, 37, 14, 831.5),
					new ExpectedCellValue(sheetName, 38, 14, 1030.5),
					new ExpectedCellValue(sheetName, 39, 14, 2857d),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, 415.75),
					new ExpectedCellValue(sheetName, 42, 14, 415.75),
					new ExpectedCellValue(sheetName, 43, 14, 415.75),
					new ExpectedCellValue(sheetName, 44, 14, 415.75),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, 99d),
					new ExpectedCellValue(sheetName, 47, 14, 99d),
					new ExpectedCellValue(sheetName, 48, 14, 99d),
					new ExpectedCellValue(sheetName, 49, 14, 99d),
					new ExpectedCellValue(sheetName, 50, 14, 514.75),
					new ExpectedCellValue(sheetName, 51, 14, 514.75),
					new ExpectedCellValue(sheetName, 52, 14, 1985.99),
					new ExpectedCellValue(sheetName, 53, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondAndThirdFieldsLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q10:U40"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, null),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 32, 17, null),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 40, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 18, "Month"),
					new ExpectedCellValue(sheetName, 11, 18, "January"),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, "March"),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, null),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, "January"),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, "February"),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, "March"),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, null),
					new ExpectedCellValue(sheetName, 30, 18, null),
					new ExpectedCellValue(sheetName, 31, 18, "January"),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, null),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, "February"),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, null),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, null),
					new ExpectedCellValue(sheetName, 10, 19, "Item"),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, null),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, null),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, null),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, "Tent"),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, null),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, null),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 10, 20, "Values"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 19, 20, null),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 26, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 20, null),
					new ExpectedCellValue(sheetName, 28, 20, null),
					new ExpectedCellValue(sheetName, 29, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 20, null),
					new ExpectedCellValue(sheetName, 36, 20, null),
					new ExpectedCellValue(sheetName, 37, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 38, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 39, 20, null),
					new ExpectedCellValue(sheetName, 40, 20, null),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, null),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, 415.75),
					new ExpectedCellValue(sheetName, 14, 21, 831.5),
					new ExpectedCellValue(sheetName, 15, 21, null),
					new ExpectedCellValue(sheetName, 16, 21, null),
					new ExpectedCellValue(sheetName, 17, 21, 24.99),
					new ExpectedCellValue(sheetName, 18, 21, 24.99),
					new ExpectedCellValue(sheetName, 19, 21, null),
					new ExpectedCellValue(sheetName, 20, 21, null),
					new ExpectedCellValue(sheetName, 21, 21, 415.75),
					new ExpectedCellValue(sheetName, 22, 21, 831.5),
					new ExpectedCellValue(sheetName, 23, 21, null),
					new ExpectedCellValue(sheetName, 24, 21, null),
					new ExpectedCellValue(sheetName, 25, 21, 199d),
					new ExpectedCellValue(sheetName, 26, 21, 1194d),
					new ExpectedCellValue(sheetName, 27, 21, null),
					new ExpectedCellValue(sheetName, 28, 21, null),
					new ExpectedCellValue(sheetName, 29, 21, 415.75),
					new ExpectedCellValue(sheetName, 30, 21, 831.5),
					new ExpectedCellValue(sheetName, 31, 21, null),
					new ExpectedCellValue(sheetName, 32, 21, null),
					new ExpectedCellValue(sheetName, 33, 21, 415.75),
					new ExpectedCellValue(sheetName, 34, 21, 415.75),
					new ExpectedCellValue(sheetName, 35, 21, null),
					new ExpectedCellValue(sheetName, 36, 21, null),
					new ExpectedCellValue(sheetName, 37, 21, 99d),
					new ExpectedCellValue(sheetName, 38, 21, 99d),
					new ExpectedCellValue(sheetName, 39, 21, 1985.99),
					new ExpectedCellValue(sheetName, 40, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondAndThirdFieldsLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q10:U60"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, null),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, null),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 40, 17, null),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, null),
					new ExpectedCellValue(sheetName, 43, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 46, 17, null),
					new ExpectedCellValue(sheetName, 47, 17, null),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, null),
					new ExpectedCellValue(sheetName, 53, 17, null),
					new ExpectedCellValue(sheetName, 54, 17, null),
					new ExpectedCellValue(sheetName, 55, 17, null),
					new ExpectedCellValue(sheetName, 56, 17, null),
					new ExpectedCellValue(sheetName, 57, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 58, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 60, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 18, "Month"),
					new ExpectedCellValue(sheetName, 11, 18, "January"),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 18, "March"),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, "January"),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 18, "February"),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, null),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 18, "March"),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, null),
					new ExpectedCellValue(sheetName, 41, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 18, null),
					new ExpectedCellValue(sheetName, 44, 18, null),
					new ExpectedCellValue(sheetName, 45, 18, "January"),
					new ExpectedCellValue(sheetName, 46, 18, null),
					new ExpectedCellValue(sheetName, 47, 18, null),
					new ExpectedCellValue(sheetName, 48, 18, null),
					new ExpectedCellValue(sheetName, 49, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 18, "February"),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, null),
					new ExpectedCellValue(sheetName, 54, 18, null),
					new ExpectedCellValue(sheetName, 55, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 56, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 18, null),
					new ExpectedCellValue(sheetName, 58, 18, null),
					new ExpectedCellValue(sheetName, 59, 18, null),
					new ExpectedCellValue(sheetName, 60, 18, null),
					new ExpectedCellValue(sheetName, 10, 19, "Item"),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, null),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, null),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, null),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, "Tent"),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, null),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, null),
					new ExpectedCellValue(sheetName, 43, 19, null),
					new ExpectedCellValue(sheetName, 44, 19, null),
					new ExpectedCellValue(sheetName, 45, 19, null),
					new ExpectedCellValue(sheetName, 46, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 19, null),
					new ExpectedCellValue(sheetName, 48, 19, null),
					new ExpectedCellValue(sheetName, 49, 19, null),
					new ExpectedCellValue(sheetName, 50, 19, null),
					new ExpectedCellValue(sheetName, 51, 19, null),
					new ExpectedCellValue(sheetName, 52, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 53, 19, null),
					new ExpectedCellValue(sheetName, 54, 19, null),
					new ExpectedCellValue(sheetName, 55, 19, null),
					new ExpectedCellValue(sheetName, 56, 19, null),
					new ExpectedCellValue(sheetName, 57, 19, null),
					new ExpectedCellValue(sheetName, 58, 19, null),
					new ExpectedCellValue(sheetName, 59, 19, null),
					new ExpectedCellValue(sheetName, 60, 19, null),
					new ExpectedCellValue(sheetName, 10, 20, "Values"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 20, null),
					new ExpectedCellValue(sheetName, 22, 20, null),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, null),
					new ExpectedCellValue(sheetName, 27, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 20, null),
					new ExpectedCellValue(sheetName, 30, 20, null),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 20, null),
					new ExpectedCellValue(sheetName, 36, 20, null),
					new ExpectedCellValue(sheetName, 37, 20, null),
					new ExpectedCellValue(sheetName, 38, 20, null),
					new ExpectedCellValue(sheetName, 39, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 40, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 20, null),
					new ExpectedCellValue(sheetName, 42, 20, null),
					new ExpectedCellValue(sheetName, 43, 20, null),
					new ExpectedCellValue(sheetName, 44, 20, null),
					new ExpectedCellValue(sheetName, 45, 20, null),
					new ExpectedCellValue(sheetName, 46, 20, null),
					new ExpectedCellValue(sheetName, 47, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 48, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 49, 20, null),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, null),
					new ExpectedCellValue(sheetName, 53, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 54, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 55, 20, null),
					new ExpectedCellValue(sheetName, 56, 20, null),
					new ExpectedCellValue(sheetName, 57, 20, null),
					new ExpectedCellValue(sheetName, 58, 20, null),
					new ExpectedCellValue(sheetName, 59, 20, null),
					new ExpectedCellValue(sheetName, 60, 20, null),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, null),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, 415.75),
					new ExpectedCellValue(sheetName, 14, 21, 831.5),
					new ExpectedCellValue(sheetName, 15, 21, 415.75),
					new ExpectedCellValue(sheetName, 16, 21, 831.5),
					new ExpectedCellValue(sheetName, 17, 21, null),
					new ExpectedCellValue(sheetName, 18, 21, null),
					new ExpectedCellValue(sheetName, 19, 21, 24.99),
					new ExpectedCellValue(sheetName, 20, 21, 24.99),
					new ExpectedCellValue(sheetName, 21, 21, 24.99),
					new ExpectedCellValue(sheetName, 22, 21, 24.99),
					new ExpectedCellValue(sheetName, 23, 21, 440.74),
					new ExpectedCellValue(sheetName, 24, 21, 856.49),
					new ExpectedCellValue(sheetName, 25, 21, null),
					new ExpectedCellValue(sheetName, 26, 21, null),
					new ExpectedCellValue(sheetName, 27, 21, 415.75),
					new ExpectedCellValue(sheetName, 28, 21, 831.5),
					new ExpectedCellValue(sheetName, 29, 21, 415.75),
					new ExpectedCellValue(sheetName, 30, 21, 831.5),
					new ExpectedCellValue(sheetName, 31, 21, null),
					new ExpectedCellValue(sheetName, 32, 21, null),
					new ExpectedCellValue(sheetName, 33, 21, 199d),
					new ExpectedCellValue(sheetName, 34, 21, 1194d),
					new ExpectedCellValue(sheetName, 35, 21, 199d),
					new ExpectedCellValue(sheetName, 36, 21, 1194d),
					new ExpectedCellValue(sheetName, 37, 21, null),
					new ExpectedCellValue(sheetName, 38, 21, null),
					new ExpectedCellValue(sheetName, 39, 21, 415.75),
					new ExpectedCellValue(sheetName, 40, 21, 831.5),
					new ExpectedCellValue(sheetName, 41, 21, 415.75),
					new ExpectedCellValue(sheetName, 42, 21, 831.5),
					new ExpectedCellValue(sheetName, 43, 21, 1030.5),
					new ExpectedCellValue(sheetName, 44, 21, 2857d),
					new ExpectedCellValue(sheetName, 45, 21, null),
					new ExpectedCellValue(sheetName, 46, 21, null),
					new ExpectedCellValue(sheetName, 47, 21, 415.75),
					new ExpectedCellValue(sheetName, 48, 21, 415.75),
					new ExpectedCellValue(sheetName, 49, 21, 415.75),
					new ExpectedCellValue(sheetName, 50, 21, 415.75),
					new ExpectedCellValue(sheetName, 51, 21, null),
					new ExpectedCellValue(sheetName, 52, 21, null),
					new ExpectedCellValue(sheetName, 53, 21, 99d),
					new ExpectedCellValue(sheetName, 54, 21, 99d),
					new ExpectedCellValue(sheetName, 55, 21, 99d),
					new ExpectedCellValue(sheetName, 56, 21, 99d),
					new ExpectedCellValue(sheetName, 57, 21, 514.75),
					new ExpectedCellValue(sheetName, 58, 21, 514.75),
					new ExpectedCellValue(sheetName, 59, 21, 1985.99),
					new ExpectedCellValue(sheetName, 60, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondAndThirdFieldsLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q10:U60"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 11, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, null),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 25, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, null),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 40, 17, null),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, null),
					new ExpectedCellValue(sheetName, 43, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 45, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 46, 17, null),
					new ExpectedCellValue(sheetName, 47, 17, null),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, null),
					new ExpectedCellValue(sheetName, 53, 17, null),
					new ExpectedCellValue(sheetName, 54, 17, null),
					new ExpectedCellValue(sheetName, 55, 17, null),
					new ExpectedCellValue(sheetName, 56, 17, null),
					new ExpectedCellValue(sheetName, 57, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 58, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 60, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 10, 18, "Month"),
					new ExpectedCellValue(sheetName, 11, 18, "January"),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 17, 18, "March"),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, "January"),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 31, 18, "February"),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, null),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 36, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 37, 18, "March"),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, null),
					new ExpectedCellValue(sheetName, 41, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 43, 18, null),
					new ExpectedCellValue(sheetName, 44, 18, null),
					new ExpectedCellValue(sheetName, 45, 18, "January"),
					new ExpectedCellValue(sheetName, 46, 18, null),
					new ExpectedCellValue(sheetName, 47, 18, null),
					new ExpectedCellValue(sheetName, 48, 18, null),
					new ExpectedCellValue(sheetName, 49, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 51, 18, "February"),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, null),
					new ExpectedCellValue(sheetName, 54, 18, null),
					new ExpectedCellValue(sheetName, 55, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 56, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 57, 18, null),
					new ExpectedCellValue(sheetName, 58, 18, null),
					new ExpectedCellValue(sheetName, 59, 18, null),
					new ExpectedCellValue(sheetName, 60, 18, null),
					new ExpectedCellValue(sheetName, 10, 19, "Item"),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, null),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, null),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, null),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, "Tent"),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, null),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, null),
					new ExpectedCellValue(sheetName, 43, 19, null),
					new ExpectedCellValue(sheetName, 44, 19, null),
					new ExpectedCellValue(sheetName, 45, 19, null),
					new ExpectedCellValue(sheetName, 46, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 47, 19, null),
					new ExpectedCellValue(sheetName, 48, 19, null),
					new ExpectedCellValue(sheetName, 49, 19, null),
					new ExpectedCellValue(sheetName, 50, 19, null),
					new ExpectedCellValue(sheetName, 51, 19, null),
					new ExpectedCellValue(sheetName, 52, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 53, 19, null),
					new ExpectedCellValue(sheetName, 54, 19, null),
					new ExpectedCellValue(sheetName, 55, 19, null),
					new ExpectedCellValue(sheetName, 56, 19, null),
					new ExpectedCellValue(sheetName, 57, 19, null),
					new ExpectedCellValue(sheetName, 58, 19, null),
					new ExpectedCellValue(sheetName, 59, 19, null),
					new ExpectedCellValue(sheetName, 60, 19, null),
					new ExpectedCellValue(sheetName, 10, 20, "Values"),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, null),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 20, null),
					new ExpectedCellValue(sheetName, 22, 20, null),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, null),
					new ExpectedCellValue(sheetName, 27, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 20, null),
					new ExpectedCellValue(sheetName, 30, 20, null),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 35, 20, null),
					new ExpectedCellValue(sheetName, 36, 20, null),
					new ExpectedCellValue(sheetName, 37, 20, null),
					new ExpectedCellValue(sheetName, 38, 20, null),
					new ExpectedCellValue(sheetName, 39, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 40, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 20, null),
					new ExpectedCellValue(sheetName, 42, 20, null),
					new ExpectedCellValue(sheetName, 43, 20, null),
					new ExpectedCellValue(sheetName, 44, 20, null),
					new ExpectedCellValue(sheetName, 45, 20, null),
					new ExpectedCellValue(sheetName, 46, 20, null),
					new ExpectedCellValue(sheetName, 47, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 48, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 49, 20, null),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, null),
					new ExpectedCellValue(sheetName, 53, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 54, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 55, 20, null),
					new ExpectedCellValue(sheetName, 56, 20, null),
					new ExpectedCellValue(sheetName, 57, 20, null),
					new ExpectedCellValue(sheetName, 58, 20, null),
					new ExpectedCellValue(sheetName, 59, 20, null),
					new ExpectedCellValue(sheetName, 60, 20, null),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, null),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, 415.75),
					new ExpectedCellValue(sheetName, 14, 21, 831.5),
					new ExpectedCellValue(sheetName, 15, 21, 415.75),
					new ExpectedCellValue(sheetName, 16, 21, 831.5),
					new ExpectedCellValue(sheetName, 17, 21, null),
					new ExpectedCellValue(sheetName, 18, 21, null),
					new ExpectedCellValue(sheetName, 19, 21, 24.99),
					new ExpectedCellValue(sheetName, 20, 21, 24.99),
					new ExpectedCellValue(sheetName, 21, 21, 24.99),
					new ExpectedCellValue(sheetName, 22, 21, 24.99),
					new ExpectedCellValue(sheetName, 23, 21, 440.74),
					new ExpectedCellValue(sheetName, 24, 21, 856.49),
					new ExpectedCellValue(sheetName, 25, 21, null),
					new ExpectedCellValue(sheetName, 26, 21, null),
					new ExpectedCellValue(sheetName, 27, 21, 415.75),
					new ExpectedCellValue(sheetName, 28, 21, 831.5),
					new ExpectedCellValue(sheetName, 29, 21, 415.75),
					new ExpectedCellValue(sheetName, 30, 21, 831.5),
					new ExpectedCellValue(sheetName, 31, 21, null),
					new ExpectedCellValue(sheetName, 32, 21, null),
					new ExpectedCellValue(sheetName, 33, 21, 199d),
					new ExpectedCellValue(sheetName, 34, 21, 1194d),
					new ExpectedCellValue(sheetName, 35, 21, 199d),
					new ExpectedCellValue(sheetName, 36, 21, 1194d),
					new ExpectedCellValue(sheetName, 37, 21, null),
					new ExpectedCellValue(sheetName, 38, 21, null),
					new ExpectedCellValue(sheetName, 39, 21, 415.75),
					new ExpectedCellValue(sheetName, 40, 21, 831.5),
					new ExpectedCellValue(sheetName, 41, 21, 415.75),
					new ExpectedCellValue(sheetName, 42, 21, 831.5),
					new ExpectedCellValue(sheetName, 43, 21, 1030.5),
					new ExpectedCellValue(sheetName, 44, 21, 2857d),
					new ExpectedCellValue(sheetName, 45, 21, null),
					new ExpectedCellValue(sheetName, 46, 21, null),
					new ExpectedCellValue(sheetName, 47, 21, 415.75),
					new ExpectedCellValue(sheetName, 48, 21, 415.75),
					new ExpectedCellValue(sheetName, 49, 21, 415.75),
					new ExpectedCellValue(sheetName, 50, 21, 415.75),
					new ExpectedCellValue(sheetName, 51, 21, null),
					new ExpectedCellValue(sheetName, 52, 21, null),
					new ExpectedCellValue(sheetName, 53, 21, 99d),
					new ExpectedCellValue(sheetName, 54, 21, 99d),
					new ExpectedCellValue(sheetName, 55, 21, 99d),
					new ExpectedCellValue(sheetName, 56, 21, 99d),
					new ExpectedCellValue(sheetName, 57, 21, 514.75),
					new ExpectedCellValue(sheetName, 58, 21, 514.75),
					new ExpectedCellValue(sheetName, 59, 21, 1985.99),
					new ExpectedCellValue(sheetName, 60, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondAndThirdFieldsLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C65:G84"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 84, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 4, "Month"),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, "January"),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, "March"),
					new ExpectedCellValue(sheetName, 70, 4, null),
					new ExpectedCellValue(sheetName, 71, 4, null),
					new ExpectedCellValue(sheetName, 72, 4, "January"),
					new ExpectedCellValue(sheetName, 73, 4, null),
					new ExpectedCellValue(sheetName, 74, 4, "February"),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, "March"),
					new ExpectedCellValue(sheetName, 77, 4, null),
					new ExpectedCellValue(sheetName, 78, 4, null),
					new ExpectedCellValue(sheetName, 79, 4, "January"),
					new ExpectedCellValue(sheetName, 80, 4, null),
					new ExpectedCellValue(sheetName, 81, 4, "February"),
					new ExpectedCellValue(sheetName, 82, 4, null),
					new ExpectedCellValue(sheetName, 83, 4, null),
					new ExpectedCellValue(sheetName, 84, 4, null),
					new ExpectedCellValue(sheetName, 65, 5, "Item"),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 5, null),
					new ExpectedCellValue(sheetName, 69, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 70, 5, null),
					new ExpectedCellValue(sheetName, 71, 5, null),
					new ExpectedCellValue(sheetName, 72, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 73, 5, null),
					new ExpectedCellValue(sheetName, 74, 5, "Tent"),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 77, 5, null),
					new ExpectedCellValue(sheetName, 78, 5, null),
					new ExpectedCellValue(sheetName, 79, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 80, 5, null),
					new ExpectedCellValue(sheetName, 81, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 82, 5, null),
					new ExpectedCellValue(sheetName, 83, 5, null),
					new ExpectedCellValue(sheetName, 84, 5, null),
					new ExpectedCellValue(sheetName, 65, 6, "Values"),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 68, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 69, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 70, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 73, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 74, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 75, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 77, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 78, 6, null),
					new ExpectedCellValue(sheetName, 79, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 80, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 81, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 6, null),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, 415.75),
					new ExpectedCellValue(sheetName, 68, 7, 831.5),
					new ExpectedCellValue(sheetName, 69, 7, 24.99),
					new ExpectedCellValue(sheetName, 70, 7, 24.99),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, 415.75),
					new ExpectedCellValue(sheetName, 73, 7, 831.5),
					new ExpectedCellValue(sheetName, 74, 7, 199d),
					new ExpectedCellValue(sheetName, 75, 7, 1194d),
					new ExpectedCellValue(sheetName, 76, 7, 415.75),
					new ExpectedCellValue(sheetName, 77, 7, 831.5),
					new ExpectedCellValue(sheetName, 78, 7, null),
					new ExpectedCellValue(sheetName, 79, 7, 415.75),
					new ExpectedCellValue(sheetName, 80, 7, 415.75),
					new ExpectedCellValue(sheetName, 81, 7, 99d),
					new ExpectedCellValue(sheetName, 82, 7, 99d),
					new ExpectedCellValue(sheetName, 83, 7, 1985.99),
					new ExpectedCellValue(sheetName, 84, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondAndThirdFieldsLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C65:G104"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, null),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, null),
					new ExpectedCellValue(sheetName, 85, 3, null),
					new ExpectedCellValue(sheetName, 86, 3, null),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, null),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 90, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 91, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 92, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 93, 3, null),
					new ExpectedCellValue(sheetName, 94, 3, null),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null),
					new ExpectedCellValue(sheetName, 97, 3, null),
					new ExpectedCellValue(sheetName, 98, 3, null),
					new ExpectedCellValue(sheetName, 99, 3, null),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 101, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 102, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 104, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 4, "Month"),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, "January"),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 70, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 4, "March"),
					new ExpectedCellValue(sheetName, 72, 4, null),
					new ExpectedCellValue(sheetName, 73, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, null),
					new ExpectedCellValue(sheetName, 77, 4, null),
					new ExpectedCellValue(sheetName, 78, 4, "January"),
					new ExpectedCellValue(sheetName, 79, 4, null),
					new ExpectedCellValue(sheetName, 80, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 81, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 82, 4, "February"),
					new ExpectedCellValue(sheetName, 83, 4, null),
					new ExpectedCellValue(sheetName, 84, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 85, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 86, 4, "March"),
					new ExpectedCellValue(sheetName, 87, 4, null),
					new ExpectedCellValue(sheetName, 88, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 4, null),
					new ExpectedCellValue(sheetName, 91, 4, null),
					new ExpectedCellValue(sheetName, 92, 4, null),
					new ExpectedCellValue(sheetName, 93, 4, "January"),
					new ExpectedCellValue(sheetName, 94, 4, null),
					new ExpectedCellValue(sheetName, 95, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 4, "February"),
					new ExpectedCellValue(sheetName, 98, 4, null),
					new ExpectedCellValue(sheetName, 99, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 101, 4, null),
					new ExpectedCellValue(sheetName, 102, 4, null),
					new ExpectedCellValue(sheetName, 103, 4, null),
					new ExpectedCellValue(sheetName, 104, 4, null),
					new ExpectedCellValue(sheetName, 65, 5, "Item"),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 5, null),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 70, 5, null),
					new ExpectedCellValue(sheetName, 71, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 5, null),
					new ExpectedCellValue(sheetName, 73, 5, null),
					new ExpectedCellValue(sheetName, 74, 5, null),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, null),
					new ExpectedCellValue(sheetName, 77, 5, null),
					new ExpectedCellValue(sheetName, 78, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 5, null),
					new ExpectedCellValue(sheetName, 80, 5, null),
					new ExpectedCellValue(sheetName, 81, 5, null),
					new ExpectedCellValue(sheetName, 82, 5, "Tent"),
					new ExpectedCellValue(sheetName, 83, 5, null),
					new ExpectedCellValue(sheetName, 84, 5, null),
					new ExpectedCellValue(sheetName, 85, 5, null),
					new ExpectedCellValue(sheetName, 86, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 87, 5, null),
					new ExpectedCellValue(sheetName, 88, 5, null),
					new ExpectedCellValue(sheetName, 89, 5, null),
					new ExpectedCellValue(sheetName, 90, 5, null),
					new ExpectedCellValue(sheetName, 91, 5, null),
					new ExpectedCellValue(sheetName, 92, 5, null),
					new ExpectedCellValue(sheetName, 93, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 94, 5, null),
					new ExpectedCellValue(sheetName, 95, 5, null),
					new ExpectedCellValue(sheetName, 96, 5, null),
					new ExpectedCellValue(sheetName, 97, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 98, 5, null),
					new ExpectedCellValue(sheetName, 99, 5, null),
					new ExpectedCellValue(sheetName, 100, 5, null),
					new ExpectedCellValue(sheetName, 101, 5, null),
					new ExpectedCellValue(sheetName, 102, 5, null),
					new ExpectedCellValue(sheetName, 103, 5, null),
					new ExpectedCellValue(sheetName, 104, 5, null),
					new ExpectedCellValue(sheetName, 65, 6, "Values"),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 68, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 73, 6, null),
					new ExpectedCellValue(sheetName, 74, 6, null),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, null),
					new ExpectedCellValue(sheetName, 78, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 79, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 6, null),
					new ExpectedCellValue(sheetName, 81, 6, null),
					new ExpectedCellValue(sheetName, 82, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 83, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, null),
					new ExpectedCellValue(sheetName, 86, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 6, null),
					new ExpectedCellValue(sheetName, 89, 6, null),
					new ExpectedCellValue(sheetName, 90, 6, null),
					new ExpectedCellValue(sheetName, 91, 6, null),
					new ExpectedCellValue(sheetName, 92, 6, null),
					new ExpectedCellValue(sheetName, 93, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 6, null),
					new ExpectedCellValue(sheetName, 96, 6, null),
					new ExpectedCellValue(sheetName, 97, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 98, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 100, 6, null),
					new ExpectedCellValue(sheetName, 101, 6, null),
					new ExpectedCellValue(sheetName, 102, 6, null),
					new ExpectedCellValue(sheetName, 103, 6, null),
					new ExpectedCellValue(sheetName, 104, 6, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, 415.75),
					new ExpectedCellValue(sheetName, 68, 7, 831.5),
					new ExpectedCellValue(sheetName, 69, 7, 415.75),
					new ExpectedCellValue(sheetName, 70, 7, 831.5),
					new ExpectedCellValue(sheetName, 71, 7, 24.99),
					new ExpectedCellValue(sheetName, 72, 7, 24.99),
					new ExpectedCellValue(sheetName, 73, 7, 24.99),
					new ExpectedCellValue(sheetName, 74, 7, 24.99),
					new ExpectedCellValue(sheetName, 75, 7, 440.74),
					new ExpectedCellValue(sheetName, 76, 7, 856.49),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, 415.75),
					new ExpectedCellValue(sheetName, 79, 7, 831.5),
					new ExpectedCellValue(sheetName, 80, 7, 415.75),
					new ExpectedCellValue(sheetName, 81, 7, 831.5),
					new ExpectedCellValue(sheetName, 82, 7, 199d),
					new ExpectedCellValue(sheetName, 83, 7, 1194d),
					new ExpectedCellValue(sheetName, 84, 7, 199d),
					new ExpectedCellValue(sheetName, 85, 7, 1194d),
					new ExpectedCellValue(sheetName, 86, 7, 415.75),
					new ExpectedCellValue(sheetName, 87, 7, 831.5),
					new ExpectedCellValue(sheetName, 88, 7, 415.75),
					new ExpectedCellValue(sheetName, 89, 7, 831.5),
					new ExpectedCellValue(sheetName, 90, 7, 1030.5),
					new ExpectedCellValue(sheetName, 91, 7, 2857d),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, 415.75),
					new ExpectedCellValue(sheetName, 94, 7, 415.75),
					new ExpectedCellValue(sheetName, 95, 7, 415.75),
					new ExpectedCellValue(sheetName, 96, 7, 415.75),
					new ExpectedCellValue(sheetName, 97, 7, 99d),
					new ExpectedCellValue(sheetName, 98, 7, 99d),
					new ExpectedCellValue(sheetName, 99, 7, 99d),
					new ExpectedCellValue(sheetName, 100, 7, 99d),
					new ExpectedCellValue(sheetName, 101, 7, 514.75),
					new ExpectedCellValue(sheetName, 102, 7, 514.75),
					new ExpectedCellValue(sheetName, 103, 7, 1985.99),
					new ExpectedCellValue(sheetName, 104, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondAndThirdFieldsLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C65:G104"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, null),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, null),
					new ExpectedCellValue(sheetName, 85, 3, null),
					new ExpectedCellValue(sheetName, 86, 3, null),
					new ExpectedCellValue(sheetName, 87, 3, null),
					new ExpectedCellValue(sheetName, 88, 3, null),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 90, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 91, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 92, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 93, 3, null),
					new ExpectedCellValue(sheetName, 94, 3, null),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null),
					new ExpectedCellValue(sheetName, 97, 3, null),
					new ExpectedCellValue(sheetName, 98, 3, null),
					new ExpectedCellValue(sheetName, 99, 3, null),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 101, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 102, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 104, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 4, "Month"),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, "January"),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 70, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 4, "March"),
					new ExpectedCellValue(sheetName, 72, 4, null),
					new ExpectedCellValue(sheetName, 73, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, null),
					new ExpectedCellValue(sheetName, 77, 4, null),
					new ExpectedCellValue(sheetName, 78, 4, "January"),
					new ExpectedCellValue(sheetName, 79, 4, null),
					new ExpectedCellValue(sheetName, 80, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 81, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 82, 4, "February"),
					new ExpectedCellValue(sheetName, 83, 4, null),
					new ExpectedCellValue(sheetName, 84, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 85, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 86, 4, "March"),
					new ExpectedCellValue(sheetName, 87, 4, null),
					new ExpectedCellValue(sheetName, 88, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 4, null),
					new ExpectedCellValue(sheetName, 91, 4, null),
					new ExpectedCellValue(sheetName, 92, 4, null),
					new ExpectedCellValue(sheetName, 93, 4, "January"),
					new ExpectedCellValue(sheetName, 94, 4, null),
					new ExpectedCellValue(sheetName, 95, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 4, "February"),
					new ExpectedCellValue(sheetName, 98, 4, null),
					new ExpectedCellValue(sheetName, 99, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 101, 4, null),
					new ExpectedCellValue(sheetName, 102, 4, null),
					new ExpectedCellValue(sheetName, 103, 4, null),
					new ExpectedCellValue(sheetName, 104, 4, null),
					new ExpectedCellValue(sheetName, 65, 5, "Item"),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 5, null),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 70, 5, null),
					new ExpectedCellValue(sheetName, 71, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 5, null),
					new ExpectedCellValue(sheetName, 73, 5, null),
					new ExpectedCellValue(sheetName, 74, 5, null),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, null),
					new ExpectedCellValue(sheetName, 77, 5, null),
					new ExpectedCellValue(sheetName, 78, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 79, 5, null),
					new ExpectedCellValue(sheetName, 80, 5, null),
					new ExpectedCellValue(sheetName, 81, 5, null),
					new ExpectedCellValue(sheetName, 82, 5, "Tent"),
					new ExpectedCellValue(sheetName, 83, 5, null),
					new ExpectedCellValue(sheetName, 84, 5, null),
					new ExpectedCellValue(sheetName, 85, 5, null),
					new ExpectedCellValue(sheetName, 86, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 87, 5, null),
					new ExpectedCellValue(sheetName, 88, 5, null),
					new ExpectedCellValue(sheetName, 89, 5, null),
					new ExpectedCellValue(sheetName, 90, 5, null),
					new ExpectedCellValue(sheetName, 91, 5, null),
					new ExpectedCellValue(sheetName, 92, 5, null),
					new ExpectedCellValue(sheetName, 93, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 94, 5, null),
					new ExpectedCellValue(sheetName, 95, 5, null),
					new ExpectedCellValue(sheetName, 96, 5, null),
					new ExpectedCellValue(sheetName, 97, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 98, 5, null),
					new ExpectedCellValue(sheetName, 99, 5, null),
					new ExpectedCellValue(sheetName, 100, 5, null),
					new ExpectedCellValue(sheetName, 101, 5, null),
					new ExpectedCellValue(sheetName, 102, 5, null),
					new ExpectedCellValue(sheetName, 103, 5, null),
					new ExpectedCellValue(sheetName, 104, 5, null),
					new ExpectedCellValue(sheetName, 65, 6, "Values"),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 68, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, null),
					new ExpectedCellValue(sheetName, 71, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 73, 6, null),
					new ExpectedCellValue(sheetName, 74, 6, null),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, null),
					new ExpectedCellValue(sheetName, 78, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 79, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 6, null),
					new ExpectedCellValue(sheetName, 81, 6, null),
					new ExpectedCellValue(sheetName, 82, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 83, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, null),
					new ExpectedCellValue(sheetName, 86, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 6, null),
					new ExpectedCellValue(sheetName, 89, 6, null),
					new ExpectedCellValue(sheetName, 90, 6, null),
					new ExpectedCellValue(sheetName, 91, 6, null),
					new ExpectedCellValue(sheetName, 92, 6, null),
					new ExpectedCellValue(sheetName, 93, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 6, null),
					new ExpectedCellValue(sheetName, 96, 6, null),
					new ExpectedCellValue(sheetName, 97, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 98, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 100, 6, null),
					new ExpectedCellValue(sheetName, 101, 6, null),
					new ExpectedCellValue(sheetName, 102, 6, null),
					new ExpectedCellValue(sheetName, 103, 6, null),
					new ExpectedCellValue(sheetName, 104, 6, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, 415.75),
					new ExpectedCellValue(sheetName, 68, 7, 831.5),
					new ExpectedCellValue(sheetName, 69, 7, 415.75),
					new ExpectedCellValue(sheetName, 70, 7, 831.5),
					new ExpectedCellValue(sheetName, 71, 7, 24.99),
					new ExpectedCellValue(sheetName, 72, 7, 24.99),
					new ExpectedCellValue(sheetName, 73, 7, 24.99),
					new ExpectedCellValue(sheetName, 74, 7, 24.99),
					new ExpectedCellValue(sheetName, 75, 7, 440.74),
					new ExpectedCellValue(sheetName, 76, 7, 856.49),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, 415.75),
					new ExpectedCellValue(sheetName, 79, 7, 831.5),
					new ExpectedCellValue(sheetName, 80, 7, 415.75),
					new ExpectedCellValue(sheetName, 81, 7, 831.5),
					new ExpectedCellValue(sheetName, 82, 7, 199d),
					new ExpectedCellValue(sheetName, 83, 7, 1194d),
					new ExpectedCellValue(sheetName, 84, 7, 199d),
					new ExpectedCellValue(sheetName, 85, 7, 1194d),
					new ExpectedCellValue(sheetName, 86, 7, 415.75),
					new ExpectedCellValue(sheetName, 87, 7, 831.5),
					new ExpectedCellValue(sheetName, 88, 7, 415.75),
					new ExpectedCellValue(sheetName, 89, 7, 831.5),
					new ExpectedCellValue(sheetName, 90, 7, 1030.5),
					new ExpectedCellValue(sheetName, 91, 7, 2857d),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, 415.75),
					new ExpectedCellValue(sheetName, 94, 7, 415.75),
					new ExpectedCellValue(sheetName, 95, 7, 415.75),
					new ExpectedCellValue(sheetName, 96, 7, 415.75),
					new ExpectedCellValue(sheetName, 97, 7, 99d),
					new ExpectedCellValue(sheetName, 98, 7, 99d),
					new ExpectedCellValue(sheetName, 99, 7, 99d),
					new ExpectedCellValue(sheetName, 100, 7, 99d),
					new ExpectedCellValue(sheetName, 101, 7, 514.75),
					new ExpectedCellValue(sheetName, 102, 7, 514.75),
					new ExpectedCellValue(sheetName, 103, 7, 1985.99),
					new ExpectedCellValue(sheetName, 104, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndThirdFieldsTabularSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J65:N91"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 10, null),
					new ExpectedCellValue(sheetName, 68, 10, null),
					new ExpectedCellValue(sheetName, 69, 10, null),
					new ExpectedCellValue(sheetName, 70, 10, null),
					new ExpectedCellValue(sheetName, 71, 10, null),
					new ExpectedCellValue(sheetName, 72, 10, null),
					new ExpectedCellValue(sheetName, 73, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, null),
					new ExpectedCellValue(sheetName, 78, 10, null),
					new ExpectedCellValue(sheetName, 79, 10, null),
					new ExpectedCellValue(sheetName, 80, 10, null),
					new ExpectedCellValue(sheetName, 81, 10, null),
					new ExpectedCellValue(sheetName, 82, 10, null),
					new ExpectedCellValue(sheetName, 83, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 10, null),
					new ExpectedCellValue(sheetName, 85, 10, null),
					new ExpectedCellValue(sheetName, 86, 10, null),
					new ExpectedCellValue(sheetName, 87, 10, null),
					new ExpectedCellValue(sheetName, 88, 10, null),
					new ExpectedCellValue(sheetName, 89, 10, null),
					new ExpectedCellValue(sheetName, 90, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 91, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 11, "Month"),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, "January"),
					new ExpectedCellValue(sheetName, 68, 11, null),
					new ExpectedCellValue(sheetName, 69, 11, null),
					new ExpectedCellValue(sheetName, 70, 11, "March"),
					new ExpectedCellValue(sheetName, 71, 11, null),
					new ExpectedCellValue(sheetName, 72, 11, null),
					new ExpectedCellValue(sheetName, 73, 11, null),
					new ExpectedCellValue(sheetName, 74, 11, "January"),
					new ExpectedCellValue(sheetName, 75, 11, null),
					new ExpectedCellValue(sheetName, 76, 11, null),
					new ExpectedCellValue(sheetName, 77, 11, "February"),
					new ExpectedCellValue(sheetName, 78, 11, null),
					new ExpectedCellValue(sheetName, 79, 11, null),
					new ExpectedCellValue(sheetName, 80, 11, "March"),
					new ExpectedCellValue(sheetName, 81, 11, null),
					new ExpectedCellValue(sheetName, 82, 11, null),
					new ExpectedCellValue(sheetName, 83, 11, null),
					new ExpectedCellValue(sheetName, 84, 11, "January"),
					new ExpectedCellValue(sheetName, 85, 11, null),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, "February"),
					new ExpectedCellValue(sheetName, 88, 11, null),
					new ExpectedCellValue(sheetName, 89, 11, null),
					new ExpectedCellValue(sheetName, 90, 11, null),
					new ExpectedCellValue(sheetName, 91, 11, null),
					new ExpectedCellValue(sheetName, 65, 12, "Item"),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, null),
					new ExpectedCellValue(sheetName, 70, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 71, 12, null),
					new ExpectedCellValue(sheetName, 72, 12, null),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, null),
					new ExpectedCellValue(sheetName, 77, 12, "Tent"),
					new ExpectedCellValue(sheetName, 78, 12, null),
					new ExpectedCellValue(sheetName, 79, 12, null),
					new ExpectedCellValue(sheetName, 80, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, null),
					new ExpectedCellValue(sheetName, 83, 12, null),
					new ExpectedCellValue(sheetName, 84, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 85, 12, null),
					new ExpectedCellValue(sheetName, 86, 12, null),
					new ExpectedCellValue(sheetName, 87, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 90, 12, null),
					new ExpectedCellValue(sheetName, 91, 12, null),
					new ExpectedCellValue(sheetName, 65, 13, "Values"),
					new ExpectedCellValue(sheetName, 66, 13, null),
					new ExpectedCellValue(sheetName, 67, 13, null),
					new ExpectedCellValue(sheetName, 68, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 73, 13, null),
					new ExpectedCellValue(sheetName, 74, 13, null),
					new ExpectedCellValue(sheetName, 75, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 13, null),
					new ExpectedCellValue(sheetName, 78, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 79, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 13, null),
					new ExpectedCellValue(sheetName, 81, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 13, null),
					new ExpectedCellValue(sheetName, 84, 13, null),
					new ExpectedCellValue(sheetName, 85, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 86, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 87, 13, null),
					new ExpectedCellValue(sheetName, 88, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 13, null),
					new ExpectedCellValue(sheetName, 91, 13, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, null),
					new ExpectedCellValue(sheetName, 68, 14, 415.75),
					new ExpectedCellValue(sheetName, 69, 14, 831.5),
					new ExpectedCellValue(sheetName, 70, 14, null),
					new ExpectedCellValue(sheetName, 71, 14, 24.99),
					new ExpectedCellValue(sheetName, 72, 14, 24.99),
					new ExpectedCellValue(sheetName, 73, 14, null),
					new ExpectedCellValue(sheetName, 74, 14, null),
					new ExpectedCellValue(sheetName, 75, 14, 415.75),
					new ExpectedCellValue(sheetName, 76, 14, 831.5),
					new ExpectedCellValue(sheetName, 77, 14, null),
					new ExpectedCellValue(sheetName, 78, 14, 199d),
					new ExpectedCellValue(sheetName, 79, 14, 1194d),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, 415.75),
					new ExpectedCellValue(sheetName, 82, 14, 831.5),
					new ExpectedCellValue(sheetName, 83, 14, null),
					new ExpectedCellValue(sheetName, 84, 14, null),
					new ExpectedCellValue(sheetName, 85, 14, 415.75),
					new ExpectedCellValue(sheetName, 86, 14, 415.75),
					new ExpectedCellValue(sheetName, 87, 14, null),
					new ExpectedCellValue(sheetName, 88, 14, 99d),
					new ExpectedCellValue(sheetName, 89, 14, 99d),
					new ExpectedCellValue(sheetName, 90, 14, 1985.99),
					new ExpectedCellValue(sheetName, 91, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndThirdFieldsTabularSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J65:N111"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 10, null),
					new ExpectedCellValue(sheetName, 68, 10, null),
					new ExpectedCellValue(sheetName, 69, 10, null),
					new ExpectedCellValue(sheetName, 70, 10, null),
					new ExpectedCellValue(sheetName, 71, 10, null),
					new ExpectedCellValue(sheetName, 72, 10, null),
					new ExpectedCellValue(sheetName, 73, 10, null),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 79, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 80, 10, null),
					new ExpectedCellValue(sheetName, 81, 10, null),
					new ExpectedCellValue(sheetName, 82, 10, null),
					new ExpectedCellValue(sheetName, 83, 10, null),
					new ExpectedCellValue(sheetName, 84, 10, null),
					new ExpectedCellValue(sheetName, 85, 10, null),
					new ExpectedCellValue(sheetName, 86, 10, null),
					new ExpectedCellValue(sheetName, 87, 10, null),
					new ExpectedCellValue(sheetName, 88, 10, null),
					new ExpectedCellValue(sheetName, 89, 10, null),
					new ExpectedCellValue(sheetName, 90, 10, null),
					new ExpectedCellValue(sheetName, 91, 10, null),
					new ExpectedCellValue(sheetName, 92, 10, null),
					new ExpectedCellValue(sheetName, 93, 10, null),
					new ExpectedCellValue(sheetName, 94, 10, null),
					new ExpectedCellValue(sheetName, 95, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 10, null),
					new ExpectedCellValue(sheetName, 99, 10, null),
					new ExpectedCellValue(sheetName, 100, 10, null),
					new ExpectedCellValue(sheetName, 101, 10, null),
					new ExpectedCellValue(sheetName, 102, 10, null),
					new ExpectedCellValue(sheetName, 103, 10, null),
					new ExpectedCellValue(sheetName, 104, 10, null),
					new ExpectedCellValue(sheetName, 105, 10, null),
					new ExpectedCellValue(sheetName, 106, 10, null),
					new ExpectedCellValue(sheetName, 107, 10, null),
					new ExpectedCellValue(sheetName, 108, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 109, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 111, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 11, "Month"),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, "January"),
					new ExpectedCellValue(sheetName, 68, 11, null),
					new ExpectedCellValue(sheetName, 69, 11, null),
					new ExpectedCellValue(sheetName, 70, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 11, "March"),
					new ExpectedCellValue(sheetName, 73, 11, null),
					new ExpectedCellValue(sheetName, 74, 11, null),
					new ExpectedCellValue(sheetName, 75, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 11, null),
					new ExpectedCellValue(sheetName, 78, 11, null),
					new ExpectedCellValue(sheetName, 79, 11, null),
					new ExpectedCellValue(sheetName, 80, 11, "January"),
					new ExpectedCellValue(sheetName, 81, 11, null),
					new ExpectedCellValue(sheetName, 82, 11, null),
					new ExpectedCellValue(sheetName, 83, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 84, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 11, "February"),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, null),
					new ExpectedCellValue(sheetName, 88, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 11, "March"),
					new ExpectedCellValue(sheetName, 91, 11, null),
					new ExpectedCellValue(sheetName, 92, 11, null),
					new ExpectedCellValue(sheetName, 93, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 11, null),
					new ExpectedCellValue(sheetName, 96, 11, null),
					new ExpectedCellValue(sheetName, 97, 11, null),
					new ExpectedCellValue(sheetName, 98, 11, "January"),
					new ExpectedCellValue(sheetName, 99, 11, null),
					new ExpectedCellValue(sheetName, 100, 11, null),
					new ExpectedCellValue(sheetName, 101, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 102, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 11, "February"),
					new ExpectedCellValue(sheetName, 104, 11, null),
					new ExpectedCellValue(sheetName, 105, 11, null),
					new ExpectedCellValue(sheetName, 106, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 107, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 11, null),
					new ExpectedCellValue(sheetName, 109, 11, null),
					new ExpectedCellValue(sheetName, 110, 11, null),
					new ExpectedCellValue(sheetName, 111, 11, null),
					new ExpectedCellValue(sheetName, 65, 12, "Item"),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, null),
					new ExpectedCellValue(sheetName, 70, 12, null),
					new ExpectedCellValue(sheetName, 71, 12, null),
					new ExpectedCellValue(sheetName, 72, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, null),
					new ExpectedCellValue(sheetName, 77, 12, null),
					new ExpectedCellValue(sheetName, 78, 12, null),
					new ExpectedCellValue(sheetName, 79, 12, null),
					new ExpectedCellValue(sheetName, 80, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, null),
					new ExpectedCellValue(sheetName, 83, 12, null),
					new ExpectedCellValue(sheetName, 84, 12, null),
					new ExpectedCellValue(sheetName, 85, 12, "Tent"),
					new ExpectedCellValue(sheetName, 86, 12, null),
					new ExpectedCellValue(sheetName, 87, 12, null),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 90, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 91, 12, null),
					new ExpectedCellValue(sheetName, 92, 12, null),
					new ExpectedCellValue(sheetName, 93, 12, null),
					new ExpectedCellValue(sheetName, 94, 12, null),
					new ExpectedCellValue(sheetName, 95, 12, null),
					new ExpectedCellValue(sheetName, 96, 12, null),
					new ExpectedCellValue(sheetName, 97, 12, null),
					new ExpectedCellValue(sheetName, 98, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 99, 12, null),
					new ExpectedCellValue(sheetName, 100, 12, null),
					new ExpectedCellValue(sheetName, 101, 12, null),
					new ExpectedCellValue(sheetName, 102, 12, null),
					new ExpectedCellValue(sheetName, 103, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 104, 12, null),
					new ExpectedCellValue(sheetName, 105, 12, null),
					new ExpectedCellValue(sheetName, 106, 12, null),
					new ExpectedCellValue(sheetName, 107, 12, null),
					new ExpectedCellValue(sheetName, 108, 12, null),
					new ExpectedCellValue(sheetName, 109, 12, null),
					new ExpectedCellValue(sheetName, 110, 12, null),
					new ExpectedCellValue(sheetName, 111, 12, null),
					new ExpectedCellValue(sheetName, 65, 13, "Values"),
					new ExpectedCellValue(sheetName, 66, 13, null),
					new ExpectedCellValue(sheetName, 67, 13, null),
					new ExpectedCellValue(sheetName, 68, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, null),
					new ExpectedCellValue(sheetName, 72, 13, null),
					new ExpectedCellValue(sheetName, 73, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 75, 13, null),
					new ExpectedCellValue(sheetName, 76, 13, null),
					new ExpectedCellValue(sheetName, 77, 13, null),
					new ExpectedCellValue(sheetName, 78, 13, null),
					new ExpectedCellValue(sheetName, 79, 13, null),
					new ExpectedCellValue(sheetName, 80, 13, null),
					new ExpectedCellValue(sheetName, 81, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 13, null),
					new ExpectedCellValue(sheetName, 84, 13, null),
					new ExpectedCellValue(sheetName, 85, 13, null),
					new ExpectedCellValue(sheetName, 86, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 13, null),
					new ExpectedCellValue(sheetName, 89, 13, null),
					new ExpectedCellValue(sheetName, 90, 13, null),
					new ExpectedCellValue(sheetName, 91, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 92, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 93, 13, null),
					new ExpectedCellValue(sheetName, 94, 13, null),
					new ExpectedCellValue(sheetName, 95, 13, null),
					new ExpectedCellValue(sheetName, 96, 13, null),
					new ExpectedCellValue(sheetName, 97, 13, null),
					new ExpectedCellValue(sheetName, 98, 13, null),
					new ExpectedCellValue(sheetName, 99, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 101, 13, null),
					new ExpectedCellValue(sheetName, 102, 13, null),
					new ExpectedCellValue(sheetName, 103, 13, null),
					new ExpectedCellValue(sheetName, 104, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 13, null),
					new ExpectedCellValue(sheetName, 107, 13, null),
					new ExpectedCellValue(sheetName, 108, 13, null),
					new ExpectedCellValue(sheetName, 109, 13, null),
					new ExpectedCellValue(sheetName, 110, 13, null),
					new ExpectedCellValue(sheetName, 111, 13, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, null),
					new ExpectedCellValue(sheetName, 68, 14, 415.75),
					new ExpectedCellValue(sheetName, 69, 14, 831.5),
					new ExpectedCellValue(sheetName, 70, 14, 415.75),
					new ExpectedCellValue(sheetName, 71, 14, 831.5),
					new ExpectedCellValue(sheetName, 72, 14, null),
					new ExpectedCellValue(sheetName, 73, 14, 24.99),
					new ExpectedCellValue(sheetName, 74, 14, 24.99),
					new ExpectedCellValue(sheetName, 75, 14, 24.99),
					new ExpectedCellValue(sheetName, 76, 14, 24.99),
					new ExpectedCellValue(sheetName, 77, 14, 440.74),
					new ExpectedCellValue(sheetName, 78, 14, 856.49),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, 415.75),
					new ExpectedCellValue(sheetName, 82, 14, 831.5),
					new ExpectedCellValue(sheetName, 83, 14, 415.75),
					new ExpectedCellValue(sheetName, 84, 14, 831.5),
					new ExpectedCellValue(sheetName, 85, 14, null),
					new ExpectedCellValue(sheetName, 86, 14, 199d),
					new ExpectedCellValue(sheetName, 87, 14, 1194d),
					new ExpectedCellValue(sheetName, 88, 14, 199d),
					new ExpectedCellValue(sheetName, 89, 14, 1194d),
					new ExpectedCellValue(sheetName, 90, 14, null),
					new ExpectedCellValue(sheetName, 91, 14, 415.75),
					new ExpectedCellValue(sheetName, 92, 14, 831.5),
					new ExpectedCellValue(sheetName, 93, 14, 415.75),
					new ExpectedCellValue(sheetName, 94, 14, 831.5),
					new ExpectedCellValue(sheetName, 95, 14, 1030.5),
					new ExpectedCellValue(sheetName, 96, 14, 2857d),
					new ExpectedCellValue(sheetName, 97, 14, null),
					new ExpectedCellValue(sheetName, 98, 14, null),
					new ExpectedCellValue(sheetName, 99, 14, 415.75),
					new ExpectedCellValue(sheetName, 100, 14, 415.75),
					new ExpectedCellValue(sheetName, 101, 14, 415.75),
					new ExpectedCellValue(sheetName, 102, 14, 415.75),
					new ExpectedCellValue(sheetName, 103, 14, null),
					new ExpectedCellValue(sheetName, 104, 14, 99d),
					new ExpectedCellValue(sheetName, 105, 14, 99d),
					new ExpectedCellValue(sheetName, 106, 14, 99d),
					new ExpectedCellValue(sheetName, 107, 14, 99d),
					new ExpectedCellValue(sheetName, 108, 14, 514.75),
					new ExpectedCellValue(sheetName, 109, 14, 514.75),
					new ExpectedCellValue(sheetName, 110, 14, 1985.99),
					new ExpectedCellValue(sheetName, 111, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndThirdFieldsTabularSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J65:N111"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 10, null),
					new ExpectedCellValue(sheetName, 68, 10, null),
					new ExpectedCellValue(sheetName, 69, 10, null),
					new ExpectedCellValue(sheetName, 70, 10, null),
					new ExpectedCellValue(sheetName, 71, 10, null),
					new ExpectedCellValue(sheetName, 72, 10, null),
					new ExpectedCellValue(sheetName, 73, 10, null),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 79, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 80, 10, null),
					new ExpectedCellValue(sheetName, 81, 10, null),
					new ExpectedCellValue(sheetName, 82, 10, null),
					new ExpectedCellValue(sheetName, 83, 10, null),
					new ExpectedCellValue(sheetName, 84, 10, null),
					new ExpectedCellValue(sheetName, 85, 10, null),
					new ExpectedCellValue(sheetName, 86, 10, null),
					new ExpectedCellValue(sheetName, 87, 10, null),
					new ExpectedCellValue(sheetName, 88, 10, null),
					new ExpectedCellValue(sheetName, 89, 10, null),
					new ExpectedCellValue(sheetName, 90, 10, null),
					new ExpectedCellValue(sheetName, 91, 10, null),
					new ExpectedCellValue(sheetName, 92, 10, null),
					new ExpectedCellValue(sheetName, 93, 10, null),
					new ExpectedCellValue(sheetName, 94, 10, null),
					new ExpectedCellValue(sheetName, 95, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 10, null),
					new ExpectedCellValue(sheetName, 99, 10, null),
					new ExpectedCellValue(sheetName, 100, 10, null),
					new ExpectedCellValue(sheetName, 101, 10, null),
					new ExpectedCellValue(sheetName, 102, 10, null),
					new ExpectedCellValue(sheetName, 103, 10, null),
					new ExpectedCellValue(sheetName, 104, 10, null),
					new ExpectedCellValue(sheetName, 105, 10, null),
					new ExpectedCellValue(sheetName, 106, 10, null),
					new ExpectedCellValue(sheetName, 107, 10, null),
					new ExpectedCellValue(sheetName, 108, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 109, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 111, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 11, "Month"),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, "January"),
					new ExpectedCellValue(sheetName, 68, 11, null),
					new ExpectedCellValue(sheetName, 69, 11, null),
					new ExpectedCellValue(sheetName, 70, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 11, "March"),
					new ExpectedCellValue(sheetName, 73, 11, null),
					new ExpectedCellValue(sheetName, 74, 11, null),
					new ExpectedCellValue(sheetName, 75, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 11, null),
					new ExpectedCellValue(sheetName, 78, 11, null),
					new ExpectedCellValue(sheetName, 79, 11, null),
					new ExpectedCellValue(sheetName, 80, 11, "January"),
					new ExpectedCellValue(sheetName, 81, 11, null),
					new ExpectedCellValue(sheetName, 82, 11, null),
					new ExpectedCellValue(sheetName, 83, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 84, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 11, "February"),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, null),
					new ExpectedCellValue(sheetName, 88, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 11, "March"),
					new ExpectedCellValue(sheetName, 91, 11, null),
					new ExpectedCellValue(sheetName, 92, 11, null),
					new ExpectedCellValue(sheetName, 93, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 11, null),
					new ExpectedCellValue(sheetName, 96, 11, null),
					new ExpectedCellValue(sheetName, 97, 11, null),
					new ExpectedCellValue(sheetName, 98, 11, "January"),
					new ExpectedCellValue(sheetName, 99, 11, null),
					new ExpectedCellValue(sheetName, 100, 11, null),
					new ExpectedCellValue(sheetName, 101, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 102, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 11, "February"),
					new ExpectedCellValue(sheetName, 104, 11, null),
					new ExpectedCellValue(sheetName, 105, 11, null),
					new ExpectedCellValue(sheetName, 106, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 107, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 11, null),
					new ExpectedCellValue(sheetName, 109, 11, null),
					new ExpectedCellValue(sheetName, 110, 11, null),
					new ExpectedCellValue(sheetName, 111, 11, null),
					new ExpectedCellValue(sheetName, 65, 12, "Item"),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, null),
					new ExpectedCellValue(sheetName, 70, 12, null),
					new ExpectedCellValue(sheetName, 71, 12, null),
					new ExpectedCellValue(sheetName, 72, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, null),
					new ExpectedCellValue(sheetName, 77, 12, null),
					new ExpectedCellValue(sheetName, 78, 12, null),
					new ExpectedCellValue(sheetName, 79, 12, null),
					new ExpectedCellValue(sheetName, 80, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 81, 12, null),
					new ExpectedCellValue(sheetName, 82, 12, null),
					new ExpectedCellValue(sheetName, 83, 12, null),
					new ExpectedCellValue(sheetName, 84, 12, null),
					new ExpectedCellValue(sheetName, 85, 12, "Tent"),
					new ExpectedCellValue(sheetName, 86, 12, null),
					new ExpectedCellValue(sheetName, 87, 12, null),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, null),
					new ExpectedCellValue(sheetName, 90, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 91, 12, null),
					new ExpectedCellValue(sheetName, 92, 12, null),
					new ExpectedCellValue(sheetName, 93, 12, null),
					new ExpectedCellValue(sheetName, 94, 12, null),
					new ExpectedCellValue(sheetName, 95, 12, null),
					new ExpectedCellValue(sheetName, 96, 12, null),
					new ExpectedCellValue(sheetName, 97, 12, null),
					new ExpectedCellValue(sheetName, 98, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 99, 12, null),
					new ExpectedCellValue(sheetName, 100, 12, null),
					new ExpectedCellValue(sheetName, 101, 12, null),
					new ExpectedCellValue(sheetName, 102, 12, null),
					new ExpectedCellValue(sheetName, 103, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 104, 12, null),
					new ExpectedCellValue(sheetName, 105, 12, null),
					new ExpectedCellValue(sheetName, 106, 12, null),
					new ExpectedCellValue(sheetName, 107, 12, null),
					new ExpectedCellValue(sheetName, 108, 12, null),
					new ExpectedCellValue(sheetName, 109, 12, null),
					new ExpectedCellValue(sheetName, 110, 12, null),
					new ExpectedCellValue(sheetName, 111, 12, null),
					new ExpectedCellValue(sheetName, 65, 13, "Values"),
					new ExpectedCellValue(sheetName, 66, 13, null),
					new ExpectedCellValue(sheetName, 67, 13, null),
					new ExpectedCellValue(sheetName, 68, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, null),
					new ExpectedCellValue(sheetName, 72, 13, null),
					new ExpectedCellValue(sheetName, 73, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 75, 13, null),
					new ExpectedCellValue(sheetName, 76, 13, null),
					new ExpectedCellValue(sheetName, 77, 13, null),
					new ExpectedCellValue(sheetName, 78, 13, null),
					new ExpectedCellValue(sheetName, 79, 13, null),
					new ExpectedCellValue(sheetName, 80, 13, null),
					new ExpectedCellValue(sheetName, 81, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 13, null),
					new ExpectedCellValue(sheetName, 84, 13, null),
					new ExpectedCellValue(sheetName, 85, 13, null),
					new ExpectedCellValue(sheetName, 86, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 13, null),
					new ExpectedCellValue(sheetName, 89, 13, null),
					new ExpectedCellValue(sheetName, 90, 13, null),
					new ExpectedCellValue(sheetName, 91, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 92, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 93, 13, null),
					new ExpectedCellValue(sheetName, 94, 13, null),
					new ExpectedCellValue(sheetName, 95, 13, null),
					new ExpectedCellValue(sheetName, 96, 13, null),
					new ExpectedCellValue(sheetName, 97, 13, null),
					new ExpectedCellValue(sheetName, 98, 13, null),
					new ExpectedCellValue(sheetName, 99, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 101, 13, null),
					new ExpectedCellValue(sheetName, 102, 13, null),
					new ExpectedCellValue(sheetName, 103, 13, null),
					new ExpectedCellValue(sheetName, 104, 13, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 13, null),
					new ExpectedCellValue(sheetName, 107, 13, null),
					new ExpectedCellValue(sheetName, 108, 13, null),
					new ExpectedCellValue(sheetName, 109, 13, null),
					new ExpectedCellValue(sheetName, 110, 13, null),
					new ExpectedCellValue(sheetName, 111, 13, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, null),
					new ExpectedCellValue(sheetName, 68, 14, 415.75),
					new ExpectedCellValue(sheetName, 69, 14, 831.5),
					new ExpectedCellValue(sheetName, 70, 14, 415.75),
					new ExpectedCellValue(sheetName, 71, 14, 831.5),
					new ExpectedCellValue(sheetName, 72, 14, null),
					new ExpectedCellValue(sheetName, 73, 14, 24.99),
					new ExpectedCellValue(sheetName, 74, 14, 24.99),
					new ExpectedCellValue(sheetName, 75, 14, 24.99),
					new ExpectedCellValue(sheetName, 76, 14, 24.99),
					new ExpectedCellValue(sheetName, 77, 14, 440.74),
					new ExpectedCellValue(sheetName, 78, 14, 856.49),
					new ExpectedCellValue(sheetName, 79, 14, null),
					new ExpectedCellValue(sheetName, 80, 14, null),
					new ExpectedCellValue(sheetName, 81, 14, 415.75),
					new ExpectedCellValue(sheetName, 82, 14, 831.5),
					new ExpectedCellValue(sheetName, 83, 14, 415.75),
					new ExpectedCellValue(sheetName, 84, 14, 831.5),
					new ExpectedCellValue(sheetName, 85, 14, null),
					new ExpectedCellValue(sheetName, 86, 14, 199d),
					new ExpectedCellValue(sheetName, 87, 14, 1194d),
					new ExpectedCellValue(sheetName, 88, 14, 199d),
					new ExpectedCellValue(sheetName, 89, 14, 1194d),
					new ExpectedCellValue(sheetName, 90, 14, null),
					new ExpectedCellValue(sheetName, 91, 14, 415.75),
					new ExpectedCellValue(sheetName, 92, 14, 831.5),
					new ExpectedCellValue(sheetName, 93, 14, 415.75),
					new ExpectedCellValue(sheetName, 94, 14, 831.5),
					new ExpectedCellValue(sheetName, 95, 14, 1030.5),
					new ExpectedCellValue(sheetName, 96, 14, 2857d),
					new ExpectedCellValue(sheetName, 97, 14, null),
					new ExpectedCellValue(sheetName, 98, 14, null),
					new ExpectedCellValue(sheetName, 99, 14, 415.75),
					new ExpectedCellValue(sheetName, 100, 14, 415.75),
					new ExpectedCellValue(sheetName, 101, 14, 415.75),
					new ExpectedCellValue(sheetName, 102, 14, 415.75),
					new ExpectedCellValue(sheetName, 103, 14, null),
					new ExpectedCellValue(sheetName, 104, 14, 99d),
					new ExpectedCellValue(sheetName, 105, 14, 99d),
					new ExpectedCellValue(sheetName, 106, 14, 99d),
					new ExpectedCellValue(sheetName, 107, 14, 99d),
					new ExpectedCellValue(sheetName, 108, 14, 514.75),
					new ExpectedCellValue(sheetName, 109, 14, 514.75),
					new ExpectedCellValue(sheetName, 110, 14, 1985.99),
					new ExpectedCellValue(sheetName, 111, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndSecondFieldsTabularThirdFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q65:U91"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 17, null),
					new ExpectedCellValue(sheetName, 68, 17, null),
					new ExpectedCellValue(sheetName, 69, 17, null),
					new ExpectedCellValue(sheetName, 70, 17, null),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, null),
					new ExpectedCellValue(sheetName, 73, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 74, 17, null),
					new ExpectedCellValue(sheetName, 75, 17, null),
					new ExpectedCellValue(sheetName, 76, 17, null),
					new ExpectedCellValue(sheetName, 77, 17, null),
					new ExpectedCellValue(sheetName, 78, 17, null),
					new ExpectedCellValue(sheetName, 79, 17, null),
					new ExpectedCellValue(sheetName, 80, 17, null),
					new ExpectedCellValue(sheetName, 81, 17, null),
					new ExpectedCellValue(sheetName, 82, 17, null),
					new ExpectedCellValue(sheetName, 83, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 84, 17, null),
					new ExpectedCellValue(sheetName, 85, 17, null),
					new ExpectedCellValue(sheetName, 86, 17, null),
					new ExpectedCellValue(sheetName, 87, 17, null),
					new ExpectedCellValue(sheetName, 88, 17, null),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 91, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 18, "Month"),
					new ExpectedCellValue(sheetName, 66, 18, null),
					new ExpectedCellValue(sheetName, 67, 18, "January"),
					new ExpectedCellValue(sheetName, 68, 18, null),
					new ExpectedCellValue(sheetName, 69, 18, null),
					new ExpectedCellValue(sheetName, 70, 18, "March"),
					new ExpectedCellValue(sheetName, 71, 18, null),
					new ExpectedCellValue(sheetName, 72, 18, null),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, "January"),
					new ExpectedCellValue(sheetName, 75, 18, null),
					new ExpectedCellValue(sheetName, 76, 18, null),
					new ExpectedCellValue(sheetName, 77, 18, "February"),
					new ExpectedCellValue(sheetName, 78, 18, null),
					new ExpectedCellValue(sheetName, 79, 18, null),
					new ExpectedCellValue(sheetName, 80, 18, "March"),
					new ExpectedCellValue(sheetName, 81, 18, null),
					new ExpectedCellValue(sheetName, 82, 18, null),
					new ExpectedCellValue(sheetName, 83, 18, null),
					new ExpectedCellValue(sheetName, 84, 18, "January"),
					new ExpectedCellValue(sheetName, 85, 18, null),
					new ExpectedCellValue(sheetName, 86, 18, null),
					new ExpectedCellValue(sheetName, 87, 18, "February"),
					new ExpectedCellValue(sheetName, 88, 18, null),
					new ExpectedCellValue(sheetName, 89, 18, null),
					new ExpectedCellValue(sheetName, 90, 18, null),
					new ExpectedCellValue(sheetName, 91, 18, null),
					new ExpectedCellValue(sheetName, 65, 19, "Item"),
					new ExpectedCellValue(sheetName, 66, 19, null),
					new ExpectedCellValue(sheetName, 67, 19, null),
					new ExpectedCellValue(sheetName, 68, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 19, null),
					new ExpectedCellValue(sheetName, 70, 19, null),
					new ExpectedCellValue(sheetName, 71, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 72, 19, null),
					new ExpectedCellValue(sheetName, 73, 19, null),
					new ExpectedCellValue(sheetName, 74, 19, null),
					new ExpectedCellValue(sheetName, 75, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 76, 19, null),
					new ExpectedCellValue(sheetName, 77, 19, null),
					new ExpectedCellValue(sheetName, 78, 19, "Tent"),
					new ExpectedCellValue(sheetName, 79, 19, null),
					new ExpectedCellValue(sheetName, 80, 19, null),
					new ExpectedCellValue(sheetName, 81, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 82, 19, null),
					new ExpectedCellValue(sheetName, 83, 19, null),
					new ExpectedCellValue(sheetName, 84, 19, null),
					new ExpectedCellValue(sheetName, 85, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 86, 19, null),
					new ExpectedCellValue(sheetName, 87, 19, null),
					new ExpectedCellValue(sheetName, 88, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 89, 19, null),
					new ExpectedCellValue(sheetName, 90, 19, null),
					new ExpectedCellValue(sheetName, 91, 19, null),
					new ExpectedCellValue(sheetName, 65, 20, "Values"),
					new ExpectedCellValue(sheetName, 66, 20, null),
					new ExpectedCellValue(sheetName, 67, 20, null),
					new ExpectedCellValue(sheetName, 68, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 20, null),
					new ExpectedCellValue(sheetName, 71, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 73, 20, null),
					new ExpectedCellValue(sheetName, 74, 20, null),
					new ExpectedCellValue(sheetName, 75, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 20, null),
					new ExpectedCellValue(sheetName, 78, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 79, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 20, null),
					new ExpectedCellValue(sheetName, 81, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 20, null),
					new ExpectedCellValue(sheetName, 84, 20, null),
					new ExpectedCellValue(sheetName, 85, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 86, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 87, 20, null),
					new ExpectedCellValue(sheetName, 88, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 20, null),
					new ExpectedCellValue(sheetName, 91, 20, null),
					new ExpectedCellValue(sheetName, 65, 21, null),
					new ExpectedCellValue(sheetName, 66, 21, null),
					new ExpectedCellValue(sheetName, 67, 21, null),
					new ExpectedCellValue(sheetName, 68, 21, 415.75),
					new ExpectedCellValue(sheetName, 69, 21, 831.5),
					new ExpectedCellValue(sheetName, 70, 21, null),
					new ExpectedCellValue(sheetName, 71, 21, 24.99),
					new ExpectedCellValue(sheetName, 72, 21, 24.99),
					new ExpectedCellValue(sheetName, 73, 21, null),
					new ExpectedCellValue(sheetName, 74, 21, null),
					new ExpectedCellValue(sheetName, 75, 21, 415.75),
					new ExpectedCellValue(sheetName, 76, 21, 831.5),
					new ExpectedCellValue(sheetName, 77, 21, null),
					new ExpectedCellValue(sheetName, 78, 21, 199d),
					new ExpectedCellValue(sheetName, 79, 21, 1194d),
					new ExpectedCellValue(sheetName, 80, 21, null),
					new ExpectedCellValue(sheetName, 81, 21, 415.75),
					new ExpectedCellValue(sheetName, 82, 21, 831.5),
					new ExpectedCellValue(sheetName, 83, 21, null),
					new ExpectedCellValue(sheetName, 84, 21, null),
					new ExpectedCellValue(sheetName, 85, 21, 415.75),
					new ExpectedCellValue(sheetName, 86, 21, 415.75),
					new ExpectedCellValue(sheetName, 87, 21, null),
					new ExpectedCellValue(sheetName, 88, 21, 99d),
					new ExpectedCellValue(sheetName, 89, 21, 99d),
					new ExpectedCellValue(sheetName, 90, 21, 1985.99),
					new ExpectedCellValue(sheetName, 91, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndSecondFieldsTabularThirdFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q65:U111"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 17, null),
					new ExpectedCellValue(sheetName, 68, 17, null),
					new ExpectedCellValue(sheetName, 69, 17, null),
					new ExpectedCellValue(sheetName, 70, 17, null),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, null),
					new ExpectedCellValue(sheetName, 73, 17, null),
					new ExpectedCellValue(sheetName, 74, 17, null),
					new ExpectedCellValue(sheetName, 75, 17, null),
					new ExpectedCellValue(sheetName, 76, 17, null),
					new ExpectedCellValue(sheetName, 77, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 79, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 80, 17, null),
					new ExpectedCellValue(sheetName, 81, 17, null),
					new ExpectedCellValue(sheetName, 82, 17, null),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, null),
					new ExpectedCellValue(sheetName, 85, 17, null),
					new ExpectedCellValue(sheetName, 86, 17, null),
					new ExpectedCellValue(sheetName, 87, 17, null),
					new ExpectedCellValue(sheetName, 88, 17, null),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, null),
					new ExpectedCellValue(sheetName, 91, 17, null),
					new ExpectedCellValue(sheetName, 92, 17, null),
					new ExpectedCellValue(sheetName, 93, 17, null),
					new ExpectedCellValue(sheetName, 94, 17, null),
					new ExpectedCellValue(sheetName, 95, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 17, null),
					new ExpectedCellValue(sheetName, 99, 17, null),
					new ExpectedCellValue(sheetName, 100, 17, null),
					new ExpectedCellValue(sheetName, 101, 17, null),
					new ExpectedCellValue(sheetName, 102, 17, null),
					new ExpectedCellValue(sheetName, 103, 17, null),
					new ExpectedCellValue(sheetName, 104, 17, null),
					new ExpectedCellValue(sheetName, 105, 17, null),
					new ExpectedCellValue(sheetName, 106, 17, null),
					new ExpectedCellValue(sheetName, 107, 17, null),
					new ExpectedCellValue(sheetName, 108, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 109, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 111, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 18, "Month"),
					new ExpectedCellValue(sheetName, 66, 18, null),
					new ExpectedCellValue(sheetName, 67, 18, "January"),
					new ExpectedCellValue(sheetName, 68, 18, null),
					new ExpectedCellValue(sheetName, 69, 18, null),
					new ExpectedCellValue(sheetName, 70, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 18, "March"),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, null),
					new ExpectedCellValue(sheetName, 75, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 18, null),
					new ExpectedCellValue(sheetName, 78, 18, null),
					new ExpectedCellValue(sheetName, 79, 18, null),
					new ExpectedCellValue(sheetName, 80, 18, "January"),
					new ExpectedCellValue(sheetName, 81, 18, null),
					new ExpectedCellValue(sheetName, 82, 18, null),
					new ExpectedCellValue(sheetName, 83, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 84, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 18, "February"),
					new ExpectedCellValue(sheetName, 86, 18, null),
					new ExpectedCellValue(sheetName, 87, 18, null),
					new ExpectedCellValue(sheetName, 88, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 18, "March"),
					new ExpectedCellValue(sheetName, 91, 18, null),
					new ExpectedCellValue(sheetName, 92, 18, null),
					new ExpectedCellValue(sheetName, 93, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 18, null),
					new ExpectedCellValue(sheetName, 96, 18, null),
					new ExpectedCellValue(sheetName, 97, 18, null),
					new ExpectedCellValue(sheetName, 98, 18, "January"),
					new ExpectedCellValue(sheetName, 99, 18, null),
					new ExpectedCellValue(sheetName, 100, 18, null),
					new ExpectedCellValue(sheetName, 101, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 102, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 18, "February"),
					new ExpectedCellValue(sheetName, 104, 18, null),
					new ExpectedCellValue(sheetName, 105, 18, null),
					new ExpectedCellValue(sheetName, 106, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 107, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 18, null),
					new ExpectedCellValue(sheetName, 109, 18, null),
					new ExpectedCellValue(sheetName, 110, 18, null),
					new ExpectedCellValue(sheetName, 111, 18, null),
					new ExpectedCellValue(sheetName, 65, 19, "Item"),
					new ExpectedCellValue(sheetName, 66, 19, null),
					new ExpectedCellValue(sheetName, 67, 19, null),
					new ExpectedCellValue(sheetName, 68, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 19, null),
					new ExpectedCellValue(sheetName, 70, 19, null),
					new ExpectedCellValue(sheetName, 71, 19, null),
					new ExpectedCellValue(sheetName, 72, 19, null),
					new ExpectedCellValue(sheetName, 73, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 74, 19, null),
					new ExpectedCellValue(sheetName, 75, 19, null),
					new ExpectedCellValue(sheetName, 76, 19, null),
					new ExpectedCellValue(sheetName, 77, 19, null),
					new ExpectedCellValue(sheetName, 78, 19, null),
					new ExpectedCellValue(sheetName, 79, 19, null),
					new ExpectedCellValue(sheetName, 80, 19, null),
					new ExpectedCellValue(sheetName, 81, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 82, 19, null),
					new ExpectedCellValue(sheetName, 83, 19, null),
					new ExpectedCellValue(sheetName, 84, 19, null),
					new ExpectedCellValue(sheetName, 85, 19, null),
					new ExpectedCellValue(sheetName, 86, 19, "Tent"),
					new ExpectedCellValue(sheetName, 87, 19, null),
					new ExpectedCellValue(sheetName, 88, 19, null),
					new ExpectedCellValue(sheetName, 89, 19, null),
					new ExpectedCellValue(sheetName, 90, 19, null),
					new ExpectedCellValue(sheetName, 91, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 92, 19, null),
					new ExpectedCellValue(sheetName, 93, 19, null),
					new ExpectedCellValue(sheetName, 94, 19, null),
					new ExpectedCellValue(sheetName, 95, 19, null),
					new ExpectedCellValue(sheetName, 96, 19, null),
					new ExpectedCellValue(sheetName, 97, 19, null),
					new ExpectedCellValue(sheetName, 98, 19, null),
					new ExpectedCellValue(sheetName, 99, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 100, 19, null),
					new ExpectedCellValue(sheetName, 101, 19, null),
					new ExpectedCellValue(sheetName, 102, 19, null),
					new ExpectedCellValue(sheetName, 103, 19, null),
					new ExpectedCellValue(sheetName, 104, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 105, 19, null),
					new ExpectedCellValue(sheetName, 106, 19, null),
					new ExpectedCellValue(sheetName, 107, 19, null),
					new ExpectedCellValue(sheetName, 108, 19, null),
					new ExpectedCellValue(sheetName, 109, 19, null),
					new ExpectedCellValue(sheetName, 110, 19, null),
					new ExpectedCellValue(sheetName, 111, 19, null),
					new ExpectedCellValue(sheetName, 65, 20, "Values"),
					new ExpectedCellValue(sheetName, 66, 20, null),
					new ExpectedCellValue(sheetName, 67, 20, null),
					new ExpectedCellValue(sheetName, 68, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 20, null),
					new ExpectedCellValue(sheetName, 71, 20, null),
					new ExpectedCellValue(sheetName, 72, 20, null),
					new ExpectedCellValue(sheetName, 73, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 75, 20, null),
					new ExpectedCellValue(sheetName, 76, 20, null),
					new ExpectedCellValue(sheetName, 77, 20, null),
					new ExpectedCellValue(sheetName, 78, 20, null),
					new ExpectedCellValue(sheetName, 79, 20, null),
					new ExpectedCellValue(sheetName, 80, 20, null),
					new ExpectedCellValue(sheetName, 81, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 20, null),
					new ExpectedCellValue(sheetName, 84, 20, null),
					new ExpectedCellValue(sheetName, 85, 20, null),
					new ExpectedCellValue(sheetName, 86, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 20, null),
					new ExpectedCellValue(sheetName, 89, 20, null),
					new ExpectedCellValue(sheetName, 90, 20, null),
					new ExpectedCellValue(sheetName, 91, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 92, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 93, 20, null),
					new ExpectedCellValue(sheetName, 94, 20, null),
					new ExpectedCellValue(sheetName, 95, 20, null),
					new ExpectedCellValue(sheetName, 96, 20, null),
					new ExpectedCellValue(sheetName, 97, 20, null),
					new ExpectedCellValue(sheetName, 98, 20, null),
					new ExpectedCellValue(sheetName, 99, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 101, 20, null),
					new ExpectedCellValue(sheetName, 102, 20, null),
					new ExpectedCellValue(sheetName, 103, 20, null),
					new ExpectedCellValue(sheetName, 104, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 20, null),
					new ExpectedCellValue(sheetName, 107, 20, null),
					new ExpectedCellValue(sheetName, 108, 20, null),
					new ExpectedCellValue(sheetName, 109, 20, null),
					new ExpectedCellValue(sheetName, 110, 20, null),
					new ExpectedCellValue(sheetName, 111, 20, null),
					new ExpectedCellValue(sheetName, 65, 21, null),
					new ExpectedCellValue(sheetName, 66, 21, null),
					new ExpectedCellValue(sheetName, 67, 21, null),
					new ExpectedCellValue(sheetName, 68, 21, 415.75),
					new ExpectedCellValue(sheetName, 69, 21, 831.5),
					new ExpectedCellValue(sheetName, 70, 21, 415.75),
					new ExpectedCellValue(sheetName, 71, 21, 831.5),
					new ExpectedCellValue(sheetName, 72, 21, null),
					new ExpectedCellValue(sheetName, 73, 21, 24.99),
					new ExpectedCellValue(sheetName, 74, 21, 24.99),
					new ExpectedCellValue(sheetName, 75, 21, 24.99),
					new ExpectedCellValue(sheetName, 76, 21, 24.99),
					new ExpectedCellValue(sheetName, 77, 21, 440.74),
					new ExpectedCellValue(sheetName, 78, 21, 856.49),
					new ExpectedCellValue(sheetName, 79, 21, null),
					new ExpectedCellValue(sheetName, 80, 21, null),
					new ExpectedCellValue(sheetName, 81, 21, 415.75),
					new ExpectedCellValue(sheetName, 82, 21, 831.5),
					new ExpectedCellValue(sheetName, 83, 21, 415.75),
					new ExpectedCellValue(sheetName, 84, 21, 831.5),
					new ExpectedCellValue(sheetName, 85, 21, null),
					new ExpectedCellValue(sheetName, 86, 21, 199d),
					new ExpectedCellValue(sheetName, 87, 21, 1194d),
					new ExpectedCellValue(sheetName, 88, 21, 199d),
					new ExpectedCellValue(sheetName, 89, 21, 1194d),
					new ExpectedCellValue(sheetName, 90, 21, null),
					new ExpectedCellValue(sheetName, 91, 21, 415.75),
					new ExpectedCellValue(sheetName, 92, 21, 831.5),
					new ExpectedCellValue(sheetName, 93, 21, 415.75),
					new ExpectedCellValue(sheetName, 94, 21, 831.5),
					new ExpectedCellValue(sheetName, 95, 21, 1030.5),
					new ExpectedCellValue(sheetName, 96, 21, 2857d),
					new ExpectedCellValue(sheetName, 97, 21, null),
					new ExpectedCellValue(sheetName, 98, 21, null),
					new ExpectedCellValue(sheetName, 99, 21, 415.75),
					new ExpectedCellValue(sheetName, 100, 21, 415.75),
					new ExpectedCellValue(sheetName, 101, 21, 415.75),
					new ExpectedCellValue(sheetName, 102, 21, 415.75),
					new ExpectedCellValue(sheetName, 103, 21, null),
					new ExpectedCellValue(sheetName, 104, 21, 99d),
					new ExpectedCellValue(sheetName, 105, 21, 99d),
					new ExpectedCellValue(sheetName, 106, 21, 99d),
					new ExpectedCellValue(sheetName, 107, 21, 99d),
					new ExpectedCellValue(sheetName, 108, 21, 514.75),
					new ExpectedCellValue(sheetName, 109, 21, 514.75),
					new ExpectedCellValue(sheetName, 110, 21, 1985.99),
					new ExpectedCellValue(sheetName, 111, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndSecondFieldsTabularThirdFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q65:U111"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 65, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 66, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 67, 17, null),
					new ExpectedCellValue(sheetName, 68, 17, null),
					new ExpectedCellValue(sheetName, 69, 17, null),
					new ExpectedCellValue(sheetName, 70, 17, null),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, null),
					new ExpectedCellValue(sheetName, 73, 17, null),
					new ExpectedCellValue(sheetName, 74, 17, null),
					new ExpectedCellValue(sheetName, 75, 17, null),
					new ExpectedCellValue(sheetName, 76, 17, null),
					new ExpectedCellValue(sheetName, 77, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 78, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 79, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 80, 17, null),
					new ExpectedCellValue(sheetName, 81, 17, null),
					new ExpectedCellValue(sheetName, 82, 17, null),
					new ExpectedCellValue(sheetName, 83, 17, null),
					new ExpectedCellValue(sheetName, 84, 17, null),
					new ExpectedCellValue(sheetName, 85, 17, null),
					new ExpectedCellValue(sheetName, 86, 17, null),
					new ExpectedCellValue(sheetName, 87, 17, null),
					new ExpectedCellValue(sheetName, 88, 17, null),
					new ExpectedCellValue(sheetName, 89, 17, null),
					new ExpectedCellValue(sheetName, 90, 17, null),
					new ExpectedCellValue(sheetName, 91, 17, null),
					new ExpectedCellValue(sheetName, 92, 17, null),
					new ExpectedCellValue(sheetName, 93, 17, null),
					new ExpectedCellValue(sheetName, 94, 17, null),
					new ExpectedCellValue(sheetName, 95, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 96, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 97, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 98, 17, null),
					new ExpectedCellValue(sheetName, 99, 17, null),
					new ExpectedCellValue(sheetName, 100, 17, null),
					new ExpectedCellValue(sheetName, 101, 17, null),
					new ExpectedCellValue(sheetName, 102, 17, null),
					new ExpectedCellValue(sheetName, 103, 17, null),
					new ExpectedCellValue(sheetName, 104, 17, null),
					new ExpectedCellValue(sheetName, 105, 17, null),
					new ExpectedCellValue(sheetName, 106, 17, null),
					new ExpectedCellValue(sheetName, 107, 17, null),
					new ExpectedCellValue(sheetName, 108, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 109, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 111, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 65, 18, "Month"),
					new ExpectedCellValue(sheetName, 66, 18, null),
					new ExpectedCellValue(sheetName, 67, 18, "January"),
					new ExpectedCellValue(sheetName, 68, 18, null),
					new ExpectedCellValue(sheetName, 69, 18, null),
					new ExpectedCellValue(sheetName, 70, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 71, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 18, "March"),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, null),
					new ExpectedCellValue(sheetName, 75, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 76, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 18, null),
					new ExpectedCellValue(sheetName, 78, 18, null),
					new ExpectedCellValue(sheetName, 79, 18, null),
					new ExpectedCellValue(sheetName, 80, 18, "January"),
					new ExpectedCellValue(sheetName, 81, 18, null),
					new ExpectedCellValue(sheetName, 82, 18, null),
					new ExpectedCellValue(sheetName, 83, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 84, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 85, 18, "February"),
					new ExpectedCellValue(sheetName, 86, 18, null),
					new ExpectedCellValue(sheetName, 87, 18, null),
					new ExpectedCellValue(sheetName, 88, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 89, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 18, "March"),
					new ExpectedCellValue(sheetName, 91, 18, null),
					new ExpectedCellValue(sheetName, 92, 18, null),
					new ExpectedCellValue(sheetName, 93, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 94, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 95, 18, null),
					new ExpectedCellValue(sheetName, 96, 18, null),
					new ExpectedCellValue(sheetName, 97, 18, null),
					new ExpectedCellValue(sheetName, 98, 18, "January"),
					new ExpectedCellValue(sheetName, 99, 18, null),
					new ExpectedCellValue(sheetName, 100, 18, null),
					new ExpectedCellValue(sheetName, 101, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 102, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 103, 18, "February"),
					new ExpectedCellValue(sheetName, 104, 18, null),
					new ExpectedCellValue(sheetName, 105, 18, null),
					new ExpectedCellValue(sheetName, 106, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 107, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 18, null),
					new ExpectedCellValue(sheetName, 109, 18, null),
					new ExpectedCellValue(sheetName, 110, 18, null),
					new ExpectedCellValue(sheetName, 111, 18, null),
					new ExpectedCellValue(sheetName, 65, 19, "Item"),
					new ExpectedCellValue(sheetName, 66, 19, null),
					new ExpectedCellValue(sheetName, 67, 19, null),
					new ExpectedCellValue(sheetName, 68, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 69, 19, null),
					new ExpectedCellValue(sheetName, 70, 19, null),
					new ExpectedCellValue(sheetName, 71, 19, null),
					new ExpectedCellValue(sheetName, 72, 19, null),
					new ExpectedCellValue(sheetName, 73, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 74, 19, null),
					new ExpectedCellValue(sheetName, 75, 19, null),
					new ExpectedCellValue(sheetName, 76, 19, null),
					new ExpectedCellValue(sheetName, 77, 19, null),
					new ExpectedCellValue(sheetName, 78, 19, null),
					new ExpectedCellValue(sheetName, 79, 19, null),
					new ExpectedCellValue(sheetName, 80, 19, null),
					new ExpectedCellValue(sheetName, 81, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 82, 19, null),
					new ExpectedCellValue(sheetName, 83, 19, null),
					new ExpectedCellValue(sheetName, 84, 19, null),
					new ExpectedCellValue(sheetName, 85, 19, null),
					new ExpectedCellValue(sheetName, 86, 19, "Tent"),
					new ExpectedCellValue(sheetName, 87, 19, null),
					new ExpectedCellValue(sheetName, 88, 19, null),
					new ExpectedCellValue(sheetName, 89, 19, null),
					new ExpectedCellValue(sheetName, 90, 19, null),
					new ExpectedCellValue(sheetName, 91, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 92, 19, null),
					new ExpectedCellValue(sheetName, 93, 19, null),
					new ExpectedCellValue(sheetName, 94, 19, null),
					new ExpectedCellValue(sheetName, 95, 19, null),
					new ExpectedCellValue(sheetName, 96, 19, null),
					new ExpectedCellValue(sheetName, 97, 19, null),
					new ExpectedCellValue(sheetName, 98, 19, null),
					new ExpectedCellValue(sheetName, 99, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 100, 19, null),
					new ExpectedCellValue(sheetName, 101, 19, null),
					new ExpectedCellValue(sheetName, 102, 19, null),
					new ExpectedCellValue(sheetName, 103, 19, null),
					new ExpectedCellValue(sheetName, 104, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 105, 19, null),
					new ExpectedCellValue(sheetName, 106, 19, null),
					new ExpectedCellValue(sheetName, 107, 19, null),
					new ExpectedCellValue(sheetName, 108, 19, null),
					new ExpectedCellValue(sheetName, 109, 19, null),
					new ExpectedCellValue(sheetName, 110, 19, null),
					new ExpectedCellValue(sheetName, 111, 19, null),
					new ExpectedCellValue(sheetName, 65, 20, "Values"),
					new ExpectedCellValue(sheetName, 66, 20, null),
					new ExpectedCellValue(sheetName, 67, 20, null),
					new ExpectedCellValue(sheetName, 68, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 69, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 70, 20, null),
					new ExpectedCellValue(sheetName, 71, 20, null),
					new ExpectedCellValue(sheetName, 72, 20, null),
					new ExpectedCellValue(sheetName, 73, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 75, 20, null),
					new ExpectedCellValue(sheetName, 76, 20, null),
					new ExpectedCellValue(sheetName, 77, 20, null),
					new ExpectedCellValue(sheetName, 78, 20, null),
					new ExpectedCellValue(sheetName, 79, 20, null),
					new ExpectedCellValue(sheetName, 80, 20, null),
					new ExpectedCellValue(sheetName, 81, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 82, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 83, 20, null),
					new ExpectedCellValue(sheetName, 84, 20, null),
					new ExpectedCellValue(sheetName, 85, 20, null),
					new ExpectedCellValue(sheetName, 86, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 87, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 88, 20, null),
					new ExpectedCellValue(sheetName, 89, 20, null),
					new ExpectedCellValue(sheetName, 90, 20, null),
					new ExpectedCellValue(sheetName, 91, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 92, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 93, 20, null),
					new ExpectedCellValue(sheetName, 94, 20, null),
					new ExpectedCellValue(sheetName, 95, 20, null),
					new ExpectedCellValue(sheetName, 96, 20, null),
					new ExpectedCellValue(sheetName, 97, 20, null),
					new ExpectedCellValue(sheetName, 98, 20, null),
					new ExpectedCellValue(sheetName, 99, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 101, 20, null),
					new ExpectedCellValue(sheetName, 102, 20, null),
					new ExpectedCellValue(sheetName, 103, 20, null),
					new ExpectedCellValue(sheetName, 104, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 20, "Sum of Total"),
					new ExpectedCellValue(sheetName, 106, 20, null),
					new ExpectedCellValue(sheetName, 107, 20, null),
					new ExpectedCellValue(sheetName, 108, 20, null),
					new ExpectedCellValue(sheetName, 109, 20, null),
					new ExpectedCellValue(sheetName, 110, 20, null),
					new ExpectedCellValue(sheetName, 111, 20, null),
					new ExpectedCellValue(sheetName, 65, 21, null),
					new ExpectedCellValue(sheetName, 66, 21, null),
					new ExpectedCellValue(sheetName, 67, 21, null),
					new ExpectedCellValue(sheetName, 68, 21, 415.75),
					new ExpectedCellValue(sheetName, 69, 21, 831.5),
					new ExpectedCellValue(sheetName, 70, 21, 415.75),
					new ExpectedCellValue(sheetName, 71, 21, 831.5),
					new ExpectedCellValue(sheetName, 72, 21, null),
					new ExpectedCellValue(sheetName, 73, 21, 24.99),
					new ExpectedCellValue(sheetName, 74, 21, 24.99),
					new ExpectedCellValue(sheetName, 75, 21, 24.99),
					new ExpectedCellValue(sheetName, 76, 21, 24.99),
					new ExpectedCellValue(sheetName, 77, 21, 440.74),
					new ExpectedCellValue(sheetName, 78, 21, 856.49),
					new ExpectedCellValue(sheetName, 79, 21, null),
					new ExpectedCellValue(sheetName, 80, 21, null),
					new ExpectedCellValue(sheetName, 81, 21, 415.75),
					new ExpectedCellValue(sheetName, 82, 21, 831.5),
					new ExpectedCellValue(sheetName, 83, 21, 415.75),
					new ExpectedCellValue(sheetName, 84, 21, 831.5),
					new ExpectedCellValue(sheetName, 85, 21, null),
					new ExpectedCellValue(sheetName, 86, 21, 199d),
					new ExpectedCellValue(sheetName, 87, 21, 1194d),
					new ExpectedCellValue(sheetName, 88, 21, 199d),
					new ExpectedCellValue(sheetName, 89, 21, 1194d),
					new ExpectedCellValue(sheetName, 90, 21, null),
					new ExpectedCellValue(sheetName, 91, 21, 415.75),
					new ExpectedCellValue(sheetName, 92, 21, 831.5),
					new ExpectedCellValue(sheetName, 93, 21, 415.75),
					new ExpectedCellValue(sheetName, 94, 21, 831.5),
					new ExpectedCellValue(sheetName, 95, 21, 1030.5),
					new ExpectedCellValue(sheetName, 96, 21, 2857d),
					new ExpectedCellValue(sheetName, 97, 21, null),
					new ExpectedCellValue(sheetName, 98, 21, null),
					new ExpectedCellValue(sheetName, 99, 21, 415.75),
					new ExpectedCellValue(sheetName, 100, 21, 415.75),
					new ExpectedCellValue(sheetName, 101, 21, 415.75),
					new ExpectedCellValue(sheetName, 102, 21, 415.75),
					new ExpectedCellValue(sheetName, 103, 21, null),
					new ExpectedCellValue(sheetName, 104, 21, 99d),
					new ExpectedCellValue(sheetName, 105, 21, 99d),
					new ExpectedCellValue(sheetName, 106, 21, 99d),
					new ExpectedCellValue(sheetName, 107, 21, 99d),
					new ExpectedCellValue(sheetName, 108, 21, 514.75),
					new ExpectedCellValue(sheetName, 109, 21, 514.75),
					new ExpectedCellValue(sheetName, 110, 21, 1985.99),
					new ExpectedCellValue(sheetName, 111, 21, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndSecondFieldsNonCompactLastFieldThirdFieldDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C116:F146"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 3, null),
					new ExpectedCellValue(sheetName, 119, 3, null),
					new ExpectedCellValue(sheetName, 120, 3, null),
					new ExpectedCellValue(sheetName, 121, 3, null),
					new ExpectedCellValue(sheetName, 122, 3, null),
					new ExpectedCellValue(sheetName, 123, 3, null),
					new ExpectedCellValue(sheetName, 124, 3, null),
					new ExpectedCellValue(sheetName, 125, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 126, 3, null),
					new ExpectedCellValue(sheetName, 127, 3, null),
					new ExpectedCellValue(sheetName, 128, 3, null),
					new ExpectedCellValue(sheetName, 129, 3, null),
					new ExpectedCellValue(sheetName, 130, 3, null),
					new ExpectedCellValue(sheetName, 131, 3, null),
					new ExpectedCellValue(sheetName, 132, 3, null),
					new ExpectedCellValue(sheetName, 133, 3, null),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, null),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 140, 3, null),
					new ExpectedCellValue(sheetName, 141, 3, null),
					new ExpectedCellValue(sheetName, 142, 3, null),
					new ExpectedCellValue(sheetName, 143, 3, null),
					new ExpectedCellValue(sheetName, 144, 3, null),
					new ExpectedCellValue(sheetName, 145, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 146, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 4, "Month"),
					new ExpectedCellValue(sheetName, 117, 4, "January"),
					new ExpectedCellValue(sheetName, 118, 4, null),
					new ExpectedCellValue(sheetName, 119, 4, null),
					new ExpectedCellValue(sheetName, 120, 4, null),
					new ExpectedCellValue(sheetName, 121, 4, "March"),
					new ExpectedCellValue(sheetName, 122, 4, null),
					new ExpectedCellValue(sheetName, 123, 4, null),
					new ExpectedCellValue(sheetName, 124, 4, null),
					new ExpectedCellValue(sheetName, 125, 4, "January"),
					new ExpectedCellValue(sheetName, 126, 4, null),
					new ExpectedCellValue(sheetName, 127, 4, null),
					new ExpectedCellValue(sheetName, 128, 4, null),
					new ExpectedCellValue(sheetName, 129, 4, "February"),
					new ExpectedCellValue(sheetName, 130, 4, null),
					new ExpectedCellValue(sheetName, 131, 4, null),
					new ExpectedCellValue(sheetName, 132, 4, null),
					new ExpectedCellValue(sheetName, 133, 4, "March"),
					new ExpectedCellValue(sheetName, 134, 4, null),
					new ExpectedCellValue(sheetName, 135, 4, null),
					new ExpectedCellValue(sheetName, 136, 4, null),
					new ExpectedCellValue(sheetName, 137, 4, "January"),
					new ExpectedCellValue(sheetName, 138, 4, null),
					new ExpectedCellValue(sheetName, 139, 4, null),
					new ExpectedCellValue(sheetName, 140, 4, null),
					new ExpectedCellValue(sheetName, 141, 4, "February"),
					new ExpectedCellValue(sheetName, 142, 4, null),
					new ExpectedCellValue(sheetName, 143, 4, null),
					new ExpectedCellValue(sheetName, 144, 4, null),
					new ExpectedCellValue(sheetName, 145, 4, null),
					new ExpectedCellValue(sheetName, 146, 4, null),
					new ExpectedCellValue(sheetName, 116, 5, "Values"),
					new ExpectedCellValue(sheetName, 117, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 118, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 119, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 121, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 122, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 123, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 124, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 125, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 126, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 127, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 129, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 5, "Tent"),
					new ExpectedCellValue(sheetName, 131, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 132, 5, "Tent"),
					new ExpectedCellValue(sheetName, 133, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 134, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 135, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 137, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 138, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 139, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 141, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 143, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 144, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 145, 5, null),
					new ExpectedCellValue(sheetName, 146, 5, null),
					new ExpectedCellValue(sheetName, 116, 6, null),
					new ExpectedCellValue(sheetName, 117, 6, null),
					new ExpectedCellValue(sheetName, 118, 6, 415.75),
					new ExpectedCellValue(sheetName, 119, 6, null),
					new ExpectedCellValue(sheetName, 120, 6, 831.5),
					new ExpectedCellValue(sheetName, 121, 6, null),
					new ExpectedCellValue(sheetName, 122, 6, 24.99),
					new ExpectedCellValue(sheetName, 123, 6, null),
					new ExpectedCellValue(sheetName, 124, 6, 24.99),
					new ExpectedCellValue(sheetName, 125, 6, null),
					new ExpectedCellValue(sheetName, 126, 6, 415.75),
					new ExpectedCellValue(sheetName, 127, 6, null),
					new ExpectedCellValue(sheetName, 128, 6, 831.5),
					new ExpectedCellValue(sheetName, 129, 6, null),
					new ExpectedCellValue(sheetName, 130, 6, 199d),
					new ExpectedCellValue(sheetName, 131, 6, null),
					new ExpectedCellValue(sheetName, 132, 6, 1194d),
					new ExpectedCellValue(sheetName, 133, 6, null),
					new ExpectedCellValue(sheetName, 134, 6, 415.75),
					new ExpectedCellValue(sheetName, 135, 6, null),
					new ExpectedCellValue(sheetName, 136, 6, 831.5),
					new ExpectedCellValue(sheetName, 137, 6, null),
					new ExpectedCellValue(sheetName, 138, 6, 415.75),
					new ExpectedCellValue(sheetName, 139, 6, null),
					new ExpectedCellValue(sheetName, 140, 6, 415.75),
					new ExpectedCellValue(sheetName, 141, 6, null),
					new ExpectedCellValue(sheetName, 142, 6, 99d),
					new ExpectedCellValue(sheetName, 143, 6, null),
					new ExpectedCellValue(sheetName, 144, 6, 99d),
					new ExpectedCellValue(sheetName, 145, 6, 1985.99),
					new ExpectedCellValue(sheetName, 146, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndSecondFieldsNonCompactLastFieldThirdFieldDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C116:F166"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 3, null),
					new ExpectedCellValue(sheetName, 119, 3, null),
					new ExpectedCellValue(sheetName, 120, 3, null),
					new ExpectedCellValue(sheetName, 121, 3, null),
					new ExpectedCellValue(sheetName, 122, 3, null),
					new ExpectedCellValue(sheetName, 123, 3, null),
					new ExpectedCellValue(sheetName, 124, 3, null),
					new ExpectedCellValue(sheetName, 125, 3, null),
					new ExpectedCellValue(sheetName, 126, 3, null),
					new ExpectedCellValue(sheetName, 127, 3, null),
					new ExpectedCellValue(sheetName, 128, 3, null),
					new ExpectedCellValue(sheetName, 129, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 3, null),
					new ExpectedCellValue(sheetName, 133, 3, null),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, null),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, null),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 140, 3, null),
					new ExpectedCellValue(sheetName, 141, 3, null),
					new ExpectedCellValue(sheetName, 142, 3, null),
					new ExpectedCellValue(sheetName, 143, 3, null),
					new ExpectedCellValue(sheetName, 144, 3, null),
					new ExpectedCellValue(sheetName, 145, 3, null),
					new ExpectedCellValue(sheetName, 146, 3, null),
					new ExpectedCellValue(sheetName, 147, 3, null),
					new ExpectedCellValue(sheetName, 148, 3, null),
					new ExpectedCellValue(sheetName, 149, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 150, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 152, 3, null),
					new ExpectedCellValue(sheetName, 153, 3, null),
					new ExpectedCellValue(sheetName, 154, 3, null),
					new ExpectedCellValue(sheetName, 155, 3, null),
					new ExpectedCellValue(sheetName, 156, 3, null),
					new ExpectedCellValue(sheetName, 157, 3, null),
					new ExpectedCellValue(sheetName, 158, 3, null),
					new ExpectedCellValue(sheetName, 159, 3, null),
					new ExpectedCellValue(sheetName, 160, 3, null),
					new ExpectedCellValue(sheetName, 161, 3, null),
					new ExpectedCellValue(sheetName, 162, 3, null),
					new ExpectedCellValue(sheetName, 163, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 164, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 165, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 166, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 4, "Month"),
					new ExpectedCellValue(sheetName, 117, 4, "January"),
					new ExpectedCellValue(sheetName, 118, 4, null),
					new ExpectedCellValue(sheetName, 119, 4, null),
					new ExpectedCellValue(sheetName, 120, 4, null),
					new ExpectedCellValue(sheetName, 121, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 122, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 123, 4, "March"),
					new ExpectedCellValue(sheetName, 124, 4, null),
					new ExpectedCellValue(sheetName, 125, 4, null),
					new ExpectedCellValue(sheetName, 126, 4, null),
					new ExpectedCellValue(sheetName, 127, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 128, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 129, 4, null),
					new ExpectedCellValue(sheetName, 130, 4, null),
					new ExpectedCellValue(sheetName, 131, 4, "January"),
					new ExpectedCellValue(sheetName, 132, 4, null),
					new ExpectedCellValue(sheetName, 133, 4, null),
					new ExpectedCellValue(sheetName, 134, 4, null),
					new ExpectedCellValue(sheetName, 135, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 136, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 137, 4, "February"),
					new ExpectedCellValue(sheetName, 138, 4, null),
					new ExpectedCellValue(sheetName, 139, 4, null),
					new ExpectedCellValue(sheetName, 140, 4, null),
					new ExpectedCellValue(sheetName, 141, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 4, "March"),
					new ExpectedCellValue(sheetName, 144, 4, null),
					new ExpectedCellValue(sheetName, 145, 4, null),
					new ExpectedCellValue(sheetName, 146, 4, null),
					new ExpectedCellValue(sheetName, 147, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 148, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 149, 4, null),
					new ExpectedCellValue(sheetName, 150, 4, null),
					new ExpectedCellValue(sheetName, 151, 4, "January"),
					new ExpectedCellValue(sheetName, 152, 4, null),
					new ExpectedCellValue(sheetName, 153, 4, null),
					new ExpectedCellValue(sheetName, 154, 4, null),
					new ExpectedCellValue(sheetName, 155, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 156, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 4, "February"),
					new ExpectedCellValue(sheetName, 158, 4, null),
					new ExpectedCellValue(sheetName, 159, 4, null),
					new ExpectedCellValue(sheetName, 160, 4, null),
					new ExpectedCellValue(sheetName, 161, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 4, null),
					new ExpectedCellValue(sheetName, 164, 4, null),
					new ExpectedCellValue(sheetName, 165, 4, null),
					new ExpectedCellValue(sheetName, 166, 4, null),
					new ExpectedCellValue(sheetName, 116, 5, "Values"),
					new ExpectedCellValue(sheetName, 117, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 118, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 119, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 121, 5, null),
					new ExpectedCellValue(sheetName, 122, 5, null),
					new ExpectedCellValue(sheetName, 123, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 124, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 125, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 5, null),
					new ExpectedCellValue(sheetName, 128, 5, null),
					new ExpectedCellValue(sheetName, 129, 5, null),
					new ExpectedCellValue(sheetName, 130, 5, null),
					new ExpectedCellValue(sheetName, 131, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 132, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 133, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 134, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 135, 5, null),
					new ExpectedCellValue(sheetName, 136, 5, null),
					new ExpectedCellValue(sheetName, 137, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 138, 5, "Tent"),
					new ExpectedCellValue(sheetName, 139, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 5, "Tent"),
					new ExpectedCellValue(sheetName, 141, 5, null),
					new ExpectedCellValue(sheetName, 142, 5, null),
					new ExpectedCellValue(sheetName, 143, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 144, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 145, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 5, null),
					new ExpectedCellValue(sheetName, 148, 5, null),
					new ExpectedCellValue(sheetName, 149, 5, null),
					new ExpectedCellValue(sheetName, 150, 5, null),
					new ExpectedCellValue(sheetName, 151, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 152, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 153, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 154, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 155, 5, null),
					new ExpectedCellValue(sheetName, 156, 5, null),
					new ExpectedCellValue(sheetName, 157, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 159, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 161, 5, null),
					new ExpectedCellValue(sheetName, 162, 5, null),
					new ExpectedCellValue(sheetName, 163, 5, null),
					new ExpectedCellValue(sheetName, 164, 5, null),
					new ExpectedCellValue(sheetName, 165, 5, null),
					new ExpectedCellValue(sheetName, 166, 5, null),
					new ExpectedCellValue(sheetName, 116, 6, null),
					new ExpectedCellValue(sheetName, 117, 6, null),
					new ExpectedCellValue(sheetName, 118, 6, 415.75),
					new ExpectedCellValue(sheetName, 119, 6, null),
					new ExpectedCellValue(sheetName, 120, 6, 831.5),
					new ExpectedCellValue(sheetName, 121, 6, 415.75),
					new ExpectedCellValue(sheetName, 122, 6, 831.5),
					new ExpectedCellValue(sheetName, 123, 6, null),
					new ExpectedCellValue(sheetName, 124, 6, 24.99),
					new ExpectedCellValue(sheetName, 125, 6, null),
					new ExpectedCellValue(sheetName, 126, 6, 24.99),
					new ExpectedCellValue(sheetName, 127, 6, 24.99),
					new ExpectedCellValue(sheetName, 128, 6, 24.99),
					new ExpectedCellValue(sheetName, 129, 6, 440.74),
					new ExpectedCellValue(sheetName, 130, 6, 856.49),
					new ExpectedCellValue(sheetName, 131, 6, null),
					new ExpectedCellValue(sheetName, 132, 6, 415.75),
					new ExpectedCellValue(sheetName, 133, 6, null),
					new ExpectedCellValue(sheetName, 134, 6, 831.5),
					new ExpectedCellValue(sheetName, 135, 6, 415.75),
					new ExpectedCellValue(sheetName, 136, 6, 831.5),
					new ExpectedCellValue(sheetName, 137, 6, null),
					new ExpectedCellValue(sheetName, 138, 6, 199d),
					new ExpectedCellValue(sheetName, 139, 6, null),
					new ExpectedCellValue(sheetName, 140, 6, 1194d),
					new ExpectedCellValue(sheetName, 141, 6, 199d),
					new ExpectedCellValue(sheetName, 142, 6, 1194d),
					new ExpectedCellValue(sheetName, 143, 6, null),
					new ExpectedCellValue(sheetName, 144, 6, 415.75),
					new ExpectedCellValue(sheetName, 145, 6, null),
					new ExpectedCellValue(sheetName, 146, 6, 831.5),
					new ExpectedCellValue(sheetName, 147, 6, 415.75),
					new ExpectedCellValue(sheetName, 148, 6, 831.5),
					new ExpectedCellValue(sheetName, 149, 6, 1030.5),
					new ExpectedCellValue(sheetName, 150, 6, 2857d),
					new ExpectedCellValue(sheetName, 151, 6, null),
					new ExpectedCellValue(sheetName, 152, 6, 415.75),
					new ExpectedCellValue(sheetName, 153, 6, null),
					new ExpectedCellValue(sheetName, 154, 6, 415.75),
					new ExpectedCellValue(sheetName, 155, 6, 415.75),
					new ExpectedCellValue(sheetName, 156, 6, 415.75),
					new ExpectedCellValue(sheetName, 157, 6, null),
					new ExpectedCellValue(sheetName, 158, 6, 99d),
					new ExpectedCellValue(sheetName, 159, 6, null),
					new ExpectedCellValue(sheetName, 160, 6, 99d),
					new ExpectedCellValue(sheetName, 161, 6, 99d),
					new ExpectedCellValue(sheetName, 162, 6, 99d),
					new ExpectedCellValue(sheetName, 163, 6, 514.75),
					new ExpectedCellValue(sheetName, 164, 6, 514.75),
					new ExpectedCellValue(sheetName, 165, 6, 1985.99),
					new ExpectedCellValue(sheetName, 166, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndSecondFieldsNonCompactLastFieldThirdFieldDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable7"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C116:F166"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 3, null),
					new ExpectedCellValue(sheetName, 119, 3, null),
					new ExpectedCellValue(sheetName, 120, 3, null),
					new ExpectedCellValue(sheetName, 121, 3, null),
					new ExpectedCellValue(sheetName, 122, 3, null),
					new ExpectedCellValue(sheetName, 123, 3, null),
					new ExpectedCellValue(sheetName, 124, 3, null),
					new ExpectedCellValue(sheetName, 125, 3, null),
					new ExpectedCellValue(sheetName, 126, 3, null),
					new ExpectedCellValue(sheetName, 127, 3, null),
					new ExpectedCellValue(sheetName, 128, 3, null),
					new ExpectedCellValue(sheetName, 129, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 132, 3, null),
					new ExpectedCellValue(sheetName, 133, 3, null),
					new ExpectedCellValue(sheetName, 134, 3, null),
					new ExpectedCellValue(sheetName, 135, 3, null),
					new ExpectedCellValue(sheetName, 136, 3, null),
					new ExpectedCellValue(sheetName, 137, 3, null),
					new ExpectedCellValue(sheetName, 138, 3, null),
					new ExpectedCellValue(sheetName, 139, 3, null),
					new ExpectedCellValue(sheetName, 140, 3, null),
					new ExpectedCellValue(sheetName, 141, 3, null),
					new ExpectedCellValue(sheetName, 142, 3, null),
					new ExpectedCellValue(sheetName, 143, 3, null),
					new ExpectedCellValue(sheetName, 144, 3, null),
					new ExpectedCellValue(sheetName, 145, 3, null),
					new ExpectedCellValue(sheetName, 146, 3, null),
					new ExpectedCellValue(sheetName, 147, 3, null),
					new ExpectedCellValue(sheetName, 148, 3, null),
					new ExpectedCellValue(sheetName, 149, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 150, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 152, 3, null),
					new ExpectedCellValue(sheetName, 153, 3, null),
					new ExpectedCellValue(sheetName, 154, 3, null),
					new ExpectedCellValue(sheetName, 155, 3, null),
					new ExpectedCellValue(sheetName, 156, 3, null),
					new ExpectedCellValue(sheetName, 157, 3, null),
					new ExpectedCellValue(sheetName, 158, 3, null),
					new ExpectedCellValue(sheetName, 159, 3, null),
					new ExpectedCellValue(sheetName, 160, 3, null),
					new ExpectedCellValue(sheetName, 161, 3, null),
					new ExpectedCellValue(sheetName, 162, 3, null),
					new ExpectedCellValue(sheetName, 163, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 164, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 165, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 166, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 4, "Month"),
					new ExpectedCellValue(sheetName, 117, 4, "January"),
					new ExpectedCellValue(sheetName, 118, 4, null),
					new ExpectedCellValue(sheetName, 119, 4, null),
					new ExpectedCellValue(sheetName, 120, 4, null),
					new ExpectedCellValue(sheetName, 121, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 122, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 123, 4, "March"),
					new ExpectedCellValue(sheetName, 124, 4, null),
					new ExpectedCellValue(sheetName, 125, 4, null),
					new ExpectedCellValue(sheetName, 126, 4, null),
					new ExpectedCellValue(sheetName, 127, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 128, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 129, 4, null),
					new ExpectedCellValue(sheetName, 130, 4, null),
					new ExpectedCellValue(sheetName, 131, 4, "January"),
					new ExpectedCellValue(sheetName, 132, 4, null),
					new ExpectedCellValue(sheetName, 133, 4, null),
					new ExpectedCellValue(sheetName, 134, 4, null),
					new ExpectedCellValue(sheetName, 135, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 136, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 137, 4, "February"),
					new ExpectedCellValue(sheetName, 138, 4, null),
					new ExpectedCellValue(sheetName, 139, 4, null),
					new ExpectedCellValue(sheetName, 140, 4, null),
					new ExpectedCellValue(sheetName, 141, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 143, 4, "March"),
					new ExpectedCellValue(sheetName, 144, 4, null),
					new ExpectedCellValue(sheetName, 145, 4, null),
					new ExpectedCellValue(sheetName, 146, 4, null),
					new ExpectedCellValue(sheetName, 147, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 148, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 149, 4, null),
					new ExpectedCellValue(sheetName, 150, 4, null),
					new ExpectedCellValue(sheetName, 151, 4, "January"),
					new ExpectedCellValue(sheetName, 152, 4, null),
					new ExpectedCellValue(sheetName, 153, 4, null),
					new ExpectedCellValue(sheetName, 154, 4, null),
					new ExpectedCellValue(sheetName, 155, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 156, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 157, 4, "February"),
					new ExpectedCellValue(sheetName, 158, 4, null),
					new ExpectedCellValue(sheetName, 159, 4, null),
					new ExpectedCellValue(sheetName, 160, 4, null),
					new ExpectedCellValue(sheetName, 161, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 4, null),
					new ExpectedCellValue(sheetName, 164, 4, null),
					new ExpectedCellValue(sheetName, 165, 4, null),
					new ExpectedCellValue(sheetName, 166, 4, null),
					new ExpectedCellValue(sheetName, 116, 5, "Values"),
					new ExpectedCellValue(sheetName, 117, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 118, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 119, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 121, 5, null),
					new ExpectedCellValue(sheetName, 122, 5, null),
					new ExpectedCellValue(sheetName, 123, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 124, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 125, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 5, null),
					new ExpectedCellValue(sheetName, 128, 5, null),
					new ExpectedCellValue(sheetName, 129, 5, null),
					new ExpectedCellValue(sheetName, 130, 5, null),
					new ExpectedCellValue(sheetName, 131, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 132, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 133, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 134, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 135, 5, null),
					new ExpectedCellValue(sheetName, 136, 5, null),
					new ExpectedCellValue(sheetName, 137, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 138, 5, "Tent"),
					new ExpectedCellValue(sheetName, 139, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 5, "Tent"),
					new ExpectedCellValue(sheetName, 141, 5, null),
					new ExpectedCellValue(sheetName, 142, 5, null),
					new ExpectedCellValue(sheetName, 143, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 144, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 145, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 5, null),
					new ExpectedCellValue(sheetName, 148, 5, null),
					new ExpectedCellValue(sheetName, 149, 5, null),
					new ExpectedCellValue(sheetName, 150, 5, null),
					new ExpectedCellValue(sheetName, 151, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 152, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 153, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 154, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 155, 5, null),
					new ExpectedCellValue(sheetName, 156, 5, null),
					new ExpectedCellValue(sheetName, 157, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 159, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 161, 5, null),
					new ExpectedCellValue(sheetName, 162, 5, null),
					new ExpectedCellValue(sheetName, 163, 5, null),
					new ExpectedCellValue(sheetName, 164, 5, null),
					new ExpectedCellValue(sheetName, 165, 5, null),
					new ExpectedCellValue(sheetName, 166, 5, null),
					new ExpectedCellValue(sheetName, 116, 6, null),
					new ExpectedCellValue(sheetName, 117, 6, null),
					new ExpectedCellValue(sheetName, 118, 6, 415.75),
					new ExpectedCellValue(sheetName, 119, 6, null),
					new ExpectedCellValue(sheetName, 120, 6, 831.5),
					new ExpectedCellValue(sheetName, 121, 6, 415.75),
					new ExpectedCellValue(sheetName, 122, 6, 831.5),
					new ExpectedCellValue(sheetName, 123, 6, null),
					new ExpectedCellValue(sheetName, 124, 6, 24.99),
					new ExpectedCellValue(sheetName, 125, 6, null),
					new ExpectedCellValue(sheetName, 126, 6, 24.99),
					new ExpectedCellValue(sheetName, 127, 6, 24.99),
					new ExpectedCellValue(sheetName, 128, 6, 24.99),
					new ExpectedCellValue(sheetName, 129, 6, 440.74),
					new ExpectedCellValue(sheetName, 130, 6, 856.49),
					new ExpectedCellValue(sheetName, 131, 6, null),
					new ExpectedCellValue(sheetName, 132, 6, 415.75),
					new ExpectedCellValue(sheetName, 133, 6, null),
					new ExpectedCellValue(sheetName, 134, 6, 831.5),
					new ExpectedCellValue(sheetName, 135, 6, 415.75),
					new ExpectedCellValue(sheetName, 136, 6, 831.5),
					new ExpectedCellValue(sheetName, 137, 6, null),
					new ExpectedCellValue(sheetName, 138, 6, 199d),
					new ExpectedCellValue(sheetName, 139, 6, null),
					new ExpectedCellValue(sheetName, 140, 6, 1194d),
					new ExpectedCellValue(sheetName, 141, 6, 199d),
					new ExpectedCellValue(sheetName, 142, 6, 1194d),
					new ExpectedCellValue(sheetName, 143, 6, null),
					new ExpectedCellValue(sheetName, 144, 6, 415.75),
					new ExpectedCellValue(sheetName, 145, 6, null),
					new ExpectedCellValue(sheetName, 146, 6, 831.5),
					new ExpectedCellValue(sheetName, 147, 6, 415.75),
					new ExpectedCellValue(sheetName, 148, 6, 831.5),
					new ExpectedCellValue(sheetName, 149, 6, 1030.5),
					new ExpectedCellValue(sheetName, 150, 6, 2857d),
					new ExpectedCellValue(sheetName, 151, 6, null),
					new ExpectedCellValue(sheetName, 152, 6, 415.75),
					new ExpectedCellValue(sheetName, 153, 6, null),
					new ExpectedCellValue(sheetName, 154, 6, 415.75),
					new ExpectedCellValue(sheetName, 155, 6, 415.75),
					new ExpectedCellValue(sheetName, 156, 6, 415.75),
					new ExpectedCellValue(sheetName, 157, 6, null),
					new ExpectedCellValue(sheetName, 158, 6, 99d),
					new ExpectedCellValue(sheetName, 159, 6, null),
					new ExpectedCellValue(sheetName, 160, 6, 99d),
					new ExpectedCellValue(sheetName, 161, 6, 99d),
					new ExpectedCellValue(sheetName, 162, 6, 99d),
					new ExpectedCellValue(sheetName, 163, 6, 514.75),
					new ExpectedCellValue(sheetName, 164, 6, 514.75),
					new ExpectedCellValue(sheetName, 165, 6, 1985.99),
					new ExpectedCellValue(sheetName, 166, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndLastFieldsNonCompactSecondFieldThirdFieldDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J116:M153"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 10, null),
					new ExpectedCellValue(sheetName, 119, 10, null),
					new ExpectedCellValue(sheetName, 120, 10, null),
					new ExpectedCellValue(sheetName, 121, 10, null),
					new ExpectedCellValue(sheetName, 122, 10, null),
					new ExpectedCellValue(sheetName, 123, 10, null),
					new ExpectedCellValue(sheetName, 124, 10, null),
					new ExpectedCellValue(sheetName, 125, 10, null),
					new ExpectedCellValue(sheetName, 126, 10, null),
					new ExpectedCellValue(sheetName, 127, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 10, null),
					new ExpectedCellValue(sheetName, 129, 10, null),
					new ExpectedCellValue(sheetName, 130, 10, null),
					new ExpectedCellValue(sheetName, 131, 10, null),
					new ExpectedCellValue(sheetName, 132, 10, null),
					new ExpectedCellValue(sheetName, 133, 10, null),
					new ExpectedCellValue(sheetName, 134, 10, null),
					new ExpectedCellValue(sheetName, 135, 10, null),
					new ExpectedCellValue(sheetName, 136, 10, null),
					new ExpectedCellValue(sheetName, 137, 10, null),
					new ExpectedCellValue(sheetName, 138, 10, null),
					new ExpectedCellValue(sheetName, 139, 10, null),
					new ExpectedCellValue(sheetName, 140, 10, null),
					new ExpectedCellValue(sheetName, 141, 10, null),
					new ExpectedCellValue(sheetName, 142, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 143, 10, null),
					new ExpectedCellValue(sheetName, 144, 10, null),
					new ExpectedCellValue(sheetName, 145, 10, null),
					new ExpectedCellValue(sheetName, 146, 10, null),
					new ExpectedCellValue(sheetName, 147, 10, null),
					new ExpectedCellValue(sheetName, 148, 10, null),
					new ExpectedCellValue(sheetName, 149, 10, null),
					new ExpectedCellValue(sheetName, 150, 10, null),
					new ExpectedCellValue(sheetName, 151, 10, null),
					new ExpectedCellValue(sheetName, 152, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 11, "Month"),
					new ExpectedCellValue(sheetName, 117, 11, "January"),
					new ExpectedCellValue(sheetName, 118, 11, null),
					new ExpectedCellValue(sheetName, 119, 11, null),
					new ExpectedCellValue(sheetName, 120, 11, null),
					new ExpectedCellValue(sheetName, 121, 11, null),
					new ExpectedCellValue(sheetName, 122, 11, "March"),
					new ExpectedCellValue(sheetName, 123, 11, null),
					new ExpectedCellValue(sheetName, 124, 11, null),
					new ExpectedCellValue(sheetName, 125, 11, null),
					new ExpectedCellValue(sheetName, 126, 11, null),
					new ExpectedCellValue(sheetName, 127, 11, "January"),
					new ExpectedCellValue(sheetName, 128, 11, null),
					new ExpectedCellValue(sheetName, 129, 11, null),
					new ExpectedCellValue(sheetName, 130, 11, null),
					new ExpectedCellValue(sheetName, 131, 11, null),
					new ExpectedCellValue(sheetName, 132, 11, "February"),
					new ExpectedCellValue(sheetName, 133, 11, null),
					new ExpectedCellValue(sheetName, 134, 11, null),
					new ExpectedCellValue(sheetName, 135, 11, null),
					new ExpectedCellValue(sheetName, 136, 11, null),
					new ExpectedCellValue(sheetName, 137, 11, "March"),
					new ExpectedCellValue(sheetName, 138, 11, null),
					new ExpectedCellValue(sheetName, 139, 11, null),
					new ExpectedCellValue(sheetName, 140, 11, null),
					new ExpectedCellValue(sheetName, 141, 11, null),
					new ExpectedCellValue(sheetName, 142, 11, "January"),
					new ExpectedCellValue(sheetName, 143, 11, null),
					new ExpectedCellValue(sheetName, 144, 11, null),
					new ExpectedCellValue(sheetName, 145, 11, null),
					new ExpectedCellValue(sheetName, 146, 11, null),
					new ExpectedCellValue(sheetName, 147, 11, "February"),
					new ExpectedCellValue(sheetName, 148, 11, null),
					new ExpectedCellValue(sheetName, 149, 11, null),
					new ExpectedCellValue(sheetName, 150, 11, null),
					new ExpectedCellValue(sheetName, 151, 11, null),
					new ExpectedCellValue(sheetName, 152, 11, null),
					new ExpectedCellValue(sheetName, 153, 11, null),
					new ExpectedCellValue(sheetName, 116, 12, "Values"),
					new ExpectedCellValue(sheetName, 117, 12, null),
					new ExpectedCellValue(sheetName, 118, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 12, null),
					new ExpectedCellValue(sheetName, 123, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 124, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 125, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 12, null),
					new ExpectedCellValue(sheetName, 128, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 129, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 130, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 12, null),
					new ExpectedCellValue(sheetName, 133, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 134, 12, "Tent"),
					new ExpectedCellValue(sheetName, 135, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 12, "Tent"),
					new ExpectedCellValue(sheetName, 137, 12, null),
					new ExpectedCellValue(sheetName, 138, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 140, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 141, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 12, null),
					new ExpectedCellValue(sheetName, 143, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 144, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 145, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 12, null),
					new ExpectedCellValue(sheetName, 148, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 150, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 152, 12, null),
					new ExpectedCellValue(sheetName, 153, 12, null),
					new ExpectedCellValue(sheetName, 116, 13, null),
					new ExpectedCellValue(sheetName, 117, 13, null),
					new ExpectedCellValue(sheetName, 118, 13, null),
					new ExpectedCellValue(sheetName, 119, 13, 415.75),
					new ExpectedCellValue(sheetName, 120, 13, null),
					new ExpectedCellValue(sheetName, 121, 13, 831.5),
					new ExpectedCellValue(sheetName, 122, 13, null),
					new ExpectedCellValue(sheetName, 123, 13, null),
					new ExpectedCellValue(sheetName, 124, 13, 24.99),
					new ExpectedCellValue(sheetName, 125, 13, null),
					new ExpectedCellValue(sheetName, 126, 13, 24.99),
					new ExpectedCellValue(sheetName, 127, 13, null),
					new ExpectedCellValue(sheetName, 128, 13, null),
					new ExpectedCellValue(sheetName, 129, 13, 415.75),
					new ExpectedCellValue(sheetName, 130, 13, null),
					new ExpectedCellValue(sheetName, 131, 13, 831.5),
					new ExpectedCellValue(sheetName, 132, 13, null),
					new ExpectedCellValue(sheetName, 133, 13, null),
					new ExpectedCellValue(sheetName, 134, 13, 199d),
					new ExpectedCellValue(sheetName, 135, 13, null),
					new ExpectedCellValue(sheetName, 136, 13, 1194d),
					new ExpectedCellValue(sheetName, 137, 13, null),
					new ExpectedCellValue(sheetName, 138, 13, null),
					new ExpectedCellValue(sheetName, 139, 13, 415.75),
					new ExpectedCellValue(sheetName, 140, 13, null),
					new ExpectedCellValue(sheetName, 141, 13, 831.5),
					new ExpectedCellValue(sheetName, 142, 13, null),
					new ExpectedCellValue(sheetName, 143, 13, null),
					new ExpectedCellValue(sheetName, 144, 13, 415.75),
					new ExpectedCellValue(sheetName, 145, 13, null),
					new ExpectedCellValue(sheetName, 146, 13, 415.75),
					new ExpectedCellValue(sheetName, 147, 13, null),
					new ExpectedCellValue(sheetName, 148, 13, null),
					new ExpectedCellValue(sheetName, 149, 13, 99d),
					new ExpectedCellValue(sheetName, 150, 13, null),
					new ExpectedCellValue(sheetName, 151, 13, 99d),
					new ExpectedCellValue(sheetName, 152, 13, 1985.99),
					new ExpectedCellValue(sheetName, 153, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndLastFieldsNonCompactSecondFieldThirdFieldDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J116:M173"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 10, null),
					new ExpectedCellValue(sheetName, 119, 10, null),
					new ExpectedCellValue(sheetName, 120, 10, null),
					new ExpectedCellValue(sheetName, 121, 10, null),
					new ExpectedCellValue(sheetName, 122, 10, null),
					new ExpectedCellValue(sheetName, 123, 10, null),
					new ExpectedCellValue(sheetName, 124, 10, null),
					new ExpectedCellValue(sheetName, 125, 10, null),
					new ExpectedCellValue(sheetName, 126, 10, null),
					new ExpectedCellValue(sheetName, 127, 10, null),
					new ExpectedCellValue(sheetName, 128, 10, null),
					new ExpectedCellValue(sheetName, 129, 10, null),
					new ExpectedCellValue(sheetName, 130, 10, null),
					new ExpectedCellValue(sheetName, 131, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 132, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 134, 10, null),
					new ExpectedCellValue(sheetName, 135, 10, null),
					new ExpectedCellValue(sheetName, 136, 10, null),
					new ExpectedCellValue(sheetName, 137, 10, null),
					new ExpectedCellValue(sheetName, 138, 10, null),
					new ExpectedCellValue(sheetName, 139, 10, null),
					new ExpectedCellValue(sheetName, 140, 10, null),
					new ExpectedCellValue(sheetName, 141, 10, null),
					new ExpectedCellValue(sheetName, 142, 10, null),
					new ExpectedCellValue(sheetName, 143, 10, null),
					new ExpectedCellValue(sheetName, 144, 10, null),
					new ExpectedCellValue(sheetName, 145, 10, null),
					new ExpectedCellValue(sheetName, 146, 10, null),
					new ExpectedCellValue(sheetName, 147, 10, null),
					new ExpectedCellValue(sheetName, 148, 10, null),
					new ExpectedCellValue(sheetName, 149, 10, null),
					new ExpectedCellValue(sheetName, 150, 10, null),
					new ExpectedCellValue(sheetName, 151, 10, null),
					new ExpectedCellValue(sheetName, 152, 10, null),
					new ExpectedCellValue(sheetName, 153, 10, null),
					new ExpectedCellValue(sheetName, 154, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 155, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 156, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 157, 10, null),
					new ExpectedCellValue(sheetName, 158, 10, null),
					new ExpectedCellValue(sheetName, 159, 10, null),
					new ExpectedCellValue(sheetName, 160, 10, null),
					new ExpectedCellValue(sheetName, 161, 10, null),
					new ExpectedCellValue(sheetName, 162, 10, null),
					new ExpectedCellValue(sheetName, 163, 10, null),
					new ExpectedCellValue(sheetName, 164, 10, null),
					new ExpectedCellValue(sheetName, 165, 10, null),
					new ExpectedCellValue(sheetName, 166, 10, null),
					new ExpectedCellValue(sheetName, 167, 10, null),
					new ExpectedCellValue(sheetName, 168, 10, null),
					new ExpectedCellValue(sheetName, 169, 10, null),
					new ExpectedCellValue(sheetName, 170, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 171, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 172, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 173, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 11, "Month"),
					new ExpectedCellValue(sheetName, 117, 11, "January"),
					new ExpectedCellValue(sheetName, 118, 11, null),
					new ExpectedCellValue(sheetName, 119, 11, null),
					new ExpectedCellValue(sheetName, 120, 11, null),
					new ExpectedCellValue(sheetName, 121, 11, null),
					new ExpectedCellValue(sheetName, 122, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 123, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 124, 11, "March"),
					new ExpectedCellValue(sheetName, 125, 11, null),
					new ExpectedCellValue(sheetName, 126, 11, null),
					new ExpectedCellValue(sheetName, 127, 11, null),
					new ExpectedCellValue(sheetName, 128, 11, null),
					new ExpectedCellValue(sheetName, 129, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 11, null),
					new ExpectedCellValue(sheetName, 132, 11, null),
					new ExpectedCellValue(sheetName, 133, 11, "January"),
					new ExpectedCellValue(sheetName, 134, 11, null),
					new ExpectedCellValue(sheetName, 135, 11, null),
					new ExpectedCellValue(sheetName, 136, 11, null),
					new ExpectedCellValue(sheetName, 137, 11, null),
					new ExpectedCellValue(sheetName, 138, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 11, "February"),
					new ExpectedCellValue(sheetName, 141, 11, null),
					new ExpectedCellValue(sheetName, 142, 11, null),
					new ExpectedCellValue(sheetName, 143, 11, null),
					new ExpectedCellValue(sheetName, 144, 11, null),
					new ExpectedCellValue(sheetName, 145, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 146, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 147, 11, "March"),
					new ExpectedCellValue(sheetName, 148, 11, null),
					new ExpectedCellValue(sheetName, 149, 11, null),
					new ExpectedCellValue(sheetName, 150, 11, null),
					new ExpectedCellValue(sheetName, 151, 11, null),
					new ExpectedCellValue(sheetName, 152, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 154, 11, null),
					new ExpectedCellValue(sheetName, 155, 11, null),
					new ExpectedCellValue(sheetName, 156, 11, "January"),
					new ExpectedCellValue(sheetName, 157, 11, null),
					new ExpectedCellValue(sheetName, 158, 11, null),
					new ExpectedCellValue(sheetName, 159, 11, null),
					new ExpectedCellValue(sheetName, 160, 11, null),
					new ExpectedCellValue(sheetName, 161, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 11, "February"),
					new ExpectedCellValue(sheetName, 164, 11, null),
					new ExpectedCellValue(sheetName, 165, 11, null),
					new ExpectedCellValue(sheetName, 166, 11, null),
					new ExpectedCellValue(sheetName, 167, 11, null),
					new ExpectedCellValue(sheetName, 168, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 169, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 11, null),
					new ExpectedCellValue(sheetName, 171, 11, null),
					new ExpectedCellValue(sheetName, 172, 11, null),
					new ExpectedCellValue(sheetName, 173, 11, null),
					new ExpectedCellValue(sheetName, 116, 12, "Values"),
					new ExpectedCellValue(sheetName, 117, 12, null),
					new ExpectedCellValue(sheetName, 118, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 12, null),
					new ExpectedCellValue(sheetName, 123, 12, null),
					new ExpectedCellValue(sheetName, 124, 12, null),
					new ExpectedCellValue(sheetName, 125, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 126, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 129, 12, null),
					new ExpectedCellValue(sheetName, 130, 12, null),
					new ExpectedCellValue(sheetName, 131, 12, null),
					new ExpectedCellValue(sheetName, 132, 12, null),
					new ExpectedCellValue(sheetName, 133, 12, null),
					new ExpectedCellValue(sheetName, 134, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 135, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 137, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 138, 12, null),
					new ExpectedCellValue(sheetName, 139, 12, null),
					new ExpectedCellValue(sheetName, 140, 12, null),
					new ExpectedCellValue(sheetName, 141, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 12, "Tent"),
					new ExpectedCellValue(sheetName, 143, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 144, 12, "Tent"),
					new ExpectedCellValue(sheetName, 145, 12, null),
					new ExpectedCellValue(sheetName, 146, 12, null),
					new ExpectedCellValue(sheetName, 147, 12, null),
					new ExpectedCellValue(sheetName, 148, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 150, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 152, 12, null),
					new ExpectedCellValue(sheetName, 153, 12, null),
					new ExpectedCellValue(sheetName, 154, 12, null),
					new ExpectedCellValue(sheetName, 155, 12, null),
					new ExpectedCellValue(sheetName, 156, 12, null),
					new ExpectedCellValue(sheetName, 157, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 161, 12, null),
					new ExpectedCellValue(sheetName, 162, 12, null),
					new ExpectedCellValue(sheetName, 163, 12, null),
					new ExpectedCellValue(sheetName, 164, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 165, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 166, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 168, 12, null),
					new ExpectedCellValue(sheetName, 169, 12, null),
					new ExpectedCellValue(sheetName, 170, 12, null),
					new ExpectedCellValue(sheetName, 171, 12, null),
					new ExpectedCellValue(sheetName, 172, 12, null),
					new ExpectedCellValue(sheetName, 173, 12, null),
					new ExpectedCellValue(sheetName, 116, 13, null),
					new ExpectedCellValue(sheetName, 117, 13, null),
					new ExpectedCellValue(sheetName, 118, 13, null),
					new ExpectedCellValue(sheetName, 119, 13, 415.75),
					new ExpectedCellValue(sheetName, 120, 13, null),
					new ExpectedCellValue(sheetName, 121, 13, 831.5),
					new ExpectedCellValue(sheetName, 122, 13, 415.75),
					new ExpectedCellValue(sheetName, 123, 13, 831.5),
					new ExpectedCellValue(sheetName, 124, 13, null),
					new ExpectedCellValue(sheetName, 125, 13, null),
					new ExpectedCellValue(sheetName, 126, 13, 24.99),
					new ExpectedCellValue(sheetName, 127, 13, null),
					new ExpectedCellValue(sheetName, 128, 13, 24.99),
					new ExpectedCellValue(sheetName, 129, 13, 24.99),
					new ExpectedCellValue(sheetName, 130, 13, 24.99),
					new ExpectedCellValue(sheetName, 131, 13, 440.74),
					new ExpectedCellValue(sheetName, 132, 13, 856.49),
					new ExpectedCellValue(sheetName, 133, 13, null),
					new ExpectedCellValue(sheetName, 134, 13, null),
					new ExpectedCellValue(sheetName, 135, 13, 415.75),
					new ExpectedCellValue(sheetName, 136, 13, null),
					new ExpectedCellValue(sheetName, 137, 13, 831.5),
					new ExpectedCellValue(sheetName, 138, 13, 415.75),
					new ExpectedCellValue(sheetName, 139, 13, 831.5),
					new ExpectedCellValue(sheetName, 140, 13, null),
					new ExpectedCellValue(sheetName, 141, 13, null),
					new ExpectedCellValue(sheetName, 142, 13, 199d),
					new ExpectedCellValue(sheetName, 143, 13, null),
					new ExpectedCellValue(sheetName, 144, 13, 1194d),
					new ExpectedCellValue(sheetName, 145, 13, 199d),
					new ExpectedCellValue(sheetName, 146, 13, 1194d),
					new ExpectedCellValue(sheetName, 147, 13, null),
					new ExpectedCellValue(sheetName, 148, 13, null),
					new ExpectedCellValue(sheetName, 149, 13, 415.75),
					new ExpectedCellValue(sheetName, 150, 13, null),
					new ExpectedCellValue(sheetName, 151, 13, 831.5),
					new ExpectedCellValue(sheetName, 152, 13, 415.75),
					new ExpectedCellValue(sheetName, 153, 13, 831.5),
					new ExpectedCellValue(sheetName, 154, 13, 1030.5),
					new ExpectedCellValue(sheetName, 155, 13, 2857d),
					new ExpectedCellValue(sheetName, 156, 13, null),
					new ExpectedCellValue(sheetName, 157, 13, null),
					new ExpectedCellValue(sheetName, 158, 13, 415.75),
					new ExpectedCellValue(sheetName, 159, 13, null),
					new ExpectedCellValue(sheetName, 160, 13, 415.75),
					new ExpectedCellValue(sheetName, 161, 13, 415.75),
					new ExpectedCellValue(sheetName, 162, 13, 415.75),
					new ExpectedCellValue(sheetName, 163, 13, null),
					new ExpectedCellValue(sheetName, 164, 13, null),
					new ExpectedCellValue(sheetName, 165, 13, 99d),
					new ExpectedCellValue(sheetName, 166, 13, null),
					new ExpectedCellValue(sheetName, 167, 13, 99d),
					new ExpectedCellValue(sheetName, 168, 13, 99d),
					new ExpectedCellValue(sheetName, 169, 13, 99d),
					new ExpectedCellValue(sheetName, 170, 13, 514.75),
					new ExpectedCellValue(sheetName, 171, 13, 514.75),
					new ExpectedCellValue(sheetName, 172, 13, 1985.99),
					new ExpectedCellValue(sheetName, 173, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndLastFieldsNonCompactSecondFieldThirdFieldDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable8"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J116:M173"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 10, null),
					new ExpectedCellValue(sheetName, 119, 10, null),
					new ExpectedCellValue(sheetName, 120, 10, null),
					new ExpectedCellValue(sheetName, 121, 10, null),
					new ExpectedCellValue(sheetName, 122, 10, null),
					new ExpectedCellValue(sheetName, 123, 10, null),
					new ExpectedCellValue(sheetName, 124, 10, null),
					new ExpectedCellValue(sheetName, 125, 10, null),
					new ExpectedCellValue(sheetName, 126, 10, null),
					new ExpectedCellValue(sheetName, 127, 10, null),
					new ExpectedCellValue(sheetName, 128, 10, null),
					new ExpectedCellValue(sheetName, 129, 10, null),
					new ExpectedCellValue(sheetName, 130, 10, null),
					new ExpectedCellValue(sheetName, 131, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 132, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 134, 10, null),
					new ExpectedCellValue(sheetName, 135, 10, null),
					new ExpectedCellValue(sheetName, 136, 10, null),
					new ExpectedCellValue(sheetName, 137, 10, null),
					new ExpectedCellValue(sheetName, 138, 10, null),
					new ExpectedCellValue(sheetName, 139, 10, null),
					new ExpectedCellValue(sheetName, 140, 10, null),
					new ExpectedCellValue(sheetName, 141, 10, null),
					new ExpectedCellValue(sheetName, 142, 10, null),
					new ExpectedCellValue(sheetName, 143, 10, null),
					new ExpectedCellValue(sheetName, 144, 10, null),
					new ExpectedCellValue(sheetName, 145, 10, null),
					new ExpectedCellValue(sheetName, 146, 10, null),
					new ExpectedCellValue(sheetName, 147, 10, null),
					new ExpectedCellValue(sheetName, 148, 10, null),
					new ExpectedCellValue(sheetName, 149, 10, null),
					new ExpectedCellValue(sheetName, 150, 10, null),
					new ExpectedCellValue(sheetName, 151, 10, null),
					new ExpectedCellValue(sheetName, 152, 10, null),
					new ExpectedCellValue(sheetName, 153, 10, null),
					new ExpectedCellValue(sheetName, 154, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 155, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 156, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 157, 10, null),
					new ExpectedCellValue(sheetName, 158, 10, null),
					new ExpectedCellValue(sheetName, 159, 10, null),
					new ExpectedCellValue(sheetName, 160, 10, null),
					new ExpectedCellValue(sheetName, 161, 10, null),
					new ExpectedCellValue(sheetName, 162, 10, null),
					new ExpectedCellValue(sheetName, 163, 10, null),
					new ExpectedCellValue(sheetName, 164, 10, null),
					new ExpectedCellValue(sheetName, 165, 10, null),
					new ExpectedCellValue(sheetName, 166, 10, null),
					new ExpectedCellValue(sheetName, 167, 10, null),
					new ExpectedCellValue(sheetName, 168, 10, null),
					new ExpectedCellValue(sheetName, 169, 10, null),
					new ExpectedCellValue(sheetName, 170, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 171, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 172, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 173, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 11, "Month"),
					new ExpectedCellValue(sheetName, 117, 11, "January"),
					new ExpectedCellValue(sheetName, 118, 11, null),
					new ExpectedCellValue(sheetName, 119, 11, null),
					new ExpectedCellValue(sheetName, 120, 11, null),
					new ExpectedCellValue(sheetName, 121, 11, null),
					new ExpectedCellValue(sheetName, 122, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 123, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 124, 11, "March"),
					new ExpectedCellValue(sheetName, 125, 11, null),
					new ExpectedCellValue(sheetName, 126, 11, null),
					new ExpectedCellValue(sheetName, 127, 11, null),
					new ExpectedCellValue(sheetName, 128, 11, null),
					new ExpectedCellValue(sheetName, 129, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 11, null),
					new ExpectedCellValue(sheetName, 132, 11, null),
					new ExpectedCellValue(sheetName, 133, 11, "January"),
					new ExpectedCellValue(sheetName, 134, 11, null),
					new ExpectedCellValue(sheetName, 135, 11, null),
					new ExpectedCellValue(sheetName, 136, 11, null),
					new ExpectedCellValue(sheetName, 137, 11, null),
					new ExpectedCellValue(sheetName, 138, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 11, "February"),
					new ExpectedCellValue(sheetName, 141, 11, null),
					new ExpectedCellValue(sheetName, 142, 11, null),
					new ExpectedCellValue(sheetName, 143, 11, null),
					new ExpectedCellValue(sheetName, 144, 11, null),
					new ExpectedCellValue(sheetName, 145, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 146, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 147, 11, "March"),
					new ExpectedCellValue(sheetName, 148, 11, null),
					new ExpectedCellValue(sheetName, 149, 11, null),
					new ExpectedCellValue(sheetName, 150, 11, null),
					new ExpectedCellValue(sheetName, 151, 11, null),
					new ExpectedCellValue(sheetName, 152, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 154, 11, null),
					new ExpectedCellValue(sheetName, 155, 11, null),
					new ExpectedCellValue(sheetName, 156, 11, "January"),
					new ExpectedCellValue(sheetName, 157, 11, null),
					new ExpectedCellValue(sheetName, 158, 11, null),
					new ExpectedCellValue(sheetName, 159, 11, null),
					new ExpectedCellValue(sheetName, 160, 11, null),
					new ExpectedCellValue(sheetName, 161, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 11, "February"),
					new ExpectedCellValue(sheetName, 164, 11, null),
					new ExpectedCellValue(sheetName, 165, 11, null),
					new ExpectedCellValue(sheetName, 166, 11, null),
					new ExpectedCellValue(sheetName, 167, 11, null),
					new ExpectedCellValue(sheetName, 168, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 169, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 11, null),
					new ExpectedCellValue(sheetName, 171, 11, null),
					new ExpectedCellValue(sheetName, 172, 11, null),
					new ExpectedCellValue(sheetName, 173, 11, null),
					new ExpectedCellValue(sheetName, 116, 12, "Values"),
					new ExpectedCellValue(sheetName, 117, 12, null),
					new ExpectedCellValue(sheetName, 118, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 12, null),
					new ExpectedCellValue(sheetName, 123, 12, null),
					new ExpectedCellValue(sheetName, 124, 12, null),
					new ExpectedCellValue(sheetName, 125, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 126, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 129, 12, null),
					new ExpectedCellValue(sheetName, 130, 12, null),
					new ExpectedCellValue(sheetName, 131, 12, null),
					new ExpectedCellValue(sheetName, 132, 12, null),
					new ExpectedCellValue(sheetName, 133, 12, null),
					new ExpectedCellValue(sheetName, 134, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 135, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 137, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 138, 12, null),
					new ExpectedCellValue(sheetName, 139, 12, null),
					new ExpectedCellValue(sheetName, 140, 12, null),
					new ExpectedCellValue(sheetName, 141, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 12, "Tent"),
					new ExpectedCellValue(sheetName, 143, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 144, 12, "Tent"),
					new ExpectedCellValue(sheetName, 145, 12, null),
					new ExpectedCellValue(sheetName, 146, 12, null),
					new ExpectedCellValue(sheetName, 147, 12, null),
					new ExpectedCellValue(sheetName, 148, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 150, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 152, 12, null),
					new ExpectedCellValue(sheetName, 153, 12, null),
					new ExpectedCellValue(sheetName, 154, 12, null),
					new ExpectedCellValue(sheetName, 155, 12, null),
					new ExpectedCellValue(sheetName, 156, 12, null),
					new ExpectedCellValue(sheetName, 157, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 161, 12, null),
					new ExpectedCellValue(sheetName, 162, 12, null),
					new ExpectedCellValue(sheetName, 163, 12, null),
					new ExpectedCellValue(sheetName, 164, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 165, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 166, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 168, 12, null),
					new ExpectedCellValue(sheetName, 169, 12, null),
					new ExpectedCellValue(sheetName, 170, 12, null),
					new ExpectedCellValue(sheetName, 171, 12, null),
					new ExpectedCellValue(sheetName, 172, 12, null),
					new ExpectedCellValue(sheetName, 173, 12, null),
					new ExpectedCellValue(sheetName, 116, 13, null),
					new ExpectedCellValue(sheetName, 117, 13, null),
					new ExpectedCellValue(sheetName, 118, 13, null),
					new ExpectedCellValue(sheetName, 119, 13, 415.75),
					new ExpectedCellValue(sheetName, 120, 13, null),
					new ExpectedCellValue(sheetName, 121, 13, 831.5),
					new ExpectedCellValue(sheetName, 122, 13, 415.75),
					new ExpectedCellValue(sheetName, 123, 13, 831.5),
					new ExpectedCellValue(sheetName, 124, 13, null),
					new ExpectedCellValue(sheetName, 125, 13, null),
					new ExpectedCellValue(sheetName, 126, 13, 24.99),
					new ExpectedCellValue(sheetName, 127, 13, null),
					new ExpectedCellValue(sheetName, 128, 13, 24.99),
					new ExpectedCellValue(sheetName, 129, 13, 24.99),
					new ExpectedCellValue(sheetName, 130, 13, 24.99),
					new ExpectedCellValue(sheetName, 131, 13, 440.74),
					new ExpectedCellValue(sheetName, 132, 13, 856.49),
					new ExpectedCellValue(sheetName, 133, 13, null),
					new ExpectedCellValue(sheetName, 134, 13, null),
					new ExpectedCellValue(sheetName, 135, 13, 415.75),
					new ExpectedCellValue(sheetName, 136, 13, null),
					new ExpectedCellValue(sheetName, 137, 13, 831.5),
					new ExpectedCellValue(sheetName, 138, 13, 415.75),
					new ExpectedCellValue(sheetName, 139, 13, 831.5),
					new ExpectedCellValue(sheetName, 140, 13, null),
					new ExpectedCellValue(sheetName, 141, 13, null),
					new ExpectedCellValue(sheetName, 142, 13, 199d),
					new ExpectedCellValue(sheetName, 143, 13, null),
					new ExpectedCellValue(sheetName, 144, 13, 1194d),
					new ExpectedCellValue(sheetName, 145, 13, 199d),
					new ExpectedCellValue(sheetName, 146, 13, 1194d),
					new ExpectedCellValue(sheetName, 147, 13, null),
					new ExpectedCellValue(sheetName, 148, 13, null),
					new ExpectedCellValue(sheetName, 149, 13, 415.75),
					new ExpectedCellValue(sheetName, 150, 13, null),
					new ExpectedCellValue(sheetName, 151, 13, 831.5),
					new ExpectedCellValue(sheetName, 152, 13, 415.75),
					new ExpectedCellValue(sheetName, 153, 13, 831.5),
					new ExpectedCellValue(sheetName, 154, 13, 1030.5),
					new ExpectedCellValue(sheetName, 155, 13, 2857d),
					new ExpectedCellValue(sheetName, 156, 13, null),
					new ExpectedCellValue(sheetName, 157, 13, null),
					new ExpectedCellValue(sheetName, 158, 13, 415.75),
					new ExpectedCellValue(sheetName, 159, 13, null),
					new ExpectedCellValue(sheetName, 160, 13, 415.75),
					new ExpectedCellValue(sheetName, 161, 13, 415.75),
					new ExpectedCellValue(sheetName, 162, 13, 415.75),
					new ExpectedCellValue(sheetName, 163, 13, null),
					new ExpectedCellValue(sheetName, 164, 13, null),
					new ExpectedCellValue(sheetName, 165, 13, 99d),
					new ExpectedCellValue(sheetName, 166, 13, null),
					new ExpectedCellValue(sheetName, 167, 13, 99d),
					new ExpectedCellValue(sheetName, 168, 13, 99d),
					new ExpectedCellValue(sheetName, 169, 13, 99d),
					new ExpectedCellValue(sheetName, 170, 13, 514.75),
					new ExpectedCellValue(sheetName, 171, 13, 514.75),
					new ExpectedCellValue(sheetName, 172, 13, 1985.99),
					new ExpectedCellValue(sheetName, 173, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondAndLastFieldsThirdFieldDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q116:T153"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 17, null),
					new ExpectedCellValue(sheetName, 119, 17, null),
					new ExpectedCellValue(sheetName, 120, 17, null),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, null),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, null),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, null),
					new ExpectedCellValue(sheetName, 127, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, null),
					new ExpectedCellValue(sheetName, 131, 17, null),
					new ExpectedCellValue(sheetName, 132, 17, null),
					new ExpectedCellValue(sheetName, 133, 17, null),
					new ExpectedCellValue(sheetName, 134, 17, null),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, null),
					new ExpectedCellValue(sheetName, 137, 17, null),
					new ExpectedCellValue(sheetName, 138, 17, null),
					new ExpectedCellValue(sheetName, 139, 17, null),
					new ExpectedCellValue(sheetName, 140, 17, null),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, null),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, null),
					new ExpectedCellValue(sheetName, 147, 17, null),
					new ExpectedCellValue(sheetName, 148, 17, null),
					new ExpectedCellValue(sheetName, 149, 17, null),
					new ExpectedCellValue(sheetName, 150, 17, null),
					new ExpectedCellValue(sheetName, 151, 17, null),
					new ExpectedCellValue(sheetName, 152, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 18, "Month"),
					new ExpectedCellValue(sheetName, 117, 18, "January"),
					new ExpectedCellValue(sheetName, 118, 18, null),
					new ExpectedCellValue(sheetName, 119, 18, null),
					new ExpectedCellValue(sheetName, 120, 18, null),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "March"),
					new ExpectedCellValue(sheetName, 123, 18, null),
					new ExpectedCellValue(sheetName, 124, 18, null),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, null),
					new ExpectedCellValue(sheetName, 127, 18, "January"),
					new ExpectedCellValue(sheetName, 128, 18, null),
					new ExpectedCellValue(sheetName, 129, 18, null),
					new ExpectedCellValue(sheetName, 130, 18, null),
					new ExpectedCellValue(sheetName, 131, 18, null),
					new ExpectedCellValue(sheetName, 132, 18, "February"),
					new ExpectedCellValue(sheetName, 133, 18, null),
					new ExpectedCellValue(sheetName, 134, 18, null),
					new ExpectedCellValue(sheetName, 135, 18, null),
					new ExpectedCellValue(sheetName, 136, 18, null),
					new ExpectedCellValue(sheetName, 137, 18, "March"),
					new ExpectedCellValue(sheetName, 138, 18, null),
					new ExpectedCellValue(sheetName, 139, 18, null),
					new ExpectedCellValue(sheetName, 140, 18, null),
					new ExpectedCellValue(sheetName, 141, 18, null),
					new ExpectedCellValue(sheetName, 142, 18, "January"),
					new ExpectedCellValue(sheetName, 143, 18, null),
					new ExpectedCellValue(sheetName, 144, 18, null),
					new ExpectedCellValue(sheetName, 145, 18, null),
					new ExpectedCellValue(sheetName, 146, 18, null),
					new ExpectedCellValue(sheetName, 147, 18, "February"),
					new ExpectedCellValue(sheetName, 148, 18, null),
					new ExpectedCellValue(sheetName, 149, 18, null),
					new ExpectedCellValue(sheetName, 150, 18, null),
					new ExpectedCellValue(sheetName, 151, 18, null),
					new ExpectedCellValue(sheetName, 152, 18, null),
					new ExpectedCellValue(sheetName, 153, 18, null),
					new ExpectedCellValue(sheetName, 116, 19, "Values"),
					new ExpectedCellValue(sheetName, 117, 19, null),
					new ExpectedCellValue(sheetName, 118, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 19, null),
					new ExpectedCellValue(sheetName, 123, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 124, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 125, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 126, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 19, null),
					new ExpectedCellValue(sheetName, 128, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 129, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 130, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 132, 19, null),
					new ExpectedCellValue(sheetName, 133, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 134, 19, "Tent"),
					new ExpectedCellValue(sheetName, 135, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 136, 19, "Tent"),
					new ExpectedCellValue(sheetName, 137, 19, null),
					new ExpectedCellValue(sheetName, 138, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 140, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 141, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 142, 19, null),
					new ExpectedCellValue(sheetName, 143, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 144, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 145, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 146, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 147, 19, null),
					new ExpectedCellValue(sheetName, 148, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 150, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 152, 19, null),
					new ExpectedCellValue(sheetName, 153, 19, null),
					new ExpectedCellValue(sheetName, 116, 20, null),
					new ExpectedCellValue(sheetName, 117, 20, null),
					new ExpectedCellValue(sheetName, 118, 20, null),
					new ExpectedCellValue(sheetName, 119, 20, 415.75),
					new ExpectedCellValue(sheetName, 120, 20, null),
					new ExpectedCellValue(sheetName, 121, 20, 831.5),
					new ExpectedCellValue(sheetName, 122, 20, null),
					new ExpectedCellValue(sheetName, 123, 20, null),
					new ExpectedCellValue(sheetName, 124, 20, 24.99),
					new ExpectedCellValue(sheetName, 125, 20, null),
					new ExpectedCellValue(sheetName, 126, 20, 24.99),
					new ExpectedCellValue(sheetName, 127, 20, null),
					new ExpectedCellValue(sheetName, 128, 20, null),
					new ExpectedCellValue(sheetName, 129, 20, 415.75),
					new ExpectedCellValue(sheetName, 130, 20, null),
					new ExpectedCellValue(sheetName, 131, 20, 831.5),
					new ExpectedCellValue(sheetName, 132, 20, null),
					new ExpectedCellValue(sheetName, 133, 20, null),
					new ExpectedCellValue(sheetName, 134, 20, 199d),
					new ExpectedCellValue(sheetName, 135, 20, null),
					new ExpectedCellValue(sheetName, 136, 20, 1194d),
					new ExpectedCellValue(sheetName, 137, 20, null),
					new ExpectedCellValue(sheetName, 138, 20, null),
					new ExpectedCellValue(sheetName, 139, 20, 415.75),
					new ExpectedCellValue(sheetName, 140, 20, null),
					new ExpectedCellValue(sheetName, 141, 20, 831.5),
					new ExpectedCellValue(sheetName, 142, 20, null),
					new ExpectedCellValue(sheetName, 143, 20, null),
					new ExpectedCellValue(sheetName, 144, 20, 415.75),
					new ExpectedCellValue(sheetName, 145, 20, null),
					new ExpectedCellValue(sheetName, 146, 20, 415.75),
					new ExpectedCellValue(sheetName, 147, 20, null),
					new ExpectedCellValue(sheetName, 148, 20, null),
					new ExpectedCellValue(sheetName, 149, 20, 99d),
					new ExpectedCellValue(sheetName, 150, 20, null),
					new ExpectedCellValue(sheetName, 151, 20, 99d),
					new ExpectedCellValue(sheetName, 152, 20, 1985.99),
					new ExpectedCellValue(sheetName, 153, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondAndLastFieldsThirdFieldDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q116:T173"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 17, null),
					new ExpectedCellValue(sheetName, 119, 17, null),
					new ExpectedCellValue(sheetName, 120, 17, null),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, null),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, null),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, null),
					new ExpectedCellValue(sheetName, 127, 17, null),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, null),
					new ExpectedCellValue(sheetName, 131, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 132, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 134, 17, null),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, null),
					new ExpectedCellValue(sheetName, 137, 17, null),
					new ExpectedCellValue(sheetName, 138, 17, null),
					new ExpectedCellValue(sheetName, 139, 17, null),
					new ExpectedCellValue(sheetName, 140, 17, null),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, null),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, null),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, null),
					new ExpectedCellValue(sheetName, 147, 17, null),
					new ExpectedCellValue(sheetName, 148, 17, null),
					new ExpectedCellValue(sheetName, 149, 17, null),
					new ExpectedCellValue(sheetName, 150, 17, null),
					new ExpectedCellValue(sheetName, 151, 17, null),
					new ExpectedCellValue(sheetName, 152, 17, null),
					new ExpectedCellValue(sheetName, 153, 17, null),
					new ExpectedCellValue(sheetName, 154, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 155, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 156, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 157, 17, null),
					new ExpectedCellValue(sheetName, 158, 17, null),
					new ExpectedCellValue(sheetName, 159, 17, null),
					new ExpectedCellValue(sheetName, 160, 17, null),
					new ExpectedCellValue(sheetName, 161, 17, null),
					new ExpectedCellValue(sheetName, 162, 17, null),
					new ExpectedCellValue(sheetName, 163, 17, null),
					new ExpectedCellValue(sheetName, 164, 17, null),
					new ExpectedCellValue(sheetName, 165, 17, null),
					new ExpectedCellValue(sheetName, 166, 17, null),
					new ExpectedCellValue(sheetName, 167, 17, null),
					new ExpectedCellValue(sheetName, 168, 17, null),
					new ExpectedCellValue(sheetName, 169, 17, null),
					new ExpectedCellValue(sheetName, 170, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 171, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 172, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 173, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 18, "Month"),
					new ExpectedCellValue(sheetName, 117, 18, "January"),
					new ExpectedCellValue(sheetName, 118, 18, null),
					new ExpectedCellValue(sheetName, 119, 18, null),
					new ExpectedCellValue(sheetName, 120, 18, null),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 123, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 124, 18, "March"),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, null),
					new ExpectedCellValue(sheetName, 127, 18, null),
					new ExpectedCellValue(sheetName, 128, 18, null),
					new ExpectedCellValue(sheetName, 129, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 18, null),
					new ExpectedCellValue(sheetName, 132, 18, null),
					new ExpectedCellValue(sheetName, 133, 18, "January"),
					new ExpectedCellValue(sheetName, 134, 18, null),
					new ExpectedCellValue(sheetName, 135, 18, null),
					new ExpectedCellValue(sheetName, 136, 18, null),
					new ExpectedCellValue(sheetName, 137, 18, null),
					new ExpectedCellValue(sheetName, 138, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 18, "February"),
					new ExpectedCellValue(sheetName, 141, 18, null),
					new ExpectedCellValue(sheetName, 142, 18, null),
					new ExpectedCellValue(sheetName, 143, 18, null),
					new ExpectedCellValue(sheetName, 144, 18, null),
					new ExpectedCellValue(sheetName, 145, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 146, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 147, 18, "March"),
					new ExpectedCellValue(sheetName, 148, 18, null),
					new ExpectedCellValue(sheetName, 149, 18, null),
					new ExpectedCellValue(sheetName, 150, 18, null),
					new ExpectedCellValue(sheetName, 151, 18, null),
					new ExpectedCellValue(sheetName, 152, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 154, 18, null),
					new ExpectedCellValue(sheetName, 155, 18, null),
					new ExpectedCellValue(sheetName, 156, 18, "January"),
					new ExpectedCellValue(sheetName, 157, 18, null),
					new ExpectedCellValue(sheetName, 158, 18, null),
					new ExpectedCellValue(sheetName, 159, 18, null),
					new ExpectedCellValue(sheetName, 160, 18, null),
					new ExpectedCellValue(sheetName, 161, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 18, "February"),
					new ExpectedCellValue(sheetName, 164, 18, null),
					new ExpectedCellValue(sheetName, 165, 18, null),
					new ExpectedCellValue(sheetName, 166, 18, null),
					new ExpectedCellValue(sheetName, 167, 18, null),
					new ExpectedCellValue(sheetName, 168, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 169, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 18, null),
					new ExpectedCellValue(sheetName, 171, 18, null),
					new ExpectedCellValue(sheetName, 172, 18, null),
					new ExpectedCellValue(sheetName, 173, 18, null),
					new ExpectedCellValue(sheetName, 116, 19, "Values"),
					new ExpectedCellValue(sheetName, 117, 19, null),
					new ExpectedCellValue(sheetName, 118, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 19, null),
					new ExpectedCellValue(sheetName, 123, 19, null),
					new ExpectedCellValue(sheetName, 124, 19, null),
					new ExpectedCellValue(sheetName, 125, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 126, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 129, 19, null),
					new ExpectedCellValue(sheetName, 130, 19, null),
					new ExpectedCellValue(sheetName, 131, 19, null),
					new ExpectedCellValue(sheetName, 132, 19, null),
					new ExpectedCellValue(sheetName, 133, 19, null),
					new ExpectedCellValue(sheetName, 134, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 135, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 137, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 138, 19, null),
					new ExpectedCellValue(sheetName, 139, 19, null),
					new ExpectedCellValue(sheetName, 140, 19, null),
					new ExpectedCellValue(sheetName, 141, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 19, "Tent"),
					new ExpectedCellValue(sheetName, 143, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 144, 19, "Tent"),
					new ExpectedCellValue(sheetName, 145, 19, null),
					new ExpectedCellValue(sheetName, 146, 19, null),
					new ExpectedCellValue(sheetName, 147, 19, null),
					new ExpectedCellValue(sheetName, 148, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 150, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 152, 19, null),
					new ExpectedCellValue(sheetName, 153, 19, null),
					new ExpectedCellValue(sheetName, 154, 19, null),
					new ExpectedCellValue(sheetName, 155, 19, null),
					new ExpectedCellValue(sheetName, 156, 19, null),
					new ExpectedCellValue(sheetName, 157, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 161, 19, null),
					new ExpectedCellValue(sheetName, 162, 19, null),
					new ExpectedCellValue(sheetName, 163, 19, null),
					new ExpectedCellValue(sheetName, 164, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 165, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 166, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 168, 19, null),
					new ExpectedCellValue(sheetName, 169, 19, null),
					new ExpectedCellValue(sheetName, 170, 19, null),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, null),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 116, 20, null),
					new ExpectedCellValue(sheetName, 117, 20, null),
					new ExpectedCellValue(sheetName, 118, 20, null),
					new ExpectedCellValue(sheetName, 119, 20, 415.75),
					new ExpectedCellValue(sheetName, 120, 20, null),
					new ExpectedCellValue(sheetName, 121, 20, 831.5),
					new ExpectedCellValue(sheetName, 122, 20, 415.75),
					new ExpectedCellValue(sheetName, 123, 20, 831.5),
					new ExpectedCellValue(sheetName, 124, 20, null),
					new ExpectedCellValue(sheetName, 125, 20, null),
					new ExpectedCellValue(sheetName, 126, 20, 24.99),
					new ExpectedCellValue(sheetName, 127, 20, null),
					new ExpectedCellValue(sheetName, 128, 20, 24.99),
					new ExpectedCellValue(sheetName, 129, 20, 24.99),
					new ExpectedCellValue(sheetName, 130, 20, 24.99),
					new ExpectedCellValue(sheetName, 131, 20, 440.74),
					new ExpectedCellValue(sheetName, 132, 20, 856.49),
					new ExpectedCellValue(sheetName, 133, 20, null),
					new ExpectedCellValue(sheetName, 134, 20, null),
					new ExpectedCellValue(sheetName, 135, 20, 415.75),
					new ExpectedCellValue(sheetName, 136, 20, null),
					new ExpectedCellValue(sheetName, 137, 20, 831.5),
					new ExpectedCellValue(sheetName, 138, 20, 415.75),
					new ExpectedCellValue(sheetName, 139, 20, 831.5),
					new ExpectedCellValue(sheetName, 140, 20, null),
					new ExpectedCellValue(sheetName, 141, 20, null),
					new ExpectedCellValue(sheetName, 142, 20, 199d),
					new ExpectedCellValue(sheetName, 143, 20, null),
					new ExpectedCellValue(sheetName, 144, 20, 1194d),
					new ExpectedCellValue(sheetName, 145, 20, 199d),
					new ExpectedCellValue(sheetName, 146, 20, 1194d),
					new ExpectedCellValue(sheetName, 147, 20, null),
					new ExpectedCellValue(sheetName, 148, 20, null),
					new ExpectedCellValue(sheetName, 149, 20, 415.75),
					new ExpectedCellValue(sheetName, 150, 20, null),
					new ExpectedCellValue(sheetName, 151, 20, 831.5),
					new ExpectedCellValue(sheetName, 152, 20, 415.75),
					new ExpectedCellValue(sheetName, 153, 20, 831.5),
					new ExpectedCellValue(sheetName, 154, 20, 1030.5),
					new ExpectedCellValue(sheetName, 155, 20, 2857d),
					new ExpectedCellValue(sheetName, 156, 20, null),
					new ExpectedCellValue(sheetName, 157, 20, null),
					new ExpectedCellValue(sheetName, 158, 20, 415.75),
					new ExpectedCellValue(sheetName, 159, 20, null),
					new ExpectedCellValue(sheetName, 160, 20, 415.75),
					new ExpectedCellValue(sheetName, 161, 20, 415.75),
					new ExpectedCellValue(sheetName, 162, 20, 415.75),
					new ExpectedCellValue(sheetName, 163, 20, null),
					new ExpectedCellValue(sheetName, 164, 20, null),
					new ExpectedCellValue(sheetName, 165, 20, 99d),
					new ExpectedCellValue(sheetName, 166, 20, null),
					new ExpectedCellValue(sheetName, 167, 20, 99d),
					new ExpectedCellValue(sheetName, 168, 20, 99d),
					new ExpectedCellValue(sheetName, 169, 20, 99d),
					new ExpectedCellValue(sheetName, 170, 20, 514.75),
					new ExpectedCellValue(sheetName, 171, 20, 514.75),
					new ExpectedCellValue(sheetName, 172, 20, 1985.99),
					new ExpectedCellValue(sheetName, 173, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactSecondAndLastFieldsThirdFieldDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable9"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q116:T173"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 116, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 117, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 118, 17, null),
					new ExpectedCellValue(sheetName, 119, 17, null),
					new ExpectedCellValue(sheetName, 120, 17, null),
					new ExpectedCellValue(sheetName, 121, 17, null),
					new ExpectedCellValue(sheetName, 122, 17, null),
					new ExpectedCellValue(sheetName, 123, 17, null),
					new ExpectedCellValue(sheetName, 124, 17, null),
					new ExpectedCellValue(sheetName, 125, 17, null),
					new ExpectedCellValue(sheetName, 126, 17, null),
					new ExpectedCellValue(sheetName, 127, 17, null),
					new ExpectedCellValue(sheetName, 128, 17, null),
					new ExpectedCellValue(sheetName, 129, 17, null),
					new ExpectedCellValue(sheetName, 130, 17, null),
					new ExpectedCellValue(sheetName, 131, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 132, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 133, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 134, 17, null),
					new ExpectedCellValue(sheetName, 135, 17, null),
					new ExpectedCellValue(sheetName, 136, 17, null),
					new ExpectedCellValue(sheetName, 137, 17, null),
					new ExpectedCellValue(sheetName, 138, 17, null),
					new ExpectedCellValue(sheetName, 139, 17, null),
					new ExpectedCellValue(sheetName, 140, 17, null),
					new ExpectedCellValue(sheetName, 141, 17, null),
					new ExpectedCellValue(sheetName, 142, 17, null),
					new ExpectedCellValue(sheetName, 143, 17, null),
					new ExpectedCellValue(sheetName, 144, 17, null),
					new ExpectedCellValue(sheetName, 145, 17, null),
					new ExpectedCellValue(sheetName, 146, 17, null),
					new ExpectedCellValue(sheetName, 147, 17, null),
					new ExpectedCellValue(sheetName, 148, 17, null),
					new ExpectedCellValue(sheetName, 149, 17, null),
					new ExpectedCellValue(sheetName, 150, 17, null),
					new ExpectedCellValue(sheetName, 151, 17, null),
					new ExpectedCellValue(sheetName, 152, 17, null),
					new ExpectedCellValue(sheetName, 153, 17, null),
					new ExpectedCellValue(sheetName, 154, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 155, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 156, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 157, 17, null),
					new ExpectedCellValue(sheetName, 158, 17, null),
					new ExpectedCellValue(sheetName, 159, 17, null),
					new ExpectedCellValue(sheetName, 160, 17, null),
					new ExpectedCellValue(sheetName, 161, 17, null),
					new ExpectedCellValue(sheetName, 162, 17, null),
					new ExpectedCellValue(sheetName, 163, 17, null),
					new ExpectedCellValue(sheetName, 164, 17, null),
					new ExpectedCellValue(sheetName, 165, 17, null),
					new ExpectedCellValue(sheetName, 166, 17, null),
					new ExpectedCellValue(sheetName, 167, 17, null),
					new ExpectedCellValue(sheetName, 168, 17, null),
					new ExpectedCellValue(sheetName, 169, 17, null),
					new ExpectedCellValue(sheetName, 170, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 171, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 172, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 173, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 18, "Month"),
					new ExpectedCellValue(sheetName, 117, 18, "January"),
					new ExpectedCellValue(sheetName, 118, 18, null),
					new ExpectedCellValue(sheetName, 119, 18, null),
					new ExpectedCellValue(sheetName, 120, 18, null),
					new ExpectedCellValue(sheetName, 121, 18, null),
					new ExpectedCellValue(sheetName, 122, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 123, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 124, 18, "March"),
					new ExpectedCellValue(sheetName, 125, 18, null),
					new ExpectedCellValue(sheetName, 126, 18, null),
					new ExpectedCellValue(sheetName, 127, 18, null),
					new ExpectedCellValue(sheetName, 128, 18, null),
					new ExpectedCellValue(sheetName, 129, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 130, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 131, 18, null),
					new ExpectedCellValue(sheetName, 132, 18, null),
					new ExpectedCellValue(sheetName, 133, 18, "January"),
					new ExpectedCellValue(sheetName, 134, 18, null),
					new ExpectedCellValue(sheetName, 135, 18, null),
					new ExpectedCellValue(sheetName, 136, 18, null),
					new ExpectedCellValue(sheetName, 137, 18, null),
					new ExpectedCellValue(sheetName, 138, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 139, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 140, 18, "February"),
					new ExpectedCellValue(sheetName, 141, 18, null),
					new ExpectedCellValue(sheetName, 142, 18, null),
					new ExpectedCellValue(sheetName, 143, 18, null),
					new ExpectedCellValue(sheetName, 144, 18, null),
					new ExpectedCellValue(sheetName, 145, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 146, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 147, 18, "March"),
					new ExpectedCellValue(sheetName, 148, 18, null),
					new ExpectedCellValue(sheetName, 149, 18, null),
					new ExpectedCellValue(sheetName, 150, 18, null),
					new ExpectedCellValue(sheetName, 151, 18, null),
					new ExpectedCellValue(sheetName, 152, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 153, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 154, 18, null),
					new ExpectedCellValue(sheetName, 155, 18, null),
					new ExpectedCellValue(sheetName, 156, 18, "January"),
					new ExpectedCellValue(sheetName, 157, 18, null),
					new ExpectedCellValue(sheetName, 158, 18, null),
					new ExpectedCellValue(sheetName, 159, 18, null),
					new ExpectedCellValue(sheetName, 160, 18, null),
					new ExpectedCellValue(sheetName, 161, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 162, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 163, 18, "February"),
					new ExpectedCellValue(sheetName, 164, 18, null),
					new ExpectedCellValue(sheetName, 165, 18, null),
					new ExpectedCellValue(sheetName, 166, 18, null),
					new ExpectedCellValue(sheetName, 167, 18, null),
					new ExpectedCellValue(sheetName, 168, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 169, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 170, 18, null),
					new ExpectedCellValue(sheetName, 171, 18, null),
					new ExpectedCellValue(sheetName, 172, 18, null),
					new ExpectedCellValue(sheetName, 173, 18, null),
					new ExpectedCellValue(sheetName, 116, 19, "Values"),
					new ExpectedCellValue(sheetName, 117, 19, null),
					new ExpectedCellValue(sheetName, 118, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 120, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 121, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 122, 19, null),
					new ExpectedCellValue(sheetName, 123, 19, null),
					new ExpectedCellValue(sheetName, 124, 19, null),
					new ExpectedCellValue(sheetName, 125, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 126, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 127, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 128, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 129, 19, null),
					new ExpectedCellValue(sheetName, 130, 19, null),
					new ExpectedCellValue(sheetName, 131, 19, null),
					new ExpectedCellValue(sheetName, 132, 19, null),
					new ExpectedCellValue(sheetName, 133, 19, null),
					new ExpectedCellValue(sheetName, 134, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 135, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 136, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 137, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 138, 19, null),
					new ExpectedCellValue(sheetName, 139, 19, null),
					new ExpectedCellValue(sheetName, 140, 19, null),
					new ExpectedCellValue(sheetName, 141, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 142, 19, "Tent"),
					new ExpectedCellValue(sheetName, 143, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 144, 19, "Tent"),
					new ExpectedCellValue(sheetName, 145, 19, null),
					new ExpectedCellValue(sheetName, 146, 19, null),
					new ExpectedCellValue(sheetName, 147, 19, null),
					new ExpectedCellValue(sheetName, 148, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 149, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 150, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 151, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 152, 19, null),
					new ExpectedCellValue(sheetName, 153, 19, null),
					new ExpectedCellValue(sheetName, 154, 19, null),
					new ExpectedCellValue(sheetName, 155, 19, null),
					new ExpectedCellValue(sheetName, 156, 19, null),
					new ExpectedCellValue(sheetName, 157, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 158, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 159, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 160, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 161, 19, null),
					new ExpectedCellValue(sheetName, 162, 19, null),
					new ExpectedCellValue(sheetName, 163, 19, null),
					new ExpectedCellValue(sheetName, 164, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 165, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 166, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 167, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 168, 19, null),
					new ExpectedCellValue(sheetName, 169, 19, null),
					new ExpectedCellValue(sheetName, 170, 19, null),
					new ExpectedCellValue(sheetName, 171, 19, null),
					new ExpectedCellValue(sheetName, 172, 19, null),
					new ExpectedCellValue(sheetName, 173, 19, null),
					new ExpectedCellValue(sheetName, 116, 20, null),
					new ExpectedCellValue(sheetName, 117, 20, null),
					new ExpectedCellValue(sheetName, 118, 20, null),
					new ExpectedCellValue(sheetName, 119, 20, 415.75),
					new ExpectedCellValue(sheetName, 120, 20, null),
					new ExpectedCellValue(sheetName, 121, 20, 831.5),
					new ExpectedCellValue(sheetName, 122, 20, 415.75),
					new ExpectedCellValue(sheetName, 123, 20, 831.5),
					new ExpectedCellValue(sheetName, 124, 20, null),
					new ExpectedCellValue(sheetName, 125, 20, null),
					new ExpectedCellValue(sheetName, 126, 20, 24.99),
					new ExpectedCellValue(sheetName, 127, 20, null),
					new ExpectedCellValue(sheetName, 128, 20, 24.99),
					new ExpectedCellValue(sheetName, 129, 20, 24.99),
					new ExpectedCellValue(sheetName, 130, 20, 24.99),
					new ExpectedCellValue(sheetName, 131, 20, 440.74),
					new ExpectedCellValue(sheetName, 132, 20, 856.49),
					new ExpectedCellValue(sheetName, 133, 20, null),
					new ExpectedCellValue(sheetName, 134, 20, null),
					new ExpectedCellValue(sheetName, 135, 20, 415.75),
					new ExpectedCellValue(sheetName, 136, 20, null),
					new ExpectedCellValue(sheetName, 137, 20, 831.5),
					new ExpectedCellValue(sheetName, 138, 20, 415.75),
					new ExpectedCellValue(sheetName, 139, 20, 831.5),
					new ExpectedCellValue(sheetName, 140, 20, null),
					new ExpectedCellValue(sheetName, 141, 20, null),
					new ExpectedCellValue(sheetName, 142, 20, 199d),
					new ExpectedCellValue(sheetName, 143, 20, null),
					new ExpectedCellValue(sheetName, 144, 20, 1194d),
					new ExpectedCellValue(sheetName, 145, 20, 199d),
					new ExpectedCellValue(sheetName, 146, 20, 1194d),
					new ExpectedCellValue(sheetName, 147, 20, null),
					new ExpectedCellValue(sheetName, 148, 20, null),
					new ExpectedCellValue(sheetName, 149, 20, 415.75),
					new ExpectedCellValue(sheetName, 150, 20, null),
					new ExpectedCellValue(sheetName, 151, 20, 831.5),
					new ExpectedCellValue(sheetName, 152, 20, 415.75),
					new ExpectedCellValue(sheetName, 153, 20, 831.5),
					new ExpectedCellValue(sheetName, 154, 20, 1030.5),
					new ExpectedCellValue(sheetName, 155, 20, 2857d),
					new ExpectedCellValue(sheetName, 156, 20, null),
					new ExpectedCellValue(sheetName, 157, 20, null),
					new ExpectedCellValue(sheetName, 158, 20, 415.75),
					new ExpectedCellValue(sheetName, 159, 20, null),
					new ExpectedCellValue(sheetName, 160, 20, 415.75),
					new ExpectedCellValue(sheetName, 161, 20, 415.75),
					new ExpectedCellValue(sheetName, 162, 20, 415.75),
					new ExpectedCellValue(sheetName, 163, 20, null),
					new ExpectedCellValue(sheetName, 164, 20, null),
					new ExpectedCellValue(sheetName, 165, 20, 99d),
					new ExpectedCellValue(sheetName, 166, 20, null),
					new ExpectedCellValue(sheetName, 167, 20, 99d),
					new ExpectedCellValue(sheetName, 168, 20, 99d),
					new ExpectedCellValue(sheetName, 169, 20, 99d),
					new ExpectedCellValue(sheetName, 170, 20, 514.75),
					new ExpectedCellValue(sheetName, 171, 20, 514.75),
					new ExpectedCellValue(sheetName, 172, 20, 1985.99),
					new ExpectedCellValue(sheetName, 173, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondAndLastFieldsThirdFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C179:F212"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 3, null),
					new ExpectedCellValue(sheetName, 182, 3, null),
					new ExpectedCellValue(sheetName, 183, 3, null),
					new ExpectedCellValue(sheetName, 184, 3, null),
					new ExpectedCellValue(sheetName, 185, 3, null),
					new ExpectedCellValue(sheetName, 186, 3, null),
					new ExpectedCellValue(sheetName, 187, 3, null),
					new ExpectedCellValue(sheetName, 188, 3, null),
					new ExpectedCellValue(sheetName, 189, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 190, 3, null),
					new ExpectedCellValue(sheetName, 191, 3, null),
					new ExpectedCellValue(sheetName, 192, 3, null),
					new ExpectedCellValue(sheetName, 193, 3, null),
					new ExpectedCellValue(sheetName, 194, 3, null),
					new ExpectedCellValue(sheetName, 195, 3, null),
					new ExpectedCellValue(sheetName, 196, 3, null),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, null),
					new ExpectedCellValue(sheetName, 199, 3, null),
					new ExpectedCellValue(sheetName, 200, 3, null),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 203, 3, null),
					new ExpectedCellValue(sheetName, 204, 3, null),
					new ExpectedCellValue(sheetName, 205, 3, null),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, null),
					new ExpectedCellValue(sheetName, 208, 3, null),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 210, 3, null),
					new ExpectedCellValue(sheetName, 211, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 212, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 4, "Month"),
					new ExpectedCellValue(sheetName, 180, 4, null),
					new ExpectedCellValue(sheetName, 181, 4, "January"),
					new ExpectedCellValue(sheetName, 182, 4, null),
					new ExpectedCellValue(sheetName, 183, 4, null),
					new ExpectedCellValue(sheetName, 184, 4, null),
					new ExpectedCellValue(sheetName, 185, 4, "March"),
					new ExpectedCellValue(sheetName, 186, 4, null),
					new ExpectedCellValue(sheetName, 187, 4, null),
					new ExpectedCellValue(sheetName, 188, 4, null),
					new ExpectedCellValue(sheetName, 189, 4, null),
					new ExpectedCellValue(sheetName, 190, 4, "January"),
					new ExpectedCellValue(sheetName, 191, 4, null),
					new ExpectedCellValue(sheetName, 192, 4, null),
					new ExpectedCellValue(sheetName, 193, 4, null),
					new ExpectedCellValue(sheetName, 194, 4, "February"),
					new ExpectedCellValue(sheetName, 195, 4, null),
					new ExpectedCellValue(sheetName, 196, 4, null),
					new ExpectedCellValue(sheetName, 197, 4, null),
					new ExpectedCellValue(sheetName, 198, 4, "March"),
					new ExpectedCellValue(sheetName, 199, 4, null),
					new ExpectedCellValue(sheetName, 200, 4, null),
					new ExpectedCellValue(sheetName, 201, 4, null),
					new ExpectedCellValue(sheetName, 202, 4, null),
					new ExpectedCellValue(sheetName, 203, 4, "January"),
					new ExpectedCellValue(sheetName, 204, 4, null),
					new ExpectedCellValue(sheetName, 205, 4, null),
					new ExpectedCellValue(sheetName, 206, 4, null),
					new ExpectedCellValue(sheetName, 207, 4, "February"),
					new ExpectedCellValue(sheetName, 208, 4, null),
					new ExpectedCellValue(sheetName, 209, 4, null),
					new ExpectedCellValue(sheetName, 210, 4, null),
					new ExpectedCellValue(sheetName, 211, 4, null),
					new ExpectedCellValue(sheetName, 212, 4, null),
					new ExpectedCellValue(sheetName, 179, 5, "Values"),
					new ExpectedCellValue(sheetName, 180, 5, null),
					new ExpectedCellValue(sheetName, 181, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 187, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 188, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 5, null),
					new ExpectedCellValue(sheetName, 190, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 191, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 193, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 194, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 195, 5, "Tent"),
					new ExpectedCellValue(sheetName, 196, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 197, 5, "Tent"),
					new ExpectedCellValue(sheetName, 198, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 199, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 201, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 202, 5, null),
					new ExpectedCellValue(sheetName, 203, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 204, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 205, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 206, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 207, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 208, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 209, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 210, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 211, 5, null),
					new ExpectedCellValue(sheetName, 212, 5, null),
					new ExpectedCellValue(sheetName, 179, 6, null),
					new ExpectedCellValue(sheetName, 180, 6, null),
					new ExpectedCellValue(sheetName, 181, 6, null),
					new ExpectedCellValue(sheetName, 182, 6, 415.75),
					new ExpectedCellValue(sheetName, 183, 6, null),
					new ExpectedCellValue(sheetName, 184, 6, 831.5),
					new ExpectedCellValue(sheetName, 185, 6, null),
					new ExpectedCellValue(sheetName, 186, 6, 24.99),
					new ExpectedCellValue(sheetName, 187, 6, null),
					new ExpectedCellValue(sheetName, 188, 6, 24.99),
					new ExpectedCellValue(sheetName, 189, 6, null),
					new ExpectedCellValue(sheetName, 190, 6, null),
					new ExpectedCellValue(sheetName, 191, 6, 415.75),
					new ExpectedCellValue(sheetName, 192, 6, null),
					new ExpectedCellValue(sheetName, 193, 6, 831.5),
					new ExpectedCellValue(sheetName, 194, 6, null),
					new ExpectedCellValue(sheetName, 195, 6, 199d),
					new ExpectedCellValue(sheetName, 196, 6, null),
					new ExpectedCellValue(sheetName, 197, 6, 1194d),
					new ExpectedCellValue(sheetName, 198, 6, null),
					new ExpectedCellValue(sheetName, 199, 6, 415.75),
					new ExpectedCellValue(sheetName, 200, 6, null),
					new ExpectedCellValue(sheetName, 201, 6, 831.5),
					new ExpectedCellValue(sheetName, 202, 6, null),
					new ExpectedCellValue(sheetName, 203, 6, null),
					new ExpectedCellValue(sheetName, 204, 6, 415.75),
					new ExpectedCellValue(sheetName, 205, 6, null),
					new ExpectedCellValue(sheetName, 206, 6, 415.75),
					new ExpectedCellValue(sheetName, 207, 6, null),
					new ExpectedCellValue(sheetName, 208, 6, 99d),
					new ExpectedCellValue(sheetName, 209, 6, null),
					new ExpectedCellValue(sheetName, 210, 6, 99d),
					new ExpectedCellValue(sheetName, 211, 6, 1985.99),
					new ExpectedCellValue(sheetName, 212, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondAndLastFieldsThirdFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C179:F232"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 3, null),
					new ExpectedCellValue(sheetName, 182, 3, null),
					new ExpectedCellValue(sheetName, 183, 3, null),
					new ExpectedCellValue(sheetName, 184, 3, null),
					new ExpectedCellValue(sheetName, 185, 3, null),
					new ExpectedCellValue(sheetName, 186, 3, null),
					new ExpectedCellValue(sheetName, 187, 3, null),
					new ExpectedCellValue(sheetName, 188, 3, null),
					new ExpectedCellValue(sheetName, 189, 3, null),
					new ExpectedCellValue(sheetName, 190, 3, null),
					new ExpectedCellValue(sheetName, 191, 3, null),
					new ExpectedCellValue(sheetName, 192, 3, null),
					new ExpectedCellValue(sheetName, 193, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 3, null),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, null),
					new ExpectedCellValue(sheetName, 199, 3, null),
					new ExpectedCellValue(sheetName, 200, 3, null),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, null),
					new ExpectedCellValue(sheetName, 203, 3, null),
					new ExpectedCellValue(sheetName, 204, 3, null),
					new ExpectedCellValue(sheetName, 205, 3, null),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, null),
					new ExpectedCellValue(sheetName, 208, 3, null),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 210, 3, null),
					new ExpectedCellValue(sheetName, 211, 3, null),
					new ExpectedCellValue(sheetName, 212, 3, null),
					new ExpectedCellValue(sheetName, 213, 3, null),
					new ExpectedCellValue(sheetName, 214, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 215, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 217, 3, null),
					new ExpectedCellValue(sheetName, 218, 3, null),
					new ExpectedCellValue(sheetName, 219, 3, null),
					new ExpectedCellValue(sheetName, 220, 3, null),
					new ExpectedCellValue(sheetName, 221, 3, null),
					new ExpectedCellValue(sheetName, 222, 3, null),
					new ExpectedCellValue(sheetName, 223, 3, null),
					new ExpectedCellValue(sheetName, 224, 3, null),
					new ExpectedCellValue(sheetName, 225, 3, null),
					new ExpectedCellValue(sheetName, 226, 3, null),
					new ExpectedCellValue(sheetName, 227, 3, null),
					new ExpectedCellValue(sheetName, 228, 3, null),
					new ExpectedCellValue(sheetName, 229, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 230, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 231, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 232, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 4, "Month"),
					new ExpectedCellValue(sheetName, 180, 4, null),
					new ExpectedCellValue(sheetName, 181, 4, "January"),
					new ExpectedCellValue(sheetName, 182, 4, null),
					new ExpectedCellValue(sheetName, 183, 4, null),
					new ExpectedCellValue(sheetName, 184, 4, null),
					new ExpectedCellValue(sheetName, 185, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 187, 4, "March"),
					new ExpectedCellValue(sheetName, 188, 4, null),
					new ExpectedCellValue(sheetName, 189, 4, null),
					new ExpectedCellValue(sheetName, 190, 4, null),
					new ExpectedCellValue(sheetName, 191, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 192, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 193, 4, null),
					new ExpectedCellValue(sheetName, 194, 4, null),
					new ExpectedCellValue(sheetName, 195, 4, null),
					new ExpectedCellValue(sheetName, 196, 4, "January"),
					new ExpectedCellValue(sheetName, 197, 4, null),
					new ExpectedCellValue(sheetName, 198, 4, null),
					new ExpectedCellValue(sheetName, 199, 4, null),
					new ExpectedCellValue(sheetName, 200, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 201, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 4, "February"),
					new ExpectedCellValue(sheetName, 203, 4, null),
					new ExpectedCellValue(sheetName, 204, 4, null),
					new ExpectedCellValue(sheetName, 205, 4, null),
					new ExpectedCellValue(sheetName, 206, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 208, 4, "March"),
					new ExpectedCellValue(sheetName, 209, 4, null),
					new ExpectedCellValue(sheetName, 210, 4, null),
					new ExpectedCellValue(sheetName, 211, 4, null),
					new ExpectedCellValue(sheetName, 212, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 213, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 214, 4, null),
					new ExpectedCellValue(sheetName, 215, 4, null),
					new ExpectedCellValue(sheetName, 216, 4, null),
					new ExpectedCellValue(sheetName, 217, 4, "January"),
					new ExpectedCellValue(sheetName, 218, 4, null),
					new ExpectedCellValue(sheetName, 219, 4, null),
					new ExpectedCellValue(sheetName, 220, 4, null),
					new ExpectedCellValue(sheetName, 221, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 222, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 4, "February"),
					new ExpectedCellValue(sheetName, 224, 4, null),
					new ExpectedCellValue(sheetName, 225, 4, null),
					new ExpectedCellValue(sheetName, 226, 4, null),
					new ExpectedCellValue(sheetName, 227, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 228, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 229, 4, null),
					new ExpectedCellValue(sheetName, 230, 4, null),
					new ExpectedCellValue(sheetName, 231, 4, null),
					new ExpectedCellValue(sheetName, 232, 4, null),
					new ExpectedCellValue(sheetName, 179, 5, "Values"),
					new ExpectedCellValue(sheetName, 180, 5, null),
					new ExpectedCellValue(sheetName, 181, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 5, null),
					new ExpectedCellValue(sheetName, 186, 5, null),
					new ExpectedCellValue(sheetName, 187, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 188, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 190, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 5, null),
					new ExpectedCellValue(sheetName, 192, 5, null),
					new ExpectedCellValue(sheetName, 193, 5, null),
					new ExpectedCellValue(sheetName, 194, 5, null),
					new ExpectedCellValue(sheetName, 195, 5, null),
					new ExpectedCellValue(sheetName, 196, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 197, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 198, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 5, null),
					new ExpectedCellValue(sheetName, 201, 5, null),
					new ExpectedCellValue(sheetName, 202, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 203, 5, "Tent"),
					new ExpectedCellValue(sheetName, 204, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 205, 5, "Tent"),
					new ExpectedCellValue(sheetName, 206, 5, null),
					new ExpectedCellValue(sheetName, 207, 5, null),
					new ExpectedCellValue(sheetName, 208, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 209, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 211, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 212, 5, null),
					new ExpectedCellValue(sheetName, 213, 5, null),
					new ExpectedCellValue(sheetName, 214, 5, null),
					new ExpectedCellValue(sheetName, 215, 5, null),
					new ExpectedCellValue(sheetName, 216, 5, null),
					new ExpectedCellValue(sheetName, 217, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 219, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 220, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 221, 5, null),
					new ExpectedCellValue(sheetName, 222, 5, null),
					new ExpectedCellValue(sheetName, 223, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 225, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 227, 5, null),
					new ExpectedCellValue(sheetName, 228, 5, null),
					new ExpectedCellValue(sheetName, 229, 5, null),
					new ExpectedCellValue(sheetName, 230, 5, null),
					new ExpectedCellValue(sheetName, 231, 5, null),
					new ExpectedCellValue(sheetName, 232, 5, null),
					new ExpectedCellValue(sheetName, 179, 6, null),
					new ExpectedCellValue(sheetName, 180, 6, null),
					new ExpectedCellValue(sheetName, 181, 6, null),
					new ExpectedCellValue(sheetName, 182, 6, 415.75),
					new ExpectedCellValue(sheetName, 183, 6, null),
					new ExpectedCellValue(sheetName, 184, 6, 831.5),
					new ExpectedCellValue(sheetName, 185, 6, 415.75),
					new ExpectedCellValue(sheetName, 186, 6, 831.5),
					new ExpectedCellValue(sheetName, 187, 6, null),
					new ExpectedCellValue(sheetName, 188, 6, 24.99),
					new ExpectedCellValue(sheetName, 189, 6, null),
					new ExpectedCellValue(sheetName, 190, 6, 24.99),
					new ExpectedCellValue(sheetName, 191, 6, 24.99),
					new ExpectedCellValue(sheetName, 192, 6, 24.99),
					new ExpectedCellValue(sheetName, 193, 6, 440.74),
					new ExpectedCellValue(sheetName, 194, 6, 856.49),
					new ExpectedCellValue(sheetName, 195, 6, null),
					new ExpectedCellValue(sheetName, 196, 6, null),
					new ExpectedCellValue(sheetName, 197, 6, 415.75),
					new ExpectedCellValue(sheetName, 198, 6, null),
					new ExpectedCellValue(sheetName, 199, 6, 831.5),
					new ExpectedCellValue(sheetName, 200, 6, 415.75),
					new ExpectedCellValue(sheetName, 201, 6, 831.5),
					new ExpectedCellValue(sheetName, 202, 6, null),
					new ExpectedCellValue(sheetName, 203, 6, 199d),
					new ExpectedCellValue(sheetName, 204, 6, null),
					new ExpectedCellValue(sheetName, 205, 6, 1194d),
					new ExpectedCellValue(sheetName, 206, 6, 199d),
					new ExpectedCellValue(sheetName, 207, 6, 1194d),
					new ExpectedCellValue(sheetName, 208, 6, null),
					new ExpectedCellValue(sheetName, 209, 6, 415.75),
					new ExpectedCellValue(sheetName, 210, 6, null),
					new ExpectedCellValue(sheetName, 211, 6, 831.5),
					new ExpectedCellValue(sheetName, 212, 6, 415.75),
					new ExpectedCellValue(sheetName, 213, 6, 831.5),
					new ExpectedCellValue(sheetName, 214, 6, 1030.5),
					new ExpectedCellValue(sheetName, 215, 6, 2857d),
					new ExpectedCellValue(sheetName, 216, 6, null),
					new ExpectedCellValue(sheetName, 217, 6, null),
					new ExpectedCellValue(sheetName, 218, 6, 415.75),
					new ExpectedCellValue(sheetName, 219, 6, null),
					new ExpectedCellValue(sheetName, 220, 6, 415.75),
					new ExpectedCellValue(sheetName, 221, 6, 415.75),
					new ExpectedCellValue(sheetName, 222, 6, 415.75),
					new ExpectedCellValue(sheetName, 223, 6, null),
					new ExpectedCellValue(sheetName, 224, 6, 99d),
					new ExpectedCellValue(sheetName, 225, 6, null),
					new ExpectedCellValue(sheetName, 226, 6, 99d),
					new ExpectedCellValue(sheetName, 227, 6, 99d),
					new ExpectedCellValue(sheetName, 228, 6, 99d),
					new ExpectedCellValue(sheetName, 229, 6, 514.75),
					new ExpectedCellValue(sheetName, 230, 6, 514.75),
					new ExpectedCellValue(sheetName, 231, 6, 1985.99),
					new ExpectedCellValue(sheetName, 232, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularSecondAndLastFieldsThirdFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable10"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C179:F232"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 3, null),
					new ExpectedCellValue(sheetName, 182, 3, null),
					new ExpectedCellValue(sheetName, 183, 3, null),
					new ExpectedCellValue(sheetName, 184, 3, null),
					new ExpectedCellValue(sheetName, 185, 3, null),
					new ExpectedCellValue(sheetName, 186, 3, null),
					new ExpectedCellValue(sheetName, 187, 3, null),
					new ExpectedCellValue(sheetName, 188, 3, null),
					new ExpectedCellValue(sheetName, 189, 3, null),
					new ExpectedCellValue(sheetName, 190, 3, null),
					new ExpectedCellValue(sheetName, 191, 3, null),
					new ExpectedCellValue(sheetName, 192, 3, null),
					new ExpectedCellValue(sheetName, 193, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 3, null),
					new ExpectedCellValue(sheetName, 197, 3, null),
					new ExpectedCellValue(sheetName, 198, 3, null),
					new ExpectedCellValue(sheetName, 199, 3, null),
					new ExpectedCellValue(sheetName, 200, 3, null),
					new ExpectedCellValue(sheetName, 201, 3, null),
					new ExpectedCellValue(sheetName, 202, 3, null),
					new ExpectedCellValue(sheetName, 203, 3, null),
					new ExpectedCellValue(sheetName, 204, 3, null),
					new ExpectedCellValue(sheetName, 205, 3, null),
					new ExpectedCellValue(sheetName, 206, 3, null),
					new ExpectedCellValue(sheetName, 207, 3, null),
					new ExpectedCellValue(sheetName, 208, 3, null),
					new ExpectedCellValue(sheetName, 209, 3, null),
					new ExpectedCellValue(sheetName, 210, 3, null),
					new ExpectedCellValue(sheetName, 211, 3, null),
					new ExpectedCellValue(sheetName, 212, 3, null),
					new ExpectedCellValue(sheetName, 213, 3, null),
					new ExpectedCellValue(sheetName, 214, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 215, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 217, 3, null),
					new ExpectedCellValue(sheetName, 218, 3, null),
					new ExpectedCellValue(sheetName, 219, 3, null),
					new ExpectedCellValue(sheetName, 220, 3, null),
					new ExpectedCellValue(sheetName, 221, 3, null),
					new ExpectedCellValue(sheetName, 222, 3, null),
					new ExpectedCellValue(sheetName, 223, 3, null),
					new ExpectedCellValue(sheetName, 224, 3, null),
					new ExpectedCellValue(sheetName, 225, 3, null),
					new ExpectedCellValue(sheetName, 226, 3, null),
					new ExpectedCellValue(sheetName, 227, 3, null),
					new ExpectedCellValue(sheetName, 228, 3, null),
					new ExpectedCellValue(sheetName, 229, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 230, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 231, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 232, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 4, "Month"),
					new ExpectedCellValue(sheetName, 180, 4, null),
					new ExpectedCellValue(sheetName, 181, 4, "January"),
					new ExpectedCellValue(sheetName, 182, 4, null),
					new ExpectedCellValue(sheetName, 183, 4, null),
					new ExpectedCellValue(sheetName, 184, 4, null),
					new ExpectedCellValue(sheetName, 185, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 187, 4, "March"),
					new ExpectedCellValue(sheetName, 188, 4, null),
					new ExpectedCellValue(sheetName, 189, 4, null),
					new ExpectedCellValue(sheetName, 190, 4, null),
					new ExpectedCellValue(sheetName, 191, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 192, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 193, 4, null),
					new ExpectedCellValue(sheetName, 194, 4, null),
					new ExpectedCellValue(sheetName, 195, 4, null),
					new ExpectedCellValue(sheetName, 196, 4, "January"),
					new ExpectedCellValue(sheetName, 197, 4, null),
					new ExpectedCellValue(sheetName, 198, 4, null),
					new ExpectedCellValue(sheetName, 199, 4, null),
					new ExpectedCellValue(sheetName, 200, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 201, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 4, "February"),
					new ExpectedCellValue(sheetName, 203, 4, null),
					new ExpectedCellValue(sheetName, 204, 4, null),
					new ExpectedCellValue(sheetName, 205, 4, null),
					new ExpectedCellValue(sheetName, 206, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 208, 4, "March"),
					new ExpectedCellValue(sheetName, 209, 4, null),
					new ExpectedCellValue(sheetName, 210, 4, null),
					new ExpectedCellValue(sheetName, 211, 4, null),
					new ExpectedCellValue(sheetName, 212, 4, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 213, 4, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 214, 4, null),
					new ExpectedCellValue(sheetName, 215, 4, null),
					new ExpectedCellValue(sheetName, 216, 4, null),
					new ExpectedCellValue(sheetName, 217, 4, "January"),
					new ExpectedCellValue(sheetName, 218, 4, null),
					new ExpectedCellValue(sheetName, 219, 4, null),
					new ExpectedCellValue(sheetName, 220, 4, null),
					new ExpectedCellValue(sheetName, 221, 4, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 222, 4, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 4, "February"),
					new ExpectedCellValue(sheetName, 224, 4, null),
					new ExpectedCellValue(sheetName, 225, 4, null),
					new ExpectedCellValue(sheetName, 226, 4, null),
					new ExpectedCellValue(sheetName, 227, 4, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 228, 4, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 229, 4, null),
					new ExpectedCellValue(sheetName, 230, 4, null),
					new ExpectedCellValue(sheetName, 231, 4, null),
					new ExpectedCellValue(sheetName, 232, 4, null),
					new ExpectedCellValue(sheetName, 179, 5, "Values"),
					new ExpectedCellValue(sheetName, 180, 5, null),
					new ExpectedCellValue(sheetName, 181, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 5, null),
					new ExpectedCellValue(sheetName, 186, 5, null),
					new ExpectedCellValue(sheetName, 187, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 188, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 190, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 5, null),
					new ExpectedCellValue(sheetName, 192, 5, null),
					new ExpectedCellValue(sheetName, 193, 5, null),
					new ExpectedCellValue(sheetName, 194, 5, null),
					new ExpectedCellValue(sheetName, 195, 5, null),
					new ExpectedCellValue(sheetName, 196, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 197, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 198, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 5, null),
					new ExpectedCellValue(sheetName, 201, 5, null),
					new ExpectedCellValue(sheetName, 202, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 203, 5, "Tent"),
					new ExpectedCellValue(sheetName, 204, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 205, 5, "Tent"),
					new ExpectedCellValue(sheetName, 206, 5, null),
					new ExpectedCellValue(sheetName, 207, 5, null),
					new ExpectedCellValue(sheetName, 208, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 209, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 211, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 212, 5, null),
					new ExpectedCellValue(sheetName, 213, 5, null),
					new ExpectedCellValue(sheetName, 214, 5, null),
					new ExpectedCellValue(sheetName, 215, 5, null),
					new ExpectedCellValue(sheetName, 216, 5, null),
					new ExpectedCellValue(sheetName, 217, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 219, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 220, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 221, 5, null),
					new ExpectedCellValue(sheetName, 222, 5, null),
					new ExpectedCellValue(sheetName, 223, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 225, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 227, 5, null),
					new ExpectedCellValue(sheetName, 228, 5, null),
					new ExpectedCellValue(sheetName, 229, 5, null),
					new ExpectedCellValue(sheetName, 230, 5, null),
					new ExpectedCellValue(sheetName, 231, 5, null),
					new ExpectedCellValue(sheetName, 232, 5, null),
					new ExpectedCellValue(sheetName, 179, 6, null),
					new ExpectedCellValue(sheetName, 180, 6, null),
					new ExpectedCellValue(sheetName, 181, 6, null),
					new ExpectedCellValue(sheetName, 182, 6, 415.75),
					new ExpectedCellValue(sheetName, 183, 6, null),
					new ExpectedCellValue(sheetName, 184, 6, 831.5),
					new ExpectedCellValue(sheetName, 185, 6, 415.75),
					new ExpectedCellValue(sheetName, 186, 6, 831.5),
					new ExpectedCellValue(sheetName, 187, 6, null),
					new ExpectedCellValue(sheetName, 188, 6, 24.99),
					new ExpectedCellValue(sheetName, 189, 6, null),
					new ExpectedCellValue(sheetName, 190, 6, 24.99),
					new ExpectedCellValue(sheetName, 191, 6, 24.99),
					new ExpectedCellValue(sheetName, 192, 6, 24.99),
					new ExpectedCellValue(sheetName, 193, 6, 440.74),
					new ExpectedCellValue(sheetName, 194, 6, 856.49),
					new ExpectedCellValue(sheetName, 195, 6, null),
					new ExpectedCellValue(sheetName, 196, 6, null),
					new ExpectedCellValue(sheetName, 197, 6, 415.75),
					new ExpectedCellValue(sheetName, 198, 6, null),
					new ExpectedCellValue(sheetName, 199, 6, 831.5),
					new ExpectedCellValue(sheetName, 200, 6, 415.75),
					new ExpectedCellValue(sheetName, 201, 6, 831.5),
					new ExpectedCellValue(sheetName, 202, 6, null),
					new ExpectedCellValue(sheetName, 203, 6, 199d),
					new ExpectedCellValue(sheetName, 204, 6, null),
					new ExpectedCellValue(sheetName, 205, 6, 1194d),
					new ExpectedCellValue(sheetName, 206, 6, 199d),
					new ExpectedCellValue(sheetName, 207, 6, 1194d),
					new ExpectedCellValue(sheetName, 208, 6, null),
					new ExpectedCellValue(sheetName, 209, 6, 415.75),
					new ExpectedCellValue(sheetName, 210, 6, null),
					new ExpectedCellValue(sheetName, 211, 6, 831.5),
					new ExpectedCellValue(sheetName, 212, 6, 415.75),
					new ExpectedCellValue(sheetName, 213, 6, 831.5),
					new ExpectedCellValue(sheetName, 214, 6, 1030.5),
					new ExpectedCellValue(sheetName, 215, 6, 2857d),
					new ExpectedCellValue(sheetName, 216, 6, null),
					new ExpectedCellValue(sheetName, 217, 6, null),
					new ExpectedCellValue(sheetName, 218, 6, 415.75),
					new ExpectedCellValue(sheetName, 219, 6, null),
					new ExpectedCellValue(sheetName, 220, 6, 415.75),
					new ExpectedCellValue(sheetName, 221, 6, 415.75),
					new ExpectedCellValue(sheetName, 222, 6, 415.75),
					new ExpectedCellValue(sheetName, 223, 6, null),
					new ExpectedCellValue(sheetName, 224, 6, 99d),
					new ExpectedCellValue(sheetName, 225, 6, null),
					new ExpectedCellValue(sheetName, 226, 6, 99d),
					new ExpectedCellValue(sheetName, 227, 6, 99d),
					new ExpectedCellValue(sheetName, 228, 6, 99d),
					new ExpectedCellValue(sheetName, 229, 6, 514.75),
					new ExpectedCellValue(sheetName, 230, 6, 514.75),
					new ExpectedCellValue(sheetName, 231, 6, 1985.99),
					new ExpectedCellValue(sheetName, 232, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndLastFieldsTabularSecondFieldThirdFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J179:M212"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 10, null),
					new ExpectedCellValue(sheetName, 182, 10, null),
					new ExpectedCellValue(sheetName, 183, 10, null),
					new ExpectedCellValue(sheetName, 184, 10, null),
					new ExpectedCellValue(sheetName, 185, 10, null),
					new ExpectedCellValue(sheetName, 186, 10, null),
					new ExpectedCellValue(sheetName, 187, 10, null),
					new ExpectedCellValue(sheetName, 188, 10, null),
					new ExpectedCellValue(sheetName, 189, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 190, 10, null),
					new ExpectedCellValue(sheetName, 191, 10, null),
					new ExpectedCellValue(sheetName, 192, 10, null),
					new ExpectedCellValue(sheetName, 193, 10, null),
					new ExpectedCellValue(sheetName, 194, 10, null),
					new ExpectedCellValue(sheetName, 195, 10, null),
					new ExpectedCellValue(sheetName, 196, 10, null),
					new ExpectedCellValue(sheetName, 197, 10, null),
					new ExpectedCellValue(sheetName, 198, 10, null),
					new ExpectedCellValue(sheetName, 199, 10, null),
					new ExpectedCellValue(sheetName, 200, 10, null),
					new ExpectedCellValue(sheetName, 201, 10, null),
					new ExpectedCellValue(sheetName, 202, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 203, 10, null),
					new ExpectedCellValue(sheetName, 204, 10, null),
					new ExpectedCellValue(sheetName, 205, 10, null),
					new ExpectedCellValue(sheetName, 206, 10, null),
					new ExpectedCellValue(sheetName, 207, 10, null),
					new ExpectedCellValue(sheetName, 208, 10, null),
					new ExpectedCellValue(sheetName, 209, 10, null),
					new ExpectedCellValue(sheetName, 210, 10, null),
					new ExpectedCellValue(sheetName, 211, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 212, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 11, "Month"),
					new ExpectedCellValue(sheetName, 180, 11, null),
					new ExpectedCellValue(sheetName, 181, 11, "January"),
					new ExpectedCellValue(sheetName, 182, 11, null),
					new ExpectedCellValue(sheetName, 183, 11, null),
					new ExpectedCellValue(sheetName, 184, 11, null),
					new ExpectedCellValue(sheetName, 185, 11, "March"),
					new ExpectedCellValue(sheetName, 186, 11, null),
					new ExpectedCellValue(sheetName, 187, 11, null),
					new ExpectedCellValue(sheetName, 188, 11, null),
					new ExpectedCellValue(sheetName, 189, 11, null),
					new ExpectedCellValue(sheetName, 190, 11, "January"),
					new ExpectedCellValue(sheetName, 191, 11, null),
					new ExpectedCellValue(sheetName, 192, 11, null),
					new ExpectedCellValue(sheetName, 193, 11, null),
					new ExpectedCellValue(sheetName, 194, 11, "February"),
					new ExpectedCellValue(sheetName, 195, 11, null),
					new ExpectedCellValue(sheetName, 196, 11, null),
					new ExpectedCellValue(sheetName, 197, 11, null),
					new ExpectedCellValue(sheetName, 198, 11, "March"),
					new ExpectedCellValue(sheetName, 199, 11, null),
					new ExpectedCellValue(sheetName, 200, 11, null),
					new ExpectedCellValue(sheetName, 201, 11, null),
					new ExpectedCellValue(sheetName, 202, 11, null),
					new ExpectedCellValue(sheetName, 203, 11, "January"),
					new ExpectedCellValue(sheetName, 204, 11, null),
					new ExpectedCellValue(sheetName, 205, 11, null),
					new ExpectedCellValue(sheetName, 206, 11, null),
					new ExpectedCellValue(sheetName, 207, 11, "February"),
					new ExpectedCellValue(sheetName, 208, 11, null),
					new ExpectedCellValue(sheetName, 209, 11, null),
					new ExpectedCellValue(sheetName, 210, 11, null),
					new ExpectedCellValue(sheetName, 211, 11, null),
					new ExpectedCellValue(sheetName, 212, 11, null),
					new ExpectedCellValue(sheetName, 179, 12, "Values"),
					new ExpectedCellValue(sheetName, 180, 12, null),
					new ExpectedCellValue(sheetName, 181, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 187, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 188, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 12, null),
					new ExpectedCellValue(sheetName, 190, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 191, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 192, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 193, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 194, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 195, 12, "Tent"),
					new ExpectedCellValue(sheetName, 196, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 197, 12, "Tent"),
					new ExpectedCellValue(sheetName, 198, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 199, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 201, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 202, 12, null),
					new ExpectedCellValue(sheetName, 203, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 204, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 205, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 206, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 207, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 208, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 209, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 210, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 211, 12, null),
					new ExpectedCellValue(sheetName, 212, 12, null),
					new ExpectedCellValue(sheetName, 179, 13, null),
					new ExpectedCellValue(sheetName, 180, 13, null),
					new ExpectedCellValue(sheetName, 181, 13, null),
					new ExpectedCellValue(sheetName, 182, 13, 415.75),
					new ExpectedCellValue(sheetName, 183, 13, null),
					new ExpectedCellValue(sheetName, 184, 13, 831.5),
					new ExpectedCellValue(sheetName, 185, 13, null),
					new ExpectedCellValue(sheetName, 186, 13, 24.99),
					new ExpectedCellValue(sheetName, 187, 13, null),
					new ExpectedCellValue(sheetName, 188, 13, 24.99),
					new ExpectedCellValue(sheetName, 189, 13, null),
					new ExpectedCellValue(sheetName, 190, 13, null),
					new ExpectedCellValue(sheetName, 191, 13, 415.75),
					new ExpectedCellValue(sheetName, 192, 13, null),
					new ExpectedCellValue(sheetName, 193, 13, 831.5),
					new ExpectedCellValue(sheetName, 194, 13, null),
					new ExpectedCellValue(sheetName, 195, 13, 199d),
					new ExpectedCellValue(sheetName, 196, 13, null),
					new ExpectedCellValue(sheetName, 197, 13, 1194d),
					new ExpectedCellValue(sheetName, 198, 13, null),
					new ExpectedCellValue(sheetName, 199, 13, 415.75),
					new ExpectedCellValue(sheetName, 200, 13, null),
					new ExpectedCellValue(sheetName, 201, 13, 831.5),
					new ExpectedCellValue(sheetName, 202, 13, null),
					new ExpectedCellValue(sheetName, 203, 13, null),
					new ExpectedCellValue(sheetName, 204, 13, 415.75),
					new ExpectedCellValue(sheetName, 205, 13, null),
					new ExpectedCellValue(sheetName, 206, 13, 415.75),
					new ExpectedCellValue(sheetName, 207, 13, null),
					new ExpectedCellValue(sheetName, 208, 13, 99d),
					new ExpectedCellValue(sheetName, 209, 13, null),
					new ExpectedCellValue(sheetName, 210, 13, 99d),
					new ExpectedCellValue(sheetName, 211, 13, 1985.99),
					new ExpectedCellValue(sheetName, 212, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndLastFieldsTabularSecondFieldThirdFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J179:M232"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 10, null),
					new ExpectedCellValue(sheetName, 182, 10, null),
					new ExpectedCellValue(sheetName, 183, 10, null),
					new ExpectedCellValue(sheetName, 184, 10, null),
					new ExpectedCellValue(sheetName, 185, 10, null),
					new ExpectedCellValue(sheetName, 186, 10, null),
					new ExpectedCellValue(sheetName, 187, 10, null),
					new ExpectedCellValue(sheetName, 188, 10, null),
					new ExpectedCellValue(sheetName, 189, 10, null),
					new ExpectedCellValue(sheetName, 190, 10, null),
					new ExpectedCellValue(sheetName, 191, 10, null),
					new ExpectedCellValue(sheetName, 192, 10, null),
					new ExpectedCellValue(sheetName, 193, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 10, null),
					new ExpectedCellValue(sheetName, 197, 10, null),
					new ExpectedCellValue(sheetName, 198, 10, null),
					new ExpectedCellValue(sheetName, 199, 10, null),
					new ExpectedCellValue(sheetName, 200, 10, null),
					new ExpectedCellValue(sheetName, 201, 10, null),
					new ExpectedCellValue(sheetName, 202, 10, null),
					new ExpectedCellValue(sheetName, 203, 10, null),
					new ExpectedCellValue(sheetName, 204, 10, null),
					new ExpectedCellValue(sheetName, 205, 10, null),
					new ExpectedCellValue(sheetName, 206, 10, null),
					new ExpectedCellValue(sheetName, 207, 10, null),
					new ExpectedCellValue(sheetName, 208, 10, null),
					new ExpectedCellValue(sheetName, 209, 10, null),
					new ExpectedCellValue(sheetName, 210, 10, null),
					new ExpectedCellValue(sheetName, 211, 10, null),
					new ExpectedCellValue(sheetName, 212, 10, null),
					new ExpectedCellValue(sheetName, 213, 10, null),
					new ExpectedCellValue(sheetName, 214, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 215, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 217, 10, null),
					new ExpectedCellValue(sheetName, 218, 10, null),
					new ExpectedCellValue(sheetName, 219, 10, null),
					new ExpectedCellValue(sheetName, 220, 10, null),
					new ExpectedCellValue(sheetName, 221, 10, null),
					new ExpectedCellValue(sheetName, 222, 10, null),
					new ExpectedCellValue(sheetName, 223, 10, null),
					new ExpectedCellValue(sheetName, 224, 10, null),
					new ExpectedCellValue(sheetName, 225, 10, null),
					new ExpectedCellValue(sheetName, 226, 10, null),
					new ExpectedCellValue(sheetName, 227, 10, null),
					new ExpectedCellValue(sheetName, 228, 10, null),
					new ExpectedCellValue(sheetName, 229, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 230, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 231, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 232, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 11, "Month"),
					new ExpectedCellValue(sheetName, 180, 11, null),
					new ExpectedCellValue(sheetName, 181, 11, "January"),
					new ExpectedCellValue(sheetName, 182, 11, null),
					new ExpectedCellValue(sheetName, 183, 11, null),
					new ExpectedCellValue(sheetName, 184, 11, null),
					new ExpectedCellValue(sheetName, 185, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 187, 11, "March"),
					new ExpectedCellValue(sheetName, 188, 11, null),
					new ExpectedCellValue(sheetName, 189, 11, null),
					new ExpectedCellValue(sheetName, 190, 11, null),
					new ExpectedCellValue(sheetName, 191, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 192, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 193, 11, null),
					new ExpectedCellValue(sheetName, 194, 11, null),
					new ExpectedCellValue(sheetName, 195, 11, null),
					new ExpectedCellValue(sheetName, 196, 11, "January"),
					new ExpectedCellValue(sheetName, 197, 11, null),
					new ExpectedCellValue(sheetName, 198, 11, null),
					new ExpectedCellValue(sheetName, 199, 11, null),
					new ExpectedCellValue(sheetName, 200, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 201, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 11, "February"),
					new ExpectedCellValue(sheetName, 203, 11, null),
					new ExpectedCellValue(sheetName, 204, 11, null),
					new ExpectedCellValue(sheetName, 205, 11, null),
					new ExpectedCellValue(sheetName, 206, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 208, 11, "March"),
					new ExpectedCellValue(sheetName, 209, 11, null),
					new ExpectedCellValue(sheetName, 210, 11, null),
					new ExpectedCellValue(sheetName, 211, 11, null),
					new ExpectedCellValue(sheetName, 212, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 213, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 214, 11, null),
					new ExpectedCellValue(sheetName, 215, 11, null),
					new ExpectedCellValue(sheetName, 216, 11, null),
					new ExpectedCellValue(sheetName, 217, 11, "January"),
					new ExpectedCellValue(sheetName, 218, 11, null),
					new ExpectedCellValue(sheetName, 219, 11, null),
					new ExpectedCellValue(sheetName, 220, 11, null),
					new ExpectedCellValue(sheetName, 221, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 222, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 11, "February"),
					new ExpectedCellValue(sheetName, 224, 11, null),
					new ExpectedCellValue(sheetName, 225, 11, null),
					new ExpectedCellValue(sheetName, 226, 11, null),
					new ExpectedCellValue(sheetName, 227, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 228, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 229, 11, null),
					new ExpectedCellValue(sheetName, 230, 11, null),
					new ExpectedCellValue(sheetName, 231, 11, null),
					new ExpectedCellValue(sheetName, 232, 11, null),
					new ExpectedCellValue(sheetName, 179, 12, "Values"),
					new ExpectedCellValue(sheetName, 180, 12, null),
					new ExpectedCellValue(sheetName, 181, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 12, null),
					new ExpectedCellValue(sheetName, 186, 12, null),
					new ExpectedCellValue(sheetName, 187, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 188, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 190, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 12, null),
					new ExpectedCellValue(sheetName, 192, 12, null),
					new ExpectedCellValue(sheetName, 193, 12, null),
					new ExpectedCellValue(sheetName, 194, 12, null),
					new ExpectedCellValue(sheetName, 195, 12, null),
					new ExpectedCellValue(sheetName, 196, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 197, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 198, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 12, null),
					new ExpectedCellValue(sheetName, 201, 12, null),
					new ExpectedCellValue(sheetName, 202, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 203, 12, "Tent"),
					new ExpectedCellValue(sheetName, 204, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 205, 12, "Tent"),
					new ExpectedCellValue(sheetName, 206, 12, null),
					new ExpectedCellValue(sheetName, 207, 12, null),
					new ExpectedCellValue(sheetName, 208, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 209, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 211, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 212, 12, null),
					new ExpectedCellValue(sheetName, 213, 12, null),
					new ExpectedCellValue(sheetName, 214, 12, null),
					new ExpectedCellValue(sheetName, 215, 12, null),
					new ExpectedCellValue(sheetName, 216, 12, null),
					new ExpectedCellValue(sheetName, 217, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 219, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 220, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 221, 12, null),
					new ExpectedCellValue(sheetName, 222, 12, null),
					new ExpectedCellValue(sheetName, 223, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 225, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 227, 12, null),
					new ExpectedCellValue(sheetName, 228, 12, null),
					new ExpectedCellValue(sheetName, 229, 12, null),
					new ExpectedCellValue(sheetName, 230, 12, null),
					new ExpectedCellValue(sheetName, 231, 12, null),
					new ExpectedCellValue(sheetName, 232, 12, null),
					new ExpectedCellValue(sheetName, 179, 13, null),
					new ExpectedCellValue(sheetName, 180, 13, null),
					new ExpectedCellValue(sheetName, 181, 13, null),
					new ExpectedCellValue(sheetName, 182, 13, 415.75),
					new ExpectedCellValue(sheetName, 183, 13, null),
					new ExpectedCellValue(sheetName, 184, 13, 831.5),
					new ExpectedCellValue(sheetName, 185, 13, 415.75),
					new ExpectedCellValue(sheetName, 186, 13, 831.5),
					new ExpectedCellValue(sheetName, 187, 13, null),
					new ExpectedCellValue(sheetName, 188, 13, 24.99),
					new ExpectedCellValue(sheetName, 189, 13, null),
					new ExpectedCellValue(sheetName, 190, 13, 24.99),
					new ExpectedCellValue(sheetName, 191, 13, 24.99),
					new ExpectedCellValue(sheetName, 192, 13, 24.99),
					new ExpectedCellValue(sheetName, 193, 13, 440.74),
					new ExpectedCellValue(sheetName, 194, 13, 856.49),
					new ExpectedCellValue(sheetName, 195, 13, null),
					new ExpectedCellValue(sheetName, 196, 13, null),
					new ExpectedCellValue(sheetName, 197, 13, 415.75),
					new ExpectedCellValue(sheetName, 198, 13, null),
					new ExpectedCellValue(sheetName, 199, 13, 831.5),
					new ExpectedCellValue(sheetName, 200, 13, 415.75),
					new ExpectedCellValue(sheetName, 201, 13, 831.5),
					new ExpectedCellValue(sheetName, 202, 13, null),
					new ExpectedCellValue(sheetName, 203, 13, 199d),
					new ExpectedCellValue(sheetName, 204, 13, null),
					new ExpectedCellValue(sheetName, 205, 13, 1194d),
					new ExpectedCellValue(sheetName, 206, 13, 199d),
					new ExpectedCellValue(sheetName, 207, 13, 1194d),
					new ExpectedCellValue(sheetName, 208, 13, null),
					new ExpectedCellValue(sheetName, 209, 13, 415.75),
					new ExpectedCellValue(sheetName, 210, 13, null),
					new ExpectedCellValue(sheetName, 211, 13, 831.5),
					new ExpectedCellValue(sheetName, 212, 13, 415.75),
					new ExpectedCellValue(sheetName, 213, 13, 831.5),
					new ExpectedCellValue(sheetName, 214, 13, 1030.5),
					new ExpectedCellValue(sheetName, 215, 13, 2857d),
					new ExpectedCellValue(sheetName, 216, 13, null),
					new ExpectedCellValue(sheetName, 217, 13, null),
					new ExpectedCellValue(sheetName, 218, 13, 415.75),
					new ExpectedCellValue(sheetName, 219, 13, null),
					new ExpectedCellValue(sheetName, 220, 13, 415.75),
					new ExpectedCellValue(sheetName, 221, 13, 415.75),
					new ExpectedCellValue(sheetName, 222, 13, 415.75),
					new ExpectedCellValue(sheetName, 223, 13, null),
					new ExpectedCellValue(sheetName, 224, 13, 99d),
					new ExpectedCellValue(sheetName, 225, 13, null),
					new ExpectedCellValue(sheetName, 226, 13, 99d),
					new ExpectedCellValue(sheetName, 227, 13, 99d),
					new ExpectedCellValue(sheetName, 228, 13, 99d),
					new ExpectedCellValue(sheetName, 229, 13, 514.75),
					new ExpectedCellValue(sheetName, 230, 13, 514.75),
					new ExpectedCellValue(sheetName, 231, 13, 1985.99),
					new ExpectedCellValue(sheetName, 232, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndLastFieldsTabularSecondFieldThirdFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable11"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J179:M232"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 10, null),
					new ExpectedCellValue(sheetName, 182, 10, null),
					new ExpectedCellValue(sheetName, 183, 10, null),
					new ExpectedCellValue(sheetName, 184, 10, null),
					new ExpectedCellValue(sheetName, 185, 10, null),
					new ExpectedCellValue(sheetName, 186, 10, null),
					new ExpectedCellValue(sheetName, 187, 10, null),
					new ExpectedCellValue(sheetName, 188, 10, null),
					new ExpectedCellValue(sheetName, 189, 10, null),
					new ExpectedCellValue(sheetName, 190, 10, null),
					new ExpectedCellValue(sheetName, 191, 10, null),
					new ExpectedCellValue(sheetName, 192, 10, null),
					new ExpectedCellValue(sheetName, 193, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 196, 10, null),
					new ExpectedCellValue(sheetName, 197, 10, null),
					new ExpectedCellValue(sheetName, 198, 10, null),
					new ExpectedCellValue(sheetName, 199, 10, null),
					new ExpectedCellValue(sheetName, 200, 10, null),
					new ExpectedCellValue(sheetName, 201, 10, null),
					new ExpectedCellValue(sheetName, 202, 10, null),
					new ExpectedCellValue(sheetName, 203, 10, null),
					new ExpectedCellValue(sheetName, 204, 10, null),
					new ExpectedCellValue(sheetName, 205, 10, null),
					new ExpectedCellValue(sheetName, 206, 10, null),
					new ExpectedCellValue(sheetName, 207, 10, null),
					new ExpectedCellValue(sheetName, 208, 10, null),
					new ExpectedCellValue(sheetName, 209, 10, null),
					new ExpectedCellValue(sheetName, 210, 10, null),
					new ExpectedCellValue(sheetName, 211, 10, null),
					new ExpectedCellValue(sheetName, 212, 10, null),
					new ExpectedCellValue(sheetName, 213, 10, null),
					new ExpectedCellValue(sheetName, 214, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 215, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 217, 10, null),
					new ExpectedCellValue(sheetName, 218, 10, null),
					new ExpectedCellValue(sheetName, 219, 10, null),
					new ExpectedCellValue(sheetName, 220, 10, null),
					new ExpectedCellValue(sheetName, 221, 10, null),
					new ExpectedCellValue(sheetName, 222, 10, null),
					new ExpectedCellValue(sheetName, 223, 10, null),
					new ExpectedCellValue(sheetName, 224, 10, null),
					new ExpectedCellValue(sheetName, 225, 10, null),
					new ExpectedCellValue(sheetName, 226, 10, null),
					new ExpectedCellValue(sheetName, 227, 10, null),
					new ExpectedCellValue(sheetName, 228, 10, null),
					new ExpectedCellValue(sheetName, 229, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 230, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 231, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 232, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 11, "Month"),
					new ExpectedCellValue(sheetName, 180, 11, null),
					new ExpectedCellValue(sheetName, 181, 11, "January"),
					new ExpectedCellValue(sheetName, 182, 11, null),
					new ExpectedCellValue(sheetName, 183, 11, null),
					new ExpectedCellValue(sheetName, 184, 11, null),
					new ExpectedCellValue(sheetName, 185, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 186, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 187, 11, "March"),
					new ExpectedCellValue(sheetName, 188, 11, null),
					new ExpectedCellValue(sheetName, 189, 11, null),
					new ExpectedCellValue(sheetName, 190, 11, null),
					new ExpectedCellValue(sheetName, 191, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 192, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 193, 11, null),
					new ExpectedCellValue(sheetName, 194, 11, null),
					new ExpectedCellValue(sheetName, 195, 11, null),
					new ExpectedCellValue(sheetName, 196, 11, "January"),
					new ExpectedCellValue(sheetName, 197, 11, null),
					new ExpectedCellValue(sheetName, 198, 11, null),
					new ExpectedCellValue(sheetName, 199, 11, null),
					new ExpectedCellValue(sheetName, 200, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 201, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 11, "February"),
					new ExpectedCellValue(sheetName, 203, 11, null),
					new ExpectedCellValue(sheetName, 204, 11, null),
					new ExpectedCellValue(sheetName, 205, 11, null),
					new ExpectedCellValue(sheetName, 206, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 208, 11, "March"),
					new ExpectedCellValue(sheetName, 209, 11, null),
					new ExpectedCellValue(sheetName, 210, 11, null),
					new ExpectedCellValue(sheetName, 211, 11, null),
					new ExpectedCellValue(sheetName, 212, 11, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 213, 11, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 214, 11, null),
					new ExpectedCellValue(sheetName, 215, 11, null),
					new ExpectedCellValue(sheetName, 216, 11, null),
					new ExpectedCellValue(sheetName, 217, 11, "January"),
					new ExpectedCellValue(sheetName, 218, 11, null),
					new ExpectedCellValue(sheetName, 219, 11, null),
					new ExpectedCellValue(sheetName, 220, 11, null),
					new ExpectedCellValue(sheetName, 221, 11, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 222, 11, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 223, 11, "February"),
					new ExpectedCellValue(sheetName, 224, 11, null),
					new ExpectedCellValue(sheetName, 225, 11, null),
					new ExpectedCellValue(sheetName, 226, 11, null),
					new ExpectedCellValue(sheetName, 227, 11, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 228, 11, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 229, 11, null),
					new ExpectedCellValue(sheetName, 230, 11, null),
					new ExpectedCellValue(sheetName, 231, 11, null),
					new ExpectedCellValue(sheetName, 232, 11, null),
					new ExpectedCellValue(sheetName, 179, 12, "Values"),
					new ExpectedCellValue(sheetName, 180, 12, null),
					new ExpectedCellValue(sheetName, 181, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 182, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 183, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 184, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 185, 12, null),
					new ExpectedCellValue(sheetName, 186, 12, null),
					new ExpectedCellValue(sheetName, 187, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 188, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 190, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 12, null),
					new ExpectedCellValue(sheetName, 192, 12, null),
					new ExpectedCellValue(sheetName, 193, 12, null),
					new ExpectedCellValue(sheetName, 194, 12, null),
					new ExpectedCellValue(sheetName, 195, 12, null),
					new ExpectedCellValue(sheetName, 196, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 197, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 198, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 199, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 200, 12, null),
					new ExpectedCellValue(sheetName, 201, 12, null),
					new ExpectedCellValue(sheetName, 202, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 203, 12, "Tent"),
					new ExpectedCellValue(sheetName, 204, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 205, 12, "Tent"),
					new ExpectedCellValue(sheetName, 206, 12, null),
					new ExpectedCellValue(sheetName, 207, 12, null),
					new ExpectedCellValue(sheetName, 208, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 209, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 210, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 211, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 212, 12, null),
					new ExpectedCellValue(sheetName, 213, 12, null),
					new ExpectedCellValue(sheetName, 214, 12, null),
					new ExpectedCellValue(sheetName, 215, 12, null),
					new ExpectedCellValue(sheetName, 216, 12, null),
					new ExpectedCellValue(sheetName, 217, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 219, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 220, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 221, 12, null),
					new ExpectedCellValue(sheetName, 222, 12, null),
					new ExpectedCellValue(sheetName, 223, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 225, 12, "Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 227, 12, null),
					new ExpectedCellValue(sheetName, 228, 12, null),
					new ExpectedCellValue(sheetName, 229, 12, null),
					new ExpectedCellValue(sheetName, 230, 12, null),
					new ExpectedCellValue(sheetName, 231, 12, null),
					new ExpectedCellValue(sheetName, 232, 12, null),
					new ExpectedCellValue(sheetName, 179, 13, null),
					new ExpectedCellValue(sheetName, 180, 13, null),
					new ExpectedCellValue(sheetName, 181, 13, null),
					new ExpectedCellValue(sheetName, 182, 13, 415.75),
					new ExpectedCellValue(sheetName, 183, 13, null),
					new ExpectedCellValue(sheetName, 184, 13, 831.5),
					new ExpectedCellValue(sheetName, 185, 13, 415.75),
					new ExpectedCellValue(sheetName, 186, 13, 831.5),
					new ExpectedCellValue(sheetName, 187, 13, null),
					new ExpectedCellValue(sheetName, 188, 13, 24.99),
					new ExpectedCellValue(sheetName, 189, 13, null),
					new ExpectedCellValue(sheetName, 190, 13, 24.99),
					new ExpectedCellValue(sheetName, 191, 13, 24.99),
					new ExpectedCellValue(sheetName, 192, 13, 24.99),
					new ExpectedCellValue(sheetName, 193, 13, 440.74),
					new ExpectedCellValue(sheetName, 194, 13, 856.49),
					new ExpectedCellValue(sheetName, 195, 13, null),
					new ExpectedCellValue(sheetName, 196, 13, null),
					new ExpectedCellValue(sheetName, 197, 13, 415.75),
					new ExpectedCellValue(sheetName, 198, 13, null),
					new ExpectedCellValue(sheetName, 199, 13, 831.5),
					new ExpectedCellValue(sheetName, 200, 13, 415.75),
					new ExpectedCellValue(sheetName, 201, 13, 831.5),
					new ExpectedCellValue(sheetName, 202, 13, null),
					new ExpectedCellValue(sheetName, 203, 13, 199d),
					new ExpectedCellValue(sheetName, 204, 13, null),
					new ExpectedCellValue(sheetName, 205, 13, 1194d),
					new ExpectedCellValue(sheetName, 206, 13, 199d),
					new ExpectedCellValue(sheetName, 207, 13, 1194d),
					new ExpectedCellValue(sheetName, 208, 13, null),
					new ExpectedCellValue(sheetName, 209, 13, 415.75),
					new ExpectedCellValue(sheetName, 210, 13, null),
					new ExpectedCellValue(sheetName, 211, 13, 831.5),
					new ExpectedCellValue(sheetName, 212, 13, 415.75),
					new ExpectedCellValue(sheetName, 213, 13, 831.5),
					new ExpectedCellValue(sheetName, 214, 13, 1030.5),
					new ExpectedCellValue(sheetName, 215, 13, 2857d),
					new ExpectedCellValue(sheetName, 216, 13, null),
					new ExpectedCellValue(sheetName, 217, 13, null),
					new ExpectedCellValue(sheetName, 218, 13, 415.75),
					new ExpectedCellValue(sheetName, 219, 13, null),
					new ExpectedCellValue(sheetName, 220, 13, 415.75),
					new ExpectedCellValue(sheetName, 221, 13, 415.75),
					new ExpectedCellValue(sheetName, 222, 13, 415.75),
					new ExpectedCellValue(sheetName, 223, 13, null),
					new ExpectedCellValue(sheetName, 224, 13, 99d),
					new ExpectedCellValue(sheetName, 225, 13, null),
					new ExpectedCellValue(sheetName, 226, 13, 99d),
					new ExpectedCellValue(sheetName, 227, 13, 99d),
					new ExpectedCellValue(sheetName, 228, 13, 99d),
					new ExpectedCellValue(sheetName, 229, 13, 514.75),
					new ExpectedCellValue(sheetName, 230, 13, 514.75),
					new ExpectedCellValue(sheetName, 231, 13, 1985.99),
					new ExpectedCellValue(sheetName, 232, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndSecondFieldsTabularLastFieldThirdFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q179:T219"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 17, null),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, null),
					new ExpectedCellValue(sheetName, 184, 17, null),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 186, 17, null),
					new ExpectedCellValue(sheetName, 187, 17, null),
					new ExpectedCellValue(sheetName, 188, 17, null),
					new ExpectedCellValue(sheetName, 189, 17, null),
					new ExpectedCellValue(sheetName, 190, 17, null),
					new ExpectedCellValue(sheetName, 191, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 192, 17, null),
					new ExpectedCellValue(sheetName, 193, 17, null),
					new ExpectedCellValue(sheetName, 194, 17, null),
					new ExpectedCellValue(sheetName, 195, 17, null),
					new ExpectedCellValue(sheetName, 196, 17, null),
					new ExpectedCellValue(sheetName, 197, 17, null),
					new ExpectedCellValue(sheetName, 198, 17, null),
					new ExpectedCellValue(sheetName, 199, 17, null),
					new ExpectedCellValue(sheetName, 200, 17, null),
					new ExpectedCellValue(sheetName, 201, 17, null),
					new ExpectedCellValue(sheetName, 202, 17, null),
					new ExpectedCellValue(sheetName, 203, 17, null),
					new ExpectedCellValue(sheetName, 204, 17, null),
					new ExpectedCellValue(sheetName, 205, 17, null),
					new ExpectedCellValue(sheetName, 206, 17, null),
					new ExpectedCellValue(sheetName, 207, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 208, 17, null),
					new ExpectedCellValue(sheetName, 209, 17, null),
					new ExpectedCellValue(sheetName, 210, 17, null),
					new ExpectedCellValue(sheetName, 211, 17, null),
					new ExpectedCellValue(sheetName, 212, 17, null),
					new ExpectedCellValue(sheetName, 213, 17, null),
					new ExpectedCellValue(sheetName, 214, 17, null),
					new ExpectedCellValue(sheetName, 215, 17, null),
					new ExpectedCellValue(sheetName, 216, 17, null),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 218, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 219, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 18, "Month"),
					new ExpectedCellValue(sheetName, 180, 18, null),
					new ExpectedCellValue(sheetName, 181, 18, "January"),
					new ExpectedCellValue(sheetName, 182, 18, null),
					new ExpectedCellValue(sheetName, 183, 18, null),
					new ExpectedCellValue(sheetName, 184, 18, null),
					new ExpectedCellValue(sheetName, 185, 18, null),
					new ExpectedCellValue(sheetName, 186, 18, "March"),
					new ExpectedCellValue(sheetName, 187, 18, null),
					new ExpectedCellValue(sheetName, 188, 18, null),
					new ExpectedCellValue(sheetName, 189, 18, null),
					new ExpectedCellValue(sheetName, 190, 18, null),
					new ExpectedCellValue(sheetName, 191, 18, null),
					new ExpectedCellValue(sheetName, 192, 18, "January"),
					new ExpectedCellValue(sheetName, 193, 18, null),
					new ExpectedCellValue(sheetName, 194, 18, null),
					new ExpectedCellValue(sheetName, 195, 18, null),
					new ExpectedCellValue(sheetName, 196, 18, null),
					new ExpectedCellValue(sheetName, 197, 18, "February"),
					new ExpectedCellValue(sheetName, 198, 18, null),
					new ExpectedCellValue(sheetName, 199, 18, null),
					new ExpectedCellValue(sheetName, 200, 18, null),
					new ExpectedCellValue(sheetName, 201, 18, null),
					new ExpectedCellValue(sheetName, 202, 18, "March"),
					new ExpectedCellValue(sheetName, 203, 18, null),
					new ExpectedCellValue(sheetName, 204, 18, null),
					new ExpectedCellValue(sheetName, 205, 18, null),
					new ExpectedCellValue(sheetName, 206, 18, null),
					new ExpectedCellValue(sheetName, 207, 18, null),
					new ExpectedCellValue(sheetName, 208, 18, "January"),
					new ExpectedCellValue(sheetName, 209, 18, null),
					new ExpectedCellValue(sheetName, 210, 18, null),
					new ExpectedCellValue(sheetName, 211, 18, null),
					new ExpectedCellValue(sheetName, 212, 18, null),
					new ExpectedCellValue(sheetName, 213, 18, "February"),
					new ExpectedCellValue(sheetName, 214, 18, null),
					new ExpectedCellValue(sheetName, 215, 18, null),
					new ExpectedCellValue(sheetName, 216, 18, null),
					new ExpectedCellValue(sheetName, 217, 18, null),
					new ExpectedCellValue(sheetName, 218, 18, null),
					new ExpectedCellValue(sheetName, 219, 18, null),
					new ExpectedCellValue(sheetName, 179, 19, "Values"),
					new ExpectedCellValue(sheetName, 180, 19, null),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 183, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 184, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 185, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 186, 19, null),
					new ExpectedCellValue(sheetName, 187, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 188, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 189, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 190, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 19, null),
					new ExpectedCellValue(sheetName, 192, 19, null),
					new ExpectedCellValue(sheetName, 193, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 195, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 196, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 197, 19, null),
					new ExpectedCellValue(sheetName, 198, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 199, 19, "Tent"),
					new ExpectedCellValue(sheetName, 200, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 201, 19, "Tent"),
					new ExpectedCellValue(sheetName, 202, 19, null),
					new ExpectedCellValue(sheetName, 203, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 204, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 205, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 206, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 207, 19, null),
					new ExpectedCellValue(sheetName, 208, 19, null),
					new ExpectedCellValue(sheetName, 209, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 210, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 211, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 212, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 213, 19, null),
					new ExpectedCellValue(sheetName, 214, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 215, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 216, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 217, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 218, 19, null),
					new ExpectedCellValue(sheetName, 219, 19, null),
					new ExpectedCellValue(sheetName, 179, 20, null),
					new ExpectedCellValue(sheetName, 180, 20, null),
					new ExpectedCellValue(sheetName, 181, 20, null),
					new ExpectedCellValue(sheetName, 182, 20, null),
					new ExpectedCellValue(sheetName, 183, 20, 415.75),
					new ExpectedCellValue(sheetName, 184, 20, null),
					new ExpectedCellValue(sheetName, 185, 20, 831.5),
					new ExpectedCellValue(sheetName, 186, 20, null),
					new ExpectedCellValue(sheetName, 187, 20, null),
					new ExpectedCellValue(sheetName, 188, 20, 24.99),
					new ExpectedCellValue(sheetName, 189, 20, null),
					new ExpectedCellValue(sheetName, 190, 20, 24.99),
					new ExpectedCellValue(sheetName, 191, 20, null),
					new ExpectedCellValue(sheetName, 192, 20, null),
					new ExpectedCellValue(sheetName, 193, 20, null),
					new ExpectedCellValue(sheetName, 194, 20, 415.75),
					new ExpectedCellValue(sheetName, 195, 20, null),
					new ExpectedCellValue(sheetName, 196, 20, 831.5),
					new ExpectedCellValue(sheetName, 197, 20, null),
					new ExpectedCellValue(sheetName, 198, 20, null),
					new ExpectedCellValue(sheetName, 199, 20, 199d),
					new ExpectedCellValue(sheetName, 200, 20, null),
					new ExpectedCellValue(sheetName, 201, 20, 1194d),
					new ExpectedCellValue(sheetName, 202, 20, null),
					new ExpectedCellValue(sheetName, 203, 20, null),
					new ExpectedCellValue(sheetName, 204, 20, 415.75),
					new ExpectedCellValue(sheetName, 205, 20, null),
					new ExpectedCellValue(sheetName, 206, 20, 831.5),
					new ExpectedCellValue(sheetName, 207, 20, null),
					new ExpectedCellValue(sheetName, 208, 20, null),
					new ExpectedCellValue(sheetName, 209, 20, null),
					new ExpectedCellValue(sheetName, 210, 20, 415.75),
					new ExpectedCellValue(sheetName, 211, 20, null),
					new ExpectedCellValue(sheetName, 212, 20, 415.75),
					new ExpectedCellValue(sheetName, 213, 20, null),
					new ExpectedCellValue(sheetName, 214, 20, null),
					new ExpectedCellValue(sheetName, 215, 20, 99d),
					new ExpectedCellValue(sheetName, 216, 20, null),
					new ExpectedCellValue(sheetName, 217, 20, 99d),
					new ExpectedCellValue(sheetName, 218, 20, 1985.99),
					new ExpectedCellValue(sheetName, 219, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndSecondFieldsTabularLastFieldThirdFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q179:T239"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 17, null),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, null),
					new ExpectedCellValue(sheetName, 184, 17, null),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 186, 17, null),
					new ExpectedCellValue(sheetName, 187, 17, null),
					new ExpectedCellValue(sheetName, 188, 17, null),
					new ExpectedCellValue(sheetName, 189, 17, null),
					new ExpectedCellValue(sheetName, 190, 17, null),
					new ExpectedCellValue(sheetName, 191, 17, null),
					new ExpectedCellValue(sheetName, 192, 17, null),
					new ExpectedCellValue(sheetName, 193, 17, null),
					new ExpectedCellValue(sheetName, 194, 17, null),
					new ExpectedCellValue(sheetName, 195, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 196, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 197, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 198, 17, null),
					new ExpectedCellValue(sheetName, 199, 17, null),
					new ExpectedCellValue(sheetName, 200, 17, null),
					new ExpectedCellValue(sheetName, 201, 17, null),
					new ExpectedCellValue(sheetName, 202, 17, null),
					new ExpectedCellValue(sheetName, 203, 17, null),
					new ExpectedCellValue(sheetName, 204, 17, null),
					new ExpectedCellValue(sheetName, 205, 17, null),
					new ExpectedCellValue(sheetName, 206, 17, null),
					new ExpectedCellValue(sheetName, 207, 17, null),
					new ExpectedCellValue(sheetName, 208, 17, null),
					new ExpectedCellValue(sheetName, 209, 17, null),
					new ExpectedCellValue(sheetName, 210, 17, null),
					new ExpectedCellValue(sheetName, 211, 17, null),
					new ExpectedCellValue(sheetName, 212, 17, null),
					new ExpectedCellValue(sheetName, 213, 17, null),
					new ExpectedCellValue(sheetName, 214, 17, null),
					new ExpectedCellValue(sheetName, 215, 17, null),
					new ExpectedCellValue(sheetName, 216, 17, null),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 218, 17, null),
					new ExpectedCellValue(sheetName, 219, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 220, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 221, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 222, 17, null),
					new ExpectedCellValue(sheetName, 223, 17, null),
					new ExpectedCellValue(sheetName, 224, 17, null),
					new ExpectedCellValue(sheetName, 225, 17, null),
					new ExpectedCellValue(sheetName, 226, 17, null),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 228, 17, null),
					new ExpectedCellValue(sheetName, 229, 17, null),
					new ExpectedCellValue(sheetName, 230, 17, null),
					new ExpectedCellValue(sheetName, 231, 17, null),
					new ExpectedCellValue(sheetName, 232, 17, null),
					new ExpectedCellValue(sheetName, 233, 17, null),
					new ExpectedCellValue(sheetName, 234, 17, null),
					new ExpectedCellValue(sheetName, 235, 17, null),
					new ExpectedCellValue(sheetName, 236, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 237, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 238, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 239, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 18, "Month"),
					new ExpectedCellValue(sheetName, 180, 18, null),
					new ExpectedCellValue(sheetName, 181, 18, "January"),
					new ExpectedCellValue(sheetName, 182, 18, null),
					new ExpectedCellValue(sheetName, 183, 18, null),
					new ExpectedCellValue(sheetName, 184, 18, null),
					new ExpectedCellValue(sheetName, 185, 18, null),
					new ExpectedCellValue(sheetName, 186, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 187, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 188, 18, "March"),
					new ExpectedCellValue(sheetName, 189, 18, null),
					new ExpectedCellValue(sheetName, 190, 18, null),
					new ExpectedCellValue(sheetName, 191, 18, null),
					new ExpectedCellValue(sheetName, 192, 18, null),
					new ExpectedCellValue(sheetName, 193, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 18, null),
					new ExpectedCellValue(sheetName, 196, 18, null),
					new ExpectedCellValue(sheetName, 197, 18, null),
					new ExpectedCellValue(sheetName, 198, 18, "January"),
					new ExpectedCellValue(sheetName, 199, 18, null),
					new ExpectedCellValue(sheetName, 200, 18, null),
					new ExpectedCellValue(sheetName, 201, 18, null),
					new ExpectedCellValue(sheetName, 202, 18, null),
					new ExpectedCellValue(sheetName, 203, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 204, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 205, 18, "February"),
					new ExpectedCellValue(sheetName, 206, 18, null),
					new ExpectedCellValue(sheetName, 207, 18, null),
					new ExpectedCellValue(sheetName, 208, 18, null),
					new ExpectedCellValue(sheetName, 209, 18, null),
					new ExpectedCellValue(sheetName, 210, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 211, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 212, 18, "March"),
					new ExpectedCellValue(sheetName, 213, 18, null),
					new ExpectedCellValue(sheetName, 214, 18, null),
					new ExpectedCellValue(sheetName, 215, 18, null),
					new ExpectedCellValue(sheetName, 216, 18, null),
					new ExpectedCellValue(sheetName, 217, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 219, 18, null),
					new ExpectedCellValue(sheetName, 220, 18, null),
					new ExpectedCellValue(sheetName, 221, 18, null),
					new ExpectedCellValue(sheetName, 222, 18, "January"),
					new ExpectedCellValue(sheetName, 223, 18, null),
					new ExpectedCellValue(sheetName, 224, 18, null),
					new ExpectedCellValue(sheetName, 225, 18, null),
					new ExpectedCellValue(sheetName, 226, 18, null),
					new ExpectedCellValue(sheetName, 227, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 228, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 229, 18, "February"),
					new ExpectedCellValue(sheetName, 230, 18, null),
					new ExpectedCellValue(sheetName, 231, 18, null),
					new ExpectedCellValue(sheetName, 232, 18, null),
					new ExpectedCellValue(sheetName, 233, 18, null),
					new ExpectedCellValue(sheetName, 234, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 235, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 236, 18, null),
					new ExpectedCellValue(sheetName, 237, 18, null),
					new ExpectedCellValue(sheetName, 238, 18, null),
					new ExpectedCellValue(sheetName, 239, 18, null),
					new ExpectedCellValue(sheetName, 179, 19, "Values"),
					new ExpectedCellValue(sheetName, 180, 19, null),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 183, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 184, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 185, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 186, 19, null),
					new ExpectedCellValue(sheetName, 187, 19, null),
					new ExpectedCellValue(sheetName, 188, 19, null),
					new ExpectedCellValue(sheetName, 189, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 190, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 193, 19, null),
					new ExpectedCellValue(sheetName, 194, 19, null),
					new ExpectedCellValue(sheetName, 195, 19, null),
					new ExpectedCellValue(sheetName, 196, 19, null),
					new ExpectedCellValue(sheetName, 197, 19, null),
					new ExpectedCellValue(sheetName, 198, 19, null),
					new ExpectedCellValue(sheetName, 199, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 200, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 201, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 203, 19, null),
					new ExpectedCellValue(sheetName, 204, 19, null),
					new ExpectedCellValue(sheetName, 205, 19, null),
					new ExpectedCellValue(sheetName, 206, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 19, "Tent"),
					new ExpectedCellValue(sheetName, 208, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 209, 19, "Tent"),
					new ExpectedCellValue(sheetName, 210, 19, null),
					new ExpectedCellValue(sheetName, 211, 19, null),
					new ExpectedCellValue(sheetName, 212, 19, null),
					new ExpectedCellValue(sheetName, 213, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 214, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 215, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 217, 19, null),
					new ExpectedCellValue(sheetName, 218, 19, null),
					new ExpectedCellValue(sheetName, 219, 19, null),
					new ExpectedCellValue(sheetName, 220, 19, null),
					new ExpectedCellValue(sheetName, 221, 19, null),
					new ExpectedCellValue(sheetName, 222, 19, null),
					new ExpectedCellValue(sheetName, 223, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 225, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 227, 19, null),
					new ExpectedCellValue(sheetName, 228, 19, null),
					new ExpectedCellValue(sheetName, 229, 19, null),
					new ExpectedCellValue(sheetName, 230, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 231, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 232, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 233, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 234, 19, null),
					new ExpectedCellValue(sheetName, 235, 19, null),
					new ExpectedCellValue(sheetName, 236, 19, null),
					new ExpectedCellValue(sheetName, 237, 19, null),
					new ExpectedCellValue(sheetName, 238, 19, null),
					new ExpectedCellValue(sheetName, 239, 19, null),
					new ExpectedCellValue(sheetName, 179, 20, null),
					new ExpectedCellValue(sheetName, 180, 20, null),
					new ExpectedCellValue(sheetName, 181, 20, null),
					new ExpectedCellValue(sheetName, 182, 20, null),
					new ExpectedCellValue(sheetName, 183, 20, 415.75),
					new ExpectedCellValue(sheetName, 184, 20, null),
					new ExpectedCellValue(sheetName, 185, 20, 831.5),
					new ExpectedCellValue(sheetName, 186, 20, 415.75),
					new ExpectedCellValue(sheetName, 187, 20, 831.5),
					new ExpectedCellValue(sheetName, 188, 20, null),
					new ExpectedCellValue(sheetName, 189, 20, null),
					new ExpectedCellValue(sheetName, 190, 20, 24.99),
					new ExpectedCellValue(sheetName, 191, 20, null),
					new ExpectedCellValue(sheetName, 192, 20, 24.99),
					new ExpectedCellValue(sheetName, 193, 20, 24.99),
					new ExpectedCellValue(sheetName, 194, 20, 24.99),
					new ExpectedCellValue(sheetName, 195, 20, 440.74),
					new ExpectedCellValue(sheetName, 196, 20, 856.49),
					new ExpectedCellValue(sheetName, 197, 20, null),
					new ExpectedCellValue(sheetName, 198, 20, null),
					new ExpectedCellValue(sheetName, 199, 20, null),
					new ExpectedCellValue(sheetName, 200, 20, 415.75),
					new ExpectedCellValue(sheetName, 201, 20, null),
					new ExpectedCellValue(sheetName, 202, 20, 831.5),
					new ExpectedCellValue(sheetName, 203, 20, 415.75),
					new ExpectedCellValue(sheetName, 204, 20, 831.5),
					new ExpectedCellValue(sheetName, 205, 20, null),
					new ExpectedCellValue(sheetName, 206, 20, null),
					new ExpectedCellValue(sheetName, 207, 20, 199d),
					new ExpectedCellValue(sheetName, 208, 20, null),
					new ExpectedCellValue(sheetName, 209, 20, 1194d),
					new ExpectedCellValue(sheetName, 210, 20, 199d),
					new ExpectedCellValue(sheetName, 211, 20, 1194d),
					new ExpectedCellValue(sheetName, 212, 20, null),
					new ExpectedCellValue(sheetName, 213, 20, null),
					new ExpectedCellValue(sheetName, 214, 20, 415.75),
					new ExpectedCellValue(sheetName, 215, 20, null),
					new ExpectedCellValue(sheetName, 216, 20, 831.5),
					new ExpectedCellValue(sheetName, 217, 20, 415.75),
					new ExpectedCellValue(sheetName, 218, 20, 831.5),
					new ExpectedCellValue(sheetName, 219, 20, 1030.5),
					new ExpectedCellValue(sheetName, 220, 20, 2857d),
					new ExpectedCellValue(sheetName, 221, 20, null),
					new ExpectedCellValue(sheetName, 222, 20, null),
					new ExpectedCellValue(sheetName, 223, 20, null),
					new ExpectedCellValue(sheetName, 224, 20, 415.75),
					new ExpectedCellValue(sheetName, 225, 20, null),
					new ExpectedCellValue(sheetName, 226, 20, 415.75),
					new ExpectedCellValue(sheetName, 227, 20, 415.75),
					new ExpectedCellValue(sheetName, 228, 20, 415.75),
					new ExpectedCellValue(sheetName, 229, 20, null),
					new ExpectedCellValue(sheetName, 230, 20, null),
					new ExpectedCellValue(sheetName, 231, 20, 99d),
					new ExpectedCellValue(sheetName, 232, 20, null),
					new ExpectedCellValue(sheetName, 233, 20, 99d),
					new ExpectedCellValue(sheetName, 234, 20, 99d),
					new ExpectedCellValue(sheetName, 235, 20, 99d),
					new ExpectedCellValue(sheetName, 236, 20, 514.75),
					new ExpectedCellValue(sheetName, 237, 20, 514.75),
					new ExpectedCellValue(sheetName, 238, 20, 1985.99),
					new ExpectedCellValue(sheetName, 239, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndSecondFieldsTabularLastFieldThirdFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable12"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q179:T239"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 179, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 180, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 181, 17, null),
					new ExpectedCellValue(sheetName, 182, 17, null),
					new ExpectedCellValue(sheetName, 183, 17, null),
					new ExpectedCellValue(sheetName, 184, 17, null),
					new ExpectedCellValue(sheetName, 185, 17, null),
					new ExpectedCellValue(sheetName, 186, 17, null),
					new ExpectedCellValue(sheetName, 187, 17, null),
					new ExpectedCellValue(sheetName, 188, 17, null),
					new ExpectedCellValue(sheetName, 189, 17, null),
					new ExpectedCellValue(sheetName, 190, 17, null),
					new ExpectedCellValue(sheetName, 191, 17, null),
					new ExpectedCellValue(sheetName, 192, 17, null),
					new ExpectedCellValue(sheetName, 193, 17, null),
					new ExpectedCellValue(sheetName, 194, 17, null),
					new ExpectedCellValue(sheetName, 195, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 196, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 197, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 198, 17, null),
					new ExpectedCellValue(sheetName, 199, 17, null),
					new ExpectedCellValue(sheetName, 200, 17, null),
					new ExpectedCellValue(sheetName, 201, 17, null),
					new ExpectedCellValue(sheetName, 202, 17, null),
					new ExpectedCellValue(sheetName, 203, 17, null),
					new ExpectedCellValue(sheetName, 204, 17, null),
					new ExpectedCellValue(sheetName, 205, 17, null),
					new ExpectedCellValue(sheetName, 206, 17, null),
					new ExpectedCellValue(sheetName, 207, 17, null),
					new ExpectedCellValue(sheetName, 208, 17, null),
					new ExpectedCellValue(sheetName, 209, 17, null),
					new ExpectedCellValue(sheetName, 210, 17, null),
					new ExpectedCellValue(sheetName, 211, 17, null),
					new ExpectedCellValue(sheetName, 212, 17, null),
					new ExpectedCellValue(sheetName, 213, 17, null),
					new ExpectedCellValue(sheetName, 214, 17, null),
					new ExpectedCellValue(sheetName, 215, 17, null),
					new ExpectedCellValue(sheetName, 216, 17, null),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 218, 17, null),
					new ExpectedCellValue(sheetName, 219, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 220, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 221, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 222, 17, null),
					new ExpectedCellValue(sheetName, 223, 17, null),
					new ExpectedCellValue(sheetName, 224, 17, null),
					new ExpectedCellValue(sheetName, 225, 17, null),
					new ExpectedCellValue(sheetName, 226, 17, null),
					new ExpectedCellValue(sheetName, 217, 17, null),
					new ExpectedCellValue(sheetName, 228, 17, null),
					new ExpectedCellValue(sheetName, 229, 17, null),
					new ExpectedCellValue(sheetName, 230, 17, null),
					new ExpectedCellValue(sheetName, 231, 17, null),
					new ExpectedCellValue(sheetName, 232, 17, null),
					new ExpectedCellValue(sheetName, 233, 17, null),
					new ExpectedCellValue(sheetName, 234, 17, null),
					new ExpectedCellValue(sheetName, 235, 17, null),
					new ExpectedCellValue(sheetName, 236, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 237, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 238, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 239, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 179, 18, "Month"),
					new ExpectedCellValue(sheetName, 180, 18, null),
					new ExpectedCellValue(sheetName, 181, 18, "January"),
					new ExpectedCellValue(sheetName, 182, 18, null),
					new ExpectedCellValue(sheetName, 183, 18, null),
					new ExpectedCellValue(sheetName, 184, 18, null),
					new ExpectedCellValue(sheetName, 185, 18, null),
					new ExpectedCellValue(sheetName, 186, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 187, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 188, 18, "March"),
					new ExpectedCellValue(sheetName, 189, 18, null),
					new ExpectedCellValue(sheetName, 190, 18, null),
					new ExpectedCellValue(sheetName, 191, 18, null),
					new ExpectedCellValue(sheetName, 192, 18, null),
					new ExpectedCellValue(sheetName, 193, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 194, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 195, 18, null),
					new ExpectedCellValue(sheetName, 196, 18, null),
					new ExpectedCellValue(sheetName, 197, 18, null),
					new ExpectedCellValue(sheetName, 198, 18, "January"),
					new ExpectedCellValue(sheetName, 199, 18, null),
					new ExpectedCellValue(sheetName, 200, 18, null),
					new ExpectedCellValue(sheetName, 201, 18, null),
					new ExpectedCellValue(sheetName, 202, 18, null),
					new ExpectedCellValue(sheetName, 203, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 204, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 205, 18, "February"),
					new ExpectedCellValue(sheetName, 206, 18, null),
					new ExpectedCellValue(sheetName, 207, 18, null),
					new ExpectedCellValue(sheetName, 208, 18, null),
					new ExpectedCellValue(sheetName, 209, 18, null),
					new ExpectedCellValue(sheetName, 210, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 211, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 212, 18, "March"),
					new ExpectedCellValue(sheetName, 213, 18, null),
					new ExpectedCellValue(sheetName, 214, 18, null),
					new ExpectedCellValue(sheetName, 215, 18, null),
					new ExpectedCellValue(sheetName, 216, 18, null),
					new ExpectedCellValue(sheetName, 217, 18, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 218, 18, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 219, 18, null),
					new ExpectedCellValue(sheetName, 220, 18, null),
					new ExpectedCellValue(sheetName, 221, 18, null),
					new ExpectedCellValue(sheetName, 222, 18, "January"),
					new ExpectedCellValue(sheetName, 223, 18, null),
					new ExpectedCellValue(sheetName, 224, 18, null),
					new ExpectedCellValue(sheetName, 225, 18, null),
					new ExpectedCellValue(sheetName, 226, 18, null),
					new ExpectedCellValue(sheetName, 227, 18, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 228, 18, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 229, 18, "February"),
					new ExpectedCellValue(sheetName, 230, 18, null),
					new ExpectedCellValue(sheetName, 231, 18, null),
					new ExpectedCellValue(sheetName, 232, 18, null),
					new ExpectedCellValue(sheetName, 233, 18, null),
					new ExpectedCellValue(sheetName, 234, 18, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 235, 18, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 236, 18, null),
					new ExpectedCellValue(sheetName, 237, 18, null),
					new ExpectedCellValue(sheetName, 238, 18, null),
					new ExpectedCellValue(sheetName, 239, 18, null),
					new ExpectedCellValue(sheetName, 179, 19, "Values"),
					new ExpectedCellValue(sheetName, 180, 19, null),
					new ExpectedCellValue(sheetName, 181, 19, null),
					new ExpectedCellValue(sheetName, 182, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 183, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 184, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 185, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 186, 19, null),
					new ExpectedCellValue(sheetName, 187, 19, null),
					new ExpectedCellValue(sheetName, 188, 19, null),
					new ExpectedCellValue(sheetName, 189, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 190, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 191, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 192, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 193, 19, null),
					new ExpectedCellValue(sheetName, 194, 19, null),
					new ExpectedCellValue(sheetName, 195, 19, null),
					new ExpectedCellValue(sheetName, 196, 19, null),
					new ExpectedCellValue(sheetName, 197, 19, null),
					new ExpectedCellValue(sheetName, 198, 19, null),
					new ExpectedCellValue(sheetName, 199, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 200, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 201, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 202, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 203, 19, null),
					new ExpectedCellValue(sheetName, 204, 19, null),
					new ExpectedCellValue(sheetName, 205, 19, null),
					new ExpectedCellValue(sheetName, 206, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 207, 19, "Tent"),
					new ExpectedCellValue(sheetName, 208, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 209, 19, "Tent"),
					new ExpectedCellValue(sheetName, 210, 19, null),
					new ExpectedCellValue(sheetName, 211, 19, null),
					new ExpectedCellValue(sheetName, 212, 19, null),
					new ExpectedCellValue(sheetName, 213, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 214, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 215, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 216, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 217, 19, null),
					new ExpectedCellValue(sheetName, 218, 19, null),
					new ExpectedCellValue(sheetName, 219, 19, null),
					new ExpectedCellValue(sheetName, 220, 19, null),
					new ExpectedCellValue(sheetName, 221, 19, null),
					new ExpectedCellValue(sheetName, 222, 19, null),
					new ExpectedCellValue(sheetName, 223, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 224, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 225, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 226, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 227, 19, null),
					new ExpectedCellValue(sheetName, 228, 19, null),
					new ExpectedCellValue(sheetName, 229, 19, null),
					new ExpectedCellValue(sheetName, 230, 19, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 231, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 232, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 233, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 234, 19, null),
					new ExpectedCellValue(sheetName, 235, 19, null),
					new ExpectedCellValue(sheetName, 236, 19, null),
					new ExpectedCellValue(sheetName, 237, 19, null),
					new ExpectedCellValue(sheetName, 238, 19, null),
					new ExpectedCellValue(sheetName, 239, 19, null),
					new ExpectedCellValue(sheetName, 179, 20, null),
					new ExpectedCellValue(sheetName, 180, 20, null),
					new ExpectedCellValue(sheetName, 181, 20, null),
					new ExpectedCellValue(sheetName, 182, 20, null),
					new ExpectedCellValue(sheetName, 183, 20, 415.75),
					new ExpectedCellValue(sheetName, 184, 20, null),
					new ExpectedCellValue(sheetName, 185, 20, 831.5),
					new ExpectedCellValue(sheetName, 186, 20, 415.75),
					new ExpectedCellValue(sheetName, 187, 20, 831.5),
					new ExpectedCellValue(sheetName, 188, 20, null),
					new ExpectedCellValue(sheetName, 189, 20, null),
					new ExpectedCellValue(sheetName, 190, 20, 24.99),
					new ExpectedCellValue(sheetName, 191, 20, null),
					new ExpectedCellValue(sheetName, 192, 20, 24.99),
					new ExpectedCellValue(sheetName, 193, 20, 24.99),
					new ExpectedCellValue(sheetName, 194, 20, 24.99),
					new ExpectedCellValue(sheetName, 195, 20, 440.74),
					new ExpectedCellValue(sheetName, 196, 20, 856.49),
					new ExpectedCellValue(sheetName, 197, 20, null),
					new ExpectedCellValue(sheetName, 198, 20, null),
					new ExpectedCellValue(sheetName, 199, 20, null),
					new ExpectedCellValue(sheetName, 200, 20, 415.75),
					new ExpectedCellValue(sheetName, 201, 20, null),
					new ExpectedCellValue(sheetName, 202, 20, 831.5),
					new ExpectedCellValue(sheetName, 203, 20, 415.75),
					new ExpectedCellValue(sheetName, 204, 20, 831.5),
					new ExpectedCellValue(sheetName, 205, 20, null),
					new ExpectedCellValue(sheetName, 206, 20, null),
					new ExpectedCellValue(sheetName, 207, 20, 199d),
					new ExpectedCellValue(sheetName, 208, 20, null),
					new ExpectedCellValue(sheetName, 209, 20, 1194d),
					new ExpectedCellValue(sheetName, 210, 20, 199d),
					new ExpectedCellValue(sheetName, 211, 20, 1194d),
					new ExpectedCellValue(sheetName, 212, 20, null),
					new ExpectedCellValue(sheetName, 213, 20, null),
					new ExpectedCellValue(sheetName, 214, 20, 415.75),
					new ExpectedCellValue(sheetName, 215, 20, null),
					new ExpectedCellValue(sheetName, 216, 20, 831.5),
					new ExpectedCellValue(sheetName, 217, 20, 415.75),
					new ExpectedCellValue(sheetName, 218, 20, 831.5),
					new ExpectedCellValue(sheetName, 219, 20, 1030.5),
					new ExpectedCellValue(sheetName, 220, 20, 2857d),
					new ExpectedCellValue(sheetName, 221, 20, null),
					new ExpectedCellValue(sheetName, 222, 20, null),
					new ExpectedCellValue(sheetName, 223, 20, null),
					new ExpectedCellValue(sheetName, 224, 20, 415.75),
					new ExpectedCellValue(sheetName, 225, 20, null),
					new ExpectedCellValue(sheetName, 226, 20, 415.75),
					new ExpectedCellValue(sheetName, 227, 20, 415.75),
					new ExpectedCellValue(sheetName, 228, 20, 415.75),
					new ExpectedCellValue(sheetName, 229, 20, null),
					new ExpectedCellValue(sheetName, 230, 20, null),
					new ExpectedCellValue(sheetName, 231, 20, 99d),
					new ExpectedCellValue(sheetName, 232, 20, null),
					new ExpectedCellValue(sheetName, 233, 20, 99d),
					new ExpectedCellValue(sheetName, 234, 20, 99d),
					new ExpectedCellValue(sheetName, 235, 20, 99d),
					new ExpectedCellValue(sheetName, 236, 20, 514.75),
					new ExpectedCellValue(sheetName, 237, 20, 514.75),
					new ExpectedCellValue(sheetName, 238, 20, 1985.99),
					new ExpectedCellValue(sheetName, 239, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndThirdFieldsNonCompactLastFieldSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C244:F266"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 3, null),
					new ExpectedCellValue(sheetName, 247, 3, null),
					new ExpectedCellValue(sheetName, 248, 3, null),
					new ExpectedCellValue(sheetName, 249, 3, null),
					new ExpectedCellValue(sheetName, 250, 3, null),
					new ExpectedCellValue(sheetName, 251, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 252, 3, null),
					new ExpectedCellValue(sheetName, 253, 3, null),
					new ExpectedCellValue(sheetName, 254, 3, null),
					new ExpectedCellValue(sheetName, 255, 3, null),
					new ExpectedCellValue(sheetName, 256, 3, null),
					new ExpectedCellValue(sheetName, 257, 3, null),
					new ExpectedCellValue(sheetName, 258, 3, null),
					new ExpectedCellValue(sheetName, 259, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 260, 3, null),
					new ExpectedCellValue(sheetName, 261, 3, null),
					new ExpectedCellValue(sheetName, 262, 3, null),
					new ExpectedCellValue(sheetName, 263, 3, null),
					new ExpectedCellValue(sheetName, 264, 3, null),
					new ExpectedCellValue(sheetName, 265, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 266, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 4, "Values"),
					new ExpectedCellValue(sheetName, 245, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 4, "January"),
					new ExpectedCellValue(sheetName, 247, 4, "March"),
					new ExpectedCellValue(sheetName, 248, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 249, 4, "January"),
					new ExpectedCellValue(sheetName, 250, 4, "March"),
					new ExpectedCellValue(sheetName, 251, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 252, 4, "January"),
					new ExpectedCellValue(sheetName, 253, 4, "February"),
					new ExpectedCellValue(sheetName, 254, 4, "March"),
					new ExpectedCellValue(sheetName, 255, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 256, 4, "January"),
					new ExpectedCellValue(sheetName, 257, 4, "February"),
					new ExpectedCellValue(sheetName, 258, 4, "March"),
					new ExpectedCellValue(sheetName, 259, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 260, 4, "January"),
					new ExpectedCellValue(sheetName, 261, 4, "February"),
					new ExpectedCellValue(sheetName, 262, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 263, 4, "January"),
					new ExpectedCellValue(sheetName, 264, 4, "February"),
					new ExpectedCellValue(sheetName, 265, 4, null),
					new ExpectedCellValue(sheetName, 266, 4, null),
					new ExpectedCellValue(sheetName, 244, 5, "Item"),
					new ExpectedCellValue(sheetName, 245, 5, null),
					new ExpectedCellValue(sheetName, 246, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 247, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 248, 5, null),
					new ExpectedCellValue(sheetName, 249, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 250, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 251, 5, null),
					new ExpectedCellValue(sheetName, 252, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 253, 5, "Tent"),
					new ExpectedCellValue(sheetName, 254, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 255, 5, null),
					new ExpectedCellValue(sheetName, 256, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 257, 5, "Tent"),
					new ExpectedCellValue(sheetName, 258, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 259, 5, null),
					new ExpectedCellValue(sheetName, 260, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 261, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 262, 5, null),
					new ExpectedCellValue(sheetName, 263, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 264, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 265, 5, null),
					new ExpectedCellValue(sheetName, 266, 5, null),
					new ExpectedCellValue(sheetName, 244, 6, null),
					new ExpectedCellValue(sheetName, 245, 6, null),
					new ExpectedCellValue(sheetName, 246, 6, 415.75),
					new ExpectedCellValue(sheetName, 247, 6, 24.99),
					new ExpectedCellValue(sheetName, 248, 6, null),
					new ExpectedCellValue(sheetName, 249, 6, 831.5),
					new ExpectedCellValue(sheetName, 250, 6, 24.99),
					new ExpectedCellValue(sheetName, 251, 6, null),
					new ExpectedCellValue(sheetName, 252, 6, 415.75),
					new ExpectedCellValue(sheetName, 253, 6, 199d),
					new ExpectedCellValue(sheetName, 254, 6, 415.75),
					new ExpectedCellValue(sheetName, 255, 6, null),
					new ExpectedCellValue(sheetName, 256, 6, 831.5),
					new ExpectedCellValue(sheetName, 257, 6, 1194d),
					new ExpectedCellValue(sheetName, 258, 6, 831.5),
					new ExpectedCellValue(sheetName, 259, 6, null),
					new ExpectedCellValue(sheetName, 260, 6, 415.75),
					new ExpectedCellValue(sheetName, 261, 6, 99d),
					new ExpectedCellValue(sheetName, 262, 6, null),
					new ExpectedCellValue(sheetName, 263, 6, 415.75),
					new ExpectedCellValue(sheetName, 264, 6, 99d),
					new ExpectedCellValue(sheetName, 265, 6, 1985.99),
					new ExpectedCellValue(sheetName, 266, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndThirdFieldsNonCompactLastFieldSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C244:F286"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 3, null),
					new ExpectedCellValue(sheetName, 247, 3, null),
					new ExpectedCellValue(sheetName, 248, 3, null),
					new ExpectedCellValue(sheetName, 249, 3, null),
					new ExpectedCellValue(sheetName, 250, 3, null),
					new ExpectedCellValue(sheetName, 251, 3, null),
					new ExpectedCellValue(sheetName, 252, 3, null),
					new ExpectedCellValue(sheetName, 253, 3, null),
					new ExpectedCellValue(sheetName, 254, 3, null),
					new ExpectedCellValue(sheetName, 255, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 257, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 258, 3, null),
					new ExpectedCellValue(sheetName, 259, 3, null),
					new ExpectedCellValue(sheetName, 260, 3, null),
					new ExpectedCellValue(sheetName, 261, 3, null),
					new ExpectedCellValue(sheetName, 262, 3, null),
					new ExpectedCellValue(sheetName, 263, 3, null),
					new ExpectedCellValue(sheetName, 264, 3, null),
					new ExpectedCellValue(sheetName, 265, 3, null),
					new ExpectedCellValue(sheetName, 266, 3, null),
					new ExpectedCellValue(sheetName, 267, 3, null),
					new ExpectedCellValue(sheetName, 268, 3, null),
					new ExpectedCellValue(sheetName, 269, 3, null),
					new ExpectedCellValue(sheetName, 270, 3, null),
					new ExpectedCellValue(sheetName, 271, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 272, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 273, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 274, 3, null),
					new ExpectedCellValue(sheetName, 275, 3, null),
					new ExpectedCellValue(sheetName, 276, 3, null),
					new ExpectedCellValue(sheetName, 277, 3, null),
					new ExpectedCellValue(sheetName, 278, 3, null),
					new ExpectedCellValue(sheetName, 279, 3, null),
					new ExpectedCellValue(sheetName, 280, 3, null),
					new ExpectedCellValue(sheetName, 281, 3, null),
					new ExpectedCellValue(sheetName, 282, 3, null),
					new ExpectedCellValue(sheetName, 283, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 285, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 286, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 4, "Values"),
					new ExpectedCellValue(sheetName, 245, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 4, "January"),
					new ExpectedCellValue(sheetName, 247, 4, "January Total"),
					new ExpectedCellValue(sheetName, 248, 4, "March"),
					new ExpectedCellValue(sheetName, 249, 4, "March Total"),
					new ExpectedCellValue(sheetName, 250, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 4, "January"),
					new ExpectedCellValue(sheetName, 252, 4, "January Total"),
					new ExpectedCellValue(sheetName, 253, 4, "March"),
					new ExpectedCellValue(sheetName, 254, 4, "March Total"),
					new ExpectedCellValue(sheetName, 255, 4, null),
					new ExpectedCellValue(sheetName, 256, 4, null),
					new ExpectedCellValue(sheetName, 257, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 258, 4, "January"),
					new ExpectedCellValue(sheetName, 259, 4, "January Total"),
					new ExpectedCellValue(sheetName, 260, 4, "February"),
					new ExpectedCellValue(sheetName, 261, 4, "February Total"),
					new ExpectedCellValue(sheetName, 262, 4, "March"),
					new ExpectedCellValue(sheetName, 263, 4, "March Total"),
					new ExpectedCellValue(sheetName, 264, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 265, 4, "January"),
					new ExpectedCellValue(sheetName, 266, 4, "January Total"),
					new ExpectedCellValue(sheetName, 267, 4, "February"),
					new ExpectedCellValue(sheetName, 268, 4, "February Total"),
					new ExpectedCellValue(sheetName, 269, 4, "March"),
					new ExpectedCellValue(sheetName, 270, 4, "March Total"),
					new ExpectedCellValue(sheetName, 271, 4, null),
					new ExpectedCellValue(sheetName, 272, 4, null),
					new ExpectedCellValue(sheetName, 273, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 274, 4, "January"),
					new ExpectedCellValue(sheetName, 275, 4, "January Total"),
					new ExpectedCellValue(sheetName, 276, 4, "February"),
					new ExpectedCellValue(sheetName, 277, 4, "February Total"),
					new ExpectedCellValue(sheetName, 278, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 279, 4, "January"),
					new ExpectedCellValue(sheetName, 280, 4, "January Total"),
					new ExpectedCellValue(sheetName, 281, 4, "February"),
					new ExpectedCellValue(sheetName, 282, 4, "February Total"),
					new ExpectedCellValue(sheetName, 283, 4, null),
					new ExpectedCellValue(sheetName, 284, 4, null),
					new ExpectedCellValue(sheetName, 285, 4, null),
					new ExpectedCellValue(sheetName, 286, 4, null),
					new ExpectedCellValue(sheetName, 244, 5, "Item"),
					new ExpectedCellValue(sheetName, 245, 5, null),
					new ExpectedCellValue(sheetName, 246, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 247, 5, null),
					new ExpectedCellValue(sheetName, 248, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 249, 5, null),
					new ExpectedCellValue(sheetName, 250, 5, null),
					new ExpectedCellValue(sheetName, 251, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 252, 5, null),
					new ExpectedCellValue(sheetName, 253, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 254, 5, null),
					new ExpectedCellValue(sheetName, 255, 5, null),
					new ExpectedCellValue(sheetName, 256, 5, null),
					new ExpectedCellValue(sheetName, 257, 5, null),
					new ExpectedCellValue(sheetName, 258, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 259, 5, null),
					new ExpectedCellValue(sheetName, 260, 5, "Tent"),
					new ExpectedCellValue(sheetName, 261, 5, null),
					new ExpectedCellValue(sheetName, 262, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 5, null),
					new ExpectedCellValue(sheetName, 264, 5, null),
					new ExpectedCellValue(sheetName, 265, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 266, 5, null),
					new ExpectedCellValue(sheetName, 267, 5, "Tent"),
					new ExpectedCellValue(sheetName, 268, 5, null),
					new ExpectedCellValue(sheetName, 269, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 270, 5, null),
					new ExpectedCellValue(sheetName, 271, 5, null),
					new ExpectedCellValue(sheetName, 272, 5, null),
					new ExpectedCellValue(sheetName, 273, 5, null),
					new ExpectedCellValue(sheetName, 274, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 5, null),
					new ExpectedCellValue(sheetName, 276, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 277, 5, null),
					new ExpectedCellValue(sheetName, 278, 5, null),
					new ExpectedCellValue(sheetName, 279, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 280, 5, null),
					new ExpectedCellValue(sheetName, 281, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 282, 5, null),
					new ExpectedCellValue(sheetName, 283, 5, null),
					new ExpectedCellValue(sheetName, 284, 5, null),
					new ExpectedCellValue(sheetName, 285, 5, null),
					new ExpectedCellValue(sheetName, 286, 5, null),
					new ExpectedCellValue(sheetName, 244, 6, null),
					new ExpectedCellValue(sheetName, 245, 6, null),
					new ExpectedCellValue(sheetName, 246, 6, 415.75),
					new ExpectedCellValue(sheetName, 247, 6, 415.75),
					new ExpectedCellValue(sheetName, 248, 6, 24.99),
					new ExpectedCellValue(sheetName, 249, 6, 24.99),
					new ExpectedCellValue(sheetName, 250, 6, null),
					new ExpectedCellValue(sheetName, 251, 6, 831.5),
					new ExpectedCellValue(sheetName, 252, 6, 831.5),
					new ExpectedCellValue(sheetName, 253, 6, 24.99),
					new ExpectedCellValue(sheetName, 254, 6, 24.99),
					new ExpectedCellValue(sheetName, 255, 6, 440.74),
					new ExpectedCellValue(sheetName, 256, 6, 856.49),
					new ExpectedCellValue(sheetName, 257, 6, null),
					new ExpectedCellValue(sheetName, 258, 6, 415.75),
					new ExpectedCellValue(sheetName, 259, 6, 415.75),
					new ExpectedCellValue(sheetName, 260, 6, 199d),
					new ExpectedCellValue(sheetName, 261, 6, 199d),
					new ExpectedCellValue(sheetName, 262, 6, 415.75),
					new ExpectedCellValue(sheetName, 263, 6, 415.75),
					new ExpectedCellValue(sheetName, 264, 6, null),
					new ExpectedCellValue(sheetName, 265, 6, 831.5),
					new ExpectedCellValue(sheetName, 266, 6, 831.5),
					new ExpectedCellValue(sheetName, 267, 6, 1194d),
					new ExpectedCellValue(sheetName, 268, 6, 1194d),
					new ExpectedCellValue(sheetName, 269, 6, 831.5),
					new ExpectedCellValue(sheetName, 270, 6, 831.5),
					new ExpectedCellValue(sheetName, 271, 6, 1030.5),
					new ExpectedCellValue(sheetName, 272, 6, 2857d),
					new ExpectedCellValue(sheetName, 273, 6, null),
					new ExpectedCellValue(sheetName, 274, 6, 415.75),
					new ExpectedCellValue(sheetName, 275, 6, 415.75),
					new ExpectedCellValue(sheetName, 276, 6, 99d),
					new ExpectedCellValue(sheetName, 277, 6, 99d),
					new ExpectedCellValue(sheetName, 278, 6, null),
					new ExpectedCellValue(sheetName, 279, 6, 415.75),
					new ExpectedCellValue(sheetName, 280, 6, 415.75),
					new ExpectedCellValue(sheetName, 281, 6, 99d),
					new ExpectedCellValue(sheetName, 282, 6, 99d),
					new ExpectedCellValue(sheetName, 283, 6, 514.75),
					new ExpectedCellValue(sheetName, 284, 6, 514.75),
					new ExpectedCellValue(sheetName, 285, 6, 1985.99),
					new ExpectedCellValue(sheetName, 286, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndThirdFieldsNonCompactLastFieldSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable13"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C244:F286"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 3, null),
					new ExpectedCellValue(sheetName, 247, 3, null),
					new ExpectedCellValue(sheetName, 248, 3, null),
					new ExpectedCellValue(sheetName, 249, 3, null),
					new ExpectedCellValue(sheetName, 250, 3, null),
					new ExpectedCellValue(sheetName, 251, 3, null),
					new ExpectedCellValue(sheetName, 252, 3, null),
					new ExpectedCellValue(sheetName, 253, 3, null),
					new ExpectedCellValue(sheetName, 254, 3, null),
					new ExpectedCellValue(sheetName, 255, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 257, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 258, 3, null),
					new ExpectedCellValue(sheetName, 259, 3, null),
					new ExpectedCellValue(sheetName, 260, 3, null),
					new ExpectedCellValue(sheetName, 261, 3, null),
					new ExpectedCellValue(sheetName, 262, 3, null),
					new ExpectedCellValue(sheetName, 263, 3, null),
					new ExpectedCellValue(sheetName, 264, 3, null),
					new ExpectedCellValue(sheetName, 265, 3, null),
					new ExpectedCellValue(sheetName, 266, 3, null),
					new ExpectedCellValue(sheetName, 267, 3, null),
					new ExpectedCellValue(sheetName, 268, 3, null),
					new ExpectedCellValue(sheetName, 269, 3, null),
					new ExpectedCellValue(sheetName, 270, 3, null),
					new ExpectedCellValue(sheetName, 271, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 272, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 273, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 274, 3, null),
					new ExpectedCellValue(sheetName, 275, 3, null),
					new ExpectedCellValue(sheetName, 276, 3, null),
					new ExpectedCellValue(sheetName, 277, 3, null),
					new ExpectedCellValue(sheetName, 278, 3, null),
					new ExpectedCellValue(sheetName, 279, 3, null),
					new ExpectedCellValue(sheetName, 280, 3, null),
					new ExpectedCellValue(sheetName, 281, 3, null),
					new ExpectedCellValue(sheetName, 282, 3, null),
					new ExpectedCellValue(sheetName, 283, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 285, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 286, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 4, "Values"),
					new ExpectedCellValue(sheetName, 245, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 4, "January"),
					new ExpectedCellValue(sheetName, 247, 4, "January Total"),
					new ExpectedCellValue(sheetName, 248, 4, "March"),
					new ExpectedCellValue(sheetName, 249, 4, "March Total"),
					new ExpectedCellValue(sheetName, 250, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 4, "January"),
					new ExpectedCellValue(sheetName, 252, 4, "January Total"),
					new ExpectedCellValue(sheetName, 253, 4, "March"),
					new ExpectedCellValue(sheetName, 254, 4, "March Total"),
					new ExpectedCellValue(sheetName, 255, 4, null),
					new ExpectedCellValue(sheetName, 256, 4, null),
					new ExpectedCellValue(sheetName, 257, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 258, 4, "January"),
					new ExpectedCellValue(sheetName, 259, 4, "January Total"),
					new ExpectedCellValue(sheetName, 260, 4, "February"),
					new ExpectedCellValue(sheetName, 261, 4, "February Total"),
					new ExpectedCellValue(sheetName, 262, 4, "March"),
					new ExpectedCellValue(sheetName, 263, 4, "March Total"),
					new ExpectedCellValue(sheetName, 264, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 265, 4, "January"),
					new ExpectedCellValue(sheetName, 266, 4, "January Total"),
					new ExpectedCellValue(sheetName, 267, 4, "February"),
					new ExpectedCellValue(sheetName, 268, 4, "February Total"),
					new ExpectedCellValue(sheetName, 269, 4, "March"),
					new ExpectedCellValue(sheetName, 270, 4, "March Total"),
					new ExpectedCellValue(sheetName, 271, 4, null),
					new ExpectedCellValue(sheetName, 272, 4, null),
					new ExpectedCellValue(sheetName, 273, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 274, 4, "January"),
					new ExpectedCellValue(sheetName, 275, 4, "January Total"),
					new ExpectedCellValue(sheetName, 276, 4, "February"),
					new ExpectedCellValue(sheetName, 277, 4, "February Total"),
					new ExpectedCellValue(sheetName, 278, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 279, 4, "January"),
					new ExpectedCellValue(sheetName, 280, 4, "January Total"),
					new ExpectedCellValue(sheetName, 281, 4, "February"),
					new ExpectedCellValue(sheetName, 282, 4, "February Total"),
					new ExpectedCellValue(sheetName, 283, 4, null),
					new ExpectedCellValue(sheetName, 284, 4, null),
					new ExpectedCellValue(sheetName, 285, 4, null),
					new ExpectedCellValue(sheetName, 286, 4, null),
					new ExpectedCellValue(sheetName, 244, 5, "Item"),
					new ExpectedCellValue(sheetName, 245, 5, null),
					new ExpectedCellValue(sheetName, 246, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 247, 5, null),
					new ExpectedCellValue(sheetName, 248, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 249, 5, null),
					new ExpectedCellValue(sheetName, 250, 5, null),
					new ExpectedCellValue(sheetName, 251, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 252, 5, null),
					new ExpectedCellValue(sheetName, 253, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 254, 5, null),
					new ExpectedCellValue(sheetName, 255, 5, null),
					new ExpectedCellValue(sheetName, 256, 5, null),
					new ExpectedCellValue(sheetName, 257, 5, null),
					new ExpectedCellValue(sheetName, 258, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 259, 5, null),
					new ExpectedCellValue(sheetName, 260, 5, "Tent"),
					new ExpectedCellValue(sheetName, 261, 5, null),
					new ExpectedCellValue(sheetName, 262, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 263, 5, null),
					new ExpectedCellValue(sheetName, 264, 5, null),
					new ExpectedCellValue(sheetName, 265, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 266, 5, null),
					new ExpectedCellValue(sheetName, 267, 5, "Tent"),
					new ExpectedCellValue(sheetName, 268, 5, null),
					new ExpectedCellValue(sheetName, 269, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 270, 5, null),
					new ExpectedCellValue(sheetName, 271, 5, null),
					new ExpectedCellValue(sheetName, 272, 5, null),
					new ExpectedCellValue(sheetName, 273, 5, null),
					new ExpectedCellValue(sheetName, 274, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 275, 5, null),
					new ExpectedCellValue(sheetName, 276, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 277, 5, null),
					new ExpectedCellValue(sheetName, 278, 5, null),
					new ExpectedCellValue(sheetName, 279, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 280, 5, null),
					new ExpectedCellValue(sheetName, 281, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 282, 5, null),
					new ExpectedCellValue(sheetName, 283, 5, null),
					new ExpectedCellValue(sheetName, 284, 5, null),
					new ExpectedCellValue(sheetName, 285, 5, null),
					new ExpectedCellValue(sheetName, 286, 5, null),
					new ExpectedCellValue(sheetName, 244, 6, null),
					new ExpectedCellValue(sheetName, 245, 6, null),
					new ExpectedCellValue(sheetName, 246, 6, 415.75),
					new ExpectedCellValue(sheetName, 247, 6, 415.75),
					new ExpectedCellValue(sheetName, 248, 6, 24.99),
					new ExpectedCellValue(sheetName, 249, 6, 24.99),
					new ExpectedCellValue(sheetName, 250, 6, null),
					new ExpectedCellValue(sheetName, 251, 6, 831.5),
					new ExpectedCellValue(sheetName, 252, 6, 831.5),
					new ExpectedCellValue(sheetName, 253, 6, 24.99),
					new ExpectedCellValue(sheetName, 254, 6, 24.99),
					new ExpectedCellValue(sheetName, 255, 6, 440.74),
					new ExpectedCellValue(sheetName, 256, 6, 856.49),
					new ExpectedCellValue(sheetName, 257, 6, null),
					new ExpectedCellValue(sheetName, 258, 6, 415.75),
					new ExpectedCellValue(sheetName, 259, 6, 415.75),
					new ExpectedCellValue(sheetName, 260, 6, 199d),
					new ExpectedCellValue(sheetName, 261, 6, 199d),
					new ExpectedCellValue(sheetName, 262, 6, 415.75),
					new ExpectedCellValue(sheetName, 263, 6, 415.75),
					new ExpectedCellValue(sheetName, 264, 6, null),
					new ExpectedCellValue(sheetName, 265, 6, 831.5),
					new ExpectedCellValue(sheetName, 266, 6, 831.5),
					new ExpectedCellValue(sheetName, 267, 6, 1194d),
					new ExpectedCellValue(sheetName, 268, 6, 1194d),
					new ExpectedCellValue(sheetName, 269, 6, 831.5),
					new ExpectedCellValue(sheetName, 270, 6, 831.5),
					new ExpectedCellValue(sheetName, 271, 6, 1030.5),
					new ExpectedCellValue(sheetName, 272, 6, 2857d),
					new ExpectedCellValue(sheetName, 273, 6, null),
					new ExpectedCellValue(sheetName, 274, 6, 415.75),
					new ExpectedCellValue(sheetName, 275, 6, 415.75),
					new ExpectedCellValue(sheetName, 276, 6, 99d),
					new ExpectedCellValue(sheetName, 277, 6, 99d),
					new ExpectedCellValue(sheetName, 278, 6, null),
					new ExpectedCellValue(sheetName, 279, 6, 415.75),
					new ExpectedCellValue(sheetName, 280, 6, 415.75),
					new ExpectedCellValue(sheetName, 281, 6, 99d),
					new ExpectedCellValue(sheetName, 282, 6, 99d),
					new ExpectedCellValue(sheetName, 283, 6, 514.75),
					new ExpectedCellValue(sheetName, 284, 6, 514.75),
					new ExpectedCellValue(sheetName, 285, 6, 1985.99),
					new ExpectedCellValue(sheetName, 286, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndLastFieldsNonCompactThirdFieldSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J244:M280"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 10, null),
					new ExpectedCellValue(sheetName, 247, 10, null),
					new ExpectedCellValue(sheetName, 248, 10, null),
					new ExpectedCellValue(sheetName, 249, 10, null),
					new ExpectedCellValue(sheetName, 250, 10, null),
					new ExpectedCellValue(sheetName, 251, 10, null),
					new ExpectedCellValue(sheetName, 252, 10, null),
					new ExpectedCellValue(sheetName, 253, 10, null),
					new ExpectedCellValue(sheetName, 254, 10, null),
					new ExpectedCellValue(sheetName, 255, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 256, 10, null),
					new ExpectedCellValue(sheetName, 257, 10, null),
					new ExpectedCellValue(sheetName, 258, 10, null),
					new ExpectedCellValue(sheetName, 259, 10, null),
					new ExpectedCellValue(sheetName, 260, 10, null),
					new ExpectedCellValue(sheetName, 261, 10, null),
					new ExpectedCellValue(sheetName, 262, 10, null),
					new ExpectedCellValue(sheetName, 263, 10, null),
					new ExpectedCellValue(sheetName, 264, 10, null),
					new ExpectedCellValue(sheetName, 265, 10, null),
					new ExpectedCellValue(sheetName, 266, 10, null),
					new ExpectedCellValue(sheetName, 267, 10, null),
					new ExpectedCellValue(sheetName, 268, 10, null),
					new ExpectedCellValue(sheetName, 269, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 270, 10, null),
					new ExpectedCellValue(sheetName, 271, 10, null),
					new ExpectedCellValue(sheetName, 272, 10, null),
					new ExpectedCellValue(sheetName, 273, 10, null),
					new ExpectedCellValue(sheetName, 274, 10, null),
					new ExpectedCellValue(sheetName, 275, 10, null),
					new ExpectedCellValue(sheetName, 276, 10, null),
					new ExpectedCellValue(sheetName, 277, 10, null),
					new ExpectedCellValue(sheetName, 278, 10, null),
					new ExpectedCellValue(sheetName, 279, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 280, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 11, "Values"),
					new ExpectedCellValue(sheetName, 245, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 11, "January"),
					new ExpectedCellValue(sheetName, 247, 11, null),
					new ExpectedCellValue(sheetName, 248, 11, "March"),
					new ExpectedCellValue(sheetName, 249, 11, null),
					new ExpectedCellValue(sheetName, 250, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 11, "January"),
					new ExpectedCellValue(sheetName, 252, 11, null),
					new ExpectedCellValue(sheetName, 253, 11, "March"),
					new ExpectedCellValue(sheetName, 254, 11, null),
					new ExpectedCellValue(sheetName, 255, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 11, "January"),
					new ExpectedCellValue(sheetName, 257, 11, null),
					new ExpectedCellValue(sheetName, 258, 11, "February"),
					new ExpectedCellValue(sheetName, 259, 11, null),
					new ExpectedCellValue(sheetName, 260, 11, "March"),
					new ExpectedCellValue(sheetName, 261, 11, null),
					new ExpectedCellValue(sheetName, 262, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 263, 11, "January"),
					new ExpectedCellValue(sheetName, 264, 11, null),
					new ExpectedCellValue(sheetName, 265, 11, "February"),
					new ExpectedCellValue(sheetName, 266, 11, null),
					new ExpectedCellValue(sheetName, 267, 11, "March"),
					new ExpectedCellValue(sheetName, 268, 11, null),
					new ExpectedCellValue(sheetName, 269, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 270, 11, "January"),
					new ExpectedCellValue(sheetName, 271, 11, null),
					new ExpectedCellValue(sheetName, 272, 11, "February"),
					new ExpectedCellValue(sheetName, 273, 11, null),
					new ExpectedCellValue(sheetName, 274, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 275, 11, "January"),
					new ExpectedCellValue(sheetName, 276, 11, null),
					new ExpectedCellValue(sheetName, 277, 11, "February"),
					new ExpectedCellValue(sheetName, 278, 11, null),
					new ExpectedCellValue(sheetName, 279, 11, null),
					new ExpectedCellValue(sheetName, 280, 11, null),
					new ExpectedCellValue(sheetName, 244, 12, "Item"),
					new ExpectedCellValue(sheetName, 245, 12, null),
					new ExpectedCellValue(sheetName, 246, 12, null),
					new ExpectedCellValue(sheetName, 247, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 12, null),
					new ExpectedCellValue(sheetName, 249, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 250, 12, null),
					new ExpectedCellValue(sheetName, 251, 12, null),
					new ExpectedCellValue(sheetName, 252, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 253, 12, null),
					new ExpectedCellValue(sheetName, 254, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 255, 12, null),
					new ExpectedCellValue(sheetName, 256, 12, null),
					new ExpectedCellValue(sheetName, 257, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 258, 12, null),
					new ExpectedCellValue(sheetName, 259, 12, "Tent"),
					new ExpectedCellValue(sheetName, 260, 12, null),
					new ExpectedCellValue(sheetName, 261, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 262, 12, null),
					new ExpectedCellValue(sheetName, 263, 12, null),
					new ExpectedCellValue(sheetName, 264, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 265, 12, null),
					new ExpectedCellValue(sheetName, 266, 12, "Tent"),
					new ExpectedCellValue(sheetName, 267, 12, null),
					new ExpectedCellValue(sheetName, 268, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 269, 12, null),
					new ExpectedCellValue(sheetName, 270, 12, null),
					new ExpectedCellValue(sheetName, 271, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 272, 12, null),
					new ExpectedCellValue(sheetName, 273, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 274, 12, null),
					new ExpectedCellValue(sheetName, 275, 12, null),
					new ExpectedCellValue(sheetName, 276, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 277, 12, null),
					new ExpectedCellValue(sheetName, 278, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 279, 12, null),
					new ExpectedCellValue(sheetName, 280, 12, null),
					new ExpectedCellValue(sheetName, 244, 13, null),
					new ExpectedCellValue(sheetName, 245, 13, null),
					new ExpectedCellValue(sheetName, 246, 13, null),
					new ExpectedCellValue(sheetName, 247, 13, 415.75),
					new ExpectedCellValue(sheetName, 248, 13, null),
					new ExpectedCellValue(sheetName, 249, 13, 24.99),
					new ExpectedCellValue(sheetName, 250, 13, null),
					new ExpectedCellValue(sheetName, 251, 13, null),
					new ExpectedCellValue(sheetName, 252, 13, 831.5),
					new ExpectedCellValue(sheetName, 253, 13, null),
					new ExpectedCellValue(sheetName, 254, 13, 24.99),
					new ExpectedCellValue(sheetName, 255, 13, null),
					new ExpectedCellValue(sheetName, 256, 13, null),
					new ExpectedCellValue(sheetName, 257, 13, 415.75),
					new ExpectedCellValue(sheetName, 258, 13, null),
					new ExpectedCellValue(sheetName, 259, 13, 199d),
					new ExpectedCellValue(sheetName, 260, 13, null),
					new ExpectedCellValue(sheetName, 261, 13, 415.75),
					new ExpectedCellValue(sheetName, 262, 13, null),
					new ExpectedCellValue(sheetName, 263, 13, null),
					new ExpectedCellValue(sheetName, 264, 13, 831.5),
					new ExpectedCellValue(sheetName, 265, 13, null),
					new ExpectedCellValue(sheetName, 266, 13, 1194d),
					new ExpectedCellValue(sheetName, 267, 13, null),
					new ExpectedCellValue(sheetName, 268, 13, 831.5),
					new ExpectedCellValue(sheetName, 269, 13, null),
					new ExpectedCellValue(sheetName, 270, 13, null),
					new ExpectedCellValue(sheetName, 271, 13, 415.75),
					new ExpectedCellValue(sheetName, 272, 13, null),
					new ExpectedCellValue(sheetName, 273, 13, 99d),
					new ExpectedCellValue(sheetName, 274, 13, null),
					new ExpectedCellValue(sheetName, 275, 13, null),
					new ExpectedCellValue(sheetName, 276, 13, 415.75),
					new ExpectedCellValue(sheetName, 277, 13, null),
					new ExpectedCellValue(sheetName, 278, 13, 99d),
					new ExpectedCellValue(sheetName, 279, 13, 1985.99),
					new ExpectedCellValue(sheetName, 280, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndLastFieldsNonCompactThirdFieldSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J244:M286"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 10, null),
					new ExpectedCellValue(sheetName, 247, 10, null),
					new ExpectedCellValue(sheetName, 248, 10, null),
					new ExpectedCellValue(sheetName, 249, 10, null),
					new ExpectedCellValue(sheetName, 250, 10, null),
					new ExpectedCellValue(sheetName, 251, 10, null),
					new ExpectedCellValue(sheetName, 252, 10, null),
					new ExpectedCellValue(sheetName, 253, 10, null),
					new ExpectedCellValue(sheetName, 254, 10, null),
					new ExpectedCellValue(sheetName, 255, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 257, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 258, 10, null),
					new ExpectedCellValue(sheetName, 259, 10, null),
					new ExpectedCellValue(sheetName, 260, 10, null),
					new ExpectedCellValue(sheetName, 261, 10, null),
					new ExpectedCellValue(sheetName, 262, 10, null),
					new ExpectedCellValue(sheetName, 263, 10, null),
					new ExpectedCellValue(sheetName, 264, 10, null),
					new ExpectedCellValue(sheetName, 265, 10, null),
					new ExpectedCellValue(sheetName, 266, 10, null),
					new ExpectedCellValue(sheetName, 267, 10, null),
					new ExpectedCellValue(sheetName, 268, 10, null),
					new ExpectedCellValue(sheetName, 269, 10, null),
					new ExpectedCellValue(sheetName, 270, 10, null),
					new ExpectedCellValue(sheetName, 271, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 272, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 273, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 274, 10, null),
					new ExpectedCellValue(sheetName, 275, 10, null),
					new ExpectedCellValue(sheetName, 276, 10, null),
					new ExpectedCellValue(sheetName, 277, 10, null),
					new ExpectedCellValue(sheetName, 278, 10, null),
					new ExpectedCellValue(sheetName, 279, 10, null),
					new ExpectedCellValue(sheetName, 280, 10, null),
					new ExpectedCellValue(sheetName, 281, 10, null),
					new ExpectedCellValue(sheetName, 282, 10, null),
					new ExpectedCellValue(sheetName, 283, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 285, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 286, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 11, "Values"),
					new ExpectedCellValue(sheetName, 245, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 11, "January"),
					new ExpectedCellValue(sheetName, 247, 11, null),
					new ExpectedCellValue(sheetName, 248, 11, "March"),
					new ExpectedCellValue(sheetName, 249, 11, null),
					new ExpectedCellValue(sheetName, 250, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 11, "January"),
					new ExpectedCellValue(sheetName, 252, 11, null),
					new ExpectedCellValue(sheetName, 253, 11, "March"),
					new ExpectedCellValue(sheetName, 254, 11, null),
					new ExpectedCellValue(sheetName, 255, 11, null),
					new ExpectedCellValue(sheetName, 256, 11, null),
					new ExpectedCellValue(sheetName, 257, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 258, 11, "January"),
					new ExpectedCellValue(sheetName, 259, 11, null),
					new ExpectedCellValue(sheetName, 260, 11, "February"),
					new ExpectedCellValue(sheetName, 261, 11, null),
					new ExpectedCellValue(sheetName, 262, 11, "March"),
					new ExpectedCellValue(sheetName, 263, 11, null),
					new ExpectedCellValue(sheetName, 264, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 265, 11, "January"),
					new ExpectedCellValue(sheetName, 266, 11, null),
					new ExpectedCellValue(sheetName, 267, 11, "February"),
					new ExpectedCellValue(sheetName, 268, 11, null),
					new ExpectedCellValue(sheetName, 269, 11, "March"),
					new ExpectedCellValue(sheetName, 270, 11, null),
					new ExpectedCellValue(sheetName, 271, 11, null),
					new ExpectedCellValue(sheetName, 272, 11, null),
					new ExpectedCellValue(sheetName, 273, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 274, 11, "January"),
					new ExpectedCellValue(sheetName, 275, 11, null),
					new ExpectedCellValue(sheetName, 276, 11, "February"),
					new ExpectedCellValue(sheetName, 277, 11, null),
					new ExpectedCellValue(sheetName, 278, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 279, 11, "January"),
					new ExpectedCellValue(sheetName, 280, 11, null),
					new ExpectedCellValue(sheetName, 281, 11, "February"),
					new ExpectedCellValue(sheetName, 282, 11, null),
					new ExpectedCellValue(sheetName, 283, 11, null),
					new ExpectedCellValue(sheetName, 284, 11, null),
					new ExpectedCellValue(sheetName, 285, 11, null),
					new ExpectedCellValue(sheetName, 286, 11, null),
					new ExpectedCellValue(sheetName, 244, 12, "Item"),
					new ExpectedCellValue(sheetName, 245, 12, null),
					new ExpectedCellValue(sheetName, 246, 12, null),
					new ExpectedCellValue(sheetName, 247, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 12, null),
					new ExpectedCellValue(sheetName, 249, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 250, 12, null),
					new ExpectedCellValue(sheetName, 251, 12, null),
					new ExpectedCellValue(sheetName, 252, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 253, 12, null),
					new ExpectedCellValue(sheetName, 254, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 255, 12, null),
					new ExpectedCellValue(sheetName, 256, 12, null),
					new ExpectedCellValue(sheetName, 257, 12, null),
					new ExpectedCellValue(sheetName, 258, 12, null),
					new ExpectedCellValue(sheetName, 259, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 260, 12, null),
					new ExpectedCellValue(sheetName, 261, 12, "Tent"),
					new ExpectedCellValue(sheetName, 262, 12, null),
					new ExpectedCellValue(sheetName, 263, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 264, 12, null),
					new ExpectedCellValue(sheetName, 265, 12, null),
					new ExpectedCellValue(sheetName, 266, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 267, 12, null),
					new ExpectedCellValue(sheetName, 268, 12, "Tent"),
					new ExpectedCellValue(sheetName, 269, 12, null),
					new ExpectedCellValue(sheetName, 270, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 12, null),
					new ExpectedCellValue(sheetName, 272, 12, null),
					new ExpectedCellValue(sheetName, 273, 12, null),
					new ExpectedCellValue(sheetName, 274, 12, null),
					new ExpectedCellValue(sheetName, 275, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 276, 12, null),
					new ExpectedCellValue(sheetName, 277, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 278, 12, null),
					new ExpectedCellValue(sheetName, 279, 12, null),
					new ExpectedCellValue(sheetName, 280, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 281, 12, null),
					new ExpectedCellValue(sheetName, 282, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 283, 12, null),
					new ExpectedCellValue(sheetName, 284, 12, null),
					new ExpectedCellValue(sheetName, 285, 12, null),
					new ExpectedCellValue(sheetName, 286, 12, null),
					new ExpectedCellValue(sheetName, 244, 13, null),
					new ExpectedCellValue(sheetName, 245, 13, null),
					new ExpectedCellValue(sheetName, 246, 13, 415.75),
					new ExpectedCellValue(sheetName, 247, 13, 415.75),
					new ExpectedCellValue(sheetName, 248, 13, 24.99),
					new ExpectedCellValue(sheetName, 249, 13, 24.99),
					new ExpectedCellValue(sheetName, 250, 13, null),
					new ExpectedCellValue(sheetName, 251, 13, 831.5),
					new ExpectedCellValue(sheetName, 252, 13, 831.5),
					new ExpectedCellValue(sheetName, 253, 13, 24.99),
					new ExpectedCellValue(sheetName, 254, 13, 24.99),
					new ExpectedCellValue(sheetName, 255, 13, 440.74),
					new ExpectedCellValue(sheetName, 256, 13, 856.49),
					new ExpectedCellValue(sheetName, 257, 13, null),
					new ExpectedCellValue(sheetName, 258, 13, 415.75),
					new ExpectedCellValue(sheetName, 259, 13, 415.75),
					new ExpectedCellValue(sheetName, 260, 13, 199d),
					new ExpectedCellValue(sheetName, 261, 13, 199d),
					new ExpectedCellValue(sheetName, 262, 13, 415.75),
					new ExpectedCellValue(sheetName, 263, 13, 415.75),
					new ExpectedCellValue(sheetName, 264, 13, null),
					new ExpectedCellValue(sheetName, 265, 13, 831.5),
					new ExpectedCellValue(sheetName, 266, 13, 831.5),
					new ExpectedCellValue(sheetName, 267, 13, 1194d),
					new ExpectedCellValue(sheetName, 268, 13, 1194d),
					new ExpectedCellValue(sheetName, 269, 13, 831.5),
					new ExpectedCellValue(sheetName, 270, 13, 831.5),
					new ExpectedCellValue(sheetName, 271, 13, 1030.5),
					new ExpectedCellValue(sheetName, 272, 13, 2857d),
					new ExpectedCellValue(sheetName, 273, 13, null),
					new ExpectedCellValue(sheetName, 274, 13, 415.75),
					new ExpectedCellValue(sheetName, 275, 13, 415.75),
					new ExpectedCellValue(sheetName, 276, 13, 99d),
					new ExpectedCellValue(sheetName, 277, 13, 99d),
					new ExpectedCellValue(sheetName, 278, 13, null),
					new ExpectedCellValue(sheetName, 279, 13, 415.75),
					new ExpectedCellValue(sheetName, 280, 13, 415.75),
					new ExpectedCellValue(sheetName, 281, 13, 99d),
					new ExpectedCellValue(sheetName, 282, 13, 99d),
					new ExpectedCellValue(sheetName, 283, 13, 514.75),
					new ExpectedCellValue(sheetName, 284, 13, 514.75),
					new ExpectedCellValue(sheetName, 285, 13, 1985.99),
					new ExpectedCellValue(sheetName, 286, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstAndLastFieldsNonCompactThirdFieldSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable14"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J244:M300"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 10, null),
					new ExpectedCellValue(sheetName, 247, 10, null),
					new ExpectedCellValue(sheetName, 248, 10, null),
					new ExpectedCellValue(sheetName, 249, 10, null),
					new ExpectedCellValue(sheetName, 250, 10, null),
					new ExpectedCellValue(sheetName, 251, 10, null),
					new ExpectedCellValue(sheetName, 252, 10, null),
					new ExpectedCellValue(sheetName, 253, 10, null),
					new ExpectedCellValue(sheetName, 254, 10, null),
					new ExpectedCellValue(sheetName, 255, 10, null),
					new ExpectedCellValue(sheetName, 256, 10, null),
					new ExpectedCellValue(sheetName, 257, 10, null),
					new ExpectedCellValue(sheetName, 258, 10, null),
					new ExpectedCellValue(sheetName, 259, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 260, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 261, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 262, 10, null),
					new ExpectedCellValue(sheetName, 263, 10, null),
					new ExpectedCellValue(sheetName, 264, 10, null),
					new ExpectedCellValue(sheetName, 265, 10, null),
					new ExpectedCellValue(sheetName, 266, 10, null),
					new ExpectedCellValue(sheetName, 267, 10, null),
					new ExpectedCellValue(sheetName, 268, 10, null),
					new ExpectedCellValue(sheetName, 269, 10, null),
					new ExpectedCellValue(sheetName, 270, 10, null),
					new ExpectedCellValue(sheetName, 271, 10, null),
					new ExpectedCellValue(sheetName, 272, 10, null),
					new ExpectedCellValue(sheetName, 273, 10, null),
					new ExpectedCellValue(sheetName, 274, 10, null),
					new ExpectedCellValue(sheetName, 275, 10, null),
					new ExpectedCellValue(sheetName, 276, 10, null),
					new ExpectedCellValue(sheetName, 277, 10, null),
					new ExpectedCellValue(sheetName, 278, 10, null),
					new ExpectedCellValue(sheetName, 279, 10, null),
					new ExpectedCellValue(sheetName, 280, 10, null),
					new ExpectedCellValue(sheetName, 281, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 282, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 283, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 284, 10, null),
					new ExpectedCellValue(sheetName, 285, 10, null),
					new ExpectedCellValue(sheetName, 286, 10, null),
					new ExpectedCellValue(sheetName, 287, 10, null),
					new ExpectedCellValue(sheetName, 288, 10, null),
					new ExpectedCellValue(sheetName, 289, 10, null),
					new ExpectedCellValue(sheetName, 290, 10, null),
					new ExpectedCellValue(sheetName, 291, 10, null),
					new ExpectedCellValue(sheetName, 292, 10, null),
					new ExpectedCellValue(sheetName, 293, 10, null),
					new ExpectedCellValue(sheetName, 294, 10, null),
					new ExpectedCellValue(sheetName, 295, 10, null),
					new ExpectedCellValue(sheetName, 296, 10, null),
					new ExpectedCellValue(sheetName, 297, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 298, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 299, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 300, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 11, "Values"),
					new ExpectedCellValue(sheetName, 245, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 11, "January"),
					new ExpectedCellValue(sheetName, 247, 11, null),
					new ExpectedCellValue(sheetName, 248, 11, "January Total"),
					new ExpectedCellValue(sheetName, 249, 11, "March"),
					new ExpectedCellValue(sheetName, 250, 11, null),
					new ExpectedCellValue(sheetName, 251, 11, "March Total"),
					new ExpectedCellValue(sheetName, 252, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 11, "January"),
					new ExpectedCellValue(sheetName, 254, 11, null),
					new ExpectedCellValue(sheetName, 255, 11, "January Total"),
					new ExpectedCellValue(sheetName, 256, 11, "March"),
					new ExpectedCellValue(sheetName, 257, 11, null),
					new ExpectedCellValue(sheetName, 258, 11, "March Total"),
					new ExpectedCellValue(sheetName, 259, 11, null),
					new ExpectedCellValue(sheetName, 260, 11, null),
					new ExpectedCellValue(sheetName, 261, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 262, 11, "January"),
					new ExpectedCellValue(sheetName, 263, 11, null),
					new ExpectedCellValue(sheetName, 264, 11, "January Total"),
					new ExpectedCellValue(sheetName, 265, 11, "February"),
					new ExpectedCellValue(sheetName, 266, 11, null),
					new ExpectedCellValue(sheetName, 267, 11, "February Total"),
					new ExpectedCellValue(sheetName, 268, 11, "March"),
					new ExpectedCellValue(sheetName, 269, 11, null),
					new ExpectedCellValue(sheetName, 270, 11, "March Total"),
					new ExpectedCellValue(sheetName, 271, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 272, 11, "January"),
					new ExpectedCellValue(sheetName, 273, 11, null),
					new ExpectedCellValue(sheetName, 274, 11, "January Total"),
					new ExpectedCellValue(sheetName, 275, 11, "February"),
					new ExpectedCellValue(sheetName, 276, 11, null),
					new ExpectedCellValue(sheetName, 277, 11, "February Total"),
					new ExpectedCellValue(sheetName, 278, 11, "March"),
					new ExpectedCellValue(sheetName, 279, 11, null),
					new ExpectedCellValue(sheetName, 280, 11, "March Total"),
					new ExpectedCellValue(sheetName, 281, 11, null),
					new ExpectedCellValue(sheetName, 282, 11, null),
					new ExpectedCellValue(sheetName, 283, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 11, "January"),
					new ExpectedCellValue(sheetName, 285, 11, null),
					new ExpectedCellValue(sheetName, 286, 11, "January Total"),
					new ExpectedCellValue(sheetName, 287, 11, "February"),
					new ExpectedCellValue(sheetName, 288, 11, null),
					new ExpectedCellValue(sheetName, 289, 11, "February Total"),
					new ExpectedCellValue(sheetName, 290, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 11, "January"),
					new ExpectedCellValue(sheetName, 292, 11, null),
					new ExpectedCellValue(sheetName, 293, 11, "January Total"),
					new ExpectedCellValue(sheetName, 294, 11, "February"),
					new ExpectedCellValue(sheetName, 295, 11, null),
					new ExpectedCellValue(sheetName, 296, 11, "February Total"),
					new ExpectedCellValue(sheetName, 297, 11, null),
					new ExpectedCellValue(sheetName, 298, 11, null),
					new ExpectedCellValue(sheetName, 299, 11, null),
					new ExpectedCellValue(sheetName, 300, 11, null),
					new ExpectedCellValue(sheetName, 244, 12, "Item"),
					new ExpectedCellValue(sheetName, 245, 12, null),
					new ExpectedCellValue(sheetName, 246, 12, null),
					new ExpectedCellValue(sheetName, 247, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 12, null),
					new ExpectedCellValue(sheetName, 249, 12, null),
					new ExpectedCellValue(sheetName, 250, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 251, 12, null),
					new ExpectedCellValue(sheetName, 252, 12, null),
					new ExpectedCellValue(sheetName, 253, 12, null),
					new ExpectedCellValue(sheetName, 254, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 255, 12, null),
					new ExpectedCellValue(sheetName, 256, 12, null),
					new ExpectedCellValue(sheetName, 257, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 258, 12, null),
					new ExpectedCellValue(sheetName, 259, 12, null),
					new ExpectedCellValue(sheetName, 260, 12, null),
					new ExpectedCellValue(sheetName, 261, 12, null),
					new ExpectedCellValue(sheetName, 262, 12, null),
					new ExpectedCellValue(sheetName, 263, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 264, 12, null),
					new ExpectedCellValue(sheetName, 265, 12, null),
					new ExpectedCellValue(sheetName, 266, 12, "Tent"),
					new ExpectedCellValue(sheetName, 267, 12, null),
					new ExpectedCellValue(sheetName, 268, 12, null),
					new ExpectedCellValue(sheetName, 269, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 270, 12, null),
					new ExpectedCellValue(sheetName, 271, 12, null),
					new ExpectedCellValue(sheetName, 272, 12, null),
					new ExpectedCellValue(sheetName, 273, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 274, 12, null),
					new ExpectedCellValue(sheetName, 275, 12, null),
					new ExpectedCellValue(sheetName, 276, 12, "Tent"),
					new ExpectedCellValue(sheetName, 277, 12, null),
					new ExpectedCellValue(sheetName, 278, 12, null),
					new ExpectedCellValue(sheetName, 279, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 280, 12, null),
					new ExpectedCellValue(sheetName, 281, 12, null),
					new ExpectedCellValue(sheetName, 282, 12, null),
					new ExpectedCellValue(sheetName, 283, 12, null),
					new ExpectedCellValue(sheetName, 284, 12, null),
					new ExpectedCellValue(sheetName, 285, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 286, 12, null),
					new ExpectedCellValue(sheetName, 287, 12, null),
					new ExpectedCellValue(sheetName, 288, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 289, 12, null),
					new ExpectedCellValue(sheetName, 290, 12, null),
					new ExpectedCellValue(sheetName, 291, 12, null),
					new ExpectedCellValue(sheetName, 292, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 293, 12, null),
					new ExpectedCellValue(sheetName, 294, 12, null),
					new ExpectedCellValue(sheetName, 295, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 296, 12, null),
					new ExpectedCellValue(sheetName, 297, 12, null),
					new ExpectedCellValue(sheetName, 298, 12, null),
					new ExpectedCellValue(sheetName, 299, 12, null),
					new ExpectedCellValue(sheetName, 300, 12, null),
					new ExpectedCellValue(sheetName, 244, 13, null),
					new ExpectedCellValue(sheetName, 245, 13, null),
					new ExpectedCellValue(sheetName, 246, 13, null),
					new ExpectedCellValue(sheetName, 247, 13, 415.75),
					new ExpectedCellValue(sheetName, 248, 13, 415.75),
					new ExpectedCellValue(sheetName, 249, 13, null),
					new ExpectedCellValue(sheetName, 250, 13, 24.99),
					new ExpectedCellValue(sheetName, 251, 13, 24.99),
					new ExpectedCellValue(sheetName, 252, 13, null),
					new ExpectedCellValue(sheetName, 253, 13, null),
					new ExpectedCellValue(sheetName, 254, 13, 831.5),
					new ExpectedCellValue(sheetName, 255, 13, 831.5),
					new ExpectedCellValue(sheetName, 256, 13, null),
					new ExpectedCellValue(sheetName, 257, 13, 24.99),
					new ExpectedCellValue(sheetName, 258, 13, 24.99),
					new ExpectedCellValue(sheetName, 259, 13, 440.74),
					new ExpectedCellValue(sheetName, 260, 13, 856.49),
					new ExpectedCellValue(sheetName, 261, 13, null),
					new ExpectedCellValue(sheetName, 262, 13, null),
					new ExpectedCellValue(sheetName, 263, 13, 415.75),
					new ExpectedCellValue(sheetName, 264, 13, 415.75),
					new ExpectedCellValue(sheetName, 265, 13, null),
					new ExpectedCellValue(sheetName, 266, 13, 199d),
					new ExpectedCellValue(sheetName, 267, 13, 199d),
					new ExpectedCellValue(sheetName, 268, 13, null),
					new ExpectedCellValue(sheetName, 269, 13, 415.75),
					new ExpectedCellValue(sheetName, 270, 13, 415.75),
					new ExpectedCellValue(sheetName, 271, 13, null),
					new ExpectedCellValue(sheetName, 272, 13, null),
					new ExpectedCellValue(sheetName, 273, 13, 831.5),
					new ExpectedCellValue(sheetName, 274, 13, 831.5),
					new ExpectedCellValue(sheetName, 275, 13, null),
					new ExpectedCellValue(sheetName, 276, 13, 1194d),
					new ExpectedCellValue(sheetName, 277, 13, 1194d),
					new ExpectedCellValue(sheetName, 278, 13, null),
					new ExpectedCellValue(sheetName, 279, 13, 831.5),
					new ExpectedCellValue(sheetName, 280, 13, 831.5),
					new ExpectedCellValue(sheetName, 281, 13, 1030.5),
					new ExpectedCellValue(sheetName, 282, 13, 2857d),
					new ExpectedCellValue(sheetName, 283, 13, null),
					new ExpectedCellValue(sheetName, 284, 13, null),
					new ExpectedCellValue(sheetName, 285, 13, 415.75),
					new ExpectedCellValue(sheetName, 286, 13, 415.75),
					new ExpectedCellValue(sheetName, 287, 13, null),
					new ExpectedCellValue(sheetName, 288, 13, 99d),
					new ExpectedCellValue(sheetName, 289, 13, 99d),
					new ExpectedCellValue(sheetName, 290, 13, null),
					new ExpectedCellValue(sheetName, 291, 13, null),
					new ExpectedCellValue(sheetName, 292, 13, 415.75),
					new ExpectedCellValue(sheetName, 293, 13, 415.75),
					new ExpectedCellValue(sheetName, 294, 13, null),
					new ExpectedCellValue(sheetName, 295, 13, 99d),
					new ExpectedCellValue(sheetName, 296, 13, 99d),
					new ExpectedCellValue(sheetName, 297, 13, 514.75),
					new ExpectedCellValue(sheetName, 298, 13, 514.75),
					new ExpectedCellValue(sheetName, 299, 13, 1985.99),
					new ExpectedCellValue(sheetName, 300, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactThirdAndLastFieldsSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q244:T280"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 17, null),
					new ExpectedCellValue(sheetName, 247, 17, null),
					new ExpectedCellValue(sheetName, 248, 17, null),
					new ExpectedCellValue(sheetName, 249, 17, null),
					new ExpectedCellValue(sheetName, 250, 17, null),
					new ExpectedCellValue(sheetName, 251, 17, null),
					new ExpectedCellValue(sheetName, 252, 17, null),
					new ExpectedCellValue(sheetName, 253, 17, null),
					new ExpectedCellValue(sheetName, 254, 17, null),
					new ExpectedCellValue(sheetName, 255, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 256, 17, null),
					new ExpectedCellValue(sheetName, 257, 17, null),
					new ExpectedCellValue(sheetName, 258, 17, null),
					new ExpectedCellValue(sheetName, 259, 17, null),
					new ExpectedCellValue(sheetName, 260, 17, null),
					new ExpectedCellValue(sheetName, 261, 17, null),
					new ExpectedCellValue(sheetName, 262, 17, null),
					new ExpectedCellValue(sheetName, 263, 17, null),
					new ExpectedCellValue(sheetName, 264, 17, null),
					new ExpectedCellValue(sheetName, 265, 17, null),
					new ExpectedCellValue(sheetName, 266, 17, null),
					new ExpectedCellValue(sheetName, 267, 17, null),
					new ExpectedCellValue(sheetName, 268, 17, null),
					new ExpectedCellValue(sheetName, 269, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 270, 17, null),
					new ExpectedCellValue(sheetName, 271, 17, null),
					new ExpectedCellValue(sheetName, 272, 17, null),
					new ExpectedCellValue(sheetName, 273, 17, null),
					new ExpectedCellValue(sheetName, 274, 17, null),
					new ExpectedCellValue(sheetName, 275, 17, null),
					new ExpectedCellValue(sheetName, 276, 17, null),
					new ExpectedCellValue(sheetName, 277, 17, null),
					new ExpectedCellValue(sheetName, 278, 17, null),
					new ExpectedCellValue(sheetName, 279, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 280, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 18, "Values"),
					new ExpectedCellValue(sheetName, 245, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 18, "January"),
					new ExpectedCellValue(sheetName, 247, 18, null),
					new ExpectedCellValue(sheetName, 248, 18, "March"),
					new ExpectedCellValue(sheetName, 249, 18, null),
					new ExpectedCellValue(sheetName, 250, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 18, "January"),
					new ExpectedCellValue(sheetName, 252, 18, null),
					new ExpectedCellValue(sheetName, 253, 18, "March"),
					new ExpectedCellValue(sheetName, 254, 18, null),
					new ExpectedCellValue(sheetName, 255, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 18, "January"),
					new ExpectedCellValue(sheetName, 257, 18, null),
					new ExpectedCellValue(sheetName, 258, 18, "February"),
					new ExpectedCellValue(sheetName, 259, 18, null),
					new ExpectedCellValue(sheetName, 260, 18, "March"),
					new ExpectedCellValue(sheetName, 261, 18, null),
					new ExpectedCellValue(sheetName, 262, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 263, 18, "January"),
					new ExpectedCellValue(sheetName, 264, 18, null),
					new ExpectedCellValue(sheetName, 265, 18, "February"),
					new ExpectedCellValue(sheetName, 266, 18, null),
					new ExpectedCellValue(sheetName, 267, 18, "March"),
					new ExpectedCellValue(sheetName, 268, 18, null),
					new ExpectedCellValue(sheetName, 269, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 270, 18, "January"),
					new ExpectedCellValue(sheetName, 271, 18, null),
					new ExpectedCellValue(sheetName, 272, 18, "February"),
					new ExpectedCellValue(sheetName, 273, 18, null),
					new ExpectedCellValue(sheetName, 274, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 275, 18, "January"),
					new ExpectedCellValue(sheetName, 276, 18, null),
					new ExpectedCellValue(sheetName, 277, 18, "February"),
					new ExpectedCellValue(sheetName, 278, 18, null),
					new ExpectedCellValue(sheetName, 279, 18, null),
					new ExpectedCellValue(sheetName, 280, 18, null),
					new ExpectedCellValue(sheetName, 244, 19, "Item"),
					new ExpectedCellValue(sheetName, 245, 19, null),
					new ExpectedCellValue(sheetName, 246, 19, null),
					new ExpectedCellValue(sheetName, 247, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 19, null),
					new ExpectedCellValue(sheetName, 249, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 250, 19, null),
					new ExpectedCellValue(sheetName, 251, 19, null),
					new ExpectedCellValue(sheetName, 252, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 253, 19, null),
					new ExpectedCellValue(sheetName, 254, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 255, 19, null),
					new ExpectedCellValue(sheetName, 256, 19, null),
					new ExpectedCellValue(sheetName, 257, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 258, 19, null),
					new ExpectedCellValue(sheetName, 259, 19, "Tent"),
					new ExpectedCellValue(sheetName, 260, 19, null),
					new ExpectedCellValue(sheetName, 261, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 262, 19, null),
					new ExpectedCellValue(sheetName, 263, 19, null),
					new ExpectedCellValue(sheetName, 264, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 265, 19, null),
					new ExpectedCellValue(sheetName, 266, 19, "Tent"),
					new ExpectedCellValue(sheetName, 267, 19, null),
					new ExpectedCellValue(sheetName, 268, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 269, 19, null),
					new ExpectedCellValue(sheetName, 270, 19, null),
					new ExpectedCellValue(sheetName, 271, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 272, 19, null),
					new ExpectedCellValue(sheetName, 273, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 274, 19, null),
					new ExpectedCellValue(sheetName, 275, 19, null),
					new ExpectedCellValue(sheetName, 276, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 277, 19, null),
					new ExpectedCellValue(sheetName, 278, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 279, 19, null),
					new ExpectedCellValue(sheetName, 280, 19, null),
					new ExpectedCellValue(sheetName, 244, 20, null),
					new ExpectedCellValue(sheetName, 245, 20, null),
					new ExpectedCellValue(sheetName, 246, 20, null),
					new ExpectedCellValue(sheetName, 247, 20, 415.75),
					new ExpectedCellValue(sheetName, 248, 20, null),
					new ExpectedCellValue(sheetName, 249, 20, 24.99),
					new ExpectedCellValue(sheetName, 250, 20, null),
					new ExpectedCellValue(sheetName, 251, 20, null),
					new ExpectedCellValue(sheetName, 252, 20, 831.5),
					new ExpectedCellValue(sheetName, 253, 20, null),
					new ExpectedCellValue(sheetName, 254, 20, 24.99),
					new ExpectedCellValue(sheetName, 255, 20, null),
					new ExpectedCellValue(sheetName, 256, 20, null),
					new ExpectedCellValue(sheetName, 257, 20, 415.75),
					new ExpectedCellValue(sheetName, 258, 20, null),
					new ExpectedCellValue(sheetName, 259, 20, 199d),
					new ExpectedCellValue(sheetName, 260, 20, null),
					new ExpectedCellValue(sheetName, 261, 20, 415.75),
					new ExpectedCellValue(sheetName, 262, 20, null),
					new ExpectedCellValue(sheetName, 263, 20, null),
					new ExpectedCellValue(sheetName, 264, 20, 831.5),
					new ExpectedCellValue(sheetName, 265, 20, null),
					new ExpectedCellValue(sheetName, 266, 20, 1194d),
					new ExpectedCellValue(sheetName, 267, 20, null),
					new ExpectedCellValue(sheetName, 268, 20, 831.5),
					new ExpectedCellValue(sheetName, 269, 20, null),
					new ExpectedCellValue(sheetName, 270, 20, null),
					new ExpectedCellValue(sheetName, 271, 20, 415.75),
					new ExpectedCellValue(sheetName, 272, 20, null),
					new ExpectedCellValue(sheetName, 273, 20, 99d),
					new ExpectedCellValue(sheetName, 274, 20, null),
					new ExpectedCellValue(sheetName, 275, 20, null),
					new ExpectedCellValue(sheetName, 276, 20, 415.75),
					new ExpectedCellValue(sheetName, 277, 20, null),
					new ExpectedCellValue(sheetName, 278, 20, 99d),
					new ExpectedCellValue(sheetName, 279, 20, 1985.99),
					new ExpectedCellValue(sheetName, 280, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactThirdAndLastFieldsSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q244:T286"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 17, null),
					new ExpectedCellValue(sheetName, 247, 17, null),
					new ExpectedCellValue(sheetName, 248, 17, null),
					new ExpectedCellValue(sheetName, 249, 17, null),
					new ExpectedCellValue(sheetName, 250, 17, null),
					new ExpectedCellValue(sheetName, 251, 17, null),
					new ExpectedCellValue(sheetName, 252, 17, null),
					new ExpectedCellValue(sheetName, 253, 17, null),
					new ExpectedCellValue(sheetName, 254, 17, null),
					new ExpectedCellValue(sheetName, 255, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 256, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 257, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 258, 17, null),
					new ExpectedCellValue(sheetName, 259, 17, null),
					new ExpectedCellValue(sheetName, 260, 17, null),
					new ExpectedCellValue(sheetName, 261, 17, null),
					new ExpectedCellValue(sheetName, 262, 17, null),
					new ExpectedCellValue(sheetName, 263, 17, null),
					new ExpectedCellValue(sheetName, 264, 17, null),
					new ExpectedCellValue(sheetName, 265, 17, null),
					new ExpectedCellValue(sheetName, 266, 17, null),
					new ExpectedCellValue(sheetName, 267, 17, null),
					new ExpectedCellValue(sheetName, 268, 17, null),
					new ExpectedCellValue(sheetName, 269, 17, null),
					new ExpectedCellValue(sheetName, 270, 17, null),
					new ExpectedCellValue(sheetName, 271, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 272, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 273, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 274, 17, null),
					new ExpectedCellValue(sheetName, 275, 17, null),
					new ExpectedCellValue(sheetName, 276, 17, null),
					new ExpectedCellValue(sheetName, 277, 17, null),
					new ExpectedCellValue(sheetName, 278, 17, null),
					new ExpectedCellValue(sheetName, 279, 17, null),
					new ExpectedCellValue(sheetName, 280, 17, null),
					new ExpectedCellValue(sheetName, 281, 17, null),
					new ExpectedCellValue(sheetName, 282, 17, null),
					new ExpectedCellValue(sheetName, 283, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 285, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 286, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 18, "Values"),
					new ExpectedCellValue(sheetName, 245, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 18, "January"),
					new ExpectedCellValue(sheetName, 247, 18, null),
					new ExpectedCellValue(sheetName, 248, 18, "March"),
					new ExpectedCellValue(sheetName, 249, 18, null),
					new ExpectedCellValue(sheetName, 250, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 251, 18, "January"),
					new ExpectedCellValue(sheetName, 252, 18, null),
					new ExpectedCellValue(sheetName, 253, 18, "March"),
					new ExpectedCellValue(sheetName, 254, 18, null),
					new ExpectedCellValue(sheetName, 255, 18, null),
					new ExpectedCellValue(sheetName, 256, 18, null),
					new ExpectedCellValue(sheetName, 257, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 258, 18, "January"),
					new ExpectedCellValue(sheetName, 259, 18, null),
					new ExpectedCellValue(sheetName, 260, 18, "February"),
					new ExpectedCellValue(sheetName, 261, 18, null),
					new ExpectedCellValue(sheetName, 262, 18, "March"),
					new ExpectedCellValue(sheetName, 263, 18, null),
					new ExpectedCellValue(sheetName, 264, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 265, 18, "January"),
					new ExpectedCellValue(sheetName, 266, 18, null),
					new ExpectedCellValue(sheetName, 267, 18, "February"),
					new ExpectedCellValue(sheetName, 268, 18, null),
					new ExpectedCellValue(sheetName, 269, 18, "March"),
					new ExpectedCellValue(sheetName, 270, 18, null),
					new ExpectedCellValue(sheetName, 271, 18, null),
					new ExpectedCellValue(sheetName, 272, 18, null),
					new ExpectedCellValue(sheetName, 273, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 274, 18, "January"),
					new ExpectedCellValue(sheetName, 275, 18, null),
					new ExpectedCellValue(sheetName, 276, 18, "February"),
					new ExpectedCellValue(sheetName, 277, 18, null),
					new ExpectedCellValue(sheetName, 278, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 279, 18, "January"),
					new ExpectedCellValue(sheetName, 280, 18, null),
					new ExpectedCellValue(sheetName, 281, 18, "February"),
					new ExpectedCellValue(sheetName, 282, 18, null),
					new ExpectedCellValue(sheetName, 283, 18, null),
					new ExpectedCellValue(sheetName, 284, 18, null),
					new ExpectedCellValue(sheetName, 285, 18, null),
					new ExpectedCellValue(sheetName, 286, 18, null),
					new ExpectedCellValue(sheetName, 244, 19, "Item"),
					new ExpectedCellValue(sheetName, 245, 19, null),
					new ExpectedCellValue(sheetName, 246, 19, null),
					new ExpectedCellValue(sheetName, 247, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 19, null),
					new ExpectedCellValue(sheetName, 249, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 250, 19, null),
					new ExpectedCellValue(sheetName, 251, 19, null),
					new ExpectedCellValue(sheetName, 252, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 253, 19, null),
					new ExpectedCellValue(sheetName, 254, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 255, 19, null),
					new ExpectedCellValue(sheetName, 256, 19, null),
					new ExpectedCellValue(sheetName, 257, 19, null),
					new ExpectedCellValue(sheetName, 258, 19, null),
					new ExpectedCellValue(sheetName, 259, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 260, 19, null),
					new ExpectedCellValue(sheetName, 261, 19, "Tent"),
					new ExpectedCellValue(sheetName, 262, 19, null),
					new ExpectedCellValue(sheetName, 263, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 264, 19, null),
					new ExpectedCellValue(sheetName, 265, 19, null),
					new ExpectedCellValue(sheetName, 266, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 267, 19, null),
					new ExpectedCellValue(sheetName, 268, 19, "Tent"),
					new ExpectedCellValue(sheetName, 269, 19, null),
					new ExpectedCellValue(sheetName, 270, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 271, 19, null),
					new ExpectedCellValue(sheetName, 272, 19, null),
					new ExpectedCellValue(sheetName, 273, 19, null),
					new ExpectedCellValue(sheetName, 274, 19, null),
					new ExpectedCellValue(sheetName, 275, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 276, 19, null),
					new ExpectedCellValue(sheetName, 277, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 278, 19, null),
					new ExpectedCellValue(sheetName, 279, 19, null),
					new ExpectedCellValue(sheetName, 280, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 281, 19, null),
					new ExpectedCellValue(sheetName, 282, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 283, 19, null),
					new ExpectedCellValue(sheetName, 284, 19, null),
					new ExpectedCellValue(sheetName, 285, 19, null),
					new ExpectedCellValue(sheetName, 286, 19, null),
					new ExpectedCellValue(sheetName, 244, 20, null),
					new ExpectedCellValue(sheetName, 245, 20, null),
					new ExpectedCellValue(sheetName, 246, 20, 415.75),
					new ExpectedCellValue(sheetName, 247, 20, 415.75),
					new ExpectedCellValue(sheetName, 248, 20, 24.99),
					new ExpectedCellValue(sheetName, 249, 20, 24.99),
					new ExpectedCellValue(sheetName, 250, 20, null),
					new ExpectedCellValue(sheetName, 251, 20, 831.5),
					new ExpectedCellValue(sheetName, 252, 20, 831.5),
					new ExpectedCellValue(sheetName, 253, 20, 24.99),
					new ExpectedCellValue(sheetName, 254, 20, 24.99),
					new ExpectedCellValue(sheetName, 255, 20, 440.74),
					new ExpectedCellValue(sheetName, 256, 20, 856.49),
					new ExpectedCellValue(sheetName, 257, 20, null),
					new ExpectedCellValue(sheetName, 258, 20, 415.75),
					new ExpectedCellValue(sheetName, 259, 20, 415.75),
					new ExpectedCellValue(sheetName, 260, 20, 199d),
					new ExpectedCellValue(sheetName, 261, 20, 199d),
					new ExpectedCellValue(sheetName, 262, 20, 415.75),
					new ExpectedCellValue(sheetName, 263, 20, 415.75),
					new ExpectedCellValue(sheetName, 264, 20, null),
					new ExpectedCellValue(sheetName, 265, 20, 831.5),
					new ExpectedCellValue(sheetName, 266, 20, 831.5),
					new ExpectedCellValue(sheetName, 267, 20, 1194d),
					new ExpectedCellValue(sheetName, 268, 20, 1194d),
					new ExpectedCellValue(sheetName, 269, 20, 831.5),
					new ExpectedCellValue(sheetName, 270, 20, 831.5),
					new ExpectedCellValue(sheetName, 271, 20, 1030.5),
					new ExpectedCellValue(sheetName, 272, 20, 2857d),
					new ExpectedCellValue(sheetName, 273, 20, null),
					new ExpectedCellValue(sheetName, 274, 20, 415.75),
					new ExpectedCellValue(sheetName, 275, 20, 415.75),
					new ExpectedCellValue(sheetName, 276, 20, 99d),
					new ExpectedCellValue(sheetName, 277, 20, 99d),
					new ExpectedCellValue(sheetName, 278, 20, null),
					new ExpectedCellValue(sheetName, 279, 20, 415.75),
					new ExpectedCellValue(sheetName, 280, 20, 415.75),
					new ExpectedCellValue(sheetName, 281, 20, 99d),
					new ExpectedCellValue(sheetName, 282, 20, 99d),
					new ExpectedCellValue(sheetName, 283, 20, 514.75),
					new ExpectedCellValue(sheetName, 284, 20, 514.75),
					new ExpectedCellValue(sheetName, 285, 20, 1985.99),
					new ExpectedCellValue(sheetName, 286, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularFirstFieldNonCompactThirdAndLastFieldsSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable15"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q244:T300"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 244, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 245, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 246, 17, null),
					new ExpectedCellValue(sheetName, 247, 17, null),
					new ExpectedCellValue(sheetName, 248, 17, null),
					new ExpectedCellValue(sheetName, 249, 17, null),
					new ExpectedCellValue(sheetName, 250, 17, null),
					new ExpectedCellValue(sheetName, 251, 17, null),
					new ExpectedCellValue(sheetName, 252, 17, null),
					new ExpectedCellValue(sheetName, 253, 17, null),
					new ExpectedCellValue(sheetName, 254, 17, null),
					new ExpectedCellValue(sheetName, 255, 17, null),
					new ExpectedCellValue(sheetName, 256, 17, null),
					new ExpectedCellValue(sheetName, 257, 17, null),
					new ExpectedCellValue(sheetName, 258, 17, null),
					new ExpectedCellValue(sheetName, 259, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 260, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 261, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 262, 17, null),
					new ExpectedCellValue(sheetName, 263, 17, null),
					new ExpectedCellValue(sheetName, 264, 17, null),
					new ExpectedCellValue(sheetName, 265, 17, null),
					new ExpectedCellValue(sheetName, 266, 17, null),
					new ExpectedCellValue(sheetName, 267, 17, null),
					new ExpectedCellValue(sheetName, 268, 17, null),
					new ExpectedCellValue(sheetName, 269, 17, null),
					new ExpectedCellValue(sheetName, 270, 17, null),
					new ExpectedCellValue(sheetName, 271, 17, null),
					new ExpectedCellValue(sheetName, 272, 17, null),
					new ExpectedCellValue(sheetName, 273, 17, null),
					new ExpectedCellValue(sheetName, 274, 17, null),
					new ExpectedCellValue(sheetName, 275, 17, null),
					new ExpectedCellValue(sheetName, 276, 17, null),
					new ExpectedCellValue(sheetName, 277, 17, null),
					new ExpectedCellValue(sheetName, 278, 17, null),
					new ExpectedCellValue(sheetName, 279, 17, null),
					new ExpectedCellValue(sheetName, 280, 17, null),
					new ExpectedCellValue(sheetName, 281, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 282, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 283, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 284, 17, null),
					new ExpectedCellValue(sheetName, 285, 17, null),
					new ExpectedCellValue(sheetName, 286, 17, null),
					new ExpectedCellValue(sheetName, 287, 17, null),
					new ExpectedCellValue(sheetName, 288, 17, null),
					new ExpectedCellValue(sheetName, 289, 17, null),
					new ExpectedCellValue(sheetName, 290, 17, null),
					new ExpectedCellValue(sheetName, 291, 17, null),
					new ExpectedCellValue(sheetName, 292, 17, null),
					new ExpectedCellValue(sheetName, 293, 17, null),
					new ExpectedCellValue(sheetName, 294, 17, null),
					new ExpectedCellValue(sheetName, 295, 17, null),
					new ExpectedCellValue(sheetName, 296, 17, null),
					new ExpectedCellValue(sheetName, 297, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 298, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 299, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 300, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 244, 18, "Values"),
					new ExpectedCellValue(sheetName, 245, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 246, 18, "January"),
					new ExpectedCellValue(sheetName, 247, 18, null),
					new ExpectedCellValue(sheetName, 248, 18, "January Total"),
					new ExpectedCellValue(sheetName, 249, 18, "March"),
					new ExpectedCellValue(sheetName, 250, 18, null),
					new ExpectedCellValue(sheetName, 251, 18, "March Total"),
					new ExpectedCellValue(sheetName, 252, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 253, 18, "January"),
					new ExpectedCellValue(sheetName, 254, 18, null),
					new ExpectedCellValue(sheetName, 255, 18, "January Total"),
					new ExpectedCellValue(sheetName, 256, 18, "March"),
					new ExpectedCellValue(sheetName, 257, 18, null),
					new ExpectedCellValue(sheetName, 258, 18, "March Total"),
					new ExpectedCellValue(sheetName, 259, 18, null),
					new ExpectedCellValue(sheetName, 260, 18, null),
					new ExpectedCellValue(sheetName, 261, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 262, 18, "January"),
					new ExpectedCellValue(sheetName, 263, 18, null),
					new ExpectedCellValue(sheetName, 264, 18, "January Total"),
					new ExpectedCellValue(sheetName, 265, 18, "February"),
					new ExpectedCellValue(sheetName, 266, 18, null),
					new ExpectedCellValue(sheetName, 267, 18, "February Total"),
					new ExpectedCellValue(sheetName, 268, 18, "March"),
					new ExpectedCellValue(sheetName, 269, 18, null),
					new ExpectedCellValue(sheetName, 270, 18, "March Total"),
					new ExpectedCellValue(sheetName, 271, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 272, 18, "January"),
					new ExpectedCellValue(sheetName, 273, 18, null),
					new ExpectedCellValue(sheetName, 274, 18, "January Total"),
					new ExpectedCellValue(sheetName, 275, 18, "February"),
					new ExpectedCellValue(sheetName, 276, 18, null),
					new ExpectedCellValue(sheetName, 277, 18, "February Total"),
					new ExpectedCellValue(sheetName, 278, 18, "March"),
					new ExpectedCellValue(sheetName, 279, 18, null),
					new ExpectedCellValue(sheetName, 280, 18, "March Total"),
					new ExpectedCellValue(sheetName, 281, 18, null),
					new ExpectedCellValue(sheetName, 282, 18, null),
					new ExpectedCellValue(sheetName, 283, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 284, 18, "January"),
					new ExpectedCellValue(sheetName, 285, 18, null),
					new ExpectedCellValue(sheetName, 286, 18, "January Total"),
					new ExpectedCellValue(sheetName, 287, 18, "February"),
					new ExpectedCellValue(sheetName, 288, 18, null),
					new ExpectedCellValue(sheetName, 289, 18, "February Total"),
					new ExpectedCellValue(sheetName, 290, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 291, 18, "January"),
					new ExpectedCellValue(sheetName, 292, 18, null),
					new ExpectedCellValue(sheetName, 293, 18, "January Total"),
					new ExpectedCellValue(sheetName, 294, 18, "February"),
					new ExpectedCellValue(sheetName, 295, 18, null),
					new ExpectedCellValue(sheetName, 296, 18, "February Total"),
					new ExpectedCellValue(sheetName, 297, 18, null),
					new ExpectedCellValue(sheetName, 298, 18, null),
					new ExpectedCellValue(sheetName, 299, 18, null),
					new ExpectedCellValue(sheetName, 300, 18, null),
					new ExpectedCellValue(sheetName, 244, 19, "Item"),
					new ExpectedCellValue(sheetName, 245, 19, null),
					new ExpectedCellValue(sheetName, 246, 19, null),
					new ExpectedCellValue(sheetName, 247, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 248, 19, null),
					new ExpectedCellValue(sheetName, 249, 19, null),
					new ExpectedCellValue(sheetName, 250, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 251, 19, null),
					new ExpectedCellValue(sheetName, 252, 19, null),
					new ExpectedCellValue(sheetName, 253, 19, null),
					new ExpectedCellValue(sheetName, 254, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 255, 19, null),
					new ExpectedCellValue(sheetName, 256, 19, null),
					new ExpectedCellValue(sheetName, 257, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 258, 19, null),
					new ExpectedCellValue(sheetName, 259, 19, null),
					new ExpectedCellValue(sheetName, 260, 19, null),
					new ExpectedCellValue(sheetName, 261, 19, null),
					new ExpectedCellValue(sheetName, 262, 19, null),
					new ExpectedCellValue(sheetName, 263, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 264, 19, null),
					new ExpectedCellValue(sheetName, 265, 19, null),
					new ExpectedCellValue(sheetName, 266, 19, "Tent"),
					new ExpectedCellValue(sheetName, 267, 19, null),
					new ExpectedCellValue(sheetName, 268, 19, null),
					new ExpectedCellValue(sheetName, 269, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 270, 19, null),
					new ExpectedCellValue(sheetName, 271, 19, null),
					new ExpectedCellValue(sheetName, 272, 19, null),
					new ExpectedCellValue(sheetName, 273, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 274, 19, null),
					new ExpectedCellValue(sheetName, 275, 19, null),
					new ExpectedCellValue(sheetName, 276, 19, "Tent"),
					new ExpectedCellValue(sheetName, 277, 19, null),
					new ExpectedCellValue(sheetName, 278, 19, null),
					new ExpectedCellValue(sheetName, 279, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 280, 19, null),
					new ExpectedCellValue(sheetName, 281, 19, null),
					new ExpectedCellValue(sheetName, 282, 19, null),
					new ExpectedCellValue(sheetName, 283, 19, null),
					new ExpectedCellValue(sheetName, 284, 19, null),
					new ExpectedCellValue(sheetName, 285, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 286, 19, null),
					new ExpectedCellValue(sheetName, 287, 19, null),
					new ExpectedCellValue(sheetName, 288, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 289, 19, null),
					new ExpectedCellValue(sheetName, 290, 19, null),
					new ExpectedCellValue(sheetName, 291, 19, null),
					new ExpectedCellValue(sheetName, 292, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 293, 19, null),
					new ExpectedCellValue(sheetName, 294, 19, null),
					new ExpectedCellValue(sheetName, 295, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 296, 19, null),
					new ExpectedCellValue(sheetName, 297, 19, null),
					new ExpectedCellValue(sheetName, 298, 19, null),
					new ExpectedCellValue(sheetName, 299, 19, null),
					new ExpectedCellValue(sheetName, 300, 19, null),
					new ExpectedCellValue(sheetName, 244, 20, null),
					new ExpectedCellValue(sheetName, 245, 20, null),
					new ExpectedCellValue(sheetName, 246, 20, null),
					new ExpectedCellValue(sheetName, 247, 20, 415.75),
					new ExpectedCellValue(sheetName, 248, 20, 415.75),
					new ExpectedCellValue(sheetName, 249, 20, null),
					new ExpectedCellValue(sheetName, 250, 20, 24.99),
					new ExpectedCellValue(sheetName, 251, 20, 24.99),
					new ExpectedCellValue(sheetName, 252, 20, null),
					new ExpectedCellValue(sheetName, 253, 20, null),
					new ExpectedCellValue(sheetName, 254, 20, 831.5),
					new ExpectedCellValue(sheetName, 255, 20, 831.5),
					new ExpectedCellValue(sheetName, 256, 20, null),
					new ExpectedCellValue(sheetName, 257, 20, 24.99),
					new ExpectedCellValue(sheetName, 258, 20, 24.99),
					new ExpectedCellValue(sheetName, 259, 20, 440.74),
					new ExpectedCellValue(sheetName, 260, 20, 856.49),
					new ExpectedCellValue(sheetName, 261, 20, null),
					new ExpectedCellValue(sheetName, 262, 20, null),
					new ExpectedCellValue(sheetName, 263, 20, 415.75),
					new ExpectedCellValue(sheetName, 264, 20, 415.75),
					new ExpectedCellValue(sheetName, 265, 20, null),
					new ExpectedCellValue(sheetName, 266, 20, 199d),
					new ExpectedCellValue(sheetName, 267, 20, 199d),
					new ExpectedCellValue(sheetName, 268, 20, null),
					new ExpectedCellValue(sheetName, 269, 20, 415.75),
					new ExpectedCellValue(sheetName, 270, 20, 415.75),
					new ExpectedCellValue(sheetName, 271, 20, null),
					new ExpectedCellValue(sheetName, 272, 20, null),
					new ExpectedCellValue(sheetName, 273, 20, 831.5),
					new ExpectedCellValue(sheetName, 274, 20, 831.5),
					new ExpectedCellValue(sheetName, 275, 20, null),
					new ExpectedCellValue(sheetName, 276, 20, 1194d),
					new ExpectedCellValue(sheetName, 277, 20, 1194d),
					new ExpectedCellValue(sheetName, 278, 20, null),
					new ExpectedCellValue(sheetName, 279, 20, 831.5),
					new ExpectedCellValue(sheetName, 280, 20, 831.5),
					new ExpectedCellValue(sheetName, 281, 20, 1030.5),
					new ExpectedCellValue(sheetName, 282, 20, 2857d),
					new ExpectedCellValue(sheetName, 283, 20, null),
					new ExpectedCellValue(sheetName, 284, 20, null),
					new ExpectedCellValue(sheetName, 285, 20, 415.75),
					new ExpectedCellValue(sheetName, 286, 20, 415.75),
					new ExpectedCellValue(sheetName, 287, 20, null),
					new ExpectedCellValue(sheetName, 288, 20, 99d),
					new ExpectedCellValue(sheetName, 289, 20, 99d),
					new ExpectedCellValue(sheetName, 290, 20, null),
					new ExpectedCellValue(sheetName, 291, 20, null),
					new ExpectedCellValue(sheetName, 292, 20, 415.75),
					new ExpectedCellValue(sheetName, 293, 20, 415.75),
					new ExpectedCellValue(sheetName, 294, 20, null),
					new ExpectedCellValue(sheetName, 295, 20, 99d),
					new ExpectedCellValue(sheetName, 296, 20, 99d),
					new ExpectedCellValue(sheetName, 297, 20, 514.75),
					new ExpectedCellValue(sheetName, 298, 20, 514.75),
					new ExpectedCellValue(sheetName, 299, 20, 1985.99),
					new ExpectedCellValue(sheetName, 300, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularThirdAndLastFieldsSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable16"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C305:F330"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 3, null),
					new ExpectedCellValue(sheetName, 308, 3, null),
					new ExpectedCellValue(sheetName, 309, 3, null),
					new ExpectedCellValue(sheetName, 310, 3, null),
					new ExpectedCellValue(sheetName, 311, 3, null),
					new ExpectedCellValue(sheetName, 312, 3, null),
					new ExpectedCellValue(sheetName, 313, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 314, 3, null),
					new ExpectedCellValue(sheetName, 315, 3, null),
					new ExpectedCellValue(sheetName, 316, 3, null),
					new ExpectedCellValue(sheetName, 317, 3, null),
					new ExpectedCellValue(sheetName, 318, 3, null),
					new ExpectedCellValue(sheetName, 319, 3, null),
					new ExpectedCellValue(sheetName, 320, 3, null),
					new ExpectedCellValue(sheetName, 321, 3, null),
					new ExpectedCellValue(sheetName, 322, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 323, 3, null),
					new ExpectedCellValue(sheetName, 324, 3, null),
					new ExpectedCellValue(sheetName, 325, 3, null),
					new ExpectedCellValue(sheetName, 326, 3, null),
					new ExpectedCellValue(sheetName, 327, 3, null),
					new ExpectedCellValue(sheetName, 328, 3, null),
					new ExpectedCellValue(sheetName, 329, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 330, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 4, "Values"),
					new ExpectedCellValue(sheetName, 306, 4, null),
					new ExpectedCellValue(sheetName, 307, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 4, "January"),
					new ExpectedCellValue(sheetName, 309, 4, "March"),
					new ExpectedCellValue(sheetName, 310, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 311, 4, "January"),
					new ExpectedCellValue(sheetName, 312, 4, "March"),
					new ExpectedCellValue(sheetName, 313, 4, null),
					new ExpectedCellValue(sheetName, 314, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 315, 4, "January"),
					new ExpectedCellValue(sheetName, 316, 4, "February"),
					new ExpectedCellValue(sheetName, 317, 4, "March"),
					new ExpectedCellValue(sheetName, 318, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 4, "January"),
					new ExpectedCellValue(sheetName, 320, 4, "February"),
					new ExpectedCellValue(sheetName, 321, 4, "March"),
					new ExpectedCellValue(sheetName, 322, 4, null),
					new ExpectedCellValue(sheetName, 323, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 324, 4, "January"),
					new ExpectedCellValue(sheetName, 325, 4, "February"),
					new ExpectedCellValue(sheetName, 326, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 327, 4, "January"),
					new ExpectedCellValue(sheetName, 328, 4, "February"),
					new ExpectedCellValue(sheetName, 329, 4, null),
					new ExpectedCellValue(sheetName, 330, 4, null),
					new ExpectedCellValue(sheetName, 305, 5, "Item"),
					new ExpectedCellValue(sheetName, 306, 5, null),
					new ExpectedCellValue(sheetName, 307, 5, null),
					new ExpectedCellValue(sheetName, 308, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 310, 5, null),
					new ExpectedCellValue(sheetName, 311, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 312, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 313, 5, null),
					new ExpectedCellValue(sheetName, 314, 5, null),
					new ExpectedCellValue(sheetName, 315, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 316, 5, "Tent"),
					new ExpectedCellValue(sheetName, 317, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 318, 5, null),
					new ExpectedCellValue(sheetName, 319, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 320, 5, "Tent"),
					new ExpectedCellValue(sheetName, 321, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 5, null),
					new ExpectedCellValue(sheetName, 323, 5, null),
					new ExpectedCellValue(sheetName, 324, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 325, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 326, 5, null),
					new ExpectedCellValue(sheetName, 327, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 328, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 329, 5, null),
					new ExpectedCellValue(sheetName, 330, 5, null),
					new ExpectedCellValue(sheetName, 305, 6, null),
					new ExpectedCellValue(sheetName, 306, 6, null),
					new ExpectedCellValue(sheetName, 307, 6, null),
					new ExpectedCellValue(sheetName, 308, 6, 415.75),
					new ExpectedCellValue(sheetName, 309, 6, 24.99),
					new ExpectedCellValue(sheetName, 310, 6, null),
					new ExpectedCellValue(sheetName, 311, 6, 831.5),
					new ExpectedCellValue(sheetName, 312, 6, 24.99),
					new ExpectedCellValue(sheetName, 313, 6, null),
					new ExpectedCellValue(sheetName, 314, 6, null),
					new ExpectedCellValue(sheetName, 315, 6, 415.75),
					new ExpectedCellValue(sheetName, 316, 6, 199d),
					new ExpectedCellValue(sheetName, 317, 6, 415.75),
					new ExpectedCellValue(sheetName, 318, 6, null),
					new ExpectedCellValue(sheetName, 319, 6, 831.5),
					new ExpectedCellValue(sheetName, 320, 6, 1194d),
					new ExpectedCellValue(sheetName, 321, 6, 831.5),
					new ExpectedCellValue(sheetName, 322, 6, null),
					new ExpectedCellValue(sheetName, 323, 6, null),
					new ExpectedCellValue(sheetName, 324, 6, 415.75),
					new ExpectedCellValue(sheetName, 325, 6, 99d),
					new ExpectedCellValue(sheetName, 326, 6, null),
					new ExpectedCellValue(sheetName, 327, 6, 415.75),
					new ExpectedCellValue(sheetName, 328, 6, 99d),
					new ExpectedCellValue(sheetName, 329, 6, 1985.99),
					new ExpectedCellValue(sheetName, 330, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularThirdAndLastFieldsSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable16"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C305:F350"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 3, null),
					new ExpectedCellValue(sheetName, 308, 3, null),
					new ExpectedCellValue(sheetName, 309, 3, null),
					new ExpectedCellValue(sheetName, 310, 3, null),
					new ExpectedCellValue(sheetName, 311, 3, null),
					new ExpectedCellValue(sheetName, 312, 3, null),
					new ExpectedCellValue(sheetName, 313, 3, null),
					new ExpectedCellValue(sheetName, 314, 3, null),
					new ExpectedCellValue(sheetName, 315, 3, null),
					new ExpectedCellValue(sheetName, 316, 3, null),
					new ExpectedCellValue(sheetName, 317, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 318, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 320, 3, null),
					new ExpectedCellValue(sheetName, 321, 3, null),
					new ExpectedCellValue(sheetName, 322, 3, null),
					new ExpectedCellValue(sheetName, 323, 3, null),
					new ExpectedCellValue(sheetName, 324, 3, null),
					new ExpectedCellValue(sheetName, 325, 3, null),
					new ExpectedCellValue(sheetName, 326, 3, null),
					new ExpectedCellValue(sheetName, 327, 3, null),
					new ExpectedCellValue(sheetName, 328, 3, null),
					new ExpectedCellValue(sheetName, 329, 3, null),
					new ExpectedCellValue(sheetName, 330, 3, null),
					new ExpectedCellValue(sheetName, 331, 3, null),
					new ExpectedCellValue(sheetName, 332, 3, null),
					new ExpectedCellValue(sheetName, 333, 3, null),
					new ExpectedCellValue(sheetName, 334, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 335, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 336, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 337, 3, null),
					new ExpectedCellValue(sheetName, 338, 3, null),
					new ExpectedCellValue(sheetName, 339, 3, null),
					new ExpectedCellValue(sheetName, 340, 3, null),
					new ExpectedCellValue(sheetName, 341, 3, null),
					new ExpectedCellValue(sheetName, 342, 3, null),
					new ExpectedCellValue(sheetName, 343, 3, null),
					new ExpectedCellValue(sheetName, 344, 3, null),
					new ExpectedCellValue(sheetName, 345, 3, null),
					new ExpectedCellValue(sheetName, 346, 3, null),
					new ExpectedCellValue(sheetName, 347, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 348, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 349, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 350, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 4, "Values"),
					new ExpectedCellValue(sheetName, 306, 4, null),
					new ExpectedCellValue(sheetName, 307, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 4, "January"),
					new ExpectedCellValue(sheetName, 309, 4, "January Total"),
					new ExpectedCellValue(sheetName, 310, 4, "March"),
					new ExpectedCellValue(sheetName, 311, 4, "March Total"),
					new ExpectedCellValue(sheetName, 312, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 4, "January"),
					new ExpectedCellValue(sheetName, 314, 4, "January Total"),
					new ExpectedCellValue(sheetName, 315, 4, "March"),
					new ExpectedCellValue(sheetName, 316, 4, "March Total"),
					new ExpectedCellValue(sheetName, 317, 4, null),
					new ExpectedCellValue(sheetName, 318, 4, null),
					new ExpectedCellValue(sheetName, 319, 4, null),
					new ExpectedCellValue(sheetName, 320, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 321, 4, "January"),
					new ExpectedCellValue(sheetName, 322, 4, "January Total"),
					new ExpectedCellValue(sheetName, 323, 4, "February"),
					new ExpectedCellValue(sheetName, 324, 4, "February Total"),
					new ExpectedCellValue(sheetName, 325, 4, "March"),
					new ExpectedCellValue(sheetName, 326, 4, "March Total"),
					new ExpectedCellValue(sheetName, 327, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 328, 4, "January"),
					new ExpectedCellValue(sheetName, 329, 4, "January Total"),
					new ExpectedCellValue(sheetName, 330, 4, "February"),
					new ExpectedCellValue(sheetName, 331, 4, "February Total"),
					new ExpectedCellValue(sheetName, 332, 4, "March"),
					new ExpectedCellValue(sheetName, 333, 4, "March Total"),
					new ExpectedCellValue(sheetName, 334, 4, null),
					new ExpectedCellValue(sheetName, 335, 4, null),
					new ExpectedCellValue(sheetName, 336, 4, null),
					new ExpectedCellValue(sheetName, 337, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 338, 4, "January"),
					new ExpectedCellValue(sheetName, 339, 4, "January Total"),
					new ExpectedCellValue(sheetName, 340, 4, "February"),
					new ExpectedCellValue(sheetName, 341, 4, "February Total"),
					new ExpectedCellValue(sheetName, 342, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 343, 4, "January"),
					new ExpectedCellValue(sheetName, 344, 4, "January Total"),
					new ExpectedCellValue(sheetName, 345, 4, "February"),
					new ExpectedCellValue(sheetName, 346, 4, "February Total"),
					new ExpectedCellValue(sheetName, 347, 4, null),
					new ExpectedCellValue(sheetName, 348, 4, null),
					new ExpectedCellValue(sheetName, 349, 4, null),
					new ExpectedCellValue(sheetName, 350, 4, null),
					new ExpectedCellValue(sheetName, 305, 5, "Item"),
					new ExpectedCellValue(sheetName, 306, 5, null),
					new ExpectedCellValue(sheetName, 307, 5, null),
					new ExpectedCellValue(sheetName, 308, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 5, null),
					new ExpectedCellValue(sheetName, 310, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 5, null),
					new ExpectedCellValue(sheetName, 312, 5, null),
					new ExpectedCellValue(sheetName, 313, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 5, null),
					new ExpectedCellValue(sheetName, 315, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 5, null),
					new ExpectedCellValue(sheetName, 317, 5, null),
					new ExpectedCellValue(sheetName, 318, 5, null),
					new ExpectedCellValue(sheetName, 319, 5, null),
					new ExpectedCellValue(sheetName, 320, 5, null),
					new ExpectedCellValue(sheetName, 321, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 5, null),
					new ExpectedCellValue(sheetName, 323, 5, "Tent"),
					new ExpectedCellValue(sheetName, 324, 5, null),
					new ExpectedCellValue(sheetName, 325, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 5, null),
					new ExpectedCellValue(sheetName, 327, 5, null),
					new ExpectedCellValue(sheetName, 328, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 5, null),
					new ExpectedCellValue(sheetName, 330, 5, "Tent"),
					new ExpectedCellValue(sheetName, 331, 5, null),
					new ExpectedCellValue(sheetName, 332, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 5, null),
					new ExpectedCellValue(sheetName, 334, 5, null),
					new ExpectedCellValue(sheetName, 335, 5, null),
					new ExpectedCellValue(sheetName, 336, 5, null),
					new ExpectedCellValue(sheetName, 337, 5, null),
					new ExpectedCellValue(sheetName, 338, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 5, null),
					new ExpectedCellValue(sheetName, 340, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 5, null),
					new ExpectedCellValue(sheetName, 342, 5, null),
					new ExpectedCellValue(sheetName, 343, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 5, null),
					new ExpectedCellValue(sheetName, 345, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 5, null),
					new ExpectedCellValue(sheetName, 347, 5, null),
					new ExpectedCellValue(sheetName, 348, 5, null),
					new ExpectedCellValue(sheetName, 349, 5, null),
					new ExpectedCellValue(sheetName, 350, 5, null),
					new ExpectedCellValue(sheetName, 305, 6, null),
					new ExpectedCellValue(sheetName, 306, 6, null),
					new ExpectedCellValue(sheetName, 307, 6, null),
					new ExpectedCellValue(sheetName, 308, 6, 415.75),
					new ExpectedCellValue(sheetName, 309, 6, 415.75),
					new ExpectedCellValue(sheetName, 310, 6, 24.99),
					new ExpectedCellValue(sheetName, 311, 6, 24.99),
					new ExpectedCellValue(sheetName, 312, 6, null),
					new ExpectedCellValue(sheetName, 313, 6, 831.5),
					new ExpectedCellValue(sheetName, 314, 6, 831.5),
					new ExpectedCellValue(sheetName, 315, 6, 24.99),
					new ExpectedCellValue(sheetName, 316, 6, 24.99),
					new ExpectedCellValue(sheetName, 317, 6, 440.74),
					new ExpectedCellValue(sheetName, 318, 6, 856.49),
					new ExpectedCellValue(sheetName, 319, 6, null),
					new ExpectedCellValue(sheetName, 320, 6, null),
					new ExpectedCellValue(sheetName, 321, 6, 415.75),
					new ExpectedCellValue(sheetName, 322, 6, 415.75),
					new ExpectedCellValue(sheetName, 323, 6, 199d),
					new ExpectedCellValue(sheetName, 324, 6, 199d),
					new ExpectedCellValue(sheetName, 325, 6, 415.75),
					new ExpectedCellValue(sheetName, 326, 6, 415.75),
					new ExpectedCellValue(sheetName, 327, 6, null),
					new ExpectedCellValue(sheetName, 328, 6, 831.5),
					new ExpectedCellValue(sheetName, 329, 6, 831.5),
					new ExpectedCellValue(sheetName, 330, 6, 1194d),
					new ExpectedCellValue(sheetName, 331, 6, 1194d),
					new ExpectedCellValue(sheetName, 332, 6, 831.5),
					new ExpectedCellValue(sheetName, 333, 6, 831.5),
					new ExpectedCellValue(sheetName, 334, 6, 1030.5),
					new ExpectedCellValue(sheetName, 335, 6, 2857d),
					new ExpectedCellValue(sheetName, 336, 6, null),
					new ExpectedCellValue(sheetName, 337, 6, null),
					new ExpectedCellValue(sheetName, 338, 6, 415.75),
					new ExpectedCellValue(sheetName, 339, 6, 415.75),
					new ExpectedCellValue(sheetName, 340, 6, 99d),
					new ExpectedCellValue(sheetName, 341, 6, 99d),
					new ExpectedCellValue(sheetName, 342, 6, null),
					new ExpectedCellValue(sheetName, 343, 6, 415.75),
					new ExpectedCellValue(sheetName, 344, 6, 415.75),
					new ExpectedCellValue(sheetName, 345, 6, 99d),
					new ExpectedCellValue(sheetName, 346, 6, 99d),
					new ExpectedCellValue(sheetName, 347, 6, 514.75),
					new ExpectedCellValue(sheetName, 348, 6, 514.75),
					new ExpectedCellValue(sheetName, 349, 6, 1985.99),
					new ExpectedCellValue(sheetName, 350, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstFieldTabularThirdAndLastFieldsSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable16"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C305:F350"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 3, null),
					new ExpectedCellValue(sheetName, 308, 3, null),
					new ExpectedCellValue(sheetName, 309, 3, null),
					new ExpectedCellValue(sheetName, 310, 3, null),
					new ExpectedCellValue(sheetName, 311, 3, null),
					new ExpectedCellValue(sheetName, 312, 3, null),
					new ExpectedCellValue(sheetName, 313, 3, null),
					new ExpectedCellValue(sheetName, 314, 3, null),
					new ExpectedCellValue(sheetName, 315, 3, null),
					new ExpectedCellValue(sheetName, 316, 3, null),
					new ExpectedCellValue(sheetName, 317, 3, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 318, 3, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 320, 3, null),
					new ExpectedCellValue(sheetName, 321, 3, null),
					new ExpectedCellValue(sheetName, 322, 3, null),
					new ExpectedCellValue(sheetName, 323, 3, null),
					new ExpectedCellValue(sheetName, 324, 3, null),
					new ExpectedCellValue(sheetName, 325, 3, null),
					new ExpectedCellValue(sheetName, 326, 3, null),
					new ExpectedCellValue(sheetName, 327, 3, null),
					new ExpectedCellValue(sheetName, 328, 3, null),
					new ExpectedCellValue(sheetName, 329, 3, null),
					new ExpectedCellValue(sheetName, 330, 3, null),
					new ExpectedCellValue(sheetName, 331, 3, null),
					new ExpectedCellValue(sheetName, 332, 3, null),
					new ExpectedCellValue(sheetName, 333, 3, null),
					new ExpectedCellValue(sheetName, 334, 3, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 335, 3, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 336, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 337, 3, null),
					new ExpectedCellValue(sheetName, 338, 3, null),
					new ExpectedCellValue(sheetName, 339, 3, null),
					new ExpectedCellValue(sheetName, 340, 3, null),
					new ExpectedCellValue(sheetName, 341, 3, null),
					new ExpectedCellValue(sheetName, 342, 3, null),
					new ExpectedCellValue(sheetName, 343, 3, null),
					new ExpectedCellValue(sheetName, 344, 3, null),
					new ExpectedCellValue(sheetName, 345, 3, null),
					new ExpectedCellValue(sheetName, 346, 3, null),
					new ExpectedCellValue(sheetName, 347, 3, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 348, 3, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 349, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 350, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 4, "Values"),
					new ExpectedCellValue(sheetName, 306, 4, null),
					new ExpectedCellValue(sheetName, 307, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 4, "January"),
					new ExpectedCellValue(sheetName, 309, 4, "January Total"),
					new ExpectedCellValue(sheetName, 310, 4, "March"),
					new ExpectedCellValue(sheetName, 311, 4, "March Total"),
					new ExpectedCellValue(sheetName, 312, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 4, "January"),
					new ExpectedCellValue(sheetName, 314, 4, "January Total"),
					new ExpectedCellValue(sheetName, 315, 4, "March"),
					new ExpectedCellValue(sheetName, 316, 4, "March Total"),
					new ExpectedCellValue(sheetName, 317, 4, null),
					new ExpectedCellValue(sheetName, 318, 4, null),
					new ExpectedCellValue(sheetName, 319, 4, null),
					new ExpectedCellValue(sheetName, 320, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 321, 4, "January"),
					new ExpectedCellValue(sheetName, 322, 4, "January Total"),
					new ExpectedCellValue(sheetName, 323, 4, "February"),
					new ExpectedCellValue(sheetName, 324, 4, "February Total"),
					new ExpectedCellValue(sheetName, 325, 4, "March"),
					new ExpectedCellValue(sheetName, 326, 4, "March Total"),
					new ExpectedCellValue(sheetName, 327, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 328, 4, "January"),
					new ExpectedCellValue(sheetName, 329, 4, "January Total"),
					new ExpectedCellValue(sheetName, 330, 4, "February"),
					new ExpectedCellValue(sheetName, 331, 4, "February Total"),
					new ExpectedCellValue(sheetName, 332, 4, "March"),
					new ExpectedCellValue(sheetName, 333, 4, "March Total"),
					new ExpectedCellValue(sheetName, 334, 4, null),
					new ExpectedCellValue(sheetName, 335, 4, null),
					new ExpectedCellValue(sheetName, 336, 4, null),
					new ExpectedCellValue(sheetName, 337, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 338, 4, "January"),
					new ExpectedCellValue(sheetName, 339, 4, "January Total"),
					new ExpectedCellValue(sheetName, 340, 4, "February"),
					new ExpectedCellValue(sheetName, 341, 4, "February Total"),
					new ExpectedCellValue(sheetName, 342, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 343, 4, "January"),
					new ExpectedCellValue(sheetName, 344, 4, "January Total"),
					new ExpectedCellValue(sheetName, 345, 4, "February"),
					new ExpectedCellValue(sheetName, 346, 4, "February Total"),
					new ExpectedCellValue(sheetName, 347, 4, null),
					new ExpectedCellValue(sheetName, 348, 4, null),
					new ExpectedCellValue(sheetName, 349, 4, null),
					new ExpectedCellValue(sheetName, 350, 4, null),
					new ExpectedCellValue(sheetName, 305, 5, "Item"),
					new ExpectedCellValue(sheetName, 306, 5, null),
					new ExpectedCellValue(sheetName, 307, 5, null),
					new ExpectedCellValue(sheetName, 308, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 5, null),
					new ExpectedCellValue(sheetName, 310, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 5, null),
					new ExpectedCellValue(sheetName, 312, 5, null),
					new ExpectedCellValue(sheetName, 313, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 5, null),
					new ExpectedCellValue(sheetName, 315, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 5, null),
					new ExpectedCellValue(sheetName, 317, 5, null),
					new ExpectedCellValue(sheetName, 318, 5, null),
					new ExpectedCellValue(sheetName, 319, 5, null),
					new ExpectedCellValue(sheetName, 320, 5, null),
					new ExpectedCellValue(sheetName, 321, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 5, null),
					new ExpectedCellValue(sheetName, 323, 5, "Tent"),
					new ExpectedCellValue(sheetName, 324, 5, null),
					new ExpectedCellValue(sheetName, 325, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 5, null),
					new ExpectedCellValue(sheetName, 327, 5, null),
					new ExpectedCellValue(sheetName, 328, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 5, null),
					new ExpectedCellValue(sheetName, 330, 5, "Tent"),
					new ExpectedCellValue(sheetName, 331, 5, null),
					new ExpectedCellValue(sheetName, 332, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 5, null),
					new ExpectedCellValue(sheetName, 334, 5, null),
					new ExpectedCellValue(sheetName, 335, 5, null),
					new ExpectedCellValue(sheetName, 336, 5, null),
					new ExpectedCellValue(sheetName, 337, 5, null),
					new ExpectedCellValue(sheetName, 338, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 5, null),
					new ExpectedCellValue(sheetName, 340, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 5, null),
					new ExpectedCellValue(sheetName, 342, 5, null),
					new ExpectedCellValue(sheetName, 343, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 5, null),
					new ExpectedCellValue(sheetName, 345, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 5, null),
					new ExpectedCellValue(sheetName, 347, 5, null),
					new ExpectedCellValue(sheetName, 348, 5, null),
					new ExpectedCellValue(sheetName, 349, 5, null),
					new ExpectedCellValue(sheetName, 350, 5, null),
					new ExpectedCellValue(sheetName, 305, 6, null),
					new ExpectedCellValue(sheetName, 306, 6, null),
					new ExpectedCellValue(sheetName, 307, 6, null),
					new ExpectedCellValue(sheetName, 308, 6, 415.75),
					new ExpectedCellValue(sheetName, 309, 6, 415.75),
					new ExpectedCellValue(sheetName, 310, 6, 24.99),
					new ExpectedCellValue(sheetName, 311, 6, 24.99),
					new ExpectedCellValue(sheetName, 312, 6, null),
					new ExpectedCellValue(sheetName, 313, 6, 831.5),
					new ExpectedCellValue(sheetName, 314, 6, 831.5),
					new ExpectedCellValue(sheetName, 315, 6, 24.99),
					new ExpectedCellValue(sheetName, 316, 6, 24.99),
					new ExpectedCellValue(sheetName, 317, 6, 440.74),
					new ExpectedCellValue(sheetName, 318, 6, 856.49),
					new ExpectedCellValue(sheetName, 319, 6, null),
					new ExpectedCellValue(sheetName, 320, 6, null),
					new ExpectedCellValue(sheetName, 321, 6, 415.75),
					new ExpectedCellValue(sheetName, 322, 6, 415.75),
					new ExpectedCellValue(sheetName, 323, 6, 199d),
					new ExpectedCellValue(sheetName, 324, 6, 199d),
					new ExpectedCellValue(sheetName, 325, 6, 415.75),
					new ExpectedCellValue(sheetName, 326, 6, 415.75),
					new ExpectedCellValue(sheetName, 327, 6, null),
					new ExpectedCellValue(sheetName, 328, 6, 831.5),
					new ExpectedCellValue(sheetName, 329, 6, 831.5),
					new ExpectedCellValue(sheetName, 330, 6, 1194d),
					new ExpectedCellValue(sheetName, 331, 6, 1194d),
					new ExpectedCellValue(sheetName, 332, 6, 831.5),
					new ExpectedCellValue(sheetName, 333, 6, 831.5),
					new ExpectedCellValue(sheetName, 334, 6, 1030.5),
					new ExpectedCellValue(sheetName, 335, 6, 2857d),
					new ExpectedCellValue(sheetName, 336, 6, null),
					new ExpectedCellValue(sheetName, 337, 6, null),
					new ExpectedCellValue(sheetName, 338, 6, 415.75),
					new ExpectedCellValue(sheetName, 339, 6, 415.75),
					new ExpectedCellValue(sheetName, 340, 6, 99d),
					new ExpectedCellValue(sheetName, 341, 6, 99d),
					new ExpectedCellValue(sheetName, 342, 6, null),
					new ExpectedCellValue(sheetName, 343, 6, 415.75),
					new ExpectedCellValue(sheetName, 344, 6, 415.75),
					new ExpectedCellValue(sheetName, 345, 6, 99d),
					new ExpectedCellValue(sheetName, 346, 6, 99d),
					new ExpectedCellValue(sheetName, 347, 6, 514.75),
					new ExpectedCellValue(sheetName, 348, 6, 514.75),
					new ExpectedCellValue(sheetName, 349, 6, 1985.99),
					new ExpectedCellValue(sheetName, 350, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndLastFieldsTabularThirdFieldSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable17"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J305:M330"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 10, null),
					new ExpectedCellValue(sheetName, 308, 10, null),
					new ExpectedCellValue(sheetName, 309, 10, null),
					new ExpectedCellValue(sheetName, 310, 10, null),
					new ExpectedCellValue(sheetName, 311, 10, null),
					new ExpectedCellValue(sheetName, 312, 10, null),
					new ExpectedCellValue(sheetName, 313, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 314, 10, null),
					new ExpectedCellValue(sheetName, 315, 10, null),
					new ExpectedCellValue(sheetName, 316, 10, null),
					new ExpectedCellValue(sheetName, 317, 10, null),
					new ExpectedCellValue(sheetName, 318, 10, null),
					new ExpectedCellValue(sheetName, 319, 10, null),
					new ExpectedCellValue(sheetName, 320, 10, null),
					new ExpectedCellValue(sheetName, 321, 10, null),
					new ExpectedCellValue(sheetName, 322, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 323, 10, null),
					new ExpectedCellValue(sheetName, 324, 10, null),
					new ExpectedCellValue(sheetName, 325, 10, null),
					new ExpectedCellValue(sheetName, 326, 10, null),
					new ExpectedCellValue(sheetName, 327, 10, null),
					new ExpectedCellValue(sheetName, 328, 10, null),
					new ExpectedCellValue(sheetName, 329, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 330, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 11, "Values"),
					new ExpectedCellValue(sheetName, 306, 11, null),
					new ExpectedCellValue(sheetName, 307, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 11, "January"),
					new ExpectedCellValue(sheetName, 309, 11, "March"),
					new ExpectedCellValue(sheetName, 310, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 311, 11, "January"),
					new ExpectedCellValue(sheetName, 312, 11, "March"),
					new ExpectedCellValue(sheetName, 313, 11, null),
					new ExpectedCellValue(sheetName, 314, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 315, 11, "January"),
					new ExpectedCellValue(sheetName, 316, 11, "February"),
					new ExpectedCellValue(sheetName, 317, 11, "March"),
					new ExpectedCellValue(sheetName, 318, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 11, "January"),
					new ExpectedCellValue(sheetName, 320, 11, "February"),
					new ExpectedCellValue(sheetName, 321, 11, "March"),
					new ExpectedCellValue(sheetName, 322, 11, null),
					new ExpectedCellValue(sheetName, 323, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 324, 11, "January"),
					new ExpectedCellValue(sheetName, 325, 11, "February"),
					new ExpectedCellValue(sheetName, 326, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 327, 11, "January"),
					new ExpectedCellValue(sheetName, 328, 11, "February"),
					new ExpectedCellValue(sheetName, 329, 11, null),
					new ExpectedCellValue(sheetName, 330, 11, null),
					new ExpectedCellValue(sheetName, 305, 12, "Item"),
					new ExpectedCellValue(sheetName, 306, 12, null),
					new ExpectedCellValue(sheetName, 307, 12, null),
					new ExpectedCellValue(sheetName, 308, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 310, 12, null),
					new ExpectedCellValue(sheetName, 311, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 312, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 313, 12, null),
					new ExpectedCellValue(sheetName, 314, 12, null),
					new ExpectedCellValue(sheetName, 315, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 316, 12, "Tent"),
					new ExpectedCellValue(sheetName, 317, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 318, 12, null),
					new ExpectedCellValue(sheetName, 319, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 320, 12, "Tent"),
					new ExpectedCellValue(sheetName, 321, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 12, null),
					new ExpectedCellValue(sheetName, 323, 12, null),
					new ExpectedCellValue(sheetName, 324, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 325, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 326, 12, null),
					new ExpectedCellValue(sheetName, 327, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 328, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 329, 12, null),
					new ExpectedCellValue(sheetName, 330, 12, null),
					new ExpectedCellValue(sheetName, 305, 13, null),
					new ExpectedCellValue(sheetName, 306, 13, null),
					new ExpectedCellValue(sheetName, 307, 13, null),
					new ExpectedCellValue(sheetName, 308, 13, 415.75),
					new ExpectedCellValue(sheetName, 309, 13, 24.99),
					new ExpectedCellValue(sheetName, 310, 13, null),
					new ExpectedCellValue(sheetName, 311, 13, 831.5),
					new ExpectedCellValue(sheetName, 312, 13, 24.99),
					new ExpectedCellValue(sheetName, 313, 13, null),
					new ExpectedCellValue(sheetName, 314, 13, null),
					new ExpectedCellValue(sheetName, 315, 13, 415.75),
					new ExpectedCellValue(sheetName, 316, 13, 199d),
					new ExpectedCellValue(sheetName, 317, 13, 415.75),
					new ExpectedCellValue(sheetName, 318, 13, null),
					new ExpectedCellValue(sheetName, 319, 13, 831.5),
					new ExpectedCellValue(sheetName, 320, 13, 1194d),
					new ExpectedCellValue(sheetName, 321, 13, 831.5),
					new ExpectedCellValue(sheetName, 322, 13, null),
					new ExpectedCellValue(sheetName, 323, 13, null),
					new ExpectedCellValue(sheetName, 324, 13, 415.75),
					new ExpectedCellValue(sheetName, 325, 13, 99d),
					new ExpectedCellValue(sheetName, 326, 13, null),
					new ExpectedCellValue(sheetName, 327, 13, 415.75),
					new ExpectedCellValue(sheetName, 328, 13, 99d),
					new ExpectedCellValue(sheetName, 329, 13, 1985.99),
					new ExpectedCellValue(sheetName, 330, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndLastFieldsTabularThirdFieldSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable17"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J305:M350"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 10, null),
					new ExpectedCellValue(sheetName, 308, 10, null),
					new ExpectedCellValue(sheetName, 309, 10, null),
					new ExpectedCellValue(sheetName, 310, 10, null),
					new ExpectedCellValue(sheetName, 311, 10, null),
					new ExpectedCellValue(sheetName, 312, 10, null),
					new ExpectedCellValue(sheetName, 313, 10, null),
					new ExpectedCellValue(sheetName, 314, 10, null),
					new ExpectedCellValue(sheetName, 315, 10, null),
					new ExpectedCellValue(sheetName, 316, 10, null),
					new ExpectedCellValue(sheetName, 317, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 318, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 320, 10, null),
					new ExpectedCellValue(sheetName, 321, 10, null),
					new ExpectedCellValue(sheetName, 322, 10, null),
					new ExpectedCellValue(sheetName, 323, 10, null),
					new ExpectedCellValue(sheetName, 324, 10, null),
					new ExpectedCellValue(sheetName, 325, 10, null),
					new ExpectedCellValue(sheetName, 326, 10, null),
					new ExpectedCellValue(sheetName, 327, 10, null),
					new ExpectedCellValue(sheetName, 328, 10, null),
					new ExpectedCellValue(sheetName, 329, 10, null),
					new ExpectedCellValue(sheetName, 330, 10, null),
					new ExpectedCellValue(sheetName, 331, 10, null),
					new ExpectedCellValue(sheetName, 332, 10, null),
					new ExpectedCellValue(sheetName, 333, 10, null),
					new ExpectedCellValue(sheetName, 334, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 335, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 336, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 337, 10, null),
					new ExpectedCellValue(sheetName, 338, 10, null),
					new ExpectedCellValue(sheetName, 339, 10, null),
					new ExpectedCellValue(sheetName, 340, 10, null),
					new ExpectedCellValue(sheetName, 341, 10, null),
					new ExpectedCellValue(sheetName, 342, 10, null),
					new ExpectedCellValue(sheetName, 343, 10, null),
					new ExpectedCellValue(sheetName, 344, 10, null),
					new ExpectedCellValue(sheetName, 345, 10, null),
					new ExpectedCellValue(sheetName, 346, 10, null),
					new ExpectedCellValue(sheetName, 347, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 348, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 349, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 350, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 11, "Values"),
					new ExpectedCellValue(sheetName, 306, 11, null),
					new ExpectedCellValue(sheetName, 307, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 11, "January"),
					new ExpectedCellValue(sheetName, 309, 11, "January Total"),
					new ExpectedCellValue(sheetName, 310, 11, "March"),
					new ExpectedCellValue(sheetName, 311, 11, "March Total"),
					new ExpectedCellValue(sheetName, 312, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 11, "January"),
					new ExpectedCellValue(sheetName, 314, 11, "January Total"),
					new ExpectedCellValue(sheetName, 315, 11, "March"),
					new ExpectedCellValue(sheetName, 316, 11, "March Total"),
					new ExpectedCellValue(sheetName, 317, 11, null),
					new ExpectedCellValue(sheetName, 318, 11, null),
					new ExpectedCellValue(sheetName, 319, 11, null),
					new ExpectedCellValue(sheetName, 320, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 321, 11, "January"),
					new ExpectedCellValue(sheetName, 322, 11, "January Total"),
					new ExpectedCellValue(sheetName, 323, 11, "February"),
					new ExpectedCellValue(sheetName, 324, 11, "February Total"),
					new ExpectedCellValue(sheetName, 325, 11, "March"),
					new ExpectedCellValue(sheetName, 326, 11, "March Total"),
					new ExpectedCellValue(sheetName, 327, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 328, 11, "January"),
					new ExpectedCellValue(sheetName, 329, 11, "January Total"),
					new ExpectedCellValue(sheetName, 330, 11, "February"),
					new ExpectedCellValue(sheetName, 331, 11, "February Total"),
					new ExpectedCellValue(sheetName, 332, 11, "March"),
					new ExpectedCellValue(sheetName, 333, 11, "March Total"),
					new ExpectedCellValue(sheetName, 334, 11, null),
					new ExpectedCellValue(sheetName, 335, 11, null),
					new ExpectedCellValue(sheetName, 336, 11, null),
					new ExpectedCellValue(sheetName, 337, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 338, 11, "January"),
					new ExpectedCellValue(sheetName, 339, 11, "January Total"),
					new ExpectedCellValue(sheetName, 340, 11, "February"),
					new ExpectedCellValue(sheetName, 341, 11, "February Total"),
					new ExpectedCellValue(sheetName, 342, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 343, 11, "January"),
					new ExpectedCellValue(sheetName, 344, 11, "January Total"),
					new ExpectedCellValue(sheetName, 345, 11, "February"),
					new ExpectedCellValue(sheetName, 346, 11, "February Total"),
					new ExpectedCellValue(sheetName, 347, 11, null),
					new ExpectedCellValue(sheetName, 348, 11, null),
					new ExpectedCellValue(sheetName, 349, 11, null),
					new ExpectedCellValue(sheetName, 350, 11, null),
					new ExpectedCellValue(sheetName, 305, 12, "Item"),
					new ExpectedCellValue(sheetName, 306, 12, null),
					new ExpectedCellValue(sheetName, 307, 12, null),
					new ExpectedCellValue(sheetName, 308, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 12, null),
					new ExpectedCellValue(sheetName, 310, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 12, null),
					new ExpectedCellValue(sheetName, 312, 12, null),
					new ExpectedCellValue(sheetName, 313, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 12, null),
					new ExpectedCellValue(sheetName, 315, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 12, null),
					new ExpectedCellValue(sheetName, 317, 12, null),
					new ExpectedCellValue(sheetName, 318, 12, null),
					new ExpectedCellValue(sheetName, 319, 12, null),
					new ExpectedCellValue(sheetName, 320, 12, null),
					new ExpectedCellValue(sheetName, 321, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 12, null),
					new ExpectedCellValue(sheetName, 323, 12, "Tent"),
					new ExpectedCellValue(sheetName, 324, 12, null),
					new ExpectedCellValue(sheetName, 325, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 12, null),
					new ExpectedCellValue(sheetName, 327, 12, null),
					new ExpectedCellValue(sheetName, 328, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 12, null),
					new ExpectedCellValue(sheetName, 330, 12, "Tent"),
					new ExpectedCellValue(sheetName, 331, 12, null),
					new ExpectedCellValue(sheetName, 332, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 12, null),
					new ExpectedCellValue(sheetName, 334, 12, null),
					new ExpectedCellValue(sheetName, 335, 12, null),
					new ExpectedCellValue(sheetName, 336, 12, null),
					new ExpectedCellValue(sheetName, 337, 12, null),
					new ExpectedCellValue(sheetName, 338, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 12, null),
					new ExpectedCellValue(sheetName, 340, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 12, null),
					new ExpectedCellValue(sheetName, 342, 12, null),
					new ExpectedCellValue(sheetName, 343, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 12, null),
					new ExpectedCellValue(sheetName, 345, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 12, null),
					new ExpectedCellValue(sheetName, 347, 12, null),
					new ExpectedCellValue(sheetName, 348, 12, null),
					new ExpectedCellValue(sheetName, 349, 12, null),
					new ExpectedCellValue(sheetName, 350, 12, null),
					new ExpectedCellValue(sheetName, 305, 13, null),
					new ExpectedCellValue(sheetName, 306, 13, null),
					new ExpectedCellValue(sheetName, 307, 13, null),
					new ExpectedCellValue(sheetName, 308, 13, 415.75),
					new ExpectedCellValue(sheetName, 309, 13, 415.75),
					new ExpectedCellValue(sheetName, 310, 13, 24.99),
					new ExpectedCellValue(sheetName, 311, 13, 24.99),
					new ExpectedCellValue(sheetName, 312, 13, null),
					new ExpectedCellValue(sheetName, 313, 13, 831.5),
					new ExpectedCellValue(sheetName, 314, 13, 831.5),
					new ExpectedCellValue(sheetName, 315, 13, 24.99),
					new ExpectedCellValue(sheetName, 316, 13, 24.99),
					new ExpectedCellValue(sheetName, 317, 13, 440.74),
					new ExpectedCellValue(sheetName, 318, 13, 856.49),
					new ExpectedCellValue(sheetName, 319, 13, null),
					new ExpectedCellValue(sheetName, 320, 13, null),
					new ExpectedCellValue(sheetName, 321, 13, 415.75),
					new ExpectedCellValue(sheetName, 322, 13, 415.75),
					new ExpectedCellValue(sheetName, 323, 13, 199d),
					new ExpectedCellValue(sheetName, 324, 13, 199d),
					new ExpectedCellValue(sheetName, 325, 13, 415.75),
					new ExpectedCellValue(sheetName, 326, 13, 415.75),
					new ExpectedCellValue(sheetName, 327, 13, null),
					new ExpectedCellValue(sheetName, 328, 13, 831.5),
					new ExpectedCellValue(sheetName, 329, 13, 831.5),
					new ExpectedCellValue(sheetName, 330, 13, 1194d),
					new ExpectedCellValue(sheetName, 331, 13, 1194d),
					new ExpectedCellValue(sheetName, 332, 13, 831.5),
					new ExpectedCellValue(sheetName, 333, 13, 831.5),
					new ExpectedCellValue(sheetName, 334, 13, 1030.5),
					new ExpectedCellValue(sheetName, 335, 13, 2857d),
					new ExpectedCellValue(sheetName, 336, 13, null),
					new ExpectedCellValue(sheetName, 337, 13, null),
					new ExpectedCellValue(sheetName, 338, 13, 415.75),
					new ExpectedCellValue(sheetName, 339, 13, 415.75),
					new ExpectedCellValue(sheetName, 340, 13, 99d),
					new ExpectedCellValue(sheetName, 341, 13, 99d),
					new ExpectedCellValue(sheetName, 342, 13, null),
					new ExpectedCellValue(sheetName, 343, 13, 415.75),
					new ExpectedCellValue(sheetName, 344, 13, 415.75),
					new ExpectedCellValue(sheetName, 345, 13, 99d),
					new ExpectedCellValue(sheetName, 346, 13, 99d),
					new ExpectedCellValue(sheetName, 347, 13, 514.75),
					new ExpectedCellValue(sheetName, 348, 13, 514.75),
					new ExpectedCellValue(sheetName, 349, 13, 1985.99),
					new ExpectedCellValue(sheetName, 350, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndLastFieldsTabularThirdFieldSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable17"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J305:M350"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 10, null),
					new ExpectedCellValue(sheetName, 308, 10, null),
					new ExpectedCellValue(sheetName, 309, 10, null),
					new ExpectedCellValue(sheetName, 310, 10, null),
					new ExpectedCellValue(sheetName, 311, 10, null),
					new ExpectedCellValue(sheetName, 312, 10, null),
					new ExpectedCellValue(sheetName, 313, 10, null),
					new ExpectedCellValue(sheetName, 314, 10, null),
					new ExpectedCellValue(sheetName, 315, 10, null),
					new ExpectedCellValue(sheetName, 316, 10, null),
					new ExpectedCellValue(sheetName, 317, 10, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 318, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 320, 10, null),
					new ExpectedCellValue(sheetName, 321, 10, null),
					new ExpectedCellValue(sheetName, 322, 10, null),
					new ExpectedCellValue(sheetName, 323, 10, null),
					new ExpectedCellValue(sheetName, 324, 10, null),
					new ExpectedCellValue(sheetName, 325, 10, null),
					new ExpectedCellValue(sheetName, 326, 10, null),
					new ExpectedCellValue(sheetName, 327, 10, null),
					new ExpectedCellValue(sheetName, 328, 10, null),
					new ExpectedCellValue(sheetName, 329, 10, null),
					new ExpectedCellValue(sheetName, 330, 10, null),
					new ExpectedCellValue(sheetName, 331, 10, null),
					new ExpectedCellValue(sheetName, 332, 10, null),
					new ExpectedCellValue(sheetName, 333, 10, null),
					new ExpectedCellValue(sheetName, 334, 10, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 335, 10, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 336, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 337, 10, null),
					new ExpectedCellValue(sheetName, 338, 10, null),
					new ExpectedCellValue(sheetName, 339, 10, null),
					new ExpectedCellValue(sheetName, 340, 10, null),
					new ExpectedCellValue(sheetName, 341, 10, null),
					new ExpectedCellValue(sheetName, 342, 10, null),
					new ExpectedCellValue(sheetName, 343, 10, null),
					new ExpectedCellValue(sheetName, 344, 10, null),
					new ExpectedCellValue(sheetName, 345, 10, null),
					new ExpectedCellValue(sheetName, 346, 10, null),
					new ExpectedCellValue(sheetName, 347, 10, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 348, 10, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 349, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 350, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 11, "Values"),
					new ExpectedCellValue(sheetName, 306, 11, null),
					new ExpectedCellValue(sheetName, 307, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 11, "January"),
					new ExpectedCellValue(sheetName, 309, 11, "January Total"),
					new ExpectedCellValue(sheetName, 310, 11, "March"),
					new ExpectedCellValue(sheetName, 311, 11, "March Total"),
					new ExpectedCellValue(sheetName, 312, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 11, "January"),
					new ExpectedCellValue(sheetName, 314, 11, "January Total"),
					new ExpectedCellValue(sheetName, 315, 11, "March"),
					new ExpectedCellValue(sheetName, 316, 11, "March Total"),
					new ExpectedCellValue(sheetName, 317, 11, null),
					new ExpectedCellValue(sheetName, 318, 11, null),
					new ExpectedCellValue(sheetName, 319, 11, null),
					new ExpectedCellValue(sheetName, 320, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 321, 11, "January"),
					new ExpectedCellValue(sheetName, 322, 11, "January Total"),
					new ExpectedCellValue(sheetName, 323, 11, "February"),
					new ExpectedCellValue(sheetName, 324, 11, "February Total"),
					new ExpectedCellValue(sheetName, 325, 11, "March"),
					new ExpectedCellValue(sheetName, 326, 11, "March Total"),
					new ExpectedCellValue(sheetName, 327, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 328, 11, "January"),
					new ExpectedCellValue(sheetName, 329, 11, "January Total"),
					new ExpectedCellValue(sheetName, 330, 11, "February"),
					new ExpectedCellValue(sheetName, 331, 11, "February Total"),
					new ExpectedCellValue(sheetName, 332, 11, "March"),
					new ExpectedCellValue(sheetName, 333, 11, "March Total"),
					new ExpectedCellValue(sheetName, 334, 11, null),
					new ExpectedCellValue(sheetName, 335, 11, null),
					new ExpectedCellValue(sheetName, 336, 11, null),
					new ExpectedCellValue(sheetName, 337, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 338, 11, "January"),
					new ExpectedCellValue(sheetName, 339, 11, "January Total"),
					new ExpectedCellValue(sheetName, 340, 11, "February"),
					new ExpectedCellValue(sheetName, 341, 11, "February Total"),
					new ExpectedCellValue(sheetName, 342, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 343, 11, "January"),
					new ExpectedCellValue(sheetName, 344, 11, "January Total"),
					new ExpectedCellValue(sheetName, 345, 11, "February"),
					new ExpectedCellValue(sheetName, 346, 11, "February Total"),
					new ExpectedCellValue(sheetName, 347, 11, null),
					new ExpectedCellValue(sheetName, 348, 11, null),
					new ExpectedCellValue(sheetName, 349, 11, null),
					new ExpectedCellValue(sheetName, 350, 11, null),
					new ExpectedCellValue(sheetName, 305, 12, "Item"),
					new ExpectedCellValue(sheetName, 306, 12, null),
					new ExpectedCellValue(sheetName, 307, 12, null),
					new ExpectedCellValue(sheetName, 308, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 309, 12, null),
					new ExpectedCellValue(sheetName, 310, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 311, 12, null),
					new ExpectedCellValue(sheetName, 312, 12, null),
					new ExpectedCellValue(sheetName, 313, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 314, 12, null),
					new ExpectedCellValue(sheetName, 315, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 316, 12, null),
					new ExpectedCellValue(sheetName, 317, 12, null),
					new ExpectedCellValue(sheetName, 318, 12, null),
					new ExpectedCellValue(sheetName, 319, 12, null),
					new ExpectedCellValue(sheetName, 320, 12, null),
					new ExpectedCellValue(sheetName, 321, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 322, 12, null),
					new ExpectedCellValue(sheetName, 323, 12, "Tent"),
					new ExpectedCellValue(sheetName, 324, 12, null),
					new ExpectedCellValue(sheetName, 325, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 326, 12, null),
					new ExpectedCellValue(sheetName, 327, 12, null),
					new ExpectedCellValue(sheetName, 328, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 329, 12, null),
					new ExpectedCellValue(sheetName, 330, 12, "Tent"),
					new ExpectedCellValue(sheetName, 331, 12, null),
					new ExpectedCellValue(sheetName, 332, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 12, null),
					new ExpectedCellValue(sheetName, 334, 12, null),
					new ExpectedCellValue(sheetName, 335, 12, null),
					new ExpectedCellValue(sheetName, 336, 12, null),
					new ExpectedCellValue(sheetName, 337, 12, null),
					new ExpectedCellValue(sheetName, 338, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 339, 12, null),
					new ExpectedCellValue(sheetName, 340, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 341, 12, null),
					new ExpectedCellValue(sheetName, 342, 12, null),
					new ExpectedCellValue(sheetName, 343, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 344, 12, null),
					new ExpectedCellValue(sheetName, 345, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 346, 12, null),
					new ExpectedCellValue(sheetName, 347, 12, null),
					new ExpectedCellValue(sheetName, 348, 12, null),
					new ExpectedCellValue(sheetName, 349, 12, null),
					new ExpectedCellValue(sheetName, 350, 12, null),
					new ExpectedCellValue(sheetName, 305, 13, null),
					new ExpectedCellValue(sheetName, 306, 13, null),
					new ExpectedCellValue(sheetName, 307, 13, null),
					new ExpectedCellValue(sheetName, 308, 13, 415.75),
					new ExpectedCellValue(sheetName, 309, 13, 415.75),
					new ExpectedCellValue(sheetName, 310, 13, 24.99),
					new ExpectedCellValue(sheetName, 311, 13, 24.99),
					new ExpectedCellValue(sheetName, 312, 13, null),
					new ExpectedCellValue(sheetName, 313, 13, 831.5),
					new ExpectedCellValue(sheetName, 314, 13, 831.5),
					new ExpectedCellValue(sheetName, 315, 13, 24.99),
					new ExpectedCellValue(sheetName, 316, 13, 24.99),
					new ExpectedCellValue(sheetName, 317, 13, 440.74),
					new ExpectedCellValue(sheetName, 318, 13, 856.49),
					new ExpectedCellValue(sheetName, 319, 13, null),
					new ExpectedCellValue(sheetName, 320, 13, null),
					new ExpectedCellValue(sheetName, 321, 13, 415.75),
					new ExpectedCellValue(sheetName, 322, 13, 415.75),
					new ExpectedCellValue(sheetName, 323, 13, 199d),
					new ExpectedCellValue(sheetName, 324, 13, 199d),
					new ExpectedCellValue(sheetName, 325, 13, 415.75),
					new ExpectedCellValue(sheetName, 326, 13, 415.75),
					new ExpectedCellValue(sheetName, 327, 13, null),
					new ExpectedCellValue(sheetName, 328, 13, 831.5),
					new ExpectedCellValue(sheetName, 329, 13, 831.5),
					new ExpectedCellValue(sheetName, 330, 13, 1194d),
					new ExpectedCellValue(sheetName, 331, 13, 1194d),
					new ExpectedCellValue(sheetName, 332, 13, 831.5),
					new ExpectedCellValue(sheetName, 333, 13, 831.5),
					new ExpectedCellValue(sheetName, 334, 13, 1030.5),
					new ExpectedCellValue(sheetName, 335, 13, 2857d),
					new ExpectedCellValue(sheetName, 336, 13, null),
					new ExpectedCellValue(sheetName, 337, 13, null),
					new ExpectedCellValue(sheetName, 338, 13, 415.75),
					new ExpectedCellValue(sheetName, 339, 13, 415.75),
					new ExpectedCellValue(sheetName, 340, 13, 99d),
					new ExpectedCellValue(sheetName, 341, 13, 99d),
					new ExpectedCellValue(sheetName, 342, 13, null),
					new ExpectedCellValue(sheetName, 343, 13, 415.75),
					new ExpectedCellValue(sheetName, 344, 13, 415.75),
					new ExpectedCellValue(sheetName, 345, 13, 99d),
					new ExpectedCellValue(sheetName, 346, 13, 99d),
					new ExpectedCellValue(sheetName, 347, 13, 514.75),
					new ExpectedCellValue(sheetName, 348, 13, 514.75),
					new ExpectedCellValue(sheetName, 349, 13, 1985.99),
					new ExpectedCellValue(sheetName, 350, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndThirdFieldsTabularLastFieldSecondFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable18"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q305:T344"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 17, null),
					new ExpectedCellValue(sheetName, 308, 17, null),
					new ExpectedCellValue(sheetName, 309, 17, null),
					new ExpectedCellValue(sheetName, 310, 17, null),
					new ExpectedCellValue(sheetName, 311, 17, null),
					new ExpectedCellValue(sheetName, 312, 17, null),
					new ExpectedCellValue(sheetName, 313, 17, null),
					new ExpectedCellValue(sheetName, 314, 17, null),
					new ExpectedCellValue(sheetName, 315, 17, null),
					new ExpectedCellValue(sheetName, 316, 17, null),
					new ExpectedCellValue(sheetName, 317, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 318, 17, null),
					new ExpectedCellValue(sheetName, 319, 17, null),
					new ExpectedCellValue(sheetName, 320, 17, null),
					new ExpectedCellValue(sheetName, 321, 17, null),
					new ExpectedCellValue(sheetName, 322, 17, null),
					new ExpectedCellValue(sheetName, 323, 17, null),
					new ExpectedCellValue(sheetName, 324, 17, null),
					new ExpectedCellValue(sheetName, 325, 17, null),
					new ExpectedCellValue(sheetName, 326, 17, null),
					new ExpectedCellValue(sheetName, 327, 17, null),
					new ExpectedCellValue(sheetName, 328, 17, null),
					new ExpectedCellValue(sheetName, 329, 17, null),
					new ExpectedCellValue(sheetName, 330, 17, null),
					new ExpectedCellValue(sheetName, 331, 17, null),
					new ExpectedCellValue(sheetName, 332, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 333, 17, null),
					new ExpectedCellValue(sheetName, 334, 17, null),
					new ExpectedCellValue(sheetName, 335, 17, null),
					new ExpectedCellValue(sheetName, 336, 17, null),
					new ExpectedCellValue(sheetName, 337, 17, null),
					new ExpectedCellValue(sheetName, 338, 17, null),
					new ExpectedCellValue(sheetName, 339, 17, null),
					new ExpectedCellValue(sheetName, 340, 17, null),
					new ExpectedCellValue(sheetName, 341, 17, null),
					new ExpectedCellValue(sheetName, 342, 17, null),
					new ExpectedCellValue(sheetName, 343, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 344, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 18, "Values"),
					new ExpectedCellValue(sheetName, 306, 18, null),
					new ExpectedCellValue(sheetName, 307, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 18, "January"),
					new ExpectedCellValue(sheetName, 309, 18, null),
					new ExpectedCellValue(sheetName, 310, 18, "March"),
					new ExpectedCellValue(sheetName, 311, 18, null),
					new ExpectedCellValue(sheetName, 312, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 18, "January"),
					new ExpectedCellValue(sheetName, 314, 18, null),
					new ExpectedCellValue(sheetName, 315, 18, "March"),
					new ExpectedCellValue(sheetName, 316, 18, null),
					new ExpectedCellValue(sheetName, 317, 18, null),
					new ExpectedCellValue(sheetName, 318, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 319, 18, "January"),
					new ExpectedCellValue(sheetName, 320, 18, null),
					new ExpectedCellValue(sheetName, 321, 18, "February"),
					new ExpectedCellValue(sheetName, 322, 18, null),
					new ExpectedCellValue(sheetName, 323, 18, "March"),
					new ExpectedCellValue(sheetName, 324, 18, null),
					new ExpectedCellValue(sheetName, 325, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 326, 18, "January"),
					new ExpectedCellValue(sheetName, 327, 18, null),
					new ExpectedCellValue(sheetName, 328, 18, "February"),
					new ExpectedCellValue(sheetName, 329, 18, null),
					new ExpectedCellValue(sheetName, 330, 18, "March"),
					new ExpectedCellValue(sheetName, 331, 18, null),
					new ExpectedCellValue(sheetName, 332, 18, null),
					new ExpectedCellValue(sheetName, 333, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 334, 18, "January"),
					new ExpectedCellValue(sheetName, 335, 18, null),
					new ExpectedCellValue(sheetName, 336, 18, "February"),
					new ExpectedCellValue(sheetName, 337, 18, null),
					new ExpectedCellValue(sheetName, 338, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 339, 18, "January"),
					new ExpectedCellValue(sheetName, 340, 18, null),
					new ExpectedCellValue(sheetName, 341, 18, "February"),
					new ExpectedCellValue(sheetName, 342, 18, null),
					new ExpectedCellValue(sheetName, 343, 18, null),
					new ExpectedCellValue(sheetName, 344, 18, null),
					new ExpectedCellValue(sheetName, 305, 19, "Item"),
					new ExpectedCellValue(sheetName, 306, 19, null),
					new ExpectedCellValue(sheetName, 307, 19, null),
					new ExpectedCellValue(sheetName, 308, 19, null),
					new ExpectedCellValue(sheetName, 309, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 310, 19, null),
					new ExpectedCellValue(sheetName, 311, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 312, 19, null),
					new ExpectedCellValue(sheetName, 313, 19, null),
					new ExpectedCellValue(sheetName, 314, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 315, 19, null),
					new ExpectedCellValue(sheetName, 316, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 317, 19, null),
					new ExpectedCellValue(sheetName, 318, 19, null),
					new ExpectedCellValue(sheetName, 319, 19, null),
					new ExpectedCellValue(sheetName, 320, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 321, 19, null),
					new ExpectedCellValue(sheetName, 322, 19, "Tent"),
					new ExpectedCellValue(sheetName, 323, 19, null),
					new ExpectedCellValue(sheetName, 324, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 325, 19, null),
					new ExpectedCellValue(sheetName, 326, 19, null),
					new ExpectedCellValue(sheetName, 327, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 328, 19, null),
					new ExpectedCellValue(sheetName, 329, 19, "Tent"),
					new ExpectedCellValue(sheetName, 330, 19, null),
					new ExpectedCellValue(sheetName, 331, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 332, 19, null),
					new ExpectedCellValue(sheetName, 333, 19, null),
					new ExpectedCellValue(sheetName, 334, 19, null),
					new ExpectedCellValue(sheetName, 335, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 336, 19, null),
					new ExpectedCellValue(sheetName, 337, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 338, 19, null),
					new ExpectedCellValue(sheetName, 339, 19, null),
					new ExpectedCellValue(sheetName, 340, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 341, 19, null),
					new ExpectedCellValue(sheetName, 342, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 343, 19, null),
					new ExpectedCellValue(sheetName, 344, 19, null),
					new ExpectedCellValue(sheetName, 305, 20, null),
					new ExpectedCellValue(sheetName, 306, 20, null),
					new ExpectedCellValue(sheetName, 307, 20, null),
					new ExpectedCellValue(sheetName, 308, 20, null),
					new ExpectedCellValue(sheetName, 309, 20, 415.75),
					new ExpectedCellValue(sheetName, 310, 20, null),
					new ExpectedCellValue(sheetName, 311, 20, 24.99),
					new ExpectedCellValue(sheetName, 312, 20, null),
					new ExpectedCellValue(sheetName, 313, 20, null),
					new ExpectedCellValue(sheetName, 314, 20, 831.5),
					new ExpectedCellValue(sheetName, 315, 20, null),
					new ExpectedCellValue(sheetName, 316, 20, 24.99),
					new ExpectedCellValue(sheetName, 317, 20, null),
					new ExpectedCellValue(sheetName, 318, 20, null),
					new ExpectedCellValue(sheetName, 319, 20, null),
					new ExpectedCellValue(sheetName, 320, 20, 415.75),
					new ExpectedCellValue(sheetName, 321, 20, null),
					new ExpectedCellValue(sheetName, 322, 20, 199d),
					new ExpectedCellValue(sheetName, 323, 20, null),
					new ExpectedCellValue(sheetName, 324, 20, 415.75),
					new ExpectedCellValue(sheetName, 325, 20, null),
					new ExpectedCellValue(sheetName, 326, 20, null),
					new ExpectedCellValue(sheetName, 327, 20, 831.5),
					new ExpectedCellValue(sheetName, 328, 20, null),
					new ExpectedCellValue(sheetName, 329, 20, 1194d),
					new ExpectedCellValue(sheetName, 330, 20, null),
					new ExpectedCellValue(sheetName, 331, 20, 831.5),
					new ExpectedCellValue(sheetName, 332, 20, null),
					new ExpectedCellValue(sheetName, 333, 20, null),
					new ExpectedCellValue(sheetName, 334, 20, null),
					new ExpectedCellValue(sheetName, 335, 20, 415.75),
					new ExpectedCellValue(sheetName, 336, 20, null),
					new ExpectedCellValue(sheetName, 337, 20, 99d),
					new ExpectedCellValue(sheetName, 338, 20, null),
					new ExpectedCellValue(sheetName, 339, 20, null),
					new ExpectedCellValue(sheetName, 340, 20, 415.75),
					new ExpectedCellValue(sheetName, 341, 20, null),
					new ExpectedCellValue(sheetName, 342, 20, 99d),
					new ExpectedCellValue(sheetName, 343, 20, 1985.99),
					new ExpectedCellValue(sheetName, 344, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndThirdFieldsTabularLastFieldSecondFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable18"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q305:T350"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 17, null),
					new ExpectedCellValue(sheetName, 308, 17, null),
					new ExpectedCellValue(sheetName, 309, 17, null),
					new ExpectedCellValue(sheetName, 310, 17, null),
					new ExpectedCellValue(sheetName, 311, 17, null),
					new ExpectedCellValue(sheetName, 312, 17, null),
					new ExpectedCellValue(sheetName, 313, 17, null),
					new ExpectedCellValue(sheetName, 314, 17, null),
					new ExpectedCellValue(sheetName, 315, 17, null),
					new ExpectedCellValue(sheetName, 316, 17, null),
					new ExpectedCellValue(sheetName, 317, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 318, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 319, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 320, 17, null),
					new ExpectedCellValue(sheetName, 321, 17, null),
					new ExpectedCellValue(sheetName, 322, 17, null),
					new ExpectedCellValue(sheetName, 323, 17, null),
					new ExpectedCellValue(sheetName, 324, 17, null),
					new ExpectedCellValue(sheetName, 325, 17, null),
					new ExpectedCellValue(sheetName, 326, 17, null),
					new ExpectedCellValue(sheetName, 327, 17, null),
					new ExpectedCellValue(sheetName, 328, 17, null),
					new ExpectedCellValue(sheetName, 329, 17, null),
					new ExpectedCellValue(sheetName, 330, 17, null),
					new ExpectedCellValue(sheetName, 331, 17, null),
					new ExpectedCellValue(sheetName, 332, 17, null),
					new ExpectedCellValue(sheetName, 333, 17, null),
					new ExpectedCellValue(sheetName, 334, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 335, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 336, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 337, 17, null),
					new ExpectedCellValue(sheetName, 338, 17, null),
					new ExpectedCellValue(sheetName, 339, 17, null),
					new ExpectedCellValue(sheetName, 340, 17, null),
					new ExpectedCellValue(sheetName, 341, 17, null),
					new ExpectedCellValue(sheetName, 342, 17, null),
					new ExpectedCellValue(sheetName, 343, 17, null),
					new ExpectedCellValue(sheetName, 344, 17, null),
					new ExpectedCellValue(sheetName, 345, 17, null),
					new ExpectedCellValue(sheetName, 346, 17, null),
					new ExpectedCellValue(sheetName, 347, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 348, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 349, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 350, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 18, "Values"),
					new ExpectedCellValue(sheetName, 306, 18, null),
					new ExpectedCellValue(sheetName, 307, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 18, "January"),
					new ExpectedCellValue(sheetName, 309, 18, null),
					new ExpectedCellValue(sheetName, 310, 18, "March"),
					new ExpectedCellValue(sheetName, 311, 18, null),
					new ExpectedCellValue(sheetName, 312, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 313, 18, "January"),
					new ExpectedCellValue(sheetName, 314, 18, null),
					new ExpectedCellValue(sheetName, 315, 18, "March"),
					new ExpectedCellValue(sheetName, 316, 18, null),
					new ExpectedCellValue(sheetName, 317, 18, null),
					new ExpectedCellValue(sheetName, 318, 18, null),
					new ExpectedCellValue(sheetName, 319, 18, null),
					new ExpectedCellValue(sheetName, 320, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 321, 18, "January"),
					new ExpectedCellValue(sheetName, 322, 18, null),
					new ExpectedCellValue(sheetName, 323, 18, "February"),
					new ExpectedCellValue(sheetName, 324, 18, null),
					new ExpectedCellValue(sheetName, 325, 18, "March"),
					new ExpectedCellValue(sheetName, 326, 18, null),
					new ExpectedCellValue(sheetName, 327, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 328, 18, "January"),
					new ExpectedCellValue(sheetName, 329, 18, null),
					new ExpectedCellValue(sheetName, 330, 18, "February"),
					new ExpectedCellValue(sheetName, 331, 18, null),
					new ExpectedCellValue(sheetName, 332, 18, "March"),
					new ExpectedCellValue(sheetName, 333, 18, null),
					new ExpectedCellValue(sheetName, 334, 18, null),
					new ExpectedCellValue(sheetName, 335, 18, null),
					new ExpectedCellValue(sheetName, 336, 18, null),
					new ExpectedCellValue(sheetName, 337, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 338, 18, "January"),
					new ExpectedCellValue(sheetName, 339, 18, null),
					new ExpectedCellValue(sheetName, 340, 18, "February"),
					new ExpectedCellValue(sheetName, 341, 18, null),
					new ExpectedCellValue(sheetName, 342, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 343, 18, "January"),
					new ExpectedCellValue(sheetName, 344, 18, null),
					new ExpectedCellValue(sheetName, 345, 18, "February"),
					new ExpectedCellValue(sheetName, 346, 18, null),
					new ExpectedCellValue(sheetName, 347, 18, null),
					new ExpectedCellValue(sheetName, 348, 18, null),
					new ExpectedCellValue(sheetName, 349, 18, null),
					new ExpectedCellValue(sheetName, 350, 18, null),
					new ExpectedCellValue(sheetName, 305, 19, "Item"),
					new ExpectedCellValue(sheetName, 306, 19, null),
					new ExpectedCellValue(sheetName, 307, 19, null),
					new ExpectedCellValue(sheetName, 308, 19, null),
					new ExpectedCellValue(sheetName, 309, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 310, 19, null),
					new ExpectedCellValue(sheetName, 311, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 312, 19, null),
					new ExpectedCellValue(sheetName, 313, 19, null),
					new ExpectedCellValue(sheetName, 314, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 315, 19, null),
					new ExpectedCellValue(sheetName, 316, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 317, 19, null),
					new ExpectedCellValue(sheetName, 318, 19, null),
					new ExpectedCellValue(sheetName, 319, 19, null),
					new ExpectedCellValue(sheetName, 320, 19, null),
					new ExpectedCellValue(sheetName, 321, 19, null),
					new ExpectedCellValue(sheetName, 322, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 323, 19, null),
					new ExpectedCellValue(sheetName, 324, 19, "Tent"),
					new ExpectedCellValue(sheetName, 325, 19, null),
					new ExpectedCellValue(sheetName, 326, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 327, 19, null),
					new ExpectedCellValue(sheetName, 328, 19, null),
					new ExpectedCellValue(sheetName, 329, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 330, 19, null),
					new ExpectedCellValue(sheetName, 331, 19, "Tent"),
					new ExpectedCellValue(sheetName, 332, 19, null),
					new ExpectedCellValue(sheetName, 333, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 334, 19, null),
					new ExpectedCellValue(sheetName, 335, 19, null),
					new ExpectedCellValue(sheetName, 336, 19, null),
					new ExpectedCellValue(sheetName, 337, 19, null),
					new ExpectedCellValue(sheetName, 338, 19, null),
					new ExpectedCellValue(sheetName, 339, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 340, 19, null),
					new ExpectedCellValue(sheetName, 341, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 342, 19, null),
					new ExpectedCellValue(sheetName, 343, 19, null),
					new ExpectedCellValue(sheetName, 344, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 345, 19, null),
					new ExpectedCellValue(sheetName, 346, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 347, 19, null),
					new ExpectedCellValue(sheetName, 348, 19, null),
					new ExpectedCellValue(sheetName, 349, 19, null),
					new ExpectedCellValue(sheetName, 350, 19, null),
					new ExpectedCellValue(sheetName, 305, 20, null),
					new ExpectedCellValue(sheetName, 306, 20, null),
					new ExpectedCellValue(sheetName, 307, 20, null),
					new ExpectedCellValue(sheetName, 308, 20, 415.75),
					new ExpectedCellValue(sheetName, 309, 20, 415.75),
					new ExpectedCellValue(sheetName, 310, 20, 24.99),
					new ExpectedCellValue(sheetName, 311, 20, 24.99),
					new ExpectedCellValue(sheetName, 312, 20, null),
					new ExpectedCellValue(sheetName, 313, 20, 831.5),
					new ExpectedCellValue(sheetName, 314, 20, 831.5),
					new ExpectedCellValue(sheetName, 315, 20, 24.99),
					new ExpectedCellValue(sheetName, 316, 20, 24.99),
					new ExpectedCellValue(sheetName, 317, 20, 440.74),
					new ExpectedCellValue(sheetName, 318, 20, 856.49),
					new ExpectedCellValue(sheetName, 319, 20, null),
					new ExpectedCellValue(sheetName, 320, 20, null),
					new ExpectedCellValue(sheetName, 321, 20, 415.75),
					new ExpectedCellValue(sheetName, 322, 20, 415.75),
					new ExpectedCellValue(sheetName, 323, 20, 199d),
					new ExpectedCellValue(sheetName, 324, 20, 199d),
					new ExpectedCellValue(sheetName, 325, 20, 415.75),
					new ExpectedCellValue(sheetName, 326, 20, 415.75),
					new ExpectedCellValue(sheetName, 327, 20, null),
					new ExpectedCellValue(sheetName, 328, 20, 831.5),
					new ExpectedCellValue(sheetName, 329, 20, 831.5),
					new ExpectedCellValue(sheetName, 330, 20, 1194d),
					new ExpectedCellValue(sheetName, 331, 20, 1194d),
					new ExpectedCellValue(sheetName, 332, 20, 831.5),
					new ExpectedCellValue(sheetName, 333, 20, 831.5),
					new ExpectedCellValue(sheetName, 334, 20, 1030.5),
					new ExpectedCellValue(sheetName, 335, 20, 2857d),
					new ExpectedCellValue(sheetName, 336, 20, null),
					new ExpectedCellValue(sheetName, 337, 20, null),
					new ExpectedCellValue(sheetName, 338, 20, 415.75),
					new ExpectedCellValue(sheetName, 339, 20, 415.75),
					new ExpectedCellValue(sheetName, 340, 20, 99d),
					new ExpectedCellValue(sheetName, 341, 20, 99d),
					new ExpectedCellValue(sheetName, 342, 20, null),
					new ExpectedCellValue(sheetName, 343, 20, 415.75),
					new ExpectedCellValue(sheetName, 344, 20, 415.75),
					new ExpectedCellValue(sheetName, 345, 20, 99d),
					new ExpectedCellValue(sheetName, 346, 20, 99d),
					new ExpectedCellValue(sheetName, 347, 20, 514.75),
					new ExpectedCellValue(sheetName, 348, 20, 514.75),
					new ExpectedCellValue(sheetName, 349, 20, 1985.99),
					new ExpectedCellValue(sheetName, 350, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactFirstAndThirdFieldsTabularLastFieldSecondFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable18"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q305:T364"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 305, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 306, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 307, 17, null),
					new ExpectedCellValue(sheetName, 308, 17, null),
					new ExpectedCellValue(sheetName, 309, 17, null),
					new ExpectedCellValue(sheetName, 310, 17, null),
					new ExpectedCellValue(sheetName, 311, 17, null),
					new ExpectedCellValue(sheetName, 312, 17, null),
					new ExpectedCellValue(sheetName, 313, 17, null),
					new ExpectedCellValue(sheetName, 314, 17, null),
					new ExpectedCellValue(sheetName, 315, 17, null),
					new ExpectedCellValue(sheetName, 316, 17, null),
					new ExpectedCellValue(sheetName, 317, 17, null),
					new ExpectedCellValue(sheetName, 318, 17, null),
					new ExpectedCellValue(sheetName, 319, 17, null),
					new ExpectedCellValue(sheetName, 320, 17, null),
					new ExpectedCellValue(sheetName, 321, 17, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 322, 17, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 323, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 324, 17, null),
					new ExpectedCellValue(sheetName, 325, 17, null),
					new ExpectedCellValue(sheetName, 326, 17, null),
					new ExpectedCellValue(sheetName, 327, 17, null),
					new ExpectedCellValue(sheetName, 328, 17, null),
					new ExpectedCellValue(sheetName, 329, 17, null),
					new ExpectedCellValue(sheetName, 330, 17, null),
					new ExpectedCellValue(sheetName, 331, 17, null),
					new ExpectedCellValue(sheetName, 332, 17, null),
					new ExpectedCellValue(sheetName, 333, 17, null),
					new ExpectedCellValue(sheetName, 334, 17, null),
					new ExpectedCellValue(sheetName, 335, 17, null),
					new ExpectedCellValue(sheetName, 336, 17, null),
					new ExpectedCellValue(sheetName, 337, 17, null),
					new ExpectedCellValue(sheetName, 338, 17, null),
					new ExpectedCellValue(sheetName, 339, 17, null),
					new ExpectedCellValue(sheetName, 340, 17, null),
					new ExpectedCellValue(sheetName, 341, 17, null),
					new ExpectedCellValue(sheetName, 342, 17, null),
					new ExpectedCellValue(sheetName, 343, 17, null),
					new ExpectedCellValue(sheetName, 344, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 345, 17, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 346, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 347, 17, null),
					new ExpectedCellValue(sheetName, 348, 17, null),
					new ExpectedCellValue(sheetName, 349, 17, null),
					new ExpectedCellValue(sheetName, 350, 17, null),
					new ExpectedCellValue(sheetName, 351, 17, null),
					new ExpectedCellValue(sheetName, 352, 17, null),
					new ExpectedCellValue(sheetName, 353, 17, null),
					new ExpectedCellValue(sheetName, 354, 17, null),
					new ExpectedCellValue(sheetName, 355, 17, null),
					new ExpectedCellValue(sheetName, 356, 17, null),
					new ExpectedCellValue(sheetName, 357, 17, null),
					new ExpectedCellValue(sheetName, 358, 17, null),
					new ExpectedCellValue(sheetName, 359, 17, null),
					new ExpectedCellValue(sheetName, 360, 17, null),
					new ExpectedCellValue(sheetName, 361, 17, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 362, 17, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 363, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 364, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 305, 18, "Values"),
					new ExpectedCellValue(sheetName, 306, 18, null),
					new ExpectedCellValue(sheetName, 307, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 308, 18, "January"),
					new ExpectedCellValue(sheetName, 309, 18, null),
					new ExpectedCellValue(sheetName, 310, 18, "January Total"),
					new ExpectedCellValue(sheetName, 311, 18, "March"),
					new ExpectedCellValue(sheetName, 312, 18, null),
					new ExpectedCellValue(sheetName, 313, 18, "March Total"),
					new ExpectedCellValue(sheetName, 314, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 315, 18, "January"),
					new ExpectedCellValue(sheetName, 316, 18, null),
					new ExpectedCellValue(sheetName, 317, 18, "January Total"),
					new ExpectedCellValue(sheetName, 318, 18, "March"),
					new ExpectedCellValue(sheetName, 319, 18, null),
					new ExpectedCellValue(sheetName, 320, 18, "March Total"),
					new ExpectedCellValue(sheetName, 321, 18, null),
					new ExpectedCellValue(sheetName, 322, 18, null),
					new ExpectedCellValue(sheetName, 323, 18, null),
					new ExpectedCellValue(sheetName, 324, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 325, 18, "January"),
					new ExpectedCellValue(sheetName, 326, 18, null),
					new ExpectedCellValue(sheetName, 327, 18, "January Total"),
					new ExpectedCellValue(sheetName, 328, 18, "February"),
					new ExpectedCellValue(sheetName, 329, 18, null),
					new ExpectedCellValue(sheetName, 330, 18, "February Total"),
					new ExpectedCellValue(sheetName, 331, 18, "March"),
					new ExpectedCellValue(sheetName, 332, 18, null),
					new ExpectedCellValue(sheetName, 333, 18, "March Total"),
					new ExpectedCellValue(sheetName, 334, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 335, 18, "January"),
					new ExpectedCellValue(sheetName, 336, 18, null),
					new ExpectedCellValue(sheetName, 337, 18, "January Total"),
					new ExpectedCellValue(sheetName, 338, 18, "February"),
					new ExpectedCellValue(sheetName, 339, 18, null),
					new ExpectedCellValue(sheetName, 340, 18, "February Total"),
					new ExpectedCellValue(sheetName, 341, 18, "March"),
					new ExpectedCellValue(sheetName, 342, 18, null),
					new ExpectedCellValue(sheetName, 343, 18, "March Total"),
					new ExpectedCellValue(sheetName, 344, 18, null),
					new ExpectedCellValue(sheetName, 345, 18, null),
					new ExpectedCellValue(sheetName, 346, 18, null),
					new ExpectedCellValue(sheetName, 347, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 348, 18, "January"),
					new ExpectedCellValue(sheetName, 349, 18, null),
					new ExpectedCellValue(sheetName, 350, 18, "January Total"),
					new ExpectedCellValue(sheetName, 351, 18, "February"),
					new ExpectedCellValue(sheetName, 352, 18, null),
					new ExpectedCellValue(sheetName, 353, 18, "February Total"),
					new ExpectedCellValue(sheetName, 354, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 355, 18, "January"),
					new ExpectedCellValue(sheetName, 356, 18, null),
					new ExpectedCellValue(sheetName, 357, 18, "January Total"),
					new ExpectedCellValue(sheetName, 358, 18, "February"),
					new ExpectedCellValue(sheetName, 359, 18, null),
					new ExpectedCellValue(sheetName, 360, 18, "February Total"),
					new ExpectedCellValue(sheetName, 361, 18, null),
					new ExpectedCellValue(sheetName, 362, 18, null),
					new ExpectedCellValue(sheetName, 363, 18, null),
					new ExpectedCellValue(sheetName, 364, 18, null),
					new ExpectedCellValue(sheetName, 305, 19, "Item"),
					new ExpectedCellValue(sheetName, 306, 19, null),
					new ExpectedCellValue(sheetName, 307, 19, null),
					new ExpectedCellValue(sheetName, 308, 19, null),
					new ExpectedCellValue(sheetName, 309, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 310, 19, null),
					new ExpectedCellValue(sheetName, 311, 19, null),
					new ExpectedCellValue(sheetName, 312, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 313, 19, null),
					new ExpectedCellValue(sheetName, 314, 19, null),
					new ExpectedCellValue(sheetName, 315, 19, null),
					new ExpectedCellValue(sheetName, 316, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 317, 19, null),
					new ExpectedCellValue(sheetName, 318, 19, null),
					new ExpectedCellValue(sheetName, 319, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 320, 19, null),
					new ExpectedCellValue(sheetName, 321, 19, null),
					new ExpectedCellValue(sheetName, 322, 19, null),
					new ExpectedCellValue(sheetName, 323, 19, null),
					new ExpectedCellValue(sheetName, 324, 19, null),
					new ExpectedCellValue(sheetName, 325, 19, null),
					new ExpectedCellValue(sheetName, 326, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 327, 19, null),
					new ExpectedCellValue(sheetName, 328, 19, null),
					new ExpectedCellValue(sheetName, 329, 19, "Tent"),
					new ExpectedCellValue(sheetName, 330, 19, null),
					new ExpectedCellValue(sheetName, 331, 19, null),
					new ExpectedCellValue(sheetName, 332, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 333, 19, null),
					new ExpectedCellValue(sheetName, 334, 19, null),
					new ExpectedCellValue(sheetName, 335, 19, null),
					new ExpectedCellValue(sheetName, 336, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 337, 19, null),
					new ExpectedCellValue(sheetName, 338, 19, null),
					new ExpectedCellValue(sheetName, 339, 19, "Tent"),
					new ExpectedCellValue(sheetName, 340, 19, null),
					new ExpectedCellValue(sheetName, 341, 19, null),
					new ExpectedCellValue(sheetName, 342, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 343, 19, null),
					new ExpectedCellValue(sheetName, 344, 19, null),
					new ExpectedCellValue(sheetName, 345, 19, null),
					new ExpectedCellValue(sheetName, 346, 19, null),
					new ExpectedCellValue(sheetName, 347, 19, null),
					new ExpectedCellValue(sheetName, 348, 19, null),
					new ExpectedCellValue(sheetName, 349, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 350, 19, null),
					new ExpectedCellValue(sheetName, 351, 19, null),
					new ExpectedCellValue(sheetName, 352, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 353, 19, null),
					new ExpectedCellValue(sheetName, 354, 19, null),
					new ExpectedCellValue(sheetName, 355, 19, null),
					new ExpectedCellValue(sheetName, 356, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 357, 19, null),
					new ExpectedCellValue(sheetName, 358, 19, null),
					new ExpectedCellValue(sheetName, 359, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 360, 19, null),
					new ExpectedCellValue(sheetName, 361, 19, null),
					new ExpectedCellValue(sheetName, 362, 19, null),
					new ExpectedCellValue(sheetName, 363, 19, null),
					new ExpectedCellValue(sheetName, 364, 19, null),
					new ExpectedCellValue(sheetName, 305, 20, null),
					new ExpectedCellValue(sheetName, 306, 20, null),
					new ExpectedCellValue(sheetName, 307, 20, null),
					new ExpectedCellValue(sheetName, 308, 20, null),
					new ExpectedCellValue(sheetName, 309, 20, 415.75),
					new ExpectedCellValue(sheetName, 310, 20, 415.75),
					new ExpectedCellValue(sheetName, 311, 20, null),
					new ExpectedCellValue(sheetName, 312, 20, 24.99),
					new ExpectedCellValue(sheetName, 313, 20, 24.99),
					new ExpectedCellValue(sheetName, 314, 20, null),
					new ExpectedCellValue(sheetName, 315, 20, null),
					new ExpectedCellValue(sheetName, 316, 20, 831.5),
					new ExpectedCellValue(sheetName, 317, 20, 831.5),
					new ExpectedCellValue(sheetName, 318, 20, null),
					new ExpectedCellValue(sheetName, 319, 20, 24.99),
					new ExpectedCellValue(sheetName, 320, 20, 24.99),
					new ExpectedCellValue(sheetName, 321, 20, 440.74),
					new ExpectedCellValue(sheetName, 322, 20, 856.49),
					new ExpectedCellValue(sheetName, 323, 20, null),
					new ExpectedCellValue(sheetName, 324, 20, null),
					new ExpectedCellValue(sheetName, 325, 20, null),
					new ExpectedCellValue(sheetName, 326, 20, 415.75),
					new ExpectedCellValue(sheetName, 327, 20, 415.75),
					new ExpectedCellValue(sheetName, 328, 20, null),
					new ExpectedCellValue(sheetName, 329, 20, 199d),
					new ExpectedCellValue(sheetName, 330, 20, 199d),
					new ExpectedCellValue(sheetName, 331, 20, null),
					new ExpectedCellValue(sheetName, 332, 20, 415.75),
					new ExpectedCellValue(sheetName, 333, 20, 415.75),
					new ExpectedCellValue(sheetName, 334, 20, null),
					new ExpectedCellValue(sheetName, 335, 20, null),
					new ExpectedCellValue(sheetName, 336, 20, 831.5),
					new ExpectedCellValue(sheetName, 337, 20, 831.5),
					new ExpectedCellValue(sheetName, 338, 20, null),
					new ExpectedCellValue(sheetName, 339, 20, 1194d),
					new ExpectedCellValue(sheetName, 340, 20, 1194d),
					new ExpectedCellValue(sheetName, 341, 20, null),
					new ExpectedCellValue(sheetName, 342, 20, 831.5),
					new ExpectedCellValue(sheetName, 343, 20, 831.5),
					new ExpectedCellValue(sheetName, 344, 20, 1030.5),
					new ExpectedCellValue(sheetName, 345, 20, 2857d),
					new ExpectedCellValue(sheetName, 346, 20, null),
					new ExpectedCellValue(sheetName, 347, 20, null),
					new ExpectedCellValue(sheetName, 348, 20, null),
					new ExpectedCellValue(sheetName, 349, 20, 415.75),
					new ExpectedCellValue(sheetName, 350, 20, 415.75),
					new ExpectedCellValue(sheetName, 351, 20, null),
					new ExpectedCellValue(sheetName, 352, 20, 99d),
					new ExpectedCellValue(sheetName, 353, 20, 99d),
					new ExpectedCellValue(sheetName, 354, 20, null),
					new ExpectedCellValue(sheetName, 355, 20, null),
					new ExpectedCellValue(sheetName, 356, 20, 415.75),
					new ExpectedCellValue(sheetName, 357, 20, 415.75),
					new ExpectedCellValue(sheetName, 358, 20, null),
					new ExpectedCellValue(sheetName, 359, 20, 99d),
					new ExpectedCellValue(sheetName, 360, 20, 99d),
					new ExpectedCellValue(sheetName, 361, 20, 514.75),
					new ExpectedCellValue(sheetName, 362, 20, 514.75),
					new ExpectedCellValue(sheetName, 363, 20, 1985.99),
					new ExpectedCellValue(sheetName, 364, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondAndThirdFieldsNonCompactLastFieldFirstFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable19"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C370:F388"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 3, null),
					new ExpectedCellValue(sheetName, 374, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 375, 3, null),
					new ExpectedCellValue(sheetName, 376, 3, null),
					new ExpectedCellValue(sheetName, 377, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 378, 3, null),
					new ExpectedCellValue(sheetName, 379, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 380, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 381, 3, null),
					new ExpectedCellValue(sheetName, 382, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 383, 3, null),
					new ExpectedCellValue(sheetName, 384, 3, null),
					new ExpectedCellValue(sheetName, 385, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 386, 3, null),
					new ExpectedCellValue(sheetName, 387, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 388, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 4, "Month"),
					new ExpectedCellValue(sheetName, 371, 4, null),
					new ExpectedCellValue(sheetName, 372, 4, "January"),
					new ExpectedCellValue(sheetName, 373, 4, "March"),
					new ExpectedCellValue(sheetName, 374, 4, "January"),
					new ExpectedCellValue(sheetName, 375, 4, "February"),
					new ExpectedCellValue(sheetName, 376, 4, "March"),
					new ExpectedCellValue(sheetName, 377, 4, "January"),
					new ExpectedCellValue(sheetName, 378, 4, "February"),
					new ExpectedCellValue(sheetName, 379, 4, null),
					new ExpectedCellValue(sheetName, 380, 4, "January"),
					new ExpectedCellValue(sheetName, 381, 4, "March"),
					new ExpectedCellValue(sheetName, 382, 4, "January"),
					new ExpectedCellValue(sheetName, 383, 4, "February"),
					new ExpectedCellValue(sheetName, 384, 4, "March"),
					new ExpectedCellValue(sheetName, 385, 4, "January"),
					new ExpectedCellValue(sheetName, 386, 4, "February"),
					new ExpectedCellValue(sheetName, 387, 4, null),
					new ExpectedCellValue(sheetName, 388, 4, null),
					new ExpectedCellValue(sheetName, 370, 5, "Item"),
					new ExpectedCellValue(sheetName, 371, 5, null),
					new ExpectedCellValue(sheetName, 372, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 374, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 375, 5, "Tent"),
					new ExpectedCellValue(sheetName, 376, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 377, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 378, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 379, 5, null),
					new ExpectedCellValue(sheetName, 380, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 381, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 382, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 383, 5, "Tent"),
					new ExpectedCellValue(sheetName, 384, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 385, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 386, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 387, 5, null),
					new ExpectedCellValue(sheetName, 388, 5, null),
					new ExpectedCellValue(sheetName, 370, 6, null),
					new ExpectedCellValue(sheetName, 371, 6, null),
					new ExpectedCellValue(sheetName, 372, 6, 415.75),
					new ExpectedCellValue(sheetName, 373, 6, 24.99),
					new ExpectedCellValue(sheetName, 374, 6, 415.75),
					new ExpectedCellValue(sheetName, 375, 6, 199d),
					new ExpectedCellValue(sheetName, 376, 6, 415.75),
					new ExpectedCellValue(sheetName, 377, 6, 415.75),
					new ExpectedCellValue(sheetName, 378, 6, 99d),
					new ExpectedCellValue(sheetName, 379, 6, null),
					new ExpectedCellValue(sheetName, 380, 6, 831.5),
					new ExpectedCellValue(sheetName, 381, 6, 24.99),
					new ExpectedCellValue(sheetName, 382, 6, 831.5),
					new ExpectedCellValue(sheetName, 383, 6, 1194d),
					new ExpectedCellValue(sheetName, 384, 6, 831.5),
					new ExpectedCellValue(sheetName, 385, 6, 415.75),
					new ExpectedCellValue(sheetName, 386, 6, 99d),
					new ExpectedCellValue(sheetName, 387, 6, 1985.99),
					new ExpectedCellValue(sheetName, 388, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondAndThirdFieldsNonCompactLastFieldFirstFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable19"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C370:F408"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 3, null),
					new ExpectedCellValue(sheetName, 374, 3, null),
					new ExpectedCellValue(sheetName, 375, 3, null),
					new ExpectedCellValue(sheetName, 376, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 377, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 378, 3, null),
					new ExpectedCellValue(sheetName, 379, 3, null),
					new ExpectedCellValue(sheetName, 380, 3, null),
					new ExpectedCellValue(sheetName, 381, 3, null),
					new ExpectedCellValue(sheetName, 382, 3, null),
					new ExpectedCellValue(sheetName, 383, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 384, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 385, 3, null),
					new ExpectedCellValue(sheetName, 386, 3, null),
					new ExpectedCellValue(sheetName, 387, 3, null),
					new ExpectedCellValue(sheetName, 388, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 389, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 390, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 391, 3, null),
					new ExpectedCellValue(sheetName, 392, 3, null),
					new ExpectedCellValue(sheetName, 393, 3, null),
					new ExpectedCellValue(sheetName, 394, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 395, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 396, 3, null),
					new ExpectedCellValue(sheetName, 397, 3, null),
					new ExpectedCellValue(sheetName, 398, 3, null),
					new ExpectedCellValue(sheetName, 399, 3, null),
					new ExpectedCellValue(sheetName, 400, 3, null),
					new ExpectedCellValue(sheetName, 401, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 402, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 403, 3, null),
					new ExpectedCellValue(sheetName, 404, 3, null),
					new ExpectedCellValue(sheetName, 405, 3, null),
					new ExpectedCellValue(sheetName, 406, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 407, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 408, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 4, "Month"),
					new ExpectedCellValue(sheetName, 371, 4, null),
					new ExpectedCellValue(sheetName, 372, 4, "January"),
					new ExpectedCellValue(sheetName, 373, 4, "January Total"),
					new ExpectedCellValue(sheetName, 374, 4, "March"),
					new ExpectedCellValue(sheetName, 375, 4, "March Total"),
					new ExpectedCellValue(sheetName, 376, 4, null),
					new ExpectedCellValue(sheetName, 377, 4, "January"),
					new ExpectedCellValue(sheetName, 378, 4, "January Total"),
					new ExpectedCellValue(sheetName, 379, 4, "February"),
					new ExpectedCellValue(sheetName, 380, 4, "February Total"),
					new ExpectedCellValue(sheetName, 381, 4, "March"),
					new ExpectedCellValue(sheetName, 382, 4, "March Total"),
					new ExpectedCellValue(sheetName, 383, 4, null),
					new ExpectedCellValue(sheetName, 384, 4, "January"),
					new ExpectedCellValue(sheetName, 385, 4, "January Total"),
					new ExpectedCellValue(sheetName, 386, 4, "February"),
					new ExpectedCellValue(sheetName, 387, 4, "February Total"),
					new ExpectedCellValue(sheetName, 388, 4, null),
					new ExpectedCellValue(sheetName, 389, 4, null),
					new ExpectedCellValue(sheetName, 390, 4, "January"),
					new ExpectedCellValue(sheetName, 391, 4, "January Total"),
					new ExpectedCellValue(sheetName, 392, 4, "March"),
					new ExpectedCellValue(sheetName, 393, 4, "March Total"),
					new ExpectedCellValue(sheetName, 394, 4, null),
					new ExpectedCellValue(sheetName, 395, 4, "January"),
					new ExpectedCellValue(sheetName, 396, 4, "January Total"),
					new ExpectedCellValue(sheetName, 397, 4, "February"),
					new ExpectedCellValue(sheetName, 398, 4, "February Total"),
					new ExpectedCellValue(sheetName, 399, 4, "March"),
					new ExpectedCellValue(sheetName, 400, 4, "March Total"),
					new ExpectedCellValue(sheetName, 401, 4, null),
					new ExpectedCellValue(sheetName, 402, 4, "January"),
					new ExpectedCellValue(sheetName, 403, 4, "January Total"),
					new ExpectedCellValue(sheetName, 404, 4, "February"),
					new ExpectedCellValue(sheetName, 405, 4, "February Total"),
					new ExpectedCellValue(sheetName, 406, 4, null),
					new ExpectedCellValue(sheetName, 407, 4, null),
					new ExpectedCellValue(sheetName, 408, 4, null),
					new ExpectedCellValue(sheetName, 370, 5, "Item"),
					new ExpectedCellValue(sheetName, 371, 5, null),
					new ExpectedCellValue(sheetName, 372, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 5, null),
					new ExpectedCellValue(sheetName, 374, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 375, 5, null),
					new ExpectedCellValue(sheetName, 376, 5, null),
					new ExpectedCellValue(sheetName, 377, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 378, 5, null),
					new ExpectedCellValue(sheetName, 379, 5, "Tent"),
					new ExpectedCellValue(sheetName, 380, 5, null),
					new ExpectedCellValue(sheetName, 381, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 382, 5, null),
					new ExpectedCellValue(sheetName, 383, 5, null),
					new ExpectedCellValue(sheetName, 384, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 385, 5, null),
					new ExpectedCellValue(sheetName, 386, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 387, 5, null),
					new ExpectedCellValue(sheetName, 388, 5, null),
					new ExpectedCellValue(sheetName, 389, 5, null),
					new ExpectedCellValue(sheetName, 390, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 5, null),
					new ExpectedCellValue(sheetName, 392, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 393, 5, null),
					new ExpectedCellValue(sheetName, 394, 5, null),
					new ExpectedCellValue(sheetName, 395, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 396, 5, null),
					new ExpectedCellValue(sheetName, 397, 5, "Tent"),
					new ExpectedCellValue(sheetName, 398, 5, null),
					new ExpectedCellValue(sheetName, 399, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 400, 5, null),
					new ExpectedCellValue(sheetName, 401, 5, null),
					new ExpectedCellValue(sheetName, 402, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 403, 5, null),
					new ExpectedCellValue(sheetName, 404, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 405, 5, null),
					new ExpectedCellValue(sheetName, 406, 5, null),
					new ExpectedCellValue(sheetName, 407, 5, null),
					new ExpectedCellValue(sheetName, 408, 5, null),
					new ExpectedCellValue(sheetName, 370, 6, null),
					new ExpectedCellValue(sheetName, 371, 6, null),
					new ExpectedCellValue(sheetName, 372, 6, 415.75),
					new ExpectedCellValue(sheetName, 373, 6, 415.75),
					new ExpectedCellValue(sheetName, 374, 6, 24.99),
					new ExpectedCellValue(sheetName, 375, 6, 24.99),
					new ExpectedCellValue(sheetName, 376, 6, 440.74),
					new ExpectedCellValue(sheetName, 377, 6, 415.75),
					new ExpectedCellValue(sheetName, 378, 6, 415.75),
					new ExpectedCellValue(sheetName, 379, 6, 199d),
					new ExpectedCellValue(sheetName, 380, 6, 199d),
					new ExpectedCellValue(sheetName, 381, 6, 415.75),
					new ExpectedCellValue(sheetName, 382, 6, 415.75),
					new ExpectedCellValue(sheetName, 383, 6, 1030.5),
					new ExpectedCellValue(sheetName, 384, 6, 415.75),
					new ExpectedCellValue(sheetName, 385, 6, 415.75),
					new ExpectedCellValue(sheetName, 386, 6, 99d),
					new ExpectedCellValue(sheetName, 387, 6, 99d),
					new ExpectedCellValue(sheetName, 388, 6, 514.75),
					new ExpectedCellValue(sheetName, 389, 6, null),
					new ExpectedCellValue(sheetName, 390, 6, 831.5),
					new ExpectedCellValue(sheetName, 391, 6, 831.5),
					new ExpectedCellValue(sheetName, 392, 6, 24.99),
					new ExpectedCellValue(sheetName, 393, 6, 24.99),
					new ExpectedCellValue(sheetName, 394, 6, 856.49),
					new ExpectedCellValue(sheetName, 395, 6, 831.5),
					new ExpectedCellValue(sheetName, 396, 6, 831.5),
					new ExpectedCellValue(sheetName, 397, 6, 1194d),
					new ExpectedCellValue(sheetName, 398, 6, 1194d),
					new ExpectedCellValue(sheetName, 399, 6, 831.5),
					new ExpectedCellValue(sheetName, 400, 6, 831.5),
					new ExpectedCellValue(sheetName, 401, 6, 2857d),
					new ExpectedCellValue(sheetName, 402, 6, 415.75),
					new ExpectedCellValue(sheetName, 403, 6, 415.75),
					new ExpectedCellValue(sheetName, 404, 6, 99d),
					new ExpectedCellValue(sheetName, 405, 6, 99d),
					new ExpectedCellValue(sheetName, 406, 6, 514.75),
					new ExpectedCellValue(sheetName, 407, 6, 1985.99),
					new ExpectedCellValue(sheetName, 408, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondAndThirdFieldsNonCompactLastFieldFirstFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable19"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C370:F408"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 3, null),
					new ExpectedCellValue(sheetName, 374, 3, null),
					new ExpectedCellValue(sheetName, 375, 3, null),
					new ExpectedCellValue(sheetName, 376, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 377, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 378, 3, null),
					new ExpectedCellValue(sheetName, 379, 3, null),
					new ExpectedCellValue(sheetName, 380, 3, null),
					new ExpectedCellValue(sheetName, 381, 3, null),
					new ExpectedCellValue(sheetName, 382, 3, null),
					new ExpectedCellValue(sheetName, 383, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 384, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 385, 3, null),
					new ExpectedCellValue(sheetName, 386, 3, null),
					new ExpectedCellValue(sheetName, 387, 3, null),
					new ExpectedCellValue(sheetName, 388, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 389, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 390, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 391, 3, null),
					new ExpectedCellValue(sheetName, 392, 3, null),
					new ExpectedCellValue(sheetName, 393, 3, null),
					new ExpectedCellValue(sheetName, 394, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 395, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 396, 3, null),
					new ExpectedCellValue(sheetName, 397, 3, null),
					new ExpectedCellValue(sheetName, 398, 3, null),
					new ExpectedCellValue(sheetName, 399, 3, null),
					new ExpectedCellValue(sheetName, 400, 3, null),
					new ExpectedCellValue(sheetName, 401, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 402, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 403, 3, null),
					new ExpectedCellValue(sheetName, 404, 3, null),
					new ExpectedCellValue(sheetName, 405, 3, null),
					new ExpectedCellValue(sheetName, 406, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 407, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 408, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 4, "Month"),
					new ExpectedCellValue(sheetName, 371, 4, null),
					new ExpectedCellValue(sheetName, 372, 4, "January"),
					new ExpectedCellValue(sheetName, 373, 4, "January Total"),
					new ExpectedCellValue(sheetName, 374, 4, "March"),
					new ExpectedCellValue(sheetName, 375, 4, "March Total"),
					new ExpectedCellValue(sheetName, 376, 4, null),
					new ExpectedCellValue(sheetName, 377, 4, "January"),
					new ExpectedCellValue(sheetName, 378, 4, "January Total"),
					new ExpectedCellValue(sheetName, 379, 4, "February"),
					new ExpectedCellValue(sheetName, 380, 4, "February Total"),
					new ExpectedCellValue(sheetName, 381, 4, "March"),
					new ExpectedCellValue(sheetName, 382, 4, "March Total"),
					new ExpectedCellValue(sheetName, 383, 4, null),
					new ExpectedCellValue(sheetName, 384, 4, "January"),
					new ExpectedCellValue(sheetName, 385, 4, "January Total"),
					new ExpectedCellValue(sheetName, 386, 4, "February"),
					new ExpectedCellValue(sheetName, 387, 4, "February Total"),
					new ExpectedCellValue(sheetName, 388, 4, null),
					new ExpectedCellValue(sheetName, 389, 4, null),
					new ExpectedCellValue(sheetName, 390, 4, "January"),
					new ExpectedCellValue(sheetName, 391, 4, "January Total"),
					new ExpectedCellValue(sheetName, 392, 4, "March"),
					new ExpectedCellValue(sheetName, 393, 4, "March Total"),
					new ExpectedCellValue(sheetName, 394, 4, null),
					new ExpectedCellValue(sheetName, 395, 4, "January"),
					new ExpectedCellValue(sheetName, 396, 4, "January Total"),
					new ExpectedCellValue(sheetName, 397, 4, "February"),
					new ExpectedCellValue(sheetName, 398, 4, "February Total"),
					new ExpectedCellValue(sheetName, 399, 4, "March"),
					new ExpectedCellValue(sheetName, 400, 4, "March Total"),
					new ExpectedCellValue(sheetName, 401, 4, null),
					new ExpectedCellValue(sheetName, 402, 4, "January"),
					new ExpectedCellValue(sheetName, 403, 4, "January Total"),
					new ExpectedCellValue(sheetName, 404, 4, "February"),
					new ExpectedCellValue(sheetName, 405, 4, "February Total"),
					new ExpectedCellValue(sheetName, 406, 4, null),
					new ExpectedCellValue(sheetName, 407, 4, null),
					new ExpectedCellValue(sheetName, 408, 4, null),
					new ExpectedCellValue(sheetName, 370, 5, "Item"),
					new ExpectedCellValue(sheetName, 371, 5, null),
					new ExpectedCellValue(sheetName, 372, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 373, 5, null),
					new ExpectedCellValue(sheetName, 374, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 375, 5, null),
					new ExpectedCellValue(sheetName, 376, 5, null),
					new ExpectedCellValue(sheetName, 377, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 378, 5, null),
					new ExpectedCellValue(sheetName, 379, 5, "Tent"),
					new ExpectedCellValue(sheetName, 380, 5, null),
					new ExpectedCellValue(sheetName, 381, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 382, 5, null),
					new ExpectedCellValue(sheetName, 383, 5, null),
					new ExpectedCellValue(sheetName, 384, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 385, 5, null),
					new ExpectedCellValue(sheetName, 386, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 387, 5, null),
					new ExpectedCellValue(sheetName, 388, 5, null),
					new ExpectedCellValue(sheetName, 389, 5, null),
					new ExpectedCellValue(sheetName, 390, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 5, null),
					new ExpectedCellValue(sheetName, 392, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 393, 5, null),
					new ExpectedCellValue(sheetName, 394, 5, null),
					new ExpectedCellValue(sheetName, 395, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 396, 5, null),
					new ExpectedCellValue(sheetName, 397, 5, "Tent"),
					new ExpectedCellValue(sheetName, 398, 5, null),
					new ExpectedCellValue(sheetName, 399, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 400, 5, null),
					new ExpectedCellValue(sheetName, 401, 5, null),
					new ExpectedCellValue(sheetName, 402, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 403, 5, null),
					new ExpectedCellValue(sheetName, 404, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 405, 5, null),
					new ExpectedCellValue(sheetName, 406, 5, null),
					new ExpectedCellValue(sheetName, 407, 5, null),
					new ExpectedCellValue(sheetName, 408, 5, null),
					new ExpectedCellValue(sheetName, 370, 6, null),
					new ExpectedCellValue(sheetName, 371, 6, null),
					new ExpectedCellValue(sheetName, 372, 6, 415.75),
					new ExpectedCellValue(sheetName, 373, 6, 415.75),
					new ExpectedCellValue(sheetName, 374, 6, 24.99),
					new ExpectedCellValue(sheetName, 375, 6, 24.99),
					new ExpectedCellValue(sheetName, 376, 6, 440.74),
					new ExpectedCellValue(sheetName, 377, 6, 415.75),
					new ExpectedCellValue(sheetName, 378, 6, 415.75),
					new ExpectedCellValue(sheetName, 379, 6, 199d),
					new ExpectedCellValue(sheetName, 380, 6, 199d),
					new ExpectedCellValue(sheetName, 381, 6, 415.75),
					new ExpectedCellValue(sheetName, 382, 6, 415.75),
					new ExpectedCellValue(sheetName, 383, 6, 1030.5),
					new ExpectedCellValue(sheetName, 384, 6, 415.75),
					new ExpectedCellValue(sheetName, 385, 6, 415.75),
					new ExpectedCellValue(sheetName, 386, 6, 99d),
					new ExpectedCellValue(sheetName, 387, 6, 99d),
					new ExpectedCellValue(sheetName, 388, 6, 514.75),
					new ExpectedCellValue(sheetName, 389, 6, null),
					new ExpectedCellValue(sheetName, 390, 6, 831.5),
					new ExpectedCellValue(sheetName, 391, 6, 831.5),
					new ExpectedCellValue(sheetName, 392, 6, 24.99),
					new ExpectedCellValue(sheetName, 393, 6, 24.99),
					new ExpectedCellValue(sheetName, 394, 6, 856.49),
					new ExpectedCellValue(sheetName, 395, 6, 831.5),
					new ExpectedCellValue(sheetName, 396, 6, 831.5),
					new ExpectedCellValue(sheetName, 397, 6, 1194d),
					new ExpectedCellValue(sheetName, 398, 6, 1194d),
					new ExpectedCellValue(sheetName, 399, 6, 831.5),
					new ExpectedCellValue(sheetName, 400, 6, 831.5),
					new ExpectedCellValue(sheetName, 401, 6, 2857d),
					new ExpectedCellValue(sheetName, 402, 6, 415.75),
					new ExpectedCellValue(sheetName, 403, 6, 415.75),
					new ExpectedCellValue(sheetName, 404, 6, 99d),
					new ExpectedCellValue(sheetName, 405, 6, 99d),
					new ExpectedCellValue(sheetName, 406, 6, 514.75),
					new ExpectedCellValue(sheetName, 407, 6, 1985.99),
					new ExpectedCellValue(sheetName, 408, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondAndLastFieldsNonCompactThirdFieldFirstFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable20"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J370:M402"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 10, null),
					new ExpectedCellValue(sheetName, 374, 10, null),
					new ExpectedCellValue(sheetName, 375, 10, null),
					new ExpectedCellValue(sheetName, 376, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 377, 10, null),
					new ExpectedCellValue(sheetName, 378, 10, null),
					new ExpectedCellValue(sheetName, 379, 10, null),
					new ExpectedCellValue(sheetName, 380, 10, null),
					new ExpectedCellValue(sheetName, 381, 10, null),
					new ExpectedCellValue(sheetName, 382, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 383, 10, null),
					new ExpectedCellValue(sheetName, 384, 10, null),
					new ExpectedCellValue(sheetName, 385, 10, null),
					new ExpectedCellValue(sheetName, 386, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 387, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 388, 10, null),
					new ExpectedCellValue(sheetName, 389, 10, null),
					new ExpectedCellValue(sheetName, 390, 10, null),
					new ExpectedCellValue(sheetName, 391, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 392, 10, null),
					new ExpectedCellValue(sheetName, 393, 10, null),
					new ExpectedCellValue(sheetName, 394, 10, null),
					new ExpectedCellValue(sheetName, 395, 10, null),
					new ExpectedCellValue(sheetName, 396, 10, null),
					new ExpectedCellValue(sheetName, 397, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 398, 10, null),
					new ExpectedCellValue(sheetName, 399, 10, null),
					new ExpectedCellValue(sheetName, 400, 10, null),
					new ExpectedCellValue(sheetName, 401, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 402, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 11, "Month"),
					new ExpectedCellValue(sheetName, 371, 11, null),
					new ExpectedCellValue(sheetName, 372, 11, "January"),
					new ExpectedCellValue(sheetName, 373, 11, null),
					new ExpectedCellValue(sheetName, 374, 11, "March"),
					new ExpectedCellValue(sheetName, 375, 11, null),
					new ExpectedCellValue(sheetName, 376, 11, "January"),
					new ExpectedCellValue(sheetName, 377, 11, null),
					new ExpectedCellValue(sheetName, 378, 11, "February"),
					new ExpectedCellValue(sheetName, 379, 11, null),
					new ExpectedCellValue(sheetName, 380, 11, "March"),
					new ExpectedCellValue(sheetName, 381, 11, null),
					new ExpectedCellValue(sheetName, 382, 11, "January"),
					new ExpectedCellValue(sheetName, 383, 11, null),
					new ExpectedCellValue(sheetName, 384, 11, "February"),
					new ExpectedCellValue(sheetName, 385, 11, null),
					new ExpectedCellValue(sheetName, 386, 11, null),
					new ExpectedCellValue(sheetName, 387, 11, "January"),
					new ExpectedCellValue(sheetName, 388, 11, null),
					new ExpectedCellValue(sheetName, 389, 11, "March"),
					new ExpectedCellValue(sheetName, 390, 11, null),
					new ExpectedCellValue(sheetName, 391, 11, "January"),
					new ExpectedCellValue(sheetName, 392, 11, null),
					new ExpectedCellValue(sheetName, 393, 11, "February"),
					new ExpectedCellValue(sheetName, 394, 11, null),
					new ExpectedCellValue(sheetName, 395, 11, "March"),
					new ExpectedCellValue(sheetName, 396, 11, null),
					new ExpectedCellValue(sheetName, 397, 11, "January"),
					new ExpectedCellValue(sheetName, 398, 11, null),
					new ExpectedCellValue(sheetName, 399, 11, "February"),
					new ExpectedCellValue(sheetName, 400, 11, null),
					new ExpectedCellValue(sheetName, 401, 11, null),
					new ExpectedCellValue(sheetName, 402, 11, null),
					new ExpectedCellValue(sheetName, 370, 12, "Item"),
					new ExpectedCellValue(sheetName, 371, 12, null),
					new ExpectedCellValue(sheetName, 372, 12, null),
					new ExpectedCellValue(sheetName, 373, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 12, null),
					new ExpectedCellValue(sheetName, 375, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 376, 12, null),
					new ExpectedCellValue(sheetName, 377, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 378, 12, null),
					new ExpectedCellValue(sheetName, 379, 12, "Tent"),
					new ExpectedCellValue(sheetName, 380, 12, null),
					new ExpectedCellValue(sheetName, 381, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 382, 12, null),
					new ExpectedCellValue(sheetName, 383, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 12, null),
					new ExpectedCellValue(sheetName, 385, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 386, 12, null),
					new ExpectedCellValue(sheetName, 387, 12, null),
					new ExpectedCellValue(sheetName, 388, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 389, 12, null),
					new ExpectedCellValue(sheetName, 390, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 391, 12, null),
					new ExpectedCellValue(sheetName, 392, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 393, 12, null),
					new ExpectedCellValue(sheetName, 394, 12, "Tent"),
					new ExpectedCellValue(sheetName, 395, 12, null),
					new ExpectedCellValue(sheetName, 396, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 397, 12, null),
					new ExpectedCellValue(sheetName, 398, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 399, 12, null),
					new ExpectedCellValue(sheetName, 400, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 401, 12, null),
					new ExpectedCellValue(sheetName, 402, 12, null),
					new ExpectedCellValue(sheetName, 370, 13, null),
					new ExpectedCellValue(sheetName, 371, 13, null),
					new ExpectedCellValue(sheetName, 372, 13, null),
					new ExpectedCellValue(sheetName, 373, 13, 415.75),
					new ExpectedCellValue(sheetName, 374, 13, null),
					new ExpectedCellValue(sheetName, 375, 13, 24.99),
					new ExpectedCellValue(sheetName, 376, 13, null),
					new ExpectedCellValue(sheetName, 377, 13, 415.75),
					new ExpectedCellValue(sheetName, 378, 13, null),
					new ExpectedCellValue(sheetName, 379, 13, 199d),
					new ExpectedCellValue(sheetName, 380, 13, null),
					new ExpectedCellValue(sheetName, 381, 13, 415.75),
					new ExpectedCellValue(sheetName, 382, 13, null),
					new ExpectedCellValue(sheetName, 383, 13, 415.75),
					new ExpectedCellValue(sheetName, 384, 13, null),
					new ExpectedCellValue(sheetName, 385, 13, 99d),
					new ExpectedCellValue(sheetName, 386, 13, null),
					new ExpectedCellValue(sheetName, 387, 13, null),
					new ExpectedCellValue(sheetName, 388, 13, 831.5),
					new ExpectedCellValue(sheetName, 389, 13, null),
					new ExpectedCellValue(sheetName, 390, 13, 24.99),
					new ExpectedCellValue(sheetName, 391, 13, null),
					new ExpectedCellValue(sheetName, 392, 13, 831.5),
					new ExpectedCellValue(sheetName, 393, 13, null),
					new ExpectedCellValue(sheetName, 394, 13, 1194d),
					new ExpectedCellValue(sheetName, 395, 13, null),
					new ExpectedCellValue(sheetName, 396, 13, 831.5),
					new ExpectedCellValue(sheetName, 397, 13, null),
					new ExpectedCellValue(sheetName, 398, 13, 415.75),
					new ExpectedCellValue(sheetName, 399, 13, null),
					new ExpectedCellValue(sheetName, 400, 13, 99d),
					new ExpectedCellValue(sheetName, 401, 13, 1985.99),
					new ExpectedCellValue(sheetName, 402, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondAndLastFieldsNonCompactThirdFieldFirstFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable20"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J370:M408"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 10, null),
					new ExpectedCellValue(sheetName, 374, 10, null),
					new ExpectedCellValue(sheetName, 375, 10, null),
					new ExpectedCellValue(sheetName, 376, 10, "Chicago Total"),
					new ExpectedCellValue(sheetName, 377, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 378, 10, null),
					new ExpectedCellValue(sheetName, 379, 10, null),
					new ExpectedCellValue(sheetName, 380, 10, null),
					new ExpectedCellValue(sheetName, 381, 10, null),
					new ExpectedCellValue(sheetName, 382, 10, null),
					new ExpectedCellValue(sheetName, 383, 10, "Nashville Total"),
					new ExpectedCellValue(sheetName, 384, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 385, 10, null),
					new ExpectedCellValue(sheetName, 386, 10, null),
					new ExpectedCellValue(sheetName, 387, 10, null),
					new ExpectedCellValue(sheetName, 388, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 389, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 390, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 391, 10, null),
					new ExpectedCellValue(sheetName, 392, 10, null),
					new ExpectedCellValue(sheetName, 393, 10, null),
					new ExpectedCellValue(sheetName, 394, 10, "Chicago Total"),
					new ExpectedCellValue(sheetName, 395, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 396, 10, null),
					new ExpectedCellValue(sheetName, 397, 10, null),
					new ExpectedCellValue(sheetName, 398, 10, null),
					new ExpectedCellValue(sheetName, 399, 10, null),
					new ExpectedCellValue(sheetName, 400, 10, null),
					new ExpectedCellValue(sheetName, 401, 10, "Nashville Total"),
					new ExpectedCellValue(sheetName, 402, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 403, 10, null),
					new ExpectedCellValue(sheetName, 404, 10, null),
					new ExpectedCellValue(sheetName, 405, 10, null),
					new ExpectedCellValue(sheetName, 406, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 407, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 408, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 11, "Month"),
					new ExpectedCellValue(sheetName, 371, 11, null),
					new ExpectedCellValue(sheetName, 372, 11, "January"),
					new ExpectedCellValue(sheetName, 373, 11, null),
					new ExpectedCellValue(sheetName, 374, 11, "March"),
					new ExpectedCellValue(sheetName, 375, 11, null),
					new ExpectedCellValue(sheetName, 376, 11, null),
					new ExpectedCellValue(sheetName, 377, 11, "January"),
					new ExpectedCellValue(sheetName, 378, 11, null),
					new ExpectedCellValue(sheetName, 379, 11, "February"),
					new ExpectedCellValue(sheetName, 380, 11, null),
					new ExpectedCellValue(sheetName, 381, 11, "March"),
					new ExpectedCellValue(sheetName, 382, 11, null),
					new ExpectedCellValue(sheetName, 383, 11, null),
					new ExpectedCellValue(sheetName, 384, 11, "January"),
					new ExpectedCellValue(sheetName, 385, 11, null),
					new ExpectedCellValue(sheetName, 386, 11, "February"),
					new ExpectedCellValue(sheetName, 387, 11, null),
					new ExpectedCellValue(sheetName, 388, 11, null),
					new ExpectedCellValue(sheetName, 389, 11, null),
					new ExpectedCellValue(sheetName, 390, 11, "January"),
					new ExpectedCellValue(sheetName, 391, 11, null),
					new ExpectedCellValue(sheetName, 392, 11, "March"),
					new ExpectedCellValue(sheetName, 393, 11, null),
					new ExpectedCellValue(sheetName, 394, 11, null),
					new ExpectedCellValue(sheetName, 395, 11, "January"),
					new ExpectedCellValue(sheetName, 396, 11, null),
					new ExpectedCellValue(sheetName, 397, 11, "February"),
					new ExpectedCellValue(sheetName, 398, 11, null),
					new ExpectedCellValue(sheetName, 399, 11, "March"),
					new ExpectedCellValue(sheetName, 400, 11, null),
					new ExpectedCellValue(sheetName, 401, 11, null),
					new ExpectedCellValue(sheetName, 402, 11, "January"),
					new ExpectedCellValue(sheetName, 403, 11, null),
					new ExpectedCellValue(sheetName, 404, 11, "February"),
					new ExpectedCellValue(sheetName, 405, 11, null),
					new ExpectedCellValue(sheetName, 406, 11, null),
					new ExpectedCellValue(sheetName, 407, 11, null),
					new ExpectedCellValue(sheetName, 408, 11, null),
					new ExpectedCellValue(sheetName, 370, 12, "Item"),
					new ExpectedCellValue(sheetName, 371, 12, null),
					new ExpectedCellValue(sheetName, 372, 12, null),
					new ExpectedCellValue(sheetName, 373, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 12, null),
					new ExpectedCellValue(sheetName, 375, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 376, 12, null),
					new ExpectedCellValue(sheetName, 377, 12, null),
					new ExpectedCellValue(sheetName, 378, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 12, null),
					new ExpectedCellValue(sheetName, 380, 12, "Tent"),
					new ExpectedCellValue(sheetName, 381, 12, null),
					new ExpectedCellValue(sheetName, 382, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 383, 12, null),
					new ExpectedCellValue(sheetName, 384, 12, null),
					new ExpectedCellValue(sheetName, 385, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 386, 12, null),
					new ExpectedCellValue(sheetName, 387, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 388, 12, null),
					new ExpectedCellValue(sheetName, 389, 12, null),
					new ExpectedCellValue(sheetName, 390, 12, null),
					new ExpectedCellValue(sheetName, 391, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 392, 12, null),
					new ExpectedCellValue(sheetName, 393, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 394, 12, null),
					new ExpectedCellValue(sheetName, 395, 12, null),
					new ExpectedCellValue(sheetName, 396, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 397, 12, null),
					new ExpectedCellValue(sheetName, 398, 12, "Tent"),
					new ExpectedCellValue(sheetName, 399, 12, null),
					new ExpectedCellValue(sheetName, 400, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 401, 12, null),
					new ExpectedCellValue(sheetName, 402, 12, null),
					new ExpectedCellValue(sheetName, 403, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 404, 12, null),
					new ExpectedCellValue(sheetName, 405, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 406, 12, null),
					new ExpectedCellValue(sheetName, 407, 12, null),
					new ExpectedCellValue(sheetName, 408, 12, null),
					new ExpectedCellValue(sheetName, 370, 13, null),
					new ExpectedCellValue(sheetName, 371, 13, null),
					new ExpectedCellValue(sheetName, 372, 13, 415.75),
					new ExpectedCellValue(sheetName, 373, 13, 415.75),
					new ExpectedCellValue(sheetName, 374, 13, 24.99),
					new ExpectedCellValue(sheetName, 375, 13, 24.99),
					new ExpectedCellValue(sheetName, 376, 13, 440.74),
					new ExpectedCellValue(sheetName, 377, 13, 415.75),
					new ExpectedCellValue(sheetName, 378, 13, 415.75),
					new ExpectedCellValue(sheetName, 379, 13, 199d),
					new ExpectedCellValue(sheetName, 380, 13, 199d),
					new ExpectedCellValue(sheetName, 381, 13, 415.75),
					new ExpectedCellValue(sheetName, 382, 13, 415.75),
					new ExpectedCellValue(sheetName, 383, 13, 1030.5),
					new ExpectedCellValue(sheetName, 384, 13, 415.75),
					new ExpectedCellValue(sheetName, 385, 13, 415.75),
					new ExpectedCellValue(sheetName, 386, 13, 99d),
					new ExpectedCellValue(sheetName, 387, 13, 99d),
					new ExpectedCellValue(sheetName, 388, 13, 514.75),
					new ExpectedCellValue(sheetName, 389, 13, null),
					new ExpectedCellValue(sheetName, 390, 13, 831.5),
					new ExpectedCellValue(sheetName, 391, 13, 831.5),
					new ExpectedCellValue(sheetName, 392, 13, 24.99),
					new ExpectedCellValue(sheetName, 393, 13, 24.99),
					new ExpectedCellValue(sheetName, 394, 13, 856.49),
					new ExpectedCellValue(sheetName, 395, 13, 831.5),
					new ExpectedCellValue(sheetName, 396, 13, 831.5),
					new ExpectedCellValue(sheetName, 397, 13, 1194d),
					new ExpectedCellValue(sheetName, 398, 13, 1194d),
					new ExpectedCellValue(sheetName, 399, 13, 831.5),
					new ExpectedCellValue(sheetName, 400, 13, 831.5),
					new ExpectedCellValue(sheetName, 401, 13, 2857d),
					new ExpectedCellValue(sheetName, 402, 13, 415.75),
					new ExpectedCellValue(sheetName, 403, 13, 415.75),
					new ExpectedCellValue(sheetName, 404, 13, 99d),
					new ExpectedCellValue(sheetName, 405, 13, 99d),
					new ExpectedCellValue(sheetName, 406, 13, 514.75),
					new ExpectedCellValue(sheetName, 407, 13, 1985.99),
					new ExpectedCellValue(sheetName, 408, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondAndLastFieldsNonCompactThirdFieldFirstFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable20"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J370:M422"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 10, null),
					new ExpectedCellValue(sheetName, 374, 10, null),
					new ExpectedCellValue(sheetName, 375, 10, null),
					new ExpectedCellValue(sheetName, 376, 10, null),
					new ExpectedCellValue(sheetName, 377, 10, null),
					new ExpectedCellValue(sheetName, 378, 10, "Chicago Total"),
					new ExpectedCellValue(sheetName, 379, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 380, 10, null),
					new ExpectedCellValue(sheetName, 381, 10, null),
					new ExpectedCellValue(sheetName, 382, 10, null),
					new ExpectedCellValue(sheetName, 383, 10, null),
					new ExpectedCellValue(sheetName, 384, 10, null),
					new ExpectedCellValue(sheetName, 385, 10, null),
					new ExpectedCellValue(sheetName, 386, 10, null),
					new ExpectedCellValue(sheetName, 387, 10, null),
					new ExpectedCellValue(sheetName, 388, 10, "Nashville Total"),
					new ExpectedCellValue(sheetName, 389, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 390, 10, null),
					new ExpectedCellValue(sheetName, 391, 10, null),
					new ExpectedCellValue(sheetName, 392, 10, null),
					new ExpectedCellValue(sheetName, 393, 10, null),
					new ExpectedCellValue(sheetName, 394, 10, null),
					new ExpectedCellValue(sheetName, 395, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 396, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 397, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 398, 10, null),
					new ExpectedCellValue(sheetName, 399, 10, null),
					new ExpectedCellValue(sheetName, 400, 10, null),
					new ExpectedCellValue(sheetName, 401, 10, null),
					new ExpectedCellValue(sheetName, 402, 10, null),
					new ExpectedCellValue(sheetName, 403, 10, "Chicago Total"),
					new ExpectedCellValue(sheetName, 404, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 405, 10, null),
					new ExpectedCellValue(sheetName, 406, 10, null),
					new ExpectedCellValue(sheetName, 407, 10, null),
					new ExpectedCellValue(sheetName, 408, 10, null),
					new ExpectedCellValue(sheetName, 409, 10, null),
					new ExpectedCellValue(sheetName, 410, 10, null),
					new ExpectedCellValue(sheetName, 411, 10, null),
					new ExpectedCellValue(sheetName, 412, 10, null),
					new ExpectedCellValue(sheetName, 413, 10, "Nashville Total"),
					new ExpectedCellValue(sheetName, 414, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 415, 10, null),
					new ExpectedCellValue(sheetName, 416, 10, null),
					new ExpectedCellValue(sheetName, 417, 10, null),
					new ExpectedCellValue(sheetName, 418, 10, null),
					new ExpectedCellValue(sheetName, 419, 10, null),
					new ExpectedCellValue(sheetName, 420, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 421, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 422, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 11, "Month"),
					new ExpectedCellValue(sheetName, 371, 11, null),
					new ExpectedCellValue(sheetName, 372, 11, "January"),
					new ExpectedCellValue(sheetName, 373, 11, null),
					new ExpectedCellValue(sheetName, 374, 11, "January Total"),
					new ExpectedCellValue(sheetName, 375, 11, "March"),
					new ExpectedCellValue(sheetName, 376, 11, null),
					new ExpectedCellValue(sheetName, 377, 11, "March Total"),
					new ExpectedCellValue(sheetName, 378, 11, null),
					new ExpectedCellValue(sheetName, 379, 11, "January"),
					new ExpectedCellValue(sheetName, 380, 11, null),
					new ExpectedCellValue(sheetName, 381, 11, "January Total"),
					new ExpectedCellValue(sheetName, 382, 11, "February"),
					new ExpectedCellValue(sheetName, 383, 11, null),
					new ExpectedCellValue(sheetName, 384, 11, "February Total"),
					new ExpectedCellValue(sheetName, 385, 11, "March"),
					new ExpectedCellValue(sheetName, 386, 11, null),
					new ExpectedCellValue(sheetName, 387, 11, "March Total"),
					new ExpectedCellValue(sheetName, 388, 11, null),
					new ExpectedCellValue(sheetName, 389, 11, "January"),
					new ExpectedCellValue(sheetName, 390, 11, null),
					new ExpectedCellValue(sheetName, 391, 11, "January Total"),
					new ExpectedCellValue(sheetName, 392, 11, "February"),
					new ExpectedCellValue(sheetName, 393, 11, null),
					new ExpectedCellValue(sheetName, 394, 11, "February Total"),
					new ExpectedCellValue(sheetName, 395, 11, null),
					new ExpectedCellValue(sheetName, 396, 11, null),
					new ExpectedCellValue(sheetName, 397, 11, "January"),
					new ExpectedCellValue(sheetName, 398, 11, null),
					new ExpectedCellValue(sheetName, 399, 11, "January Total"),
					new ExpectedCellValue(sheetName, 400, 11, "March"),
					new ExpectedCellValue(sheetName, 401, 11, null),
					new ExpectedCellValue(sheetName, 402, 11, "March Total"),
					new ExpectedCellValue(sheetName, 403, 11, null),
					new ExpectedCellValue(sheetName, 404, 11, "January"),
					new ExpectedCellValue(sheetName, 405, 11, null),
					new ExpectedCellValue(sheetName, 406, 11, "January Total"),
					new ExpectedCellValue(sheetName, 407, 11, "February"),
					new ExpectedCellValue(sheetName, 408, 11, null),
					new ExpectedCellValue(sheetName, 409, 11, "February Total"),
					new ExpectedCellValue(sheetName, 410, 11, "March"),
					new ExpectedCellValue(sheetName, 411, 11, null),
					new ExpectedCellValue(sheetName, 412, 11, "March Total"),
					new ExpectedCellValue(sheetName, 413, 11, null),
					new ExpectedCellValue(sheetName, 414, 11, "January"),
					new ExpectedCellValue(sheetName, 415, 11, null),
					new ExpectedCellValue(sheetName, 416, 11, "January Total"),
					new ExpectedCellValue(sheetName, 417, 11, "February"),
					new ExpectedCellValue(sheetName, 418, 11, null),
					new ExpectedCellValue(sheetName, 419, 11, "February Total"),
					new ExpectedCellValue(sheetName, 420, 11, null),
					new ExpectedCellValue(sheetName, 421, 11, null),
					new ExpectedCellValue(sheetName, 422, 11, null),
					new ExpectedCellValue(sheetName, 370, 12, "Item"),
					new ExpectedCellValue(sheetName, 371, 12, null),
					new ExpectedCellValue(sheetName, 372, 12, null),
					new ExpectedCellValue(sheetName, 373, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 12, null),
					new ExpectedCellValue(sheetName, 375, 12, null),
					new ExpectedCellValue(sheetName, 376, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 377, 12, null),
					new ExpectedCellValue(sheetName, 378, 12, null),
					new ExpectedCellValue(sheetName, 379, 12, null),
					new ExpectedCellValue(sheetName, 380, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 381, 12, null),
					new ExpectedCellValue(sheetName, 382, 12, null),
					new ExpectedCellValue(sheetName, 383, 12, "Tent"),
					new ExpectedCellValue(sheetName, 384, 12, null),
					new ExpectedCellValue(sheetName, 385, 12, null),
					new ExpectedCellValue(sheetName, 386, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 387, 12, null),
					new ExpectedCellValue(sheetName, 388, 12, null),
					new ExpectedCellValue(sheetName, 389, 12, null),
					new ExpectedCellValue(sheetName, 390, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 12, null),
					new ExpectedCellValue(sheetName, 392, 12, null),
					new ExpectedCellValue(sheetName, 393, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 394, 12, null),
					new ExpectedCellValue(sheetName, 395, 12, null),
					new ExpectedCellValue(sheetName, 396, 12, null),
					new ExpectedCellValue(sheetName, 397, 12, null),
					new ExpectedCellValue(sheetName, 398, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 399, 12, null),
					new ExpectedCellValue(sheetName, 400, 12, null),
					new ExpectedCellValue(sheetName, 401, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 402, 12, null),
					new ExpectedCellValue(sheetName, 403, 12, null),
					new ExpectedCellValue(sheetName, 404, 12, null),
					new ExpectedCellValue(sheetName, 405, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 406, 12, null),
					new ExpectedCellValue(sheetName, 407, 12, null),
					new ExpectedCellValue(sheetName, 408, 12, "Tent"),
					new ExpectedCellValue(sheetName, 409, 12, null),
					new ExpectedCellValue(sheetName, 410, 12, null),
					new ExpectedCellValue(sheetName, 411, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 412, 12, null),
					new ExpectedCellValue(sheetName, 413, 12, null),
					new ExpectedCellValue(sheetName, 414, 12, null),
					new ExpectedCellValue(sheetName, 415, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 416, 12, null),
					new ExpectedCellValue(sheetName, 417, 12, null),
					new ExpectedCellValue(sheetName, 418, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 419, 12, null),
					new ExpectedCellValue(sheetName, 420, 12, null),
					new ExpectedCellValue(sheetName, 421, 12, null),
					new ExpectedCellValue(sheetName, 422, 12, null),
					new ExpectedCellValue(sheetName, 370, 13, null),
					new ExpectedCellValue(sheetName, 371, 13, null),
					new ExpectedCellValue(sheetName, 372, 13, null),
					new ExpectedCellValue(sheetName, 373, 13, 415.75),
					new ExpectedCellValue(sheetName, 374, 13, 415.75),
					new ExpectedCellValue(sheetName, 375, 13, null),
					new ExpectedCellValue(sheetName, 376, 13, 24.99),
					new ExpectedCellValue(sheetName, 377, 13, 24.99),
					new ExpectedCellValue(sheetName, 378, 13, 440.74),
					new ExpectedCellValue(sheetName, 379, 13, null),
					new ExpectedCellValue(sheetName, 380, 13, 415.75),
					new ExpectedCellValue(sheetName, 381, 13, 415.75),
					new ExpectedCellValue(sheetName, 382, 13, null),
					new ExpectedCellValue(sheetName, 383, 13, 199d),
					new ExpectedCellValue(sheetName, 384, 13, 199d),
					new ExpectedCellValue(sheetName, 385, 13, null),
					new ExpectedCellValue(sheetName, 386, 13, 415.75),
					new ExpectedCellValue(sheetName, 387, 13, 415.75),
					new ExpectedCellValue(sheetName, 388, 13, 1030.5),
					new ExpectedCellValue(sheetName, 389, 13, null),
					new ExpectedCellValue(sheetName, 390, 13, 415.75),
					new ExpectedCellValue(sheetName, 391, 13, 415.75),
					new ExpectedCellValue(sheetName, 392, 13, null),
					new ExpectedCellValue(sheetName, 393, 13, 99d),
					new ExpectedCellValue(sheetName, 394, 13, 99d),
					new ExpectedCellValue(sheetName, 395, 13, 514.75),
					new ExpectedCellValue(sheetName, 396, 13, null),
					new ExpectedCellValue(sheetName, 397, 13, null),
					new ExpectedCellValue(sheetName, 398, 13, 831.5),
					new ExpectedCellValue(sheetName, 399, 13, 831.5),
					new ExpectedCellValue(sheetName, 400, 13, null),
					new ExpectedCellValue(sheetName, 401, 13, 24.99),
					new ExpectedCellValue(sheetName, 402, 13, 24.99),
					new ExpectedCellValue(sheetName, 403, 13, 856.49),
					new ExpectedCellValue(sheetName, 404, 13, null),
					new ExpectedCellValue(sheetName, 405, 13, 831.5),
					new ExpectedCellValue(sheetName, 406, 13, 831.5),
					new ExpectedCellValue(sheetName, 407, 13, null),
					new ExpectedCellValue(sheetName, 408, 13, 1194d),
					new ExpectedCellValue(sheetName, 409, 13, 1194d),
					new ExpectedCellValue(sheetName, 410, 13, null),
					new ExpectedCellValue(sheetName, 411, 13, 831.5),
					new ExpectedCellValue(sheetName, 412, 13, 831.5),
					new ExpectedCellValue(sheetName, 413, 13, 2857d),
					new ExpectedCellValue(sheetName, 414, 13, null),
					new ExpectedCellValue(sheetName, 415, 13, 415.75),
					new ExpectedCellValue(sheetName, 416, 13, 415.75),
					new ExpectedCellValue(sheetName, 417, 13, null),
					new ExpectedCellValue(sheetName, 418, 13, 99d),
					new ExpectedCellValue(sheetName, 419, 13, 99d),
					new ExpectedCellValue(sheetName, 420, 13, 514.75),
					new ExpectedCellValue(sheetName, 421, 13, 1985.99),
					new ExpectedCellValue(sheetName, 422, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondFieldNonCompactThirdAndLastFieldsFirstFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable21"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q370:T402"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 17, null),
					new ExpectedCellValue(sheetName, 374, 17, null),
					new ExpectedCellValue(sheetName, 375, 17, null),
					new ExpectedCellValue(sheetName, 376, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 377, 17, null),
					new ExpectedCellValue(sheetName, 378, 17, null),
					new ExpectedCellValue(sheetName, 379, 17, null),
					new ExpectedCellValue(sheetName, 380, 17, null),
					new ExpectedCellValue(sheetName, 381, 17, null),
					new ExpectedCellValue(sheetName, 382, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 383, 17, null),
					new ExpectedCellValue(sheetName, 384, 17, null),
					new ExpectedCellValue(sheetName, 385, 17, null),
					new ExpectedCellValue(sheetName, 386, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 387, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 388, 17, null),
					new ExpectedCellValue(sheetName, 389, 17, null),
					new ExpectedCellValue(sheetName, 390, 17, null),
					new ExpectedCellValue(sheetName, 391, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 392, 17, null),
					new ExpectedCellValue(sheetName, 393, 17, null),
					new ExpectedCellValue(sheetName, 394, 17, null),
					new ExpectedCellValue(sheetName, 395, 17, null),
					new ExpectedCellValue(sheetName, 396, 17, null),
					new ExpectedCellValue(sheetName, 397, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 398, 17, null),
					new ExpectedCellValue(sheetName, 399, 17, null),
					new ExpectedCellValue(sheetName, 400, 17, null),
					new ExpectedCellValue(sheetName, 401, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 402, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 18, "Month"),
					new ExpectedCellValue(sheetName, 371, 18, null),
					new ExpectedCellValue(sheetName, 372, 18, "January"),
					new ExpectedCellValue(sheetName, 373, 18, null),
					new ExpectedCellValue(sheetName, 374, 18, "March"),
					new ExpectedCellValue(sheetName, 375, 18, null),
					new ExpectedCellValue(sheetName, 376, 18, "January"),
					new ExpectedCellValue(sheetName, 377, 18, null),
					new ExpectedCellValue(sheetName, 378, 18, "February"),
					new ExpectedCellValue(sheetName, 379, 18, null),
					new ExpectedCellValue(sheetName, 380, 18, "March"),
					new ExpectedCellValue(sheetName, 381, 18, null),
					new ExpectedCellValue(sheetName, 382, 18, "January"),
					new ExpectedCellValue(sheetName, 383, 18, null),
					new ExpectedCellValue(sheetName, 384, 18, "February"),
					new ExpectedCellValue(sheetName, 385, 18, null),
					new ExpectedCellValue(sheetName, 386, 18, null),
					new ExpectedCellValue(sheetName, 387, 18, "January"),
					new ExpectedCellValue(sheetName, 388, 18, null),
					new ExpectedCellValue(sheetName, 389, 18, "March"),
					new ExpectedCellValue(sheetName, 390, 18, null),
					new ExpectedCellValue(sheetName, 391, 18, "January"),
					new ExpectedCellValue(sheetName, 392, 18, null),
					new ExpectedCellValue(sheetName, 393, 18, "February"),
					new ExpectedCellValue(sheetName, 394, 18, null),
					new ExpectedCellValue(sheetName, 395, 18, "March"),
					new ExpectedCellValue(sheetName, 396, 18, null),
					new ExpectedCellValue(sheetName, 397, 18, "January"),
					new ExpectedCellValue(sheetName, 398, 18, null),
					new ExpectedCellValue(sheetName, 399, 18, "February"),
					new ExpectedCellValue(sheetName, 400, 18, null),
					new ExpectedCellValue(sheetName, 401, 18, null),
					new ExpectedCellValue(sheetName, 402, 18, null),
					new ExpectedCellValue(sheetName, 370, 19, "Item"),
					new ExpectedCellValue(sheetName, 371, 19, null),
					new ExpectedCellValue(sheetName, 372, 19, null),
					new ExpectedCellValue(sheetName, 373, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 19, null),
					new ExpectedCellValue(sheetName, 375, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 376, 19, null),
					new ExpectedCellValue(sheetName, 377, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 378, 19, null),
					new ExpectedCellValue(sheetName, 379, 19, "Tent"),
					new ExpectedCellValue(sheetName, 380, 19, null),
					new ExpectedCellValue(sheetName, 381, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 382, 19, null),
					new ExpectedCellValue(sheetName, 383, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 384, 19, null),
					new ExpectedCellValue(sheetName, 385, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 386, 19, null),
					new ExpectedCellValue(sheetName, 387, 19, null),
					new ExpectedCellValue(sheetName, 388, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 389, 19, null),
					new ExpectedCellValue(sheetName, 390, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 391, 19, null),
					new ExpectedCellValue(sheetName, 392, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 393, 19, null),
					new ExpectedCellValue(sheetName, 394, 19, "Tent"),
					new ExpectedCellValue(sheetName, 395, 19, null),
					new ExpectedCellValue(sheetName, 396, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 397, 19, null),
					new ExpectedCellValue(sheetName, 398, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 399, 19, null),
					new ExpectedCellValue(sheetName, 400, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 401, 19, null),
					new ExpectedCellValue(sheetName, 402, 19, null),
					new ExpectedCellValue(sheetName, 370, 20, null),
					new ExpectedCellValue(sheetName, 371, 20, null),
					new ExpectedCellValue(sheetName, 372, 20, null),
					new ExpectedCellValue(sheetName, 373, 20, 415.75),
					new ExpectedCellValue(sheetName, 374, 20, null),
					new ExpectedCellValue(sheetName, 375, 20, 24.99),
					new ExpectedCellValue(sheetName, 376, 20, null),
					new ExpectedCellValue(sheetName, 377, 20, 415.75),
					new ExpectedCellValue(sheetName, 378, 20, null),
					new ExpectedCellValue(sheetName, 379, 20, 199d),
					new ExpectedCellValue(sheetName, 380, 20, null),
					new ExpectedCellValue(sheetName, 381, 20, 415.75),
					new ExpectedCellValue(sheetName, 382, 20, null),
					new ExpectedCellValue(sheetName, 383, 20, 415.75),
					new ExpectedCellValue(sheetName, 384, 20, null),
					new ExpectedCellValue(sheetName, 385, 20, 99d),
					new ExpectedCellValue(sheetName, 386, 20, null),
					new ExpectedCellValue(sheetName, 387, 20, null),
					new ExpectedCellValue(sheetName, 388, 20, 831.5),
					new ExpectedCellValue(sheetName, 389, 20, null),
					new ExpectedCellValue(sheetName, 390, 20, 24.99),
					new ExpectedCellValue(sheetName, 391, 20, null),
					new ExpectedCellValue(sheetName, 392, 20, 831.5),
					new ExpectedCellValue(sheetName, 393, 20, null),
					new ExpectedCellValue(sheetName, 394, 20, 1194d),
					new ExpectedCellValue(sheetName, 395, 20, null),
					new ExpectedCellValue(sheetName, 396, 20, 831.5),
					new ExpectedCellValue(sheetName, 397, 20, null),
					new ExpectedCellValue(sheetName, 398, 20, 415.75),
					new ExpectedCellValue(sheetName, 399, 20, null),
					new ExpectedCellValue(sheetName, 400, 20, 99d),
					new ExpectedCellValue(sheetName, 401, 20, 1985.99),
					new ExpectedCellValue(sheetName, 402, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondFieldNonCompactThirdAndLastFieldsFirstFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable21"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q370:T408"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 17, null),
					new ExpectedCellValue(sheetName, 374, 17, null),
					new ExpectedCellValue(sheetName, 375, 17, null),
					new ExpectedCellValue(sheetName, 376, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 377, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 378, 17, null),
					new ExpectedCellValue(sheetName, 379, 17, null),
					new ExpectedCellValue(sheetName, 380, 17, null),
					new ExpectedCellValue(sheetName, 381, 17, null),
					new ExpectedCellValue(sheetName, 382, 17, null),
					new ExpectedCellValue(sheetName, 383, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 384, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 385, 17, null),
					new ExpectedCellValue(sheetName, 386, 17, null),
					new ExpectedCellValue(sheetName, 387, 17, null),
					new ExpectedCellValue(sheetName, 388, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 389, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 390, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 391, 17, null),
					new ExpectedCellValue(sheetName, 392, 17, null),
					new ExpectedCellValue(sheetName, 393, 17, null),
					new ExpectedCellValue(sheetName, 394, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 395, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 396, 17, null),
					new ExpectedCellValue(sheetName, 397, 17, null),
					new ExpectedCellValue(sheetName, 398, 17, null),
					new ExpectedCellValue(sheetName, 399, 17, null),
					new ExpectedCellValue(sheetName, 400, 17, null),
					new ExpectedCellValue(sheetName, 401, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 402, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 403, 17, null),
					new ExpectedCellValue(sheetName, 404, 17, null),
					new ExpectedCellValue(sheetName, 405, 17, null),
					new ExpectedCellValue(sheetName, 406, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 407, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 408, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 18, "Month"),
					new ExpectedCellValue(sheetName, 371, 18, null),
					new ExpectedCellValue(sheetName, 372, 18, "January"),
					new ExpectedCellValue(sheetName, 373, 18, null),
					new ExpectedCellValue(sheetName, 374, 18, "March"),
					new ExpectedCellValue(sheetName, 375, 18, null),
					new ExpectedCellValue(sheetName, 376, 18, null),
					new ExpectedCellValue(sheetName, 377, 18, "January"),
					new ExpectedCellValue(sheetName, 378, 18, null),
					new ExpectedCellValue(sheetName, 379, 18, "February"),
					new ExpectedCellValue(sheetName, 380, 18, null),
					new ExpectedCellValue(sheetName, 381, 18, "March"),
					new ExpectedCellValue(sheetName, 382, 18, null),
					new ExpectedCellValue(sheetName, 383, 18, null),
					new ExpectedCellValue(sheetName, 384, 18, "January"),
					new ExpectedCellValue(sheetName, 385, 18, null),
					new ExpectedCellValue(sheetName, 386, 18, "February"),
					new ExpectedCellValue(sheetName, 387, 18, null),
					new ExpectedCellValue(sheetName, 388, 18, null),
					new ExpectedCellValue(sheetName, 389, 18, null),
					new ExpectedCellValue(sheetName, 390, 18, "January"),
					new ExpectedCellValue(sheetName, 391, 18, null),
					new ExpectedCellValue(sheetName, 392, 18, "March"),
					new ExpectedCellValue(sheetName, 393, 18, null),
					new ExpectedCellValue(sheetName, 394, 18, null),
					new ExpectedCellValue(sheetName, 395, 18, "January"),
					new ExpectedCellValue(sheetName, 396, 18, null),
					new ExpectedCellValue(sheetName, 397, 18, "February"),
					new ExpectedCellValue(sheetName, 398, 18, null),
					new ExpectedCellValue(sheetName, 399, 18, "March"),
					new ExpectedCellValue(sheetName, 400, 18, null),
					new ExpectedCellValue(sheetName, 401, 18, null),
					new ExpectedCellValue(sheetName, 402, 18, "January"),
					new ExpectedCellValue(sheetName, 403, 18, null),
					new ExpectedCellValue(sheetName, 404, 18, "February"),
					new ExpectedCellValue(sheetName, 405, 18, null),
					new ExpectedCellValue(sheetName, 406, 18, null),
					new ExpectedCellValue(sheetName, 407, 18, null),
					new ExpectedCellValue(sheetName, 408, 18, null),
					new ExpectedCellValue(sheetName, 370, 19, "Item"),
					new ExpectedCellValue(sheetName, 371, 19, null),
					new ExpectedCellValue(sheetName, 372, 19, null),
					new ExpectedCellValue(sheetName, 373, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 19, null),
					new ExpectedCellValue(sheetName, 375, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 376, 19, null),
					new ExpectedCellValue(sheetName, 377, 19, null),
					new ExpectedCellValue(sheetName, 378, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 379, 19, null),
					new ExpectedCellValue(sheetName, 380, 19, "Tent"),
					new ExpectedCellValue(sheetName, 381, 19, null),
					new ExpectedCellValue(sheetName, 382, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 383, 19, null),
					new ExpectedCellValue(sheetName, 384, 19, null),
					new ExpectedCellValue(sheetName, 385, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 386, 19, null),
					new ExpectedCellValue(sheetName, 387, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 388, 19, null),
					new ExpectedCellValue(sheetName, 389, 19, null),
					new ExpectedCellValue(sheetName, 390, 19, null),
					new ExpectedCellValue(sheetName, 391, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 392, 19, null),
					new ExpectedCellValue(sheetName, 393, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 394, 19, null),
					new ExpectedCellValue(sheetName, 395, 19, null),
					new ExpectedCellValue(sheetName, 396, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 397, 19, null),
					new ExpectedCellValue(sheetName, 398, 19, "Tent"),
					new ExpectedCellValue(sheetName, 399, 19, null),
					new ExpectedCellValue(sheetName, 400, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 401, 19, null),
					new ExpectedCellValue(sheetName, 402, 19, null),
					new ExpectedCellValue(sheetName, 403, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 404, 19, null),
					new ExpectedCellValue(sheetName, 405, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 406, 19, null),
					new ExpectedCellValue(sheetName, 407, 19, null),
					new ExpectedCellValue(sheetName, 408, 19, null),
					new ExpectedCellValue(sheetName, 370, 20, null),
					new ExpectedCellValue(sheetName, 371, 20, null),
					new ExpectedCellValue(sheetName, 372, 20, 415.75),
					new ExpectedCellValue(sheetName, 373, 20, 415.75),
					new ExpectedCellValue(sheetName, 374, 20, 24.99),
					new ExpectedCellValue(sheetName, 375, 20, 24.99),
					new ExpectedCellValue(sheetName, 376, 20, 440.74),
					new ExpectedCellValue(sheetName, 377, 20, 415.75),
					new ExpectedCellValue(sheetName, 378, 20, 415.75),
					new ExpectedCellValue(sheetName, 379, 20, 199d),
					new ExpectedCellValue(sheetName, 380, 20, 199d),
					new ExpectedCellValue(sheetName, 381, 20, 415.75),
					new ExpectedCellValue(sheetName, 382, 20, 415.75),
					new ExpectedCellValue(sheetName, 383, 20, 1030.5),
					new ExpectedCellValue(sheetName, 384, 20, 415.75),
					new ExpectedCellValue(sheetName, 385, 20, 415.75),
					new ExpectedCellValue(sheetName, 386, 20, 99d),
					new ExpectedCellValue(sheetName, 387, 20, 99d),
					new ExpectedCellValue(sheetName, 388, 20, 514.75),
					new ExpectedCellValue(sheetName, 389, 20, null),
					new ExpectedCellValue(sheetName, 390, 20, 831.5),
					new ExpectedCellValue(sheetName, 391, 20, 831.5),
					new ExpectedCellValue(sheetName, 392, 20, 24.99),
					new ExpectedCellValue(sheetName, 393, 20, 24.99),
					new ExpectedCellValue(sheetName, 394, 20, 856.49),
					new ExpectedCellValue(sheetName, 395, 20, 831.5),
					new ExpectedCellValue(sheetName, 396, 20, 831.5),
					new ExpectedCellValue(sheetName, 397, 20, 1194d),
					new ExpectedCellValue(sheetName, 398, 20, 1194d),
					new ExpectedCellValue(sheetName, 399, 20, 831.5),
					new ExpectedCellValue(sheetName, 400, 20, 831.5),
					new ExpectedCellValue(sheetName, 401, 20, 2857d),
					new ExpectedCellValue(sheetName, 402, 20, 415.75),
					new ExpectedCellValue(sheetName, 403, 20, 415.75),
					new ExpectedCellValue(sheetName, 404, 20, 99d),
					new ExpectedCellValue(sheetName, 405, 20, 99d),
					new ExpectedCellValue(sheetName, 406, 20, 514.75),
					new ExpectedCellValue(sheetName, 407, 20, 1985.99),
					new ExpectedCellValue(sheetName, 408, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsTabularSecondFieldNonCompactThirdAndLastFieldsFirstFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable21"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q370:T422"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 370, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 371, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 372, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 373, 17, null),
					new ExpectedCellValue(sheetName, 374, 17, null),
					new ExpectedCellValue(sheetName, 375, 17, null),
					new ExpectedCellValue(sheetName, 376, 17, null),
					new ExpectedCellValue(sheetName, 377, 17, null),
					new ExpectedCellValue(sheetName, 378, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 379, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 380, 17, null),
					new ExpectedCellValue(sheetName, 381, 17, null),
					new ExpectedCellValue(sheetName, 382, 17, null),
					new ExpectedCellValue(sheetName, 383, 17, null),
					new ExpectedCellValue(sheetName, 384, 17, null),
					new ExpectedCellValue(sheetName, 385, 17, null),
					new ExpectedCellValue(sheetName, 386, 17, null),
					new ExpectedCellValue(sheetName, 387, 17, null),
					new ExpectedCellValue(sheetName, 388, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 389, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 390, 17, null),
					new ExpectedCellValue(sheetName, 391, 17, null),
					new ExpectedCellValue(sheetName, 392, 17, null),
					new ExpectedCellValue(sheetName, 393, 17, null),
					new ExpectedCellValue(sheetName, 394, 17, null),
					new ExpectedCellValue(sheetName, 395, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 396, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 397, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 398, 17, null),
					new ExpectedCellValue(sheetName, 399, 17, null),
					new ExpectedCellValue(sheetName, 400, 17, null),
					new ExpectedCellValue(sheetName, 401, 17, null),
					new ExpectedCellValue(sheetName, 402, 17, null),
					new ExpectedCellValue(sheetName, 403, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 404, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 405, 17, null),
					new ExpectedCellValue(sheetName, 406, 17, null),
					new ExpectedCellValue(sheetName, 407, 17, null),
					new ExpectedCellValue(sheetName, 408, 17, null),
					new ExpectedCellValue(sheetName, 409, 17, null),
					new ExpectedCellValue(sheetName, 410, 17, null),
					new ExpectedCellValue(sheetName, 411, 17, null),
					new ExpectedCellValue(sheetName, 412, 17, null),
					new ExpectedCellValue(sheetName, 413, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 414, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 415, 17, null),
					new ExpectedCellValue(sheetName, 416, 17, null),
					new ExpectedCellValue(sheetName, 417, 17, null),
					new ExpectedCellValue(sheetName, 418, 17, null),
					new ExpectedCellValue(sheetName, 419, 17, null),
					new ExpectedCellValue(sheetName, 420, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 421, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 422, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 370, 18, "Month"),
					new ExpectedCellValue(sheetName, 371, 18, null),
					new ExpectedCellValue(sheetName, 372, 18, "January"),
					new ExpectedCellValue(sheetName, 373, 18, null),
					new ExpectedCellValue(sheetName, 374, 18, "January Total"),
					new ExpectedCellValue(sheetName, 375, 18, "March"),
					new ExpectedCellValue(sheetName, 376, 18, null),
					new ExpectedCellValue(sheetName, 377, 18, "March Total"),
					new ExpectedCellValue(sheetName, 378, 18, null),
					new ExpectedCellValue(sheetName, 379, 18, "January"),
					new ExpectedCellValue(sheetName, 380, 18, null),
					new ExpectedCellValue(sheetName, 381, 18, "January Total"),
					new ExpectedCellValue(sheetName, 382, 18, "February"),
					new ExpectedCellValue(sheetName, 383, 18, null),
					new ExpectedCellValue(sheetName, 384, 18, "February Total"),
					new ExpectedCellValue(sheetName, 385, 18, "March"),
					new ExpectedCellValue(sheetName, 386, 18, null),
					new ExpectedCellValue(sheetName, 387, 18, "March Total"),
					new ExpectedCellValue(sheetName, 388, 18, null),
					new ExpectedCellValue(sheetName, 389, 18, "January"),
					new ExpectedCellValue(sheetName, 390, 18, null),
					new ExpectedCellValue(sheetName, 391, 18, "January Total"),
					new ExpectedCellValue(sheetName, 392, 18, "February"),
					new ExpectedCellValue(sheetName, 393, 18, null),
					new ExpectedCellValue(sheetName, 394, 18, "February Total"),
					new ExpectedCellValue(sheetName, 395, 18, null),
					new ExpectedCellValue(sheetName, 396, 18, null),
					new ExpectedCellValue(sheetName, 397, 18, "January"),
					new ExpectedCellValue(sheetName, 398, 18, null),
					new ExpectedCellValue(sheetName, 399, 18, "January Total"),
					new ExpectedCellValue(sheetName, 400, 18, "March"),
					new ExpectedCellValue(sheetName, 401, 18, null),
					new ExpectedCellValue(sheetName, 402, 18, "March Total"),
					new ExpectedCellValue(sheetName, 403, 18, null),
					new ExpectedCellValue(sheetName, 404, 18, "January"),
					new ExpectedCellValue(sheetName, 405, 18, null),
					new ExpectedCellValue(sheetName, 406, 18, "January Total"),
					new ExpectedCellValue(sheetName, 407, 18, "February"),
					new ExpectedCellValue(sheetName, 408, 18, null),
					new ExpectedCellValue(sheetName, 409, 18, "February Total"),
					new ExpectedCellValue(sheetName, 410, 18, "March"),
					new ExpectedCellValue(sheetName, 411, 18, null),
					new ExpectedCellValue(sheetName, 412, 18, "March Total"),
					new ExpectedCellValue(sheetName, 413, 18, null),
					new ExpectedCellValue(sheetName, 414, 18, "January"),
					new ExpectedCellValue(sheetName, 415, 18, null),
					new ExpectedCellValue(sheetName, 416, 18, "January Total"),
					new ExpectedCellValue(sheetName, 417, 18, "February"),
					new ExpectedCellValue(sheetName, 418, 18, null),
					new ExpectedCellValue(sheetName, 419, 18, "February Total"),
					new ExpectedCellValue(sheetName, 420, 18, null),
					new ExpectedCellValue(sheetName, 421, 18, null),
					new ExpectedCellValue(sheetName, 422, 18, null),
					new ExpectedCellValue(sheetName, 370, 19, "Item"),
					new ExpectedCellValue(sheetName, 371, 19, null),
					new ExpectedCellValue(sheetName, 372, 19, null),
					new ExpectedCellValue(sheetName, 373, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 374, 19, null),
					new ExpectedCellValue(sheetName, 375, 19, null),
					new ExpectedCellValue(sheetName, 376, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 377, 19, null),
					new ExpectedCellValue(sheetName, 378, 19, null),
					new ExpectedCellValue(sheetName, 379, 19, null),
					new ExpectedCellValue(sheetName, 380, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 381, 19, null),
					new ExpectedCellValue(sheetName, 382, 19, null),
					new ExpectedCellValue(sheetName, 383, 19, "Tent"),
					new ExpectedCellValue(sheetName, 384, 19, null),
					new ExpectedCellValue(sheetName, 385, 19, null),
					new ExpectedCellValue(sheetName, 386, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 387, 19, null),
					new ExpectedCellValue(sheetName, 388, 19, null),
					new ExpectedCellValue(sheetName, 389, 19, null),
					new ExpectedCellValue(sheetName, 390, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 391, 19, null),
					new ExpectedCellValue(sheetName, 392, 19, null),
					new ExpectedCellValue(sheetName, 393, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 394, 19, null),
					new ExpectedCellValue(sheetName, 395, 19, null),
					new ExpectedCellValue(sheetName, 396, 19, null),
					new ExpectedCellValue(sheetName, 397, 19, null),
					new ExpectedCellValue(sheetName, 398, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 399, 19, null),
					new ExpectedCellValue(sheetName, 400, 19, null),
					new ExpectedCellValue(sheetName, 401, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 402, 19, null),
					new ExpectedCellValue(sheetName, 403, 19, null),
					new ExpectedCellValue(sheetName, 404, 19, null),
					new ExpectedCellValue(sheetName, 405, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 406, 19, null),
					new ExpectedCellValue(sheetName, 407, 19, null),
					new ExpectedCellValue(sheetName, 408, 19, "Tent"),
					new ExpectedCellValue(sheetName, 409, 19, null),
					new ExpectedCellValue(sheetName, 410, 19, null),
					new ExpectedCellValue(sheetName, 411, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 412, 19, null),
					new ExpectedCellValue(sheetName, 413, 19, null),
					new ExpectedCellValue(sheetName, 414, 19, null),
					new ExpectedCellValue(sheetName, 415, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 416, 19, null),
					new ExpectedCellValue(sheetName, 417, 19, null),
					new ExpectedCellValue(sheetName, 418, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 419, 19, null),
					new ExpectedCellValue(sheetName, 420, 19, null),
					new ExpectedCellValue(sheetName, 421, 19, null),
					new ExpectedCellValue(sheetName, 422, 19, null),
					new ExpectedCellValue(sheetName, 370, 20, null),
					new ExpectedCellValue(sheetName, 371, 20, null),
					new ExpectedCellValue(sheetName, 372, 20, null),
					new ExpectedCellValue(sheetName, 373, 20, 415.75),
					new ExpectedCellValue(sheetName, 374, 20, 415.75),
					new ExpectedCellValue(sheetName, 375, 20, null),
					new ExpectedCellValue(sheetName, 376, 20, 24.99),
					new ExpectedCellValue(sheetName, 377, 20, 24.99),
					new ExpectedCellValue(sheetName, 378, 20, 440.74),
					new ExpectedCellValue(sheetName, 379, 20, null),
					new ExpectedCellValue(sheetName, 380, 20, 415.75),
					new ExpectedCellValue(sheetName, 381, 20, 415.75),
					new ExpectedCellValue(sheetName, 382, 20, null),
					new ExpectedCellValue(sheetName, 383, 20, 199d),
					new ExpectedCellValue(sheetName, 384, 20, 199d),
					new ExpectedCellValue(sheetName, 385, 20, null),
					new ExpectedCellValue(sheetName, 386, 20, 415.75),
					new ExpectedCellValue(sheetName, 387, 20, 415.75),
					new ExpectedCellValue(sheetName, 388, 20, 1030.5),
					new ExpectedCellValue(sheetName, 389, 20, null),
					new ExpectedCellValue(sheetName, 390, 20, 415.75),
					new ExpectedCellValue(sheetName, 391, 20, 415.75),
					new ExpectedCellValue(sheetName, 392, 20, null),
					new ExpectedCellValue(sheetName, 393, 20, 99d),
					new ExpectedCellValue(sheetName, 394, 20, 99d),
					new ExpectedCellValue(sheetName, 395, 20, 514.75),
					new ExpectedCellValue(sheetName, 396, 20, null),
					new ExpectedCellValue(sheetName, 397, 20, null),
					new ExpectedCellValue(sheetName, 398, 20, 831.5),
					new ExpectedCellValue(sheetName, 399, 20, 831.5),
					new ExpectedCellValue(sheetName, 400, 20, null),
					new ExpectedCellValue(sheetName, 401, 20, 24.99),
					new ExpectedCellValue(sheetName, 402, 20, 24.99),
					new ExpectedCellValue(sheetName, 403, 20, 856.49),
					new ExpectedCellValue(sheetName, 404, 20, null),
					new ExpectedCellValue(sheetName, 405, 20, 831.5),
					new ExpectedCellValue(sheetName, 406, 20, 831.5),
					new ExpectedCellValue(sheetName, 407, 20, null),
					new ExpectedCellValue(sheetName, 408, 20, 1194d),
					new ExpectedCellValue(sheetName, 409, 20, 1194d),
					new ExpectedCellValue(sheetName, 410, 20, null),
					new ExpectedCellValue(sheetName, 411, 20, 831.5),
					new ExpectedCellValue(sheetName, 412, 20, 831.5),
					new ExpectedCellValue(sheetName, 413, 20, 2857d),
					new ExpectedCellValue(sheetName, 414, 20, null),
					new ExpectedCellValue(sheetName, 415, 20, 415.75),
					new ExpectedCellValue(sheetName, 416, 20, 415.75),
					new ExpectedCellValue(sheetName, 417, 20, null),
					new ExpectedCellValue(sheetName, 418, 20, 99d),
					new ExpectedCellValue(sheetName, 419, 20, 99d),
					new ExpectedCellValue(sheetName, 420, 20, 514.75),
					new ExpectedCellValue(sheetName, 421, 20, 1985.99),
					new ExpectedCellValue(sheetName, 422, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondFieldTabularThirdAndLastFieldsFirstFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable22"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C430:F454"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 3, null),
					new ExpectedCellValue(sheetName, 434, 3, null),
					new ExpectedCellValue(sheetName, 435, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 436, 3, null),
					new ExpectedCellValue(sheetName, 437, 3, null),
					new ExpectedCellValue(sheetName, 438, 3, null),
					new ExpectedCellValue(sheetName, 439, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 440, 3, null),
					new ExpectedCellValue(sheetName, 441, 3, null),
					new ExpectedCellValue(sheetName, 442, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 443, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 444, 3, null),
					new ExpectedCellValue(sheetName, 445, 3, null),
					new ExpectedCellValue(sheetName, 446, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 447, 3, null),
					new ExpectedCellValue(sheetName, 448, 3, null),
					new ExpectedCellValue(sheetName, 449, 3, null),
					new ExpectedCellValue(sheetName, 450, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 451, 3, null),
					new ExpectedCellValue(sheetName, 452, 3, null),
					new ExpectedCellValue(sheetName, 453, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 454, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 4, "Month"),
					new ExpectedCellValue(sheetName, 431, 4, null),
					new ExpectedCellValue(sheetName, 432, 4, null),
					new ExpectedCellValue(sheetName, 433, 4, "January"),
					new ExpectedCellValue(sheetName, 434, 4, "March"),
					new ExpectedCellValue(sheetName, 435, 4, null),
					new ExpectedCellValue(sheetName, 436, 4, "January"),
					new ExpectedCellValue(sheetName, 437, 4, "February"),
					new ExpectedCellValue(sheetName, 438, 4, "March"),
					new ExpectedCellValue(sheetName, 439, 4, null),
					new ExpectedCellValue(sheetName, 440, 4, "January"),
					new ExpectedCellValue(sheetName, 441, 4, "February"),
					new ExpectedCellValue(sheetName, 442, 4, null),
					new ExpectedCellValue(sheetName, 443, 4, null),
					new ExpectedCellValue(sheetName, 444, 4, "January"),
					new ExpectedCellValue(sheetName, 445, 4, "March"),
					new ExpectedCellValue(sheetName, 446, 4, null),
					new ExpectedCellValue(sheetName, 447, 4, "January"),
					new ExpectedCellValue(sheetName, 448, 4, "February"),
					new ExpectedCellValue(sheetName, 449, 4, "March"),
					new ExpectedCellValue(sheetName, 450, 4, null),
					new ExpectedCellValue(sheetName, 451, 4, "January"),
					new ExpectedCellValue(sheetName, 452, 4, "February"),
					new ExpectedCellValue(sheetName, 453, 4, null),
					new ExpectedCellValue(sheetName, 454, 4, null),
					new ExpectedCellValue(sheetName, 430, 5, "Item"),
					new ExpectedCellValue(sheetName, 431, 5, null),
					new ExpectedCellValue(sheetName, 432, 5, null),
					new ExpectedCellValue(sheetName, 433, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 434, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 435, 5, null),
					new ExpectedCellValue(sheetName, 436, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 437, 5, "Tent"),
					new ExpectedCellValue(sheetName, 438, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 439, 5, null),
					new ExpectedCellValue(sheetName, 440, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 441, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 442, 5, null),
					new ExpectedCellValue(sheetName, 443, 5, null),
					new ExpectedCellValue(sheetName, 444, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 445, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 446, 5, null),
					new ExpectedCellValue(sheetName, 447, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 448, 5, "Tent"),
					new ExpectedCellValue(sheetName, 449, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 450, 5, null),
					new ExpectedCellValue(sheetName, 451, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 452, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 453, 5, null),
					new ExpectedCellValue(sheetName, 454, 5, null),
					new ExpectedCellValue(sheetName, 430, 6, null),
					new ExpectedCellValue(sheetName, 431, 6, null),
					new ExpectedCellValue(sheetName, 432, 6, null),
					new ExpectedCellValue(sheetName, 433, 6, 415.75),
					new ExpectedCellValue(sheetName, 434, 6, 24.99),
					new ExpectedCellValue(sheetName, 435, 6, null),
					new ExpectedCellValue(sheetName, 436, 6, 415.75),
					new ExpectedCellValue(sheetName, 437, 6, 199d),
					new ExpectedCellValue(sheetName, 438, 6, 415.75),
					new ExpectedCellValue(sheetName, 439, 6, null),
					new ExpectedCellValue(sheetName, 440, 6, 415.75),
					new ExpectedCellValue(sheetName, 441, 6, 99d),
					new ExpectedCellValue(sheetName, 442, 6, null),
					new ExpectedCellValue(sheetName, 443, 6, null),
					new ExpectedCellValue(sheetName, 444, 6, 831.5),
					new ExpectedCellValue(sheetName, 445, 6, 24.99),
					new ExpectedCellValue(sheetName, 446, 6, null),
					new ExpectedCellValue(sheetName, 447, 6, 831.5),
					new ExpectedCellValue(sheetName, 448, 6, 1194d),
					new ExpectedCellValue(sheetName, 449, 6, 831.5),
					new ExpectedCellValue(sheetName, 450, 6, null),
					new ExpectedCellValue(sheetName, 451, 6, 415.75),
					new ExpectedCellValue(sheetName, 452, 6, 99d),
					new ExpectedCellValue(sheetName, 453, 6, 1985.99),
					new ExpectedCellValue(sheetName, 454, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondFieldTabularThirdAndLastFieldsFirstFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable22"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C430:F468"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 3, null),
					new ExpectedCellValue(sheetName, 434, 3, null),
					new ExpectedCellValue(sheetName, 435, 3, null),
					new ExpectedCellValue(sheetName, 436, 3, null),
					new ExpectedCellValue(sheetName, 437, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 438, 3, null),
					new ExpectedCellValue(sheetName, 439, 3, null),
					new ExpectedCellValue(sheetName, 440, 3, null),
					new ExpectedCellValue(sheetName, 441, 3, null),
					new ExpectedCellValue(sheetName, 442, 3, null),
					new ExpectedCellValue(sheetName, 443, 3, null),
					new ExpectedCellValue(sheetName, 444, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 445, 3, null),
					new ExpectedCellValue(sheetName, 446, 3, null),
					new ExpectedCellValue(sheetName, 447, 3, null),
					new ExpectedCellValue(sheetName, 448, 3, null),
					new ExpectedCellValue(sheetName, 449, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 450, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 451, 3, null),
					new ExpectedCellValue(sheetName, 452, 3, null),
					new ExpectedCellValue(sheetName, 453, 3, null),
					new ExpectedCellValue(sheetName, 454, 3, null),
					new ExpectedCellValue(sheetName, 455, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 456, 3, null),
					new ExpectedCellValue(sheetName, 457, 3, null),
					new ExpectedCellValue(sheetName, 458, 3, null),
					new ExpectedCellValue(sheetName, 459, 3, null),
					new ExpectedCellValue(sheetName, 460, 3, null),
					new ExpectedCellValue(sheetName, 461, 3, null),
					new ExpectedCellValue(sheetName, 462, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 463, 3, null),
					new ExpectedCellValue(sheetName, 464, 3, null),
					new ExpectedCellValue(sheetName, 465, 3, null),
					new ExpectedCellValue(sheetName, 466, 3, null),
					new ExpectedCellValue(sheetName, 467, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 468, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 4, "Month"),
					new ExpectedCellValue(sheetName, 431, 4, null),
					new ExpectedCellValue(sheetName, 432, 4, null),
					new ExpectedCellValue(sheetName, 433, 4, "January"),
					new ExpectedCellValue(sheetName, 434, 4, "January Total"),
					new ExpectedCellValue(sheetName, 435, 4, "March"),
					new ExpectedCellValue(sheetName, 436, 4, "March Total"),
					new ExpectedCellValue(sheetName, 437, 4, null),
					new ExpectedCellValue(sheetName, 438, 4, "January"),
					new ExpectedCellValue(sheetName, 439, 4, "January Total"),
					new ExpectedCellValue(sheetName, 440, 4, "February"),
					new ExpectedCellValue(sheetName, 441, 4, "February Total"),
					new ExpectedCellValue(sheetName, 442, 4, "March"),
					new ExpectedCellValue(sheetName, 443, 4, "March Total"),
					new ExpectedCellValue(sheetName, 444, 4, null),
					new ExpectedCellValue(sheetName, 445, 4, "January"),
					new ExpectedCellValue(sheetName, 446, 4, "January Total"),
					new ExpectedCellValue(sheetName, 447, 4, "February"),
					new ExpectedCellValue(sheetName, 448, 4, "February Total"),
					new ExpectedCellValue(sheetName, 449, 4, null),
					new ExpectedCellValue(sheetName, 450, 4, null),
					new ExpectedCellValue(sheetName, 451, 4, "January"),
					new ExpectedCellValue(sheetName, 452, 4, "January Total"),
					new ExpectedCellValue(sheetName, 453, 4, "March"),
					new ExpectedCellValue(sheetName, 454, 4, "March Total"),
					new ExpectedCellValue(sheetName, 455, 4, null),
					new ExpectedCellValue(sheetName, 456, 4, "January"),
					new ExpectedCellValue(sheetName, 457, 4, "January Total"),
					new ExpectedCellValue(sheetName, 458, 4, "February"),
					new ExpectedCellValue(sheetName, 459, 4, "February Total"),
					new ExpectedCellValue(sheetName, 460, 4, "March"),
					new ExpectedCellValue(sheetName, 461, 4, "March Total"),
					new ExpectedCellValue(sheetName, 462, 4, null),
					new ExpectedCellValue(sheetName, 463, 4, "January"),
					new ExpectedCellValue(sheetName, 464, 4, "January Total"),
					new ExpectedCellValue(sheetName, 465, 4, "February"),
					new ExpectedCellValue(sheetName, 466, 4, "February Total"),
					new ExpectedCellValue(sheetName, 467, 4, null),
					new ExpectedCellValue(sheetName, 468, 4, null),
					new ExpectedCellValue(sheetName, 430, 5, "Item"),
					new ExpectedCellValue(sheetName, 431, 5, null),
					new ExpectedCellValue(sheetName, 432, 5, null),
					new ExpectedCellValue(sheetName, 433, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 434, 5, null),
					new ExpectedCellValue(sheetName, 435, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 436, 5, null),
					new ExpectedCellValue(sheetName, 437, 5, null),
					new ExpectedCellValue(sheetName, 438, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 439, 5, null),
					new ExpectedCellValue(sheetName, 440, 5, "Tent"),
					new ExpectedCellValue(sheetName, 441, 5, null),
					new ExpectedCellValue(sheetName, 442, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 443, 5, null),
					new ExpectedCellValue(sheetName, 444, 5, null),
					new ExpectedCellValue(sheetName, 445, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 446, 5, null),
					new ExpectedCellValue(sheetName, 447, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 448, 5, null),
					new ExpectedCellValue(sheetName, 449, 5, null),
					new ExpectedCellValue(sheetName, 450, 5, null),
					new ExpectedCellValue(sheetName, 451, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 452, 5, null),
					new ExpectedCellValue(sheetName, 453, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 454, 5, null),
					new ExpectedCellValue(sheetName, 455, 5, null),
					new ExpectedCellValue(sheetName, 456, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 457, 5, null),
					new ExpectedCellValue(sheetName, 458, 5, "Tent"),
					new ExpectedCellValue(sheetName, 459, 5, null),
					new ExpectedCellValue(sheetName, 460, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 461, 5, null),
					new ExpectedCellValue(sheetName, 462, 5, null),
					new ExpectedCellValue(sheetName, 463, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 464, 5, null),
					new ExpectedCellValue(sheetName, 465, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 466, 5, null),
					new ExpectedCellValue(sheetName, 467, 5, null),
					new ExpectedCellValue(sheetName, 468, 5, null),
					new ExpectedCellValue(sheetName, 430, 6, null),
					new ExpectedCellValue(sheetName, 431, 6, null),
					new ExpectedCellValue(sheetName, 432, 6, 440.74),
					new ExpectedCellValue(sheetName, 433, 6, 415.75),
					new ExpectedCellValue(sheetName, 434, 6, 415.75),
					new ExpectedCellValue(sheetName, 435, 6, 24.99),
					new ExpectedCellValue(sheetName, 436, 6, 24.99),
					new ExpectedCellValue(sheetName, 437, 6, 1030.5),
					new ExpectedCellValue(sheetName, 438, 6, 415.75),
					new ExpectedCellValue(sheetName, 439, 6, 415.75),
					new ExpectedCellValue(sheetName, 440, 6, 199d),
					new ExpectedCellValue(sheetName, 441, 6, 199d),
					new ExpectedCellValue(sheetName, 442, 6, 415.75),
					new ExpectedCellValue(sheetName, 443, 6, 415.75),
					new ExpectedCellValue(sheetName, 444, 6, 514.75),
					new ExpectedCellValue(sheetName, 445, 6, 415.75),
					new ExpectedCellValue(sheetName, 446, 6, 415.75),
					new ExpectedCellValue(sheetName, 447, 6, 99d),
					new ExpectedCellValue(sheetName, 448, 6, 99d),
					new ExpectedCellValue(sheetName, 449, 6, null),
					new ExpectedCellValue(sheetName, 450, 6, 856.49),
					new ExpectedCellValue(sheetName, 451, 6, 831.5),
					new ExpectedCellValue(sheetName, 452, 6, 831.5),
					new ExpectedCellValue(sheetName, 453, 6, 24.99),
					new ExpectedCellValue(sheetName, 454, 6, 24.99),
					new ExpectedCellValue(sheetName, 455, 6, 2857d),
					new ExpectedCellValue(sheetName, 456, 6, 831.5),
					new ExpectedCellValue(sheetName, 457, 6, 831.5),
					new ExpectedCellValue(sheetName, 458, 6, 1194d),
					new ExpectedCellValue(sheetName, 459, 6, 1194d),
					new ExpectedCellValue(sheetName, 460, 6, 831.5),
					new ExpectedCellValue(sheetName, 461, 6, 831.5),
					new ExpectedCellValue(sheetName, 462, 6, 514.75),
					new ExpectedCellValue(sheetName, 463, 6, 415.75),
					new ExpectedCellValue(sheetName, 464, 6, 415.75),
					new ExpectedCellValue(sheetName, 465, 6, 99d),
					new ExpectedCellValue(sheetName, 466, 6, 99d),
					new ExpectedCellValue(sheetName, 467, 6, 1985.99),
					new ExpectedCellValue(sheetName, 468, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondFieldTabularThirdAndLastFieldsFirstFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable22"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("C430:F474"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 3, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 3, null),
					new ExpectedCellValue(sheetName, 434, 3, null),
					new ExpectedCellValue(sheetName, 435, 3, null),
					new ExpectedCellValue(sheetName, 436, 3, null),
					new ExpectedCellValue(sheetName, 437, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 438, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 439, 3, null),
					new ExpectedCellValue(sheetName, 440, 3, null),
					new ExpectedCellValue(sheetName, 441, 3, null),
					new ExpectedCellValue(sheetName, 442, 3, null),
					new ExpectedCellValue(sheetName, 443, 3, null),
					new ExpectedCellValue(sheetName, 444, 3, null),
					new ExpectedCellValue(sheetName, 445, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 446, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 447, 3, null),
					new ExpectedCellValue(sheetName, 448, 3, null),
					new ExpectedCellValue(sheetName, 449, 3, null),
					new ExpectedCellValue(sheetName, 450, 3, null),
					new ExpectedCellValue(sheetName, 451, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 452, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 453, 3, "Chicago"),
					new ExpectedCellValue(sheetName, 454, 3, null),
					new ExpectedCellValue(sheetName, 455, 3, null),
					new ExpectedCellValue(sheetName, 456, 3, null),
					new ExpectedCellValue(sheetName, 457, 3, null),
					new ExpectedCellValue(sheetName, 458, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 459, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 460, 3, null),
					new ExpectedCellValue(sheetName, 461, 3, null),
					new ExpectedCellValue(sheetName, 462, 3, null),
					new ExpectedCellValue(sheetName, 463, 3, null),
					new ExpectedCellValue(sheetName, 464, 3, null),
					new ExpectedCellValue(sheetName, 465, 3, null),
					new ExpectedCellValue(sheetName, 466, 3, "Nashville Total"),
					new ExpectedCellValue(sheetName, 467, 3, "San Francisco"),
					new ExpectedCellValue(sheetName, 468, 3, null),
					new ExpectedCellValue(sheetName, 469, 3, null),
					new ExpectedCellValue(sheetName, 470, 3, null),
					new ExpectedCellValue(sheetName, 471, 3, null),
					new ExpectedCellValue(sheetName, 472, 3, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 473, 3, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 474, 3, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 4, "Month"),
					new ExpectedCellValue(sheetName, 431, 4, null),
					new ExpectedCellValue(sheetName, 432, 4, null),
					new ExpectedCellValue(sheetName, 433, 4, "January"),
					new ExpectedCellValue(sheetName, 434, 4, "January Total"),
					new ExpectedCellValue(sheetName, 435, 4, "March"),
					new ExpectedCellValue(sheetName, 436, 4, "March Total"),
					new ExpectedCellValue(sheetName, 437, 4, null),
					new ExpectedCellValue(sheetName, 438, 4, null),
					new ExpectedCellValue(sheetName, 439, 4, "January"),
					new ExpectedCellValue(sheetName, 440, 4, "January Total"),
					new ExpectedCellValue(sheetName, 441, 4, "February"),
					new ExpectedCellValue(sheetName, 442, 4, "February Total"),
					new ExpectedCellValue(sheetName, 443, 4, "March"),
					new ExpectedCellValue(sheetName, 444, 4, "March Total"),
					new ExpectedCellValue(sheetName, 445, 4, null),
					new ExpectedCellValue(sheetName, 446, 4, null),
					new ExpectedCellValue(sheetName, 447, 4, "January"),
					new ExpectedCellValue(sheetName, 448, 4, "January Total"),
					new ExpectedCellValue(sheetName, 449, 4, "February"),
					new ExpectedCellValue(sheetName, 450, 4, "February Total"),
					new ExpectedCellValue(sheetName, 451, 4, null),
					new ExpectedCellValue(sheetName, 452, 4, null),
					new ExpectedCellValue(sheetName, 453, 4, null),
					new ExpectedCellValue(sheetName, 454, 4, "January"),
					new ExpectedCellValue(sheetName, 455, 4, "January Total"),
					new ExpectedCellValue(sheetName, 456, 4, "March"),
					new ExpectedCellValue(sheetName, 457, 4, "March Total"),
					new ExpectedCellValue(sheetName, 458, 4, null),
					new ExpectedCellValue(sheetName, 459, 4, null),
					new ExpectedCellValue(sheetName, 460, 4, "January"),
					new ExpectedCellValue(sheetName, 461, 4, "January Total"),
					new ExpectedCellValue(sheetName, 462, 4, "February"),
					new ExpectedCellValue(sheetName, 463, 4, "February Total"),
					new ExpectedCellValue(sheetName, 464, 4, "March"),
					new ExpectedCellValue(sheetName, 465, 4, "March Total"),
					new ExpectedCellValue(sheetName, 466, 4, null),
					new ExpectedCellValue(sheetName, 467, 4, null),
					new ExpectedCellValue(sheetName, 468, 4, "January"),
					new ExpectedCellValue(sheetName, 469, 4, "January Total"),
					new ExpectedCellValue(sheetName, 470, 4, "February"),
					new ExpectedCellValue(sheetName, 471, 4, "February Total"),
					new ExpectedCellValue(sheetName, 472, 4, null),
					new ExpectedCellValue(sheetName, 473, 4, null),
					new ExpectedCellValue(sheetName, 474, 4, null),
					new ExpectedCellValue(sheetName, 430, 5, "Item"),
					new ExpectedCellValue(sheetName, 431, 5, null),
					new ExpectedCellValue(sheetName, 432, 5, null),
					new ExpectedCellValue(sheetName, 433, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 434, 5, null),
					new ExpectedCellValue(sheetName, 435, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 436, 5, null),
					new ExpectedCellValue(sheetName, 437, 5, null),
					new ExpectedCellValue(sheetName, 438, 5, null),
					new ExpectedCellValue(sheetName, 439, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 440, 5, null),
					new ExpectedCellValue(sheetName, 441, 5, "Tent"),
					new ExpectedCellValue(sheetName, 442, 5, null),
					new ExpectedCellValue(sheetName, 443, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 444, 5, null),
					new ExpectedCellValue(sheetName, 445, 5, null),
					new ExpectedCellValue(sheetName, 446, 5, null),
					new ExpectedCellValue(sheetName, 447, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 448, 5, null),
					new ExpectedCellValue(sheetName, 449, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 450, 5, null),
					new ExpectedCellValue(sheetName, 451, 5, null),
					new ExpectedCellValue(sheetName, 452, 5, null),
					new ExpectedCellValue(sheetName, 453, 5, null),
					new ExpectedCellValue(sheetName, 454, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 455, 5, null),
					new ExpectedCellValue(sheetName, 456, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 457, 5, null),
					new ExpectedCellValue(sheetName, 458, 5, null),
					new ExpectedCellValue(sheetName, 459, 5, null),
					new ExpectedCellValue(sheetName, 460, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 461, 5, null),
					new ExpectedCellValue(sheetName, 462, 5, "Tent"),
					new ExpectedCellValue(sheetName, 463, 5, null),
					new ExpectedCellValue(sheetName, 464, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 465, 5, null),
					new ExpectedCellValue(sheetName, 466, 5, null),
					new ExpectedCellValue(sheetName, 467, 5, null),
					new ExpectedCellValue(sheetName, 468, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 469, 5, null),
					new ExpectedCellValue(sheetName, 470, 5, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 471, 5, null),
					new ExpectedCellValue(sheetName, 472, 5, null),
					new ExpectedCellValue(sheetName, 473, 5, null),
					new ExpectedCellValue(sheetName, 474, 5, null),
					new ExpectedCellValue(sheetName, 430, 6, null),
					new ExpectedCellValue(sheetName, 431, 6, null),
					new ExpectedCellValue(sheetName, 432, 6, null),
					new ExpectedCellValue(sheetName, 433, 6, 415.75),
					new ExpectedCellValue(sheetName, 434, 6, 415.75),
					new ExpectedCellValue(sheetName, 435, 6, 24.99),
					new ExpectedCellValue(sheetName, 436, 6, 24.99),
					new ExpectedCellValue(sheetName, 437, 6, 440.74),
					new ExpectedCellValue(sheetName, 438, 6, null),
					new ExpectedCellValue(sheetName, 439, 6, 415.75),
					new ExpectedCellValue(sheetName, 440, 6, 415.75),
					new ExpectedCellValue(sheetName, 441, 6, 199d),
					new ExpectedCellValue(sheetName, 442, 6, 199d),
					new ExpectedCellValue(sheetName, 443, 6, 415.75),
					new ExpectedCellValue(sheetName, 444, 6, 415.75),
					new ExpectedCellValue(sheetName, 445, 6, 1030.5),
					new ExpectedCellValue(sheetName, 446, 6, null),
					new ExpectedCellValue(sheetName, 447, 6, 415.75),
					new ExpectedCellValue(sheetName, 448, 6, 415.75),
					new ExpectedCellValue(sheetName, 449, 6, 99d),
					new ExpectedCellValue(sheetName, 450, 6, 99d),
					new ExpectedCellValue(sheetName, 451, 6, 514.75),
					new ExpectedCellValue(sheetName, 452, 6, null),
					new ExpectedCellValue(sheetName, 453, 6, null),
					new ExpectedCellValue(sheetName, 454, 6, 831.5),
					new ExpectedCellValue(sheetName, 455, 6, 831.5),
					new ExpectedCellValue(sheetName, 456, 6, 24.99),
					new ExpectedCellValue(sheetName, 457, 6, 24.99),
					new ExpectedCellValue(sheetName, 458, 6, 856.49),
					new ExpectedCellValue(sheetName, 459, 6, null),
					new ExpectedCellValue(sheetName, 460, 6, 831.5),
					new ExpectedCellValue(sheetName, 461, 6, 831.5),
					new ExpectedCellValue(sheetName, 462, 6, 1194d),
					new ExpectedCellValue(sheetName, 463, 6, 1194d),
					new ExpectedCellValue(sheetName, 464, 6, 831.5),
					new ExpectedCellValue(sheetName, 465, 6, 831.5),
					new ExpectedCellValue(sheetName, 466, 6, 2857d),
					new ExpectedCellValue(sheetName, 467, 6, null),
					new ExpectedCellValue(sheetName, 468, 6, 415.75),
					new ExpectedCellValue(sheetName, 469, 6, 415.75),
					new ExpectedCellValue(sheetName, 470, 6, 99d),
					new ExpectedCellValue(sheetName, 471, 6, 99d),
					new ExpectedCellValue(sheetName, 472, 6, 514.75),
					new ExpectedCellValue(sheetName, 473, 6, 1985.99),
					new ExpectedCellValue(sheetName, 474, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondAndLastFieldsTabularThirdFieldFirstFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable23"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J430:M454"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 10, null),
					new ExpectedCellValue(sheetName, 434, 10, null),
					new ExpectedCellValue(sheetName, 435, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 436, 10, null),
					new ExpectedCellValue(sheetName, 437, 10, null),
					new ExpectedCellValue(sheetName, 438, 10, null),
					new ExpectedCellValue(sheetName, 439, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 440, 10, null),
					new ExpectedCellValue(sheetName, 441, 10, null),
					new ExpectedCellValue(sheetName, 442, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 443, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 444, 10, null),
					new ExpectedCellValue(sheetName, 445, 10, null),
					new ExpectedCellValue(sheetName, 446, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 447, 10, null),
					new ExpectedCellValue(sheetName, 448, 10, null),
					new ExpectedCellValue(sheetName, 449, 10, null),
					new ExpectedCellValue(sheetName, 450, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 451, 10, null),
					new ExpectedCellValue(sheetName, 452, 10, null),
					new ExpectedCellValue(sheetName, 453, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 454, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 11, "Month"),
					new ExpectedCellValue(sheetName, 431, 11, null),
					new ExpectedCellValue(sheetName, 432, 11, null),
					new ExpectedCellValue(sheetName, 433, 11, "January"),
					new ExpectedCellValue(sheetName, 434, 11, "March"),
					new ExpectedCellValue(sheetName, 435, 11, null),
					new ExpectedCellValue(sheetName, 436, 11, "January"),
					new ExpectedCellValue(sheetName, 437, 11, "February"),
					new ExpectedCellValue(sheetName, 438, 11, "March"),
					new ExpectedCellValue(sheetName, 439, 11, null),
					new ExpectedCellValue(sheetName, 440, 11, "January"),
					new ExpectedCellValue(sheetName, 441, 11, "February"),
					new ExpectedCellValue(sheetName, 442, 11, null),
					new ExpectedCellValue(sheetName, 443, 11, null),
					new ExpectedCellValue(sheetName, 444, 11, "January"),
					new ExpectedCellValue(sheetName, 445, 11, "March"),
					new ExpectedCellValue(sheetName, 446, 11, null),
					new ExpectedCellValue(sheetName, 447, 11, "January"),
					new ExpectedCellValue(sheetName, 448, 11, "February"),
					new ExpectedCellValue(sheetName, 449, 11, "March"),
					new ExpectedCellValue(sheetName, 450, 11, null),
					new ExpectedCellValue(sheetName, 451, 11, "January"),
					new ExpectedCellValue(sheetName, 452, 11, "February"),
					new ExpectedCellValue(sheetName, 453, 11, null),
					new ExpectedCellValue(sheetName, 454, 11, null),
					new ExpectedCellValue(sheetName, 430, 12, "Item"),
					new ExpectedCellValue(sheetName, 431, 12, null),
					new ExpectedCellValue(sheetName, 432, 12, null),
					new ExpectedCellValue(sheetName, 433, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 434, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 435, 12, null),
					new ExpectedCellValue(sheetName, 436, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 437, 12, "Tent"),
					new ExpectedCellValue(sheetName, 438, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 439, 12, null),
					new ExpectedCellValue(sheetName, 440, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 441, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 442, 12, null),
					new ExpectedCellValue(sheetName, 443, 12, null),
					new ExpectedCellValue(sheetName, 444, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 445, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 446, 12, null),
					new ExpectedCellValue(sheetName, 447, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 448, 12, "Tent"),
					new ExpectedCellValue(sheetName, 449, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 450, 12, null),
					new ExpectedCellValue(sheetName, 451, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 452, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 453, 12, null),
					new ExpectedCellValue(sheetName, 454, 12, null),
					new ExpectedCellValue(sheetName, 430, 13, null),
					new ExpectedCellValue(sheetName, 431, 13, null),
					new ExpectedCellValue(sheetName, 432, 13, null),
					new ExpectedCellValue(sheetName, 433, 13, 415.75),
					new ExpectedCellValue(sheetName, 434, 13, 24.99),
					new ExpectedCellValue(sheetName, 435, 13, null),
					new ExpectedCellValue(sheetName, 436, 13, 415.75),
					new ExpectedCellValue(sheetName, 437, 13, 199d),
					new ExpectedCellValue(sheetName, 438, 13, 415.75),
					new ExpectedCellValue(sheetName, 439, 13, null),
					new ExpectedCellValue(sheetName, 440, 13, 415.75),
					new ExpectedCellValue(sheetName, 441, 13, 99d),
					new ExpectedCellValue(sheetName, 442, 13, null),
					new ExpectedCellValue(sheetName, 443, 13, null),
					new ExpectedCellValue(sheetName, 444, 13, 831.5),
					new ExpectedCellValue(sheetName, 445, 13, 24.99),
					new ExpectedCellValue(sheetName, 446, 13, null),
					new ExpectedCellValue(sheetName, 447, 13, 831.5),
					new ExpectedCellValue(sheetName, 448, 13, 1194d),
					new ExpectedCellValue(sheetName, 449, 13, 831.5),
					new ExpectedCellValue(sheetName, 450, 13, null),
					new ExpectedCellValue(sheetName, 451, 13, 415.75),
					new ExpectedCellValue(sheetName, 452, 13, 99d),
					new ExpectedCellValue(sheetName, 453, 13, 1985.99),
					new ExpectedCellValue(sheetName, 454, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondAndLastFieldsTabularThirdFieldFirstFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable23"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J430:M468"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 10, null),
					new ExpectedCellValue(sheetName, 434, 10, null),
					new ExpectedCellValue(sheetName, 435, 10, null),
					new ExpectedCellValue(sheetName, 436, 10, null),
					new ExpectedCellValue(sheetName, 437, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 438, 10, null),
					new ExpectedCellValue(sheetName, 439, 10, null),
					new ExpectedCellValue(sheetName, 440, 10, null),
					new ExpectedCellValue(sheetName, 441, 10, null),
					new ExpectedCellValue(sheetName, 442, 10, null),
					new ExpectedCellValue(sheetName, 443, 10, null),
					new ExpectedCellValue(sheetName, 444, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 445, 10, null),
					new ExpectedCellValue(sheetName, 446, 10, null),
					new ExpectedCellValue(sheetName, 447, 10, null),
					new ExpectedCellValue(sheetName, 448, 10, null),
					new ExpectedCellValue(sheetName, 449, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 450, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 451, 10, null),
					new ExpectedCellValue(sheetName, 452, 10, null),
					new ExpectedCellValue(sheetName, 453, 10, null),
					new ExpectedCellValue(sheetName, 454, 10, null),
					new ExpectedCellValue(sheetName, 455, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 456, 10, null),
					new ExpectedCellValue(sheetName, 457, 10, null),
					new ExpectedCellValue(sheetName, 458, 10, null),
					new ExpectedCellValue(sheetName, 459, 10, null),
					new ExpectedCellValue(sheetName, 460, 10, null),
					new ExpectedCellValue(sheetName, 461, 10, null),
					new ExpectedCellValue(sheetName, 462, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 463, 10, null),
					new ExpectedCellValue(sheetName, 464, 10, null),
					new ExpectedCellValue(sheetName, 465, 10, null),
					new ExpectedCellValue(sheetName, 466, 10, null),
					new ExpectedCellValue(sheetName, 467, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 468, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 11, "Month"),
					new ExpectedCellValue(sheetName, 431, 11, null),
					new ExpectedCellValue(sheetName, 432, 11, null),
					new ExpectedCellValue(sheetName, 433, 11, "January"),
					new ExpectedCellValue(sheetName, 434, 11, "January Total"),
					new ExpectedCellValue(sheetName, 435, 11, "March"),
					new ExpectedCellValue(sheetName, 436, 11, "March Total"),
					new ExpectedCellValue(sheetName, 437, 11, null),
					new ExpectedCellValue(sheetName, 438, 11, "January"),
					new ExpectedCellValue(sheetName, 439, 11, "January Total"),
					new ExpectedCellValue(sheetName, 440, 11, "February"),
					new ExpectedCellValue(sheetName, 441, 11, "February Total"),
					new ExpectedCellValue(sheetName, 442, 11, "March"),
					new ExpectedCellValue(sheetName, 443, 11, "March Total"),
					new ExpectedCellValue(sheetName, 444, 11, null),
					new ExpectedCellValue(sheetName, 445, 11, "January"),
					new ExpectedCellValue(sheetName, 446, 11, "January Total"),
					new ExpectedCellValue(sheetName, 447, 11, "February"),
					new ExpectedCellValue(sheetName, 448, 11, "February Total"),
					new ExpectedCellValue(sheetName, 449, 11, null),
					new ExpectedCellValue(sheetName, 450, 11, null),
					new ExpectedCellValue(sheetName, 451, 11, "January"),
					new ExpectedCellValue(sheetName, 452, 11, "January Total"),
					new ExpectedCellValue(sheetName, 453, 11, "March"),
					new ExpectedCellValue(sheetName, 454, 11, "March Total"),
					new ExpectedCellValue(sheetName, 455, 11, null),
					new ExpectedCellValue(sheetName, 456, 11, "January"),
					new ExpectedCellValue(sheetName, 457, 11, "January Total"),
					new ExpectedCellValue(sheetName, 458, 11, "February"),
					new ExpectedCellValue(sheetName, 459, 11, "February Total"),
					new ExpectedCellValue(sheetName, 460, 11, "March"),
					new ExpectedCellValue(sheetName, 461, 11, "March Total"),
					new ExpectedCellValue(sheetName, 462, 11, null),
					new ExpectedCellValue(sheetName, 463, 11, "January"),
					new ExpectedCellValue(sheetName, 464, 11, "January Total"),
					new ExpectedCellValue(sheetName, 465, 11, "February"),
					new ExpectedCellValue(sheetName, 466, 11, "February Total"),
					new ExpectedCellValue(sheetName, 467, 11, null),
					new ExpectedCellValue(sheetName, 468, 11, null),
					new ExpectedCellValue(sheetName, 430, 12, "Item"),
					new ExpectedCellValue(sheetName, 431, 12, null),
					new ExpectedCellValue(sheetName, 432, 12, null),
					new ExpectedCellValue(sheetName, 433, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 434, 12, null),
					new ExpectedCellValue(sheetName, 435, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 436, 12, null),
					new ExpectedCellValue(sheetName, 437, 12, null),
					new ExpectedCellValue(sheetName, 438, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 439, 12, null),
					new ExpectedCellValue(sheetName, 440, 12, "Tent"),
					new ExpectedCellValue(sheetName, 441, 12, null),
					new ExpectedCellValue(sheetName, 442, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 443, 12, null),
					new ExpectedCellValue(sheetName, 444, 12, null),
					new ExpectedCellValue(sheetName, 445, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 446, 12, null),
					new ExpectedCellValue(sheetName, 447, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 448, 12, null),
					new ExpectedCellValue(sheetName, 449, 12, null),
					new ExpectedCellValue(sheetName, 450, 12, null),
					new ExpectedCellValue(sheetName, 451, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 452, 12, null),
					new ExpectedCellValue(sheetName, 453, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 454, 12, null),
					new ExpectedCellValue(sheetName, 455, 12, null),
					new ExpectedCellValue(sheetName, 456, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 457, 12, null),
					new ExpectedCellValue(sheetName, 458, 12, "Tent"),
					new ExpectedCellValue(sheetName, 459, 12, null),
					new ExpectedCellValue(sheetName, 460, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 461, 12, null),
					new ExpectedCellValue(sheetName, 462, 12, null),
					new ExpectedCellValue(sheetName, 463, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 464, 12, null),
					new ExpectedCellValue(sheetName, 465, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 466, 12, null),
					new ExpectedCellValue(sheetName, 467, 12, null),
					new ExpectedCellValue(sheetName, 468, 12, null),
					new ExpectedCellValue(sheetName, 430, 13, null),
					new ExpectedCellValue(sheetName, 431, 13, null),
					new ExpectedCellValue(sheetName, 432, 13, 440.74),
					new ExpectedCellValue(sheetName, 433, 13, 415.75),
					new ExpectedCellValue(sheetName, 434, 13, 415.75),
					new ExpectedCellValue(sheetName, 435, 13, 24.99),
					new ExpectedCellValue(sheetName, 436, 13, 24.99),
					new ExpectedCellValue(sheetName, 437, 13, 1030.5),
					new ExpectedCellValue(sheetName, 438, 13, 415.75),
					new ExpectedCellValue(sheetName, 439, 13, 415.75),
					new ExpectedCellValue(sheetName, 440, 13, 199d),
					new ExpectedCellValue(sheetName, 441, 13, 199d),
					new ExpectedCellValue(sheetName, 442, 13, 415.75),
					new ExpectedCellValue(sheetName, 443, 13, 415.75),
					new ExpectedCellValue(sheetName, 444, 13, 514.75),
					new ExpectedCellValue(sheetName, 445, 13, 415.75),
					new ExpectedCellValue(sheetName, 446, 13, 415.75),
					new ExpectedCellValue(sheetName, 447, 13, 99d),
					new ExpectedCellValue(sheetName, 448, 13, 99d),
					new ExpectedCellValue(sheetName, 449, 13, null),
					new ExpectedCellValue(sheetName, 450, 13, 856.49),
					new ExpectedCellValue(sheetName, 451, 13, 831.5),
					new ExpectedCellValue(sheetName, 452, 13, 831.5),
					new ExpectedCellValue(sheetName, 453, 13, 24.99),
					new ExpectedCellValue(sheetName, 454, 13, 24.99),
					new ExpectedCellValue(sheetName, 455, 13, 2857d),
					new ExpectedCellValue(sheetName, 456, 13, 831.5),
					new ExpectedCellValue(sheetName, 457, 13, 831.5),
					new ExpectedCellValue(sheetName, 458, 13, 1194d),
					new ExpectedCellValue(sheetName, 459, 13, 1194d),
					new ExpectedCellValue(sheetName, 460, 13, 831.5),
					new ExpectedCellValue(sheetName, 461, 13, 831.5),
					new ExpectedCellValue(sheetName, 462, 13, 514.75),
					new ExpectedCellValue(sheetName, 463, 13, 415.75),
					new ExpectedCellValue(sheetName, 464, 13, 415.75),
					new ExpectedCellValue(sheetName, 465, 13, 99d),
					new ExpectedCellValue(sheetName, 466, 13, 99d),
					new ExpectedCellValue(sheetName, 467, 13, 1985.99),
					new ExpectedCellValue(sheetName, 468, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondAndLastFieldsTabularThirdFieldFirstFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable23"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("J430:M474"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 10, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 10, null),
					new ExpectedCellValue(sheetName, 434, 10, null),
					new ExpectedCellValue(sheetName, 435, 10, null),
					new ExpectedCellValue(sheetName, 436, 10, null),
					new ExpectedCellValue(sheetName, 437, 10, "Chicago Total"),
					new ExpectedCellValue(sheetName, 438, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 439, 10, null),
					new ExpectedCellValue(sheetName, 440, 10, null),
					new ExpectedCellValue(sheetName, 441, 10, null),
					new ExpectedCellValue(sheetName, 442, 10, null),
					new ExpectedCellValue(sheetName, 443, 10, null),
					new ExpectedCellValue(sheetName, 444, 10, null),
					new ExpectedCellValue(sheetName, 445, 10, "Nashville Total"),
					new ExpectedCellValue(sheetName, 446, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 447, 10, null),
					new ExpectedCellValue(sheetName, 448, 10, null),
					new ExpectedCellValue(sheetName, 449, 10, null),
					new ExpectedCellValue(sheetName, 450, 10, null),
					new ExpectedCellValue(sheetName, 451, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 452, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 453, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 454, 10, null),
					new ExpectedCellValue(sheetName, 455, 10, null),
					new ExpectedCellValue(sheetName, 456, 10, null),
					new ExpectedCellValue(sheetName, 457, 10, null),
					new ExpectedCellValue(sheetName, 458, 10, "Chicago Total"),
					new ExpectedCellValue(sheetName, 459, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 460, 10, null),
					new ExpectedCellValue(sheetName, 461, 10, null),
					new ExpectedCellValue(sheetName, 462, 10, null),
					new ExpectedCellValue(sheetName, 463, 10, null),
					new ExpectedCellValue(sheetName, 464, 10, null),
					new ExpectedCellValue(sheetName, 465, 10, null),
					new ExpectedCellValue(sheetName, 466, 10, "Nashville Total"),
					new ExpectedCellValue(sheetName, 467, 10, "San Francisco"),
					new ExpectedCellValue(sheetName, 468, 10, null),
					new ExpectedCellValue(sheetName, 469, 10, null),
					new ExpectedCellValue(sheetName, 470, 10, null),
					new ExpectedCellValue(sheetName, 471, 10, null),
					new ExpectedCellValue(sheetName, 472, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 473, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 474, 10, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 11, "Month"),
					new ExpectedCellValue(sheetName, 431, 11, null),
					new ExpectedCellValue(sheetName, 432, 11, null),
					new ExpectedCellValue(sheetName, 433, 11, "January"),
					new ExpectedCellValue(sheetName, 434, 11, "January Total"),
					new ExpectedCellValue(sheetName, 435, 11, "March"),
					new ExpectedCellValue(sheetName, 436, 11, "March Total"),
					new ExpectedCellValue(sheetName, 437, 11, null),
					new ExpectedCellValue(sheetName, 438, 11, null),
					new ExpectedCellValue(sheetName, 439, 11, "January"),
					new ExpectedCellValue(sheetName, 440, 11, "January Total"),
					new ExpectedCellValue(sheetName, 441, 11, "February"),
					new ExpectedCellValue(sheetName, 442, 11, "February Total"),
					new ExpectedCellValue(sheetName, 443, 11, "March"),
					new ExpectedCellValue(sheetName, 444, 11, "March Total"),
					new ExpectedCellValue(sheetName, 445, 11, null),
					new ExpectedCellValue(sheetName, 446, 11, null),
					new ExpectedCellValue(sheetName, 447, 11, "January"),
					new ExpectedCellValue(sheetName, 448, 11, "January Total"),
					new ExpectedCellValue(sheetName, 449, 11, "February"),
					new ExpectedCellValue(sheetName, 450, 11, "February Total"),
					new ExpectedCellValue(sheetName, 451, 11, null),
					new ExpectedCellValue(sheetName, 452, 11, null),
					new ExpectedCellValue(sheetName, 453, 11, null),
					new ExpectedCellValue(sheetName, 454, 11, "January"),
					new ExpectedCellValue(sheetName, 455, 11, "January Total"),
					new ExpectedCellValue(sheetName, 456, 11, "March"),
					new ExpectedCellValue(sheetName, 457, 11, "March Total"),
					new ExpectedCellValue(sheetName, 458, 11, null),
					new ExpectedCellValue(sheetName, 459, 11, null),
					new ExpectedCellValue(sheetName, 460, 11, "January"),
					new ExpectedCellValue(sheetName, 461, 11, "January Total"),
					new ExpectedCellValue(sheetName, 462, 11, "February"),
					new ExpectedCellValue(sheetName, 463, 11, "February Total"),
					new ExpectedCellValue(sheetName, 464, 11, "March"),
					new ExpectedCellValue(sheetName, 465, 11, "March Total"),
					new ExpectedCellValue(sheetName, 466, 11, null),
					new ExpectedCellValue(sheetName, 467, 11, null),
					new ExpectedCellValue(sheetName, 468, 11, "January"),
					new ExpectedCellValue(sheetName, 469, 11, "January Total"),
					new ExpectedCellValue(sheetName, 470, 11, "February"),
					new ExpectedCellValue(sheetName, 471, 11, "February Total"),
					new ExpectedCellValue(sheetName, 472, 11, null),
					new ExpectedCellValue(sheetName, 473, 11, null),
					new ExpectedCellValue(sheetName, 474, 11, null),
					new ExpectedCellValue(sheetName, 430, 12, "Item"),
					new ExpectedCellValue(sheetName, 431, 12, null),
					new ExpectedCellValue(sheetName, 432, 12, null),
					new ExpectedCellValue(sheetName, 433, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 434, 12, null),
					new ExpectedCellValue(sheetName, 435, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 436, 12, null),
					new ExpectedCellValue(sheetName, 437, 12, null),
					new ExpectedCellValue(sheetName, 438, 12, null),
					new ExpectedCellValue(sheetName, 439, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 440, 12, null),
					new ExpectedCellValue(sheetName, 441, 12, "Tent"),
					new ExpectedCellValue(sheetName, 442, 12, null),
					new ExpectedCellValue(sheetName, 443, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 444, 12, null),
					new ExpectedCellValue(sheetName, 445, 12, null),
					new ExpectedCellValue(sheetName, 446, 12, null),
					new ExpectedCellValue(sheetName, 447, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 448, 12, null),
					new ExpectedCellValue(sheetName, 449, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 450, 12, null),
					new ExpectedCellValue(sheetName, 451, 12, null),
					new ExpectedCellValue(sheetName, 452, 12, null),
					new ExpectedCellValue(sheetName, 453, 12, null),
					new ExpectedCellValue(sheetName, 454, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 455, 12, null),
					new ExpectedCellValue(sheetName, 456, 12, "Headlamp"),
					new ExpectedCellValue(sheetName, 457, 12, null),
					new ExpectedCellValue(sheetName, 458, 12, null),
					new ExpectedCellValue(sheetName, 459, 12, null),
					new ExpectedCellValue(sheetName, 460, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 461, 12, null),
					new ExpectedCellValue(sheetName, 462, 12, "Tent"),
					new ExpectedCellValue(sheetName, 463, 12, null),
					new ExpectedCellValue(sheetName, 464, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 465, 12, null),
					new ExpectedCellValue(sheetName, 466, 12, null),
					new ExpectedCellValue(sheetName, 467, 12, null),
					new ExpectedCellValue(sheetName, 468, 12, "Car Rack"),
					new ExpectedCellValue(sheetName, 469, 12, null),
					new ExpectedCellValue(sheetName, 470, 12, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 471, 12, null),
					new ExpectedCellValue(sheetName, 472, 12, null),
					new ExpectedCellValue(sheetName, 473, 12, null),
					new ExpectedCellValue(sheetName, 474, 12, null),
					new ExpectedCellValue(sheetName, 430, 13, null),
					new ExpectedCellValue(sheetName, 431, 13, null),
					new ExpectedCellValue(sheetName, 432, 13, null),
					new ExpectedCellValue(sheetName, 433, 13, 415.75),
					new ExpectedCellValue(sheetName, 434, 13, 415.75),
					new ExpectedCellValue(sheetName, 435, 13, 24.99),
					new ExpectedCellValue(sheetName, 436, 13, 24.99),
					new ExpectedCellValue(sheetName, 437, 13, 440.74),
					new ExpectedCellValue(sheetName, 438, 13, null),
					new ExpectedCellValue(sheetName, 439, 13, 415.75),
					new ExpectedCellValue(sheetName, 440, 13, 415.75),
					new ExpectedCellValue(sheetName, 441, 13, 199d),
					new ExpectedCellValue(sheetName, 442, 13, 199d),
					new ExpectedCellValue(sheetName, 443, 13, 415.75),
					new ExpectedCellValue(sheetName, 444, 13, 415.75),
					new ExpectedCellValue(sheetName, 445, 13, 1030.5),
					new ExpectedCellValue(sheetName, 446, 13, null),
					new ExpectedCellValue(sheetName, 447, 13, 415.75),
					new ExpectedCellValue(sheetName, 448, 13, 415.75),
					new ExpectedCellValue(sheetName, 449, 13, 99d),
					new ExpectedCellValue(sheetName, 450, 13, 99d),
					new ExpectedCellValue(sheetName, 451, 13, 514.75),
					new ExpectedCellValue(sheetName, 452, 13, null),
					new ExpectedCellValue(sheetName, 453, 13, null),
					new ExpectedCellValue(sheetName, 454, 13, 831.5),
					new ExpectedCellValue(sheetName, 455, 13, 831.5),
					new ExpectedCellValue(sheetName, 456, 13, 24.99),
					new ExpectedCellValue(sheetName, 457, 13, 24.99),
					new ExpectedCellValue(sheetName, 458, 13, 856.49),
					new ExpectedCellValue(sheetName, 459, 13, null),
					new ExpectedCellValue(sheetName, 460, 13, 831.5),
					new ExpectedCellValue(sheetName, 461, 13, 831.5),
					new ExpectedCellValue(sheetName, 462, 13, 1194d),
					new ExpectedCellValue(sheetName, 463, 13, 1194d),
					new ExpectedCellValue(sheetName, 464, 13, 831.5),
					new ExpectedCellValue(sheetName, 465, 13, 831.5),
					new ExpectedCellValue(sheetName, 466, 13, 2857d),
					new ExpectedCellValue(sheetName, 467, 13, null),
					new ExpectedCellValue(sheetName, 468, 13, 415.75),
					new ExpectedCellValue(sheetName, 469, 13, 415.75),
					new ExpectedCellValue(sheetName, 470, 13, 99d),
					new ExpectedCellValue(sheetName, 471, 13, 99d),
					new ExpectedCellValue(sheetName, 472, 13, 514.75),
					new ExpectedCellValue(sheetName, 473, 13, 1985.99),
					new ExpectedCellValue(sheetName, 474, 13, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondAndThirdFieldsTabularLastFieldFirstFieldLeafDataFieldSubtotalOff()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable24"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q430:T468"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 17, null),
					new ExpectedCellValue(sheetName, 434, 17, null),
					new ExpectedCellValue(sheetName, 435, 17, null),
					new ExpectedCellValue(sheetName, 436, 17, null),
					new ExpectedCellValue(sheetName, 437, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 438, 17, null),
					new ExpectedCellValue(sheetName, 439, 17, null),
					new ExpectedCellValue(sheetName, 440, 17, null),
					new ExpectedCellValue(sheetName, 441, 17, null),
					new ExpectedCellValue(sheetName, 442, 17, null),
					new ExpectedCellValue(sheetName, 443, 17, null),
					new ExpectedCellValue(sheetName, 444, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 445, 17, null),
					new ExpectedCellValue(sheetName, 446, 17, null),
					new ExpectedCellValue(sheetName, 447, 17, null),
					new ExpectedCellValue(sheetName, 448, 17, null),
					new ExpectedCellValue(sheetName, 449, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 450, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 451, 17, null),
					new ExpectedCellValue(sheetName, 452, 17, null),
					new ExpectedCellValue(sheetName, 453, 17, null),
					new ExpectedCellValue(sheetName, 454, 17, null),
					new ExpectedCellValue(sheetName, 455, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 456, 17, null),
					new ExpectedCellValue(sheetName, 457, 17, null),
					new ExpectedCellValue(sheetName, 458, 17, null),
					new ExpectedCellValue(sheetName, 459, 17, null),
					new ExpectedCellValue(sheetName, 460, 17, null),
					new ExpectedCellValue(sheetName, 461, 17, null),
					new ExpectedCellValue(sheetName, 462, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 463, 17, null),
					new ExpectedCellValue(sheetName, 464, 17, null),
					new ExpectedCellValue(sheetName, 465, 17, null),
					new ExpectedCellValue(sheetName, 466, 17, null),
					new ExpectedCellValue(sheetName, 467, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 468, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 18, "Month"),
					new ExpectedCellValue(sheetName, 431, 18, null),
					new ExpectedCellValue(sheetName, 432, 18, null),
					new ExpectedCellValue(sheetName, 433, 18, "January"),
					new ExpectedCellValue(sheetName, 434, 18, null),
					new ExpectedCellValue(sheetName, 435, 18, "March"),
					new ExpectedCellValue(sheetName, 436, 18, null),
					new ExpectedCellValue(sheetName, 437, 18, null),
					new ExpectedCellValue(sheetName, 438, 18, "January"),
					new ExpectedCellValue(sheetName, 439, 18, null),
					new ExpectedCellValue(sheetName, 440, 18, "February"),
					new ExpectedCellValue(sheetName, 441, 18, null),
					new ExpectedCellValue(sheetName, 442, 18, "March"),
					new ExpectedCellValue(sheetName, 443, 18, null),
					new ExpectedCellValue(sheetName, 444, 18, null),
					new ExpectedCellValue(sheetName, 445, 18, "January"),
					new ExpectedCellValue(sheetName, 446, 18, null),
					new ExpectedCellValue(sheetName, 447, 18, "February"),
					new ExpectedCellValue(sheetName, 448, 18, null),
					new ExpectedCellValue(sheetName, 449, 18, null),
					new ExpectedCellValue(sheetName, 450, 18, null),
					new ExpectedCellValue(sheetName, 451, 18, "January"),
					new ExpectedCellValue(sheetName, 452, 18, null),
					new ExpectedCellValue(sheetName, 453, 18, "March"),
					new ExpectedCellValue(sheetName, 454, 18, null),
					new ExpectedCellValue(sheetName, 455, 18, null),
					new ExpectedCellValue(sheetName, 456, 18, "January"),
					new ExpectedCellValue(sheetName, 457, 18, null),
					new ExpectedCellValue(sheetName, 458, 18, "February"),
					new ExpectedCellValue(sheetName, 459, 18, null),
					new ExpectedCellValue(sheetName, 460, 18, "March"),
					new ExpectedCellValue(sheetName, 461, 18, null),
					new ExpectedCellValue(sheetName, 462, 18, null),
					new ExpectedCellValue(sheetName, 463, 18, "January"),
					new ExpectedCellValue(sheetName, 464, 18, null),
					new ExpectedCellValue(sheetName, 465, 18, "February"),
					new ExpectedCellValue(sheetName, 466, 18, null),
					new ExpectedCellValue(sheetName, 467, 18, null),
					new ExpectedCellValue(sheetName, 468, 18, null),
					new ExpectedCellValue(sheetName, 430, 19, "Item"),
					new ExpectedCellValue(sheetName, 431, 19, null),
					new ExpectedCellValue(sheetName, 432, 19, null),
					new ExpectedCellValue(sheetName, 433, 19, null),
					new ExpectedCellValue(sheetName, 434, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 435, 19, null),
					new ExpectedCellValue(sheetName, 436, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 437, 19, null),
					new ExpectedCellValue(sheetName, 438, 19, null),
					new ExpectedCellValue(sheetName, 439, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 440, 19, null),
					new ExpectedCellValue(sheetName, 441, 19, "Tent"),
					new ExpectedCellValue(sheetName, 442, 19, null),
					new ExpectedCellValue(sheetName, 443, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 444, 19, null),
					new ExpectedCellValue(sheetName, 445, 19, null),
					new ExpectedCellValue(sheetName, 446, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 447, 19, null),
					new ExpectedCellValue(sheetName, 448, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 449, 19, null),
					new ExpectedCellValue(sheetName, 450, 19, null),
					new ExpectedCellValue(sheetName, 451, 19, null),
					new ExpectedCellValue(sheetName, 452, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 453, 19, null),
					new ExpectedCellValue(sheetName, 454, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 455, 19, null),
					new ExpectedCellValue(sheetName, 456, 19, null),
					new ExpectedCellValue(sheetName, 457, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 458, 19, null),
					new ExpectedCellValue(sheetName, 459, 19, "Tent"),
					new ExpectedCellValue(sheetName, 460, 19, null),
					new ExpectedCellValue(sheetName, 461, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 462, 19, null),
					new ExpectedCellValue(sheetName, 463, 19, null),
					new ExpectedCellValue(sheetName, 464, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 465, 19, null),
					new ExpectedCellValue(sheetName, 466, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 467, 19, null),
					new ExpectedCellValue(sheetName, 468, 19, null),
					new ExpectedCellValue(sheetName, 430, 20, null),
					new ExpectedCellValue(sheetName, 431, 20, null),
					new ExpectedCellValue(sheetName, 432, 20, null),
					new ExpectedCellValue(sheetName, 433, 20, null),
					new ExpectedCellValue(sheetName, 434, 20, 415.75),
					new ExpectedCellValue(sheetName, 435, 20, null),
					new ExpectedCellValue(sheetName, 436, 20, 24.99),
					new ExpectedCellValue(sheetName, 437, 20, null),
					new ExpectedCellValue(sheetName, 438, 20, null),
					new ExpectedCellValue(sheetName, 439, 20, 415.75),
					new ExpectedCellValue(sheetName, 440, 20, null),
					new ExpectedCellValue(sheetName, 441, 20, 199d),
					new ExpectedCellValue(sheetName, 442, 20, null),
					new ExpectedCellValue(sheetName, 443, 20, 415.75),
					new ExpectedCellValue(sheetName, 444, 20, null),
					new ExpectedCellValue(sheetName, 445, 20, null),
					new ExpectedCellValue(sheetName, 446, 20, 415.75),
					new ExpectedCellValue(sheetName, 447, 20, null),
					new ExpectedCellValue(sheetName, 448, 20, 99d),
					new ExpectedCellValue(sheetName, 449, 20, null),
					new ExpectedCellValue(sheetName, 450, 20, null),
					new ExpectedCellValue(sheetName, 451, 20, null),
					new ExpectedCellValue(sheetName, 452, 20, 831.5),
					new ExpectedCellValue(sheetName, 453, 20, null),
					new ExpectedCellValue(sheetName, 454, 20, 24.99),
					new ExpectedCellValue(sheetName, 455, 20, null),
					new ExpectedCellValue(sheetName, 456, 20, null),
					new ExpectedCellValue(sheetName, 457, 20, 831.5),
					new ExpectedCellValue(sheetName, 458, 20, null),
					new ExpectedCellValue(sheetName, 459, 20, 1194d),
					new ExpectedCellValue(sheetName, 460, 20, null),
					new ExpectedCellValue(sheetName, 461, 20, 831.5),
					new ExpectedCellValue(sheetName, 462, 20, null),
					new ExpectedCellValue(sheetName, 463, 20, null),
					new ExpectedCellValue(sheetName, 464, 20, 415.75),
					new ExpectedCellValue(sheetName, 465, 20, null),
					new ExpectedCellValue(sheetName, 466, 20, 99d),
					new ExpectedCellValue(sheetName, 467, 20, 1985.99),
					new ExpectedCellValue(sheetName, 468, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondAndThirdFieldsTabularLastFieldFirstFieldLeafDataFieldSubtotalTop()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable24"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Top;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q430:T468"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 17, null),
					new ExpectedCellValue(sheetName, 434, 17, null),
					new ExpectedCellValue(sheetName, 435, 17, null),
					new ExpectedCellValue(sheetName, 436, 17, null),
					new ExpectedCellValue(sheetName, 437, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 438, 17, null),
					new ExpectedCellValue(sheetName, 439, 17, null),
					new ExpectedCellValue(sheetName, 440, 17, null),
					new ExpectedCellValue(sheetName, 441, 17, null),
					new ExpectedCellValue(sheetName, 442, 17, null),
					new ExpectedCellValue(sheetName, 443, 17, null),
					new ExpectedCellValue(sheetName, 444, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 445, 17, null),
					new ExpectedCellValue(sheetName, 446, 17, null),
					new ExpectedCellValue(sheetName, 447, 17, null),
					new ExpectedCellValue(sheetName, 448, 17, null),
					new ExpectedCellValue(sheetName, 449, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 450, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 451, 17, null),
					new ExpectedCellValue(sheetName, 452, 17, null),
					new ExpectedCellValue(sheetName, 453, 17, null),
					new ExpectedCellValue(sheetName, 454, 17, null),
					new ExpectedCellValue(sheetName, 455, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 456, 17, null),
					new ExpectedCellValue(sheetName, 457, 17, null),
					new ExpectedCellValue(sheetName, 458, 17, null),
					new ExpectedCellValue(sheetName, 459, 17, null),
					new ExpectedCellValue(sheetName, 460, 17, null),
					new ExpectedCellValue(sheetName, 461, 17, null),
					new ExpectedCellValue(sheetName, 462, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 463, 17, null),
					new ExpectedCellValue(sheetName, 464, 17, null),
					new ExpectedCellValue(sheetName, 465, 17, null),
					new ExpectedCellValue(sheetName, 466, 17, null),
					new ExpectedCellValue(sheetName, 467, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 468, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 18, "Month"),
					new ExpectedCellValue(sheetName, 431, 18, null),
					new ExpectedCellValue(sheetName, 432, 18, null),
					new ExpectedCellValue(sheetName, 433, 18, "January"),
					new ExpectedCellValue(sheetName, 434, 18, null),
					new ExpectedCellValue(sheetName, 435, 18, "March"),
					new ExpectedCellValue(sheetName, 436, 18, null),
					new ExpectedCellValue(sheetName, 437, 18, null),
					new ExpectedCellValue(sheetName, 438, 18, "January"),
					new ExpectedCellValue(sheetName, 439, 18, null),
					new ExpectedCellValue(sheetName, 440, 18, "February"),
					new ExpectedCellValue(sheetName, 441, 18, null),
					new ExpectedCellValue(sheetName, 442, 18, "March"),
					new ExpectedCellValue(sheetName, 443, 18, null),
					new ExpectedCellValue(sheetName, 444, 18, null),
					new ExpectedCellValue(sheetName, 445, 18, "January"),
					new ExpectedCellValue(sheetName, 446, 18, null),
					new ExpectedCellValue(sheetName, 447, 18, "February"),
					new ExpectedCellValue(sheetName, 448, 18, null),
					new ExpectedCellValue(sheetName, 449, 18, null),
					new ExpectedCellValue(sheetName, 450, 18, null),
					new ExpectedCellValue(sheetName, 451, 18, "January"),
					new ExpectedCellValue(sheetName, 452, 18, null),
					new ExpectedCellValue(sheetName, 453, 18, "March"),
					new ExpectedCellValue(sheetName, 454, 18, null),
					new ExpectedCellValue(sheetName, 455, 18, null),
					new ExpectedCellValue(sheetName, 456, 18, "January"),
					new ExpectedCellValue(sheetName, 457, 18, null),
					new ExpectedCellValue(sheetName, 458, 18, "February"),
					new ExpectedCellValue(sheetName, 459, 18, null),
					new ExpectedCellValue(sheetName, 460, 18, "March"),
					new ExpectedCellValue(sheetName, 461, 18, null),
					new ExpectedCellValue(sheetName, 462, 18, null),
					new ExpectedCellValue(sheetName, 463, 18, "January"),
					new ExpectedCellValue(sheetName, 464, 18, null),
					new ExpectedCellValue(sheetName, 465, 18, "February"),
					new ExpectedCellValue(sheetName, 466, 18, null),
					new ExpectedCellValue(sheetName, 467, 18, null),
					new ExpectedCellValue(sheetName, 468, 18, null),
					new ExpectedCellValue(sheetName, 430, 19, "Item"),
					new ExpectedCellValue(sheetName, 431, 19, null),
					new ExpectedCellValue(sheetName, 432, 19, null),
					new ExpectedCellValue(sheetName, 433, 19, null),
					new ExpectedCellValue(sheetName, 434, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 435, 19, null),
					new ExpectedCellValue(sheetName, 436, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 437, 19, null),
					new ExpectedCellValue(sheetName, 438, 19, null),
					new ExpectedCellValue(sheetName, 439, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 440, 19, null),
					new ExpectedCellValue(sheetName, 441, 19, "Tent"),
					new ExpectedCellValue(sheetName, 442, 19, null),
					new ExpectedCellValue(sheetName, 443, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 444, 19, null),
					new ExpectedCellValue(sheetName, 445, 19, null),
					new ExpectedCellValue(sheetName, 446, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 447, 19, null),
					new ExpectedCellValue(sheetName, 448, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 449, 19, null),
					new ExpectedCellValue(sheetName, 450, 19, null),
					new ExpectedCellValue(sheetName, 451, 19, null),
					new ExpectedCellValue(sheetName, 452, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 453, 19, null),
					new ExpectedCellValue(sheetName, 454, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 455, 19, null),
					new ExpectedCellValue(sheetName, 456, 19, null),
					new ExpectedCellValue(sheetName, 457, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 458, 19, null),
					new ExpectedCellValue(sheetName, 459, 19, "Tent"),
					new ExpectedCellValue(sheetName, 460, 19, null),
					new ExpectedCellValue(sheetName, 461, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 462, 19, null),
					new ExpectedCellValue(sheetName, 463, 19, null),
					new ExpectedCellValue(sheetName, 464, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 465, 19, null),
					new ExpectedCellValue(sheetName, 466, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 467, 19, null),
					new ExpectedCellValue(sheetName, 468, 19, null),
					new ExpectedCellValue(sheetName, 430, 20, null),
					new ExpectedCellValue(sheetName, 431, 20, null),
					new ExpectedCellValue(sheetName, 432, 20, 440.74),
					new ExpectedCellValue(sheetName, 433, 20, 415.75),
					new ExpectedCellValue(sheetName, 434, 20, 415.75),
					new ExpectedCellValue(sheetName, 435, 20, 24.99),
					new ExpectedCellValue(sheetName, 436, 20, 24.99),
					new ExpectedCellValue(sheetName, 437, 20, 1030.5),
					new ExpectedCellValue(sheetName, 438, 20, 415.75),
					new ExpectedCellValue(sheetName, 439, 20, 415.75),
					new ExpectedCellValue(sheetName, 440, 20, 199d),
					new ExpectedCellValue(sheetName, 441, 20, 199d),
					new ExpectedCellValue(sheetName, 442, 20, 415.75),
					new ExpectedCellValue(sheetName, 443, 20, 415.75),
					new ExpectedCellValue(sheetName, 444, 20, 514.75),
					new ExpectedCellValue(sheetName, 445, 20, 415.75),
					new ExpectedCellValue(sheetName, 446, 20, 415.75),
					new ExpectedCellValue(sheetName, 447, 20, 99d),
					new ExpectedCellValue(sheetName, 448, 20, 99d),
					new ExpectedCellValue(sheetName, 449, 20, null),
					new ExpectedCellValue(sheetName, 450, 20, 856.49),
					new ExpectedCellValue(sheetName, 451, 20, 831.5),
					new ExpectedCellValue(sheetName, 452, 20, 831.5),
					new ExpectedCellValue(sheetName, 453, 20, 24.99),
					new ExpectedCellValue(sheetName, 454, 20, 24.99),
					new ExpectedCellValue(sheetName, 455, 20, 2857d),
					new ExpectedCellValue(sheetName, 456, 20, 831.5),
					new ExpectedCellValue(sheetName, 457, 20, 831.5),
					new ExpectedCellValue(sheetName, 458, 20, 1194d),
					new ExpectedCellValue(sheetName, 459, 20, 1194d),
					new ExpectedCellValue(sheetName, 460, 20, 831.5),
					new ExpectedCellValue(sheetName, 461, 20, 831.5),
					new ExpectedCellValue(sheetName, 462, 20, 514.75),
					new ExpectedCellValue(sheetName, 463, 20, 415.75),
					new ExpectedCellValue(sheetName, 464, 20, 415.75),
					new ExpectedCellValue(sheetName, 465, 20, 99d),
					new ExpectedCellValue(sheetName, 466, 20, 99d),
					new ExpectedCellValue(sheetName, 467, 20, 1985.99),
					new ExpectedCellValue(sheetName, 468, 20, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCompactAndTabularFormMultipleDataFields.xlsx")]
		public void PivotTableCompactAndTabularFormThreeRowFieldsMultipleDataFieldsNonCompactSecondAndThirdFieldsTabularLastFieldFirstFieldLeafDataFieldSubtotalBottom()
		{
			var file = new FileInfo("PivotTableCompactAndTabularFormMultipleDataFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "ThreeRowFields";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable24"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubTotalFunctions = eSubTotalFunctions.Default;
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q430:T488"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 430, 17, "Row Labels"),
					new ExpectedCellValue(sheetName, 431, 17, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 432, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 433, 17, null),
					new ExpectedCellValue(sheetName, 434, 17, null),
					new ExpectedCellValue(sheetName, 435, 17, null),
					new ExpectedCellValue(sheetName, 436, 17, null),
					new ExpectedCellValue(sheetName, 437, 17, null),
					new ExpectedCellValue(sheetName, 438, 17, null),
					new ExpectedCellValue(sheetName, 439, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 440, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 441, 17, null),
					new ExpectedCellValue(sheetName, 442, 17, null),
					new ExpectedCellValue(sheetName, 443, 17, null),
					new ExpectedCellValue(sheetName, 444, 17, null),
					new ExpectedCellValue(sheetName, 445, 17, null),
					new ExpectedCellValue(sheetName, 446, 17, null),
					new ExpectedCellValue(sheetName, 447, 17, null),
					new ExpectedCellValue(sheetName, 448, 17, null),
					new ExpectedCellValue(sheetName, 449, 17, null),
					new ExpectedCellValue(sheetName, 450, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 451, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 452, 17, null),
					new ExpectedCellValue(sheetName, 453, 17, null),
					new ExpectedCellValue(sheetName, 454, 17, null),
					new ExpectedCellValue(sheetName, 455, 17, null),
					new ExpectedCellValue(sheetName, 456, 17, null),
					new ExpectedCellValue(sheetName, 457, 17, null),
					new ExpectedCellValue(sheetName, 458, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 459, 17, "Sum of Total"),
					new ExpectedCellValue(sheetName, 460, 17, "Chicago"),
					new ExpectedCellValue(sheetName, 461, 17, null),
					new ExpectedCellValue(sheetName, 462, 17, null),
					new ExpectedCellValue(sheetName, 463, 17, null),
					new ExpectedCellValue(sheetName, 464, 17, null),
					new ExpectedCellValue(sheetName, 465, 17, null),
					new ExpectedCellValue(sheetName, 466, 17, null),
					new ExpectedCellValue(sheetName, 467, 17, "Chicago Total"),
					new ExpectedCellValue(sheetName, 468, 17, "Nashville"),
					new ExpectedCellValue(sheetName, 469, 17, null),
					new ExpectedCellValue(sheetName, 470, 17, null),
					new ExpectedCellValue(sheetName, 471, 17, null),
					new ExpectedCellValue(sheetName, 472, 17, null),
					new ExpectedCellValue(sheetName, 473, 17, null),
					new ExpectedCellValue(sheetName, 474, 17, null),
					new ExpectedCellValue(sheetName, 475, 17, null),
					new ExpectedCellValue(sheetName, 476, 17, null),
					new ExpectedCellValue(sheetName, 477, 17, null),
					new ExpectedCellValue(sheetName, 478, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 479, 17, "San Francisco"),
					new ExpectedCellValue(sheetName, 480, 17, null),
					new ExpectedCellValue(sheetName, 481, 17, null),
					new ExpectedCellValue(sheetName, 482, 17, null),
					new ExpectedCellValue(sheetName, 483, 17, null),
					new ExpectedCellValue(sheetName, 484, 17, null),
					new ExpectedCellValue(sheetName, 485, 17, null),
					new ExpectedCellValue(sheetName, 486, 17, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 487, 17, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 488, 17, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 430, 18, "Month"),
					new ExpectedCellValue(sheetName, 431, 18, null),
					new ExpectedCellValue(sheetName, 432, 18, null),
					new ExpectedCellValue(sheetName, 433, 18, "January"),
					new ExpectedCellValue(sheetName, 434, 18, null),
					new ExpectedCellValue(sheetName, 435, 18, "January Total"),
					new ExpectedCellValue(sheetName, 436, 18, "March"),
					new ExpectedCellValue(sheetName, 437, 18, null),
					new ExpectedCellValue(sheetName, 438, 18, "March Total"),
					new ExpectedCellValue(sheetName, 439, 18, null),
					new ExpectedCellValue(sheetName, 440, 18, null),
					new ExpectedCellValue(sheetName, 441, 18, "January"),
					new ExpectedCellValue(sheetName, 442, 18, null),
					new ExpectedCellValue(sheetName, 443, 18, "January Total"),
					new ExpectedCellValue(sheetName, 444, 18, "February"),
					new ExpectedCellValue(sheetName, 445, 18, null),
					new ExpectedCellValue(sheetName, 446, 18, "February Total"),
					new ExpectedCellValue(sheetName, 447, 18, "March"),
					new ExpectedCellValue(sheetName, 448, 18, null),
					new ExpectedCellValue(sheetName, 449, 18, "March Total"),
					new ExpectedCellValue(sheetName, 450, 18, null),
					new ExpectedCellValue(sheetName, 451, 18, null),
					new ExpectedCellValue(sheetName, 452, 18, "January"),
					new ExpectedCellValue(sheetName, 453, 18, null),
					new ExpectedCellValue(sheetName, 454, 18, "January Total"),
					new ExpectedCellValue(sheetName, 455, 18, "February"),
					new ExpectedCellValue(sheetName, 456, 18, null),
					new ExpectedCellValue(sheetName, 457, 18, "February Total"),
					new ExpectedCellValue(sheetName, 458, 18, null),
					new ExpectedCellValue(sheetName, 459, 18, null),
					new ExpectedCellValue(sheetName, 460, 18, null),
					new ExpectedCellValue(sheetName, 461, 18, "January"),
					new ExpectedCellValue(sheetName, 462, 18, null),
					new ExpectedCellValue(sheetName, 463, 18, "January Total"),
					new ExpectedCellValue(sheetName, 464, 18, "March"),
					new ExpectedCellValue(sheetName, 465, 18, null),
					new ExpectedCellValue(sheetName, 466, 18, "March Total"),
					new ExpectedCellValue(sheetName, 467, 18, null),
					new ExpectedCellValue(sheetName, 468, 18, null),
					new ExpectedCellValue(sheetName, 469, 18, "January"),
					new ExpectedCellValue(sheetName, 470, 18, null),
					new ExpectedCellValue(sheetName, 471, 18, "January Total"),
					new ExpectedCellValue(sheetName, 472, 18, "February"),
					new ExpectedCellValue(sheetName, 473, 18, null),
					new ExpectedCellValue(sheetName, 474, 18, "February Total"),
					new ExpectedCellValue(sheetName, 475, 18, "March"),
					new ExpectedCellValue(sheetName, 476, 18, null),
					new ExpectedCellValue(sheetName, 477, 18, "March Total"),
					new ExpectedCellValue(sheetName, 478, 18, null),
					new ExpectedCellValue(sheetName, 479, 18, null),
					new ExpectedCellValue(sheetName, 480, 18, "January"),
					new ExpectedCellValue(sheetName, 481, 18, null),
					new ExpectedCellValue(sheetName, 482, 18, "January Total"),
					new ExpectedCellValue(sheetName, 483, 18, "February"),
					new ExpectedCellValue(sheetName, 484, 18, null),
					new ExpectedCellValue(sheetName, 485, 18, "February Total"),
					new ExpectedCellValue(sheetName, 486, 18, null),
					new ExpectedCellValue(sheetName, 487, 18, null),
					new ExpectedCellValue(sheetName, 488, 18, null),
					new ExpectedCellValue(sheetName, 430, 19, "Item"),
					new ExpectedCellValue(sheetName, 431, 19, null),
					new ExpectedCellValue(sheetName, 432, 19, null),
					new ExpectedCellValue(sheetName, 433, 19, null),
					new ExpectedCellValue(sheetName, 434, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 435, 19, null),
					new ExpectedCellValue(sheetName, 436, 19, null),
					new ExpectedCellValue(sheetName, 437, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 438, 19, null),
					new ExpectedCellValue(sheetName, 439, 19, null),
					new ExpectedCellValue(sheetName, 440, 19, null),
					new ExpectedCellValue(sheetName, 441, 19, null),
					new ExpectedCellValue(sheetName, 442, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 443, 19, null),
					new ExpectedCellValue(sheetName, 444, 19, null),
					new ExpectedCellValue(sheetName, 445, 19, "Tent"),
					new ExpectedCellValue(sheetName, 446, 19, null),
					new ExpectedCellValue(sheetName, 447, 19, null),
					new ExpectedCellValue(sheetName, 448, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 449, 19, null),
					new ExpectedCellValue(sheetName, 450, 19, null),
					new ExpectedCellValue(sheetName, 451, 19, null),
					new ExpectedCellValue(sheetName, 452, 19, null),
					new ExpectedCellValue(sheetName, 453, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 454, 19, null),
					new ExpectedCellValue(sheetName, 455, 19, null),
					new ExpectedCellValue(sheetName, 456, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 457, 19, null),
					new ExpectedCellValue(sheetName, 458, 19, null),
					new ExpectedCellValue(sheetName, 459, 19, null),
					new ExpectedCellValue(sheetName, 460, 19, null),
					new ExpectedCellValue(sheetName, 461, 19, null),
					new ExpectedCellValue(sheetName, 462, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 463, 19, null),
					new ExpectedCellValue(sheetName, 464, 19, null),
					new ExpectedCellValue(sheetName, 465, 19, "Headlamp"),
					new ExpectedCellValue(sheetName, 466, 19, null),
					new ExpectedCellValue(sheetName, 467, 19, null),
					new ExpectedCellValue(sheetName, 468, 19, null),
					new ExpectedCellValue(sheetName, 469, 19, null),
					new ExpectedCellValue(sheetName, 470, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 471, 19, null),
					new ExpectedCellValue(sheetName, 472, 19, null),
					new ExpectedCellValue(sheetName, 473, 19, "Tent"),
					new ExpectedCellValue(sheetName, 474, 19, null),
					new ExpectedCellValue(sheetName, 475, 19, null),
					new ExpectedCellValue(sheetName, 476, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 477, 19, null),
					new ExpectedCellValue(sheetName, 478, 19, null),
					new ExpectedCellValue(sheetName, 479, 19, null),
					new ExpectedCellValue(sheetName, 480, 19, null),
					new ExpectedCellValue(sheetName, 481, 19, "Car Rack"),
					new ExpectedCellValue(sheetName, 482, 19, null),
					new ExpectedCellValue(sheetName, 483, 19, null),
					new ExpectedCellValue(sheetName, 484, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 485, 19, null),
					new ExpectedCellValue(sheetName, 486, 19, null),
					new ExpectedCellValue(sheetName, 487, 19, null),
					new ExpectedCellValue(sheetName, 488, 19, null),
					new ExpectedCellValue(sheetName, 430, 20, null),
					new ExpectedCellValue(sheetName, 431, 20, null),
					new ExpectedCellValue(sheetName, 432, 20, null),
					new ExpectedCellValue(sheetName, 433, 20, null),
					new ExpectedCellValue(sheetName, 434, 20, 415.75),
					new ExpectedCellValue(sheetName, 435, 20, 415.75),
					new ExpectedCellValue(sheetName, 436, 20, null),
					new ExpectedCellValue(sheetName, 437, 20, 24.99),
					new ExpectedCellValue(sheetName, 438, 20, 24.99),
					new ExpectedCellValue(sheetName, 439, 20, 440.74),
					new ExpectedCellValue(sheetName, 440, 20, null),
					new ExpectedCellValue(sheetName, 441, 20, null),
					new ExpectedCellValue(sheetName, 442, 20, 415.75),
					new ExpectedCellValue(sheetName, 443, 20, 415.75),
					new ExpectedCellValue(sheetName, 444, 20, null),
					new ExpectedCellValue(sheetName, 445, 20, 199d),
					new ExpectedCellValue(sheetName, 446, 20, 199d),
					new ExpectedCellValue(sheetName, 447, 20, null),
					new ExpectedCellValue(sheetName, 448, 20, 415.75),
					new ExpectedCellValue(sheetName, 449, 20, 415.75),
					new ExpectedCellValue(sheetName, 450, 20, 1030.5),
					new ExpectedCellValue(sheetName, 451, 20, null),
					new ExpectedCellValue(sheetName, 452, 20, null),
					new ExpectedCellValue(sheetName, 453, 20, 415.75),
					new ExpectedCellValue(sheetName, 454, 20, 415.75),
					new ExpectedCellValue(sheetName, 455, 20, null),
					new ExpectedCellValue(sheetName, 456, 20, 99d),
					new ExpectedCellValue(sheetName, 457, 20, 99d),
					new ExpectedCellValue(sheetName, 458, 20, 514.75),
					new ExpectedCellValue(sheetName, 459, 20, null),
					new ExpectedCellValue(sheetName, 460, 20, null),
					new ExpectedCellValue(sheetName, 461, 20, null),
					new ExpectedCellValue(sheetName, 462, 20, 831.5),
					new ExpectedCellValue(sheetName, 463, 20, 831.5),
					new ExpectedCellValue(sheetName, 464, 20, null),
					new ExpectedCellValue(sheetName, 465, 20, 24.99),
					new ExpectedCellValue(sheetName, 466, 20, 24.99),
					new ExpectedCellValue(sheetName, 467, 20, 856.49),
					new ExpectedCellValue(sheetName, 468, 20, null),
					new ExpectedCellValue(sheetName, 469, 20, null),
					new ExpectedCellValue(sheetName, 470, 20, 831.5),
					new ExpectedCellValue(sheetName, 471, 20, 831.5),
					new ExpectedCellValue(sheetName, 472, 20, null),
					new ExpectedCellValue(sheetName, 473, 20, 1194d),
					new ExpectedCellValue(sheetName, 474, 20, 1194d),
					new ExpectedCellValue(sheetName, 475, 20, null),
					new ExpectedCellValue(sheetName, 476, 20, 831.5),
					new ExpectedCellValue(sheetName, 477, 20, 831.5),
					new ExpectedCellValue(sheetName, 478, 20, 2857d),
					new ExpectedCellValue(sheetName, 479, 20, null),
					new ExpectedCellValue(sheetName, 480, 20, null),
					new ExpectedCellValue(sheetName, 481, 20, 415.75),
					new ExpectedCellValue(sheetName, 482, 20, 415.75),
					new ExpectedCellValue(sheetName, 483, 20, null),
					new ExpectedCellValue(sheetName, 484, 20, 99d),
					new ExpectedCellValue(sheetName, 485, 20, 99d),
					new ExpectedCellValue(sheetName, 486, 20, 514.75),
					new ExpectedCellValue(sheetName, 487, 20, 1985.99),
					new ExpectedCellValue(sheetName, 488, 20, 4228.24)
				});
			}
		}
		#endregion
		#endregion
		#endregion
		#endregion

		#region Sorting Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingRowFieldsWithNoReferencesToDataFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithoutReferences"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:C12"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithoutReferences";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 3, 1, 20100085),
					new ExpectedCellValue(sheetName, 4, 1, 20100076),
					new ExpectedCellValue(sheetName, 5, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 1, 20100090),
					new ExpectedCellValue(sheetName, 7, 1, 20100070),
					new ExpectedCellValue(sheetName, 8, 1, 20100017),
					new ExpectedCellValue(sheetName, 9, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 10, 1, 20100083),
					new ExpectedCellValue(sheetName, 11, 1, 20100007),
					new ExpectedCellValue(sheetName, 12, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 2, 2, 514.75),
					new ExpectedCellValue(sheetName, 3, 2, 99d),
					new ExpectedCellValue(sheetName, 4, 2, 415.75),
					new ExpectedCellValue(sheetName, 5, 2, 1030.5),
					new ExpectedCellValue(sheetName, 6, 2, 415.75),
					new ExpectedCellValue(sheetName, 7, 2, 199d),
					new ExpectedCellValue(sheetName, 8, 2, 415.75),
					new ExpectedCellValue(sheetName, 9, 2, 440.74),
					new ExpectedCellValue(sheetName, 10, 2, 24.99),
					new ExpectedCellValue(sheetName, 11, 2, 415.75),
					new ExpectedCellValue(sheetName, 12, 2, 1985.99),
					new ExpectedCellValue(sheetName, 1, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 3, 2d),
					new ExpectedCellValue(sheetName, 3, 3, 1d),
					new ExpectedCellValue(sheetName, 4, 3, 1d),
					new ExpectedCellValue(sheetName, 5, 3, 10d),
					new ExpectedCellValue(sheetName, 6, 3, 2d),
					new ExpectedCellValue(sheetName, 7, 3, 6d),
					new ExpectedCellValue(sheetName, 8, 3, 2d),
					new ExpectedCellValue(sheetName, 9, 3, 3d),
					new ExpectedCellValue(sheetName, 10, 3, 1d),
					new ExpectedCellValue(sheetName, 11, 3, 2d),
					new ExpectedCellValue(sheetName, 12, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingColumnFieldsWithNoReferencesToDataFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithoutReferences"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A16:W23"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithoutReferences";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 20, 1, "January"),
					new ExpectedCellValue(sheetName, 21, 1, "February"),
					new ExpectedCellValue(sheetName, 22, 1, "March"),
					new ExpectedCellValue(sheetName, 23, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 17, 2, "San Francisco"),
					new ExpectedCellValue(sheetName, 18, 2, 20100085),
					new ExpectedCellValue(sheetName, 19, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 21, 2, 99d),
					new ExpectedCellValue(sheetName, 23, 2, 99d),
					new ExpectedCellValue(sheetName, 19, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 3, 1d),
					new ExpectedCellValue(sheetName, 23, 3, 1d),
					new ExpectedCellValue(sheetName, 18, 4, 20100076),
					new ExpectedCellValue(sheetName, 19, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 4, 415.75),
					new ExpectedCellValue(sheetName, 23, 4, 415.75),
					new ExpectedCellValue(sheetName, 19, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 5, 1d),
					new ExpectedCellValue(sheetName, 23, 5, 1d),
					new ExpectedCellValue(sheetName, 17, 6, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 6, 415.75),
					new ExpectedCellValue(sheetName, 21, 6, 99d),
					new ExpectedCellValue(sheetName, 23, 6, 514.75),
					new ExpectedCellValue(sheetName, 17, 7, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 7, 1d),
					new ExpectedCellValue(sheetName, 21, 7, 1d),
					new ExpectedCellValue(sheetName, 23, 7, 2d),
					new ExpectedCellValue(sheetName, 17, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 18, 8, 20100090),
					new ExpectedCellValue(sheetName, 19, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 8, 415.75),
					new ExpectedCellValue(sheetName, 23, 8, 415.75),
					new ExpectedCellValue(sheetName, 19, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 9, 2d),
					new ExpectedCellValue(sheetName, 23, 9, 2d),
					new ExpectedCellValue(sheetName, 18, 10, 20100070),
					new ExpectedCellValue(sheetName, 19, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 21, 10, 199d),
					new ExpectedCellValue(sheetName, 23, 10, 199d),
					new ExpectedCellValue(sheetName, 19, 11, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 11, 6d),
					new ExpectedCellValue(sheetName, 23, 11, 6d),
					new ExpectedCellValue(sheetName, 18, 12, 20100017),
					new ExpectedCellValue(sheetName, 19, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 12, 415.75),
					new ExpectedCellValue(sheetName, 23, 12, 415.75),
					new ExpectedCellValue(sheetName, 19, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 13, 2d),
					new ExpectedCellValue(sheetName, 23, 13, 2d),
					new ExpectedCellValue(sheetName, 17, 14, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 14, 415.75),
					new ExpectedCellValue(sheetName, 21, 14, 199d),
					new ExpectedCellValue(sheetName, 22, 14, 415.75),
					new ExpectedCellValue(sheetName, 23, 14, 1030.5),
					new ExpectedCellValue(sheetName, 17, 15, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 15, 2d),
					new ExpectedCellValue(sheetName, 21, 15, 6d),
					new ExpectedCellValue(sheetName, 22, 15, 2d),
					new ExpectedCellValue(sheetName, 23, 15, 10d),
					new ExpectedCellValue(sheetName, 17, 16, "Chicago"),
					new ExpectedCellValue(sheetName, 18, 16, 20100083),
					new ExpectedCellValue(sheetName, 19, 16, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 16, 24.99),
					new ExpectedCellValue(sheetName, 23, 16, 24.99),
					new ExpectedCellValue(sheetName, 19, 17, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 17, 1d),
					new ExpectedCellValue(sheetName, 23, 17, 1d),
					new ExpectedCellValue(sheetName, 18, 18, 20100007),
					new ExpectedCellValue(sheetName, 19, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 18, 415.75),
					new ExpectedCellValue(sheetName, 23, 18, 415.75),
					new ExpectedCellValue(sheetName, 19, 19, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 19, 2d),
					new ExpectedCellValue(sheetName, 23, 19, 2d),
					new ExpectedCellValue(sheetName, 17, 20, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 20, 415.75),
					new ExpectedCellValue(sheetName, 22, 20, 24.99),
					new ExpectedCellValue(sheetName, 23, 20, 440.74),
					new ExpectedCellValue(sheetName, 17, 21, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 21, 2d),
					new ExpectedCellValue(sheetName, 22, 21, 1d),
					new ExpectedCellValue(sheetName, 23, 21, 3d),
					new ExpectedCellValue(sheetName, 17, 22, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 20, 22, 1247.25),
					new ExpectedCellValue(sheetName, 21, 22, 298d),
					new ExpectedCellValue(sheetName, 22, 22, 440.74),
					new ExpectedCellValue(sheetName, 23, 22, 1985.99),
					new ExpectedCellValue(sheetName, 17, 23, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 23, 5d),
					new ExpectedCellValue(sheetName, 21, 23, 7d),
					new ExpectedCellValue(sheetName, 22, 23, 3d),
					new ExpectedCellValue(sheetName, 23, 23, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingRowFieldsAndColumnFieldsWithNoReferencesToDataFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithoutReferences"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A27:I40"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithoutReferences";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 30, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 31, 1, 20100085),
					new ExpectedCellValue(sheetName, 32, 1, 20100076),
					new ExpectedCellValue(sheetName, 33, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 34, 1, 20100090),
					new ExpectedCellValue(sheetName, 35, 1, 20100070),
					new ExpectedCellValue(sheetName, 36, 1, 20100017),
					new ExpectedCellValue(sheetName, 37, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 38, 1, 20100083),
					new ExpectedCellValue(sheetName, 39, 1, 20100007),
					new ExpectedCellValue(sheetName, 40, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 28, 2, "March"),
					new ExpectedCellValue(sheetName, 29, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 2, 2d),
					new ExpectedCellValue(sheetName, 36, 2, 2d),
					new ExpectedCellValue(sheetName, 37, 2, 1d),
					new ExpectedCellValue(sheetName, 38, 2, 1d),
					new ExpectedCellValue(sheetName, 40, 2, 3d),
					new ExpectedCellValue(sheetName, 29, 3, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 3, 415.75),
					new ExpectedCellValue(sheetName, 36, 3, 415.75),
					new ExpectedCellValue(sheetName, 37, 3, 24.99),
					new ExpectedCellValue(sheetName, 38, 3, 24.99),
					new ExpectedCellValue(sheetName, 40, 3, 440.74),
					new ExpectedCellValue(sheetName, 28, 4, "February"),
					new ExpectedCellValue(sheetName, 29, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 4, 1d),
					new ExpectedCellValue(sheetName, 31, 4, 1d),
					new ExpectedCellValue(sheetName, 33, 4, 6d),
					new ExpectedCellValue(sheetName, 35, 4, 6d),
					new ExpectedCellValue(sheetName, 40, 4, 7d),
					new ExpectedCellValue(sheetName, 29, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 5, 99d),
					new ExpectedCellValue(sheetName, 31, 5, 99d),
					new ExpectedCellValue(sheetName, 33, 5, 199d),
					new ExpectedCellValue(sheetName, 35, 5, 199d),
					new ExpectedCellValue(sheetName, 40, 5, 298d),
					new ExpectedCellValue(sheetName, 28, 6, "January"),
					new ExpectedCellValue(sheetName, 29, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 6, 1d),
					new ExpectedCellValue(sheetName, 32, 6, 1d),
					new ExpectedCellValue(sheetName, 33, 6, 2d),
					new ExpectedCellValue(sheetName, 34, 6, 2d),
					new ExpectedCellValue(sheetName, 37, 6, 2d),
					new ExpectedCellValue(sheetName, 39, 6, 2d),
					new ExpectedCellValue(sheetName, 40, 6, 5d),
					new ExpectedCellValue(sheetName, 29, 7, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 7, 415.75),
					new ExpectedCellValue(sheetName, 32, 7, 415.75),
					new ExpectedCellValue(sheetName, 33, 7, 415.75),
					new ExpectedCellValue(sheetName, 34, 7, 415.75),
					new ExpectedCellValue(sheetName, 37, 7, 415.75),
					new ExpectedCellValue(sheetName, 39, 7, 415.75),
					new ExpectedCellValue(sheetName, 40, 7, 1247.25),
					new ExpectedCellValue(sheetName, 28, 8, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 8, 2d),
					new ExpectedCellValue(sheetName, 31, 8, 1d),
					new ExpectedCellValue(sheetName, 32, 8, 1d),
					new ExpectedCellValue(sheetName, 33, 8, 10d),
					new ExpectedCellValue(sheetName, 34, 8, 2d),
					new ExpectedCellValue(sheetName, 35, 8, 6d),
					new ExpectedCellValue(sheetName, 36, 8, 2d),
					new ExpectedCellValue(sheetName, 37, 8, 3d),
					new ExpectedCellValue(sheetName, 38, 8, 1d),
					new ExpectedCellValue(sheetName, 39, 8, 2d),
					new ExpectedCellValue(sheetName, 40, 8, 15d),
					new ExpectedCellValue(sheetName, 28, 9, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 30, 9, 514.75),
					new ExpectedCellValue(sheetName, 31, 9, 99d),
					new ExpectedCellValue(sheetName, 32, 9, 415.75),
					new ExpectedCellValue(sheetName, 33, 9, 1030.5),
					new ExpectedCellValue(sheetName, 34, 9, 415.75),
					new ExpectedCellValue(sheetName, 35, 9, 199d),
					new ExpectedCellValue(sheetName, 36, 9, 415.75),
					new ExpectedCellValue(sheetName, 37, 9, 440.74),
					new ExpectedCellValue(sheetName, 38, 9, 24.99),
					new ExpectedCellValue(sheetName, 39, 9, 415.75),
					new ExpectedCellValue(sheetName, 40, 9, 1985.99)

				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsOneRowFieldAndNoColumnFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithReferencesRowFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:C5"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithReferencesRowFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 3, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 2, 2, 1030.5),
					new ExpectedCellValue(sheetName, 3, 2, 514.75),
					new ExpectedCellValue(sheetName, 4, 2, 440.74),
					new ExpectedCellValue(sheetName, 5, 2, 1985.99),
					new ExpectedCellValue(sheetName, 1, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 2, 3, 10d),
					new ExpectedCellValue(sheetName, 3, 3, 2d),
					new ExpectedCellValue(sheetName, 4, 3, 3d),
					new ExpectedCellValue(sheetName, 5, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsTwoRowFieldsAndNoColumnFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithReferencesRowFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A9:C19"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithReferencesRowFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 10, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 1, "Tent"),
					new ExpectedCellValue(sheetName, 13, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 14, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 15, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 16, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 17, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 18, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 9, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 10, 2, 1030.5),
					new ExpectedCellValue(sheetName, 11, 2, 831.5),
					new ExpectedCellValue(sheetName, 12, 2, 199d),
					new ExpectedCellValue(sheetName, 13, 2, 514.75),
					new ExpectedCellValue(sheetName, 14, 2, 415.75),
					new ExpectedCellValue(sheetName, 15, 2, 99d),
					new ExpectedCellValue(sheetName, 16, 2, 440.74),
					new ExpectedCellValue(sheetName, 17, 2, 24.99),
					new ExpectedCellValue(sheetName, 18, 2, 415.75),
					new ExpectedCellValue(sheetName, 19, 2, 1985.99),
					new ExpectedCellValue(sheetName, 9, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 3, 10d),
					new ExpectedCellValue(sheetName, 11, 3, 4d),
					new ExpectedCellValue(sheetName, 12, 3, 6d),
					new ExpectedCellValue(sheetName, 13, 3, 2d),
					new ExpectedCellValue(sheetName, 14, 3, 1d),
					new ExpectedCellValue(sheetName, 15, 3, 1d),
					new ExpectedCellValue(sheetName, 16, 3, 3d),
					new ExpectedCellValue(sheetName, 17, 3, 1d),
					new ExpectedCellValue(sheetName, 18, 3, 2d),
					new ExpectedCellValue(sheetName, 19, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsTwoRowFieldsAndNoColumnFieldsCorrectSortWithSameValuesDescending()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithReferencesRowFields"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A23:C34"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithReferencesRowFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 24, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 25, 1, "February"),
					new ExpectedCellValue(sheetName, 26, 1, "March"),
					new ExpectedCellValue(sheetName, 27, 1, "January"),
					new ExpectedCellValue(sheetName, 28, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 29, 1, "February"),
					new ExpectedCellValue(sheetName, 30, 1, "January"),
					new ExpectedCellValue(sheetName, 31, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 32, 1, "January"),
					new ExpectedCellValue(sheetName, 33, 1, "March"),
					new ExpectedCellValue(sheetName, 34, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 23, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 2, 1030.5),
					new ExpectedCellValue(sheetName, 25, 2, 199d),
					new ExpectedCellValue(sheetName, 26, 2, 415.75),
					new ExpectedCellValue(sheetName, 27, 2, 415.75),
					new ExpectedCellValue(sheetName, 28, 2, 514.75),
					new ExpectedCellValue(sheetName, 29, 2, 99d),
					new ExpectedCellValue(sheetName, 30, 2, 415.75),
					new ExpectedCellValue(sheetName, 31, 2, 440.74),
					new ExpectedCellValue(sheetName, 32, 2, 415.75),
					new ExpectedCellValue(sheetName, 33, 2, 24.99),
					new ExpectedCellValue(sheetName, 34, 2, 1985.99),
					new ExpectedCellValue(sheetName, 23, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 3, 10d),
					new ExpectedCellValue(sheetName, 25, 3, 6d),
					new ExpectedCellValue(sheetName, 26, 3, 2d),
					new ExpectedCellValue(sheetName, 27, 3, 2d),
					new ExpectedCellValue(sheetName, 28, 3, 2d),
					new ExpectedCellValue(sheetName, 29, 3, 1d),
					new ExpectedCellValue(sheetName, 30, 3, 1d),
					new ExpectedCellValue(sheetName, 31, 3, 3d),
					new ExpectedCellValue(sheetName, 32, 3, 2d),
					new ExpectedCellValue(sheetName, 33, 3, 1d),
					new ExpectedCellValue(sheetName, 34, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsTwoRowFieldsAndNoColumnFieldsCorrectSortWithSameValuesAscending()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["SortingWithReferencesRowFields"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A38:C49"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "SortingWithReferencesRowFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 39, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 40, 1, "February"),
					new ExpectedCellValue(sheetName, 41, 1, "January"),
					new ExpectedCellValue(sheetName, 42, 1, "March"),
					new ExpectedCellValue(sheetName, 43, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 44, 1, "February"),
					new ExpectedCellValue(sheetName, 45, 1, "January"),
					new ExpectedCellValue(sheetName, 46, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 47, 1, "March"),
					new ExpectedCellValue(sheetName, 48, 1, "January"),
					new ExpectedCellValue(sheetName, 49, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 38, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 39, 2, 1030.5),
					new ExpectedCellValue(sheetName, 40, 2, 199d),
					new ExpectedCellValue(sheetName, 41, 2, 415.75),
					new ExpectedCellValue(sheetName, 42, 2, 415.75),
					new ExpectedCellValue(sheetName, 43, 2, 514.75),
					new ExpectedCellValue(sheetName, 44, 2, 99d),
					new ExpectedCellValue(sheetName, 45, 2, 415.75),
					new ExpectedCellValue(sheetName, 46, 2, 440.74),
					new ExpectedCellValue(sheetName, 47, 2, 24.99),
					new ExpectedCellValue(sheetName, 48, 2, 415.75),
					new ExpectedCellValue(sheetName, 49, 2, 1985.99),
					new ExpectedCellValue(sheetName, 38, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 39, 3, 10d),
					new ExpectedCellValue(sheetName, 40, 3, 6d),
					new ExpectedCellValue(sheetName, 41, 3, 2d),
					new ExpectedCellValue(sheetName, 42, 3, 2d),
					new ExpectedCellValue(sheetName, 43, 3, 2d),
					new ExpectedCellValue(sheetName, 44, 3, 1d),
					new ExpectedCellValue(sheetName, 45, 3, 1d),
					new ExpectedCellValue(sheetName, 46, 3, 3d),
					new ExpectedCellValue(sheetName, 47, 3, 1d),
					new ExpectedCellValue(sheetName, 48, 3, 2d),
					new ExpectedCellValue(sheetName, 49, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsTwoRowFieldsAndOneColumnFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnFieldsSorting"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:K14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnFieldsSorting";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 4, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 1, "February"),
					new ExpectedCellValue(sheetName, 6, 1, "January"),
					new ExpectedCellValue(sheetName, 7, 1, "March"),
					new ExpectedCellValue(sheetName, 8, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 9, 1, "February"),
					new ExpectedCellValue(sheetName, 10, 1, "January"),
					new ExpectedCellValue(sheetName, 11, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 1, "March"),
					new ExpectedCellValue(sheetName, 13, 1, "January"),
					new ExpectedCellValue(sheetName, 14, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 3, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 6, 2, 415.75),
					new ExpectedCellValue(sheetName, 7, 2, 415.75),
					new ExpectedCellValue(sheetName, 8, 2, 415.75),
					new ExpectedCellValue(sheetName, 10, 2, 415.75),
					new ExpectedCellValue(sheetName, 11, 2, 415.75),
					new ExpectedCellValue(sheetName, 13, 2, 415.75),
					new ExpectedCellValue(sheetName, 14, 2, 1663d),
					new ExpectedCellValue(sheetName, 3, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 3, 4d),
					new ExpectedCellValue(sheetName, 6, 3, 2d),
					new ExpectedCellValue(sheetName, 7, 3, 2d),
					new ExpectedCellValue(sheetName, 8, 3, 1d),
					new ExpectedCellValue(sheetName, 10, 3, 1d),
					new ExpectedCellValue(sheetName, 11, 3, 2d),
					new ExpectedCellValue(sheetName, 13, 3, 2d),
					new ExpectedCellValue(sheetName, 14, 3, 7d),
					new ExpectedCellValue(sheetName, 2, 4, "Headlamp"),
					new ExpectedCellValue(sheetName, 3, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 11, 4, 24.99),
					new ExpectedCellValue(sheetName, 12, 4, 24.99),
					new ExpectedCellValue(sheetName, 14, 4, 24.99),
					new ExpectedCellValue(sheetName, 3, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 5, 1d),
					new ExpectedCellValue(sheetName, 12, 5, 1d),
					new ExpectedCellValue(sheetName, 14, 5, 1d),
					new ExpectedCellValue(sheetName, 2, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 3, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 8, 6, 99d),
					new ExpectedCellValue(sheetName, 9, 6, 99d),
					new ExpectedCellValue(sheetName, 14, 6, 99d),
					new ExpectedCellValue(sheetName, 3, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 7, 1d),
					new ExpectedCellValue(sheetName, 9, 7, 1d),
					new ExpectedCellValue(sheetName, 14, 7, 1d),
					new ExpectedCellValue(sheetName, 2, 8, "Tent"),
					new ExpectedCellValue(sheetName, 3, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 8, 199d),
					new ExpectedCellValue(sheetName, 5, 8, 199d),
					new ExpectedCellValue(sheetName, 14, 8, 199d),
					new ExpectedCellValue(sheetName, 3, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 9, 6d),
					new ExpectedCellValue(sheetName, 5, 9, 6d),
					new ExpectedCellValue(sheetName, 14, 9, 6d),
					new ExpectedCellValue(sheetName, 2, 10, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 4, 10, 1030.5),
					new ExpectedCellValue(sheetName, 5, 10, 199d),
					new ExpectedCellValue(sheetName, 6, 10, 415.75),
					new ExpectedCellValue(sheetName, 7, 10, 415.75),
					new ExpectedCellValue(sheetName, 8, 10, 514.75),
					new ExpectedCellValue(sheetName, 9, 10, 99d),
					new ExpectedCellValue(sheetName, 10, 10, 415.75),
					new ExpectedCellValue(sheetName, 11, 10, 440.74),
					new ExpectedCellValue(sheetName, 12, 10, 24.99),
					new ExpectedCellValue(sheetName, 13, 10, 415.75),
					new ExpectedCellValue(sheetName, 14, 10, 1985.99),
					new ExpectedCellValue(sheetName, 2, 11, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 4, 11, 10d),
					new ExpectedCellValue(sheetName, 5, 11, 6d),
					new ExpectedCellValue(sheetName, 6, 11, 2d),
					new ExpectedCellValue(sheetName, 7, 11, 2d),
					new ExpectedCellValue(sheetName, 8, 11, 2d),
					new ExpectedCellValue(sheetName, 9, 11, 1d),
					new ExpectedCellValue(sheetName, 10, 11, 1d),
					new ExpectedCellValue(sheetName, 11, 11, 3d),
					new ExpectedCellValue(sheetName, 12, 11, 1d),
					new ExpectedCellValue(sheetName, 13, 11, 2d),
					new ExpectedCellValue(sheetName, 14, 11, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsOneRowFieldAndTwoColumnFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnFieldsSorting"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A18:S25"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnFieldsSorting";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 22, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 23, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 24, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 25, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 19, 2, "March"),
					new ExpectedCellValue(sheetName, 20, 2, "Headlamp"),
					new ExpectedCellValue(sheetName, 21, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 2, 24.99),
					new ExpectedCellValue(sheetName, 25, 2, 24.99),
					new ExpectedCellValue(sheetName, 21, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 24, 3, 1d),
					new ExpectedCellValue(sheetName, 25, 3, 1d),
					new ExpectedCellValue(sheetName, 20, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 4, 415.75),
					new ExpectedCellValue(sheetName, 25, 4, 415.75),
					new ExpectedCellValue(sheetName, 21, 5, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 5, 2d),
					new ExpectedCellValue(sheetName, 25, 5, 2d),
					new ExpectedCellValue(sheetName, 19, 6, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 6, 415.75),
					new ExpectedCellValue(sheetName, 24, 6, 24.99),
					new ExpectedCellValue(sheetName, 25, 6, 440.74),
					new ExpectedCellValue(sheetName, 19, 7, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 7, 2d),
					new ExpectedCellValue(sheetName, 24, 7, 1d),
					new ExpectedCellValue(sheetName, 25, 7, 3d),
					new ExpectedCellValue(sheetName, 19, 8, "January"),
					new ExpectedCellValue(sheetName, 20, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 8, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 8, 415.75),
					new ExpectedCellValue(sheetName, 23, 8, 415.75),
					new ExpectedCellValue(sheetName, 24, 8, 415.75),
					new ExpectedCellValue(sheetName, 25, 8, 1247.25),
					new ExpectedCellValue(sheetName, 21, 9, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 9, 2d),
					new ExpectedCellValue(sheetName, 23, 9, 1d),
					new ExpectedCellValue(sheetName, 24, 9, 2d),
					new ExpectedCellValue(sheetName, 25, 9, 5d),
					new ExpectedCellValue(sheetName, 19, 10, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 10, 415.75),
					new ExpectedCellValue(sheetName, 23, 10, 415.75),
					new ExpectedCellValue(sheetName, 24, 10, 415.75),
					new ExpectedCellValue(sheetName, 25, 10, 1247.25),
					new ExpectedCellValue(sheetName, 19, 11, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 11, 2d),
					new ExpectedCellValue(sheetName, 23, 11, 1d),
					new ExpectedCellValue(sheetName, 24, 11, 2d),
					new ExpectedCellValue(sheetName, 25, 11, 5d),
					new ExpectedCellValue(sheetName, 19, 12, "February"),
					new ExpectedCellValue(sheetName, 20, 12, "Tent"),
					new ExpectedCellValue(sheetName, 21, 12, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 12, 199d),
					new ExpectedCellValue(sheetName, 25, 12, 199d),
					new ExpectedCellValue(sheetName, 21, 13, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 13, 6d),
					new ExpectedCellValue(sheetName, 25, 13, 6d),
					new ExpectedCellValue(sheetName, 20, 14, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 21, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 23, 14, 99d),
					new ExpectedCellValue(sheetName, 25, 14, 99d),
					new ExpectedCellValue(sheetName, 21, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 23, 15, 1d),
					new ExpectedCellValue(sheetName, 25, 15, 1d),
					new ExpectedCellValue(sheetName, 19, 16, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 16, 199d),
					new ExpectedCellValue(sheetName, 23, 16, 99d),
					new ExpectedCellValue(sheetName, 25, 16, 298d),
					new ExpectedCellValue(sheetName, 19, 17, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 17, 6d),
					new ExpectedCellValue(sheetName, 23, 17, 1d),
					new ExpectedCellValue(sheetName, 25, 17, 7d),
					new ExpectedCellValue(sheetName, 19, 18, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 22, 18, 1030.5),
					new ExpectedCellValue(sheetName, 23, 18, 514.75),
					new ExpectedCellValue(sheetName, 24, 18, 440.74),
					new ExpectedCellValue(sheetName, 25, 18, 1985.99),
					new ExpectedCellValue(sheetName, 19, 19, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 19, 10d),
					new ExpectedCellValue(sheetName, 23, 19, 2d),
					new ExpectedCellValue(sheetName, 24, 19, 3d),
					new ExpectedCellValue(sheetName, 25, 19, 15d),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsTwoRowFieldAndTwoColumnFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnFieldsSorting"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A29:AH44"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnFieldsSorting";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					// These values will need to be changed when Bug #10033 is completed.
					new ExpectedCellValue(sheetName, 33, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 34, 1, 20100076),
					new ExpectedCellValue(sheetName, 35, 1, 20100007),
					new ExpectedCellValue(sheetName, 36, 1, 20100017),
					new ExpectedCellValue(sheetName, 37, 1, 20100090),
					new ExpectedCellValue(sheetName, 38, 1, "Tent"),
					new ExpectedCellValue(sheetName, 39, 1, 20100070),
					new ExpectedCellValue(sheetName, 40, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 41, 1, 20100085),
					new ExpectedCellValue(sheetName, 42, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 43, 1, 20100083),
					new ExpectedCellValue(sheetName, 44, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 30, 2, "March"),
					new ExpectedCellValue(sheetName, 31, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 32, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 42, 2, 24.99),
					new ExpectedCellValue(sheetName, 43, 2, 24.99),
					new ExpectedCellValue(sheetName, 44, 2, 24.99),
					new ExpectedCellValue(sheetName, 32, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 3, 1d),
					new ExpectedCellValue(sheetName, 43, 3, 1d),
					new ExpectedCellValue(sheetName, 44, 3, 1d),
					new ExpectedCellValue(sheetName, 32, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 42, 4, 24.99),
					new ExpectedCellValue(sheetName, 43, 4, 24.99),
					new ExpectedCellValue(sheetName, 44, 4, 24.99),
					new ExpectedCellValue(sheetName, 31, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 32, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 5, 415.75),
					new ExpectedCellValue(sheetName, 36, 5, 415.75),
					new ExpectedCellValue(sheetName, 44, 5, 415.75),
					new ExpectedCellValue(sheetName, 32, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 6, 2d),
					new ExpectedCellValue(sheetName, 36, 6, 2d),
					new ExpectedCellValue(sheetName, 44, 6, 2d),
					new ExpectedCellValue(sheetName, 32, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 7, 831.5),
					new ExpectedCellValue(sheetName, 36, 7, 831.5),
					new ExpectedCellValue(sheetName, 44, 7, 831.5),
					new ExpectedCellValue(sheetName, 30, 8, "March Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 8, 415.75),
					new ExpectedCellValue(sheetName, 36, 8, 415.75),
					new ExpectedCellValue(sheetName, 42, 8, 24.99),
					new ExpectedCellValue(sheetName, 43, 8, 24.99),
					new ExpectedCellValue(sheetName, 44, 8, 440.74),
					new ExpectedCellValue(sheetName, 30, 9, "March Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 9, 2d),
					new ExpectedCellValue(sheetName, 36, 9, 2d),
					new ExpectedCellValue(sheetName, 42, 9, 1d),
					new ExpectedCellValue(sheetName, 43, 9, 1d),
					new ExpectedCellValue(sheetName, 44, 9, 3d),
					new ExpectedCellValue(sheetName, 30, 10, "March Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 10, 831.5),
					new ExpectedCellValue(sheetName, 36, 10, 831.5),
					new ExpectedCellValue(sheetName, 42, 10, 24.99),
					new ExpectedCellValue(sheetName, 43, 10, 24.99),
					new ExpectedCellValue(sheetName, 44, 10, 856.49),
					new ExpectedCellValue(sheetName, 30, 11, "February"),
					new ExpectedCellValue(sheetName, 31, 11, "San Francisco"),
					new ExpectedCellValue(sheetName, 32, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 40, 11, 99d),
					new ExpectedCellValue(sheetName, 41, 11, 99d),
					new ExpectedCellValue(sheetName, 44, 11, 99d),
					new ExpectedCellValue(sheetName, 32, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 40, 12, 1d),
					new ExpectedCellValue(sheetName, 41, 12, 1d),
					new ExpectedCellValue(sheetName, 44, 12, 1d),
					new ExpectedCellValue(sheetName, 32, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 40, 13, 99d),
					new ExpectedCellValue(sheetName, 41, 13, 99d),
					new ExpectedCellValue(sheetName, 44, 13, 99d),
					new ExpectedCellValue(sheetName, 31, 14, "Nashville"),
					new ExpectedCellValue(sheetName, 32, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 38, 14, 199d),
					new ExpectedCellValue(sheetName, 39, 14, 199d),
					new ExpectedCellValue(sheetName, 44, 14, 199d),
					new ExpectedCellValue(sheetName, 32, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 15, 6d),
					new ExpectedCellValue(sheetName, 39, 15, 6d),
					new ExpectedCellValue(sheetName, 44, 15, 6d),
					new ExpectedCellValue(sheetName, 32, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 16, 1194d),
					new ExpectedCellValue(sheetName, 39, 16, 1194d),
					new ExpectedCellValue(sheetName, 44, 16, 1194d),
					new ExpectedCellValue(sheetName, 30, 17, "February Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 38, 17, 199d),
					new ExpectedCellValue(sheetName, 39, 17, 199d),
					new ExpectedCellValue(sheetName, 40, 17, 99d),
					new ExpectedCellValue(sheetName, 41, 17, 99d),
					new ExpectedCellValue(sheetName, 44, 17, 298d),
					new ExpectedCellValue(sheetName, 30, 18, "February Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 38, 18, 6d),
					new ExpectedCellValue(sheetName, 39, 18, 6d),
					new ExpectedCellValue(sheetName, 40, 18, 1d),
					new ExpectedCellValue(sheetName, 41, 18, 1d),
					new ExpectedCellValue(sheetName, 44, 18, 7d),
					new ExpectedCellValue(sheetName, 30, 19, "February Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 19, 1194d),
					new ExpectedCellValue(sheetName, 39, 19, 1194d),
					new ExpectedCellValue(sheetName, 40, 19, 99d),
					new ExpectedCellValue(sheetName, 41, 19, 99d),
					new ExpectedCellValue(sheetName, 44, 19, 1293d),
					new ExpectedCellValue(sheetName, 30, 20, "January"),
					new ExpectedCellValue(sheetName, 31, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 32, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 20, 415.75),
					new ExpectedCellValue(sheetName, 34, 20, 415.75),
					new ExpectedCellValue(sheetName, 44, 20, 415.75),
					new ExpectedCellValue(sheetName, 32, 21, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 21, 1d),
					new ExpectedCellValue(sheetName, 34, 21, 1d),
					new ExpectedCellValue(sheetName, 44, 21, 1d),
					new ExpectedCellValue(sheetName, 32, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 22, 415.75),
					new ExpectedCellValue(sheetName, 34, 22, 415.75),
					new ExpectedCellValue(sheetName, 44, 22, 415.75),
					new ExpectedCellValue(sheetName, 31, 23, "Chicago"),
					new ExpectedCellValue(sheetName, 32, 23, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 23, 415.75),
					new ExpectedCellValue(sheetName, 35, 23, 415.75),
					new ExpectedCellValue(sheetName, 44, 23, 415.75),
					new ExpectedCellValue(sheetName, 32, 24, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 24, 2d),
					new ExpectedCellValue(sheetName, 35, 24, 2d),
					new ExpectedCellValue(sheetName, 44, 24, 2d),
					new ExpectedCellValue(sheetName, 32, 25, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 25, 831.5),
					new ExpectedCellValue(sheetName, 35, 25, 831.5),
					new ExpectedCellValue(sheetName, 44, 25, 831.5),
					new ExpectedCellValue(sheetName, 31, 26, "Nashville"),
					new ExpectedCellValue(sheetName, 32, 26, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 26, 415.75),
					new ExpectedCellValue(sheetName, 37, 26, 415.75),
					new ExpectedCellValue(sheetName, 44, 26, 415.75),
					new ExpectedCellValue(sheetName, 32, 27, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 27, 2d),
					new ExpectedCellValue(sheetName, 37, 27, 2d),
					new ExpectedCellValue(sheetName, 44, 27, 2d),
					new ExpectedCellValue(sheetName, 32, 28, "Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 28, 831.5),
					new ExpectedCellValue(sheetName, 37, 28, 831.5),
					new ExpectedCellValue(sheetName, 44, 28, 831.5),
					new ExpectedCellValue(sheetName, 30, 29, "January Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 29, 1247.25),
					new ExpectedCellValue(sheetName, 34, 29, 415.75),
					new ExpectedCellValue(sheetName, 35, 29, 415.75),
					new ExpectedCellValue(sheetName, 37, 29, 415.75),
					new ExpectedCellValue(sheetName, 44, 29, 1247.25),
					new ExpectedCellValue(sheetName, 30, 30, "January Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 30, 5d),
					new ExpectedCellValue(sheetName, 34, 30, 1d),
					new ExpectedCellValue(sheetName, 35, 30, 2d),
					new ExpectedCellValue(sheetName, 37, 30, 2d),
					new ExpectedCellValue(sheetName, 44, 30, 5d),
					new ExpectedCellValue(sheetName, 30, 31, "January Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 31, 2078.75),
					new ExpectedCellValue(sheetName, 34, 31, 415.75),
					new ExpectedCellValue(sheetName, 35, 31, 831.5),
					new ExpectedCellValue(sheetName, 37, 31, 831.5),
					new ExpectedCellValue(sheetName, 44, 31, 2078.75),
					new ExpectedCellValue(sheetName, 30, 32, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 33, 32, 1663d),
					new ExpectedCellValue(sheetName, 34, 32, 415.75),
					new ExpectedCellValue(sheetName, 35, 32, 415.75),
					new ExpectedCellValue(sheetName, 36, 32, 415.75),
					new ExpectedCellValue(sheetName, 37, 32, 415.75),
					new ExpectedCellValue(sheetName, 38, 32, 199d),
					new ExpectedCellValue(sheetName, 39, 32, 199d),
					new ExpectedCellValue(sheetName, 40, 32, 99d),
					new ExpectedCellValue(sheetName, 41, 32, 99d),
					new ExpectedCellValue(sheetName, 42, 32, 24.99),
					new ExpectedCellValue(sheetName, 43, 32, 24.99),
					new ExpectedCellValue(sheetName, 44, 32, 1985.99),
					new ExpectedCellValue(sheetName, 30, 33, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 33, 33, 7d),
					new ExpectedCellValue(sheetName, 34, 33, 1d),
					new ExpectedCellValue(sheetName, 35, 33, 2d),
					new ExpectedCellValue(sheetName, 36, 33, 2d),
					new ExpectedCellValue(sheetName, 37, 33, 2d),
					new ExpectedCellValue(sheetName, 38, 33, 6d),
					new ExpectedCellValue(sheetName, 39, 33, 6d),
					new ExpectedCellValue(sheetName, 40, 33, 1d),
					new ExpectedCellValue(sheetName, 41, 33, 1d),
					new ExpectedCellValue(sheetName, 42, 33, 1d),
					new ExpectedCellValue(sheetName, 43, 33, 1d),
					new ExpectedCellValue(sheetName, 44, 33, 15d),
					new ExpectedCellValue(sheetName, 30, 34, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 33, 34, 2910.25),
					new ExpectedCellValue(sheetName, 34, 34, 415.75),
					new ExpectedCellValue(sheetName, 35, 34, 831.5),
					new ExpectedCellValue(sheetName, 36, 34, 831.5),
					new ExpectedCellValue(sheetName, 37, 34, 831.5),
					new ExpectedCellValue(sheetName, 38, 34, 1194d),
					new ExpectedCellValue(sheetName, 39, 34, 1194d),
					new ExpectedCellValue(sheetName, 40, 34, 99d),
					new ExpectedCellValue(sheetName, 41, 34, 99d),
					new ExpectedCellValue(sheetName, 42, 34, 24.99),
					new ExpectedCellValue(sheetName, 43, 34, 24.99),
					new ExpectedCellValue(sheetName, 44, 34, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsRowFieldsWithDataFieldsSortingRowsAndColumns()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DataFieldsInRows"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:E13"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DataFieldsInRows";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 6, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 7, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 8, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 9, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 10, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 11, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 13, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "February"),
					new ExpectedCellValue(sheetName, 4, 2, 1d),
					new ExpectedCellValue(sheetName, 5, 2, 99d),
					new ExpectedCellValue(sheetName, 10, 2, 6d),
					new ExpectedCellValue(sheetName, 11, 2, 1194d),
					new ExpectedCellValue(sheetName, 12, 2, 7d),
					new ExpectedCellValue(sheetName, 13, 2, 1293d),
					new ExpectedCellValue(sheetName, 2, 3, "January"),
					new ExpectedCellValue(sheetName, 4, 3, 1d),
					new ExpectedCellValue(sheetName, 5, 3, 415.75),
					new ExpectedCellValue(sheetName, 7, 3, 2d),
					new ExpectedCellValue(sheetName, 8, 3, 831.5),
					new ExpectedCellValue(sheetName, 10, 3, 2d),
					new ExpectedCellValue(sheetName, 11, 3, 831.5),
					new ExpectedCellValue(sheetName, 12, 3, 5d),
					new ExpectedCellValue(sheetName, 13, 3, 2078.75),
					new ExpectedCellValue(sheetName, 2, 4, "March"),
					new ExpectedCellValue(sheetName, 7, 4, 1d),
					new ExpectedCellValue(sheetName, 8, 4, 24.99),
					new ExpectedCellValue(sheetName, 10, 4, 2d),
					new ExpectedCellValue(sheetName, 11, 4, 831.5),
					new ExpectedCellValue(sheetName, 12, 4, 3d),
					new ExpectedCellValue(sheetName, 13, 4, 856.49),
					new ExpectedCellValue(sheetName, 2, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 4, 5, 2d),
					new ExpectedCellValue(sheetName, 5, 5, 514.75),
					new ExpectedCellValue(sheetName, 7, 5, 3d),
					new ExpectedCellValue(sheetName, 8, 5, 856.49),
					new ExpectedCellValue(sheetName, 10, 5, 10d),
					new ExpectedCellValue(sheetName, 11, 5, 2857d),
					new ExpectedCellValue(sheetName, 12, 5, 15d),
					new ExpectedCellValue(sheetName, 13, 5, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsRowFieldsWithDataFieldsSortingRowsColumnsDataFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DataFieldsInRows"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A17:E29"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DataFieldsInRows";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 19, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 20, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 22, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 23, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 24, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 26, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 27, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 28, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 29, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 2, "March"),
					new ExpectedCellValue(sheetName, 20, 2, 831.5),
					new ExpectedCellValue(sheetName, 21, 2, 2d),
					new ExpectedCellValue(sheetName, 23, 2, 24.99),
					new ExpectedCellValue(sheetName, 24, 2, 1d),
					new ExpectedCellValue(sheetName, 28, 2, 856.49),
					new ExpectedCellValue(sheetName, 29, 2, 3d),
					new ExpectedCellValue(sheetName, 18, 3, "February"),
					new ExpectedCellValue(sheetName, 20, 3, 1194d),
					new ExpectedCellValue(sheetName, 21, 3, 6d),
					new ExpectedCellValue(sheetName, 26, 3, 99d),
					new ExpectedCellValue(sheetName, 27, 3, 1d),
					new ExpectedCellValue(sheetName, 28, 3, 1293d),
					new ExpectedCellValue(sheetName, 29, 3, 7d),
					new ExpectedCellValue(sheetName, 18, 4, "January"),
					new ExpectedCellValue(sheetName, 20, 4, 831.5),
					new ExpectedCellValue(sheetName, 21, 4, 2d),
					new ExpectedCellValue(sheetName, 23, 4, 831.5),
					new ExpectedCellValue(sheetName, 24, 4, 2d),
					new ExpectedCellValue(sheetName, 26, 4, 415.75),
					new ExpectedCellValue(sheetName, 27, 4, 1d),
					new ExpectedCellValue(sheetName, 28, 4, 2078.75),
					new ExpectedCellValue(sheetName, 29, 4, 5d),
					new ExpectedCellValue(sheetName, 18, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 20, 5, 2857d),
					new ExpectedCellValue(sheetName, 21, 5, 10d),
					new ExpectedCellValue(sheetName, 23, 5, 856.49),
					new ExpectedCellValue(sheetName, 24, 5, 3d),
					new ExpectedCellValue(sheetName, 26, 5, 514.75),
					new ExpectedCellValue(sheetName, 27, 5, 2d),
					new ExpectedCellValue(sheetName, 28, 5, 4228.24),
					new ExpectedCellValue(sheetName, 29, 5, 15d),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsRowFieldsWithDataFieldsAndTwoColumnFieldsSortingRowsColumnsDataFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DataFieldsInRows"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A33:J46"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DataFieldsInRows";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 36, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 37, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 38, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 39, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 40, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 41, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 43, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 44, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 45, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 34, 2, "February"),
					new ExpectedCellValue(sheetName, 35, 2, "Tent"),
					new ExpectedCellValue(sheetName, 36, 2, null),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, 1194d),
					new ExpectedCellValue(sheetName, 41, 2, 6d),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, 1194d),
					new ExpectedCellValue(sheetName, 46, 2, 6d),
					new ExpectedCellValue(sheetName, 35, 3, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, 99d),
					new ExpectedCellValue(sheetName, 38, 3, 1d),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, 99d),
					new ExpectedCellValue(sheetName, 46, 3, 1d),
					new ExpectedCellValue(sheetName, 34, 4, "February Total"),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, 99d),
					new ExpectedCellValue(sheetName, 38, 4, 1d),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, 1194d),
					new ExpectedCellValue(sheetName, 41, 4, 6d),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, 1293d),
					new ExpectedCellValue(sheetName, 46, 4, 7d),
					new ExpectedCellValue(sheetName, 34, 5, "January"),
					new ExpectedCellValue(sheetName, 35, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, 415.75),
					new ExpectedCellValue(sheetName, 38, 5, 1d),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, 831.5),
					new ExpectedCellValue(sheetName, 41, 5, 2d),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, 831.5),
					new ExpectedCellValue(sheetName, 44, 5, 2d),
					new ExpectedCellValue(sheetName, 45, 5, 2078.75),
					new ExpectedCellValue(sheetName, 46, 5, 5d),
					new ExpectedCellValue(sheetName, 34, 6, "January Total"),
					new ExpectedCellValue(sheetName, 35, 6, null),
					new ExpectedCellValue(sheetName, 36, 6, null),
					new ExpectedCellValue(sheetName, 37, 6, 415.75),
					new ExpectedCellValue(sheetName, 38, 6, 1d),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, 831.5),
					new ExpectedCellValue(sheetName, 41, 6, 2d),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, 831.5),
					new ExpectedCellValue(sheetName, 44, 6, 2d),
					new ExpectedCellValue(sheetName, 45, 6, 2078.75),
					new ExpectedCellValue(sheetName, 46, 6, 5d),
					new ExpectedCellValue(sheetName, 34, 7, "March"),
					new ExpectedCellValue(sheetName, 35, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, null),
					new ExpectedCellValue(sheetName, 38, 7, null),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, 24.99),
					new ExpectedCellValue(sheetName, 44, 7, 1d),
					new ExpectedCellValue(sheetName, 45, 7, 24.99),
					new ExpectedCellValue(sheetName, 46, 7, 1d),
					new ExpectedCellValue(sheetName, 35, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 36, 8, null),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, 831.5),
					new ExpectedCellValue(sheetName, 41, 8, 2d),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, 831.5),
					new ExpectedCellValue(sheetName, 46, 8, 2d),
					new ExpectedCellValue(sheetName, 34, 9, "March Total"),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, 831.5),
					new ExpectedCellValue(sheetName, 41, 9, 2d),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, 24.99),
					new ExpectedCellValue(sheetName, 44, 9, 1d),
					new ExpectedCellValue(sheetName, 45, 9, 856.49),
					new ExpectedCellValue(sheetName, 46, 9, 3d),
					new ExpectedCellValue(sheetName, 34, 10, "Grand Total"),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, 514.75),
					new ExpectedCellValue(sheetName, 38, 10, 2d),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, 2857d),
					new ExpectedCellValue(sheetName, 41, 10, 10d),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, 856.49),
					new ExpectedCellValue(sheetName, 44, 10, 3d),
					new ExpectedCellValue(sheetName, 45, 10, 4228.24),
					new ExpectedCellValue(sheetName, 46, 10, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSorting.xlsx")]
		public void PivotTableRefreshCustomSortingWithReferencesToDataFieldsTwoRowFieldsWithDataFieldsAndTwoColumnFieldsSortingRowsColumnsDataFields()
		{
			var file = new FileInfo("PivotTableSorting.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DataFieldsInRows"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A50:J84"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DataFieldsInRows";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 53, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 54, 1, 20100090),
					new ExpectedCellValue(sheetName, 55, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 56, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 57, 1, 20100070),
					new ExpectedCellValue(sheetName, 58, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 60, 1, 20100017),
					new ExpectedCellValue(sheetName, 61, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 63, 1, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 64, 1, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 65, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 66, 1, 20100083),
					new ExpectedCellValue(sheetName, 67, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 68, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 69, 1, 20100007),
					new ExpectedCellValue(sheetName, 70, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 71, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 72, 1, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 73, 1, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 74, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 75, 1, 20100085),
					new ExpectedCellValue(sheetName, 76, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 77, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 78, 1, 20100076),
					new ExpectedCellValue(sheetName, 79, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 81, 1, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 82, 1, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 83, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 84, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 51, 2, "February"),
					new ExpectedCellValue(sheetName, 52, 2, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, null),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, null),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, null),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, 99d),
					new ExpectedCellValue(sheetName, 77, 2, 1d),
					new ExpectedCellValue(sheetName, 78, 2, null),
					new ExpectedCellValue(sheetName, 79, 2, null),
					new ExpectedCellValue(sheetName, 80, 2, null),
					new ExpectedCellValue(sheetName, 81, 2, 99d),
					new ExpectedCellValue(sheetName, 82, 2, 1d),
					new ExpectedCellValue(sheetName, 83, 2, 99d),
					new ExpectedCellValue(sheetName, 84, 2, 1d),
					new ExpectedCellValue(sheetName, 52, 3, "Tent"),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, null),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, 1194d),
					new ExpectedCellValue(sheetName, 59, 3, 6d),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, 1194d),
					new ExpectedCellValue(sheetName, 64, 3, 6d),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, null),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, 1194d),
					new ExpectedCellValue(sheetName, 84, 3, 6d),
					new ExpectedCellValue(sheetName, 51, 4, "February Total"),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, null),
					new ExpectedCellValue(sheetName, 56, 4, null),
					new ExpectedCellValue(sheetName, 57, 4, null),
					new ExpectedCellValue(sheetName, 58, 4, 1194d),
					new ExpectedCellValue(sheetName, 59, 4, 6d),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, 1194d),
					new ExpectedCellValue(sheetName, 64, 4, 6d),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, null),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, null),
					new ExpectedCellValue(sheetName, 70, 4, null),
					new ExpectedCellValue(sheetName, 71, 4, null),
					new ExpectedCellValue(sheetName, 72, 4, null),
					new ExpectedCellValue(sheetName, 73, 4, null),
					new ExpectedCellValue(sheetName, 74, 4, null),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, 99d),
					new ExpectedCellValue(sheetName, 77, 4, 1d),
					new ExpectedCellValue(sheetName, 78, 4, null),
					new ExpectedCellValue(sheetName, 79, 4, null),
					new ExpectedCellValue(sheetName, 80, 4, null),
					new ExpectedCellValue(sheetName, 81, 4, 99d),
					new ExpectedCellValue(sheetName, 82, 4, 1d),
					new ExpectedCellValue(sheetName, 83, 4, 1293d),
					new ExpectedCellValue(sheetName, 84, 4, 7d),
					new ExpectedCellValue(sheetName, 51, 5, "January"),
					new ExpectedCellValue(sheetName, 52, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, null),
					new ExpectedCellValue(sheetName, 55, 5, 831.5),
					new ExpectedCellValue(sheetName, 56, 5, 2d),
					new ExpectedCellValue(sheetName, 57, 5, null),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, null),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, null),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, 831.5),
					new ExpectedCellValue(sheetName, 64, 5, 2d),
					new ExpectedCellValue(sheetName, 65, 5, null),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, null),
					new ExpectedCellValue(sheetName, 68, 5, null),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 70, 5, 831.5),
					new ExpectedCellValue(sheetName, 71, 5, 2d),
					new ExpectedCellValue(sheetName, 72, 5, 831.5),
					new ExpectedCellValue(sheetName, 73, 5, 2d),
					new ExpectedCellValue(sheetName, 74, 5, null),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, null),
					new ExpectedCellValue(sheetName, 77, 5, null),
					new ExpectedCellValue(sheetName, 78, 5, null),
					new ExpectedCellValue(sheetName, 79, 5, 415.75),
					new ExpectedCellValue(sheetName, 80, 5, 1d),
					new ExpectedCellValue(sheetName, 81, 5, 415.75),
					new ExpectedCellValue(sheetName, 82, 5, 1d),
					new ExpectedCellValue(sheetName, 83, 5, 2078.75),
					new ExpectedCellValue(sheetName, 84, 5, 5d),
					new ExpectedCellValue(sheetName, 51, 6, "January Total"),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, 831.5),
					new ExpectedCellValue(sheetName, 56, 6, 2d),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, null),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, 831.5),
					new ExpectedCellValue(sheetName, 64, 6, 2d),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, null),
					new ExpectedCellValue(sheetName, 68, 6, null),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, 831.5),
					new ExpectedCellValue(sheetName, 71, 6, 2d),
					new ExpectedCellValue(sheetName, 72, 6, 831.5),
					new ExpectedCellValue(sheetName, 73, 6, 2d),
					new ExpectedCellValue(sheetName, 74, 6, null),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, null),
					new ExpectedCellValue(sheetName, 78, 6, null),
					new ExpectedCellValue(sheetName, 79, 6, 415.75),
					new ExpectedCellValue(sheetName, 80, 6, 1d),
					new ExpectedCellValue(sheetName, 81, 6, 415.75),
					new ExpectedCellValue(sheetName, 82, 6, 1d),
					new ExpectedCellValue(sheetName, 83, 6, 2078.75),
					new ExpectedCellValue(sheetName, 84, 6, 5d),
					new ExpectedCellValue(sheetName, 51, 7, "March"),
					new ExpectedCellValue(sheetName, 52, 7, "Headlamp"),
					new ExpectedCellValue(sheetName, 53, 7, null),
					new ExpectedCellValue(sheetName, 54, 7, null),
					new ExpectedCellValue(sheetName, 55, 7, null),
					new ExpectedCellValue(sheetName, 56, 7, null),
					new ExpectedCellValue(sheetName, 57, 7, null),
					new ExpectedCellValue(sheetName, 58, 7, null),
					new ExpectedCellValue(sheetName, 59, 7, null),
					new ExpectedCellValue(sheetName, 60, 7, null),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, null),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, 24.99),
					new ExpectedCellValue(sheetName, 68, 7, 1d),
					new ExpectedCellValue(sheetName, 69, 7, null),
					new ExpectedCellValue(sheetName, 70, 7, null),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, 24.99),
					new ExpectedCellValue(sheetName, 73, 7, 1d),
					new ExpectedCellValue(sheetName, 74, 7, null),
					new ExpectedCellValue(sheetName, 75, 7, null),
					new ExpectedCellValue(sheetName, 76, 7, null),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, null),
					new ExpectedCellValue(sheetName, 79, 7, null),
					new ExpectedCellValue(sheetName, 80, 7, null),
					new ExpectedCellValue(sheetName, 81, 7, null),
					new ExpectedCellValue(sheetName, 82, 7, null),
					new ExpectedCellValue(sheetName, 83, 7, 24.99),
					new ExpectedCellValue(sheetName, 84, 7, 1d),
					new ExpectedCellValue(sheetName, 52, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, null),
					new ExpectedCellValue(sheetName, 61, 8, 831.5),
					new ExpectedCellValue(sheetName, 62, 8, 2d),
					new ExpectedCellValue(sheetName, 63, 8, 831.5),
					new ExpectedCellValue(sheetName, 64, 8, 2d),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, null),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, null),
					new ExpectedCellValue(sheetName, 70, 8, null),
					new ExpectedCellValue(sheetName, 71, 8, null),
					new ExpectedCellValue(sheetName, 72, 8, null),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, null),
					new ExpectedCellValue(sheetName, 77, 8, null),
					new ExpectedCellValue(sheetName, 78, 8, null),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, null),
					new ExpectedCellValue(sheetName, 81, 8, null),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, 831.5),
					new ExpectedCellValue(sheetName, 84, 8, 2d),
					new ExpectedCellValue(sheetName, 51, 9, "March Total"),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, 831.5),
					new ExpectedCellValue(sheetName, 62, 9, 2d),
					new ExpectedCellValue(sheetName, 63, 9, 831.5),
					new ExpectedCellValue(sheetName, 64, 9, 2d),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, 24.99),
					new ExpectedCellValue(sheetName, 68, 9, 1d),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 70, 9, null),
					new ExpectedCellValue(sheetName, 71, 9, null),
					new ExpectedCellValue(sheetName, 72, 9, 24.99),
					new ExpectedCellValue(sheetName, 73, 9, 1d),
					new ExpectedCellValue(sheetName, 74, 9, null),
					new ExpectedCellValue(sheetName, 75, 9, null),
					new ExpectedCellValue(sheetName, 76, 9, null),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, null),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 80, 9, null),
					new ExpectedCellValue(sheetName, 81, 9, null),
					new ExpectedCellValue(sheetName, 82, 9, null),
					new ExpectedCellValue(sheetName, 83, 9, 856.49),
					new ExpectedCellValue(sheetName, 84, 9, 3d),
					new ExpectedCellValue(sheetName, 51, 10, "Grand Total"),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, 831.5),
					new ExpectedCellValue(sheetName, 56, 10, 2d),
					new ExpectedCellValue(sheetName, 57, 10, null),
					new ExpectedCellValue(sheetName, 58, 10, 1194d),
					new ExpectedCellValue(sheetName, 59, 10, 6d),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, 831.5),
					new ExpectedCellValue(sheetName, 62, 10, 2d),
					new ExpectedCellValue(sheetName, 63, 10, 2857d),
					new ExpectedCellValue(sheetName, 64, 10, 10d),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 66, 10, null),
					new ExpectedCellValue(sheetName, 67, 10, 24.99),
					new ExpectedCellValue(sheetName, 68, 10, 1d),
					new ExpectedCellValue(sheetName, 69, 10, null),
					new ExpectedCellValue(sheetName, 70, 10, 831.5),
					new ExpectedCellValue(sheetName, 71, 10, 2d),
					new ExpectedCellValue(sheetName, 72, 10, 856.49),
					new ExpectedCellValue(sheetName, 73, 10, 3d),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, 99d),
					new ExpectedCellValue(sheetName, 77, 10, 1d),
					new ExpectedCellValue(sheetName, 78, 10, null),
					new ExpectedCellValue(sheetName, 79, 10, 415.75),
					new ExpectedCellValue(sheetName, 80, 10, 1d),
					new ExpectedCellValue(sheetName, 81, 10, 514.75),
					new ExpectedCellValue(sheetName, 82, 10, 2d),
					new ExpectedCellValue(sheetName, 83, 10, 4228.24),
					new ExpectedCellValue(sheetName, 84, 10, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSortingCalculatedFields.xlsx")]
		public void PivotTableRefreshSortCalculatedFieldsOneCalculatedFieldTwoRowFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableSortingCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A2:C13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 4, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 6, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 1, "Tent"),
					new ExpectedCellValue(sheetName, 8, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 11, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 2, 1d),
					new ExpectedCellValue(sheetName, 4, 2, 1d),
					new ExpectedCellValue(sheetName, 5, 2, 1d),
					new ExpectedCellValue(sheetName, 6, 2, 1d),
					new ExpectedCellValue(sheetName, 7, 2, 6d),
					new ExpectedCellValue(sheetName, 8, 2, 6d),
					new ExpectedCellValue(sheetName, 9, 2, 7d),
					new ExpectedCellValue(sheetName, 10, 2, 2d),
					new ExpectedCellValue(sheetName, 11, 2, 4d),
					new ExpectedCellValue(sheetName, 12, 2, 1d),
					new ExpectedCellValue(sheetName, 13, 2, 15d),
					new ExpectedCellValue(sheetName, 2, 3, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 3, 3, 24.99),
					new ExpectedCellValue(sheetName, 4, 3, 24.99),
					new ExpectedCellValue(sheetName, 5, 3, 99d),
					new ExpectedCellValue(sheetName, 6, 3, 99d),
					new ExpectedCellValue(sheetName, 7, 3, 1194d),
					new ExpectedCellValue(sheetName, 8, 3, 1194d),
					new ExpectedCellValue(sheetName, 9, 3, 11641),
					new ExpectedCellValue(sheetName, 10, 3, 831.5),
					new ExpectedCellValue(sheetName, 11, 3, 3326d),
					new ExpectedCellValue(sheetName, 12, 3, 415.75),
					new ExpectedCellValue(sheetName, 13, 3, 29789.85)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSortingCalculatedFields.xlsx")]
		public void PivotTableRefreshSortCalculatedFieldsTwoCalculatedFieldsTwoRowFieldsNoColumnFields()
		{
			var file = new FileInfo("PivotTableSortingCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F2:I13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 3, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 4, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 5, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 6, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 7, 6, "Tent"),
					new ExpectedCellValue(sheetName, 8, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 9, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 10, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 11, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 13, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 7, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 7, 1d),
					new ExpectedCellValue(sheetName, 4, 7, 1d),
					new ExpectedCellValue(sheetName, 5, 7, 1d),
					new ExpectedCellValue(sheetName, 6, 7, 1d),
					new ExpectedCellValue(sheetName, 7, 7, 6d),
					new ExpectedCellValue(sheetName, 8, 7, 6d),
					new ExpectedCellValue(sheetName, 9, 7, 7d),
					new ExpectedCellValue(sheetName, 10, 7, 4d),
					new ExpectedCellValue(sheetName, 11, 7, 2d),
					new ExpectedCellValue(sheetName, 12, 7, 1d),
					new ExpectedCellValue(sheetName, 13, 7, 15d),
					new ExpectedCellValue(sheetName, 2, 8, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 3, 8, 24.99),
					new ExpectedCellValue(sheetName, 4, 8, 24.99),
					new ExpectedCellValue(sheetName, 5, 8, 99d),
					new ExpectedCellValue(sheetName, 6, 8, 99d),
					new ExpectedCellValue(sheetName, 7, 8, 1194d),
					new ExpectedCellValue(sheetName, 8, 8, 1194d),
					new ExpectedCellValue(sheetName, 9, 8, 11641),
					new ExpectedCellValue(sheetName, 10, 8, 3326d),
					new ExpectedCellValue(sheetName, 11, 8, 831.5),
					new ExpectedCellValue(sheetName, 12, 8, 415.75),
					new ExpectedCellValue(sheetName, 13, 8, 29789.85),
					new ExpectedCellValue(sheetName, 2, 9, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 3, 9, 1d),
					new ExpectedCellValue(sheetName, 4, 9, 1d),
					new ExpectedCellValue(sheetName, 5, 9, 1d),
					new ExpectedCellValue(sheetName, 6, 9, 1d),
					new ExpectedCellValue(sheetName, 7, 9, 6d),
					new ExpectedCellValue(sheetName, 8, 9, 6d),
					new ExpectedCellValue(sheetName, 9, 9, 7d),
					new ExpectedCellValue(sheetName, 10, 9, 4d),
					new ExpectedCellValue(sheetName, 11, 9, 2d),
					new ExpectedCellValue(sheetName, 12, 9, 1d),
					new ExpectedCellValue(sheetName, 13, 9, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSortingCalculatedFields.xlsx")]
		public void PivotTableRefreshSortCalculatedFieldsTwoCalculatedFieldsTwoRowFieldsBothSortedNoColumnFields()
		{
			var file = new FileInfo("PivotTableSortingCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A18:C27"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 18, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 19, 1, "March"),
					new ExpectedCellValue(sheetName, 20, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 22, 1, "February"),
					new ExpectedCellValue(sheetName, 23, 1, "Tent"),
					new ExpectedCellValue(sheetName, 24, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 25, 1, "January"),
					new ExpectedCellValue(sheetName, 26, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 27, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 18, 2, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 19, 2, 1322.22),
					new ExpectedCellValue(sheetName, 20, 2, 831.50),
					new ExpectedCellValue(sheetName, 21, 2, 24.99),
					new ExpectedCellValue(sheetName, 22, 2, 2086d),
					new ExpectedCellValue(sheetName, 23, 2, 1194d),
					new ExpectedCellValue(sheetName, 24, 2, 99d),
					new ExpectedCellValue(sheetName, 25, 2, 6236.25),
					new ExpectedCellValue(sheetName, 26, 2, 6236.25),
					new ExpectedCellValue(sheetName, 27, 2, 29789.85),
					new ExpectedCellValue(sheetName, 18, 3, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 19, 3, 3d),
					new ExpectedCellValue(sheetName, 20, 3, 2d),
					new ExpectedCellValue(sheetName, 21, 3, 1d),
					new ExpectedCellValue(sheetName, 22, 3, 7d),
					new ExpectedCellValue(sheetName, 23, 3, 6d),
					new ExpectedCellValue(sheetName, 24, 3, 1d),
					new ExpectedCellValue(sheetName, 25, 3, 5d),
					new ExpectedCellValue(sheetName, 26, 3, 5d),
					new ExpectedCellValue(sheetName, 27, 3, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSortingCalculatedFields.xlsx")]
		public void PivotTableRefreshSortCalculatedFieldsTwoCalculatedFieldsTwoRowFieldsFirstFieldSortedNoColumnFields()
		{
			var file = new FileInfo("PivotTableSortingCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("F18:H27"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 18, 6, "Row Labels"),
					new ExpectedCellValue(sheetName, 19, 6, "March"),
					new ExpectedCellValue(sheetName, 20, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 21, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 22, 6, "January"),
					new ExpectedCellValue(sheetName, 23, 6, "Car Rack"),
					new ExpectedCellValue(sheetName, 24, 6, "February"),
					new ExpectedCellValue(sheetName, 25, 6, "Tent"),
					new ExpectedCellValue(sheetName, 26, 6, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 27, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 18, 7, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 19, 7, 1322.22),
					new ExpectedCellValue(sheetName, 20, 7, 831.50),
					new ExpectedCellValue(sheetName, 21, 7, 24.99),
					new ExpectedCellValue(sheetName, 22, 7, 6236.25),
					new ExpectedCellValue(sheetName, 23, 7, 6236.25),
					new ExpectedCellValue(sheetName, 24, 7, 2086d),
					new ExpectedCellValue(sheetName, 25, 7, 1194d),
					new ExpectedCellValue(sheetName, 26, 7, 99d),
					new ExpectedCellValue(sheetName, 27, 7, 29789.85),
					new ExpectedCellValue(sheetName, 18, 8, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 19, 8, 3d),
					new ExpectedCellValue(sheetName, 20, 8, 2d),
					new ExpectedCellValue(sheetName, 21, 8, 1d),
					new ExpectedCellValue(sheetName, 22, 8, 5d),
					new ExpectedCellValue(sheetName, 23, 8, 5d),
					new ExpectedCellValue(sheetName, 24, 8, 7d),
					new ExpectedCellValue(sheetName, 25, 8, 6d),
					new ExpectedCellValue(sheetName, 26, 8, 1d),
					new ExpectedCellValue(sheetName, 27, 8, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableSortingCalculatedFields.xlsx")]
		public void PivotTableRefreshSortCalculatedFieldsTwoCalculatedFieldsTwoRowFieldsFirstFieldSortedOneColumnFieldSorted()
		{
			var file = new FileInfo("PivotTableSortingCalculatedFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				string sheetName = "Sheet2";
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets[sheetName];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A33:I45"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					package.SaveAs(newFile.File);
				}
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 33, 1, null),
					new ExpectedCellValue(sheetName, 34, 1, null),
					new ExpectedCellValue(sheetName, 35, 1, "Row Labels"),
					new ExpectedCellValue(sheetName, 36, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 37, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 38, 1, "Tent"),
					new ExpectedCellValue(sheetName, 39, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 40, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 41, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 42, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 43, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 44, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 45, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 33, 2, "Column Labels"),
					new ExpectedCellValue(sheetName, 34, 2, "March"),
					new ExpectedCellValue(sheetName, 35, 2, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 36, 2, 831.5),
					new ExpectedCellValue(sheetName, 37, 2, 831.5),
					new ExpectedCellValue(sheetName, 38, 2, 0),
					new ExpectedCellValue(sheetName, 39, 2, 24.99),
					new ExpectedCellValue(sheetName, 40, 2, 0),
					new ExpectedCellValue(sheetName, 41, 2, 24.99),
					new ExpectedCellValue(sheetName, 42, 2, 0),
					new ExpectedCellValue(sheetName, 43, 2, 0),
					new ExpectedCellValue(sheetName, 44, 2, 0),
					new ExpectedCellValue(sheetName, 45, 2, 1322.22),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 36, 3, 2d),
					new ExpectedCellValue(sheetName, 37, 3, 2d),
					new ExpectedCellValue(sheetName, 38, 3, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 39, 3, 1d),
					new ExpectedCellValue(sheetName, 40, 3, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 41, 3, 1d),
					new ExpectedCellValue(sheetName, 42, 3, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 43, 3, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 44, 3, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 45, 3, 3d),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, "February"),
					new ExpectedCellValue(sheetName, 35, 4, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 36, 4, 1194d),
					new ExpectedCellValue(sheetName, 37, 4, 0),
					new ExpectedCellValue(sheetName, 38, 4, 1194d),
					new ExpectedCellValue(sheetName, 39, 4, 0),
					new ExpectedCellValue(sheetName, 40, 4, 0),
					new ExpectedCellValue(sheetName, 41, 4, 0),
					new ExpectedCellValue(sheetName, 42, 4, 99d),
					new ExpectedCellValue(sheetName, 43, 4, 0),
					new ExpectedCellValue(sheetName, 44, 4, 99d),
					new ExpectedCellValue(sheetName, 45, 4, 2086d),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 36, 5, 6d),
					new ExpectedCellValue(sheetName, 37, 5, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 38, 5, 6d),
					new ExpectedCellValue(sheetName, 39, 5, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 40, 5, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 41, 5, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 42, 5, 1d),
					new ExpectedCellValue(sheetName, 43, 5, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 44, 5, 1d),
					new ExpectedCellValue(sheetName, 45, 5, 7d),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, "January"),
					new ExpectedCellValue(sheetName, 35, 6, "Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 36, 6, 831.5),
					new ExpectedCellValue(sheetName, 37, 6, 831.5),
					new ExpectedCellValue(sheetName, 38, 6, 0),
					new ExpectedCellValue(sheetName, 39, 6, 831.5),
					new ExpectedCellValue(sheetName, 40, 6, 831.5),
					new ExpectedCellValue(sheetName, 41, 6, 0),
					new ExpectedCellValue(sheetName, 42, 6, 415.75),
					new ExpectedCellValue(sheetName, 43, 6, 415.75),
					new ExpectedCellValue(sheetName, 44, 6, 0),
					new ExpectedCellValue(sheetName, 45, 6, 6236.25),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 35, 7, "Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 36, 7, 2d),
					new ExpectedCellValue(sheetName, 37, 7, 2d),
					new ExpectedCellValue(sheetName, 38, 7, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 39, 7, 2d),
					new ExpectedCellValue(sheetName, 40, 7, 2d),
					new ExpectedCellValue(sheetName, 41, 7, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 42, 7, 1d),
					new ExpectedCellValue(sheetName, 43, 7, 1d),
					new ExpectedCellValue(sheetName, 44, 7, "#DIV/0!"),
					new ExpectedCellValue(sheetName, 45, 7, 5d),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, "Total Sum of CalculatedField"),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, 10305d),
					new ExpectedCellValue(sheetName, 37, 8, 3326d),
					new ExpectedCellValue(sheetName, 38, 8, 1194d),
					new ExpectedCellValue(sheetName, 39, 8, 1322.22),
					new ExpectedCellValue(sheetName, 40, 8, 831.5),
					new ExpectedCellValue(sheetName, 41, 8, 24.99),
					new ExpectedCellValue(sheetName, 42, 8, 1029.5),
					new ExpectedCellValue(sheetName, 43, 8, 415.75),
					new ExpectedCellValue(sheetName, 44, 8, 99d),
					new ExpectedCellValue(sheetName, 45, 8, 29789.85),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, "Total Sum of CalculatedField2"),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, 10d),
					new ExpectedCellValue(sheetName, 37, 9, 4d),
					new ExpectedCellValue(sheetName, 38, 9, 6d),
					new ExpectedCellValue(sheetName, 39, 9, 3d),
					new ExpectedCellValue(sheetName, 40, 9, 2d),
					new ExpectedCellValue(sheetName, 41, 9, 1d),
					new ExpectedCellValue(sheetName, 42, 9, 2d),
					new ExpectedCellValue(sheetName, 43, 9, 1d),
					new ExpectedCellValue(sheetName, 44, 9, 1d),
					new ExpectedCellValue(sheetName, 45, 9, 15d)
				});
			}
		}
		#endregion

		#region Grouping Tests
		#region Date Grouping Tests
		// 2-Combo Months Quarters Years
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsAndQuartersOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsTwoFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B10"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsTwoFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, 2016),
					new ExpectedCellValue(sheetName, 3, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 4, 1, 2017),
					new ExpectedCellValue(sheetName, 5, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 6, 1, 2018),
					new ExpectedCellValue(sheetName, 7, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 8, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 9, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 10, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, 831.5),
					new ExpectedCellValue(sheetName, 3, 2, 831.5),
					new ExpectedCellValue(sheetName, 4, 2, 930.5),
					new ExpectedCellValue(sheetName, 5, 2, 930.5),
					new ExpectedCellValue(sheetName, 6, 2, 2466.24),
					new ExpectedCellValue(sheetName, 7, 2, 856.49),
					new ExpectedCellValue(sheetName, 8, 2, 1194d),
					new ExpectedCellValue(sheetName, 9, 2, 415.75),
					new ExpectedCellValue(sheetName, 10, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsAndQuartersOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesColumnsTwoFieldSubtotalBot"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var field in pivotTable.Fields)
					{
						field.SubtotalLocation = SubtotalLocation.Bottom;
					}
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesColumnsTwoFieldSubtotalBot";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, 2016),
					new ExpectedCellValue(sheetName, 3, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 4, 1, "2016 Total"),
					new ExpectedCellValue(sheetName, 5, 1, 2017),
					new ExpectedCellValue(sheetName, 6, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 7, 1, "2017 Total"),
					new ExpectedCellValue(sheetName, 8, 1, 2018),
					new ExpectedCellValue(sheetName, 9, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 10, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 11, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 12, 1, "2018 Total"),
					new ExpectedCellValue(sheetName, 13, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, null),
					new ExpectedCellValue(sheetName, 3, 2, 831.5),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 5, 2, null),
					new ExpectedCellValue(sheetName, 6, 2, 930.5),
					new ExpectedCellValue(sheetName, 7, 2, 930.5),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, 856.49),
					new ExpectedCellValue(sheetName, 10, 2, 1194d),
					new ExpectedCellValue(sheetName, 11, 2, 415.75),
					new ExpectedCellValue(sheetName, 12, 2, 2466.24),
					new ExpectedCellValue(sheetName, 13, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersAndYearsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsTwoFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:F10"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsTwoFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 5, 2018),
					new ExpectedCellValue(sheetName, 4, 5, "Qtr2"),
					new ExpectedCellValue(sheetName, 5, 5, 2016),
					new ExpectedCellValue(sheetName, 6, 5, 2018),
					new ExpectedCellValue(sheetName, 7, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 8, 5, 2017),
					new ExpectedCellValue(sheetName, 9, 5, 2018),
					new ExpectedCellValue(sheetName, 10, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 6, 856.49),
					new ExpectedCellValue(sheetName, 3, 6, 856.49),
					new ExpectedCellValue(sheetName, 4, 6, 2025.5),
					new ExpectedCellValue(sheetName, 5, 6, 831.5),
					new ExpectedCellValue(sheetName, 6, 6, 1194d),
					new ExpectedCellValue(sheetName, 7, 6, 1346.25),
					new ExpectedCellValue(sheetName, 8, 6, 930.5),
					new ExpectedCellValue(sheetName, 9, 6, 415.75),
					new ExpectedCellValue(sheetName, 10, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersAndYearsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesColumnsTwoFieldSubtotalBot"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:F13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesColumnsTwoFieldSubtotalBot";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 5, 2018),
					new ExpectedCellValue(sheetName, 4, 5, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 5, 5, "Qtr2"),
					new ExpectedCellValue(sheetName, 6, 5, 2016),
					new ExpectedCellValue(sheetName, 7, 5, 2018),
					new ExpectedCellValue(sheetName, 8, 5, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 9, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 10, 5, 2017),
					new ExpectedCellValue(sheetName, 11, 5, 2018),
					new ExpectedCellValue(sheetName, 12, 5, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 13, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 6, null),
					new ExpectedCellValue(sheetName, 3, 6, 856.49),
					new ExpectedCellValue(sheetName, 4, 6, 856.49),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, 831.5),
					new ExpectedCellValue(sheetName, 7, 6, 1194d),
					new ExpectedCellValue(sheetName, 8, 6, 2025.5),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, 930.5),
					new ExpectedCellValue(sheetName, 11, 6, 415.75),
					new ExpectedCellValue(sheetName, 12, 6, 1346.25),
					new ExpectedCellValue(sheetName, 13, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsAndQuartersOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsTwoFields"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I1:J14"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsTwoFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, "Feb"),
					new ExpectedCellValue(sheetName, 3, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 4, 9, "Mar"),
					new ExpectedCellValue(sheetName, 5, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 6, 9, "May"),
					new ExpectedCellValue(sheetName, 7, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 8, 9, "Oct"),
					new ExpectedCellValue(sheetName, 9, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 10, 9, "Nov"),
					new ExpectedCellValue(sheetName, 11, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 12, 9, "Dec"),
					new ExpectedCellValue(sheetName, 13, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 14, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 10, 831.5),
					new ExpectedCellValue(sheetName, 3, 10, 831.5),
					new ExpectedCellValue(sheetName, 4, 10, 24.99),
					new ExpectedCellValue(sheetName, 5, 10, 24.99),
					new ExpectedCellValue(sheetName, 6, 10, 2025.5),
					new ExpectedCellValue(sheetName, 7, 10, 2025.5),
					new ExpectedCellValue(sheetName, 8, 10, 831.5),
					new ExpectedCellValue(sheetName, 9, 10, 831.5),
					new ExpectedCellValue(sheetName, 10, 10, 415.75),
					new ExpectedCellValue(sheetName, 11, 10, 415.75),
					new ExpectedCellValue(sheetName, 12, 10, 99d),
					new ExpectedCellValue(sheetName, 13, 10, 99d),
					new ExpectedCellValue(sheetName, 14, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsAndQuartersOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesColumnsTwoFieldSubtotalBot"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I1:J20"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesColumnsTwoFieldSubtotalBot";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, "Feb"),
					new ExpectedCellValue(sheetName, 3, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 4, 9, "Feb Total"),
					new ExpectedCellValue(sheetName, 5, 9, "Mar"),
					new ExpectedCellValue(sheetName, 6, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 7, 9, "Mar Total"),
					new ExpectedCellValue(sheetName, 8, 9, "May"),
					new ExpectedCellValue(sheetName, 9, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 10, 9, "May Total"),
					new ExpectedCellValue(sheetName, 11, 9, "Oct"),
					new ExpectedCellValue(sheetName, 12, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 13, 9, "Oct Total"),
					new ExpectedCellValue(sheetName, 14, 9, "Nov"),
					new ExpectedCellValue(sheetName, 15, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 16, 9, "Nov Total"),
					new ExpectedCellValue(sheetName, 17, 9, "Dec"),
					new ExpectedCellValue(sheetName, 18, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 19, 9, "Dec Total"),
					new ExpectedCellValue(sheetName, 20, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, 831.5),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 5, 10, null),
					new ExpectedCellValue(sheetName, 6, 10, 24.99),
					new ExpectedCellValue(sheetName, 7, 10, 24.99),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, 2025.5),
					new ExpectedCellValue(sheetName, 10, 10, 2025.5),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, 831.5),
					new ExpectedCellValue(sheetName, 13, 10, 831.5),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, 415.75),
					new ExpectedCellValue(sheetName, 16, 10, 415.75),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, 99d),
					new ExpectedCellValue(sheetName, 19, 10, 99d),
					new ExpectedCellValue(sheetName, 20, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersAndMonthsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsTwoFields"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M1:N11"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsTwoFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 13, "Feb"),
					new ExpectedCellValue(sheetName, 4, 13, "Mar"),
					new ExpectedCellValue(sheetName, 5, 13, "Qtr2"),
					new ExpectedCellValue(sheetName, 6, 13, "May"),
					new ExpectedCellValue(sheetName, 7, 13, "Qtr4"),
					new ExpectedCellValue(sheetName, 8, 13, "Oct"),
					new ExpectedCellValue(sheetName, 9, 13, "Nov"),
					new ExpectedCellValue(sheetName, 10, 13, "Dec"),
					new ExpectedCellValue(sheetName, 11, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 14, 856.49),
					new ExpectedCellValue(sheetName, 3, 14, 831.5),
					new ExpectedCellValue(sheetName, 4, 14, 24.99),
					new ExpectedCellValue(sheetName, 5, 14, 2025.5),
					new ExpectedCellValue(sheetName, 6, 14, 2025.5),
					new ExpectedCellValue(sheetName, 7, 14, 1346.25),
					new ExpectedCellValue(sheetName, 8, 14, 831.5),
					new ExpectedCellValue(sheetName, 9, 14, 415.75),
					new ExpectedCellValue(sheetName, 10, 14, 99d),
					new ExpectedCellValue(sheetName, 11, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersAndMonthsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesColumnsTwoFieldSubtotalBot"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M1:N14"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesColumnsTwoFieldSubtotalBot";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 13, "Feb"),
					new ExpectedCellValue(sheetName, 4, 13, "Mar"),
					new ExpectedCellValue(sheetName, 5, 13, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 6, 13, "Qtr2"),
					new ExpectedCellValue(sheetName, 7, 13, "May"),
					new ExpectedCellValue(sheetName, 8, 13, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 9, 13, "Qtr4"),
					new ExpectedCellValue(sheetName, 10, 13, "Oct"),
					new ExpectedCellValue(sheetName, 11, 13, "Nov"),
					new ExpectedCellValue(sheetName, 12, 13, "Dec"),
					new ExpectedCellValue(sheetName, 13, 13, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 14, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 14, null),
					new ExpectedCellValue(sheetName, 3, 14, 831.5),
					new ExpectedCellValue(sheetName, 4, 14, 24.99),
					new ExpectedCellValue(sheetName, 5, 14, 856.49),
					new ExpectedCellValue(sheetName, 6, 14, null),
					new ExpectedCellValue(sheetName, 7, 14, 2025.5),
					new ExpectedCellValue(sheetName, 8, 14, 2025.5),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, 831.5),
					new ExpectedCellValue(sheetName, 11, 14, 415.75),
					new ExpectedCellValue(sheetName, 12, 14, 99d),
					new ExpectedCellValue(sheetName, 13, 14, 1346.25),
					new ExpectedCellValue(sheetName, 14, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsAndYearsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsTwoFields"];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q1:R15"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsTwoFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 17, "Feb"),
					new ExpectedCellValue(sheetName, 3, 17, 2018),
					new ExpectedCellValue(sheetName, 4, 17, "Mar"),
					new ExpectedCellValue(sheetName, 5, 17, 2018),
					new ExpectedCellValue(sheetName, 6, 17, "May"),
					new ExpectedCellValue(sheetName, 7, 17, 2016),
					new ExpectedCellValue(sheetName, 8, 17, 2018),
					new ExpectedCellValue(sheetName, 9, 17, "Oct"),
					new ExpectedCellValue(sheetName, 10, 17, 2017),
					new ExpectedCellValue(sheetName, 11, 17, "Nov"),
					new ExpectedCellValue(sheetName, 12, 17, 2018),
					new ExpectedCellValue(sheetName, 13, 17, "Dec"),
					new ExpectedCellValue(sheetName, 14, 17, 2017),
					new ExpectedCellValue(sheetName, 15, 17, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 18, 831.5),
					new ExpectedCellValue(sheetName, 3, 18, 831.5),
					new ExpectedCellValue(sheetName, 4, 18, 24.99),
					new ExpectedCellValue(sheetName, 5, 18, 24.99),
					new ExpectedCellValue(sheetName, 6, 18, 2025.5),
					new ExpectedCellValue(sheetName, 7, 18, 831.5),
					new ExpectedCellValue(sheetName, 8, 18, 1194d),
					new ExpectedCellValue(sheetName, 9, 18, 831.5),
					new ExpectedCellValue(sheetName, 10, 18, 831.5),
					new ExpectedCellValue(sheetName, 11, 18, 415.75),
					new ExpectedCellValue(sheetName, 12, 18, 415.75),
					new ExpectedCellValue(sheetName, 13, 18, 99d),
					new ExpectedCellValue(sheetName, 14, 18, 99d),
					new ExpectedCellValue(sheetName, 15, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsAndYearsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesColumnsTwoFieldSubtotalBot"];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q1:R21"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesColumnsTwoFieldSubtotalBot";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 17, "Feb"),
					new ExpectedCellValue(sheetName, 3, 17, 2018),
					new ExpectedCellValue(sheetName, 4, 17, "Feb Total"),
					new ExpectedCellValue(sheetName, 5, 17, "Mar"),
					new ExpectedCellValue(sheetName, 6, 17, 2018),
					new ExpectedCellValue(sheetName, 7, 17, "Mar Total"),
					new ExpectedCellValue(sheetName, 8, 17, "May"),
					new ExpectedCellValue(sheetName, 9, 17, 2016),
					new ExpectedCellValue(sheetName, 10, 17, 2018),
					new ExpectedCellValue(sheetName, 11, 17, "May Total"),
					new ExpectedCellValue(sheetName, 12, 17, "Oct"),
					new ExpectedCellValue(sheetName, 13, 17, 2017),
					new ExpectedCellValue(sheetName, 14, 17, "Oct Total"),
					new ExpectedCellValue(sheetName, 15, 17, "Nov"),
					new ExpectedCellValue(sheetName, 16, 17, 2018),
					new ExpectedCellValue(sheetName, 17, 17, "Nov Total"),
					new ExpectedCellValue(sheetName, 18, 17, "Dec"),
					new ExpectedCellValue(sheetName, 19, 17, 2017),
					new ExpectedCellValue(sheetName, 20, 17, "Dec Total"),
					new ExpectedCellValue(sheetName, 21, 17, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 18, null),
					new ExpectedCellValue(sheetName, 3, 18, 831.5),
					new ExpectedCellValue(sheetName, 4, 18, 831.5),
					new ExpectedCellValue(sheetName, 5, 18, null),
					new ExpectedCellValue(sheetName, 6, 18, 24.99),
					new ExpectedCellValue(sheetName, 7, 18, 24.99),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, 831.5),
					new ExpectedCellValue(sheetName, 10, 18, 1194d),
					new ExpectedCellValue(sheetName, 11, 18, 2025.5),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, 831.5),
					new ExpectedCellValue(sheetName, 14, 18, 831.5),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, 415.75),
					new ExpectedCellValue(sheetName, 17, 18, 415.75),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, 99d),
					new ExpectedCellValue(sheetName, 20, 18, 99d),
					new ExpectedCellValue(sheetName, 21, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsAndMonthsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsTwoFields"];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("U1:V12"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsTwoFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 21, 2016),
					new ExpectedCellValue(sheetName, 3, 21, "May"),
					new ExpectedCellValue(sheetName, 4, 21, 2017),
					new ExpectedCellValue(sheetName, 5, 21, "Oct"),
					new ExpectedCellValue(sheetName, 6, 21, "Dec"),
					new ExpectedCellValue(sheetName, 7, 21, 2018),
					new ExpectedCellValue(sheetName, 8, 21, "Feb"),
					new ExpectedCellValue(sheetName, 9, 21, "Mar"),
					new ExpectedCellValue(sheetName, 10, 21, "May"),
					new ExpectedCellValue(sheetName, 11, 21, "Nov"),
					new ExpectedCellValue(sheetName, 12, 21, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 22, 831.5),
					new ExpectedCellValue(sheetName, 3, 22, 831.5),
					new ExpectedCellValue(sheetName, 4, 22, 930.5),
					new ExpectedCellValue(sheetName, 5, 22, 831.5),
					new ExpectedCellValue(sheetName, 6, 22, 99d),
					new ExpectedCellValue(sheetName, 7, 22, 2466.24),
					new ExpectedCellValue(sheetName, 8, 22, 831.5),
					new ExpectedCellValue(sheetName, 9, 22, 24.99),
					new ExpectedCellValue(sheetName, 10, 22, 1194d),
					new ExpectedCellValue(sheetName, 11, 22, 415.75),
					new ExpectedCellValue(sheetName, 12, 22, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsAndMonthsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesColumnsTwoFieldSubtotalBot"];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("U1:V15"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesColumnsTwoFieldSubtotalBot";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 21, 2016),
					new ExpectedCellValue(sheetName, 3, 21, "May"),
					new ExpectedCellValue(sheetName, 4, 21, "2016 Total"),
					new ExpectedCellValue(sheetName, 5, 21, 2017),
					new ExpectedCellValue(sheetName, 6, 21, "Oct"),
					new ExpectedCellValue(sheetName, 7, 21, "Dec"),
					new ExpectedCellValue(sheetName, 8, 21, "2017 Total"),
					new ExpectedCellValue(sheetName, 9, 21, 2018),
					new ExpectedCellValue(sheetName, 10, 21, "Feb"),
					new ExpectedCellValue(sheetName, 11, 21, "Mar"),
					new ExpectedCellValue(sheetName, 12, 21, "May"),
					new ExpectedCellValue(sheetName, 13, 21, "Nov"),
					new ExpectedCellValue(sheetName, 14, 21, "2018 Total"),
					new ExpectedCellValue(sheetName, 15, 21, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 22, null),
					new ExpectedCellValue(sheetName, 3, 22, 831.5),
					new ExpectedCellValue(sheetName, 4, 22, 831.5),
					new ExpectedCellValue(sheetName, 5, 22, null),
					new ExpectedCellValue(sheetName, 6, 22, 831.5),
					new ExpectedCellValue(sheetName, 7, 22, 99d),
					new ExpectedCellValue(sheetName, 8, 22, 930.5),
					new ExpectedCellValue(sheetName, 9, 22, null),
					new ExpectedCellValue(sheetName, 10, 22, 831.5),
					new ExpectedCellValue(sheetName, 11, 22, 24.99),
					new ExpectedCellValue(sheetName, 12, 22, 1194d),
					new ExpectedCellValue(sheetName, 13, 22, 415.75),
					new ExpectedCellValue(sheetName, 14, 22, 2466.24),
					new ExpectedCellValue(sheetName, 15, 22, 4228.24)
				});
			}
		}

		// 3-Combo Months Quarters Years
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsQuartersAndMonthsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsThreeFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B17"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsThreeFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, 2016),
					new ExpectedCellValue(sheetName, 3, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 4, 1, "May"),
					new ExpectedCellValue(sheetName, 5, 1, 2017),
					new ExpectedCellValue(sheetName, 6, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 7, 1, "Oct"),
					new ExpectedCellValue(sheetName, 8, 1, "Dec"),
					new ExpectedCellValue(sheetName, 9, 1, 2018),
					new ExpectedCellValue(sheetName, 10, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 11, 1, "Feb"),
					new ExpectedCellValue(sheetName, 12, 1, "Mar"),
					new ExpectedCellValue(sheetName, 13, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 14, 1, "May"),
					new ExpectedCellValue(sheetName, 15, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 16, 1, "Nov"),
					new ExpectedCellValue(sheetName, 17, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, 831.5),
					new ExpectedCellValue(sheetName, 3, 2, 831.5),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 5, 2, 930.5),
					new ExpectedCellValue(sheetName, 6, 2, 930.5),
					new ExpectedCellValue(sheetName, 7, 2, 831.5),
					new ExpectedCellValue(sheetName, 8, 2, 99d),
					new ExpectedCellValue(sheetName, 9, 2, 2466.24),
					new ExpectedCellValue(sheetName, 10, 2, 856.49),
					new ExpectedCellValue(sheetName, 11, 2, 831.5),
					new ExpectedCellValue(sheetName, 12, 2, 24.99),
					new ExpectedCellValue(sheetName, 13, 2, 1194d),
					new ExpectedCellValue(sheetName, 14, 2, 1194d),
					new ExpectedCellValue(sheetName, 15, 2, 415.75),
					new ExpectedCellValue(sheetName, 16, 2, 415.75),
					new ExpectedCellValue(sheetName, 17, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsQuartersAndMonthsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesThreeFieldsSubtotalBottom"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B25"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesThreeFieldsSubtotalBottom";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, 2016),
					new ExpectedCellValue(sheetName, 3, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 4, 1, "May"),
					new ExpectedCellValue(sheetName, 5, 1, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 6, 1, "2016 Total"),
					new ExpectedCellValue(sheetName, 7, 1, 2017),
					new ExpectedCellValue(sheetName, 8, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 9, 1, "Oct"),
					new ExpectedCellValue(sheetName, 10, 1, "Dec"),
					new ExpectedCellValue(sheetName, 11, 1, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 12, 1, "2017 Total"),
					new ExpectedCellValue(sheetName, 13, 1, 2018),
					new ExpectedCellValue(sheetName, 14, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 15, 1, "Feb"),
					new ExpectedCellValue(sheetName, 16, 1, "Mar"),
					new ExpectedCellValue(sheetName, 17, 1, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 18, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 19, 1, "May"),
					new ExpectedCellValue(sheetName, 20, 1, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 21, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 22, 1, "Nov"),
					new ExpectedCellValue(sheetName, 23, 1, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 24, 1, "2018 Total"),
					new ExpectedCellValue(sheetName, 25, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, null),
					new ExpectedCellValue(sheetName, 3, 2, null),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 5, 2, 831.5),
					new ExpectedCellValue(sheetName, 6, 2, 831.5),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, 831.5),
					new ExpectedCellValue(sheetName, 10, 2, 99d),
					new ExpectedCellValue(sheetName, 11, 2, 930.5),
					new ExpectedCellValue(sheetName, 12, 2, 930.5),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, 831.5),
					new ExpectedCellValue(sheetName, 16, 2, 24.99),
					new ExpectedCellValue(sheetName, 17, 2, 856.49),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, 1194d),
					new ExpectedCellValue(sheetName, 20, 2, 1194d),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, 415.75),
					new ExpectedCellValue(sheetName, 23, 2, 415.75),
					new ExpectedCellValue(sheetName, 24, 2, 2466.24),
					new ExpectedCellValue(sheetName, 25, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersYearsAndMonthsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsThreeFields"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:F17"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsThreeFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 5, 2018),
					new ExpectedCellValue(sheetName, 4, 5, "Feb"),
					new ExpectedCellValue(sheetName, 5, 5, "Mar"),
					new ExpectedCellValue(sheetName, 6, 5, "Qtr2"),
					new ExpectedCellValue(sheetName, 7, 5, 2016),
					new ExpectedCellValue(sheetName, 8, 5, "May"),
					new ExpectedCellValue(sheetName, 9, 5, 2018),
					new ExpectedCellValue(sheetName, 10, 5, "May"),
					new ExpectedCellValue(sheetName, 11, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 12, 5, 2017),
					new ExpectedCellValue(sheetName, 13, 5, "Oct"),
					new ExpectedCellValue(sheetName, 14, 5, "Dec"),
					new ExpectedCellValue(sheetName, 15, 5, 2018),
					new ExpectedCellValue(sheetName, 16, 5, "Nov"),
					new ExpectedCellValue(sheetName, 17, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 6, 856.49),
					new ExpectedCellValue(sheetName, 3, 6, 856.49),
					new ExpectedCellValue(sheetName, 4, 6, 831.5),
					new ExpectedCellValue(sheetName, 5, 6, 24.99),
					new ExpectedCellValue(sheetName, 6, 6, 2025.5),
					new ExpectedCellValue(sheetName, 7, 6, 831.5),
					new ExpectedCellValue(sheetName, 8, 6, 831.5),
					new ExpectedCellValue(sheetName, 9, 6, 1194d),
					new ExpectedCellValue(sheetName, 10, 6, 1194d),
					new ExpectedCellValue(sheetName, 11, 6, 1346.25),
					new ExpectedCellValue(sheetName, 12, 6, 930.5),
					new ExpectedCellValue(sheetName, 13, 6, 831.5),
					new ExpectedCellValue(sheetName, 14, 6, 99d),
					new ExpectedCellValue(sheetName, 15, 6, 415.75),
					new ExpectedCellValue(sheetName, 16, 6, 415.75),
					new ExpectedCellValue(sheetName, 17, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersYearsAndMonthsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesThreeFieldsSubtotalBottom"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:F25"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesThreeFieldsSubtotalBottom";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 5, 2018),
					new ExpectedCellValue(sheetName, 4, 5, "Feb"),
					new ExpectedCellValue(sheetName, 5, 5, "Mar"),
					new ExpectedCellValue(sheetName, 6, 5, "2018 Total"),
					new ExpectedCellValue(sheetName, 7, 5, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 8, 5, "Qtr2"),
					new ExpectedCellValue(sheetName, 9, 5, 2016),
					new ExpectedCellValue(sheetName, 10, 5, "May"),
					new ExpectedCellValue(sheetName, 11, 5, "2016 Total"),
					new ExpectedCellValue(sheetName, 12, 5, 2018),
					new ExpectedCellValue(sheetName, 13, 5, "May"),
					new ExpectedCellValue(sheetName, 14, 5, "2018 Total"),
					new ExpectedCellValue(sheetName, 15, 5, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 16, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 17, 5, 2017),
					new ExpectedCellValue(sheetName, 18, 5, "Oct"),
					new ExpectedCellValue(sheetName, 19, 5, "Dec"),
					new ExpectedCellValue(sheetName, 20, 5, "2017 Total"),
					new ExpectedCellValue(sheetName, 21, 5, 2018),
					new ExpectedCellValue(sheetName, 22, 5, "Nov"),
					new ExpectedCellValue(sheetName, 23, 5, "2018 Total"),
					new ExpectedCellValue(sheetName, 24, 5, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 25, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 6, null),
					new ExpectedCellValue(sheetName, 3, 6, null),
					new ExpectedCellValue(sheetName, 4, 6, 831.5),
					new ExpectedCellValue(sheetName, 5, 6, 24.99),
					new ExpectedCellValue(sheetName, 6, 6, 856.49),
					new ExpectedCellValue(sheetName, 7, 6, 856.49),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, 831.5),
					new ExpectedCellValue(sheetName, 11, 6, 831.5),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, 1194d),
					new ExpectedCellValue(sheetName, 14, 6, 1194d),
					new ExpectedCellValue(sheetName, 15, 6, 2025.5),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, 831.5),
					new ExpectedCellValue(sheetName, 19, 6, 99d),
					new ExpectedCellValue(sheetName, 20, 6, 930.5),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, 415.75),
					new ExpectedCellValue(sheetName, 23, 6, 415.75),
					new ExpectedCellValue(sheetName, 24, 6, 1346.25),
					new ExpectedCellValue(sheetName, 25, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsMonthsAndQuartersOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsThreeFields"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I1:J19"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsThreeFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, 2016),
					new ExpectedCellValue(sheetName, 3, 9, "May"),
					new ExpectedCellValue(sheetName, 4, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 5, 9, 2017),
					new ExpectedCellValue(sheetName, 6, 9, "Oct"),
					new ExpectedCellValue(sheetName, 7, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 8, 9, "Dec"),
					new ExpectedCellValue(sheetName, 9, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 10, 9, 2018),
					new ExpectedCellValue(sheetName, 11, 9, "Feb"),
					new ExpectedCellValue(sheetName, 12, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 13, 9, "Mar"),
					new ExpectedCellValue(sheetName, 14, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 15, 9, "May"),
					new ExpectedCellValue(sheetName, 16, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 17, 9, "Nov"),
					new ExpectedCellValue(sheetName, 18, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 19, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 10, 831.5),
					new ExpectedCellValue(sheetName, 3, 10, 831.5),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 5, 10, 930.5),
					new ExpectedCellValue(sheetName, 6, 10, 831.5),
					new ExpectedCellValue(sheetName, 7, 10, 831.5),
					new ExpectedCellValue(sheetName, 8, 10, 99d),
					new ExpectedCellValue(sheetName, 9, 10, 99d),
					new ExpectedCellValue(sheetName, 10, 10, 2466.24),
					new ExpectedCellValue(sheetName, 11, 10, 831.5),
					new ExpectedCellValue(sheetName, 12, 10, 831.5),
					new ExpectedCellValue(sheetName, 13, 10, 24.99),
					new ExpectedCellValue(sheetName, 14, 10, 24.99),
					new ExpectedCellValue(sheetName, 15, 10, 1194d),
					new ExpectedCellValue(sheetName, 16, 10, 1194d),
					new ExpectedCellValue(sheetName, 17, 10, 415.75),
					new ExpectedCellValue(sheetName, 18, 10, 415.75),
					new ExpectedCellValue(sheetName, 19, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingYearsMonthsAndQuartersOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesThreeFieldsSubtotalBottom"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I1:J29"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesThreeFieldsSubtotalBottom";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, 2016),
					new ExpectedCellValue(sheetName, 3, 9, "May"),
					new ExpectedCellValue(sheetName, 4, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 5, 9, "May Total"),
					new ExpectedCellValue(sheetName, 6, 9, "2016 Total"),
					new ExpectedCellValue(sheetName, 7, 9, 2017),
					new ExpectedCellValue(sheetName, 8, 9, "Oct"),
					new ExpectedCellValue(sheetName, 9, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 10, 9, "Oct Total"),
					new ExpectedCellValue(sheetName, 11, 9, "Dec"),
					new ExpectedCellValue(sheetName, 12, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 13, 9, "Dec Total"),
					new ExpectedCellValue(sheetName, 14, 9, "2017 Total"),
					new ExpectedCellValue(sheetName, 15, 9, 2018),
					new ExpectedCellValue(sheetName, 16, 9, "Feb"),
					new ExpectedCellValue(sheetName, 17, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 18, 9, "Feb Total"),
					new ExpectedCellValue(sheetName, 19, 9, "Mar"),
					new ExpectedCellValue(sheetName, 20, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 21, 9, "Mar Total"),
					new ExpectedCellValue(sheetName, 22, 9, "May"),
					new ExpectedCellValue(sheetName, 23, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 24, 9, "May Total"),
					new ExpectedCellValue(sheetName, 25, 9, "Nov"),
					new ExpectedCellValue(sheetName, 26, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 27, 9, "Nov Total"),
					new ExpectedCellValue(sheetName, 28, 9, "2018 Total"),
					new ExpectedCellValue(sheetName, 29, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 10, null),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, 831.5),
					new ExpectedCellValue(sheetName, 5, 10, 831.5),
					new ExpectedCellValue(sheetName, 6, 10, 831.5),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, 831.5),
					new ExpectedCellValue(sheetName, 10, 10, 831.5),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, 99d),
					new ExpectedCellValue(sheetName, 13, 10, 99d),
					new ExpectedCellValue(sheetName, 14, 10, 930.5),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, 831.5),
					new ExpectedCellValue(sheetName, 18, 10, 831.5),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, 24.99),
					new ExpectedCellValue(sheetName, 21, 10, 24.99),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, 1194d),
					new ExpectedCellValue(sheetName, 24, 10, 1194d),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, 415.75),
					new ExpectedCellValue(sheetName, 27, 10, 415.75),
					new ExpectedCellValue(sheetName, 28, 10, 2466.24),
					new ExpectedCellValue(sheetName, 29, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersMonthsAndYearsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsThreeFields"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M1:N18"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsThreeFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 13, "Feb"),
					new ExpectedCellValue(sheetName, 4, 13, 2018),
					new ExpectedCellValue(sheetName, 5, 13, "Mar"),
					new ExpectedCellValue(sheetName, 6, 13, 2018),
					new ExpectedCellValue(sheetName, 7, 13, "Qtr2"),
					new ExpectedCellValue(sheetName, 8, 13, "May"),
					new ExpectedCellValue(sheetName, 9, 13, 2016),
					new ExpectedCellValue(sheetName, 10, 13, 2018),
					new ExpectedCellValue(sheetName, 11, 13, "Qtr4"),
					new ExpectedCellValue(sheetName, 12, 13, "Oct"),
					new ExpectedCellValue(sheetName, 13, 13, 2017),
					new ExpectedCellValue(sheetName, 14, 13, "Nov"),
					new ExpectedCellValue(sheetName, 15, 13, 2018),
					new ExpectedCellValue(sheetName, 16, 13, "Dec"),
					new ExpectedCellValue(sheetName, 17, 13, 2017),
					new ExpectedCellValue(sheetName, 18, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 14, 856.49),
					new ExpectedCellValue(sheetName, 3, 14, 831.5),
					new ExpectedCellValue(sheetName, 4, 14, 831.5),
					new ExpectedCellValue(sheetName, 5, 14, 24.99),
					new ExpectedCellValue(sheetName, 6, 14, 24.99),
					new ExpectedCellValue(sheetName, 7, 14, 2025.5),
					new ExpectedCellValue(sheetName, 8, 14, 2025.5),
					new ExpectedCellValue(sheetName, 9, 14, 831.5),
					new ExpectedCellValue(sheetName, 10, 14, 1194d),
					new ExpectedCellValue(sheetName, 11, 14, 1346.25),
					new ExpectedCellValue(sheetName, 12, 14, 831.5),
					new ExpectedCellValue(sheetName, 13, 14, 831.5),
					new ExpectedCellValue(sheetName, 14, 14, 415.75),
					new ExpectedCellValue(sheetName, 15, 14, 415.75),
					new ExpectedCellValue(sheetName, 16, 14, 99d),
					new ExpectedCellValue(sheetName, 17, 14, 99d),
					new ExpectedCellValue(sheetName, 18, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingQuartersMonthsAndYearsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesThreeFieldsSubtotalBottom"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("M1:N27"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesThreeFieldsSubtotalBottom";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 13, "Qtr1"),
					new ExpectedCellValue(sheetName, 3, 13, "Feb"),
					new ExpectedCellValue(sheetName, 4, 13, 2018),
					new ExpectedCellValue(sheetName, 5, 13, "Feb Total"),
					new ExpectedCellValue(sheetName, 6, 13, "Mar"),
					new ExpectedCellValue(sheetName, 7, 13, 2018),
					new ExpectedCellValue(sheetName, 8, 13, "Mar Total"),
					new ExpectedCellValue(sheetName, 9, 13, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 10, 13, "Qtr2"),
					new ExpectedCellValue(sheetName, 11, 13, "May"),
					new ExpectedCellValue(sheetName, 12, 13, 2016),
					new ExpectedCellValue(sheetName, 13, 13, 2018),
					new ExpectedCellValue(sheetName, 14, 13, "May Total"),
					new ExpectedCellValue(sheetName, 15, 13, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 16, 13, "Qtr4"),
					new ExpectedCellValue(sheetName, 17, 13, "Oct"),
					new ExpectedCellValue(sheetName, 18, 13, 2017),
					new ExpectedCellValue(sheetName, 19, 13, "Oct Total"),
					new ExpectedCellValue(sheetName, 20, 13, "Nov"),
					new ExpectedCellValue(sheetName, 21, 13, 2018),
					new ExpectedCellValue(sheetName, 22, 13, "Nov Total"),
					new ExpectedCellValue(sheetName, 23, 13, "Dec"),
					new ExpectedCellValue(sheetName, 24, 13, 2017),
					new ExpectedCellValue(sheetName, 25, 13, "Dec Total"),
					new ExpectedCellValue(sheetName, 26, 13, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 27, 13, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 14, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 14, null),
					new ExpectedCellValue(sheetName, 3, 14, null),
					new ExpectedCellValue(sheetName, 4, 14, 831.5),
					new ExpectedCellValue(sheetName, 5, 14, 831.5),
					new ExpectedCellValue(sheetName, 6, 14, null),
					new ExpectedCellValue(sheetName, 7, 14, 24.99),
					new ExpectedCellValue(sheetName, 8, 14, 24.99),
					new ExpectedCellValue(sheetName, 9, 14, 856.49),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, 831.5),
					new ExpectedCellValue(sheetName, 13, 14, 1194d),
					new ExpectedCellValue(sheetName, 14, 14, 2025.5),
					new ExpectedCellValue(sheetName, 15, 14, 2025.5),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, 831.5),
					new ExpectedCellValue(sheetName, 19, 14, 831.5),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, 415.75),
					new ExpectedCellValue(sheetName, 22, 14, 415.75),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, 99d),
					new ExpectedCellValue(sheetName, 25, 14, 99d),
					new ExpectedCellValue(sheetName, 26, 14, 1346.25),
					new ExpectedCellValue(sheetName, 27, 14, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsYearsAndQuartersOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsThreeFields"];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q1:R22"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsThreeFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 17, "Feb"),
					new ExpectedCellValue(sheetName, 3, 17, 2018),
					new ExpectedCellValue(sheetName, 4, 17, "Qtr1"),
					new ExpectedCellValue(sheetName, 5, 17, "Mar"),
					new ExpectedCellValue(sheetName, 6, 17, 2018),
					new ExpectedCellValue(sheetName, 7, 17, "Qtr1"),
					new ExpectedCellValue(sheetName, 8, 17, "May"),
					new ExpectedCellValue(sheetName, 9, 17, 2016),
					new ExpectedCellValue(sheetName, 10, 17, "Qtr2"),
					new ExpectedCellValue(sheetName, 11, 17, 2018),
					new ExpectedCellValue(sheetName, 12, 17, "Qtr2"),
					new ExpectedCellValue(sheetName, 13, 17, "Oct"),
					new ExpectedCellValue(sheetName, 14, 17, 2017),
					new ExpectedCellValue(sheetName, 15, 17, "Qtr4"),
					new ExpectedCellValue(sheetName, 16, 17, "Nov"),
					new ExpectedCellValue(sheetName, 17, 17, 2018),
					new ExpectedCellValue(sheetName, 18, 17, "Qtr4"),
					new ExpectedCellValue(sheetName, 19, 17, "Dec"),
					new ExpectedCellValue(sheetName, 20, 17, 2017),
					new ExpectedCellValue(sheetName, 21, 17, "Qtr4"),
					new ExpectedCellValue(sheetName, 22, 17, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 18, 831.5),
					new ExpectedCellValue(sheetName, 3, 18, 831.5),
					new ExpectedCellValue(sheetName, 4, 18, 831.5),
					new ExpectedCellValue(sheetName, 5, 18, 24.99),
					new ExpectedCellValue(sheetName, 6, 18, 24.99),
					new ExpectedCellValue(sheetName, 7, 18, 24.99),
					new ExpectedCellValue(sheetName, 8, 18, 2025.5),
					new ExpectedCellValue(sheetName, 9, 18, 831.5),
					new ExpectedCellValue(sheetName, 10, 18, 831.5),
					new ExpectedCellValue(sheetName, 11, 18, 1194d),
					new ExpectedCellValue(sheetName, 12, 18, 1194d),
					new ExpectedCellValue(sheetName, 13, 18, 831.5),
					new ExpectedCellValue(sheetName, 14, 18, 831.5),
					new ExpectedCellValue(sheetName, 15, 18, 831.5),
					new ExpectedCellValue(sheetName, 16, 18, 415.75),
					new ExpectedCellValue(sheetName, 17, 18, 415.75),
					new ExpectedCellValue(sheetName, 18, 18, 415.75),
					new ExpectedCellValue(sheetName, 19, 18, 99d),
					new ExpectedCellValue(sheetName, 20, 18, 99d),
					new ExpectedCellValue(sheetName, 21, 18, 99d),
					new ExpectedCellValue(sheetName, 22, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsYearsAndQuartersOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesThreeFieldsSubtotalBottom"];
					var pivotTable = worksheet.PivotTables["PivotTable5"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("Q1:R35"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesThreeFieldsSubtotalBottom";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 17, "Feb"),
					new ExpectedCellValue(sheetName, 3, 17, 2018),
					new ExpectedCellValue(sheetName, 4, 17, "Qtr1"),
					new ExpectedCellValue(sheetName, 5, 17, "2018 Total"),
					new ExpectedCellValue(sheetName, 6, 17, "Feb Total"),
					new ExpectedCellValue(sheetName, 7, 17, "Mar"),
					new ExpectedCellValue(sheetName, 8, 17, 2018),
					new ExpectedCellValue(sheetName, 9, 17, "Qtr1"),
					new ExpectedCellValue(sheetName, 10, 17, "2018 Total"),
					new ExpectedCellValue(sheetName, 11, 17, "Mar Total"),
					new ExpectedCellValue(sheetName, 12, 17, "May"),
					new ExpectedCellValue(sheetName, 13, 17, 2016),
					new ExpectedCellValue(sheetName, 14, 17, "Qtr2"),
					new ExpectedCellValue(sheetName, 15, 17, "2016 Total"),
					new ExpectedCellValue(sheetName, 16, 17, 2018),
					new ExpectedCellValue(sheetName, 17, 17, "Qtr2"),
					new ExpectedCellValue(sheetName, 18, 17, "2018 Total"),
					new ExpectedCellValue(sheetName, 19, 17, "May Total"),
					new ExpectedCellValue(sheetName, 20, 17, "Oct"),
					new ExpectedCellValue(sheetName, 21, 17, 2017),
					new ExpectedCellValue(sheetName, 22, 17, "Qtr4"),
					new ExpectedCellValue(sheetName, 23, 17, "2017 Total"),
					new ExpectedCellValue(sheetName, 24, 17, "Oct Total"),
					new ExpectedCellValue(sheetName, 25, 17, "Nov"),
					new ExpectedCellValue(sheetName, 26, 17, 2018),
					new ExpectedCellValue(sheetName, 27, 17, "Qtr4"),
					new ExpectedCellValue(sheetName, 28, 17, "2018 Total"),
					new ExpectedCellValue(sheetName, 29, 17, "Nov Total"),
					new ExpectedCellValue(sheetName, 30, 17, "Dec"),
					new ExpectedCellValue(sheetName, 31, 17, 2017),
					new ExpectedCellValue(sheetName, 32, 17, "Qtr4"),
					new ExpectedCellValue(sheetName, 33, 17, "2017 Total"),
					new ExpectedCellValue(sheetName, 34, 17, "Dec Total"),
					new ExpectedCellValue(sheetName, 35, 17, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 18, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 18, null),
					new ExpectedCellValue(sheetName, 3, 18, null),
					new ExpectedCellValue(sheetName, 4, 18, 831.5),
					new ExpectedCellValue(sheetName, 5, 18, 831.5),
					new ExpectedCellValue(sheetName, 6, 18, 831.5),
					new ExpectedCellValue(sheetName, 7, 18, null),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, 24.99),
					new ExpectedCellValue(sheetName, 10, 18, 24.99),
					new ExpectedCellValue(sheetName, 11, 18, 24.99),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, 831.5),
					new ExpectedCellValue(sheetName, 15, 18, 831.5),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, 1194d),
					new ExpectedCellValue(sheetName, 18, 18, 1194d),
					new ExpectedCellValue(sheetName, 19, 18, 2025.5),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, 831.5),
					new ExpectedCellValue(sheetName, 23, 18, 831.5),
					new ExpectedCellValue(sheetName, 24, 18, 831.5),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, 415.75),
					new ExpectedCellValue(sheetName, 28, 18, 415.75),
					new ExpectedCellValue(sheetName, 29, 18, 415.75),
					new ExpectedCellValue(sheetName, 30, 18, null),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, 99d),
					new ExpectedCellValue(sheetName, 33, 18, 99d),
					new ExpectedCellValue(sheetName, 34, 18, 99d),
					new ExpectedCellValue(sheetName, 35, 18, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsQuartersAndYearsOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesWithoutColumnsThreeFields"];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("U1:V21"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesWithoutColumnsThreeFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 21, "Feb"),
					new ExpectedCellValue(sheetName, 3, 21, "Qtr1"),
					new ExpectedCellValue(sheetName, 4, 21, 2018),
					new ExpectedCellValue(sheetName, 5, 21, "Mar"),
					new ExpectedCellValue(sheetName, 6, 21, "Qtr1"),
					new ExpectedCellValue(sheetName, 7, 21, 2018),
					new ExpectedCellValue(sheetName, 8, 21, "May"),
					new ExpectedCellValue(sheetName, 9, 21, "Qtr2"),
					new ExpectedCellValue(sheetName, 10, 21, 2016),
					new ExpectedCellValue(sheetName, 11, 21, 2018),
					new ExpectedCellValue(sheetName, 12, 21, "Oct"),
					new ExpectedCellValue(sheetName, 13, 21, "Qtr4"),
					new ExpectedCellValue(sheetName, 14, 21, 2017),
					new ExpectedCellValue(sheetName, 15, 21, "Nov"),
					new ExpectedCellValue(sheetName, 16, 21, "Qtr4"),
					new ExpectedCellValue(sheetName, 17, 21, 2018),
					new ExpectedCellValue(sheetName, 18, 21, "Dec"),
					new ExpectedCellValue(sheetName, 19, 21, "Qtr4"),
					new ExpectedCellValue(sheetName, 20, 21, 2017),
					new ExpectedCellValue(sheetName, 21, 21, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 22, 831.5),
					new ExpectedCellValue(sheetName, 3, 22, 831.5),
					new ExpectedCellValue(sheetName, 4, 22, 831.5),
					new ExpectedCellValue(sheetName, 5, 22, 24.99),
					new ExpectedCellValue(sheetName, 6, 22, 24.99),
					new ExpectedCellValue(sheetName, 7, 22, 24.99),
					new ExpectedCellValue(sheetName, 8, 22, 2025.5),
					new ExpectedCellValue(sheetName, 9, 22, 2025.5),
					new ExpectedCellValue(sheetName, 10, 22, 831.5),
					new ExpectedCellValue(sheetName, 11, 22, 1194d),
					new ExpectedCellValue(sheetName, 12, 22, 831.5),
					new ExpectedCellValue(sheetName, 13, 22, 831.5),
					new ExpectedCellValue(sheetName, 14, 22, 831.5),
					new ExpectedCellValue(sheetName, 15, 22, 415.75),
					new ExpectedCellValue(sheetName, 16, 22, 415.75),
					new ExpectedCellValue(sheetName, 17, 22, 415.75),
					new ExpectedCellValue(sheetName, 18, 22, 99d),
					new ExpectedCellValue(sheetName, 19, 22, 99d),
					new ExpectedCellValue(sheetName, 20, 22, 99d),
					new ExpectedCellValue(sheetName, 21, 22, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsOnly.xlsx")]
		public void PivotTableRefreshDateGroupingMonthsQuartersAndYearsOnlyNoColumnFieldsSubtotalBottom()
		{
			var file = new FileInfo("PivotTableDateGroupingsOnly.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["DatesThreeFieldsSubtotalBottom"];
					var pivotTable = worksheet.PivotTables["PivotTable6"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("U1:V33"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "DatesThreeFieldsSubtotalBottom";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 21, "Feb"),
					new ExpectedCellValue(sheetName, 3, 21, "Qtr1"),
					new ExpectedCellValue(sheetName, 4, 21, 2018),
					new ExpectedCellValue(sheetName, 5, 21, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 6, 21, "Feb Total"),
					new ExpectedCellValue(sheetName, 7, 21, "Mar"),
					new ExpectedCellValue(sheetName, 8, 21, "Qtr1"),
					new ExpectedCellValue(sheetName, 9, 21, 2018),
					new ExpectedCellValue(sheetName, 10, 21, "Qtr1 Total"),
					new ExpectedCellValue(sheetName, 11, 21, "Mar Total"),
					new ExpectedCellValue(sheetName, 12, 21, "May"),
					new ExpectedCellValue(sheetName, 13, 21, "Qtr2"),
					new ExpectedCellValue(sheetName, 14, 21, 2016),
					new ExpectedCellValue(sheetName, 15, 21, 2018),
					new ExpectedCellValue(sheetName, 16, 21, "Qtr2 Total"),
					new ExpectedCellValue(sheetName, 17, 21, "May Total"),
					new ExpectedCellValue(sheetName, 18, 21, "Oct"),
					new ExpectedCellValue(sheetName, 19, 21, "Qtr4"),
					new ExpectedCellValue(sheetName, 20, 21, 2017),
					new ExpectedCellValue(sheetName, 21, 21, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 22, 21, "Oct Total"),
					new ExpectedCellValue(sheetName, 23, 21, "Nov"),
					new ExpectedCellValue(sheetName, 24, 21, "Qtr4"),
					new ExpectedCellValue(sheetName, 25, 21, 2018),
					new ExpectedCellValue(sheetName, 26, 21, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 27, 21, "Nov Total"),
					new ExpectedCellValue(sheetName, 28, 21, "Dec"),
					new ExpectedCellValue(sheetName, 29, 21, "Qtr4"),
					new ExpectedCellValue(sheetName, 30, 21, 2017),
					new ExpectedCellValue(sheetName, 31, 21, "Qtr4 Total"),
					new ExpectedCellValue(sheetName, 32, 21, "Dec Total"),
					new ExpectedCellValue(sheetName, 33, 21, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 22, null),
					new ExpectedCellValue(sheetName, 3, 22, null),
					new ExpectedCellValue(sheetName, 4, 22, 831.5),
					new ExpectedCellValue(sheetName, 5, 22, 831.5),
					new ExpectedCellValue(sheetName, 6, 22, 831.5),
					new ExpectedCellValue(sheetName, 7, 22, null),
					new ExpectedCellValue(sheetName, 8, 22, null),
					new ExpectedCellValue(sheetName, 9, 22, 24.99),
					new ExpectedCellValue(sheetName, 10, 22, 24.99),
					new ExpectedCellValue(sheetName, 11, 22, 24.99),
					new ExpectedCellValue(sheetName, 12, 22, null),
					new ExpectedCellValue(sheetName, 13, 22, null),
					new ExpectedCellValue(sheetName, 14, 22, 831.5),
					new ExpectedCellValue(sheetName, 15, 22, 1194d),
					new ExpectedCellValue(sheetName, 16, 22, 2025.5),
					new ExpectedCellValue(sheetName, 17, 22, 2025.5),
					new ExpectedCellValue(sheetName, 18, 22, null),
					new ExpectedCellValue(sheetName, 19, 22, null),
					new ExpectedCellValue(sheetName, 20, 22, 831.5),
					new ExpectedCellValue(sheetName, 21, 22, 831.5),
					new ExpectedCellValue(sheetName, 22, 22, 831.5),
					new ExpectedCellValue(sheetName, 23, 22, null),
					new ExpectedCellValue(sheetName, 24, 22, null),
					new ExpectedCellValue(sheetName, 25, 22, 415.75),
					new ExpectedCellValue(sheetName, 26, 22, 415.75),
					new ExpectedCellValue(sheetName, 27, 22, 415.75),
					new ExpectedCellValue(sheetName, 28, 22, null),
					new ExpectedCellValue(sheetName, 29, 22, null),
					new ExpectedCellValue(sheetName, 30, 22, 99d),
					new ExpectedCellValue(sheetName, 31, 22, 99d),
					new ExpectedCellValue(sheetName, 32, 22, 99d),
					new ExpectedCellValue(sheetName, 33, 22, 4228.24)
				});
			}
		}

		// One Non-Date Grouping With Date Groupings And No Column Fields
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingOneNonDateGroupingParentNodeNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowFieldsDateGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B19"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowFieldsDateGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 3, 1, "Mar"),
					new ExpectedCellValue(sheetName, 4, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 5, 1, "May"),
					new ExpectedCellValue(sheetName, 6, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 7, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 8, 1, "Feb"),
					new ExpectedCellValue(sheetName, 9, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 10, 1, "May"),
					new ExpectedCellValue(sheetName, 11, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 12, 1, "Oct"),
					new ExpectedCellValue(sheetName, 13, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 14, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 15, 1, "Nov"),
					new ExpectedCellValue(sheetName, 16, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 17, 1, "Dec"),
					new ExpectedCellValue(sheetName, 18, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 19, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, 856.49),
					new ExpectedCellValue(sheetName, 3, 2, 24.99),
					new ExpectedCellValue(sheetName, 4, 2, 24.99),
					new ExpectedCellValue(sheetName, 5, 2, 831.5),
					new ExpectedCellValue(sheetName, 6, 2, 831.5),
					new ExpectedCellValue(sheetName, 7, 2, 2857),
					new ExpectedCellValue(sheetName, 8, 2, 831.5),
					new ExpectedCellValue(sheetName, 9, 2, 831.5),
					new ExpectedCellValue(sheetName, 10, 2, 1194d),
					new ExpectedCellValue(sheetName, 11, 2, 1194d),
					new ExpectedCellValue(sheetName, 12, 2, 831.5),
					new ExpectedCellValue(sheetName, 13, 2, 831.5),
					new ExpectedCellValue(sheetName, 14, 2, 514.75),
					new ExpectedCellValue(sheetName, 15, 2, 415.75),
					new ExpectedCellValue(sheetName, 16, 2, 415.75),
					new ExpectedCellValue(sheetName, 17, 2, 99d),
					new ExpectedCellValue(sheetName, 18, 2, 99d),
					new ExpectedCellValue(sheetName, 19, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingOneNonDateGroupingLeafNodeNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowFieldsDateGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:F21"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowFieldsDateGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 5, "Feb"),
					new ExpectedCellValue(sheetName, 3, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 4, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 5, 5, "Mar"),
					new ExpectedCellValue(sheetName, 6, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 7, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 8, 5, "May"),
					new ExpectedCellValue(sheetName, 9, 5, "Qtr2"),
					new ExpectedCellValue(sheetName, 10, 5, "Chicago"),
					new ExpectedCellValue(sheetName, 11, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 12, 5, "Oct"),
					new ExpectedCellValue(sheetName, 13, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 14, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 15, 5, "Nov"),
					new ExpectedCellValue(sheetName, 16, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 17, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 18, 5, "Dec"),
					new ExpectedCellValue(sheetName, 19, 5, "Qtr4"),
					new ExpectedCellValue(sheetName, 20, 5, "San Francisco"),
					new ExpectedCellValue(sheetName, 21, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 6, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 6, 831.5),
					new ExpectedCellValue(sheetName, 3, 6, 831.5),
					new ExpectedCellValue(sheetName, 4, 6, 831.5),
					new ExpectedCellValue(sheetName, 5, 6, 24.99),
					new ExpectedCellValue(sheetName, 6, 6, 24.99),
					new ExpectedCellValue(sheetName, 7, 6, 24.99),
					new ExpectedCellValue(sheetName, 8, 6, 2025.5),
					new ExpectedCellValue(sheetName, 9, 6, 2025.5),
					new ExpectedCellValue(sheetName, 10, 6, 831.5),
					new ExpectedCellValue(sheetName, 11, 6, 1194d),
					new ExpectedCellValue(sheetName, 12, 6, 831.5),
					new ExpectedCellValue(sheetName, 13, 6, 831.5),
					new ExpectedCellValue(sheetName, 14, 6, 831.5),
					new ExpectedCellValue(sheetName, 15, 6, 415.75),
					new ExpectedCellValue(sheetName, 16, 6, 415.75),
					new ExpectedCellValue(sheetName, 17, 6, 415.75),
					new ExpectedCellValue(sheetName, 18, 6, 99d),
					new ExpectedCellValue(sheetName, 19, 6, 99d),
					new ExpectedCellValue(sheetName, 20, 6, 99d),
					new ExpectedCellValue(sheetName, 21, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingTwoNonDateGroupingsNoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowFieldsDateGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("I1:J29"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowFieldsDateGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 9, "Feb"),
					new ExpectedCellValue(sheetName, 3, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 5, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 9, "Mar"),
					new ExpectedCellValue(sheetName, 7, 9, "Headlamp"),
					new ExpectedCellValue(sheetName, 8, 9, "Qtr1"),
					new ExpectedCellValue(sheetName, 9, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 10, 9, "May"),
					new ExpectedCellValue(sheetName, 11, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 12, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 13, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 14, 9, "Tent"),
					new ExpectedCellValue(sheetName, 15, 9, "Qtr2"),
					new ExpectedCellValue(sheetName, 16, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 9, "Oct"),
					new ExpectedCellValue(sheetName, 18, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 20, 9, "Nashville"),
					new ExpectedCellValue(sheetName, 21, 9, "Nov"),
					new ExpectedCellValue(sheetName, 22, 9, "Car Rack"),
					new ExpectedCellValue(sheetName, 23, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 24, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 25, 9, "Dec"),
					new ExpectedCellValue(sheetName, 26, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 27, 9, "Qtr4"),
					new ExpectedCellValue(sheetName, 28, 9, "San Francisco"),
					new ExpectedCellValue(sheetName, 29, 9, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 10, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 10, 831.5),
					new ExpectedCellValue(sheetName, 3, 10, 831.5),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, 831.5),
					new ExpectedCellValue(sheetName, 6, 10, 24.99),
					new ExpectedCellValue(sheetName, 7, 10, 24.99),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, 24.99),
					new ExpectedCellValue(sheetName, 10, 10, 2025.5),
					new ExpectedCellValue(sheetName, 11, 10, 831.5),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, 831.5),
					new ExpectedCellValue(sheetName, 14, 10, 1194d),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, 1194d),
					new ExpectedCellValue(sheetName, 17, 10, 831.5),
					new ExpectedCellValue(sheetName, 18, 10, 831.5),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, 831.5),
					new ExpectedCellValue(sheetName, 21, 10, 415.75),
					new ExpectedCellValue(sheetName, 22, 10, 415.75),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, 415.75),
					new ExpectedCellValue(sheetName, 25, 10, 99d),
					new ExpectedCellValue(sheetName, 26, 10, 99d),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, 99d),
					new ExpectedCellValue(sheetName, 29, 10, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingRowFieldDateGroupingsOneColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnDateGroupings"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:F22"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnDateGroupings";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 1, "Feb"),
					new ExpectedCellValue(sheetName, 4, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 5, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 6, 1, "Mar"),
					new ExpectedCellValue(sheetName, 7, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 8, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 9, 1, "May"),
					new ExpectedCellValue(sheetName, 10, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 11, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 12, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 13, 1, "Oct"),
					new ExpectedCellValue(sheetName, 14, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 15, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 16, 1, "Nov"),
					new ExpectedCellValue(sheetName, 17, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 18, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 19, 1, "Dec"),
					new ExpectedCellValue(sheetName, 20, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 21, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 22, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 3, 2, 831.5),
					new ExpectedCellValue(sheetName, 4, 2, 831.5),
					new ExpectedCellValue(sheetName, 5, 2, 831.5),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, null),
					new ExpectedCellValue(sheetName, 9, 2, 831.5),
					new ExpectedCellValue(sheetName, 10, 2, 831.5),
					new ExpectedCellValue(sheetName, 11, 2, 831.5),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, 831.5),
					new ExpectedCellValue(sheetName, 14, 2, 831.5),
					new ExpectedCellValue(sheetName, 15, 2, 831.5),
					new ExpectedCellValue(sheetName, 16, 2, 415.75),
					new ExpectedCellValue(sheetName, 17, 2, 415.75),
					new ExpectedCellValue(sheetName, 18, 2, 415.75),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, 2910.25),
					new ExpectedCellValue(sheetName, 2, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, null),
					new ExpectedCellValue(sheetName, 6, 3, 24.99),
					new ExpectedCellValue(sheetName, 7, 3, 24.99),
					new ExpectedCellValue(sheetName, 8, 3, 24.99),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, 24.99),
					new ExpectedCellValue(sheetName, 2, 4, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, null),
					new ExpectedCellValue(sheetName, 5, 4, null),
					new ExpectedCellValue(sheetName, 6, 4, null),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, 99d),
					new ExpectedCellValue(sheetName, 20, 4, 99d),
					new ExpectedCellValue(sheetName, 21, 4, 99d),
					new ExpectedCellValue(sheetName, 22, 4, 99d),
					new ExpectedCellValue(sheetName, 2, 5, "Tent"),
					new ExpectedCellValue(sheetName, 3, 5, null),
					new ExpectedCellValue(sheetName, 4, 5, null),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, null),
					new ExpectedCellValue(sheetName, 7, 5, null),
					new ExpectedCellValue(sheetName, 8, 5, null),
					new ExpectedCellValue(sheetName, 9, 5, 1194d),
					new ExpectedCellValue(sheetName, 10, 5, 1194d),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, 1194d),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, 1194d),
					new ExpectedCellValue(sheetName, 2, 6, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 6, 831.5),
					new ExpectedCellValue(sheetName, 4, 6, 831.5),
					new ExpectedCellValue(sheetName, 5, 6, 831.5),
					new ExpectedCellValue(sheetName, 6, 6, 24.99),
					new ExpectedCellValue(sheetName, 7, 6, 24.99),
					new ExpectedCellValue(sheetName, 8, 6, 24.99),
					new ExpectedCellValue(sheetName, 9, 6, 2025.5),
					new ExpectedCellValue(sheetName, 10, 6, 2025.5),
					new ExpectedCellValue(sheetName, 11, 6, 831.5),
					new ExpectedCellValue(sheetName, 12, 6, 1194d),
					new ExpectedCellValue(sheetName, 13, 6, 831.5),
					new ExpectedCellValue(sheetName, 14, 6, 831.5),
					new ExpectedCellValue(sheetName, 15, 6, 831.5),
					new ExpectedCellValue(sheetName, 16, 6, 415.75),
					new ExpectedCellValue(sheetName, 17, 6, 415.75),
					new ExpectedCellValue(sheetName, 18, 6, 415.75),
					new ExpectedCellValue(sheetName, 19, 6, 99d),
					new ExpectedCellValue(sheetName, 20, 6, 99d),
					new ExpectedCellValue(sheetName, 21, 6, 99d),
					new ExpectedCellValue(sheetName, 22, 6, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingRowFieldDateGroupingsTwoColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnDateGroupings"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A26:K44"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnDateGroupings";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 29, 1, 2016),
					new ExpectedCellValue(sheetName, 30, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 31, 1, "May"),
					new ExpectedCellValue(sheetName, 32, 1, 2017),
					new ExpectedCellValue(sheetName, 33, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 34, 1, "Oct"),
					new ExpectedCellValue(sheetName, 35, 1, "Dec"),
					new ExpectedCellValue(sheetName, 36, 1, 2018),
					new ExpectedCellValue(sheetName, 37, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 38, 1, "Feb"),
					new ExpectedCellValue(sheetName, 39, 1, "Mar"),
					new ExpectedCellValue(sheetName, 40, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 41, 1, "May"),
					new ExpectedCellValue(sheetName, 42, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 43, 1, "Nov"),
					new ExpectedCellValue(sheetName, 44, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 27, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 28, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 29, 2, 831.5),
					new ExpectedCellValue(sheetName, 30, 2, 831.5),
					new ExpectedCellValue(sheetName, 31, 2, 831.5),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, null),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, 831.5),
					new ExpectedCellValue(sheetName, 28, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, 24.99),
					new ExpectedCellValue(sheetName, 37, 3, 24.99),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, 24.99),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, 24.99),
					new ExpectedCellValue(sheetName, 27, 4, "Chicago Total"),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, 831.5),
					new ExpectedCellValue(sheetName, 30, 4, 831.5),
					new ExpectedCellValue(sheetName, 31, 4, 831.5),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, 24.99),
					new ExpectedCellValue(sheetName, 37, 4, 24.99),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, 24.99),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, 856.49),
					new ExpectedCellValue(sheetName, 27, 5, "Nashville"),
					new ExpectedCellValue(sheetName, 28, 5, "Car Rack"),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, 831.5),
					new ExpectedCellValue(sheetName, 33, 5, 831.5),
					new ExpectedCellValue(sheetName, 34, 5, 831.5),
					new ExpectedCellValue(sheetName, 35, 5, null),
					new ExpectedCellValue(sheetName, 36, 5, 831.5),
					new ExpectedCellValue(sheetName, 37, 5, 831.5),
					new ExpectedCellValue(sheetName, 38, 5, 831.5),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, 1663d),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, "Tent"),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, null),
					new ExpectedCellValue(sheetName, 35, 6, null),
					new ExpectedCellValue(sheetName, 36, 6, 1194d),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, 1194d),
					new ExpectedCellValue(sheetName, 41, 6, 1194d),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, 1194d),
					new ExpectedCellValue(sheetName, 27, 7, "Nashville Total"),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, 831.5),
					new ExpectedCellValue(sheetName, 33, 7, 831.5),
					new ExpectedCellValue(sheetName, 34, 7, 831.5),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 36, 7, 2025.5),
					new ExpectedCellValue(sheetName, 37, 7, 831.5),
					new ExpectedCellValue(sheetName, 38, 7, 831.5),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, 1194d),
					new ExpectedCellValue(sheetName, 41, 7, 1194d),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, 2857d),
					new ExpectedCellValue(sheetName, 27, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 28, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, null),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, 415.75),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, 415.75),
					new ExpectedCellValue(sheetName, 43, 8, 415.75),
					new ExpectedCellValue(sheetName, 44, 8, 415.75),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, 99d),
					new ExpectedCellValue(sheetName, 33, 9, 99d),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, 99d),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, null),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, 99d),
					new ExpectedCellValue(sheetName, 27, 10, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, 99d),
					new ExpectedCellValue(sheetName, 33, 10, 99d),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, 99d),
					new ExpectedCellValue(sheetName, 36, 10, 415.75),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, null),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, 415.75),
					new ExpectedCellValue(sheetName, 43, 10, 415.75),
					new ExpectedCellValue(sheetName, 44, 10, 514.75),
					new ExpectedCellValue(sheetName, 27, 11, "Grand Total"),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, 831.5),
					new ExpectedCellValue(sheetName, 30, 11, 831.5),
					new ExpectedCellValue(sheetName, 31, 11, 831.5),
					new ExpectedCellValue(sheetName, 32, 11, 930.5),
					new ExpectedCellValue(sheetName, 33, 11, 930.5),
					new ExpectedCellValue(sheetName, 34, 11, 831.5),
					new ExpectedCellValue(sheetName, 35, 11, 99d),
					new ExpectedCellValue(sheetName, 36, 11, 2466.24),
					new ExpectedCellValue(sheetName, 37, 11, 856.49),
					new ExpectedCellValue(sheetName, 38, 11, 831.5),
					new ExpectedCellValue(sheetName, 39, 11, 24.99),
					new ExpectedCellValue(sheetName, 40, 11, 1194d),
					new ExpectedCellValue(sheetName, 41, 11, 1194d),
					new ExpectedCellValue(sheetName, 42, 11, 415.75),
					new ExpectedCellValue(sheetName, 43, 11, 415.75),
					new ExpectedCellValue(sheetName, 44, 11, 4228.24),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingRowFieldDateGroupingsTwoColumnFieldsAndTwoColumnDataFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnDateGroupings"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A48:W67"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnDateGroupings";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 52, 1, 2016),
					new ExpectedCellValue(sheetName, 53, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 54, 1, "May"),
					new ExpectedCellValue(sheetName, 55, 1, 2017),
					new ExpectedCellValue(sheetName, 56, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 57, 1, "Oct"),
					new ExpectedCellValue(sheetName, 58, 1, "Dec"),
					new ExpectedCellValue(sheetName, 59, 1, 2018),
					new ExpectedCellValue(sheetName, 60, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 61, 1, "Feb"),
					new ExpectedCellValue(sheetName, 62, 1, "Mar"),
					new ExpectedCellValue(sheetName, 63, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 64, 1, "May"),
					new ExpectedCellValue(sheetName, 65, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 66, 1, "Nov"),
					new ExpectedCellValue(sheetName, 67, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 49, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 51, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 2, 415.75),
					new ExpectedCellValue(sheetName, 53, 2, 415.75),
					new ExpectedCellValue(sheetName, 54, 2, 415.75),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, 415.75),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 3, 831.5),
					new ExpectedCellValue(sheetName, 53, 3, 831.5),
					new ExpectedCellValue(sheetName, 54, 3, 831.5),
					new ExpectedCellValue(sheetName, 55, 3, null),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, null),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, 831.5),
					new ExpectedCellValue(sheetName, 49, 4, null),
					new ExpectedCellValue(sheetName, 50, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 51, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, 415.75),
					new ExpectedCellValue(sheetName, 56, 4, 415.75),
					new ExpectedCellValue(sheetName, 57, 4, 415.75),
					new ExpectedCellValue(sheetName, 58, 4, null),
					new ExpectedCellValue(sheetName, 59, 4, 415.75),
					new ExpectedCellValue(sheetName, 60, 4, 415.75),
					new ExpectedCellValue(sheetName, 61, 4, 415.75),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, null),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, 831.5),
					new ExpectedCellValue(sheetName, 49, 5, null),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, null),
					new ExpectedCellValue(sheetName, 55, 5, 831.5),
					new ExpectedCellValue(sheetName, 56, 5, 831.5),
					new ExpectedCellValue(sheetName, 57, 5, 831.5),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, 831.5),
					new ExpectedCellValue(sheetName, 60, 5, 831.5),
					new ExpectedCellValue(sheetName, 61, 5, 831.5),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, null),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, null),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, 1663d),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, "San Francisco"),
					new ExpectedCellValue(sheetName, 51, 6, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, null),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, 415.75),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, 415.75),
					new ExpectedCellValue(sheetName, 66, 6, 415.75),
					new ExpectedCellValue(sheetName, 67, 6, 415.75),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 7, null),
					new ExpectedCellValue(sheetName, 53, 7, null),
					new ExpectedCellValue(sheetName, 54, 7, null),
					new ExpectedCellValue(sheetName, 55, 7, null),
					new ExpectedCellValue(sheetName, 56, 7, null),
					new ExpectedCellValue(sheetName, 57, 7, null),
					new ExpectedCellValue(sheetName, 58, 7, null),
					new ExpectedCellValue(sheetName, 59, 7, 415.75),
					new ExpectedCellValue(sheetName, 60, 7, null),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, null),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, 415.75),
					new ExpectedCellValue(sheetName, 66, 7, 415.75),
					new ExpectedCellValue(sheetName, 67, 7, 415.75),
					new ExpectedCellValue(sheetName, 49, 8, "Car Rack Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, 415.75),
					new ExpectedCellValue(sheetName, 53, 8, 415.75),
					new ExpectedCellValue(sheetName, 54, 8, 415.75),
					new ExpectedCellValue(sheetName, 55, 8, 415.75),
					new ExpectedCellValue(sheetName, 56, 8, 415.75),
					new ExpectedCellValue(sheetName, 57, 8, 415.75),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, 831.5),
					new ExpectedCellValue(sheetName, 60, 8, 415.75),
					new ExpectedCellValue(sheetName, 61, 8, 415.75),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, 415.75),
					new ExpectedCellValue(sheetName, 66, 8, 415.75),
					new ExpectedCellValue(sheetName, 67, 8, 1663d),
					new ExpectedCellValue(sheetName, 49, 9, "Car Rack Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, 831.5),
					new ExpectedCellValue(sheetName, 53, 9, 831.5),
					new ExpectedCellValue(sheetName, 54, 9, 831.5),
					new ExpectedCellValue(sheetName, 55, 9, 831.5),
					new ExpectedCellValue(sheetName, 56, 9, 831.5),
					new ExpectedCellValue(sheetName, 57, 9, 831.5),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, 1247.25),
					new ExpectedCellValue(sheetName, 60, 9, 831.5),
					new ExpectedCellValue(sheetName, 61, 9, 831.5),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, 415.75),
					new ExpectedCellValue(sheetName, 66, 9, 415.75),
					new ExpectedCellValue(sheetName, 67, 9, 2910.25),
					new ExpectedCellValue(sheetName, 49, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 50, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 51, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, null),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, null),
					new ExpectedCellValue(sheetName, 58, 10, null),
					new ExpectedCellValue(sheetName, 59, 10, 24.99),
					new ExpectedCellValue(sheetName, 60, 10, 24.99),
					new ExpectedCellValue(sheetName, 61, 10, null),
					new ExpectedCellValue(sheetName, 62, 10, 24.99),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 66, 10, null),
					new ExpectedCellValue(sheetName, 67, 10, 24.99),
					new ExpectedCellValue(sheetName, 49, 11, null),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 11, null),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 54, 11, null),
					new ExpectedCellValue(sheetName, 55, 11, null),
					new ExpectedCellValue(sheetName, 56, 11, null),
					new ExpectedCellValue(sheetName, 57, 11, null),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, 24.99),
					new ExpectedCellValue(sheetName, 60, 11, 24.99),
					new ExpectedCellValue(sheetName, 61, 11, null),
					new ExpectedCellValue(sheetName, 62, 11, 24.99),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, null),
					new ExpectedCellValue(sheetName, 65, 11, null),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, 24.99),
					new ExpectedCellValue(sheetName, 49, 12, "Headlamp Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 12, null),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, null),
					new ExpectedCellValue(sheetName, 53, 12, null),
					new ExpectedCellValue(sheetName, 54, 12, null),
					new ExpectedCellValue(sheetName, 55, 12, null),
					new ExpectedCellValue(sheetName, 56, 12, null),
					new ExpectedCellValue(sheetName, 57, 12, null),
					new ExpectedCellValue(sheetName, 58, 12, null),
					new ExpectedCellValue(sheetName, 59, 12, 24.99),
					new ExpectedCellValue(sheetName, 60, 12, 24.99),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, 24.99),
					new ExpectedCellValue(sheetName, 63, 12, null),
					new ExpectedCellValue(sheetName, 64, 12, null),
					new ExpectedCellValue(sheetName, 65, 12, null),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, 24.99),
					new ExpectedCellValue(sheetName, 49, 13, "Headlamp Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 13, null),
					new ExpectedCellValue(sheetName, 51, 13, null),
					new ExpectedCellValue(sheetName, 52, 13, null),
					new ExpectedCellValue(sheetName, 53, 13, null),
					new ExpectedCellValue(sheetName, 54, 13, null),
					new ExpectedCellValue(sheetName, 55, 13, null),
					new ExpectedCellValue(sheetName, 56, 13, null),
					new ExpectedCellValue(sheetName, 57, 13, null),
					new ExpectedCellValue(sheetName, 58, 13, null),
					new ExpectedCellValue(sheetName, 59, 13, 24.99),
					new ExpectedCellValue(sheetName, 60, 13, 24.99),
					new ExpectedCellValue(sheetName, 61, 13, null),
					new ExpectedCellValue(sheetName, 62, 13, 24.99),
					new ExpectedCellValue(sheetName, 63, 13, null),
					new ExpectedCellValue(sheetName, 64, 13, null),
					new ExpectedCellValue(sheetName, 65, 13, null),
					new ExpectedCellValue(sheetName, 66, 13, null),
					new ExpectedCellValue(sheetName, 67, 13, 24.99),
					new ExpectedCellValue(sheetName, 49, 14, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 50, 14, "San Francisco"),
					new ExpectedCellValue(sheetName, 51, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, 99d),
					new ExpectedCellValue(sheetName, 56, 14, 99d),
					new ExpectedCellValue(sheetName, 57, 14, null),
					new ExpectedCellValue(sheetName, 58, 14, 99d),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, null),
					new ExpectedCellValue(sheetName, 61, 14, null),
					new ExpectedCellValue(sheetName, 62, 14, null),
					new ExpectedCellValue(sheetName, 63, 14, null),
					new ExpectedCellValue(sheetName, 64, 14, null),
					new ExpectedCellValue(sheetName, 65, 14, null),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, 99d),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 53, 15, null),
					new ExpectedCellValue(sheetName, 54, 15, null),
					new ExpectedCellValue(sheetName, 55, 15, 99d),
					new ExpectedCellValue(sheetName, 56, 15, 99d),
					new ExpectedCellValue(sheetName, 57, 15, null),
					new ExpectedCellValue(sheetName, 58, 15, 99d),
					new ExpectedCellValue(sheetName, 59, 15, null),
					new ExpectedCellValue(sheetName, 60, 15, null),
					new ExpectedCellValue(sheetName, 61, 15, null),
					new ExpectedCellValue(sheetName, 62, 15, null),
					new ExpectedCellValue(sheetName, 63, 15, null),
					new ExpectedCellValue(sheetName, 64, 15, null),
					new ExpectedCellValue(sheetName, 65, 15, null),
					new ExpectedCellValue(sheetName, 66, 15, null),
					new ExpectedCellValue(sheetName, 67, 15, 99d),
					new ExpectedCellValue(sheetName, 49, 16, "Sleeping Bag Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, null),
					new ExpectedCellValue(sheetName, 53, 16, null),
					new ExpectedCellValue(sheetName, 54, 16, null),
					new ExpectedCellValue(sheetName, 55, 16, 99d),
					new ExpectedCellValue(sheetName, 56, 16, 99d),
					new ExpectedCellValue(sheetName, 57, 16, null),
					new ExpectedCellValue(sheetName, 58, 16, 99d),
					new ExpectedCellValue(sheetName, 59, 16, null),
					new ExpectedCellValue(sheetName, 60, 16, null),
					new ExpectedCellValue(sheetName, 61, 16, null),
					new ExpectedCellValue(sheetName, 62, 16, null),
					new ExpectedCellValue(sheetName, 63, 16, null),
					new ExpectedCellValue(sheetName, 64, 16, null),
					new ExpectedCellValue(sheetName, 65, 16, null),
					new ExpectedCellValue(sheetName, 66, 16, null),
					new ExpectedCellValue(sheetName, 67, 16, 99d),
					new ExpectedCellValue(sheetName, 49, 17, "Sleeping Bag Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, null),
					new ExpectedCellValue(sheetName, 53, 17, null),
					new ExpectedCellValue(sheetName, 54, 17, null),
					new ExpectedCellValue(sheetName, 55, 17, 99d),
					new ExpectedCellValue(sheetName, 56, 17, 99d),
					new ExpectedCellValue(sheetName, 57, 17, null),
					new ExpectedCellValue(sheetName, 58, 17, 99d),
					new ExpectedCellValue(sheetName, 59, 17, null),
					new ExpectedCellValue(sheetName, 60, 17, null),
					new ExpectedCellValue(sheetName, 61, 17, null),
					new ExpectedCellValue(sheetName, 62, 17, null),
					new ExpectedCellValue(sheetName, 63, 17, null),
					new ExpectedCellValue(sheetName, 64, 17, null),
					new ExpectedCellValue(sheetName, 65, 17, null),
					new ExpectedCellValue(sheetName, 66, 17, null),
					new ExpectedCellValue(sheetName, 67, 17, 99d),
					new ExpectedCellValue(sheetName, 49, 18, "Tent"),
					new ExpectedCellValue(sheetName, 50, 18, "Nashville"),
					new ExpectedCellValue(sheetName, 51, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, null),
					new ExpectedCellValue(sheetName, 54, 18, null),
					new ExpectedCellValue(sheetName, 55, 18, null),
					new ExpectedCellValue(sheetName, 56, 18, null),
					new ExpectedCellValue(sheetName, 57, 18, null),
					new ExpectedCellValue(sheetName, 58, 18, null),
					new ExpectedCellValue(sheetName, 59, 18, 199d),
					new ExpectedCellValue(sheetName, 60, 18, null),
					new ExpectedCellValue(sheetName, 61, 18, null),
					new ExpectedCellValue(sheetName, 62, 18, null),
					new ExpectedCellValue(sheetName, 63, 18, 199d),
					new ExpectedCellValue(sheetName, 64, 18, 199d),
					new ExpectedCellValue(sheetName, 65, 18, null),
					new ExpectedCellValue(sheetName, 66, 18, null),
					new ExpectedCellValue(sheetName, 67, 18, 199d),
					new ExpectedCellValue(sheetName, 49, 19, null),
					new ExpectedCellValue(sheetName, 50, 19, null),
					new ExpectedCellValue(sheetName, 51, 19, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 19, null),
					new ExpectedCellValue(sheetName, 53, 19, null),
					new ExpectedCellValue(sheetName, 54, 19, null),
					new ExpectedCellValue(sheetName, 55, 19, null),
					new ExpectedCellValue(sheetName, 56, 19, null),
					new ExpectedCellValue(sheetName, 57, 19, null),
					new ExpectedCellValue(sheetName, 58, 19, null),
					new ExpectedCellValue(sheetName, 59, 19, 1194d),
					new ExpectedCellValue(sheetName, 60, 19, null),
					new ExpectedCellValue(sheetName, 61, 19, null),
					new ExpectedCellValue(sheetName, 62, 19, null),
					new ExpectedCellValue(sheetName, 63, 19, 1194d),
					new ExpectedCellValue(sheetName, 64, 19, 1194d),
					new ExpectedCellValue(sheetName, 65, 19, null),
					new ExpectedCellValue(sheetName, 66, 19, null),
					new ExpectedCellValue(sheetName, 67, 19, 1194d),
					new ExpectedCellValue(sheetName, 49, 20, "Tent Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, null),
					new ExpectedCellValue(sheetName, 53, 20, null),
					new ExpectedCellValue(sheetName, 54, 20, null),
					new ExpectedCellValue(sheetName, 55, 20, null),
					new ExpectedCellValue(sheetName, 56, 20, null),
					new ExpectedCellValue(sheetName, 57, 20, null),
					new ExpectedCellValue(sheetName, 58, 20, null),
					new ExpectedCellValue(sheetName, 59, 20, 199d),
					new ExpectedCellValue(sheetName, 60, 20, null),
					new ExpectedCellValue(sheetName, 61, 20, null),
					new ExpectedCellValue(sheetName, 62, 20, null),
					new ExpectedCellValue(sheetName, 63, 20, 199d),
					new ExpectedCellValue(sheetName, 64, 20, 199d),
					new ExpectedCellValue(sheetName, 65, 20, null),
					new ExpectedCellValue(sheetName, 66, 20, null),
					new ExpectedCellValue(sheetName, 67, 20, 199d),
					new ExpectedCellValue(sheetName, 49, 21, "Tent Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 21, null),
					new ExpectedCellValue(sheetName, 51, 21, null),
					new ExpectedCellValue(sheetName, 52, 21, null),
					new ExpectedCellValue(sheetName, 53, 21, null),
					new ExpectedCellValue(sheetName, 54, 21, null),
					new ExpectedCellValue(sheetName, 55, 21, null),
					new ExpectedCellValue(sheetName, 56, 21, null),
					new ExpectedCellValue(sheetName, 57, 21, null),
					new ExpectedCellValue(sheetName, 58, 21, null),
					new ExpectedCellValue(sheetName, 59, 21, 1194d),
					new ExpectedCellValue(sheetName, 60, 21, null),
					new ExpectedCellValue(sheetName, 61, 21, null),
					new ExpectedCellValue(sheetName, 62, 21, null),
					new ExpectedCellValue(sheetName, 63, 21, 1194d),
					new ExpectedCellValue(sheetName, 64, 21, 1194d),
					new ExpectedCellValue(sheetName, 65, 21, null),
					new ExpectedCellValue(sheetName, 66, 21, null),
					new ExpectedCellValue(sheetName, 67, 21, 1194d),
					new ExpectedCellValue(sheetName, 49, 22, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 50, 22, null),
					new ExpectedCellValue(sheetName, 51, 22, null),
					new ExpectedCellValue(sheetName, 52, 22, 415.75),
					new ExpectedCellValue(sheetName, 53, 22, 415.75),
					new ExpectedCellValue(sheetName, 54, 22, 415.75),
					new ExpectedCellValue(sheetName, 55, 22, 514.75),
					new ExpectedCellValue(sheetName, 56, 22, 514.75),
					new ExpectedCellValue(sheetName, 57, 22, 415.75),
					new ExpectedCellValue(sheetName, 58, 22, 99d),
					new ExpectedCellValue(sheetName, 59, 22, 1055.49),
					new ExpectedCellValue(sheetName, 60, 22, 440.74),
					new ExpectedCellValue(sheetName, 61, 22, 415.75),
					new ExpectedCellValue(sheetName, 62, 22, 24.99),
					new ExpectedCellValue(sheetName, 63, 22, 199d),
					new ExpectedCellValue(sheetName, 64, 22, 199d),
					new ExpectedCellValue(sheetName, 65, 22, 415.75),
					new ExpectedCellValue(sheetName, 66, 22, 415.75),
					new ExpectedCellValue(sheetName, 67, 22, 1985.99),
					new ExpectedCellValue(sheetName, 49, 23, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 50, 23, null),
					new ExpectedCellValue(sheetName, 51, 23, null),
					new ExpectedCellValue(sheetName, 52, 23, 831.5),
					new ExpectedCellValue(sheetName, 53, 23, 831.5),
					new ExpectedCellValue(sheetName, 54, 23, 831.5),
					new ExpectedCellValue(sheetName, 55, 23, 930.5),
					new ExpectedCellValue(sheetName, 56, 23, 930.5),
					new ExpectedCellValue(sheetName, 57, 23, 831.5),
					new ExpectedCellValue(sheetName, 58, 23, 99d),
					new ExpectedCellValue(sheetName, 59, 23, 2466.24),
					new ExpectedCellValue(sheetName, 60, 23, 856.49),
					new ExpectedCellValue(sheetName, 61, 23, 831.5),
					new ExpectedCellValue(sheetName, 62, 23, 24.99),
					new ExpectedCellValue(sheetName, 63, 23, 1194d),
					new ExpectedCellValue(sheetName, 64, 23, 1194d),
					new ExpectedCellValue(sheetName, 65, 23, 415.75),
					new ExpectedCellValue(sheetName, 66, 23, 415.75),
					new ExpectedCellValue(sheetName, 67, 23, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingsInRowFields.xlsx")]
		public void PivotTableRefreshDateGroupingRowFieldDateGroupingsTwoColumnFieldsAndTwoRowDataFields()
		{
			var file = new FileInfo("PivotTableDateGroupingsInRowFields.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowColumnDateGroupings"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A71:L120"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowColumnDateGroupings";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 74, 1, 2016),
					new ExpectedCellValue(sheetName, 75, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 76, 1, "May"),
					new ExpectedCellValue(sheetName, 77, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 78, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 79, 1, "Qtr2 Sum of Total"),
					new ExpectedCellValue(sheetName, 80, 1, "Qtr2 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 81, 1, "2016 Sum of Total"),
					new ExpectedCellValue(sheetName, 82, 1, "2016 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 83, 1, 2017),
					new ExpectedCellValue(sheetName, 84, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 85, 1, "Oct"),
					new ExpectedCellValue(sheetName, 86, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 87, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 88, 1, "Dec"),
					new ExpectedCellValue(sheetName, 89, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 90, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 91, 1, "Qtr4 Sum of Total"),
					new ExpectedCellValue(sheetName, 92, 1, "Qtr4 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 93, 1, "2017 Sum of Total"),
					new ExpectedCellValue(sheetName, 94, 1, "2017 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 95, 1, 2018),
					new ExpectedCellValue(sheetName, 96, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 97, 1, "Feb"),
					new ExpectedCellValue(sheetName, 98, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 99, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 100, 1, "Mar"),
					new ExpectedCellValue(sheetName, 101, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 102, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 103, 1, "Qtr1 Sum of Total"),
					new ExpectedCellValue(sheetName, 104, 1, "Qtr1 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 105, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 106, 1, "May"),
					new ExpectedCellValue(sheetName, 107, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 108, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 109, 1, "Qtr2 Sum of Total"),
					new ExpectedCellValue(sheetName, 110, 1, "Qtr2 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 111, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 112, 1, "Nov"),
					new ExpectedCellValue(sheetName, 113, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 114, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 115, 1, "Qtr4 Sum of Total"),
					new ExpectedCellValue(sheetName, 116, 1, "Qtr4 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 117, 1, "2018 Sum of Total"),
					new ExpectedCellValue(sheetName, 118, 1, "2018 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 119, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 120, 1, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 72, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 73, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 74, 2, null),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, null),
					new ExpectedCellValue(sheetName, 77, 2, 831.5),
					new ExpectedCellValue(sheetName, 78, 2, 415.75),
					new ExpectedCellValue(sheetName, 79, 2, 831.5),
					new ExpectedCellValue(sheetName, 80, 2, 415.75),
					new ExpectedCellValue(sheetName, 81, 2, 831.5),
					new ExpectedCellValue(sheetName, 82, 2, 415.75),
					new ExpectedCellValue(sheetName, 83, 2, null),
					new ExpectedCellValue(sheetName, 84, 2, null),
					new ExpectedCellValue(sheetName, 85, 2, null),
					new ExpectedCellValue(sheetName, 86, 2, null),
					new ExpectedCellValue(sheetName, 87, 2, null),
					new ExpectedCellValue(sheetName, 88, 2, null),
					new ExpectedCellValue(sheetName, 89, 2, null),
					new ExpectedCellValue(sheetName, 90, 2, null),
					new ExpectedCellValue(sheetName, 91, 2, null),
					new ExpectedCellValue(sheetName, 92, 2, null),
					new ExpectedCellValue(sheetName, 93, 2, null),
					new ExpectedCellValue(sheetName, 94, 2, null),
					new ExpectedCellValue(sheetName, 95, 2, null),
					new ExpectedCellValue(sheetName, 96, 2, null),
					new ExpectedCellValue(sheetName, 97, 2, null),
					new ExpectedCellValue(sheetName, 98, 2, null),
					new ExpectedCellValue(sheetName, 99, 2, null),
					new ExpectedCellValue(sheetName, 100, 2, null),
					new ExpectedCellValue(sheetName, 101, 2, null),
					new ExpectedCellValue(sheetName, 102, 2, null),
					new ExpectedCellValue(sheetName, 103, 2, null),
					new ExpectedCellValue(sheetName, 104, 2, null),
					new ExpectedCellValue(sheetName, 105, 2, null),
					new ExpectedCellValue(sheetName, 106, 2, null),
					new ExpectedCellValue(sheetName, 107, 2, null),
					new ExpectedCellValue(sheetName, 108, 2, null),
					new ExpectedCellValue(sheetName, 109, 2, null),
					new ExpectedCellValue(sheetName, 110, 2, null),
					new ExpectedCellValue(sheetName, 111, 2, null),
					new ExpectedCellValue(sheetName, 112, 2, null),
					new ExpectedCellValue(sheetName, 113, 2, null),
					new ExpectedCellValue(sheetName, 114, 2, null),
					new ExpectedCellValue(sheetName, 115, 2, null),
					new ExpectedCellValue(sheetName, 116, 2, null),
					new ExpectedCellValue(sheetName, 117, 2, null),
					new ExpectedCellValue(sheetName, 118, 2, null),
					new ExpectedCellValue(sheetName, 119, 2, 831.5),
					new ExpectedCellValue(sheetName, 120, 2, 415.75),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, null),
					new ExpectedCellValue(sheetName, 77, 3, null),
					new ExpectedCellValue(sheetName, 78, 3, null),
					new ExpectedCellValue(sheetName, 79, 3, null),
					new ExpectedCellValue(sheetName, 80, 3, null),
					new ExpectedCellValue(sheetName, 81, 3, null),
					new ExpectedCellValue(sheetName, 82, 3, null),
					new ExpectedCellValue(sheetName, 83, 3, null),
					new ExpectedCellValue(sheetName, 84, 3, null),
					new ExpectedCellValue(sheetName, 85, 3, null),
					new ExpectedCellValue(sheetName, 86, 3, 831.5),
					new ExpectedCellValue(sheetName, 87, 3, 415.75),
					new ExpectedCellValue(sheetName, 88, 3, null),
					new ExpectedCellValue(sheetName, 89, 3, null),
					new ExpectedCellValue(sheetName, 90, 3, null),
					new ExpectedCellValue(sheetName, 91, 3, 831.5),
					new ExpectedCellValue(sheetName, 92, 3, 415.75),
					new ExpectedCellValue(sheetName, 93, 3, 831.5),
					new ExpectedCellValue(sheetName, 94, 3, 415.75),
					new ExpectedCellValue(sheetName, 95, 3, null),
					new ExpectedCellValue(sheetName, 96, 3, null),
					new ExpectedCellValue(sheetName, 97, 3, null),
					new ExpectedCellValue(sheetName, 98, 3, 831.5),
					new ExpectedCellValue(sheetName, 99, 3, 415.75),
					new ExpectedCellValue(sheetName, 100, 3, null),
					new ExpectedCellValue(sheetName, 101, 3, null),
					new ExpectedCellValue(sheetName, 102, 3, null),
					new ExpectedCellValue(sheetName, 103, 3, 831.5),
					new ExpectedCellValue(sheetName, 104, 3, 415.75),
					new ExpectedCellValue(sheetName, 105, 3, null),
					new ExpectedCellValue(sheetName, 106, 3, null),
					new ExpectedCellValue(sheetName, 107, 3, null),
					new ExpectedCellValue(sheetName, 108, 3, null),
					new ExpectedCellValue(sheetName, 109, 3, null),
					new ExpectedCellValue(sheetName, 110, 3, null),
					new ExpectedCellValue(sheetName, 111, 3, null),
					new ExpectedCellValue(sheetName, 112, 3, null),
					new ExpectedCellValue(sheetName, 113, 3, null),
					new ExpectedCellValue(sheetName, 114, 3, null),
					new ExpectedCellValue(sheetName, 115, 3, null),
					new ExpectedCellValue(sheetName, 116, 3, null),
					new ExpectedCellValue(sheetName, 117, 3, 831.5),
					new ExpectedCellValue(sheetName, 118, 3, 415.75),
					new ExpectedCellValue(sheetName, 119, 3, 1663d),
					new ExpectedCellValue(sheetName, 120, 3, 831.5),
					new ExpectedCellValue(sheetName, 72, 4, null),
					new ExpectedCellValue(sheetName, 73, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 74, 4, null),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, null),
					new ExpectedCellValue(sheetName, 77, 4, null),
					new ExpectedCellValue(sheetName, 78, 4, null),
					new ExpectedCellValue(sheetName, 79, 4, null),
					new ExpectedCellValue(sheetName, 80, 4, null),
					new ExpectedCellValue(sheetName, 81, 4, null),
					new ExpectedCellValue(sheetName, 82, 4, null),
					new ExpectedCellValue(sheetName, 83, 4, null),
					new ExpectedCellValue(sheetName, 84, 4, null),
					new ExpectedCellValue(sheetName, 85, 4, null),
					new ExpectedCellValue(sheetName, 86, 4, null),
					new ExpectedCellValue(sheetName, 87, 4, null),
					new ExpectedCellValue(sheetName, 88, 4, null),
					new ExpectedCellValue(sheetName, 89, 4, null),
					new ExpectedCellValue(sheetName, 90, 4, null),
					new ExpectedCellValue(sheetName, 91, 4, null),
					new ExpectedCellValue(sheetName, 92, 4, null),
					new ExpectedCellValue(sheetName, 93, 4, null),
					new ExpectedCellValue(sheetName, 94, 4, null),
					new ExpectedCellValue(sheetName, 95, 4, null),
					new ExpectedCellValue(sheetName, 96, 4, null),
					new ExpectedCellValue(sheetName, 97, 4, null),
					new ExpectedCellValue(sheetName, 98, 4, null),
					new ExpectedCellValue(sheetName, 99, 4, null),
					new ExpectedCellValue(sheetName, 100, 4, null),
					new ExpectedCellValue(sheetName, 101, 4, null),
					new ExpectedCellValue(sheetName, 102, 4, null),
					new ExpectedCellValue(sheetName, 103, 4, null),
					new ExpectedCellValue(sheetName, 104, 4, null),
					new ExpectedCellValue(sheetName, 105, 4, null),
					new ExpectedCellValue(sheetName, 106, 4, null),
					new ExpectedCellValue(sheetName, 107, 4, null),
					new ExpectedCellValue(sheetName, 108, 4, null),
					new ExpectedCellValue(sheetName, 109, 4, null),
					new ExpectedCellValue(sheetName, 110, 4, null),
					new ExpectedCellValue(sheetName, 111, 4, null),
					new ExpectedCellValue(sheetName, 112, 4, null),
					new ExpectedCellValue(sheetName, 113, 4, 415.75),
					new ExpectedCellValue(sheetName, 114, 4, 415.75),
					new ExpectedCellValue(sheetName, 115, 4, 415.75),
					new ExpectedCellValue(sheetName, 116, 4, 415.75),
					new ExpectedCellValue(sheetName, 117, 4, 415.75),
					new ExpectedCellValue(sheetName, 118, 4, 415.75),
					new ExpectedCellValue(sheetName, 119, 4, 415.75),
					new ExpectedCellValue(sheetName, 120, 4, 415.75),
					new ExpectedCellValue(sheetName, 72, 5, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 73, 5, null),
					new ExpectedCellValue(sheetName, 74, 5, null),
					new ExpectedCellValue(sheetName, 75, 5, null),
					new ExpectedCellValue(sheetName, 76, 5, null),
					new ExpectedCellValue(sheetName, 77, 5, 831.5),
					new ExpectedCellValue(sheetName, 78, 5, 415.75),
					new ExpectedCellValue(sheetName, 79, 5, 831.5),
					new ExpectedCellValue(sheetName, 80, 5, 415.75),
					new ExpectedCellValue(sheetName, 81, 5, 831.5),
					new ExpectedCellValue(sheetName, 82, 5, 415.75),
					new ExpectedCellValue(sheetName, 83, 5, null),
					new ExpectedCellValue(sheetName, 84, 5, null),
					new ExpectedCellValue(sheetName, 85, 5, null),
					new ExpectedCellValue(sheetName, 86, 5, 831.5),
					new ExpectedCellValue(sheetName, 87, 5, 415.75),
					new ExpectedCellValue(sheetName, 88, 5, null),
					new ExpectedCellValue(sheetName, 89, 5, null),
					new ExpectedCellValue(sheetName, 90, 5, null),
					new ExpectedCellValue(sheetName, 91, 5, 831.5),
					new ExpectedCellValue(sheetName, 92, 5, 415.75),
					new ExpectedCellValue(sheetName, 93, 5, 831.5),
					new ExpectedCellValue(sheetName, 94, 5, 415.75),
					new ExpectedCellValue(sheetName, 95, 5, null),
					new ExpectedCellValue(sheetName, 96, 5, null),
					new ExpectedCellValue(sheetName, 97, 5, null),
					new ExpectedCellValue(sheetName, 98, 5, 831.5),
					new ExpectedCellValue(sheetName, 99, 5, 415.75),
					new ExpectedCellValue(sheetName, 100, 5, null),
					new ExpectedCellValue(sheetName, 101, 5, null),
					new ExpectedCellValue(sheetName, 102, 5, null),
					new ExpectedCellValue(sheetName, 103, 5, 831.5),
					new ExpectedCellValue(sheetName, 104, 5, 415.75),
					new ExpectedCellValue(sheetName, 105, 5, null),
					new ExpectedCellValue(sheetName, 106, 5, null),
					new ExpectedCellValue(sheetName, 107, 5, null),
					new ExpectedCellValue(sheetName, 108, 5, null),
					new ExpectedCellValue(sheetName, 109, 5, null),
					new ExpectedCellValue(sheetName, 110, 5, null),
					new ExpectedCellValue(sheetName, 111, 5, null),
					new ExpectedCellValue(sheetName, 112, 5, null),
					new ExpectedCellValue(sheetName, 113, 5, 415.75),
					new ExpectedCellValue(sheetName, 114, 5, 415.75),
					new ExpectedCellValue(sheetName, 115, 5, 415.75),
					new ExpectedCellValue(sheetName, 116, 5, 415.75),
					new ExpectedCellValue(sheetName, 117, 5, 1247.25),
					new ExpectedCellValue(sheetName, 118, 5, 831.5),
					new ExpectedCellValue(sheetName, 119, 5, 2910.25),
					new ExpectedCellValue(sheetName, 120, 5, 1663d),
					new ExpectedCellValue(sheetName, 72, 6, "Headlamp"),
					new ExpectedCellValue(sheetName, 73, 6, "Chicago"),
					new ExpectedCellValue(sheetName, 74, 6, null),
					new ExpectedCellValue(sheetName, 75, 6, null),
					new ExpectedCellValue(sheetName, 76, 6, null),
					new ExpectedCellValue(sheetName, 77, 6, null),
					new ExpectedCellValue(sheetName, 78, 6, null),
					new ExpectedCellValue(sheetName, 79, 6, null),
					new ExpectedCellValue(sheetName, 80, 6, null),
					new ExpectedCellValue(sheetName, 81, 6, null),
					new ExpectedCellValue(sheetName, 82, 6, null),
					new ExpectedCellValue(sheetName, 83, 6, null),
					new ExpectedCellValue(sheetName, 84, 6, null),
					new ExpectedCellValue(sheetName, 85, 6, null),
					new ExpectedCellValue(sheetName, 86, 6, null),
					new ExpectedCellValue(sheetName, 87, 6, null),
					new ExpectedCellValue(sheetName, 88, 6, null),
					new ExpectedCellValue(sheetName, 89, 6, null),
					new ExpectedCellValue(sheetName, 90, 6, null),
					new ExpectedCellValue(sheetName, 91, 6, null),
					new ExpectedCellValue(sheetName, 92, 6, null),
					new ExpectedCellValue(sheetName, 93, 6, null),
					new ExpectedCellValue(sheetName, 94, 6, null),
					new ExpectedCellValue(sheetName, 95, 6, null),
					new ExpectedCellValue(sheetName, 96, 6, null),
					new ExpectedCellValue(sheetName, 97, 6, null),
					new ExpectedCellValue(sheetName, 98, 6, null),
					new ExpectedCellValue(sheetName, 99, 6, null),
					new ExpectedCellValue(sheetName, 100, 6, null),
					new ExpectedCellValue(sheetName, 101, 6, 24.99),
					new ExpectedCellValue(sheetName, 102, 6, 24.99),
					new ExpectedCellValue(sheetName, 103, 6, 24.99),
					new ExpectedCellValue(sheetName, 104, 6, 24.99),
					new ExpectedCellValue(sheetName, 105, 6, null),
					new ExpectedCellValue(sheetName, 106, 6, null),
					new ExpectedCellValue(sheetName, 107, 6, null),
					new ExpectedCellValue(sheetName, 108, 6, null),
					new ExpectedCellValue(sheetName, 109, 6, null),
					new ExpectedCellValue(sheetName, 110, 6, null),
					new ExpectedCellValue(sheetName, 111, 6, null),
					new ExpectedCellValue(sheetName, 112, 6, null),
					new ExpectedCellValue(sheetName, 113, 6, null),
					new ExpectedCellValue(sheetName, 114, 6, null),
					new ExpectedCellValue(sheetName, 115, 6, null),
					new ExpectedCellValue(sheetName, 116, 6, null),
					new ExpectedCellValue(sheetName, 117, 6, 24.99),
					new ExpectedCellValue(sheetName, 118, 6, 24.99),
					new ExpectedCellValue(sheetName, 119, 6, 24.99),
					new ExpectedCellValue(sheetName, 120, 6, 24.99),
					new ExpectedCellValue(sheetName, 72, 7, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 73, 7, null),
					new ExpectedCellValue(sheetName, 74, 7, null),
					new ExpectedCellValue(sheetName, 75, 7, null),
					new ExpectedCellValue(sheetName, 76, 7, null),
					new ExpectedCellValue(sheetName, 77, 7, null),
					new ExpectedCellValue(sheetName, 78, 7, null),
					new ExpectedCellValue(sheetName, 79, 7, null),
					new ExpectedCellValue(sheetName, 80, 7, null),
					new ExpectedCellValue(sheetName, 81, 7, null),
					new ExpectedCellValue(sheetName, 82, 7, null),
					new ExpectedCellValue(sheetName, 83, 7, null),
					new ExpectedCellValue(sheetName, 84, 7, null),
					new ExpectedCellValue(sheetName, 85, 7, null),
					new ExpectedCellValue(sheetName, 86, 7, null),
					new ExpectedCellValue(sheetName, 87, 7, null),
					new ExpectedCellValue(sheetName, 88, 7, null),
					new ExpectedCellValue(sheetName, 89, 7, null),
					new ExpectedCellValue(sheetName, 90, 7, null),
					new ExpectedCellValue(sheetName, 91, 7, null),
					new ExpectedCellValue(sheetName, 92, 7, null),
					new ExpectedCellValue(sheetName, 93, 7, null),
					new ExpectedCellValue(sheetName, 94, 7, null),
					new ExpectedCellValue(sheetName, 95, 7, null),
					new ExpectedCellValue(sheetName, 96, 7, null),
					new ExpectedCellValue(sheetName, 97, 7, null),
					new ExpectedCellValue(sheetName, 98, 7, null),
					new ExpectedCellValue(sheetName, 99, 7, null),
					new ExpectedCellValue(sheetName, 100, 7, null),
					new ExpectedCellValue(sheetName, 101, 7, 24.99),
					new ExpectedCellValue(sheetName, 102, 7, 24.99),
					new ExpectedCellValue(sheetName, 103, 7, 24.99),
					new ExpectedCellValue(sheetName, 104, 7, 24.99),
					new ExpectedCellValue(sheetName, 105, 7, null),
					new ExpectedCellValue(sheetName, 106, 7, null),
					new ExpectedCellValue(sheetName, 107, 7, null),
					new ExpectedCellValue(sheetName, 108, 7, null),
					new ExpectedCellValue(sheetName, 109, 7, null),
					new ExpectedCellValue(sheetName, 110, 7, null),
					new ExpectedCellValue(sheetName, 111, 7, null),
					new ExpectedCellValue(sheetName, 112, 7, null),
					new ExpectedCellValue(sheetName, 113, 7, null),
					new ExpectedCellValue(sheetName, 114, 7, null),
					new ExpectedCellValue(sheetName, 115, 7, null),
					new ExpectedCellValue(sheetName, 116, 7, null),
					new ExpectedCellValue(sheetName, 117, 7, 24.99),
					new ExpectedCellValue(sheetName, 118, 7, 24.99),
					new ExpectedCellValue(sheetName, 119, 7, 24.99),
					new ExpectedCellValue(sheetName, 120, 7, 24.99),
					new ExpectedCellValue(sheetName, 72, 8, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 73, 8, "San Francisco"),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, null),
					new ExpectedCellValue(sheetName, 77, 8, null),
					new ExpectedCellValue(sheetName, 78, 8, null),
					new ExpectedCellValue(sheetName, 79, 8, null),
					new ExpectedCellValue(sheetName, 80, 8, null),
					new ExpectedCellValue(sheetName, 81, 8, null),
					new ExpectedCellValue(sheetName, 82, 8, null),
					new ExpectedCellValue(sheetName, 83, 8, null),
					new ExpectedCellValue(sheetName, 84, 8, null),
					new ExpectedCellValue(sheetName, 85, 8, null),
					new ExpectedCellValue(sheetName, 86, 8, null),
					new ExpectedCellValue(sheetName, 87, 8, null),
					new ExpectedCellValue(sheetName, 88, 8, null),
					new ExpectedCellValue(sheetName, 89, 8, 99d),
					new ExpectedCellValue(sheetName, 90, 8, 99d),
					new ExpectedCellValue(sheetName, 91, 8, 99d),
					new ExpectedCellValue(sheetName, 92, 8, 99d),
					new ExpectedCellValue(sheetName, 93, 8, 99d),
					new ExpectedCellValue(sheetName, 94, 8, 99d),
					new ExpectedCellValue(sheetName, 95, 8, null),
					new ExpectedCellValue(sheetName, 96, 8, null),
					new ExpectedCellValue(sheetName, 97, 8, null),
					new ExpectedCellValue(sheetName, 98, 8, null),
					new ExpectedCellValue(sheetName, 99, 8, null),
					new ExpectedCellValue(sheetName, 100, 8, null),
					new ExpectedCellValue(sheetName, 101, 8, null),
					new ExpectedCellValue(sheetName, 102, 8, null),
					new ExpectedCellValue(sheetName, 103, 8, null),
					new ExpectedCellValue(sheetName, 104, 8, null),
					new ExpectedCellValue(sheetName, 105, 8, null),
					new ExpectedCellValue(sheetName, 106, 8, null),
					new ExpectedCellValue(sheetName, 107, 8, null),
					new ExpectedCellValue(sheetName, 108, 8, null),
					new ExpectedCellValue(sheetName, 109, 8, null),
					new ExpectedCellValue(sheetName, 110, 8, null),
					new ExpectedCellValue(sheetName, 111, 8, null),
					new ExpectedCellValue(sheetName, 112, 8, null),
					new ExpectedCellValue(sheetName, 113, 8, null),
					new ExpectedCellValue(sheetName, 114, 8, null),
					new ExpectedCellValue(sheetName, 115, 8, null),
					new ExpectedCellValue(sheetName, 116, 8, null),
					new ExpectedCellValue(sheetName, 117, 8, null),
					new ExpectedCellValue(sheetName, 118, 8, null),
					new ExpectedCellValue(sheetName, 119, 8, 99d),
					new ExpectedCellValue(sheetName, 120, 8, 99d),
					new ExpectedCellValue(sheetName, 72, 9, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 73, 9, null),
					new ExpectedCellValue(sheetName, 74, 9, null),
					new ExpectedCellValue(sheetName, 75, 9, null),
					new ExpectedCellValue(sheetName, 76, 9, null),
					new ExpectedCellValue(sheetName, 77, 9, null),
					new ExpectedCellValue(sheetName, 78, 9, null),
					new ExpectedCellValue(sheetName, 79, 9, null),
					new ExpectedCellValue(sheetName, 80, 9, null),
					new ExpectedCellValue(sheetName, 81, 9, null),
					new ExpectedCellValue(sheetName, 82, 9, null),
					new ExpectedCellValue(sheetName, 83, 9, null),
					new ExpectedCellValue(sheetName, 84, 9, null),
					new ExpectedCellValue(sheetName, 85, 9, null),
					new ExpectedCellValue(sheetName, 86, 9, null),
					new ExpectedCellValue(sheetName, 87, 9, null),
					new ExpectedCellValue(sheetName, 88, 9, null),
					new ExpectedCellValue(sheetName, 89, 9, 99d),
					new ExpectedCellValue(sheetName, 90, 9, 99d),
					new ExpectedCellValue(sheetName, 91, 9, 99d),
					new ExpectedCellValue(sheetName, 92, 9, 99d),
					new ExpectedCellValue(sheetName, 93, 9, 99d),
					new ExpectedCellValue(sheetName, 94, 9, 99d),
					new ExpectedCellValue(sheetName, 95, 9, null),
					new ExpectedCellValue(sheetName, 96, 9, null),
					new ExpectedCellValue(sheetName, 97, 9, null),
					new ExpectedCellValue(sheetName, 98, 9, null),
					new ExpectedCellValue(sheetName, 99, 9, null),
					new ExpectedCellValue(sheetName, 100, 9, null),
					new ExpectedCellValue(sheetName, 101, 9, null),
					new ExpectedCellValue(sheetName, 102, 9, null),
					new ExpectedCellValue(sheetName, 103, 9, null),
					new ExpectedCellValue(sheetName, 104, 9, null),
					new ExpectedCellValue(sheetName, 105, 9, null),
					new ExpectedCellValue(sheetName, 106, 9, null),
					new ExpectedCellValue(sheetName, 107, 9, null),
					new ExpectedCellValue(sheetName, 108, 9, null),
					new ExpectedCellValue(sheetName, 109, 9, null),
					new ExpectedCellValue(sheetName, 110, 9, null),
					new ExpectedCellValue(sheetName, 111, 9, null),
					new ExpectedCellValue(sheetName, 112, 9, null),
					new ExpectedCellValue(sheetName, 113, 9, null),
					new ExpectedCellValue(sheetName, 114, 9, null),
					new ExpectedCellValue(sheetName, 115, 9, null),
					new ExpectedCellValue(sheetName, 116, 9, null),
					new ExpectedCellValue(sheetName, 117, 9, null),
					new ExpectedCellValue(sheetName, 118, 9, null),
					new ExpectedCellValue(sheetName, 119, 9, 99d),
					new ExpectedCellValue(sheetName, 120, 9, 99d),
					new ExpectedCellValue(sheetName, 72, 10, "Tent"),
					new ExpectedCellValue(sheetName, 73, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, null),
					new ExpectedCellValue(sheetName, 77, 10, null),
					new ExpectedCellValue(sheetName, 78, 10, null),
					new ExpectedCellValue(sheetName, 79, 10, null),
					new ExpectedCellValue(sheetName, 80, 10, null),
					new ExpectedCellValue(sheetName, 81, 10, null),
					new ExpectedCellValue(sheetName, 82, 10, null),
					new ExpectedCellValue(sheetName, 83, 10, null),
					new ExpectedCellValue(sheetName, 84, 10, null),
					new ExpectedCellValue(sheetName, 85, 10, null),
					new ExpectedCellValue(sheetName, 86, 10, null),
					new ExpectedCellValue(sheetName, 87, 10, null),
					new ExpectedCellValue(sheetName, 88, 10, null),
					new ExpectedCellValue(sheetName, 89, 10, null),
					new ExpectedCellValue(sheetName, 90, 10, null),
					new ExpectedCellValue(sheetName, 91, 10, null),
					new ExpectedCellValue(sheetName, 92, 10, null),
					new ExpectedCellValue(sheetName, 93, 10, null),
					new ExpectedCellValue(sheetName, 94, 10, null),
					new ExpectedCellValue(sheetName, 95, 10, null),
					new ExpectedCellValue(sheetName, 96, 10, null),
					new ExpectedCellValue(sheetName, 97, 10, null),
					new ExpectedCellValue(sheetName, 98, 10, null),
					new ExpectedCellValue(sheetName, 99, 10, null),
					new ExpectedCellValue(sheetName, 100, 10, null),
					new ExpectedCellValue(sheetName, 101, 10, null),
					new ExpectedCellValue(sheetName, 102, 10, null),
					new ExpectedCellValue(sheetName, 103, 10, null),
					new ExpectedCellValue(sheetName, 104, 10, null),
					new ExpectedCellValue(sheetName, 105, 10, null),
					new ExpectedCellValue(sheetName, 106, 10, null),
					new ExpectedCellValue(sheetName, 107, 10, 1194d),
					new ExpectedCellValue(sheetName, 108, 10, 199d),
					new ExpectedCellValue(sheetName, 109, 10, 1194d),
					new ExpectedCellValue(sheetName, 110, 10, 199d),
					new ExpectedCellValue(sheetName, 111, 10, null),
					new ExpectedCellValue(sheetName, 112, 10, null),
					new ExpectedCellValue(sheetName, 113, 10, null),
					new ExpectedCellValue(sheetName, 114, 10, null),
					new ExpectedCellValue(sheetName, 115, 10, null),
					new ExpectedCellValue(sheetName, 116, 10, null),
					new ExpectedCellValue(sheetName, 117, 10, 1194d),
					new ExpectedCellValue(sheetName, 118, 10, 199d),
					new ExpectedCellValue(sheetName, 119, 10, 1194d),
					new ExpectedCellValue(sheetName, 120, 10, 199d),
					new ExpectedCellValue(sheetName, 72, 11, "Tent Total"),
					new ExpectedCellValue(sheetName, 73, 11, null),
					new ExpectedCellValue(sheetName, 74, 11, null),
					new ExpectedCellValue(sheetName, 75, 11, null),
					new ExpectedCellValue(sheetName, 76, 11, null),
					new ExpectedCellValue(sheetName, 77, 11, null),
					new ExpectedCellValue(sheetName, 78, 11, null),
					new ExpectedCellValue(sheetName, 79, 11, null),
					new ExpectedCellValue(sheetName, 80, 11, null),
					new ExpectedCellValue(sheetName, 81, 11, null),
					new ExpectedCellValue(sheetName, 82, 11, null),
					new ExpectedCellValue(sheetName, 83, 11, null),
					new ExpectedCellValue(sheetName, 84, 11, null),
					new ExpectedCellValue(sheetName, 85, 11, null),
					new ExpectedCellValue(sheetName, 86, 11, null),
					new ExpectedCellValue(sheetName, 87, 11, null),
					new ExpectedCellValue(sheetName, 88, 11, null),
					new ExpectedCellValue(sheetName, 89, 11, null),
					new ExpectedCellValue(sheetName, 90, 11, null),
					new ExpectedCellValue(sheetName, 91, 11, null),
					new ExpectedCellValue(sheetName, 92, 11, null),
					new ExpectedCellValue(sheetName, 93, 11, null),
					new ExpectedCellValue(sheetName, 94, 11, null),
					new ExpectedCellValue(sheetName, 95, 11, null),
					new ExpectedCellValue(sheetName, 96, 11, null),
					new ExpectedCellValue(sheetName, 97, 11, null),
					new ExpectedCellValue(sheetName, 98, 11, null),
					new ExpectedCellValue(sheetName, 99, 11, null),
					new ExpectedCellValue(sheetName, 100, 11, null),
					new ExpectedCellValue(sheetName, 101, 11, null),
					new ExpectedCellValue(sheetName, 102, 11, null),
					new ExpectedCellValue(sheetName, 103, 11, null),
					new ExpectedCellValue(sheetName, 104, 11, null),
					new ExpectedCellValue(sheetName, 105, 11, null),
					new ExpectedCellValue(sheetName, 106, 11, null),
					new ExpectedCellValue(sheetName, 107, 11, 1194d),
					new ExpectedCellValue(sheetName, 108, 11, 199d),
					new ExpectedCellValue(sheetName, 109, 11, 1194d),
					new ExpectedCellValue(sheetName, 110, 11, 199d),
					new ExpectedCellValue(sheetName, 111, 11, null),
					new ExpectedCellValue(sheetName, 112, 11, null),
					new ExpectedCellValue(sheetName, 113, 11, null),
					new ExpectedCellValue(sheetName, 114, 11, null),
					new ExpectedCellValue(sheetName, 115, 11, null),
					new ExpectedCellValue(sheetName, 116, 11, null),
					new ExpectedCellValue(sheetName, 117, 11, 1194d),
					new ExpectedCellValue(sheetName, 118, 11, 199d),
					new ExpectedCellValue(sheetName, 119, 11, 1194d),
					new ExpectedCellValue(sheetName, 120, 11, 199d),
					new ExpectedCellValue(sheetName, 72, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, null),
					new ExpectedCellValue(sheetName, 77, 12, 831.5),
					new ExpectedCellValue(sheetName, 78, 12, 415.75),
					new ExpectedCellValue(sheetName, 79, 12, 831.5),
					new ExpectedCellValue(sheetName, 80, 12, 415.75),
					new ExpectedCellValue(sheetName, 81, 12, 831.5),
					new ExpectedCellValue(sheetName, 82, 12, 415.75),
					new ExpectedCellValue(sheetName, 83, 12, null),
					new ExpectedCellValue(sheetName, 84, 12, null),
					new ExpectedCellValue(sheetName, 85, 12, null),
					new ExpectedCellValue(sheetName, 86, 12, 831.5),
					new ExpectedCellValue(sheetName, 87, 12, 415.75),
					new ExpectedCellValue(sheetName, 88, 12, null),
					new ExpectedCellValue(sheetName, 89, 12, 99d),
					new ExpectedCellValue(sheetName, 90, 12, 99d),
					new ExpectedCellValue(sheetName, 91, 12, 930.5),
					new ExpectedCellValue(sheetName, 92, 12, 514.75),
					new ExpectedCellValue(sheetName, 93, 12, 930.5),
					new ExpectedCellValue(sheetName, 94, 12, 514.75),
					new ExpectedCellValue(sheetName, 95, 12, null),
					new ExpectedCellValue(sheetName, 96, 12, null),
					new ExpectedCellValue(sheetName, 97, 12, null),
					new ExpectedCellValue(sheetName, 98, 12, 831.5),
					new ExpectedCellValue(sheetName, 99, 12, 415.75),
					new ExpectedCellValue(sheetName, 100, 12, null),
					new ExpectedCellValue(sheetName, 101, 12, 24.99),
					new ExpectedCellValue(sheetName, 102, 12, 24.99),
					new ExpectedCellValue(sheetName, 103, 12, 856.49),
					new ExpectedCellValue(sheetName, 104, 12, 440.74),
					new ExpectedCellValue(sheetName, 105, 12, null),
					new ExpectedCellValue(sheetName, 106, 12, null),
					new ExpectedCellValue(sheetName, 107, 12, 1194d),
					new ExpectedCellValue(sheetName, 108, 12, 199d),
					new ExpectedCellValue(sheetName, 109, 12, 1194d),
					new ExpectedCellValue(sheetName, 110, 12, 199d),
					new ExpectedCellValue(sheetName, 111, 12, null),
					new ExpectedCellValue(sheetName, 112, 12, null),
					new ExpectedCellValue(sheetName, 113, 12, 415.75),
					new ExpectedCellValue(sheetName, 114, 12, 415.75),
					new ExpectedCellValue(sheetName, 115, 12, 415.75),
					new ExpectedCellValue(sheetName, 116, 12, 415.75),
					new ExpectedCellValue(sheetName, 117, 12, 2466.24),
					new ExpectedCellValue(sheetName, 118, 12, 1055.49),
					new ExpectedCellValue(sheetName, 119, 12, 4228.24),
					new ExpectedCellValue(sheetName, 120, 12, 1985.99),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGrouping.xlsx")]
		public void PivotTableRefreshDateGroupingColumnDataFields()
		{
			var file = new FileInfo("PivotTableDateGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ColumnDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:AE22"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ColumnDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 5, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 6, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 7, 1, "Feb"),
					new ExpectedCellValue(sheetName, 8, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 9, 1, "May"),
					new ExpectedCellValue(sheetName, 10, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 11, 1, "Oct"),
					new ExpectedCellValue(sheetName, 12, 1, "Nov"),
					new ExpectedCellValue(sheetName, 13, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 14, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 15, 1, "Mar"),
					new ExpectedCellValue(sheetName, 16, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 17, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 18, 1, "Dec"),
					new ExpectedCellValue(sheetName, 19, 1, "Tent"),
					new ExpectedCellValue(sheetName, 20, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 21, 1, "May"),
					new ExpectedCellValue(sheetName, 22, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 3, 2, 2016),
					new ExpectedCellValue(sheetName, 4, 2, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 2, 415.75),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, 415.75),
					new ExpectedCellValue(sheetName, 9, 2, 415.75),
					new ExpectedCellValue(sheetName, 10, 2, null),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, null),
					new ExpectedCellValue(sheetName, 13, 2, null),
					new ExpectedCellValue(sheetName, 14, 2, null),
					new ExpectedCellValue(sheetName, 15, 2, null),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, 415.75),
					new ExpectedCellValue(sheetName, 2, 3, null),
					new ExpectedCellValue(sheetName, 3, 3, null),
					new ExpectedCellValue(sheetName, 4, 3, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 3, 2d),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, 2d),
					new ExpectedCellValue(sheetName, 9, 3, 2d),
					new ExpectedCellValue(sheetName, 10, 3, null),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, null),
					new ExpectedCellValue(sheetName, 13, 3, null),
					new ExpectedCellValue(sheetName, 14, 3, null),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, 2d),
					new ExpectedCellValue(sheetName, 2, 4, null),
					new ExpectedCellValue(sheetName, 3, 4, null),
					new ExpectedCellValue(sheetName, 4, 4, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 4, 831.5),
					new ExpectedCellValue(sheetName, 6, 4, null),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, 831.5),
					new ExpectedCellValue(sheetName, 9, 4, 831.5),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, null),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, null),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, 831.5),
					new ExpectedCellValue(sheetName, 2, 5, null),
					new ExpectedCellValue(sheetName, 3, 5, 2018),
					new ExpectedCellValue(sheetName, 4, 5, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 5, null),
					new ExpectedCellValue(sheetName, 6, 5, null),
					new ExpectedCellValue(sheetName, 7, 5, null),
					new ExpectedCellValue(sheetName, 8, 5, null),
					new ExpectedCellValue(sheetName, 9, 5, null),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, 24.99),
					new ExpectedCellValue(sheetName, 14, 5, 24.99),
					new ExpectedCellValue(sheetName, 15, 5, 24.99),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, 24.99),
					new ExpectedCellValue(sheetName, 2, 6, null),
					new ExpectedCellValue(sheetName, 3, 6, null),
					new ExpectedCellValue(sheetName, 4, 6, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, 1d),
					new ExpectedCellValue(sheetName, 14, 6, 1d),
					new ExpectedCellValue(sheetName, 15, 6, 1d),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, 1d),
					new ExpectedCellValue(sheetName, 2, 7, null),
					new ExpectedCellValue(sheetName, 3, 7, null),
					new ExpectedCellValue(sheetName, 4, 7, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, 24.99),
					new ExpectedCellValue(sheetName, 14, 7, 24.99),
					new ExpectedCellValue(sheetName, 15, 7, 24.99),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, 24.99),
					new ExpectedCellValue(sheetName, 2, 8, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 8, null),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, 415.75),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, 415.75),
					new ExpectedCellValue(sheetName, 9, 8, 415.75),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, 24.99),
					new ExpectedCellValue(sheetName, 14, 8, 24.99),
					new ExpectedCellValue(sheetName, 15, 8, 24.99),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, 440.74),
					new ExpectedCellValue(sheetName, 2, 9, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 9, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, 2d),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, 2d),
					new ExpectedCellValue(sheetName, 9, 9, 2d),
					new ExpectedCellValue(sheetName, 10, 9, null),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, null),
					new ExpectedCellValue(sheetName, 13, 9, 1d),
					new ExpectedCellValue(sheetName, 14, 9, 1d),
					new ExpectedCellValue(sheetName, 15, 9, 1d),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, null),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, 3d),
					new ExpectedCellValue(sheetName, 2, 10, "Chicago Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 10, null),
					new ExpectedCellValue(sheetName, 4, 10, null),
					new ExpectedCellValue(sheetName, 5, 10, 831.5),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, 831.5),
					new ExpectedCellValue(sheetName, 9, 10, 831.5),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, 24.99),
					new ExpectedCellValue(sheetName, 14, 10, 24.99),
					new ExpectedCellValue(sheetName, 15, 10, 24.99),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, 856.49),
					new ExpectedCellValue(sheetName, 2, 11, "Nashville"),
					new ExpectedCellValue(sheetName, 3, 11, 2017),
					new ExpectedCellValue(sheetName, 4, 11, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 11, 415.75),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, 415.75),
					new ExpectedCellValue(sheetName, 11, 11, 415.75),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, 415.75),
					new ExpectedCellValue(sheetName, 2, 12, null),
					new ExpectedCellValue(sheetName, 3, 12, null),
					new ExpectedCellValue(sheetName, 4, 12, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 12, 2d),
					new ExpectedCellValue(sheetName, 6, 12, null),
					new ExpectedCellValue(sheetName, 7, 12, null),
					new ExpectedCellValue(sheetName, 8, 12, null),
					new ExpectedCellValue(sheetName, 9, 12, null),
					new ExpectedCellValue(sheetName, 10, 12, 2d),
					new ExpectedCellValue(sheetName, 11, 12, 2d),
					new ExpectedCellValue(sheetName, 12, 12, null),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, 2d),
					new ExpectedCellValue(sheetName, 2, 13, null),
					new ExpectedCellValue(sheetName, 3, 13, null),
					new ExpectedCellValue(sheetName, 4, 13, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 13, 831.5),
					new ExpectedCellValue(sheetName, 6, 13, null),
					new ExpectedCellValue(sheetName, 7, 13, null),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, null),
					new ExpectedCellValue(sheetName, 10, 13, 831.5),
					new ExpectedCellValue(sheetName, 11, 13, 831.5),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, 831.5),
					new ExpectedCellValue(sheetName, 2, 14, null),
					new ExpectedCellValue(sheetName, 3, 14, 2018),
					new ExpectedCellValue(sheetName, 4, 14, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 14, 415.75),
					new ExpectedCellValue(sheetName, 6, 14, 415.75),
					new ExpectedCellValue(sheetName, 7, 14, 415.75),
					new ExpectedCellValue(sheetName, 8, 14, null),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, 199d),
					new ExpectedCellValue(sheetName, 20, 14, 199d),
					new ExpectedCellValue(sheetName, 21, 14, 199d),
					new ExpectedCellValue(sheetName, 22, 14, 614.75),
					new ExpectedCellValue(sheetName, 2, 15, null),
					new ExpectedCellValue(sheetName, 3, 15, null),
					new ExpectedCellValue(sheetName, 4, 15, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 15, 2d),
					new ExpectedCellValue(sheetName, 6, 15, 2d),
					new ExpectedCellValue(sheetName, 7, 15, 2d),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, 6d),
					new ExpectedCellValue(sheetName, 20, 15, 6d),
					new ExpectedCellValue(sheetName, 21, 15, 6d),
					new ExpectedCellValue(sheetName, 22, 15, 8d),
					new ExpectedCellValue(sheetName, 2, 16, null),
					new ExpectedCellValue(sheetName, 3, 16, null),
					new ExpectedCellValue(sheetName, 4, 16, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 16, 831.5),
					new ExpectedCellValue(sheetName, 6, 16, 831.5),
					new ExpectedCellValue(sheetName, 7, 16, 831.5),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, null),
					new ExpectedCellValue(sheetName, 10, 16, null),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, 1194d),
					new ExpectedCellValue(sheetName, 20, 16, 1194d),
					new ExpectedCellValue(sheetName, 21, 16, 1194d),
					new ExpectedCellValue(sheetName, 22, 16, 2025.5),
					new ExpectedCellValue(sheetName, 2, 17, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 17, null),
					new ExpectedCellValue(sheetName, 4, 17, null),
					new ExpectedCellValue(sheetName, 5, 17, 831.5),
					new ExpectedCellValue(sheetName, 6, 17, 415.75),
					new ExpectedCellValue(sheetName, 7, 17, 415.75),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, null),
					new ExpectedCellValue(sheetName, 10, 17, 415.75),
					new ExpectedCellValue(sheetName, 11, 17, 415.75),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, null),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, 199d),
					new ExpectedCellValue(sheetName, 20, 17, 199d),
					new ExpectedCellValue(sheetName, 21, 17, 199d),
					new ExpectedCellValue(sheetName, 22, 17, 1030.5),
					new ExpectedCellValue(sheetName, 2, 18, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 18, null),
					new ExpectedCellValue(sheetName, 4, 18, null),
					new ExpectedCellValue(sheetName, 5, 18, 4d),
					new ExpectedCellValue(sheetName, 6, 18, 2d),
					new ExpectedCellValue(sheetName, 7, 18, 2d),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, null),
					new ExpectedCellValue(sheetName, 10, 18, 2d),
					new ExpectedCellValue(sheetName, 11, 18, 2d),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, null),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, 6d),
					new ExpectedCellValue(sheetName, 20, 18, 6d),
					new ExpectedCellValue(sheetName, 21, 18, 6d),
					new ExpectedCellValue(sheetName, 22, 18, 10d),
					new ExpectedCellValue(sheetName, 2, 19, "Nashville Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 19, null),
					new ExpectedCellValue(sheetName, 4, 19, null),
					new ExpectedCellValue(sheetName, 5, 19, 1663d),
					new ExpectedCellValue(sheetName, 6, 19, 831.5),
					new ExpectedCellValue(sheetName, 7, 19, 831.5),
					new ExpectedCellValue(sheetName, 8, 19, null),
					new ExpectedCellValue(sheetName, 9, 19, null),
					new ExpectedCellValue(sheetName, 10, 19, 831.5),
					new ExpectedCellValue(sheetName, 11, 19, 831.5),
					new ExpectedCellValue(sheetName, 12, 19, null),
					new ExpectedCellValue(sheetName, 13, 19, null),
					new ExpectedCellValue(sheetName, 14, 19, null),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, null),
					new ExpectedCellValue(sheetName, 19, 19, 1194d),
					new ExpectedCellValue(sheetName, 20, 19, 1194d),
					new ExpectedCellValue(sheetName, 21, 19, 1194d),
					new ExpectedCellValue(sheetName, 22, 19, 2857d),
					new ExpectedCellValue(sheetName, 2, 20, "San Francisco"),
					new ExpectedCellValue(sheetName, 3, 20, 2017),
					new ExpectedCellValue(sheetName, 4, 20, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 20, null),
					new ExpectedCellValue(sheetName, 6, 20, null),
					new ExpectedCellValue(sheetName, 7, 20, null),
					new ExpectedCellValue(sheetName, 8, 20, null),
					new ExpectedCellValue(sheetName, 9, 20, null),
					new ExpectedCellValue(sheetName, 10, 20, null),
					new ExpectedCellValue(sheetName, 11, 20, null),
					new ExpectedCellValue(sheetName, 12, 20, null),
					new ExpectedCellValue(sheetName, 13, 20, null),
					new ExpectedCellValue(sheetName, 14, 20, null),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, 99d),
					new ExpectedCellValue(sheetName, 17, 20, 99d),
					new ExpectedCellValue(sheetName, 18, 20, 99d),
					new ExpectedCellValue(sheetName, 19, 20, null),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, null),
					new ExpectedCellValue(sheetName, 22, 20, 99d),
					new ExpectedCellValue(sheetName, 2, 21, null),
					new ExpectedCellValue(sheetName, 3, 21, null),
					new ExpectedCellValue(sheetName, 4, 21, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 21, null),
					new ExpectedCellValue(sheetName, 6, 21, null),
					new ExpectedCellValue(sheetName, 7, 21, null),
					new ExpectedCellValue(sheetName, 8, 21, null),
					new ExpectedCellValue(sheetName, 9, 21, null),
					new ExpectedCellValue(sheetName, 10, 21, null),
					new ExpectedCellValue(sheetName, 11, 21, null),
					new ExpectedCellValue(sheetName, 12, 21, null),
					new ExpectedCellValue(sheetName, 13, 21, null),
					new ExpectedCellValue(sheetName, 14, 21, null),
					new ExpectedCellValue(sheetName, 15, 21, null),
					new ExpectedCellValue(sheetName, 16, 21, 1d),
					new ExpectedCellValue(sheetName, 17, 21, 1d),
					new ExpectedCellValue(sheetName, 18, 21, 1d),
					new ExpectedCellValue(sheetName, 19, 21, null),
					new ExpectedCellValue(sheetName, 20, 21, null),
					new ExpectedCellValue(sheetName, 21, 21, null),
					new ExpectedCellValue(sheetName, 22, 21, 1d),
					new ExpectedCellValue(sheetName, 2, 22, null),
					new ExpectedCellValue(sheetName, 3, 22, null),
					new ExpectedCellValue(sheetName, 4, 22, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 22, null),
					new ExpectedCellValue(sheetName, 6, 22, null),
					new ExpectedCellValue(sheetName, 7, 22, null),
					new ExpectedCellValue(sheetName, 8, 22, null),
					new ExpectedCellValue(sheetName, 9, 22, null),
					new ExpectedCellValue(sheetName, 10, 22, null),
					new ExpectedCellValue(sheetName, 11, 22, null),
					new ExpectedCellValue(sheetName, 12, 22, null),
					new ExpectedCellValue(sheetName, 13, 22, null),
					new ExpectedCellValue(sheetName, 14, 22, null),
					new ExpectedCellValue(sheetName, 15, 22, null),
					new ExpectedCellValue(sheetName, 16, 22, 99d),
					new ExpectedCellValue(sheetName, 17, 22, 99d),
					new ExpectedCellValue(sheetName, 18, 22, 99d),
					new ExpectedCellValue(sheetName, 19, 22, null),
					new ExpectedCellValue(sheetName, 20, 22, null),
					new ExpectedCellValue(sheetName, 21, 22, null),
					new ExpectedCellValue(sheetName, 22, 22, 99d),
					new ExpectedCellValue(sheetName, 2, 23, null),
					new ExpectedCellValue(sheetName, 3, 23, 2018),
					new ExpectedCellValue(sheetName, 4, 23, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 5, 23, 415.75),
					new ExpectedCellValue(sheetName, 6, 23, null),
					new ExpectedCellValue(sheetName, 7, 23, null),
					new ExpectedCellValue(sheetName, 8, 23, null),
					new ExpectedCellValue(sheetName, 9, 23, null),
					new ExpectedCellValue(sheetName, 10, 23, 415.75),
					new ExpectedCellValue(sheetName, 11, 23, null),
					new ExpectedCellValue(sheetName, 12, 23, 415.75),
					new ExpectedCellValue(sheetName, 13, 23, null),
					new ExpectedCellValue(sheetName, 14, 23, null),
					new ExpectedCellValue(sheetName, 15, 23, null),
					new ExpectedCellValue(sheetName, 16, 23, null),
					new ExpectedCellValue(sheetName, 17, 23, null),
					new ExpectedCellValue(sheetName, 18, 23, null),
					new ExpectedCellValue(sheetName, 19, 23, null),
					new ExpectedCellValue(sheetName, 20, 23, null),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, 415.75),
					new ExpectedCellValue(sheetName, 2, 24, null),
					new ExpectedCellValue(sheetName, 3, 24, null),
					new ExpectedCellValue(sheetName, 4, 24, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 5, 24, 1d),
					new ExpectedCellValue(sheetName, 6, 24, null),
					new ExpectedCellValue(sheetName, 7, 24, null),
					new ExpectedCellValue(sheetName, 8, 24, null),
					new ExpectedCellValue(sheetName, 9, 24, null),
					new ExpectedCellValue(sheetName, 10, 24, 1d),
					new ExpectedCellValue(sheetName, 11, 24, null),
					new ExpectedCellValue(sheetName, 12, 24, 1d),
					new ExpectedCellValue(sheetName, 13, 24, null),
					new ExpectedCellValue(sheetName, 14, 24, null),
					new ExpectedCellValue(sheetName, 15, 24, null),
					new ExpectedCellValue(sheetName, 16, 24, null),
					new ExpectedCellValue(sheetName, 17, 24, null),
					new ExpectedCellValue(sheetName, 18, 24, null),
					new ExpectedCellValue(sheetName, 19, 24, null),
					new ExpectedCellValue(sheetName, 20, 24, null),
					new ExpectedCellValue(sheetName, 21, 24, null),
					new ExpectedCellValue(sheetName, 22, 24, 1d),
					new ExpectedCellValue(sheetName, 2, 25, null),
					new ExpectedCellValue(sheetName, 3, 25, null),
					new ExpectedCellValue(sheetName, 4, 25, "Sum of Total"),
					new ExpectedCellValue(sheetName, 5, 25, 415.75),
					new ExpectedCellValue(sheetName, 6, 25, null),
					new ExpectedCellValue(sheetName, 7, 25, null),
					new ExpectedCellValue(sheetName, 8, 25, null),
					new ExpectedCellValue(sheetName, 9, 25, null),
					new ExpectedCellValue(sheetName, 10, 25, 415.75),
					new ExpectedCellValue(sheetName, 11, 25, null),
					new ExpectedCellValue(sheetName, 12, 25, 415.75),
					new ExpectedCellValue(sheetName, 13, 25, null),
					new ExpectedCellValue(sheetName, 14, 25, null),
					new ExpectedCellValue(sheetName, 15, 25, null),
					new ExpectedCellValue(sheetName, 16, 25, null),
					new ExpectedCellValue(sheetName, 17, 25, null),
					new ExpectedCellValue(sheetName, 18, 25, null),
					new ExpectedCellValue(sheetName, 19, 25, null),
					new ExpectedCellValue(sheetName, 20, 25, null),
					new ExpectedCellValue(sheetName, 21, 25, null),
					new ExpectedCellValue(sheetName, 22, 25, 415.75),
					new ExpectedCellValue(sheetName, 2, 26, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 26, null),
					new ExpectedCellValue(sheetName, 4, 26, null),
					new ExpectedCellValue(sheetName, 5, 26, 415.75),
					new ExpectedCellValue(sheetName, 6, 26, null),
					new ExpectedCellValue(sheetName, 7, 26, null),
					new ExpectedCellValue(sheetName, 8, 26, null),
					new ExpectedCellValue(sheetName, 9, 26, null),
					new ExpectedCellValue(sheetName, 10, 26, 415.75),
					new ExpectedCellValue(sheetName, 11, 26, null),
					new ExpectedCellValue(sheetName, 12, 26, 415.75),
					new ExpectedCellValue(sheetName, 13, 26, null),
					new ExpectedCellValue(sheetName, 14, 26, null),
					new ExpectedCellValue(sheetName, 15, 26, null),
					new ExpectedCellValue(sheetName, 16, 26, 99d),
					new ExpectedCellValue(sheetName, 17, 26, 99d),
					new ExpectedCellValue(sheetName, 18, 26, 99d),
					new ExpectedCellValue(sheetName, 19, 26, null),
					new ExpectedCellValue(sheetName, 20, 26, null),
					new ExpectedCellValue(sheetName, 21, 26, null),
					new ExpectedCellValue(sheetName, 22, 26, 514.75),
					new ExpectedCellValue(sheetName, 2, 27, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 27, null),
					new ExpectedCellValue(sheetName, 4, 27, null),
					new ExpectedCellValue(sheetName, 5, 27, 1d),
					new ExpectedCellValue(sheetName, 6, 27, null),
					new ExpectedCellValue(sheetName, 7, 27, null),
					new ExpectedCellValue(sheetName, 8, 27, null),
					new ExpectedCellValue(sheetName, 9, 27, null),
					new ExpectedCellValue(sheetName, 10, 27, 1d),
					new ExpectedCellValue(sheetName, 11, 27, null),
					new ExpectedCellValue(sheetName, 12, 27, 1d),
					new ExpectedCellValue(sheetName, 13, 27, null),
					new ExpectedCellValue(sheetName, 14, 27, null),
					new ExpectedCellValue(sheetName, 15, 27, null),
					new ExpectedCellValue(sheetName, 16, 27, 1d),
					new ExpectedCellValue(sheetName, 17, 27, 1d),
					new ExpectedCellValue(sheetName, 18, 27, 1d),
					new ExpectedCellValue(sheetName, 19, 27, null),
					new ExpectedCellValue(sheetName, 20, 27, null),
					new ExpectedCellValue(sheetName, 21, 27, null),
					new ExpectedCellValue(sheetName, 22, 27, 2d),
					new ExpectedCellValue(sheetName, 2, 28, "San Francisco Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 28, null),
					new ExpectedCellValue(sheetName, 4, 28, null),
					new ExpectedCellValue(sheetName, 5, 28, 415.75),
					new ExpectedCellValue(sheetName, 6, 28, null),
					new ExpectedCellValue(sheetName, 7, 28, null),
					new ExpectedCellValue(sheetName, 8, 28, null),
					new ExpectedCellValue(sheetName, 9, 28, null),
					new ExpectedCellValue(sheetName, 10, 28, 415.75),
					new ExpectedCellValue(sheetName, 11, 28, null),
					new ExpectedCellValue(sheetName, 12, 28, 415.75),
					new ExpectedCellValue(sheetName, 13, 28, null),
					new ExpectedCellValue(sheetName, 14, 28, null),
					new ExpectedCellValue(sheetName, 15, 28, null),
					new ExpectedCellValue(sheetName, 16, 28, 99d),
					new ExpectedCellValue(sheetName, 17, 28, 99d),
					new ExpectedCellValue(sheetName, 18, 28, 99d),
					new ExpectedCellValue(sheetName, 19, 28, null),
					new ExpectedCellValue(sheetName, 20, 28, null),
					new ExpectedCellValue(sheetName, 21, 28, null),
					new ExpectedCellValue(sheetName, 22, 28, 514.75),
					new ExpectedCellValue(sheetName, 2, 29, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 3, 29, null),
					new ExpectedCellValue(sheetName, 4, 29, null),
					new ExpectedCellValue(sheetName, 5, 29, 1663d),
					new ExpectedCellValue(sheetName, 6, 29, 415.75),
					new ExpectedCellValue(sheetName, 7, 29, 415.75),
					new ExpectedCellValue(sheetName, 8, 29, 415.75),
					new ExpectedCellValue(sheetName, 9, 29, 415.75),
					new ExpectedCellValue(sheetName, 10, 29, 831.5),
					new ExpectedCellValue(sheetName, 11, 29, 415.75),
					new ExpectedCellValue(sheetName, 12, 29, 415.75),
					new ExpectedCellValue(sheetName, 13, 29, 24.99),
					new ExpectedCellValue(sheetName, 14, 29, 24.99),
					new ExpectedCellValue(sheetName, 15, 29, 24.99),
					new ExpectedCellValue(sheetName, 16, 29, 99d),
					new ExpectedCellValue(sheetName, 17, 29, 99d),
					new ExpectedCellValue(sheetName, 18, 29, 99d),
					new ExpectedCellValue(sheetName, 19, 29, 199d),
					new ExpectedCellValue(sheetName, 20, 29, 199d),
					new ExpectedCellValue(sheetName, 21, 29, 199d),
					new ExpectedCellValue(sheetName, 22, 29, 1985.99),
					new ExpectedCellValue(sheetName, 2, 30, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 3, 30, null),
					new ExpectedCellValue(sheetName, 4, 30, null),
					new ExpectedCellValue(sheetName, 5, 30, 7d),
					new ExpectedCellValue(sheetName, 6, 30, 2d),
					new ExpectedCellValue(sheetName, 7, 30, 2d),
					new ExpectedCellValue(sheetName, 8, 30, 2d),
					new ExpectedCellValue(sheetName, 9, 30, 2d),
					new ExpectedCellValue(sheetName, 10, 30, 3d),
					new ExpectedCellValue(sheetName, 11, 30, 2d),
					new ExpectedCellValue(sheetName, 12, 30, 1d),
					new ExpectedCellValue(sheetName, 13, 30, 1d),
					new ExpectedCellValue(sheetName, 14, 30, 1d),
					new ExpectedCellValue(sheetName, 15, 30, 1d),
					new ExpectedCellValue(sheetName, 16, 30, 1d),
					new ExpectedCellValue(sheetName, 17, 30, 1d),
					new ExpectedCellValue(sheetName, 18, 30, 1d),
					new ExpectedCellValue(sheetName, 19, 30, 6d),
					new ExpectedCellValue(sheetName, 20, 30, 6d),
					new ExpectedCellValue(sheetName, 21, 30, 6d),
					new ExpectedCellValue(sheetName, 22, 30, 15d),
					new ExpectedCellValue(sheetName, 2, 31, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 3, 31, null),
					new ExpectedCellValue(sheetName, 4, 31, null),
					new ExpectedCellValue(sheetName, 5, 31, 2910.25),
					new ExpectedCellValue(sheetName, 6, 31, 831.5),
					new ExpectedCellValue(sheetName, 7, 31, 831.5),
					new ExpectedCellValue(sheetName, 8, 31, 831.5),
					new ExpectedCellValue(sheetName, 9, 31, 831.5),
					new ExpectedCellValue(sheetName, 10, 31, 1247.25),
					new ExpectedCellValue(sheetName, 11, 31, 831.5),
					new ExpectedCellValue(sheetName, 12, 31, 415.75),
					new ExpectedCellValue(sheetName, 13, 31, 24.99),
					new ExpectedCellValue(sheetName, 14, 31, 24.99),
					new ExpectedCellValue(sheetName, 15, 31, 24.99),
					new ExpectedCellValue(sheetName, 16, 31, 99d),
					new ExpectedCellValue(sheetName, 17, 31, 99d),
					new ExpectedCellValue(sheetName, 18, 31, 99d),
					new ExpectedCellValue(sheetName, 19, 31, 1194d),
					new ExpectedCellValue(sheetName, 20, 31, 1194d),
					new ExpectedCellValue(sheetName, 21, 31, 1194d),
					new ExpectedCellValue(sheetName, 22, 31, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGrouping.xlsx")]
		public void PivotTableRefreshDateGroupingRowDataFields()
		{
			var file = new FileInfo("PivotTableDateGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["RowDataFields"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:S78"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "RowDataFields";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 6, 1, 20100007),
					new ExpectedCellValue(sheetName, 7, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 8, 1, "May"),
					new ExpectedCellValue(sheetName, 9, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 10, 1, "May"),
					new ExpectedCellValue(sheetName, 11, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 12, 1, "May"),
					new ExpectedCellValue(sheetName, 13, 1, "20100007 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 14, 1, "20100007 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 15, 1, "20100007 Sum of Total"),
					new ExpectedCellValue(sheetName, 16, 1, "20100017"),
					new ExpectedCellValue(sheetName, 17, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 1, "Oct"),
					new ExpectedCellValue(sheetName, 19, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 1, "Oct"),
					new ExpectedCellValue(sheetName, 21, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 22, 1, "Oct"),
					new ExpectedCellValue(sheetName, 23, 1, "20100017 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 24, 1, "20100017 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 25, 1, "20100017 Sum of Total"),
					new ExpectedCellValue(sheetName, 26, 1, "20100070"),
					new ExpectedCellValue(sheetName, 27, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 28, 1, "May"),
					new ExpectedCellValue(sheetName, 29, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 30, 1, "May"),
					new ExpectedCellValue(sheetName, 31, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 32, 1, "May"),
					new ExpectedCellValue(sheetName, 33, 1, "20100070 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 34, 1, "20100070 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 35, 1, "20100070 Sum of Total"),
					new ExpectedCellValue(sheetName, 36, 1, "20100076"),
					new ExpectedCellValue(sheetName, 37, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 38, 1, "Nov"),
					new ExpectedCellValue(sheetName, 39, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 40, 1, "Nov"),
					new ExpectedCellValue(sheetName, 41, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 42, 1, "Nov"),
					new ExpectedCellValue(sheetName, 43, 1, "20100076 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 44, 1, "20100076 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 45, 1, "20100076 Sum of Total"),
					new ExpectedCellValue(sheetName, 46, 1, "20100083"),
					new ExpectedCellValue(sheetName, 47, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 48, 1, "Mar"),
					new ExpectedCellValue(sheetName, 49, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 50, 1, "Mar"),
					new ExpectedCellValue(sheetName, 51, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 1, "Mar"),
					new ExpectedCellValue(sheetName, 53, 1, "20100083 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 54, 1, "20100083 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 55, 1, "20100083 Sum of Total"),
					new ExpectedCellValue(sheetName, 56, 1, "20100085"),
					new ExpectedCellValue(sheetName, 57, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 58, 1, "Dec"),
					new ExpectedCellValue(sheetName, 59, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 60, 1, "Dec"),
					new ExpectedCellValue(sheetName, 61, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 62, 1, "Dec"),
					new ExpectedCellValue(sheetName, 63, 1, "20100085 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 64, 1, "20100085 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 65, 1, "20100085 Sum of Total"),
					new ExpectedCellValue(sheetName, 66, 1, "20100090"),
					new ExpectedCellValue(sheetName, 67, 1, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 68, 1, "Feb"),
					new ExpectedCellValue(sheetName, 69, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 70, 1, "Feb"),
					new ExpectedCellValue(sheetName, 71, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 72, 1, "Feb"),
					new ExpectedCellValue(sheetName, 73, 1, "20100090 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 74, 1, "20100090 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 75, 1, "20100090 Sum of Total"),
					new ExpectedCellValue(sheetName, 76, 1, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 77, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 78, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 3, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 2, 2016),
					new ExpectedCellValue(sheetName, 5, 2, "Qtr2"),
					new ExpectedCellValue(sheetName, 6, 2, null),
					new ExpectedCellValue(sheetName, 7, 2, null),
					new ExpectedCellValue(sheetName, 8, 2, 415.75),
					new ExpectedCellValue(sheetName, 9, 2, null),
					new ExpectedCellValue(sheetName, 10, 2, 2d),
					new ExpectedCellValue(sheetName, 11, 2, null),
					new ExpectedCellValue(sheetName, 12, 2, 831.5),
					new ExpectedCellValue(sheetName, 13, 2, 415.75),
					new ExpectedCellValue(sheetName, 14, 2, 2d),
					new ExpectedCellValue(sheetName, 15, 2, 831.5),
					new ExpectedCellValue(sheetName, 16, 2, null),
					new ExpectedCellValue(sheetName, 17, 2, null),
					new ExpectedCellValue(sheetName, 18, 2, null),
					new ExpectedCellValue(sheetName, 19, 2, null),
					new ExpectedCellValue(sheetName, 20, 2, null),
					new ExpectedCellValue(sheetName, 21, 2, null),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, null),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, null),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, null),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, null),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, null),
					new ExpectedCellValue(sheetName, 55, 2, null),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, null),
					new ExpectedCellValue(sheetName, 67, 2, null),
					new ExpectedCellValue(sheetName, 68, 2, null),
					new ExpectedCellValue(sheetName, 69, 2, null),
					new ExpectedCellValue(sheetName, 70, 2, null),
					new ExpectedCellValue(sheetName, 71, 2, null),
					new ExpectedCellValue(sheetName, 72, 2, null),
					new ExpectedCellValue(sheetName, 73, 2, null),
					new ExpectedCellValue(sheetName, 74, 2, null),
					new ExpectedCellValue(sheetName, 75, 2, null),
					new ExpectedCellValue(sheetName, 76, 2, 415.75),
					new ExpectedCellValue(sheetName, 77, 2, 2d),
					new ExpectedCellValue(sheetName, 78, 2, 831.5),
					new ExpectedCellValue(sheetName, 2, 3, null),
					new ExpectedCellValue(sheetName, 3, 3, "Chicago Total"),
					new ExpectedCellValue(sheetName, 4, 3, null),
					new ExpectedCellValue(sheetName, 5, 3, null),
					new ExpectedCellValue(sheetName, 6, 3, null),
					new ExpectedCellValue(sheetName, 7, 3, null),
					new ExpectedCellValue(sheetName, 8, 3, 415.75),
					new ExpectedCellValue(sheetName, 9, 3, null),
					new ExpectedCellValue(sheetName, 10, 3, 2d),
					new ExpectedCellValue(sheetName, 11, 3, null),
					new ExpectedCellValue(sheetName, 12, 3, 831.5),
					new ExpectedCellValue(sheetName, 13, 3, 415.75),
					new ExpectedCellValue(sheetName, 14, 3, 2d),
					new ExpectedCellValue(sheetName, 15, 3, 831.5),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, null),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, null),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, null),
					new ExpectedCellValue(sheetName, 37, 3, null),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, null),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, null),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, null),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, null),
					new ExpectedCellValue(sheetName, 67, 3, null),
					new ExpectedCellValue(sheetName, 68, 3, null),
					new ExpectedCellValue(sheetName, 69, 3, null),
					new ExpectedCellValue(sheetName, 70, 3, null),
					new ExpectedCellValue(sheetName, 71, 3, null),
					new ExpectedCellValue(sheetName, 72, 3, null),
					new ExpectedCellValue(sheetName, 73, 3, null),
					new ExpectedCellValue(sheetName, 74, 3, null),
					new ExpectedCellValue(sheetName, 75, 3, null),
					new ExpectedCellValue(sheetName, 76, 3, 415.75),
					new ExpectedCellValue(sheetName, 77, 3, 2d),
					new ExpectedCellValue(sheetName, 78, 3, 831.5),
					new ExpectedCellValue(sheetName, 2, 4, null),
					new ExpectedCellValue(sheetName, 3, 4, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 4, 2017),
					new ExpectedCellValue(sheetName, 5, 4, "Qtr4"),
					new ExpectedCellValue(sheetName, 6, 4, null),
					new ExpectedCellValue(sheetName, 7, 4, null),
					new ExpectedCellValue(sheetName, 8, 4, null),
					new ExpectedCellValue(sheetName, 9, 4, null),
					new ExpectedCellValue(sheetName, 10, 4, null),
					new ExpectedCellValue(sheetName, 11, 4, null),
					new ExpectedCellValue(sheetName, 12, 4, null),
					new ExpectedCellValue(sheetName, 13, 4, null),
					new ExpectedCellValue(sheetName, 14, 4, null),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, null),
					new ExpectedCellValue(sheetName, 18, 4, 415.75),
					new ExpectedCellValue(sheetName, 19, 4, null),
					new ExpectedCellValue(sheetName, 20, 4, 2d),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, 831.5),
					new ExpectedCellValue(sheetName, 23, 4, 415.75),
					new ExpectedCellValue(sheetName, 24, 4, 2d),
					new ExpectedCellValue(sheetName, 25, 4, 831.5),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, null),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, null),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, null),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, null),
					new ExpectedCellValue(sheetName, 56, 4, null),
					new ExpectedCellValue(sheetName, 57, 4, null),
					new ExpectedCellValue(sheetName, 58, 4, null),
					new ExpectedCellValue(sheetName, 59, 4, null),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, null),
					new ExpectedCellValue(sheetName, 64, 4, null),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 66, 4, null),
					new ExpectedCellValue(sheetName, 67, 4, null),
					new ExpectedCellValue(sheetName, 68, 4, null),
					new ExpectedCellValue(sheetName, 69, 4, null),
					new ExpectedCellValue(sheetName, 70, 4, null),
					new ExpectedCellValue(sheetName, 71, 4, null),
					new ExpectedCellValue(sheetName, 72, 4, null),
					new ExpectedCellValue(sheetName, 73, 4, null),
					new ExpectedCellValue(sheetName, 74, 4, null),
					new ExpectedCellValue(sheetName, 75, 4, null),
					new ExpectedCellValue(sheetName, 76, 4, 415.75),
					new ExpectedCellValue(sheetName, 77, 4, 2d),
					new ExpectedCellValue(sheetName, 78, 4, 831.5),
					new ExpectedCellValue(sheetName, 2, 5, null),
					new ExpectedCellValue(sheetName, 3, 5, null),
					new ExpectedCellValue(sheetName, 4, 5, 2018),
					new ExpectedCellValue(sheetName, 5, 5, "Qtr1"),
					new ExpectedCellValue(sheetName, 6, 5, null),
					new ExpectedCellValue(sheetName, 7, 5, null),
					new ExpectedCellValue(sheetName, 8, 5, null),
					new ExpectedCellValue(sheetName, 9, 5, null),
					new ExpectedCellValue(sheetName, 10, 5, null),
					new ExpectedCellValue(sheetName, 11, 5, null),
					new ExpectedCellValue(sheetName, 12, 5, null),
					new ExpectedCellValue(sheetName, 13, 5, null),
					new ExpectedCellValue(sheetName, 14, 5, null),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, null),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, null),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, null),
					new ExpectedCellValue(sheetName, 36, 5, null),
					new ExpectedCellValue(sheetName, 37, 5, null),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, null),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, null),
					new ExpectedCellValue(sheetName, 55, 5, null),
					new ExpectedCellValue(sheetName, 56, 5, null),
					new ExpectedCellValue(sheetName, 57, 5, null),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, null),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, null),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, null),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, null),
					new ExpectedCellValue(sheetName, 66, 5, null),
					new ExpectedCellValue(sheetName, 67, 5, null),
					new ExpectedCellValue(sheetName, 68, 5, 415.75),
					new ExpectedCellValue(sheetName, 69, 5, null),
					new ExpectedCellValue(sheetName, 70, 5, 2d),
					new ExpectedCellValue(sheetName, 71, 5, null),
					new ExpectedCellValue(sheetName, 72, 5, 831.5),
					new ExpectedCellValue(sheetName, 73, 5, 415.75),
					new ExpectedCellValue(sheetName, 74, 5, 2d),
					new ExpectedCellValue(sheetName, 75, 5, 831.5),
					new ExpectedCellValue(sheetName, 76, 5, 415.75),
					new ExpectedCellValue(sheetName, 77, 5, 2d),
					new ExpectedCellValue(sheetName, 78, 5, 831.5),
					new ExpectedCellValue(sheetName, 2, 6, null),
					new ExpectedCellValue(sheetName, 3, 6, "Nashville Total"),
					new ExpectedCellValue(sheetName, 4, 6, null),
					new ExpectedCellValue(sheetName, 5, 6, null),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, null),
					new ExpectedCellValue(sheetName, 8, 6, null),
					new ExpectedCellValue(sheetName, 9, 6, null),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, null),
					new ExpectedCellValue(sheetName, 12, 6, null),
					new ExpectedCellValue(sheetName, 13, 6, null),
					new ExpectedCellValue(sheetName, 14, 6, null),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, null),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, 415.75),
					new ExpectedCellValue(sheetName, 19, 6, null),
					new ExpectedCellValue(sheetName, 20, 6, 2d),
					new ExpectedCellValue(sheetName, 21, 6, null),
					new ExpectedCellValue(sheetName, 22, 6, 831.5),
					new ExpectedCellValue(sheetName, 23, 6, 415.75),
					new ExpectedCellValue(sheetName, 24, 6, 2d),
					new ExpectedCellValue(sheetName, 25, 6, 831.5),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, null),
					new ExpectedCellValue(sheetName, 31, 6, null),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, null),
					new ExpectedCellValue(sheetName, 35, 6, null),
					new ExpectedCellValue(sheetName, 36, 6, null),
					new ExpectedCellValue(sheetName, 37, 6, null),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, null),
					new ExpectedCellValue(sheetName, 41, 6, null),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, null),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, null),
					new ExpectedCellValue(sheetName, 47, 6, null),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, null),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, null),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, null),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, null),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, null),
					new ExpectedCellValue(sheetName, 67, 6, null),
					new ExpectedCellValue(sheetName, 68, 6, 415.75),
					new ExpectedCellValue(sheetName, 69, 6, null),
					new ExpectedCellValue(sheetName, 70, 6, 2d),
					new ExpectedCellValue(sheetName, 71, 6, null),
					new ExpectedCellValue(sheetName, 72, 6, 831.5),
					new ExpectedCellValue(sheetName, 73, 6, 415.75),
					new ExpectedCellValue(sheetName, 74, 6, 2d),
					new ExpectedCellValue(sheetName, 75, 6, 831.5),
					new ExpectedCellValue(sheetName, 76, 6, 831.5),
					new ExpectedCellValue(sheetName, 77, 6, 4d),
					new ExpectedCellValue(sheetName, 78, 6, 1663d),
					new ExpectedCellValue(sheetName, 2, 7, null),
					new ExpectedCellValue(sheetName, 3, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 7, 2018),
					new ExpectedCellValue(sheetName, 5, 7, "Qtr4"),
					new ExpectedCellValue(sheetName, 6, 7, null),
					new ExpectedCellValue(sheetName, 7, 7, null),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, null),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, null),
					new ExpectedCellValue(sheetName, 14, 7, null),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, null),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, null),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, null),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, null),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, null),
					new ExpectedCellValue(sheetName, 31, 7, null),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 35, 7, null),
					new ExpectedCellValue(sheetName, 36, 7, null),
					new ExpectedCellValue(sheetName, 37, 7, null),
					new ExpectedCellValue(sheetName, 38, 7, 415.75),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, 1d),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, 415.75),
					new ExpectedCellValue(sheetName, 43, 7, 415.75),
					new ExpectedCellValue(sheetName, 44, 7, 1),
					new ExpectedCellValue(sheetName, 45, 7, 415.75),
					new ExpectedCellValue(sheetName, 46, 7, null),
					new ExpectedCellValue(sheetName, 47, 7, null),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, null),
					new ExpectedCellValue(sheetName, 52, 7, null),
					new ExpectedCellValue(sheetName, 53, 7, null),
					new ExpectedCellValue(sheetName, 54, 7, null),
					new ExpectedCellValue(sheetName, 55, 7, null),
					new ExpectedCellValue(sheetName, 56, 7, null),
					new ExpectedCellValue(sheetName, 57, 7, null),
					new ExpectedCellValue(sheetName, 58, 7, null),
					new ExpectedCellValue(sheetName, 59, 7, null),
					new ExpectedCellValue(sheetName, 60, 7, null),
					new ExpectedCellValue(sheetName, 61, 7, null),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, null),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, null),
					new ExpectedCellValue(sheetName, 66, 7, null),
					new ExpectedCellValue(sheetName, 67, 7, null),
					new ExpectedCellValue(sheetName, 68, 7, null),
					new ExpectedCellValue(sheetName, 69, 7, null),
					new ExpectedCellValue(sheetName, 70, 7, null),
					new ExpectedCellValue(sheetName, 71, 7, null),
					new ExpectedCellValue(sheetName, 72, 7, null),
					new ExpectedCellValue(sheetName, 73, 7, null),
					new ExpectedCellValue(sheetName, 74, 7, null),
					new ExpectedCellValue(sheetName, 75, 7, null),
					new ExpectedCellValue(sheetName, 76, 7, 415.75),
					new ExpectedCellValue(sheetName, 77, 7, 1d),
					new ExpectedCellValue(sheetName, 78, 7, 415.75),
					new ExpectedCellValue(sheetName, 2, 8, null),
					new ExpectedCellValue(sheetName, 3, 8, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 4, 8, null),
					new ExpectedCellValue(sheetName, 5, 8, null),
					new ExpectedCellValue(sheetName, 6, 8, null),
					new ExpectedCellValue(sheetName, 7, 8, null),
					new ExpectedCellValue(sheetName, 8, 8, null),
					new ExpectedCellValue(sheetName, 9, 8, null),
					new ExpectedCellValue(sheetName, 10, 8, null),
					new ExpectedCellValue(sheetName, 11, 8, null),
					new ExpectedCellValue(sheetName, 12, 8, null),
					new ExpectedCellValue(sheetName, 13, 8, null),
					new ExpectedCellValue(sheetName, 14, 8, null),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, null),
					new ExpectedCellValue(sheetName, 17, 8, null),
					new ExpectedCellValue(sheetName, 18, 8, null),
					new ExpectedCellValue(sheetName, 19, 8, null),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, null),
					new ExpectedCellValue(sheetName, 26, 8, null),
					new ExpectedCellValue(sheetName, 27, 8, null),
					new ExpectedCellValue(sheetName, 28, 8, null),
					new ExpectedCellValue(sheetName, 29, 8, null),
					new ExpectedCellValue(sheetName, 30, 8, null),
					new ExpectedCellValue(sheetName, 31, 8, null),
					new ExpectedCellValue(sheetName, 32, 8, null),
					new ExpectedCellValue(sheetName, 33, 8, null),
					new ExpectedCellValue(sheetName, 34, 8, null),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, null),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, 415.75),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, 1d),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, 415.75),
					new ExpectedCellValue(sheetName, 43, 8, 415.75),
					new ExpectedCellValue(sheetName, 44, 8, 1),
					new ExpectedCellValue(sheetName, 45, 8, 415.75),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, null),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, null),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, null),
					new ExpectedCellValue(sheetName, 61, 8, null),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, null),
					new ExpectedCellValue(sheetName, 66, 8, null),
					new ExpectedCellValue(sheetName, 67, 8, null),
					new ExpectedCellValue(sheetName, 68, 8, null),
					new ExpectedCellValue(sheetName, 69, 8, null),
					new ExpectedCellValue(sheetName, 70, 8, null),
					new ExpectedCellValue(sheetName, 71, 8, null),
					new ExpectedCellValue(sheetName, 72, 8, null),
					new ExpectedCellValue(sheetName, 73, 8, null),
					new ExpectedCellValue(sheetName, 74, 8, null),
					new ExpectedCellValue(sheetName, 75, 8, null),
					new ExpectedCellValue(sheetName, 76, 8, 415.75),
					new ExpectedCellValue(sheetName, 77, 8, 1d),
					new ExpectedCellValue(sheetName, 78, 8, 415.75),
					new ExpectedCellValue(sheetName, 2, 9, "Car Rack Total"),
					new ExpectedCellValue(sheetName, 3, 9, null),
					new ExpectedCellValue(sheetName, 4, 9, null),
					new ExpectedCellValue(sheetName, 5, 9, null),
					new ExpectedCellValue(sheetName, 6, 9, null),
					new ExpectedCellValue(sheetName, 7, 9, null),
					new ExpectedCellValue(sheetName, 8, 9, 415.75),
					new ExpectedCellValue(sheetName, 9, 9, null),
					new ExpectedCellValue(sheetName, 10, 9, 2d),
					new ExpectedCellValue(sheetName, 11, 9, null),
					new ExpectedCellValue(sheetName, 12, 9, 831.5),
					new ExpectedCellValue(sheetName, 13, 9, 415.75),
					new ExpectedCellValue(sheetName, 14, 9, 2d),
					new ExpectedCellValue(sheetName, 15, 9, 831.5),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, 415.75),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, 2d),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, 831.5),
					new ExpectedCellValue(sheetName, 23, 9, 415.75),
					new ExpectedCellValue(sheetName, 24, 9, 2d),
					new ExpectedCellValue(sheetName, 25, 9, 831.5),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, 415.75),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, 1d),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, 415.75),
					new ExpectedCellValue(sheetName, 43, 9, 415.75),
					new ExpectedCellValue(sheetName, 44, 9, 1d),
					new ExpectedCellValue(sheetName, 45, 9, 415.75),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, null),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, null),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, null),
					new ExpectedCellValue(sheetName, 67, 9, null),
					new ExpectedCellValue(sheetName, 68, 9, 415.75),
					new ExpectedCellValue(sheetName, 69, 9, null),
					new ExpectedCellValue(sheetName, 70, 9, 2d),
					new ExpectedCellValue(sheetName, 71, 9, null),
					new ExpectedCellValue(sheetName, 72, 9, 831.5),
					new ExpectedCellValue(sheetName, 73, 9, 415.75),
					new ExpectedCellValue(sheetName, 74, 9, 2d),
					new ExpectedCellValue(sheetName, 75, 9, 831.5),
					new ExpectedCellValue(sheetName, 76, 9, 1663d),
					new ExpectedCellValue(sheetName, 77, 9, 7d),
					new ExpectedCellValue(sheetName, 78, 9, 2910.25),
					new ExpectedCellValue(sheetName, 2, 10, "Headlamp"),
					new ExpectedCellValue(sheetName, 3, 10, "Chicago"),
					new ExpectedCellValue(sheetName, 4, 10, 2018),
					new ExpectedCellValue(sheetName, 5, 10, "Qtr1"),
					new ExpectedCellValue(sheetName, 6, 10, null),
					new ExpectedCellValue(sheetName, 7, 10, null),
					new ExpectedCellValue(sheetName, 8, 10, null),
					new ExpectedCellValue(sheetName, 9, 10, null),
					new ExpectedCellValue(sheetName, 10, 10, null),
					new ExpectedCellValue(sheetName, 11, 10, null),
					new ExpectedCellValue(sheetName, 12, 10, null),
					new ExpectedCellValue(sheetName, 13, 10, null),
					new ExpectedCellValue(sheetName, 14, 10, null),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, null),
					new ExpectedCellValue(sheetName, 18, 10, null),
					new ExpectedCellValue(sheetName, 19, 10, null),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, null),
					new ExpectedCellValue(sheetName, 26, 10, null),
					new ExpectedCellValue(sheetName, 27, 10, null),
					new ExpectedCellValue(sheetName, 28, 10, null),
					new ExpectedCellValue(sheetName, 29, 10, null),
					new ExpectedCellValue(sheetName, 30, 10, null),
					new ExpectedCellValue(sheetName, 31, 10, null),
					new ExpectedCellValue(sheetName, 32, 10, null),
					new ExpectedCellValue(sheetName, 33, 10, null),
					new ExpectedCellValue(sheetName, 34, 10, null),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, null),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, 24.99),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, 1d),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, 24.99),
					new ExpectedCellValue(sheetName, 53, 10, 24.99),
					new ExpectedCellValue(sheetName, 54, 10, 1d),
					new ExpectedCellValue(sheetName, 55, 10, 24.99),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, null),
					new ExpectedCellValue(sheetName, 58, 10, null),
					new ExpectedCellValue(sheetName, 59, 10, null),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, null),
					new ExpectedCellValue(sheetName, 62, 10, null),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 66, 10, null),
					new ExpectedCellValue(sheetName, 67, 10, null),
					new ExpectedCellValue(sheetName, 68, 10, null),
					new ExpectedCellValue(sheetName, 69, 10, null),
					new ExpectedCellValue(sheetName, 70, 10, null),
					new ExpectedCellValue(sheetName, 71, 10, null),
					new ExpectedCellValue(sheetName, 72, 10, null),
					new ExpectedCellValue(sheetName, 73, 10, null),
					new ExpectedCellValue(sheetName, 74, 10, null),
					new ExpectedCellValue(sheetName, 75, 10, null),
					new ExpectedCellValue(sheetName, 76, 10, 24.99),
					new ExpectedCellValue(sheetName, 77, 10, 1d),
					new ExpectedCellValue(sheetName, 78, 10, 24.99),
					new ExpectedCellValue(sheetName, 2, 11, null),
					new ExpectedCellValue(sheetName, 3, 11, "Chicago Total"),
					new ExpectedCellValue(sheetName, 4, 11, null),
					new ExpectedCellValue(sheetName, 5, 11, null),
					new ExpectedCellValue(sheetName, 6, 11, null),
					new ExpectedCellValue(sheetName, 7, 11, null),
					new ExpectedCellValue(sheetName, 8, 11, null),
					new ExpectedCellValue(sheetName, 9, 11, null),
					new ExpectedCellValue(sheetName, 10, 11, null),
					new ExpectedCellValue(sheetName, 11, 11, null),
					new ExpectedCellValue(sheetName, 12, 11, null),
					new ExpectedCellValue(sheetName, 13, 11, null),
					new ExpectedCellValue(sheetName, 14, 11, null),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, null),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, null),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 32, 11, null),
					new ExpectedCellValue(sheetName, 33, 11, null),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 36, 11, null),
					new ExpectedCellValue(sheetName, 37, 11, null),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, null),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, null),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, 24.99),
					new ExpectedCellValue(sheetName, 49, 11, null),
					new ExpectedCellValue(sheetName, 50, 11, 1d),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, 24.99),
					new ExpectedCellValue(sheetName, 53, 11, 24.99),
					new ExpectedCellValue(sheetName, 54, 11, 1d),
					new ExpectedCellValue(sheetName, 55, 11, 24.99),
					new ExpectedCellValue(sheetName, 56, 11, null),
					new ExpectedCellValue(sheetName, 57, 11, null),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, null),
					new ExpectedCellValue(sheetName, 60, 11, null),
					new ExpectedCellValue(sheetName, 61, 11, null),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, null),
					new ExpectedCellValue(sheetName, 65, 11, null),
					new ExpectedCellValue(sheetName, 66, 11, null),
					new ExpectedCellValue(sheetName, 67, 11, null),
					new ExpectedCellValue(sheetName, 68, 11, null),
					new ExpectedCellValue(sheetName, 69, 11, null),
					new ExpectedCellValue(sheetName, 70, 11, null),
					new ExpectedCellValue(sheetName, 71, 11, null),
					new ExpectedCellValue(sheetName, 72, 11, null),
					new ExpectedCellValue(sheetName, 73, 11, null),
					new ExpectedCellValue(sheetName, 74, 11, null),
					new ExpectedCellValue(sheetName, 75, 11, null),
					new ExpectedCellValue(sheetName, 76, 11, 24.99),
					new ExpectedCellValue(sheetName, 77, 11, 1d),
					new ExpectedCellValue(sheetName, 78, 11, 24.99),
					new ExpectedCellValue(sheetName, 2, 12, "Headlamp Total"),
					new ExpectedCellValue(sheetName, 3, 12, null),
					new ExpectedCellValue(sheetName, 4, 12, null),
					new ExpectedCellValue(sheetName, 5, 12, null),
					new ExpectedCellValue(sheetName, 6, 12, null),
					new ExpectedCellValue(sheetName, 7, 12, null),
					new ExpectedCellValue(sheetName, 8, 12, null),
					new ExpectedCellValue(sheetName, 9, 12, null),
					new ExpectedCellValue(sheetName, 10, 12, null),
					new ExpectedCellValue(sheetName, 11, 12, null),
					new ExpectedCellValue(sheetName, 12, 12, null),
					new ExpectedCellValue(sheetName, 13, 12, null),
					new ExpectedCellValue(sheetName, 14, 12, null),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, null),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, null),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, null),
					new ExpectedCellValue(sheetName, 25, 12, null),
					new ExpectedCellValue(sheetName, 26, 12, null),
					new ExpectedCellValue(sheetName, 27, 12, null),
					new ExpectedCellValue(sheetName, 28, 12, null),
					new ExpectedCellValue(sheetName, 29, 12, null),
					new ExpectedCellValue(sheetName, 30, 12, null),
					new ExpectedCellValue(sheetName, 31, 12, null),
					new ExpectedCellValue(sheetName, 32, 12, null),
					new ExpectedCellValue(sheetName, 33, 12, null),
					new ExpectedCellValue(sheetName, 34, 12, null),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, null),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, null),
					new ExpectedCellValue(sheetName, 42, 12, null),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, null),
					new ExpectedCellValue(sheetName, 47, 12, null),
					new ExpectedCellValue(sheetName, 48, 12, 24.99),
					new ExpectedCellValue(sheetName, 49, 12, null),
					new ExpectedCellValue(sheetName, 50, 12, 1d),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, 24.99),
					new ExpectedCellValue(sheetName, 53, 12, 24.99),
					new ExpectedCellValue(sheetName, 54, 12, 1d),
					new ExpectedCellValue(sheetName, 55, 12, 24.99),
					new ExpectedCellValue(sheetName, 56, 12, null),
					new ExpectedCellValue(sheetName, 57, 12, null),
					new ExpectedCellValue(sheetName, 58, 12, null),
					new ExpectedCellValue(sheetName, 59, 12, null),
					new ExpectedCellValue(sheetName, 60, 12, null),
					new ExpectedCellValue(sheetName, 61, 12, null),
					new ExpectedCellValue(sheetName, 62, 12, null),
					new ExpectedCellValue(sheetName, 63, 12, null),
					new ExpectedCellValue(sheetName, 64, 12, null),
					new ExpectedCellValue(sheetName, 65, 12, null),
					new ExpectedCellValue(sheetName, 66, 12, null),
					new ExpectedCellValue(sheetName, 67, 12, null),
					new ExpectedCellValue(sheetName, 68, 12, null),
					new ExpectedCellValue(sheetName, 69, 12, null),
					new ExpectedCellValue(sheetName, 70, 12, null),
					new ExpectedCellValue(sheetName, 71, 12, null),
					new ExpectedCellValue(sheetName, 72, 12, null),
					new ExpectedCellValue(sheetName, 73, 12, null),
					new ExpectedCellValue(sheetName, 74, 12, null),
					new ExpectedCellValue(sheetName, 75, 12, null),
					new ExpectedCellValue(sheetName, 76, 12, 24.99),
					new ExpectedCellValue(sheetName, 77, 12, 1d),
					new ExpectedCellValue(sheetName, 78, 12, 24.99),
					new ExpectedCellValue(sheetName, 2, 13, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 3, 13, "San Francisco"),
					new ExpectedCellValue(sheetName, 4, 13, 2017),
					new ExpectedCellValue(sheetName, 5, 13, "Qtr4"),
					new ExpectedCellValue(sheetName, 6, 13, null),
					new ExpectedCellValue(sheetName, 7, 13, null),
					new ExpectedCellValue(sheetName, 8, 13, null),
					new ExpectedCellValue(sheetName, 9, 13, null),
					new ExpectedCellValue(sheetName, 10, 13, null),
					new ExpectedCellValue(sheetName, 11, 13, null),
					new ExpectedCellValue(sheetName, 12, 13, null),
					new ExpectedCellValue(sheetName, 13, 13, null),
					new ExpectedCellValue(sheetName, 14, 13, null),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, null),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, null),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 25, 13, null),
					new ExpectedCellValue(sheetName, 26, 13, null),
					new ExpectedCellValue(sheetName, 27, 13, null),
					new ExpectedCellValue(sheetName, 28, 13, null),
					new ExpectedCellValue(sheetName, 29, 13, null),
					new ExpectedCellValue(sheetName, 30, 13, null),
					new ExpectedCellValue(sheetName, 31, 13, null),
					new ExpectedCellValue(sheetName, 32, 13, null),
					new ExpectedCellValue(sheetName, 33, 13, null),
					new ExpectedCellValue(sheetName, 34, 13, null),
					new ExpectedCellValue(sheetName, 35, 13, null),
					new ExpectedCellValue(sheetName, 36, 13, null),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 41, 13, null),
					new ExpectedCellValue(sheetName, 42, 13, null),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, null),
					new ExpectedCellValue(sheetName, 45, 13, null),
					new ExpectedCellValue(sheetName, 46, 13, null),
					new ExpectedCellValue(sheetName, 47, 13, null),
					new ExpectedCellValue(sheetName, 48, 13, null),
					new ExpectedCellValue(sheetName, 49, 13, null),
					new ExpectedCellValue(sheetName, 50, 13, null),
					new ExpectedCellValue(sheetName, 51, 13, null),
					new ExpectedCellValue(sheetName, 52, 13, null),
					new ExpectedCellValue(sheetName, 53, 13, null),
					new ExpectedCellValue(sheetName, 54, 13, null),
					new ExpectedCellValue(sheetName, 55, 13, null),
					new ExpectedCellValue(sheetName, 56, 13, null),
					new ExpectedCellValue(sheetName, 57, 13, null),
					new ExpectedCellValue(sheetName, 58, 13, 99d),
					new ExpectedCellValue(sheetName, 59, 13, null),
					new ExpectedCellValue(sheetName, 60, 13, 1d),
					new ExpectedCellValue(sheetName, 61, 13, null),
					new ExpectedCellValue(sheetName, 62, 13, 99d),
					new ExpectedCellValue(sheetName, 63, 13, 99d),
					new ExpectedCellValue(sheetName, 64, 13, 1d),
					new ExpectedCellValue(sheetName, 65, 13, 99d),
					new ExpectedCellValue(sheetName, 66, 13, null),
					new ExpectedCellValue(sheetName, 67, 13, null),
					new ExpectedCellValue(sheetName, 68, 13, null),
					new ExpectedCellValue(sheetName, 69, 13, null),
					new ExpectedCellValue(sheetName, 70, 13, null),
					new ExpectedCellValue(sheetName, 71, 13, null),
					new ExpectedCellValue(sheetName, 72, 13, null),
					new ExpectedCellValue(sheetName, 73, 13, null),
					new ExpectedCellValue(sheetName, 74, 13, null),
					new ExpectedCellValue(sheetName, 75, 13, null),
					new ExpectedCellValue(sheetName, 76, 13, 99d),
					new ExpectedCellValue(sheetName, 77, 13, 1d),
					new ExpectedCellValue(sheetName, 78, 13, 99d),
					new ExpectedCellValue(sheetName, 2, 14, null),
					new ExpectedCellValue(sheetName, 3, 14, "San Francisco Total"),
					new ExpectedCellValue(sheetName, 4, 14, null),
					new ExpectedCellValue(sheetName, 5, 14, null),
					new ExpectedCellValue(sheetName, 6, 14, null),
					new ExpectedCellValue(sheetName, 7, 14, null),
					new ExpectedCellValue(sheetName, 8, 14, null),
					new ExpectedCellValue(sheetName, 9, 14, null),
					new ExpectedCellValue(sheetName, 10, 14, null),
					new ExpectedCellValue(sheetName, 11, 14, null),
					new ExpectedCellValue(sheetName, 12, 14, null),
					new ExpectedCellValue(sheetName, 13, 14, null),
					new ExpectedCellValue(sheetName, 14, 14, null),
					new ExpectedCellValue(sheetName, 15, 14, null),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, null),
					new ExpectedCellValue(sheetName, 20, 14, null),
					new ExpectedCellValue(sheetName, 21, 14, null),
					new ExpectedCellValue(sheetName, 22, 14, null),
					new ExpectedCellValue(sheetName, 23, 14, null),
					new ExpectedCellValue(sheetName, 24, 14, null),
					new ExpectedCellValue(sheetName, 25, 14, null),
					new ExpectedCellValue(sheetName, 26, 14, null),
					new ExpectedCellValue(sheetName, 27, 14, null),
					new ExpectedCellValue(sheetName, 28, 14, null),
					new ExpectedCellValue(sheetName, 29, 14, null),
					new ExpectedCellValue(sheetName, 30, 14, null),
					new ExpectedCellValue(sheetName, 31, 14, null),
					new ExpectedCellValue(sheetName, 32, 14, null),
					new ExpectedCellValue(sheetName, 33, 14, null),
					new ExpectedCellValue(sheetName, 34, 14, null),
					new ExpectedCellValue(sheetName, 35, 14, null),
					new ExpectedCellValue(sheetName, 36, 14, null),
					new ExpectedCellValue(sheetName, 37, 14, null),
					new ExpectedCellValue(sheetName, 38, 14, null),
					new ExpectedCellValue(sheetName, 39, 14, null),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, null),
					new ExpectedCellValue(sheetName, 42, 14, null),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, null),
					new ExpectedCellValue(sheetName, 49, 14, null),
					new ExpectedCellValue(sheetName, 50, 14, null),
					new ExpectedCellValue(sheetName, 51, 14, null),
					new ExpectedCellValue(sheetName, 52, 14, null),
					new ExpectedCellValue(sheetName, 53, 14, null),
					new ExpectedCellValue(sheetName, 54, 14, null),
					new ExpectedCellValue(sheetName, 55, 14, null),
					new ExpectedCellValue(sheetName, 56, 14, null),
					new ExpectedCellValue(sheetName, 57, 14, null),
					new ExpectedCellValue(sheetName, 58, 14, 99d),
					new ExpectedCellValue(sheetName, 59, 14, null),
					new ExpectedCellValue(sheetName, 60, 14, 1d),
					new ExpectedCellValue(sheetName, 61, 14, null),
					new ExpectedCellValue(sheetName, 62, 14, 99d),
					new ExpectedCellValue(sheetName, 63, 14, 99d),
					new ExpectedCellValue(sheetName, 64, 14, 1d),
					new ExpectedCellValue(sheetName, 65, 14, 99d),
					new ExpectedCellValue(sheetName, 66, 14, null),
					new ExpectedCellValue(sheetName, 67, 14, null),
					new ExpectedCellValue(sheetName, 68, 14, null),
					new ExpectedCellValue(sheetName, 69, 14, null),
					new ExpectedCellValue(sheetName, 70, 14, null),
					new ExpectedCellValue(sheetName, 71, 14, null),
					new ExpectedCellValue(sheetName, 72, 14, null),
					new ExpectedCellValue(sheetName, 73, 14, null),
					new ExpectedCellValue(sheetName, 74, 14, null),
					new ExpectedCellValue(sheetName, 75, 14, null),
					new ExpectedCellValue(sheetName, 76, 14, 99d),
					new ExpectedCellValue(sheetName, 77, 14, 1d),
					new ExpectedCellValue(sheetName, 78, 14, 99d),
					new ExpectedCellValue(sheetName, 2, 15, "Sleeping Bag Total"),
					new ExpectedCellValue(sheetName, 3, 15, null),
					new ExpectedCellValue(sheetName, 4, 15, null),
					new ExpectedCellValue(sheetName, 5, 15, null),
					new ExpectedCellValue(sheetName, 6, 15, null),
					new ExpectedCellValue(sheetName, 7, 15, null),
					new ExpectedCellValue(sheetName, 8, 15, null),
					new ExpectedCellValue(sheetName, 9, 15, null),
					new ExpectedCellValue(sheetName, 10, 15, null),
					new ExpectedCellValue(sheetName, 11, 15, null),
					new ExpectedCellValue(sheetName, 12, 15, null),
					new ExpectedCellValue(sheetName, 13, 15, null),
					new ExpectedCellValue(sheetName, 14, 15, null),
					new ExpectedCellValue(sheetName, 15, 15, null),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, null),
					new ExpectedCellValue(sheetName, 20, 15, null),
					new ExpectedCellValue(sheetName, 21, 15, null),
					new ExpectedCellValue(sheetName, 22, 15, null),
					new ExpectedCellValue(sheetName, 23, 15, null),
					new ExpectedCellValue(sheetName, 24, 15, null),
					new ExpectedCellValue(sheetName, 25, 15, null),
					new ExpectedCellValue(sheetName, 26, 15, null),
					new ExpectedCellValue(sheetName, 27, 15, null),
					new ExpectedCellValue(sheetName, 28, 15, null),
					new ExpectedCellValue(sheetName, 29, 15, null),
					new ExpectedCellValue(sheetName, 30, 15, null),
					new ExpectedCellValue(sheetName, 31, 15, null),
					new ExpectedCellValue(sheetName, 32, 15, null),
					new ExpectedCellValue(sheetName, 33, 15, null),
					new ExpectedCellValue(sheetName, 34, 15, null),
					new ExpectedCellValue(sheetName, 35, 15, null),
					new ExpectedCellValue(sheetName, 36, 15, null),
					new ExpectedCellValue(sheetName, 37, 15, null),
					new ExpectedCellValue(sheetName, 38, 15, null),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 40, 15, null),
					new ExpectedCellValue(sheetName, 41, 15, null),
					new ExpectedCellValue(sheetName, 42, 15, null),
					new ExpectedCellValue(sheetName, 43, 15, null),
					new ExpectedCellValue(sheetName, 44, 15, null),
					new ExpectedCellValue(sheetName, 45, 15, null),
					new ExpectedCellValue(sheetName, 46, 15, null),
					new ExpectedCellValue(sheetName, 47, 15, null),
					new ExpectedCellValue(sheetName, 48, 15, null),
					new ExpectedCellValue(sheetName, 49, 15, null),
					new ExpectedCellValue(sheetName, 50, 15, null),
					new ExpectedCellValue(sheetName, 51, 15, null),
					new ExpectedCellValue(sheetName, 52, 15, null),
					new ExpectedCellValue(sheetName, 53, 15, null),
					new ExpectedCellValue(sheetName, 54, 15, null),
					new ExpectedCellValue(sheetName, 55, 15, null),
					new ExpectedCellValue(sheetName, 56, 15, null),
					new ExpectedCellValue(sheetName, 57, 15, null),
					new ExpectedCellValue(sheetName, 58, 15, 99d),
					new ExpectedCellValue(sheetName, 59, 15, null),
					new ExpectedCellValue(sheetName, 60, 15, 1d),
					new ExpectedCellValue(sheetName, 61, 15, null),
					new ExpectedCellValue(sheetName, 62, 15, 99d),
					new ExpectedCellValue(sheetName, 63, 15, 99d),
					new ExpectedCellValue(sheetName, 64, 15, 1d),
					new ExpectedCellValue(sheetName, 65, 15, 99d),
					new ExpectedCellValue(sheetName, 66, 15, null),
					new ExpectedCellValue(sheetName, 67, 15, null),
					new ExpectedCellValue(sheetName, 68, 15, null),
					new ExpectedCellValue(sheetName, 69, 15, null),
					new ExpectedCellValue(sheetName, 70, 15, null),
					new ExpectedCellValue(sheetName, 71, 15, null),
					new ExpectedCellValue(sheetName, 72, 15, null),
					new ExpectedCellValue(sheetName, 73, 15, null),
					new ExpectedCellValue(sheetName, 74, 15, null),
					new ExpectedCellValue(sheetName, 75, 15, null),
					new ExpectedCellValue(sheetName, 76, 15, 99d),
					new ExpectedCellValue(sheetName, 77, 15, 1d),
					new ExpectedCellValue(sheetName, 78, 15, 99d),
					new ExpectedCellValue(sheetName, 2, 16, "Tent"),
					new ExpectedCellValue(sheetName, 3, 16, "Nashville"),
					new ExpectedCellValue(sheetName, 4, 16, 2018),
					new ExpectedCellValue(sheetName, 5, 16, "Qtr2"),
					new ExpectedCellValue(sheetName, 6, 16, null),
					new ExpectedCellValue(sheetName, 7, 16, null),
					new ExpectedCellValue(sheetName, 8, 16, null),
					new ExpectedCellValue(sheetName, 9, 16, null),
					new ExpectedCellValue(sheetName, 10, 16, null),
					new ExpectedCellValue(sheetName, 11, 16, null),
					new ExpectedCellValue(sheetName, 12, 16, null),
					new ExpectedCellValue(sheetName, 13, 16, null),
					new ExpectedCellValue(sheetName, 14, 16, null),
					new ExpectedCellValue(sheetName, 15, 16, null),
					new ExpectedCellValue(sheetName, 16, 16, null),
					new ExpectedCellValue(sheetName, 17, 16, null),
					new ExpectedCellValue(sheetName, 18, 16, null),
					new ExpectedCellValue(sheetName, 19, 16, null),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, null),
					new ExpectedCellValue(sheetName, 28, 16, 199d),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, 6d),
					new ExpectedCellValue(sheetName, 31, 16, null),
					new ExpectedCellValue(sheetName, 32, 16, 1194d),
					new ExpectedCellValue(sheetName, 33, 16, 199d),
					new ExpectedCellValue(sheetName, 34, 16, 6d),
					new ExpectedCellValue(sheetName, 35, 16, 1194d),
					new ExpectedCellValue(sheetName, 36, 16, null),
					new ExpectedCellValue(sheetName, 37, 16, null),
					new ExpectedCellValue(sheetName, 38, 16, null),
					new ExpectedCellValue(sheetName, 39, 16, null),
					new ExpectedCellValue(sheetName, 40, 16, null),
					new ExpectedCellValue(sheetName, 41, 16, null),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, null),
					new ExpectedCellValue(sheetName, 45, 16, null),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, null),
					new ExpectedCellValue(sheetName, 48, 16, null),
					new ExpectedCellValue(sheetName, 49, 16, null),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, null),
					new ExpectedCellValue(sheetName, 53, 16, null),
					new ExpectedCellValue(sheetName, 54, 16, null),
					new ExpectedCellValue(sheetName, 55, 16, null),
					new ExpectedCellValue(sheetName, 56, 16, null),
					new ExpectedCellValue(sheetName, 57, 16, null),
					new ExpectedCellValue(sheetName, 58, 16, null),
					new ExpectedCellValue(sheetName, 59, 16, null),
					new ExpectedCellValue(sheetName, 60, 16, null),
					new ExpectedCellValue(sheetName, 61, 16, null),
					new ExpectedCellValue(sheetName, 62, 16, null),
					new ExpectedCellValue(sheetName, 63, 16, null),
					new ExpectedCellValue(sheetName, 64, 16, null),
					new ExpectedCellValue(sheetName, 65, 16, null),
					new ExpectedCellValue(sheetName, 66, 16, null),
					new ExpectedCellValue(sheetName, 67, 16, null),
					new ExpectedCellValue(sheetName, 68, 16, null),
					new ExpectedCellValue(sheetName, 69, 16, null),
					new ExpectedCellValue(sheetName, 70, 16, null),
					new ExpectedCellValue(sheetName, 71, 16, null),
					new ExpectedCellValue(sheetName, 72, 16, null),
					new ExpectedCellValue(sheetName, 73, 16, null),
					new ExpectedCellValue(sheetName, 74, 16, null),
					new ExpectedCellValue(sheetName, 75, 16, null),
					new ExpectedCellValue(sheetName, 76, 16, 199d),
					new ExpectedCellValue(sheetName, 77, 16, 6d),
					new ExpectedCellValue(sheetName, 78, 16, 1194d),
					new ExpectedCellValue(sheetName, 2, 17, null),
					new ExpectedCellValue(sheetName, 3, 17, "Nashville Total"),
					new ExpectedCellValue(sheetName, 4, 17, null),
					new ExpectedCellValue(sheetName, 5, 17, null),
					new ExpectedCellValue(sheetName, 6, 17, null),
					new ExpectedCellValue(sheetName, 7, 17, null),
					new ExpectedCellValue(sheetName, 8, 17, null),
					new ExpectedCellValue(sheetName, 9, 17, null),
					new ExpectedCellValue(sheetName, 10, 17, null),
					new ExpectedCellValue(sheetName, 11, 17, null),
					new ExpectedCellValue(sheetName, 12, 17, null),
					new ExpectedCellValue(sheetName, 13, 17, null),
					new ExpectedCellValue(sheetName, 14, 17, null),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, null),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, null),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, 199d),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, 6d),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, 1194d),
					new ExpectedCellValue(sheetName, 33, 17, 199d),
					new ExpectedCellValue(sheetName, 34, 17, 6d),
					new ExpectedCellValue(sheetName, 35, 17, 1194d),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 40, 17, null),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, null),
					new ExpectedCellValue(sheetName, 43, 17, null),
					new ExpectedCellValue(sheetName, 44, 17, null),
					new ExpectedCellValue(sheetName, 45, 17, null),
					new ExpectedCellValue(sheetName, 46, 17, null),
					new ExpectedCellValue(sheetName, 47, 17, null),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, null),
					new ExpectedCellValue(sheetName, 53, 17, null),
					new ExpectedCellValue(sheetName, 54, 17, null),
					new ExpectedCellValue(sheetName, 55, 17, null),
					new ExpectedCellValue(sheetName, 56, 17, null),
					new ExpectedCellValue(sheetName, 57, 17, null),
					new ExpectedCellValue(sheetName, 58, 17, null),
					new ExpectedCellValue(sheetName, 59, 17, null),
					new ExpectedCellValue(sheetName, 60, 17, null),
					new ExpectedCellValue(sheetName, 61, 17, null),
					new ExpectedCellValue(sheetName, 62, 17, null),
					new ExpectedCellValue(sheetName, 63, 17, null),
					new ExpectedCellValue(sheetName, 64, 17, null),
					new ExpectedCellValue(sheetName, 65, 17, null),
					new ExpectedCellValue(sheetName, 66, 17, null),
					new ExpectedCellValue(sheetName, 67, 17, null),
					new ExpectedCellValue(sheetName, 68, 17, null),
					new ExpectedCellValue(sheetName, 69, 17, null),
					new ExpectedCellValue(sheetName, 70, 17, null),
					new ExpectedCellValue(sheetName, 71, 17, null),
					new ExpectedCellValue(sheetName, 72, 17, null),
					new ExpectedCellValue(sheetName, 73, 17, null),
					new ExpectedCellValue(sheetName, 74, 17, null),
					new ExpectedCellValue(sheetName, 75, 17, null),
					new ExpectedCellValue(sheetName, 76, 17, 199d),
					new ExpectedCellValue(sheetName, 77, 17, 6d),
					new ExpectedCellValue(sheetName, 78, 17, 1194d),
					new ExpectedCellValue(sheetName, 2, 18, "Tent Total"),
					new ExpectedCellValue(sheetName, 3, 18, null),
					new ExpectedCellValue(sheetName, 4, 18, null),
					new ExpectedCellValue(sheetName, 5, 18, null),
					new ExpectedCellValue(sheetName, 6, 18, null),
					new ExpectedCellValue(sheetName, 7, 18, null),
					new ExpectedCellValue(sheetName, 8, 18, null),
					new ExpectedCellValue(sheetName, 9, 18, null),
					new ExpectedCellValue(sheetName, 10, 18, null),
					new ExpectedCellValue(sheetName, 11, 18, null),
					new ExpectedCellValue(sheetName, 12, 18, null),
					new ExpectedCellValue(sheetName, 13, 18, null),
					new ExpectedCellValue(sheetName, 14, 18, null),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, null),
					new ExpectedCellValue(sheetName, 18, 18, null),
					new ExpectedCellValue(sheetName, 19, 18, null),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, 199d),
					new ExpectedCellValue(sheetName, 29, 18, null),
					new ExpectedCellValue(sheetName, 30, 18, 6d),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, 1194d),
					new ExpectedCellValue(sheetName, 33, 18, 199d),
					new ExpectedCellValue(sheetName, 34, 18, 6d),
					new ExpectedCellValue(sheetName, 35, 18, 1194d),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, null),
					new ExpectedCellValue(sheetName, 38, 18, null),
					new ExpectedCellValue(sheetName, 39, 18, null),
					new ExpectedCellValue(sheetName, 40, 18, null),
					new ExpectedCellValue(sheetName, 41, 18, null),
					new ExpectedCellValue(sheetName, 42, 18, null),
					new ExpectedCellValue(sheetName, 43, 18, null),
					new ExpectedCellValue(sheetName, 44, 18, null),
					new ExpectedCellValue(sheetName, 45, 18, null),
					new ExpectedCellValue(sheetName, 46, 18, null),
					new ExpectedCellValue(sheetName, 47, 18, null),
					new ExpectedCellValue(sheetName, 48, 18, null),
					new ExpectedCellValue(sheetName, 49, 18, null),
					new ExpectedCellValue(sheetName, 50, 18, null),
					new ExpectedCellValue(sheetName, 51, 18, null),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, null),
					new ExpectedCellValue(sheetName, 54, 18, null),
					new ExpectedCellValue(sheetName, 55, 18, null),
					new ExpectedCellValue(sheetName, 56, 18, null),
					new ExpectedCellValue(sheetName, 57, 18, null),
					new ExpectedCellValue(sheetName, 58, 18, null),
					new ExpectedCellValue(sheetName, 59, 18, null),
					new ExpectedCellValue(sheetName, 60, 18, null),
					new ExpectedCellValue(sheetName, 61, 18, null),
					new ExpectedCellValue(sheetName, 62, 18, null),
					new ExpectedCellValue(sheetName, 63, 18, null),
					new ExpectedCellValue(sheetName, 64, 18, null),
					new ExpectedCellValue(sheetName, 65, 18, null),
					new ExpectedCellValue(sheetName, 66, 18, null),
					new ExpectedCellValue(sheetName, 67, 18, null),
					new ExpectedCellValue(sheetName, 68, 18, null),
					new ExpectedCellValue(sheetName, 69, 18, null),
					new ExpectedCellValue(sheetName, 70, 18, null),
					new ExpectedCellValue(sheetName, 71, 18, null),
					new ExpectedCellValue(sheetName, 72, 18, null),
					new ExpectedCellValue(sheetName, 73, 18, null),
					new ExpectedCellValue(sheetName, 74, 18, null),
					new ExpectedCellValue(sheetName, 75, 18, null),
					new ExpectedCellValue(sheetName, 76, 18, 199d),
					new ExpectedCellValue(sheetName, 77, 18, 6d),
					new ExpectedCellValue(sheetName, 78, 18, 1194d),

					new ExpectedCellValue(sheetName, 2, 19, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 19, null),
					new ExpectedCellValue(sheetName, 4, 19, null),
					new ExpectedCellValue(sheetName, 5, 19, null),
					new ExpectedCellValue(sheetName, 6, 19, null),
					new ExpectedCellValue(sheetName, 7, 19, null),
					new ExpectedCellValue(sheetName, 8, 19, 415.75),
					new ExpectedCellValue(sheetName, 9, 19, null),
					new ExpectedCellValue(sheetName, 10, 19, 2d),
					new ExpectedCellValue(sheetName, 11, 19, null),
					new ExpectedCellValue(sheetName, 12, 19, 831.5),
					new ExpectedCellValue(sheetName, 13, 19, 415.75),
					new ExpectedCellValue(sheetName, 14, 19, 2d),
					new ExpectedCellValue(sheetName, 15, 19, 831.5),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, 415.75),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, 2d),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, 831.5),
					new ExpectedCellValue(sheetName, 23, 19, 415.75),
					new ExpectedCellValue(sheetName, 24, 19, 2d),
					new ExpectedCellValue(sheetName, 25, 19, 831.5),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, 199d),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, 6d),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, 1194d),
					new ExpectedCellValue(sheetName, 33, 19, 199d),
					new ExpectedCellValue(sheetName, 34, 19, 6d),
					new ExpectedCellValue(sheetName, 35, 19, 1194d),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, 415.75),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, 1d),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, 415.75),
					new ExpectedCellValue(sheetName, 43, 19, 415.75),
					new ExpectedCellValue(sheetName, 44, 19, 1d),
					new ExpectedCellValue(sheetName, 45, 19, 415.75),
					new ExpectedCellValue(sheetName, 46, 19, null),
					new ExpectedCellValue(sheetName, 47, 19, null),
					new ExpectedCellValue(sheetName, 48, 19, 24.99),
					new ExpectedCellValue(sheetName, 49, 19, null),
					new ExpectedCellValue(sheetName, 50, 19, 1d),
					new ExpectedCellValue(sheetName, 51, 19, null),
					new ExpectedCellValue(sheetName, 52, 19, 24.99),
					new ExpectedCellValue(sheetName, 53, 19, 24.99),
					new ExpectedCellValue(sheetName, 54, 19, 1d),
					new ExpectedCellValue(sheetName, 55, 19, 24.99),
					new ExpectedCellValue(sheetName, 56, 19, null),
					new ExpectedCellValue(sheetName, 57, 19, null),
					new ExpectedCellValue(sheetName, 58, 19, 99d),
					new ExpectedCellValue(sheetName, 59, 19, null),
					new ExpectedCellValue(sheetName, 60, 19, 1d),
					new ExpectedCellValue(sheetName, 61, 19, null),
					new ExpectedCellValue(sheetName, 62, 19, 99d),
					new ExpectedCellValue(sheetName, 63, 19, 99d),
					new ExpectedCellValue(sheetName, 64, 19, 1d),
					new ExpectedCellValue(sheetName, 65, 19, 99d),
					new ExpectedCellValue(sheetName, 66, 19, null),
					new ExpectedCellValue(sheetName, 67, 19, null),
					new ExpectedCellValue(sheetName, 68, 19, 415.75),
					new ExpectedCellValue(sheetName, 69, 19, null),
					new ExpectedCellValue(sheetName, 70, 19, 2d),
					new ExpectedCellValue(sheetName, 71, 19, null),
					new ExpectedCellValue(sheetName, 72, 19, 831.5),
					new ExpectedCellValue(sheetName, 73, 19, 415.75),
					new ExpectedCellValue(sheetName, 74, 19, 2d),
					new ExpectedCellValue(sheetName, 75, 19, 831.5),
					new ExpectedCellValue(sheetName, 76, 19, 1985.99),
					new ExpectedCellValue(sheetName, 77, 19, 15d),
					new ExpectedCellValue(sheetName, 78, 19, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingByDays.xlsx")]
		public void PivotTableRefreshDateGroupingWithDaysOnly()
		{
			var file = new FileInfo("PivotTableDateGroupingByDays.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet2"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					var cacheDefinition = package.Workbook.PivotCacheDefinitions.Single();
					cacheDefinition.UpdateData();
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(369, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet2";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "9-Feb"),
					new ExpectedCellValue(sheetName, 3, 1, "29-Mar"),
					new ExpectedCellValue(sheetName, 4, 1, "4-May"),
					new ExpectedCellValue(sheetName, 5, 1, "28-May"),
					new ExpectedCellValue(sheetName, 6, 1, "19-Oct"),
					new ExpectedCellValue(sheetName, 7, 1, "3-Nov"),
					new ExpectedCellValue(sheetName, 8, 1, "9-Dec"),
					new ExpectedCellValue(sheetName, 9, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, 831.5),
					new ExpectedCellValue(sheetName, 3, 2, 24.99),
					new ExpectedCellValue(sheetName, 4, 2, 1194d),
					new ExpectedCellValue(sheetName, 5, 2, 831.5),
					new ExpectedCellValue(sheetName, 6, 2, 831.5),
					new ExpectedCellValue(sheetName, 7, 2, 415.75),
					new ExpectedCellValue(sheetName, 8, 2, 99d),
					new ExpectedCellValue(sheetName, 9, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingByTime.xlsx")]
		public void PivotTableRefreshDateGroupingWithHoursOnly()
		{
			var file = new FileInfo("PivotTableDateGroupingByTime.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Hours"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(27, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Hours";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 13, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 14, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 12, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 2, 4228.24),
					new ExpectedCellValue(sheetName, 14, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingByTime.xlsx")]
		public void PivotTableRefreshDateGroupingWithMinutesOnly()
		{
			var file = new FileInfo("PivotTableDateGroupingByTime.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Minutes"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A12:B14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(63, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Minutes";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 13, 1, ":00"),
					new ExpectedCellValue(sheetName, 14, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 12, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 2, 4228.24),
					new ExpectedCellValue(sheetName, 14, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingByTime.xlsx")]
		public void PivotTableRefreshDateGroupingWithSecondsOnly()
		{
			var file = new FileInfo("PivotTableDateGroupingByTime.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Seconds"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A12:B14"), pivotTable.Address);
					Assert.AreEqual(7, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(63, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Seconds";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 13, 1, ":00"),
					new ExpectedCellValue(sheetName, 14, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 12, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 13, 2, 4228.24),
					new ExpectedCellValue(sheetName, 14, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingAllTypes.xlsx")]
		public void PivotTableRefreshDateGroupingAllTypes()
		{
			var file = new FileInfo("PivotTableDateGroupingAllTypes.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet2"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B45"), pivotTable.Address);
					Assert.AreEqual(13, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(63, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(63, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(27, pivotTable.Fields[8].Items.Count);
					Assert.AreEqual(369, pivotTable.Fields[9].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[10].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[11].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[12].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet2";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
						new ExpectedCellValue(sheetName, 2, 1, 2016),
						new ExpectedCellValue(sheetName, 3, 1, "Qtr2"),
						new ExpectedCellValue(sheetName, 4, 1, "May"),
						new ExpectedCellValue(sheetName, 5, 1, "28-May"),
						new ExpectedCellValue(sheetName, 6, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 7, 1, ":00"),
						new ExpectedCellValue(sheetName, 8, 1, ":00"),
						new ExpectedCellValue(sheetName, 9, 1, 2017),
						new ExpectedCellValue(sheetName, 10, 1, "Qtr4"),
						new ExpectedCellValue(sheetName, 11, 1, "Oct"),
						new ExpectedCellValue(sheetName, 12, 1, "19-Oct"),
						new ExpectedCellValue(sheetName, 13, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 14, 1, ":00"),
						new ExpectedCellValue(sheetName, 15, 1, ":00"),
						new ExpectedCellValue(sheetName, 16, 1, "Dec"),
						new ExpectedCellValue(sheetName, 17, 1, "9-Dec"),
						new ExpectedCellValue(sheetName, 18, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 19, 1, ":00"),
						new ExpectedCellValue(sheetName, 20, 1, ":00"),
						new ExpectedCellValue(sheetName, 21, 1, 2018),
						new ExpectedCellValue(sheetName, 22, 1, "Qtr1"),
						new ExpectedCellValue(sheetName, 23, 1, "Feb"),
						new ExpectedCellValue(sheetName, 24, 1, "9-Feb"),
						new ExpectedCellValue(sheetName, 25, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 26, 1, ":00"),
						new ExpectedCellValue(sheetName, 27, 1, ":00"),
						new ExpectedCellValue(sheetName, 28, 1, "Mar"),
						new ExpectedCellValue(sheetName, 29, 1, "29-Mar"),
						new ExpectedCellValue(sheetName, 30, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 31, 1, ":00"),
						new ExpectedCellValue(sheetName, 32, 1, ":00"),
						new ExpectedCellValue(sheetName, 33, 1, "Qtr2"),
						new ExpectedCellValue(sheetName, 34, 1, "May"),
						new ExpectedCellValue(sheetName, 35, 1, "4-May"),
						new ExpectedCellValue(sheetName, 36, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 37, 1, ":00"),
						new ExpectedCellValue(sheetName, 38, 1, ":00"),
						new ExpectedCellValue(sheetName, 39, 1, "Qtr4"),
						new ExpectedCellValue(sheetName, 40, 1, "Nov"),
						new ExpectedCellValue(sheetName, 41, 1, "3-Nov"),
						new ExpectedCellValue(sheetName, 42, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 43, 1, ":00"),
						new ExpectedCellValue(sheetName, 44, 1, ":00"),
						new ExpectedCellValue(sheetName, 45, 1, "Grand Total"),
						new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
						new ExpectedCellValue(sheetName, 2, 2, 831.5),
						new ExpectedCellValue(sheetName, 3, 2, 831.5),
						new ExpectedCellValue(sheetName, 4, 2, 831.5),
						new ExpectedCellValue(sheetName, 5, 2, 831.5),
						new ExpectedCellValue(sheetName, 6, 2, 831.5),
						new ExpectedCellValue(sheetName, 7, 2, 831.5),
						new ExpectedCellValue(sheetName, 8, 2, 831.5),
						new ExpectedCellValue(sheetName, 9, 2, 930.5),
						new ExpectedCellValue(sheetName, 10, 2, 930.5),
						new ExpectedCellValue(sheetName, 11, 2, 831.5),
						new ExpectedCellValue(sheetName, 12, 2, 831.5),
						new ExpectedCellValue(sheetName, 13, 2, 831.5),
						new ExpectedCellValue(sheetName, 14, 2, 831.5),
						new ExpectedCellValue(sheetName, 15, 2, 831.5),
						new ExpectedCellValue(sheetName, 16, 2, 99d),
						new ExpectedCellValue(sheetName, 17, 2, 99d),
						new ExpectedCellValue(sheetName, 18, 2, 99d),
						new ExpectedCellValue(sheetName, 19, 2, 99d),
						new ExpectedCellValue(sheetName, 20, 2, 99d),
						new ExpectedCellValue(sheetName, 21, 2, 2466.24),
						new ExpectedCellValue(sheetName, 22, 2, 856.49),
						new ExpectedCellValue(sheetName, 23, 2, 831.5),
						new ExpectedCellValue(sheetName, 24, 2, 831.5),
						new ExpectedCellValue(sheetName, 25, 2, 831.5),
						new ExpectedCellValue(sheetName, 26, 2, 831.5),
						new ExpectedCellValue(sheetName, 27, 2, 831.5),
						new ExpectedCellValue(sheetName, 28, 2, 24.99),
						new ExpectedCellValue(sheetName, 29, 2, 24.99),
						new ExpectedCellValue(sheetName, 30, 2, 24.99),
						new ExpectedCellValue(sheetName, 31, 2, 24.99),
						new ExpectedCellValue(sheetName, 32, 2, 24.99),
						new ExpectedCellValue(sheetName, 33, 2, 1194d),
						new ExpectedCellValue(sheetName, 34, 2, 1194d),
						new ExpectedCellValue(sheetName, 35, 2, 1194d),
						new ExpectedCellValue(sheetName, 36, 2, 1194d),
						new ExpectedCellValue(sheetName, 37, 2, 1194d),
						new ExpectedCellValue(sheetName, 38, 2, 1194d),
						new ExpectedCellValue(sheetName, 39, 2, 415.75),
						new ExpectedCellValue(sheetName, 40, 2, 415.75),
						new ExpectedCellValue(sheetName, 41, 2, 415.75),
						new ExpectedCellValue(sheetName, 42, 2, 415.75),
						new ExpectedCellValue(sheetName, 43, 2, 415.75),
						new ExpectedCellValue(sheetName, 44, 2, 415.75),
						new ExpectedCellValue(sheetName, 45, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateGroupingAllTypes.xlsx")]
		public void PivotTableRefreshDateGroupingAllTypesWithColumnFields()
		{
			var file = new FileInfo("PivotTableDateGroupingAllTypes.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["Sheet3"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:R151"), pivotTable.Address);
					Assert.AreEqual(13, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(63, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(63, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(27, pivotTable.Fields[8].Items.Count);
					Assert.AreEqual(369, pivotTable.Fields[9].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[10].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[11].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[12].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet3";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
						new ExpectedCellValue(sheetName, 5, 1, 2016),
						new ExpectedCellValue(sheetName, 6, 1, "Qtr2"),
						new ExpectedCellValue(sheetName, 7, 1, "28-May"),
						new ExpectedCellValue(sheetName, 8, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 9, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 10, 1, ":00"),
						new ExpectedCellValue(sheetName, 11, 1, ":00"),
						new ExpectedCellValue(sheetName, 12, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 13, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 14, 1, ":00"),
						new ExpectedCellValue(sheetName, 15, 1, ":00"),
						new ExpectedCellValue(sheetName, 16, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 17, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 18, 1, ":00"),
						new ExpectedCellValue(sheetName, 19, 1, ":00"),
						new ExpectedCellValue(sheetName, 20, 1, "28-May Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 21, 1, "28-May Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 22, 1, "28-May Sum of Total"),
						new ExpectedCellValue(sheetName, 23, 1, "Qtr2 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 24, 1, "Qtr2 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 25, 1, "Qtr2 Sum of Total"),
						new ExpectedCellValue(sheetName, 26, 1, "2016 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 27, 1, "2016 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 28, 1, "2016 Sum of Total"),
						new ExpectedCellValue(sheetName, 29, 1, "2017"),
						new ExpectedCellValue(sheetName, 30, 1, "Qtr4"),
						new ExpectedCellValue(sheetName, 31, 1, "19-Oct"),
						new ExpectedCellValue(sheetName, 32, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 33, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 34, 1, ":00"),
						new ExpectedCellValue(sheetName, 35, 1, ":00"),
						new ExpectedCellValue(sheetName, 36, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 37, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 38, 1, ":00"),
						new ExpectedCellValue(sheetName, 39, 1, ":00"),
						new ExpectedCellValue(sheetName, 40, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 41, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 42, 1, ":00"),
						new ExpectedCellValue(sheetName, 43, 1, ":00"),
						new ExpectedCellValue(sheetName, 44, 1, "19-Oct Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 45, 1, "19-Oct Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 46, 1, "19-Oct Sum of Total"),
						new ExpectedCellValue(sheetName, 47, 1, "9-Dec"),
						new ExpectedCellValue(sheetName, 48, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 49, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 50, 1, ":00"),
						new ExpectedCellValue(sheetName, 51, 1, ":00"),
						new ExpectedCellValue(sheetName, 52, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 53, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 54, 1, ":00"),
						new ExpectedCellValue(sheetName, 55, 1, ":00"),
						new ExpectedCellValue(sheetName, 56, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 57, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 58, 1, ":00"),
						new ExpectedCellValue(sheetName, 59, 1, ":00"),
						new ExpectedCellValue(sheetName, 60, 1, "9-Dec Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 61, 1, "9-Dec Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 62, 1, "9-Dec Sum of Total"),
						new ExpectedCellValue(sheetName, 63, 1, "Qtr4 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 64, 1, "Qtr4 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 65, 1, "Qtr4 Sum of Total"),
						new ExpectedCellValue(sheetName, 66, 1, "2017 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 67, 1, "2017 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 68, 1, "2017 Sum of Total"),
						new ExpectedCellValue(sheetName, 69, 1, "2018"),
						new ExpectedCellValue(sheetName, 70, 1, "Qtr1"),
						new ExpectedCellValue(sheetName, 71, 1, "9-Feb"),
						new ExpectedCellValue(sheetName, 72, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 73, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 74, 1, ":00"),
						new ExpectedCellValue(sheetName, 75, 1, ":00"),
						new ExpectedCellValue(sheetName, 76, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 77, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 78, 1, ":00"),
						new ExpectedCellValue(sheetName, 79, 1, ":00"),
						new ExpectedCellValue(sheetName, 80, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 81, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 82, 1, ":00"),
						new ExpectedCellValue(sheetName, 83, 1, ":00"),
						new ExpectedCellValue(sheetName, 84, 1, "9-Feb Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 85, 1, "9-Feb Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 86, 1, "9-Feb Sum of Total"),
						new ExpectedCellValue(sheetName, 87, 1, "29-Mar"),
						new ExpectedCellValue(sheetName, 88, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 89, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 90, 1, ":00"),
						new ExpectedCellValue(sheetName, 91, 1, ":00"),
						new ExpectedCellValue(sheetName, 92, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 93, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 94, 1, ":00"),
						new ExpectedCellValue(sheetName, 95, 1, ":00"),
						new ExpectedCellValue(sheetName, 96, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 97, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 98, 1, ":00"),
						new ExpectedCellValue(sheetName, 99, 1, ":00"),
						new ExpectedCellValue(sheetName, 100, 1, "29-Mar Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 101, 1, "29-Mar Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 102, 1, "29-Mar Sum of Total"),
						new ExpectedCellValue(sheetName, 103, 1, "Qtr1 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 104, 1, "Qtr1 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 105, 1, "Qtr1 Sum of Total"),
						new ExpectedCellValue(sheetName, 106, 1, "Qtr2"),
						new ExpectedCellValue(sheetName, 107, 1, "4-May"),
						new ExpectedCellValue(sheetName, 108, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 109, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 110, 1, ":00"),
						new ExpectedCellValue(sheetName, 111, 1, ":00"),
						new ExpectedCellValue(sheetName, 112, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 113, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 114, 1, ":00"),
						new ExpectedCellValue(sheetName, 115, 1, ":00"),
						new ExpectedCellValue(sheetName, 116, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 117, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 118, 1, ":00"),
						new ExpectedCellValue(sheetName, 119, 1, ":00"),
						new ExpectedCellValue(sheetName, 120, 1, "4-May Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 121, 1, "4-May Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 122, 1, "4-May Sum of Total"),
						new ExpectedCellValue(sheetName, 123, 1, "Qtr2 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 124, 1, "Qtr2 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 125, 1, "Qtr2 Sum of Total"),
						new ExpectedCellValue(sheetName, 126, 1, "Qtr4"),
						new ExpectedCellValue(sheetName, 127, 1, "3-Nov"),
						new ExpectedCellValue(sheetName, 128, 1, "Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 129, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 130, 1, ":00"),
						new ExpectedCellValue(sheetName, 131, 1, ":00"),
						new ExpectedCellValue(sheetName, 132, 1, "Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 133, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 134, 1, ":00"),
						new ExpectedCellValue(sheetName, 135, 1, ":00"),
						new ExpectedCellValue(sheetName, 136, 1, "Sum of Total"),
						new ExpectedCellValue(sheetName, 137, 1, "12 AM"),
						new ExpectedCellValue(sheetName, 138, 1, ":00"),
						new ExpectedCellValue(sheetName, 139, 1, ":00"),
						new ExpectedCellValue(sheetName, 140, 1, "3-Nov Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 141, 1, "3-Nov Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 142, 1, "3-Nov Sum of Total"),
						new ExpectedCellValue(sheetName, 143, 1, "Qtr4 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 144, 1, "Qtr4 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 145, 1, "Qtr4 Sum of Total"),
						new ExpectedCellValue(sheetName, 146, 1, "2018 Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 147, 1, "2018 Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 148, 1, "2018 Sum of Total"),
						new ExpectedCellValue(sheetName, 149, 1, "Total Sum of Wholesale Price"),
						new ExpectedCellValue(sheetName, 150, 1, "Total Sum of Units Sold"),
						new ExpectedCellValue(sheetName, 151, 1, "Total Sum of Total"),
						new ExpectedCellValue(sheetName, 2, 2, "Chicago"),
						new ExpectedCellValue(sheetName, 3, 2, "Car Rack"),
						new ExpectedCellValue(sheetName, 4, 2, "May"),
						new ExpectedCellValue(sheetName, 5, 2, null),
						new ExpectedCellValue(sheetName, 6, 2, null),
						new ExpectedCellValue(sheetName, 7, 2, null),
						new ExpectedCellValue(sheetName, 8, 2, null),
						new ExpectedCellValue(sheetName, 9, 2, 415.75),
						new ExpectedCellValue(sheetName, 10, 2, 415.75),
						new ExpectedCellValue(sheetName, 11, 2, 415.75),
						new ExpectedCellValue(sheetName, 12, 2, null),
						new ExpectedCellValue(sheetName, 13, 2, 2d),
						new ExpectedCellValue(sheetName, 14, 2, 2d),
						new ExpectedCellValue(sheetName, 15, 2, 2d),
						new ExpectedCellValue(sheetName, 16, 2, null),
						new ExpectedCellValue(sheetName, 17, 2, 831.5),
						new ExpectedCellValue(sheetName, 18, 2, 831.5),
						new ExpectedCellValue(sheetName, 19, 2, 831.5),
						new ExpectedCellValue(sheetName, 20, 2, 415.75),
						new ExpectedCellValue(sheetName, 21, 2, 2d),
						new ExpectedCellValue(sheetName, 22, 2, 831.5),
						new ExpectedCellValue(sheetName, 23, 2, 415.75),
						new ExpectedCellValue(sheetName, 24, 2, 2d),
						new ExpectedCellValue(sheetName, 25, 2, 831.5),
						new ExpectedCellValue(sheetName, 26, 2, 415.75),
						new ExpectedCellValue(sheetName, 27, 2, 2d),
						new ExpectedCellValue(sheetName, 28, 2, 831.5),
						new ExpectedCellValue(sheetName, 29, 2, null),
						new ExpectedCellValue(sheetName, 30, 2, null),
						new ExpectedCellValue(sheetName, 31, 2, null),
						new ExpectedCellValue(sheetName, 32, 2, null),
						new ExpectedCellValue(sheetName, 33, 2, null),
						new ExpectedCellValue(sheetName, 34, 2, null),
						new ExpectedCellValue(sheetName, 35, 2, null),
						new ExpectedCellValue(sheetName, 36, 2, null),
						new ExpectedCellValue(sheetName, 37, 2, null),
						new ExpectedCellValue(sheetName, 38, 2, null),
						new ExpectedCellValue(sheetName, 39, 2, null),
						new ExpectedCellValue(sheetName, 40, 2, null),
						new ExpectedCellValue(sheetName, 41, 2, null),
						new ExpectedCellValue(sheetName, 42, 2, null),
						new ExpectedCellValue(sheetName, 43, 2, null),
						new ExpectedCellValue(sheetName, 44, 2, null),
						new ExpectedCellValue(sheetName, 45, 2, null),
						new ExpectedCellValue(sheetName, 46, 2, null),
						new ExpectedCellValue(sheetName, 47, 2, null),
						new ExpectedCellValue(sheetName, 48, 2, null),
						new ExpectedCellValue(sheetName, 49, 2, null),
						new ExpectedCellValue(sheetName, 50, 2, null),
						new ExpectedCellValue(sheetName, 51, 2, null),
						new ExpectedCellValue(sheetName, 52, 2, null),
						new ExpectedCellValue(sheetName, 53, 2, null),
						new ExpectedCellValue(sheetName, 54, 2, null),
						new ExpectedCellValue(sheetName, 55, 2, null),
						new ExpectedCellValue(sheetName, 56, 2, null),
						new ExpectedCellValue(sheetName, 57, 2, null),
						new ExpectedCellValue(sheetName, 58, 2, null),
						new ExpectedCellValue(sheetName, 59, 2, null),
						new ExpectedCellValue(sheetName, 60, 2, null),
						new ExpectedCellValue(sheetName, 61, 2, null),
						new ExpectedCellValue(sheetName, 62, 2, null),
						new ExpectedCellValue(sheetName, 63, 2, null),
						new ExpectedCellValue(sheetName, 64, 2, null),
						new ExpectedCellValue(sheetName, 65, 2, null),
						new ExpectedCellValue(sheetName, 66, 2, null),
						new ExpectedCellValue(sheetName, 67, 2, null),
						new ExpectedCellValue(sheetName, 68, 2, null),
						new ExpectedCellValue(sheetName, 69, 2, null),
						new ExpectedCellValue(sheetName, 70, 2, null),
						new ExpectedCellValue(sheetName, 71, 2, null),
						new ExpectedCellValue(sheetName, 72, 2, null),
						new ExpectedCellValue(sheetName, 73, 2, null),
						new ExpectedCellValue(sheetName, 74, 2, null),
						new ExpectedCellValue(sheetName, 75, 2, null),
						new ExpectedCellValue(sheetName, 76, 2, null),
						new ExpectedCellValue(sheetName, 77, 2, null),
						new ExpectedCellValue(sheetName, 78, 2, null),
						new ExpectedCellValue(sheetName, 79, 2, null),
						new ExpectedCellValue(sheetName, 80, 2, null),
						new ExpectedCellValue(sheetName, 81, 2, null),
						new ExpectedCellValue(sheetName, 82, 2, null),
						new ExpectedCellValue(sheetName, 83, 2, null),
						new ExpectedCellValue(sheetName, 84, 2, null),
						new ExpectedCellValue(sheetName, 85, 2, null),
						new ExpectedCellValue(sheetName, 86, 2, null),
						new ExpectedCellValue(sheetName, 87, 2, null),
						new ExpectedCellValue(sheetName, 88, 2, null),
						new ExpectedCellValue(sheetName, 89, 2, null),
						new ExpectedCellValue(sheetName, 90, 2, null),
						new ExpectedCellValue(sheetName, 91, 2, null),
						new ExpectedCellValue(sheetName, 92, 2, null),
						new ExpectedCellValue(sheetName, 93, 2, null),
						new ExpectedCellValue(sheetName, 94, 2, null),
						new ExpectedCellValue(sheetName, 95, 2, null),
						new ExpectedCellValue(sheetName, 96, 2, null),
						new ExpectedCellValue(sheetName, 97, 2, null),
						new ExpectedCellValue(sheetName, 98, 2, null),
						new ExpectedCellValue(sheetName, 99, 2, null),
						new ExpectedCellValue(sheetName, 100, 2, null),
						new ExpectedCellValue(sheetName, 101, 2, null),
						new ExpectedCellValue(sheetName, 102, 2, null),
						new ExpectedCellValue(sheetName, 103, 2, null),
						new ExpectedCellValue(sheetName, 104, 2, null),
						new ExpectedCellValue(sheetName, 105, 2, null),
						new ExpectedCellValue(sheetName, 106, 2, null),
						new ExpectedCellValue(sheetName, 107, 2, null),
						new ExpectedCellValue(sheetName, 108, 2, null),
						new ExpectedCellValue(sheetName, 109, 2, null),
						new ExpectedCellValue(sheetName, 110, 2, null),
						new ExpectedCellValue(sheetName, 111, 2, null),
						new ExpectedCellValue(sheetName, 112, 2, null),
						new ExpectedCellValue(sheetName, 113, 2, null),
						new ExpectedCellValue(sheetName, 114, 2, null),
						new ExpectedCellValue(sheetName, 115, 2, null),
						new ExpectedCellValue(sheetName, 116, 2, null),
						new ExpectedCellValue(sheetName, 117, 2, null),
						new ExpectedCellValue(sheetName, 118, 2, null),
						new ExpectedCellValue(sheetName, 119, 2, null),
						new ExpectedCellValue(sheetName, 120, 2, null),
						new ExpectedCellValue(sheetName, 121, 2, null),
						new ExpectedCellValue(sheetName, 122, 2, null),
						new ExpectedCellValue(sheetName, 123, 2, null),
						new ExpectedCellValue(sheetName, 124, 2, null),
						new ExpectedCellValue(sheetName, 125, 2, null),
						new ExpectedCellValue(sheetName, 126, 2, null),
						new ExpectedCellValue(sheetName, 127, 2, null),
						new ExpectedCellValue(sheetName, 128, 2, null),
						new ExpectedCellValue(sheetName, 129, 2, null),
						new ExpectedCellValue(sheetName, 130, 2, null),
						new ExpectedCellValue(sheetName, 131, 2, null),
						new ExpectedCellValue(sheetName, 132, 2, null),
						new ExpectedCellValue(sheetName, 133, 2, null),
						new ExpectedCellValue(sheetName, 134, 2, null),
						new ExpectedCellValue(sheetName, 135, 2, null),
						new ExpectedCellValue(sheetName, 136, 2, null),
						new ExpectedCellValue(sheetName, 137, 2, null),
						new ExpectedCellValue(sheetName, 138, 2, null),
						new ExpectedCellValue(sheetName, 139, 2, null),
						new ExpectedCellValue(sheetName, 140, 2, null),
						new ExpectedCellValue(sheetName, 141, 2, null),
						new ExpectedCellValue(sheetName, 142, 2, null),
						new ExpectedCellValue(sheetName, 143, 2, null),
						new ExpectedCellValue(sheetName, 144, 2, null),
						new ExpectedCellValue(sheetName, 145, 2, null),
						new ExpectedCellValue(sheetName, 146, 2, null),
						new ExpectedCellValue(sheetName, 147, 2, null),
						new ExpectedCellValue(sheetName, 148, 2, null),
						new ExpectedCellValue(sheetName, 149, 2, 415.75),
						new ExpectedCellValue(sheetName, 150, 2, 2d),
						new ExpectedCellValue(sheetName, 151, 2, 831.5),
						new ExpectedCellValue(sheetName, 2, 3, null),
						new ExpectedCellValue(sheetName, 3, 3, "Car Rack Total"),
						new ExpectedCellValue(sheetName, 4, 3, null),
						new ExpectedCellValue(sheetName, 5, 3, null),
						new ExpectedCellValue(sheetName, 6, 3, null),
						new ExpectedCellValue(sheetName, 7, 3, null),
						new ExpectedCellValue(sheetName, 8, 3, null),
						new ExpectedCellValue(sheetName, 9, 3, 415.75),
						new ExpectedCellValue(sheetName, 10, 3, 415.75),
						new ExpectedCellValue(sheetName, 11, 3, 415.75),
						new ExpectedCellValue(sheetName, 12, 3, null),
						new ExpectedCellValue(sheetName, 13, 3, 2d),
						new ExpectedCellValue(sheetName, 14, 3, 2d),
						new ExpectedCellValue(sheetName, 15, 3, 2d),
						new ExpectedCellValue(sheetName, 16, 3, null),
						new ExpectedCellValue(sheetName, 17, 3, 831.5),
						new ExpectedCellValue(sheetName, 18, 3, 831.5),
						new ExpectedCellValue(sheetName, 19, 3, 831.5),
						new ExpectedCellValue(sheetName, 20, 3, 415.75),
						new ExpectedCellValue(sheetName, 21, 3, 2d),
						new ExpectedCellValue(sheetName, 22, 3, 831.5),
						new ExpectedCellValue(sheetName, 23, 3, 415.75),
						new ExpectedCellValue(sheetName, 24, 3, 2d),
						new ExpectedCellValue(sheetName, 25, 3, 831.5),
						new ExpectedCellValue(sheetName, 26, 3, 415.75),
						new ExpectedCellValue(sheetName, 27, 3, 2d),
						new ExpectedCellValue(sheetName, 28, 3, 831.5),
						new ExpectedCellValue(sheetName, 29, 3, null),
						new ExpectedCellValue(sheetName, 30, 3, null),
						new ExpectedCellValue(sheetName, 31, 3, null),
						new ExpectedCellValue(sheetName, 32, 3, null),
						new ExpectedCellValue(sheetName, 33, 3, null),
						new ExpectedCellValue(sheetName, 34, 3, null),
						new ExpectedCellValue(sheetName, 35, 3, null),
						new ExpectedCellValue(sheetName, 36, 3, null),
						new ExpectedCellValue(sheetName, 37, 3, null),
						new ExpectedCellValue(sheetName, 38, 3, null),
						new ExpectedCellValue(sheetName, 39, 3, null),
						new ExpectedCellValue(sheetName, 40, 3, null),
						new ExpectedCellValue(sheetName, 41, 3, null),
						new ExpectedCellValue(sheetName, 42, 3, null),
						new ExpectedCellValue(sheetName, 43, 3, null),
						new ExpectedCellValue(sheetName, 44, 3, null),
						new ExpectedCellValue(sheetName, 45, 3, null),
						new ExpectedCellValue(sheetName, 46, 3, null),
						new ExpectedCellValue(sheetName, 47, 3, null),
						new ExpectedCellValue(sheetName, 48, 3, null),
						new ExpectedCellValue(sheetName, 49, 3, null),
						new ExpectedCellValue(sheetName, 50, 3, null),
						new ExpectedCellValue(sheetName, 51, 3, null),
						new ExpectedCellValue(sheetName, 52, 3, null),
						new ExpectedCellValue(sheetName, 53, 3, null),
						new ExpectedCellValue(sheetName, 54, 3, null),
						new ExpectedCellValue(sheetName, 55, 3, null),
						new ExpectedCellValue(sheetName, 56, 3, null),
						new ExpectedCellValue(sheetName, 57, 3, null),
						new ExpectedCellValue(sheetName, 58, 3, null),
						new ExpectedCellValue(sheetName, 59, 3, null),
						new ExpectedCellValue(sheetName, 60, 3, null),
						new ExpectedCellValue(sheetName, 61, 3, null),
						new ExpectedCellValue(sheetName, 62, 3, null),
						new ExpectedCellValue(sheetName, 63, 3, null),
						new ExpectedCellValue(sheetName, 64, 3, null),
						new ExpectedCellValue(sheetName, 65, 3, null),
						new ExpectedCellValue(sheetName, 66, 3, null),
						new ExpectedCellValue(sheetName, 67, 3, null),
						new ExpectedCellValue(sheetName, 68, 3, null),
						new ExpectedCellValue(sheetName, 69, 3, null),
						new ExpectedCellValue(sheetName, 70, 3, null),
						new ExpectedCellValue(sheetName, 71, 3, null),
						new ExpectedCellValue(sheetName, 72, 3, null),
						new ExpectedCellValue(sheetName, 73, 3, null),
						new ExpectedCellValue(sheetName, 74, 3, null),
						new ExpectedCellValue(sheetName, 75, 3, null),
						new ExpectedCellValue(sheetName, 76, 3, null),
						new ExpectedCellValue(sheetName, 77, 3, null),
						new ExpectedCellValue(sheetName, 78, 3, null),
						new ExpectedCellValue(sheetName, 79, 3, null),
						new ExpectedCellValue(sheetName, 80, 3, null),
						new ExpectedCellValue(sheetName, 81, 3, null),
						new ExpectedCellValue(sheetName, 82, 3, null),
						new ExpectedCellValue(sheetName, 83, 3, null),
						new ExpectedCellValue(sheetName, 84, 3, null),
						new ExpectedCellValue(sheetName, 85, 3, null),
						new ExpectedCellValue(sheetName, 86, 3, null),
						new ExpectedCellValue(sheetName, 87, 3, null),
						new ExpectedCellValue(sheetName, 88, 3, null),
						new ExpectedCellValue(sheetName, 89, 3, null),
						new ExpectedCellValue(sheetName, 90, 3, null),
						new ExpectedCellValue(sheetName, 91, 3, null),
						new ExpectedCellValue(sheetName, 92, 3, null),
						new ExpectedCellValue(sheetName, 93, 3, null),
						new ExpectedCellValue(sheetName, 94, 3, null),
						new ExpectedCellValue(sheetName, 95, 3, null),
						new ExpectedCellValue(sheetName, 96, 3, null),
						new ExpectedCellValue(sheetName, 97, 3, null),
						new ExpectedCellValue(sheetName, 98, 3, null),
						new ExpectedCellValue(sheetName, 99, 3, null),
						new ExpectedCellValue(sheetName, 100, 3, null),
						new ExpectedCellValue(sheetName, 101, 3, null),
						new ExpectedCellValue(sheetName, 102, 3, null),
						new ExpectedCellValue(sheetName, 103, 3, null),
						new ExpectedCellValue(sheetName, 104, 3, null),
						new ExpectedCellValue(sheetName, 105, 3, null),
						new ExpectedCellValue(sheetName, 106, 3, null),
						new ExpectedCellValue(sheetName, 107, 3, null),
						new ExpectedCellValue(sheetName, 108, 3, null),
						new ExpectedCellValue(sheetName, 109, 3, null),
						new ExpectedCellValue(sheetName, 110, 3, null),
						new ExpectedCellValue(sheetName, 111, 3, null),
						new ExpectedCellValue(sheetName, 112, 3, null),
						new ExpectedCellValue(sheetName, 113, 3, null),
						new ExpectedCellValue(sheetName, 114, 3, null),
						new ExpectedCellValue(sheetName, 115, 3, null),
						new ExpectedCellValue(sheetName, 116, 3, null),
						new ExpectedCellValue(sheetName, 117, 3, null),
						new ExpectedCellValue(sheetName, 118, 3, null),
						new ExpectedCellValue(sheetName, 119, 3, null),
						new ExpectedCellValue(sheetName, 120, 3, null),
						new ExpectedCellValue(sheetName, 121, 3, null),
						new ExpectedCellValue(sheetName, 122, 3, null),
						new ExpectedCellValue(sheetName, 123, 3, null),
						new ExpectedCellValue(sheetName, 124, 3, null),
						new ExpectedCellValue(sheetName, 125, 3, null),
						new ExpectedCellValue(sheetName, 126, 3, null),
						new ExpectedCellValue(sheetName, 127, 3, null),
						new ExpectedCellValue(sheetName, 128, 3, null),
						new ExpectedCellValue(sheetName, 129, 3, null),
						new ExpectedCellValue(sheetName, 130, 3, null),
						new ExpectedCellValue(sheetName, 131, 3, null),
						new ExpectedCellValue(sheetName, 132, 3, null),
						new ExpectedCellValue(sheetName, 133, 3, null),
						new ExpectedCellValue(sheetName, 134, 3, null),
						new ExpectedCellValue(sheetName, 135, 3, null),
						new ExpectedCellValue(sheetName, 136, 3, null),
						new ExpectedCellValue(sheetName, 137, 3, null),
						new ExpectedCellValue(sheetName, 138, 3, null),
						new ExpectedCellValue(sheetName, 139, 3, null),
						new ExpectedCellValue(sheetName, 140, 3, null),
						new ExpectedCellValue(sheetName, 141, 3, null),
						new ExpectedCellValue(sheetName, 142, 3, null),
						new ExpectedCellValue(sheetName, 143, 3, null),
						new ExpectedCellValue(sheetName, 144, 3, null),
						new ExpectedCellValue(sheetName, 145, 3, null),
						new ExpectedCellValue(sheetName, 146, 3, null),
						new ExpectedCellValue(sheetName, 147, 3, null),
						new ExpectedCellValue(sheetName, 148, 3, null),
						new ExpectedCellValue(sheetName, 149, 3, 415.75),
						new ExpectedCellValue(sheetName, 150, 3, 2d),
						new ExpectedCellValue(sheetName, 151, 3, 831.5),
						new ExpectedCellValue(sheetName, 2, 4, null),
						new ExpectedCellValue(sheetName, 3, 4, "Headlamp"),
						new ExpectedCellValue(sheetName, 4, 4, "Mar"),
						new ExpectedCellValue(sheetName, 5, 4, null),
						new ExpectedCellValue(sheetName, 6, 4, null),
						new ExpectedCellValue(sheetName, 7, 4, null),
						new ExpectedCellValue(sheetName, 8, 4, null),
						new ExpectedCellValue(sheetName, 9, 4, null),
						new ExpectedCellValue(sheetName, 10, 4, null),
						new ExpectedCellValue(sheetName, 11, 4, null),
						new ExpectedCellValue(sheetName, 12, 4, null),
						new ExpectedCellValue(sheetName, 13, 4, null),
						new ExpectedCellValue(sheetName, 14, 4, null),
						new ExpectedCellValue(sheetName, 15, 4, null),
						new ExpectedCellValue(sheetName, 16, 4, null),
						new ExpectedCellValue(sheetName, 17, 4, null),
						new ExpectedCellValue(sheetName, 18, 4, null),
						new ExpectedCellValue(sheetName, 19, 4, null),
						new ExpectedCellValue(sheetName, 20, 4, null),
						new ExpectedCellValue(sheetName, 21, 4, null),
						new ExpectedCellValue(sheetName, 22, 4, null),
						new ExpectedCellValue(sheetName, 23, 4, null),
						new ExpectedCellValue(sheetName, 24, 4, null),
						new ExpectedCellValue(sheetName, 25, 4, null),
						new ExpectedCellValue(sheetName, 26, 4, null),
						new ExpectedCellValue(sheetName, 27, 4, null),
						new ExpectedCellValue(sheetName, 28, 4, null),
						new ExpectedCellValue(sheetName, 29, 4, null),
						new ExpectedCellValue(sheetName, 30, 4, null),
						new ExpectedCellValue(sheetName, 31, 4, null),
						new ExpectedCellValue(sheetName, 32, 4, null),
						new ExpectedCellValue(sheetName, 33, 4, null),
						new ExpectedCellValue(sheetName, 34, 4, null),
						new ExpectedCellValue(sheetName, 35, 4, null),
						new ExpectedCellValue(sheetName, 36, 4, null),
						new ExpectedCellValue(sheetName, 37, 4, null),
						new ExpectedCellValue(sheetName, 38, 4, null),
						new ExpectedCellValue(sheetName, 39, 4, null),
						new ExpectedCellValue(sheetName, 40, 4, null),
						new ExpectedCellValue(sheetName, 41, 4, null),
						new ExpectedCellValue(sheetName, 42, 4, null),
						new ExpectedCellValue(sheetName, 43, 4, null),
						new ExpectedCellValue(sheetName, 44, 4, null),
						new ExpectedCellValue(sheetName, 45, 4, null),
						new ExpectedCellValue(sheetName, 46, 4, null),
						new ExpectedCellValue(sheetName, 47, 4, null),
						new ExpectedCellValue(sheetName, 48, 4, null),
						new ExpectedCellValue(sheetName, 49, 4, null),
						new ExpectedCellValue(sheetName, 50, 4, null),
						new ExpectedCellValue(sheetName, 51, 4, null),
						new ExpectedCellValue(sheetName, 52, 4, null),
						new ExpectedCellValue(sheetName, 53, 4, null),
						new ExpectedCellValue(sheetName, 54, 4, null),
						new ExpectedCellValue(sheetName, 55, 4, null),
						new ExpectedCellValue(sheetName, 56, 4, null),
						new ExpectedCellValue(sheetName, 57, 4, null),
						new ExpectedCellValue(sheetName, 58, 4, null),
						new ExpectedCellValue(sheetName, 59, 4, null),
						new ExpectedCellValue(sheetName, 60, 4, null),
						new ExpectedCellValue(sheetName, 61, 4, null),
						new ExpectedCellValue(sheetName, 62, 4, null),
						new ExpectedCellValue(sheetName, 63, 4, null),
						new ExpectedCellValue(sheetName, 64, 4, null),
						new ExpectedCellValue(sheetName, 65, 4, null),
						new ExpectedCellValue(sheetName, 66, 4, null),
						new ExpectedCellValue(sheetName, 67, 4, null),
						new ExpectedCellValue(sheetName, 68, 4, null),
						new ExpectedCellValue(sheetName, 69, 4, null),
						new ExpectedCellValue(sheetName, 70, 4, null),
						new ExpectedCellValue(sheetName, 71, 4, null),
						new ExpectedCellValue(sheetName, 72, 4, null),
						new ExpectedCellValue(sheetName, 73, 4, null),
						new ExpectedCellValue(sheetName, 74, 4, null),
						new ExpectedCellValue(sheetName, 75, 4, null),
						new ExpectedCellValue(sheetName, 76, 4, null),
						new ExpectedCellValue(sheetName, 77, 4, null),
						new ExpectedCellValue(sheetName, 78, 4, null),
						new ExpectedCellValue(sheetName, 79, 4, null),
						new ExpectedCellValue(sheetName, 80, 4, null),
						new ExpectedCellValue(sheetName, 81, 4, null),
						new ExpectedCellValue(sheetName, 82, 4, null),
						new ExpectedCellValue(sheetName, 83, 4, null),
						new ExpectedCellValue(sheetName, 84, 4, null),
						new ExpectedCellValue(sheetName, 85, 4, null),
						new ExpectedCellValue(sheetName, 86, 4, null),
						new ExpectedCellValue(sheetName, 87, 4, null),
						new ExpectedCellValue(sheetName, 88, 4, null),
						new ExpectedCellValue(sheetName, 89, 4, 24.99),
						new ExpectedCellValue(sheetName, 90, 4, 24.99),
						new ExpectedCellValue(sheetName, 91, 4, 24.99),
						new ExpectedCellValue(sheetName, 92, 4, null),
						new ExpectedCellValue(sheetName, 93, 4, 1d),
						new ExpectedCellValue(sheetName, 94, 4, 1d),
						new ExpectedCellValue(sheetName, 95, 4, 1d),
						new ExpectedCellValue(sheetName, 96, 4, null),
						new ExpectedCellValue(sheetName, 97, 4, 24.99),
						new ExpectedCellValue(sheetName, 98, 4, 24.99),
						new ExpectedCellValue(sheetName, 99, 4, 24.99),
						new ExpectedCellValue(sheetName, 100, 4, 24.99),
						new ExpectedCellValue(sheetName, 101, 4, 1d),
						new ExpectedCellValue(sheetName, 102, 4, 24.99),
						new ExpectedCellValue(sheetName, 103, 4, 24.99),
						new ExpectedCellValue(sheetName, 104, 4, 1d),
						new ExpectedCellValue(sheetName, 105, 4, 24.99),
						new ExpectedCellValue(sheetName, 106, 4, null),
						new ExpectedCellValue(sheetName, 107, 4, null),
						new ExpectedCellValue(sheetName, 108, 4, null),
						new ExpectedCellValue(sheetName, 109, 4, null),
						new ExpectedCellValue(sheetName, 110, 4, null),
						new ExpectedCellValue(sheetName, 111, 4, null),
						new ExpectedCellValue(sheetName, 112, 4, null),
						new ExpectedCellValue(sheetName, 113, 4, null),
						new ExpectedCellValue(sheetName, 114, 4, null),
						new ExpectedCellValue(sheetName, 115, 4, null),
						new ExpectedCellValue(sheetName, 116, 4, null),
						new ExpectedCellValue(sheetName, 117, 4, null),
						new ExpectedCellValue(sheetName, 118, 4, null),
						new ExpectedCellValue(sheetName, 119, 4, null),
						new ExpectedCellValue(sheetName, 120, 4, null),
						new ExpectedCellValue(sheetName, 121, 4, null),
						new ExpectedCellValue(sheetName, 122, 4, null),
						new ExpectedCellValue(sheetName, 123, 4, null),
						new ExpectedCellValue(sheetName, 124, 4, null),
						new ExpectedCellValue(sheetName, 125, 4, null),
						new ExpectedCellValue(sheetName, 126, 4, null),
						new ExpectedCellValue(sheetName, 127, 4, null),
						new ExpectedCellValue(sheetName, 128, 4, null),
						new ExpectedCellValue(sheetName, 129, 4, null),
						new ExpectedCellValue(sheetName, 130, 4, null),
						new ExpectedCellValue(sheetName, 131, 4, null),
						new ExpectedCellValue(sheetName, 132, 4, null),
						new ExpectedCellValue(sheetName, 133, 4, null),
						new ExpectedCellValue(sheetName, 134, 4, null),
						new ExpectedCellValue(sheetName, 135, 4, null),
						new ExpectedCellValue(sheetName, 136, 4, null),
						new ExpectedCellValue(sheetName, 137, 4, null),
						new ExpectedCellValue(sheetName, 138, 4, null),
						new ExpectedCellValue(sheetName, 139, 4, null),
						new ExpectedCellValue(sheetName, 140, 4, null),
						new ExpectedCellValue(sheetName, 141, 4, null),
						new ExpectedCellValue(sheetName, 142, 4, null),
						new ExpectedCellValue(sheetName, 143, 4, null),
						new ExpectedCellValue(sheetName, 144, 4, null),
						new ExpectedCellValue(sheetName, 145, 4, null),
						new ExpectedCellValue(sheetName, 146, 4, 24.99),
						new ExpectedCellValue(sheetName, 147, 4, 1d),
						new ExpectedCellValue(sheetName, 148, 4, 24.99),
						new ExpectedCellValue(sheetName, 149, 4, 24.99),
						new ExpectedCellValue(sheetName, 150, 4, 1d),
						new ExpectedCellValue(sheetName, 151, 4, 24.99),
						new ExpectedCellValue(sheetName, 2, 5, null),
						new ExpectedCellValue(sheetName, 3, 5, "Headlamp Total"),
						new ExpectedCellValue(sheetName, 4, 5, null),
						new ExpectedCellValue(sheetName, 5, 5, null),
						new ExpectedCellValue(sheetName, 6, 5, null),
						new ExpectedCellValue(sheetName, 7, 5, null),
						new ExpectedCellValue(sheetName, 8, 5, null),
						new ExpectedCellValue(sheetName, 9, 5, null),
						new ExpectedCellValue(sheetName, 10, 5, null),
						new ExpectedCellValue(sheetName, 11, 5, null),
						new ExpectedCellValue(sheetName, 12, 5, null),
						new ExpectedCellValue(sheetName, 13, 5, null),
						new ExpectedCellValue(sheetName, 14, 5, null),
						new ExpectedCellValue(sheetName, 15, 5, null),
						new ExpectedCellValue(sheetName, 16, 5, null),
						new ExpectedCellValue(sheetName, 17, 5, null),
						new ExpectedCellValue(sheetName, 18, 5, null),
						new ExpectedCellValue(sheetName, 19, 5, null),
						new ExpectedCellValue(sheetName, 20, 5, null),
						new ExpectedCellValue(sheetName, 21, 5, null),
						new ExpectedCellValue(sheetName, 22, 5, null),
						new ExpectedCellValue(sheetName, 23, 5, null),
						new ExpectedCellValue(sheetName, 24, 5, null),
						new ExpectedCellValue(sheetName, 25, 5, null),
						new ExpectedCellValue(sheetName, 26, 5, null),
						new ExpectedCellValue(sheetName, 27, 5, null),
						new ExpectedCellValue(sheetName, 28, 5, null),
						new ExpectedCellValue(sheetName, 29, 5, null),
						new ExpectedCellValue(sheetName, 30, 5, null),
						new ExpectedCellValue(sheetName, 31, 5, null),
						new ExpectedCellValue(sheetName, 32, 5, null),
						new ExpectedCellValue(sheetName, 33, 5, null),
						new ExpectedCellValue(sheetName, 34, 5, null),
						new ExpectedCellValue(sheetName, 35, 5, null),
						new ExpectedCellValue(sheetName, 36, 5, null),
						new ExpectedCellValue(sheetName, 37, 5, null),
						new ExpectedCellValue(sheetName, 38, 5, null),
						new ExpectedCellValue(sheetName, 39, 5, null),
						new ExpectedCellValue(sheetName, 40, 5, null),
						new ExpectedCellValue(sheetName, 41, 5, null),
						new ExpectedCellValue(sheetName, 42, 5, null),
						new ExpectedCellValue(sheetName, 43, 5, null),
						new ExpectedCellValue(sheetName, 44, 5, null),
						new ExpectedCellValue(sheetName, 45, 5, null),
						new ExpectedCellValue(sheetName, 46, 5, null),
						new ExpectedCellValue(sheetName, 47, 5, null),
						new ExpectedCellValue(sheetName, 48, 5, null),
						new ExpectedCellValue(sheetName, 49, 5, null),
						new ExpectedCellValue(sheetName, 50, 5, null),
						new ExpectedCellValue(sheetName, 51, 5, null),
						new ExpectedCellValue(sheetName, 52, 5, null),
						new ExpectedCellValue(sheetName, 53, 5, null),
						new ExpectedCellValue(sheetName, 54, 5, null),
						new ExpectedCellValue(sheetName, 55, 5, null),
						new ExpectedCellValue(sheetName, 56, 5, null),
						new ExpectedCellValue(sheetName, 57, 5, null),
						new ExpectedCellValue(sheetName, 58, 5, null),
						new ExpectedCellValue(sheetName, 59, 5, null),
						new ExpectedCellValue(sheetName, 60, 5, null),
						new ExpectedCellValue(sheetName, 61, 5, null),
						new ExpectedCellValue(sheetName, 62, 5, null),
						new ExpectedCellValue(sheetName, 63, 5, null),
						new ExpectedCellValue(sheetName, 64, 5, null),
						new ExpectedCellValue(sheetName, 65, 5, null),
						new ExpectedCellValue(sheetName, 66, 5, null),
						new ExpectedCellValue(sheetName, 67, 5, null),
						new ExpectedCellValue(sheetName, 68, 5, null),
						new ExpectedCellValue(sheetName, 69, 5, null),
						new ExpectedCellValue(sheetName, 70, 5, null),
						new ExpectedCellValue(sheetName, 71, 5, null),
						new ExpectedCellValue(sheetName, 72, 5, null),
						new ExpectedCellValue(sheetName, 73, 5, null),
						new ExpectedCellValue(sheetName, 74, 5, null),
						new ExpectedCellValue(sheetName, 75, 5, null),
						new ExpectedCellValue(sheetName, 76, 5, null),
						new ExpectedCellValue(sheetName, 77, 5, null),
						new ExpectedCellValue(sheetName, 78, 5, null),
						new ExpectedCellValue(sheetName, 79, 5, null),
						new ExpectedCellValue(sheetName, 80, 5, null),
						new ExpectedCellValue(sheetName, 81, 5, null),
						new ExpectedCellValue(sheetName, 82, 5, null),
						new ExpectedCellValue(sheetName, 83, 5, null),
						new ExpectedCellValue(sheetName, 84, 5, null),
						new ExpectedCellValue(sheetName, 85, 5, null),
						new ExpectedCellValue(sheetName, 86, 5, null),
						new ExpectedCellValue(sheetName, 87, 5, null),
						new ExpectedCellValue(sheetName, 88, 5, null),
						new ExpectedCellValue(sheetName, 89, 5, 24.99),
						new ExpectedCellValue(sheetName, 90, 5, 24.99),
						new ExpectedCellValue(sheetName, 91, 5, 24.99),
						new ExpectedCellValue(sheetName, 92, 5, null),
						new ExpectedCellValue(sheetName, 93, 5, 1d),
						new ExpectedCellValue(sheetName, 94, 5, 1d),
						new ExpectedCellValue(sheetName, 95, 5, 1d),
						new ExpectedCellValue(sheetName, 96, 5, null),
						new ExpectedCellValue(sheetName, 97, 5, 24.99),
						new ExpectedCellValue(sheetName, 98, 5, 24.99),
						new ExpectedCellValue(sheetName, 99, 5, 24.99),
						new ExpectedCellValue(sheetName, 100, 5, 24.99),
						new ExpectedCellValue(sheetName, 101, 5, 1d),
						new ExpectedCellValue(sheetName, 102, 5, 24.99),
						new ExpectedCellValue(sheetName, 103, 5, 24.99),
						new ExpectedCellValue(sheetName, 104, 5, 1d),
						new ExpectedCellValue(sheetName, 105, 5, 24.99),
						new ExpectedCellValue(sheetName, 106, 5, null),
						new ExpectedCellValue(sheetName, 107, 5, null),
						new ExpectedCellValue(sheetName, 108, 5, null),
						new ExpectedCellValue(sheetName, 109, 5, null),
						new ExpectedCellValue(sheetName, 110, 5, null),
						new ExpectedCellValue(sheetName, 111, 5, null),
						new ExpectedCellValue(sheetName, 112, 5, null),
						new ExpectedCellValue(sheetName, 113, 5, null),
						new ExpectedCellValue(sheetName, 114, 5, null),
						new ExpectedCellValue(sheetName, 115, 5, null),
						new ExpectedCellValue(sheetName, 116, 5, null),
						new ExpectedCellValue(sheetName, 117, 5, null),
						new ExpectedCellValue(sheetName, 118, 5, null),
						new ExpectedCellValue(sheetName, 119, 5, null),
						new ExpectedCellValue(sheetName, 120, 5, null),
						new ExpectedCellValue(sheetName, 121, 5, null),
						new ExpectedCellValue(sheetName, 122, 5, null),
						new ExpectedCellValue(sheetName, 123, 5, null),
						new ExpectedCellValue(sheetName, 124, 5, null),
						new ExpectedCellValue(sheetName, 125, 5, null),
						new ExpectedCellValue(sheetName, 126, 5, null),
						new ExpectedCellValue(sheetName, 127, 5, null),
						new ExpectedCellValue(sheetName, 128, 5, null),
						new ExpectedCellValue(sheetName, 129, 5, null),
						new ExpectedCellValue(sheetName, 130, 5, null),
						new ExpectedCellValue(sheetName, 131, 5, null),
						new ExpectedCellValue(sheetName, 132, 5, null),
						new ExpectedCellValue(sheetName, 133, 5, null),
						new ExpectedCellValue(sheetName, 134, 5, null),
						new ExpectedCellValue(sheetName, 135, 5, null),
						new ExpectedCellValue(sheetName, 136, 5, null),
						new ExpectedCellValue(sheetName, 137, 5, null),
						new ExpectedCellValue(sheetName, 138, 5, null),
						new ExpectedCellValue(sheetName, 139, 5, null),
						new ExpectedCellValue(sheetName, 140, 5, null),
						new ExpectedCellValue(sheetName, 141, 5, null),
						new ExpectedCellValue(sheetName, 142, 5, null),
						new ExpectedCellValue(sheetName, 143, 5, null),
						new ExpectedCellValue(sheetName, 144, 5, null),
						new ExpectedCellValue(sheetName, 145, 5, null),
						new ExpectedCellValue(sheetName, 146, 5, 24.99),
						new ExpectedCellValue(sheetName, 147, 5, 1d),
						new ExpectedCellValue(sheetName, 148, 5, 24.99),
						new ExpectedCellValue(sheetName, 149, 5, 24.99),
						new ExpectedCellValue(sheetName, 150, 5, 1d),
						new ExpectedCellValue(sheetName, 151, 5, 24.99),
						new ExpectedCellValue(sheetName, 2, 6, "Chicago Total"),
						new ExpectedCellValue(sheetName, 3, 6, null),
						new ExpectedCellValue(sheetName, 4, 6, null),
						new ExpectedCellValue(sheetName, 5, 6, null),
						new ExpectedCellValue(sheetName, 6, 6, null),
						new ExpectedCellValue(sheetName, 7, 6, null),
						new ExpectedCellValue(sheetName, 8, 6, null),
						new ExpectedCellValue(sheetName, 9, 6, 415.75),
						new ExpectedCellValue(sheetName, 10, 6, 415.75),
						new ExpectedCellValue(sheetName, 11, 6, 415.75),
						new ExpectedCellValue(sheetName, 12, 6, null),
						new ExpectedCellValue(sheetName, 13, 6, 2d),
						new ExpectedCellValue(sheetName, 14, 6, 2d),
						new ExpectedCellValue(sheetName, 15, 6, 2d),
						new ExpectedCellValue(sheetName, 16, 6, null),
						new ExpectedCellValue(sheetName, 17, 6, 831.5),
						new ExpectedCellValue(sheetName, 18, 6, 831.5),
						new ExpectedCellValue(sheetName, 19, 6, 831.5),
						new ExpectedCellValue(sheetName, 20, 6, 415.75),
						new ExpectedCellValue(sheetName, 21, 6, 2d),
						new ExpectedCellValue(sheetName, 22, 6, 831.5),
						new ExpectedCellValue(sheetName, 23, 6, 415.75),
						new ExpectedCellValue(sheetName, 24, 6, 2d),
						new ExpectedCellValue(sheetName, 25, 6, 831.5),
						new ExpectedCellValue(sheetName, 26, 6, 415.75),
						new ExpectedCellValue(sheetName, 27, 6, 2d),
						new ExpectedCellValue(sheetName, 28, 6, 831.5),
						new ExpectedCellValue(sheetName, 29, 6, null),
						new ExpectedCellValue(sheetName, 30, 6, null),
						new ExpectedCellValue(sheetName, 31, 6, null),
						new ExpectedCellValue(sheetName, 32, 6, null),
						new ExpectedCellValue(sheetName, 33, 6, null),
						new ExpectedCellValue(sheetName, 34, 6, null),
						new ExpectedCellValue(sheetName, 35, 6, null),
						new ExpectedCellValue(sheetName, 36, 6, null),
						new ExpectedCellValue(sheetName, 37, 6, null),
						new ExpectedCellValue(sheetName, 38, 6, null),
						new ExpectedCellValue(sheetName, 39, 6, null),
						new ExpectedCellValue(sheetName, 40, 6, null),
						new ExpectedCellValue(sheetName, 41, 6, null),
						new ExpectedCellValue(sheetName, 42, 6, null),
						new ExpectedCellValue(sheetName, 43, 6, null),
						new ExpectedCellValue(sheetName, 44, 6, null),
						new ExpectedCellValue(sheetName, 45, 6, null),
						new ExpectedCellValue(sheetName, 46, 6, null),
						new ExpectedCellValue(sheetName, 47, 6, null),
						new ExpectedCellValue(sheetName, 48, 6, null),
						new ExpectedCellValue(sheetName, 49, 6, null),
						new ExpectedCellValue(sheetName, 50, 6, null),
						new ExpectedCellValue(sheetName, 51, 6, null),
						new ExpectedCellValue(sheetName, 52, 6, null),
						new ExpectedCellValue(sheetName, 53, 6, null),
						new ExpectedCellValue(sheetName, 54, 6, null),
						new ExpectedCellValue(sheetName, 55, 6, null),
						new ExpectedCellValue(sheetName, 56, 6, null),
						new ExpectedCellValue(sheetName, 57, 6, null),
						new ExpectedCellValue(sheetName, 58, 6, null),
						new ExpectedCellValue(sheetName, 59, 6, null),
						new ExpectedCellValue(sheetName, 60, 6, null),
						new ExpectedCellValue(sheetName, 61, 6, null),
						new ExpectedCellValue(sheetName, 62, 6, null),
						new ExpectedCellValue(sheetName, 63, 6, null),
						new ExpectedCellValue(sheetName, 64, 6, null),
						new ExpectedCellValue(sheetName, 65, 6, null),
						new ExpectedCellValue(sheetName, 66, 6, null),
						new ExpectedCellValue(sheetName, 67, 6, null),
						new ExpectedCellValue(sheetName, 68, 6, null),
						new ExpectedCellValue(sheetName, 69, 6, null),
						new ExpectedCellValue(sheetName, 70, 6, null),
						new ExpectedCellValue(sheetName, 71, 6, null),
						new ExpectedCellValue(sheetName, 72, 6, null),
						new ExpectedCellValue(sheetName, 73, 6, null),
						new ExpectedCellValue(sheetName, 74, 6, null),
						new ExpectedCellValue(sheetName, 75, 6, null),
						new ExpectedCellValue(sheetName, 76, 6, null),
						new ExpectedCellValue(sheetName, 77, 6, null),
						new ExpectedCellValue(sheetName, 78, 6, null),
						new ExpectedCellValue(sheetName, 79, 6, null),
						new ExpectedCellValue(sheetName, 80, 6, null),
						new ExpectedCellValue(sheetName, 81, 6, null),
						new ExpectedCellValue(sheetName, 82, 6, null),
						new ExpectedCellValue(sheetName, 83, 6, null),
						new ExpectedCellValue(sheetName, 84, 6, null),
						new ExpectedCellValue(sheetName, 85, 6, null),
						new ExpectedCellValue(sheetName, 86, 6, null),
						new ExpectedCellValue(sheetName, 87, 6, null),
						new ExpectedCellValue(sheetName, 88, 6, null),
						new ExpectedCellValue(sheetName, 89, 6, 24.99),
						new ExpectedCellValue(sheetName, 90, 6, 24.99),
						new ExpectedCellValue(sheetName, 91, 6, 24.99),
						new ExpectedCellValue(sheetName, 92, 6, null),
						new ExpectedCellValue(sheetName, 93, 6, 1d),
						new ExpectedCellValue(sheetName, 94, 6, 1d),
						new ExpectedCellValue(sheetName, 95, 6, 1d),
						new ExpectedCellValue(sheetName, 96, 6, null),
						new ExpectedCellValue(sheetName, 97, 6, 24.99),
						new ExpectedCellValue(sheetName, 98, 6, 24.99),
						new ExpectedCellValue(sheetName, 99, 6, 24.99),
						new ExpectedCellValue(sheetName, 100, 6, 24.99),
						new ExpectedCellValue(sheetName, 101, 6, 1d),
						new ExpectedCellValue(sheetName, 102, 6, 24.99),
						new ExpectedCellValue(sheetName, 103, 6, 24.99),
						new ExpectedCellValue(sheetName, 104, 6, 1d),
						new ExpectedCellValue(sheetName, 105, 6, 24.99),
						new ExpectedCellValue(sheetName, 106, 6, null),
						new ExpectedCellValue(sheetName, 107, 6, null),
						new ExpectedCellValue(sheetName, 108, 6, null),
						new ExpectedCellValue(sheetName, 109, 6, null),
						new ExpectedCellValue(sheetName, 110, 6, null),
						new ExpectedCellValue(sheetName, 111, 6, null),
						new ExpectedCellValue(sheetName, 112, 6, null),
						new ExpectedCellValue(sheetName, 113, 6, null),
						new ExpectedCellValue(sheetName, 114, 6, null),
						new ExpectedCellValue(sheetName, 115, 6, null),
						new ExpectedCellValue(sheetName, 116, 6, null),
						new ExpectedCellValue(sheetName, 117, 6, null),
						new ExpectedCellValue(sheetName, 118, 6, null),
						new ExpectedCellValue(sheetName, 119, 6, null),
						new ExpectedCellValue(sheetName, 120, 6, null),
						new ExpectedCellValue(sheetName, 121, 6, null),
						new ExpectedCellValue(sheetName, 122, 6, null),
						new ExpectedCellValue(sheetName, 123, 6, null),
						new ExpectedCellValue(sheetName, 124, 6, null),
						new ExpectedCellValue(sheetName, 125, 6, null),
						new ExpectedCellValue(sheetName, 126, 6, null),
						new ExpectedCellValue(sheetName, 127, 6, null),
						new ExpectedCellValue(sheetName, 128, 6, null),
						new ExpectedCellValue(sheetName, 129, 6, null),
						new ExpectedCellValue(sheetName, 130, 6, null),
						new ExpectedCellValue(sheetName, 131, 6, null),
						new ExpectedCellValue(sheetName, 132, 6, null),
						new ExpectedCellValue(sheetName, 133, 6, null),
						new ExpectedCellValue(sheetName, 134, 6, null),
						new ExpectedCellValue(sheetName, 135, 6, null),
						new ExpectedCellValue(sheetName, 136, 6, null),
						new ExpectedCellValue(sheetName, 137, 6, null),
						new ExpectedCellValue(sheetName, 138, 6, null),
						new ExpectedCellValue(sheetName, 139, 6, null),
						new ExpectedCellValue(sheetName, 140, 6, null),
						new ExpectedCellValue(sheetName, 141, 6, null),
						new ExpectedCellValue(sheetName, 142, 6, null),
						new ExpectedCellValue(sheetName, 143, 6, null),
						new ExpectedCellValue(sheetName, 144, 6, null),
						new ExpectedCellValue(sheetName, 145, 6, null),
						new ExpectedCellValue(sheetName, 146, 6, 24.99),
						new ExpectedCellValue(sheetName, 147, 6, 1d),
						new ExpectedCellValue(sheetName, 148, 6, 24.99),
						new ExpectedCellValue(sheetName, 149, 6, 440.74),
						new ExpectedCellValue(sheetName, 150, 6, 3d),
						new ExpectedCellValue(sheetName, 151, 6, 856.49),
						new ExpectedCellValue(sheetName, 2, 7, "Nashville"),
						new ExpectedCellValue(sheetName, 3, 7, "Car Rack"),
						new ExpectedCellValue(sheetName, 4, 7, "Feb"),
						new ExpectedCellValue(sheetName, 5, 7, null),
						new ExpectedCellValue(sheetName, 6, 7, null),
						new ExpectedCellValue(sheetName, 7, 7, null),
						new ExpectedCellValue(sheetName, 8, 7, null),
						new ExpectedCellValue(sheetName, 9, 7, null),
						new ExpectedCellValue(sheetName, 10, 7, null),
						new ExpectedCellValue(sheetName, 11, 7, null),
						new ExpectedCellValue(sheetName, 12, 7, null),
						new ExpectedCellValue(sheetName, 13, 7, null),
						new ExpectedCellValue(sheetName, 14, 7, null),
						new ExpectedCellValue(sheetName, 15, 7, null),
						new ExpectedCellValue(sheetName, 16, 7, null),
						new ExpectedCellValue(sheetName, 17, 7, null),
						new ExpectedCellValue(sheetName, 18, 7, null),
						new ExpectedCellValue(sheetName, 19, 7, null),
						new ExpectedCellValue(sheetName, 20, 7, null),
						new ExpectedCellValue(sheetName, 21, 7, null),
						new ExpectedCellValue(sheetName, 22, 7, null),
						new ExpectedCellValue(sheetName, 23, 7, null),
						new ExpectedCellValue(sheetName, 24, 7, null),
						new ExpectedCellValue(sheetName, 25, 7, null),
						new ExpectedCellValue(sheetName, 26, 7, null),
						new ExpectedCellValue(sheetName, 27, 7, null),
						new ExpectedCellValue(sheetName, 28, 7, null),
						new ExpectedCellValue(sheetName, 29, 7, null),
						new ExpectedCellValue(sheetName, 30, 7, null),
						new ExpectedCellValue(sheetName, 31, 7, null),
						new ExpectedCellValue(sheetName, 32, 7, null),
						new ExpectedCellValue(sheetName, 33, 7, null),
						new ExpectedCellValue(sheetName, 34, 7, null),
						new ExpectedCellValue(sheetName, 35, 7, null),
						new ExpectedCellValue(sheetName, 36, 7, null),
						new ExpectedCellValue(sheetName, 37, 7, null),
						new ExpectedCellValue(sheetName, 38, 7, null),
						new ExpectedCellValue(sheetName, 39, 7, null),
						new ExpectedCellValue(sheetName, 40, 7, null),
						new ExpectedCellValue(sheetName, 41, 7, null),
						new ExpectedCellValue(sheetName, 42, 7, null),
						new ExpectedCellValue(sheetName, 43, 7, null),
						new ExpectedCellValue(sheetName, 44, 7, null),
						new ExpectedCellValue(sheetName, 45, 7, null),
						new ExpectedCellValue(sheetName, 46, 7, null),
						new ExpectedCellValue(sheetName, 47, 7, null),
						new ExpectedCellValue(sheetName, 48, 7, null),
						new ExpectedCellValue(sheetName, 49, 7, null),
						new ExpectedCellValue(sheetName, 50, 7, null),
						new ExpectedCellValue(sheetName, 51, 7, null),
						new ExpectedCellValue(sheetName, 52, 7, null),
						new ExpectedCellValue(sheetName, 53, 7, null),
						new ExpectedCellValue(sheetName, 54, 7, null),
						new ExpectedCellValue(sheetName, 55, 7, null),
						new ExpectedCellValue(sheetName, 56, 7, null),
						new ExpectedCellValue(sheetName, 57, 7, null),
						new ExpectedCellValue(sheetName, 58, 7, null),
						new ExpectedCellValue(sheetName, 59, 7, null),
						new ExpectedCellValue(sheetName, 60, 7, null),
						new ExpectedCellValue(sheetName, 61, 7, null),
						new ExpectedCellValue(sheetName, 62, 7, null),
						new ExpectedCellValue(sheetName, 63, 7, null),
						new ExpectedCellValue(sheetName, 64, 7, null),
						new ExpectedCellValue(sheetName, 65, 7, null),
						new ExpectedCellValue(sheetName, 66, 7, null),
						new ExpectedCellValue(sheetName, 67, 7, null),
						new ExpectedCellValue(sheetName, 68, 7, null),
						new ExpectedCellValue(sheetName, 69, 7, null),
						new ExpectedCellValue(sheetName, 70, 7, null),
						new ExpectedCellValue(sheetName, 71, 7, null),
						new ExpectedCellValue(sheetName, 72, 7, null),
						new ExpectedCellValue(sheetName, 73, 7, 415.75),
						new ExpectedCellValue(sheetName, 74, 7, 415.75),
						new ExpectedCellValue(sheetName, 75, 7, 415.75),
						new ExpectedCellValue(sheetName, 76, 7, null),
						new ExpectedCellValue(sheetName, 77, 7, 2d),
						new ExpectedCellValue(sheetName, 78, 7, 2d),
						new ExpectedCellValue(sheetName, 79, 7, 2d),
						new ExpectedCellValue(sheetName, 80, 7, null),
						new ExpectedCellValue(sheetName, 81, 7, 831.5),
						new ExpectedCellValue(sheetName, 82, 7, 831.5),
						new ExpectedCellValue(sheetName, 83, 7, 831.5),
						new ExpectedCellValue(sheetName, 84, 7, 415.75),
						new ExpectedCellValue(sheetName, 85, 7, 2d),
						new ExpectedCellValue(sheetName, 86, 7, 831.5),
						new ExpectedCellValue(sheetName, 87, 7, null),
						new ExpectedCellValue(sheetName, 88, 7, null),
						new ExpectedCellValue(sheetName, 89, 7, null),
						new ExpectedCellValue(sheetName, 90, 7, null),
						new ExpectedCellValue(sheetName, 91, 7, null),
						new ExpectedCellValue(sheetName, 92, 7, null),
						new ExpectedCellValue(sheetName, 93, 7, null),
						new ExpectedCellValue(sheetName, 94, 7, null),
						new ExpectedCellValue(sheetName, 95, 7, null),
						new ExpectedCellValue(sheetName, 96, 7, null),
						new ExpectedCellValue(sheetName, 97, 7, null),
						new ExpectedCellValue(sheetName, 98, 7, null),
						new ExpectedCellValue(sheetName, 99, 7, null),
						new ExpectedCellValue(sheetName, 100, 7, null),
						new ExpectedCellValue(sheetName, 101, 7, null),
						new ExpectedCellValue(sheetName, 102, 7, null),
						new ExpectedCellValue(sheetName, 103, 7, 415.75),
						new ExpectedCellValue(sheetName, 104, 7, 2d),
						new ExpectedCellValue(sheetName, 105, 7, 831.5),
						new ExpectedCellValue(sheetName, 106, 7, null),
						new ExpectedCellValue(sheetName, 107, 7, null),
						new ExpectedCellValue(sheetName, 108, 7, null),
						new ExpectedCellValue(sheetName, 109, 7, null),
						new ExpectedCellValue(sheetName, 110, 7, null),
						new ExpectedCellValue(sheetName, 111, 7, null),
						new ExpectedCellValue(sheetName, 112, 7, null),
						new ExpectedCellValue(sheetName, 113, 7, null),
						new ExpectedCellValue(sheetName, 114, 7, null),
						new ExpectedCellValue(sheetName, 115, 7, null),
						new ExpectedCellValue(sheetName, 116, 7, null),
						new ExpectedCellValue(sheetName, 117, 7, null),
						new ExpectedCellValue(sheetName, 118, 7, null),
						new ExpectedCellValue(sheetName, 119, 7, null),
						new ExpectedCellValue(sheetName, 120, 7, null),
						new ExpectedCellValue(sheetName, 121, 7, null),
						new ExpectedCellValue(sheetName, 122, 7, null),
						new ExpectedCellValue(sheetName, 123, 7, null),
						new ExpectedCellValue(sheetName, 124, 7, null),
						new ExpectedCellValue(sheetName, 125, 7, null),
						new ExpectedCellValue(sheetName, 126, 7, null),
						new ExpectedCellValue(sheetName, 127, 7, null),
						new ExpectedCellValue(sheetName, 128, 7, null),
						new ExpectedCellValue(sheetName, 129, 7, null),
						new ExpectedCellValue(sheetName, 130, 7, null),
						new ExpectedCellValue(sheetName, 131, 7, null),
						new ExpectedCellValue(sheetName, 132, 7, null),
						new ExpectedCellValue(sheetName, 133, 7, null),
						new ExpectedCellValue(sheetName, 134, 7, null),
						new ExpectedCellValue(sheetName, 135, 7, null),
						new ExpectedCellValue(sheetName, 136, 7, null),
						new ExpectedCellValue(sheetName, 137, 7, null),
						new ExpectedCellValue(sheetName, 138, 7, null),
						new ExpectedCellValue(sheetName, 139, 7, null),
						new ExpectedCellValue(sheetName, 140, 7, null),
						new ExpectedCellValue(sheetName, 141, 7, null),
						new ExpectedCellValue(sheetName, 142, 7, null),
						new ExpectedCellValue(sheetName, 143, 7, null),
						new ExpectedCellValue(sheetName, 144, 7, null),
						new ExpectedCellValue(sheetName, 145, 7, null),
						new ExpectedCellValue(sheetName, 146, 7, 415.75),
						new ExpectedCellValue(sheetName, 147, 7, 2d),
						new ExpectedCellValue(sheetName, 148, 7, 831.5),
						new ExpectedCellValue(sheetName, 149, 7, 415.75),
						new ExpectedCellValue(sheetName, 150, 7, 2d),
						new ExpectedCellValue(sheetName, 151, 7, 831.5),
						new ExpectedCellValue(sheetName, 2, 8, null),
						new ExpectedCellValue(sheetName, 3, 8, null),
						new ExpectedCellValue(sheetName, 4, 8, "Oct"),
						new ExpectedCellValue(sheetName, 5, 8, null),
						new ExpectedCellValue(sheetName, 6, 8, null),
						new ExpectedCellValue(sheetName, 7, 8, null),
						new ExpectedCellValue(sheetName, 8, 8, null),
						new ExpectedCellValue(sheetName, 9, 8, null),
						new ExpectedCellValue(sheetName, 10, 8, null),
						new ExpectedCellValue(sheetName, 11, 8, null),
						new ExpectedCellValue(sheetName, 12, 8, null),
						new ExpectedCellValue(sheetName, 13, 8, null),
						new ExpectedCellValue(sheetName, 14, 8, null),
						new ExpectedCellValue(sheetName, 15, 8, null),
						new ExpectedCellValue(sheetName, 16, 8, null),
						new ExpectedCellValue(sheetName, 17, 8, null),
						new ExpectedCellValue(sheetName, 18, 8, null),
						new ExpectedCellValue(sheetName, 19, 8, null),
						new ExpectedCellValue(sheetName, 20, 8, null),
						new ExpectedCellValue(sheetName, 21, 8, null),
						new ExpectedCellValue(sheetName, 22, 8, null),
						new ExpectedCellValue(sheetName, 23, 8, null),
						new ExpectedCellValue(sheetName, 24, 8, null),
						new ExpectedCellValue(sheetName, 25, 8, null),
						new ExpectedCellValue(sheetName, 26, 8, null),
						new ExpectedCellValue(sheetName, 27, 8, null),
						new ExpectedCellValue(sheetName, 28, 8, null),
						new ExpectedCellValue(sheetName, 29, 8, null),
						new ExpectedCellValue(sheetName, 30, 8, null),
						new ExpectedCellValue(sheetName, 31, 8, null),
						new ExpectedCellValue(sheetName, 32, 8, null),
						new ExpectedCellValue(sheetName, 33, 8, 415.75),
						new ExpectedCellValue(sheetName, 34, 8, 415.75),
						new ExpectedCellValue(sheetName, 35, 8, 415.75),
						new ExpectedCellValue(sheetName, 36, 8, null),
						new ExpectedCellValue(sheetName, 37, 8, 2d),
						new ExpectedCellValue(sheetName, 38, 8, 2d),
						new ExpectedCellValue(sheetName, 39, 8, 2d),
						new ExpectedCellValue(sheetName, 40, 8, null),
						new ExpectedCellValue(sheetName, 41, 8, 831.5),
						new ExpectedCellValue(sheetName, 42, 8, 831.5),
						new ExpectedCellValue(sheetName, 43, 8, 831.5),
						new ExpectedCellValue(sheetName, 44, 8, 415.75),
						new ExpectedCellValue(sheetName, 45, 8, 2d),
						new ExpectedCellValue(sheetName, 46, 8, 831.5),
						new ExpectedCellValue(sheetName, 47, 8, null),
						new ExpectedCellValue(sheetName, 48, 8, null),
						new ExpectedCellValue(sheetName, 49, 8, null),
						new ExpectedCellValue(sheetName, 50, 8, null),
						new ExpectedCellValue(sheetName, 51, 8, null),
						new ExpectedCellValue(sheetName, 52, 8, null),
						new ExpectedCellValue(sheetName, 53, 8, null),
						new ExpectedCellValue(sheetName, 54, 8, null),
						new ExpectedCellValue(sheetName, 55, 8, null),
						new ExpectedCellValue(sheetName, 56, 8, null),
						new ExpectedCellValue(sheetName, 57, 8, null),
						new ExpectedCellValue(sheetName, 58, 8, null),
						new ExpectedCellValue(sheetName, 59, 8, null),
						new ExpectedCellValue(sheetName, 60, 8, null),
						new ExpectedCellValue(sheetName, 61, 8, null),
						new ExpectedCellValue(sheetName, 62, 8, null),
						new ExpectedCellValue(sheetName, 63, 8, 415.75),
						new ExpectedCellValue(sheetName, 64, 8, 2d),
						new ExpectedCellValue(sheetName, 65, 8, 831.5),
						new ExpectedCellValue(sheetName, 66, 8, 415.75),
						new ExpectedCellValue(sheetName, 67, 8, 2d),
						new ExpectedCellValue(sheetName, 68, 8, 831.5),
						new ExpectedCellValue(sheetName, 69, 8, null),
						new ExpectedCellValue(sheetName, 70, 8, null),
						new ExpectedCellValue(sheetName, 71, 8, null),
						new ExpectedCellValue(sheetName, 72, 8, null),
						new ExpectedCellValue(sheetName, 73, 8, null),
						new ExpectedCellValue(sheetName, 74, 8, null),
						new ExpectedCellValue(sheetName, 75, 8, null),
						new ExpectedCellValue(sheetName, 76, 8, null),
						new ExpectedCellValue(sheetName, 77, 8, null),
						new ExpectedCellValue(sheetName, 78, 8, null),
						new ExpectedCellValue(sheetName, 79, 8, null),
						new ExpectedCellValue(sheetName, 80, 8, null),
						new ExpectedCellValue(sheetName, 81, 8, null),
						new ExpectedCellValue(sheetName, 82, 8, null),
						new ExpectedCellValue(sheetName, 83, 8, null),
						new ExpectedCellValue(sheetName, 84, 8, null),
						new ExpectedCellValue(sheetName, 85, 8, null),
						new ExpectedCellValue(sheetName, 86, 8, null),
						new ExpectedCellValue(sheetName, 87, 8, null),
						new ExpectedCellValue(sheetName, 88, 8, null),
						new ExpectedCellValue(sheetName, 89, 8, null),
						new ExpectedCellValue(sheetName, 90, 8, null),
						new ExpectedCellValue(sheetName, 91, 8, null),
						new ExpectedCellValue(sheetName, 92, 8, null),
						new ExpectedCellValue(sheetName, 93, 8, null),
						new ExpectedCellValue(sheetName, 94, 8, null),
						new ExpectedCellValue(sheetName, 95, 8, null),
						new ExpectedCellValue(sheetName, 96, 8, null),
						new ExpectedCellValue(sheetName, 97, 8, null),
						new ExpectedCellValue(sheetName, 98, 8, null),
						new ExpectedCellValue(sheetName, 99, 8, null),
						new ExpectedCellValue(sheetName, 100, 8, null),
						new ExpectedCellValue(sheetName, 101, 8, null),
						new ExpectedCellValue(sheetName, 102, 8, null),
						new ExpectedCellValue(sheetName, 103, 8, null),
						new ExpectedCellValue(sheetName, 104, 8, null),
						new ExpectedCellValue(sheetName, 105, 8, null),
						new ExpectedCellValue(sheetName, 106, 8, null),
						new ExpectedCellValue(sheetName, 107, 8, null),
						new ExpectedCellValue(sheetName, 108, 8, null),
						new ExpectedCellValue(sheetName, 109, 8, null),
						new ExpectedCellValue(sheetName, 110, 8, null),
						new ExpectedCellValue(sheetName, 111, 8, null),
						new ExpectedCellValue(sheetName, 112, 8, null),
						new ExpectedCellValue(sheetName, 113, 8, null),
						new ExpectedCellValue(sheetName, 114, 8, null),
						new ExpectedCellValue(sheetName, 115, 8, null),
						new ExpectedCellValue(sheetName, 116, 8, null),
						new ExpectedCellValue(sheetName, 117, 8, null),
						new ExpectedCellValue(sheetName, 118, 8, null),
						new ExpectedCellValue(sheetName, 119, 8, null),
						new ExpectedCellValue(sheetName, 120, 8, null),
						new ExpectedCellValue(sheetName, 121, 8, null),
						new ExpectedCellValue(sheetName, 122, 8, null),
						new ExpectedCellValue(sheetName, 123, 8, null),
						new ExpectedCellValue(sheetName, 124, 8, null),
						new ExpectedCellValue(sheetName, 125, 8, null),
						new ExpectedCellValue(sheetName, 126, 8, null),
						new ExpectedCellValue(sheetName, 127, 8, null),
						new ExpectedCellValue(sheetName, 128, 8, null),
						new ExpectedCellValue(sheetName, 129, 8, null),
						new ExpectedCellValue(sheetName, 130, 8, null),
						new ExpectedCellValue(sheetName, 131, 8, null),
						new ExpectedCellValue(sheetName, 132, 8, null),
						new ExpectedCellValue(sheetName, 133, 8, null),
						new ExpectedCellValue(sheetName, 134, 8, null),
						new ExpectedCellValue(sheetName, 135, 8, null),
						new ExpectedCellValue(sheetName, 136, 8, null),
						new ExpectedCellValue(sheetName, 137, 8, null),
						new ExpectedCellValue(sheetName, 138, 8, null),
						new ExpectedCellValue(sheetName, 139, 8, null),
						new ExpectedCellValue(sheetName, 140, 8, null),
						new ExpectedCellValue(sheetName, 141, 8, null),
						new ExpectedCellValue(sheetName, 142, 8, null),
						new ExpectedCellValue(sheetName, 143, 8, null),
						new ExpectedCellValue(sheetName, 144, 8, null),
						new ExpectedCellValue(sheetName, 145, 8, null),
						new ExpectedCellValue(sheetName, 146, 8, null),
						new ExpectedCellValue(sheetName, 147, 8, null),
						new ExpectedCellValue(sheetName, 148, 8, null),
						new ExpectedCellValue(sheetName, 149, 8, 415.75),
						new ExpectedCellValue(sheetName, 150, 8, 2d),
						new ExpectedCellValue(sheetName, 151, 8, 831.5),
						new ExpectedCellValue(sheetName, 2, 9, null),
						new ExpectedCellValue(sheetName, 3, 9, "Car Rack Total"),
						new ExpectedCellValue(sheetName, 4, 9, null),
						new ExpectedCellValue(sheetName, 5, 9, null),
						new ExpectedCellValue(sheetName, 6, 9, null),
						new ExpectedCellValue(sheetName, 7, 9, null),
						new ExpectedCellValue(sheetName, 8, 9, null),
						new ExpectedCellValue(sheetName, 9, 9, null),
						new ExpectedCellValue(sheetName, 10, 9, null),
						new ExpectedCellValue(sheetName, 11, 9, null),
						new ExpectedCellValue(sheetName, 12, 9, null),
						new ExpectedCellValue(sheetName, 13, 9, null),
						new ExpectedCellValue(sheetName, 14, 9, null),
						new ExpectedCellValue(sheetName, 15, 9, null),
						new ExpectedCellValue(sheetName, 16, 9, null),
						new ExpectedCellValue(sheetName, 17, 9, null),
						new ExpectedCellValue(sheetName, 18, 9, null),
						new ExpectedCellValue(sheetName, 19, 9, null),
						new ExpectedCellValue(sheetName, 20, 9, null),
						new ExpectedCellValue(sheetName, 21, 9, null),
						new ExpectedCellValue(sheetName, 22, 9, null),
						new ExpectedCellValue(sheetName, 23, 9, null),
						new ExpectedCellValue(sheetName, 24, 9, null),
						new ExpectedCellValue(sheetName, 25, 9, null),
						new ExpectedCellValue(sheetName, 26, 9, null),
						new ExpectedCellValue(sheetName, 27, 9, null),
						new ExpectedCellValue(sheetName, 28, 9, null),
						new ExpectedCellValue(sheetName, 29, 9, null),
						new ExpectedCellValue(sheetName, 30, 9, null),
						new ExpectedCellValue(sheetName, 31, 9, null),
						new ExpectedCellValue(sheetName, 32, 9, null),
						new ExpectedCellValue(sheetName, 33, 9, 415.75),
						new ExpectedCellValue(sheetName, 34, 9, 415.75),
						new ExpectedCellValue(sheetName, 35, 9, 415.75),
						new ExpectedCellValue(sheetName, 36, 9, null),
						new ExpectedCellValue(sheetName, 37, 9, 2d),
						new ExpectedCellValue(sheetName, 38, 9, 2d),
						new ExpectedCellValue(sheetName, 39, 9, 2d),
						new ExpectedCellValue(sheetName, 40, 9, null),
						new ExpectedCellValue(sheetName, 41, 9, 831.5),
						new ExpectedCellValue(sheetName, 42, 9, 831.5),
						new ExpectedCellValue(sheetName, 43, 9, 831.5),
						new ExpectedCellValue(sheetName, 44, 9, 415.75),
						new ExpectedCellValue(sheetName, 45, 9, 2d),
						new ExpectedCellValue(sheetName, 46, 9, 831.5),
						new ExpectedCellValue(sheetName, 47, 9, null),
						new ExpectedCellValue(sheetName, 48, 9, null),
						new ExpectedCellValue(sheetName, 49, 9, null),
						new ExpectedCellValue(sheetName, 50, 9, null),
						new ExpectedCellValue(sheetName, 51, 9, null),
						new ExpectedCellValue(sheetName, 52, 9, null),
						new ExpectedCellValue(sheetName, 53, 9, null),
						new ExpectedCellValue(sheetName, 54, 9, null),
						new ExpectedCellValue(sheetName, 55, 9, null),
						new ExpectedCellValue(sheetName, 56, 9, null),
						new ExpectedCellValue(sheetName, 57, 9, null),
						new ExpectedCellValue(sheetName, 58, 9, null),
						new ExpectedCellValue(sheetName, 59, 9, null),
						new ExpectedCellValue(sheetName, 60, 9, null),
						new ExpectedCellValue(sheetName, 61, 9, null),
						new ExpectedCellValue(sheetName, 62, 9, null),
						new ExpectedCellValue(sheetName, 63, 9, 415.75),
						new ExpectedCellValue(sheetName, 64, 9, 2d),
						new ExpectedCellValue(sheetName, 65, 9, 831.5),
						new ExpectedCellValue(sheetName, 66, 9, 415.75),
						new ExpectedCellValue(sheetName, 67, 9, 2d),
						new ExpectedCellValue(sheetName, 68, 9, 831.5),
						new ExpectedCellValue(sheetName, 69, 9, null),
						new ExpectedCellValue(sheetName, 70, 9, null),
						new ExpectedCellValue(sheetName, 71, 9, null),
						new ExpectedCellValue(sheetName, 72, 9, null),
						new ExpectedCellValue(sheetName, 73, 9, 415.75),
						new ExpectedCellValue(sheetName, 74, 9, 415.75),
						new ExpectedCellValue(sheetName, 75, 9, 415.75),
						new ExpectedCellValue(sheetName, 76, 9, null),
						new ExpectedCellValue(sheetName, 77, 9, 2d),
						new ExpectedCellValue(sheetName, 78, 9, 2d),
						new ExpectedCellValue(sheetName, 79, 9, 2d),
						new ExpectedCellValue(sheetName, 80, 9, null),
						new ExpectedCellValue(sheetName, 81, 9, 831.5),
						new ExpectedCellValue(sheetName, 82, 9, 831.5),
						new ExpectedCellValue(sheetName, 83, 9, 831.5),
						new ExpectedCellValue(sheetName, 84, 9, 415.75),
						new ExpectedCellValue(sheetName, 85, 9, 2d),
						new ExpectedCellValue(sheetName, 86, 9, 831.5),
						new ExpectedCellValue(sheetName, 87, 9, null),
						new ExpectedCellValue(sheetName, 88, 9, null),
						new ExpectedCellValue(sheetName, 89, 9, null),
						new ExpectedCellValue(sheetName, 90, 9, null),
						new ExpectedCellValue(sheetName, 91, 9, null),
						new ExpectedCellValue(sheetName, 92, 9, null),
						new ExpectedCellValue(sheetName, 93, 9, null),
						new ExpectedCellValue(sheetName, 94, 9, null),
						new ExpectedCellValue(sheetName, 95, 9, null),
						new ExpectedCellValue(sheetName, 96, 9, null),
						new ExpectedCellValue(sheetName, 97, 9, null),
						new ExpectedCellValue(sheetName, 98, 9, null),
						new ExpectedCellValue(sheetName, 99, 9, null),
						new ExpectedCellValue(sheetName, 100, 9, null),
						new ExpectedCellValue(sheetName, 101, 9, null),
						new ExpectedCellValue(sheetName, 102, 9, null),
						new ExpectedCellValue(sheetName, 103, 9, 415.75),
						new ExpectedCellValue(sheetName, 104, 9, 2d),
						new ExpectedCellValue(sheetName, 105, 9, 831.5),
						new ExpectedCellValue(sheetName, 106, 9, null),
						new ExpectedCellValue(sheetName, 107, 9, null),
						new ExpectedCellValue(sheetName, 108, 9, null),
						new ExpectedCellValue(sheetName, 109, 9, null),
						new ExpectedCellValue(sheetName, 110, 9, null),
						new ExpectedCellValue(sheetName, 111, 9, null),
						new ExpectedCellValue(sheetName, 112, 9, null),
						new ExpectedCellValue(sheetName, 113, 9, null),
						new ExpectedCellValue(sheetName, 114, 9, null),
						new ExpectedCellValue(sheetName, 115, 9, null),
						new ExpectedCellValue(sheetName, 116, 9, null),
						new ExpectedCellValue(sheetName, 117, 9, null),
						new ExpectedCellValue(sheetName, 118, 9, null),
						new ExpectedCellValue(sheetName, 119, 9, null),
						new ExpectedCellValue(sheetName, 120, 9, null),
						new ExpectedCellValue(sheetName, 121, 9, null),
						new ExpectedCellValue(sheetName, 122, 9, null),
						new ExpectedCellValue(sheetName, 123, 9, null),
						new ExpectedCellValue(sheetName, 124, 9, null),
						new ExpectedCellValue(sheetName, 125, 9, null),
						new ExpectedCellValue(sheetName, 126, 9, null),
						new ExpectedCellValue(sheetName, 127, 9, null),
						new ExpectedCellValue(sheetName, 128, 9, null),
						new ExpectedCellValue(sheetName, 129, 9, null),
						new ExpectedCellValue(sheetName, 130, 9, null),
						new ExpectedCellValue(sheetName, 131, 9, null),
						new ExpectedCellValue(sheetName, 132, 9, null),
						new ExpectedCellValue(sheetName, 133, 9, null),
						new ExpectedCellValue(sheetName, 134, 9, null),
						new ExpectedCellValue(sheetName, 135, 9, null),
						new ExpectedCellValue(sheetName, 136, 9, null),
						new ExpectedCellValue(sheetName, 137, 9, null),
						new ExpectedCellValue(sheetName, 138, 9, null),
						new ExpectedCellValue(sheetName, 139, 9, null),
						new ExpectedCellValue(sheetName, 140, 9, null),
						new ExpectedCellValue(sheetName, 141, 9, null),
						new ExpectedCellValue(sheetName, 142, 9, null),
						new ExpectedCellValue(sheetName, 143, 9, null),
						new ExpectedCellValue(sheetName, 144, 9, null),
						new ExpectedCellValue(sheetName, 145, 9, null),
						new ExpectedCellValue(sheetName, 146, 9, 415.75),
						new ExpectedCellValue(sheetName, 147, 9, 2d),
						new ExpectedCellValue(sheetName, 148, 9, 831.5),
						new ExpectedCellValue(sheetName, 149, 9, 831.5),
						new ExpectedCellValue(sheetName, 150, 9, 4d),
						new ExpectedCellValue(sheetName, 151, 9, 1663d),
						new ExpectedCellValue(sheetName, 2, 10, null),
						new ExpectedCellValue(sheetName, 3, 10, "Tent"),
						new ExpectedCellValue(sheetName, 4, 10, "May"),
						new ExpectedCellValue(sheetName, 5, 10, null),
						new ExpectedCellValue(sheetName, 6, 10, null),
						new ExpectedCellValue(sheetName, 7, 10, null),
						new ExpectedCellValue(sheetName, 8, 10, null),
						new ExpectedCellValue(sheetName, 9, 10, null),
						new ExpectedCellValue(sheetName, 10, 10, null),
						new ExpectedCellValue(sheetName, 11, 10, null),
						new ExpectedCellValue(sheetName, 12, 10, null),
						new ExpectedCellValue(sheetName, 13, 10, null),
						new ExpectedCellValue(sheetName, 14, 10, null),
						new ExpectedCellValue(sheetName, 15, 10, null),
						new ExpectedCellValue(sheetName, 16, 10, null),
						new ExpectedCellValue(sheetName, 17, 10, null),
						new ExpectedCellValue(sheetName, 18, 10, null),
						new ExpectedCellValue(sheetName, 19, 10, null),
						new ExpectedCellValue(sheetName, 20, 10, null),
						new ExpectedCellValue(sheetName, 21, 10, null),
						new ExpectedCellValue(sheetName, 22, 10, null),
						new ExpectedCellValue(sheetName, 23, 10, null),
						new ExpectedCellValue(sheetName, 24, 10, null),
						new ExpectedCellValue(sheetName, 25, 10, null),
						new ExpectedCellValue(sheetName, 26, 10, null),
						new ExpectedCellValue(sheetName, 27, 10, null),
						new ExpectedCellValue(sheetName, 28, 10, null),
						new ExpectedCellValue(sheetName, 29, 10, null),
						new ExpectedCellValue(sheetName, 30, 10, null),
						new ExpectedCellValue(sheetName, 31, 10, null),
						new ExpectedCellValue(sheetName, 32, 10, null),
						new ExpectedCellValue(sheetName, 33, 10, null),
						new ExpectedCellValue(sheetName, 34, 10, null),
						new ExpectedCellValue(sheetName, 35, 10, null),
						new ExpectedCellValue(sheetName, 36, 10, null),
						new ExpectedCellValue(sheetName, 37, 10, null),
						new ExpectedCellValue(sheetName, 38, 10, null),
						new ExpectedCellValue(sheetName, 39, 10, null),
						new ExpectedCellValue(sheetName, 40, 10, null),
						new ExpectedCellValue(sheetName, 41, 10, null),
						new ExpectedCellValue(sheetName, 42, 10, null),
						new ExpectedCellValue(sheetName, 43, 10, null),
						new ExpectedCellValue(sheetName, 44, 10, null),
						new ExpectedCellValue(sheetName, 45, 10, null),
						new ExpectedCellValue(sheetName, 46, 10, null),
						new ExpectedCellValue(sheetName, 47, 10, null),
						new ExpectedCellValue(sheetName, 48, 10, null),
						new ExpectedCellValue(sheetName, 49, 10, null),
						new ExpectedCellValue(sheetName, 50, 10, null),
						new ExpectedCellValue(sheetName, 51, 10, null),
						new ExpectedCellValue(sheetName, 52, 10, null),
						new ExpectedCellValue(sheetName, 53, 10, null),
						new ExpectedCellValue(sheetName, 54, 10, null),
						new ExpectedCellValue(sheetName, 55, 10, null),
						new ExpectedCellValue(sheetName, 56, 10, null),
						new ExpectedCellValue(sheetName, 57, 10, null),
						new ExpectedCellValue(sheetName, 58, 10, null),
						new ExpectedCellValue(sheetName, 59, 10, null),
						new ExpectedCellValue(sheetName, 60, 10, null),
						new ExpectedCellValue(sheetName, 61, 10, null),
						new ExpectedCellValue(sheetName, 62, 10, null),
						new ExpectedCellValue(sheetName, 63, 10, null),
						new ExpectedCellValue(sheetName, 64, 10, null),
						new ExpectedCellValue(sheetName, 65, 10, null),
						new ExpectedCellValue(sheetName, 66, 10, null),
						new ExpectedCellValue(sheetName, 67, 10, null),
						new ExpectedCellValue(sheetName, 68, 10, null),
						new ExpectedCellValue(sheetName, 69, 10, null),
						new ExpectedCellValue(sheetName, 70, 10, null),
						new ExpectedCellValue(sheetName, 71, 10, null),
						new ExpectedCellValue(sheetName, 72, 10, null),
						new ExpectedCellValue(sheetName, 73, 10, null),
						new ExpectedCellValue(sheetName, 74, 10, null),
						new ExpectedCellValue(sheetName, 75, 10, null),
						new ExpectedCellValue(sheetName, 76, 10, null),
						new ExpectedCellValue(sheetName, 77, 10, null),
						new ExpectedCellValue(sheetName, 78, 10, null),
						new ExpectedCellValue(sheetName, 79, 10, null),
						new ExpectedCellValue(sheetName, 80, 10, null),
						new ExpectedCellValue(sheetName, 81, 10, null),
						new ExpectedCellValue(sheetName, 82, 10, null),
						new ExpectedCellValue(sheetName, 83, 10, null),
						new ExpectedCellValue(sheetName, 84, 10, null),
						new ExpectedCellValue(sheetName, 85, 10, null),
						new ExpectedCellValue(sheetName, 86, 10, null),
						new ExpectedCellValue(sheetName, 87, 10, null),
						new ExpectedCellValue(sheetName, 88, 10, null),
						new ExpectedCellValue(sheetName, 89, 10, null),
						new ExpectedCellValue(sheetName, 90, 10, null),
						new ExpectedCellValue(sheetName, 91, 10, null),
						new ExpectedCellValue(sheetName, 92, 10, null),
						new ExpectedCellValue(sheetName, 93, 10, null),
						new ExpectedCellValue(sheetName, 94, 10, null),
						new ExpectedCellValue(sheetName, 95, 10, null),
						new ExpectedCellValue(sheetName, 96, 10, null),
						new ExpectedCellValue(sheetName, 97, 10, null),
						new ExpectedCellValue(sheetName, 98, 10, null),
						new ExpectedCellValue(sheetName, 99, 10, null),
						new ExpectedCellValue(sheetName, 100, 10, null),
						new ExpectedCellValue(sheetName, 101, 10, null),
						new ExpectedCellValue(sheetName, 102, 10, null),
						new ExpectedCellValue(sheetName, 103, 10, null),
						new ExpectedCellValue(sheetName, 104, 10, null),
						new ExpectedCellValue(sheetName, 105, 10, null),
						new ExpectedCellValue(sheetName, 106, 10, null),
						new ExpectedCellValue(sheetName, 107, 10, null),
						new ExpectedCellValue(sheetName, 108, 10, null),
						new ExpectedCellValue(sheetName, 109, 10, 199d),
						new ExpectedCellValue(sheetName, 110, 10, 199d),
						new ExpectedCellValue(sheetName, 111, 10, 199d),
						new ExpectedCellValue(sheetName, 112, 10, null),
						new ExpectedCellValue(sheetName, 113, 10, 6d),
						new ExpectedCellValue(sheetName, 114, 10, 6d),
						new ExpectedCellValue(sheetName, 115, 10, 6d),
						new ExpectedCellValue(sheetName, 116, 10, null),
						new ExpectedCellValue(sheetName, 117, 10, 1194d),
						new ExpectedCellValue(sheetName, 118, 10, 1194d),
						new ExpectedCellValue(sheetName, 119, 10, 1194d),
						new ExpectedCellValue(sheetName, 120, 10, 199d),
						new ExpectedCellValue(sheetName, 121, 10, 6d),
						new ExpectedCellValue(sheetName, 122, 10, 1194d),
						new ExpectedCellValue(sheetName, 123, 10, 199d),
						new ExpectedCellValue(sheetName, 124, 10, 6d),
						new ExpectedCellValue(sheetName, 125, 10, 1194d),
						new ExpectedCellValue(sheetName, 126, 10, null),
						new ExpectedCellValue(sheetName, 127, 10, null),
						new ExpectedCellValue(sheetName, 128, 10, null),
						new ExpectedCellValue(sheetName, 129, 10, null),
						new ExpectedCellValue(sheetName, 130, 10, null),
						new ExpectedCellValue(sheetName, 131, 10, null),
						new ExpectedCellValue(sheetName, 132, 10, null),
						new ExpectedCellValue(sheetName, 133, 10, null),
						new ExpectedCellValue(sheetName, 134, 10, null),
						new ExpectedCellValue(sheetName, 135, 10, null),
						new ExpectedCellValue(sheetName, 136, 10, null),
						new ExpectedCellValue(sheetName, 137, 10, null),
						new ExpectedCellValue(sheetName, 138, 10, null),
						new ExpectedCellValue(sheetName, 139, 10, null),
						new ExpectedCellValue(sheetName, 140, 10, null),
						new ExpectedCellValue(sheetName, 141, 10, null),
						new ExpectedCellValue(sheetName, 142, 10, null),
						new ExpectedCellValue(sheetName, 143, 10, null),
						new ExpectedCellValue(sheetName, 144, 10, null),
						new ExpectedCellValue(sheetName, 145, 10, null),
						new ExpectedCellValue(sheetName, 146, 10, 199d),
						new ExpectedCellValue(sheetName, 147, 10, 6d),
						new ExpectedCellValue(sheetName, 148, 10, 1194),
						new ExpectedCellValue(sheetName, 149, 10, 199d),
						new ExpectedCellValue(sheetName, 150, 10, 6d),
						new ExpectedCellValue(sheetName, 151, 10, 1194d),
						new ExpectedCellValue(sheetName, 2, 11, null),
						new ExpectedCellValue(sheetName, 3, 11, "Tent Total"),
						new ExpectedCellValue(sheetName, 4, 11, null),
						new ExpectedCellValue(sheetName, 5, 11, null),
						new ExpectedCellValue(sheetName, 6, 11, null),
						new ExpectedCellValue(sheetName, 7, 11, null),
						new ExpectedCellValue(sheetName, 8, 11, null),
						new ExpectedCellValue(sheetName, 9, 11, null),
						new ExpectedCellValue(sheetName, 10, 11, null),
						new ExpectedCellValue(sheetName, 11, 11, null),
						new ExpectedCellValue(sheetName, 12, 11, null),
						new ExpectedCellValue(sheetName, 13, 11, null),
						new ExpectedCellValue(sheetName, 14, 11, null),
						new ExpectedCellValue(sheetName, 15, 11, null),
						new ExpectedCellValue(sheetName, 16, 11, null),
						new ExpectedCellValue(sheetName, 17, 11, null),
						new ExpectedCellValue(sheetName, 18, 11, null),
						new ExpectedCellValue(sheetName, 19, 11, null),
						new ExpectedCellValue(sheetName, 20, 11, null),
						new ExpectedCellValue(sheetName, 21, 11, null),
						new ExpectedCellValue(sheetName, 22, 11, null),
						new ExpectedCellValue(sheetName, 23, 11, null),
						new ExpectedCellValue(sheetName, 24, 11, null),
						new ExpectedCellValue(sheetName, 25, 11, null),
						new ExpectedCellValue(sheetName, 26, 11, null),
						new ExpectedCellValue(sheetName, 27, 11, null),
						new ExpectedCellValue(sheetName, 28, 11, null),
						new ExpectedCellValue(sheetName, 29, 11, null),
						new ExpectedCellValue(sheetName, 30, 11, null),
						new ExpectedCellValue(sheetName, 31, 11, null),
						new ExpectedCellValue(sheetName, 32, 11, null),
						new ExpectedCellValue(sheetName, 33, 11, null),
						new ExpectedCellValue(sheetName, 34, 11, null),
						new ExpectedCellValue(sheetName, 35, 11, null),
						new ExpectedCellValue(sheetName, 36, 11, null),
						new ExpectedCellValue(sheetName, 37, 11, null),
						new ExpectedCellValue(sheetName, 38, 11, null),
						new ExpectedCellValue(sheetName, 39, 11, null),
						new ExpectedCellValue(sheetName, 40, 11, null),
						new ExpectedCellValue(sheetName, 41, 11, null),
						new ExpectedCellValue(sheetName, 42, 11, null),
						new ExpectedCellValue(sheetName, 43, 11, null),
						new ExpectedCellValue(sheetName, 44, 11, null),
						new ExpectedCellValue(sheetName, 45, 11, null),
						new ExpectedCellValue(sheetName, 46, 11, null),
						new ExpectedCellValue(sheetName, 47, 11, null),
						new ExpectedCellValue(sheetName, 48, 11, null),
						new ExpectedCellValue(sheetName, 49, 11, null),
						new ExpectedCellValue(sheetName, 50, 11, null),
						new ExpectedCellValue(sheetName, 51, 11, null),
						new ExpectedCellValue(sheetName, 52, 11, null),
						new ExpectedCellValue(sheetName, 53, 11, null),
						new ExpectedCellValue(sheetName, 54, 11, null),
						new ExpectedCellValue(sheetName, 55, 11, null),
						new ExpectedCellValue(sheetName, 56, 11, null),
						new ExpectedCellValue(sheetName, 57, 11, null),
						new ExpectedCellValue(sheetName, 58, 11, null),
						new ExpectedCellValue(sheetName, 59, 11, null),
						new ExpectedCellValue(sheetName, 60, 11, null),
						new ExpectedCellValue(sheetName, 61, 11, null),
						new ExpectedCellValue(sheetName, 62, 11, null),
						new ExpectedCellValue(sheetName, 63, 11, null),
						new ExpectedCellValue(sheetName, 64, 11, null),
						new ExpectedCellValue(sheetName, 65, 11, null),
						new ExpectedCellValue(sheetName, 66, 11, null),
						new ExpectedCellValue(sheetName, 67, 11, null),
						new ExpectedCellValue(sheetName, 68, 11, null),
						new ExpectedCellValue(sheetName, 69, 11, null),
						new ExpectedCellValue(sheetName, 70, 11, null),
						new ExpectedCellValue(sheetName, 71, 11, null),
						new ExpectedCellValue(sheetName, 72, 11, null),
						new ExpectedCellValue(sheetName, 73, 11, null),
						new ExpectedCellValue(sheetName, 74, 11, null),
						new ExpectedCellValue(sheetName, 75, 11, null),
						new ExpectedCellValue(sheetName, 76, 11, null),
						new ExpectedCellValue(sheetName, 77, 11, null),
						new ExpectedCellValue(sheetName, 78, 11, null),
						new ExpectedCellValue(sheetName, 79, 11, null),
						new ExpectedCellValue(sheetName, 80, 11, null),
						new ExpectedCellValue(sheetName, 81, 11, null),
						new ExpectedCellValue(sheetName, 82, 11, null),
						new ExpectedCellValue(sheetName, 83, 11, null),
						new ExpectedCellValue(sheetName, 84, 11, null),
						new ExpectedCellValue(sheetName, 85, 11, null),
						new ExpectedCellValue(sheetName, 86, 11, null),
						new ExpectedCellValue(sheetName, 87, 11, null),
						new ExpectedCellValue(sheetName, 88, 11, null),
						new ExpectedCellValue(sheetName, 89, 11, null),
						new ExpectedCellValue(sheetName, 90, 11, null),
						new ExpectedCellValue(sheetName, 91, 11, null),
						new ExpectedCellValue(sheetName, 92, 11, null),
						new ExpectedCellValue(sheetName, 93, 11, null),
						new ExpectedCellValue(sheetName, 94, 11, null),
						new ExpectedCellValue(sheetName, 95, 11, null),
						new ExpectedCellValue(sheetName, 96, 11, null),
						new ExpectedCellValue(sheetName, 97, 11, null),
						new ExpectedCellValue(sheetName, 98, 11, null),
						new ExpectedCellValue(sheetName, 99, 11, null),
						new ExpectedCellValue(sheetName, 100, 11, null),
						new ExpectedCellValue(sheetName, 101, 11, null),
						new ExpectedCellValue(sheetName, 102, 11, null),
						new ExpectedCellValue(sheetName, 103, 11, null),
						new ExpectedCellValue(sheetName, 104, 11, null),
						new ExpectedCellValue(sheetName, 105, 11, null),
						new ExpectedCellValue(sheetName, 106, 11, null),
						new ExpectedCellValue(sheetName, 107, 11, null),
						new ExpectedCellValue(sheetName, 108, 11, null),
						new ExpectedCellValue(sheetName, 109, 11, 199d),
						new ExpectedCellValue(sheetName, 110, 11, 199d),
						new ExpectedCellValue(sheetName, 111, 11, 199d),
						new ExpectedCellValue(sheetName, 112, 11, null),
						new ExpectedCellValue(sheetName, 113, 11, 6d),
						new ExpectedCellValue(sheetName, 114, 11, 6d),
						new ExpectedCellValue(sheetName, 115, 11, 6d),
						new ExpectedCellValue(sheetName, 116, 11, null),
						new ExpectedCellValue(sheetName, 117, 11, 1194d),
						new ExpectedCellValue(sheetName, 118, 11, 1194d),
						new ExpectedCellValue(sheetName, 119, 11, 1194d),
						new ExpectedCellValue(sheetName, 120, 11, 199d),
						new ExpectedCellValue(sheetName, 121, 11, 6d),
						new ExpectedCellValue(sheetName, 122, 11, 1194d),
						new ExpectedCellValue(sheetName, 123, 11, 199d),
						new ExpectedCellValue(sheetName, 124, 11, 6d),
						new ExpectedCellValue(sheetName, 125, 11, 1194d),
						new ExpectedCellValue(sheetName, 126, 11, null),
						new ExpectedCellValue(sheetName, 127, 11, null),
						new ExpectedCellValue(sheetName, 128, 11, null),
						new ExpectedCellValue(sheetName, 129, 11, null),
						new ExpectedCellValue(sheetName, 130, 11, null),
						new ExpectedCellValue(sheetName, 131, 11, null),
						new ExpectedCellValue(sheetName, 132, 11, null),
						new ExpectedCellValue(sheetName, 133, 11, null),
						new ExpectedCellValue(sheetName, 134, 11, null),
						new ExpectedCellValue(sheetName, 135, 11, null),
						new ExpectedCellValue(sheetName, 136, 11, null),
						new ExpectedCellValue(sheetName, 137, 11, null),
						new ExpectedCellValue(sheetName, 138, 11, null),
						new ExpectedCellValue(sheetName, 139, 11, null),
						new ExpectedCellValue(sheetName, 140, 11, null),
						new ExpectedCellValue(sheetName, 141, 11, null),
						new ExpectedCellValue(sheetName, 142, 11, null),
						new ExpectedCellValue(sheetName, 143, 11, null),
						new ExpectedCellValue(sheetName, 144, 11, null),
						new ExpectedCellValue(sheetName, 145, 11, null),
						new ExpectedCellValue(sheetName, 146, 11, 199d),
						new ExpectedCellValue(sheetName, 147, 11, 6d),
						new ExpectedCellValue(sheetName, 148, 11, 1194),
						new ExpectedCellValue(sheetName, 149, 11, 199d),
						new ExpectedCellValue(sheetName, 150, 11, 6d),
						new ExpectedCellValue(sheetName, 151, 11, 1194d),
						new ExpectedCellValue(sheetName, 2, 12, "Nashville Total"),
						new ExpectedCellValue(sheetName, 3, 12, null),
						new ExpectedCellValue(sheetName, 4, 12, null),
						new ExpectedCellValue(sheetName, 5, 12, null),
						new ExpectedCellValue(sheetName, 6, 12, null),
						new ExpectedCellValue(sheetName, 7, 12, null),
						new ExpectedCellValue(sheetName, 8, 12, null),
						new ExpectedCellValue(sheetName, 9, 12, null),
						new ExpectedCellValue(sheetName, 10, 12, null),
						new ExpectedCellValue(sheetName, 11, 12, null),
						new ExpectedCellValue(sheetName, 12, 12, null),
						new ExpectedCellValue(sheetName, 13, 12, null),
						new ExpectedCellValue(sheetName, 14, 12, null),
						new ExpectedCellValue(sheetName, 15, 12, null),
						new ExpectedCellValue(sheetName, 16, 12, null),
						new ExpectedCellValue(sheetName, 17, 12, null),
						new ExpectedCellValue(sheetName, 18, 12, null),
						new ExpectedCellValue(sheetName, 19, 12, null),
						new ExpectedCellValue(sheetName, 20, 12, null),
						new ExpectedCellValue(sheetName, 21, 12, null),
						new ExpectedCellValue(sheetName, 22, 12, null),
						new ExpectedCellValue(sheetName, 23, 12, null),
						new ExpectedCellValue(sheetName, 24, 12, null),
						new ExpectedCellValue(sheetName, 25, 12, null),
						new ExpectedCellValue(sheetName, 26, 12, null),
						new ExpectedCellValue(sheetName, 27, 12, null),
						new ExpectedCellValue(sheetName, 28, 12, null),
						new ExpectedCellValue(sheetName, 29, 12, null),
						new ExpectedCellValue(sheetName, 30, 12, null),
						new ExpectedCellValue(sheetName, 31, 12, null),
						new ExpectedCellValue(sheetName, 32, 12, null),
						new ExpectedCellValue(sheetName, 33, 12, 415.75),
						new ExpectedCellValue(sheetName, 34, 12, 415.75),
						new ExpectedCellValue(sheetName, 35, 12, 415.75),
						new ExpectedCellValue(sheetName, 36, 12, null),
						new ExpectedCellValue(sheetName, 37, 12, 2d),
						new ExpectedCellValue(sheetName, 38, 12, 2d),
						new ExpectedCellValue(sheetName, 39, 12, 2d),
						new ExpectedCellValue(sheetName, 40, 12, null),
						new ExpectedCellValue(sheetName, 41, 12, 831.5),
						new ExpectedCellValue(sheetName, 42, 12, 831.5),
						new ExpectedCellValue(sheetName, 43, 12, 831.5),
						new ExpectedCellValue(sheetName, 44, 12, 415.75),
						new ExpectedCellValue(sheetName, 45, 12, 2d),
						new ExpectedCellValue(sheetName, 46, 12, 831.5),
						new ExpectedCellValue(sheetName, 47, 12, null),
						new ExpectedCellValue(sheetName, 48, 12, null),
						new ExpectedCellValue(sheetName, 49, 12, null),
						new ExpectedCellValue(sheetName, 50, 12, null),
						new ExpectedCellValue(sheetName, 51, 12, null),
						new ExpectedCellValue(sheetName, 52, 12, null),
						new ExpectedCellValue(sheetName, 53, 12, null),
						new ExpectedCellValue(sheetName, 54, 12, null),
						new ExpectedCellValue(sheetName, 55, 12, null),
						new ExpectedCellValue(sheetName, 56, 12, null),
						new ExpectedCellValue(sheetName, 57, 12, null),
						new ExpectedCellValue(sheetName, 58, 12, null),
						new ExpectedCellValue(sheetName, 59, 12, null),
						new ExpectedCellValue(sheetName, 60, 12, null),
						new ExpectedCellValue(sheetName, 61, 12, null),
						new ExpectedCellValue(sheetName, 62, 12, null),
						new ExpectedCellValue(sheetName, 63, 12, 415.75),
						new ExpectedCellValue(sheetName, 64, 12, 2d),
						new ExpectedCellValue(sheetName, 65, 12, 831.5),
						new ExpectedCellValue(sheetName, 66, 12, 415.75),
						new ExpectedCellValue(sheetName, 67, 12, 2d),
						new ExpectedCellValue(sheetName, 68, 12, 831.5),
						new ExpectedCellValue(sheetName, 69, 12, null),
						new ExpectedCellValue(sheetName, 70, 12, null),
						new ExpectedCellValue(sheetName, 71, 12, null),
						new ExpectedCellValue(sheetName, 72, 12, null),
						new ExpectedCellValue(sheetName, 73, 12, 415.75),
						new ExpectedCellValue(sheetName, 74, 12, 415.75),
						new ExpectedCellValue(sheetName, 75, 12, 415.75),
						new ExpectedCellValue(sheetName, 76, 12, null),
						new ExpectedCellValue(sheetName, 77, 12, 2d),
						new ExpectedCellValue(sheetName, 78, 12, 2d),
						new ExpectedCellValue(sheetName, 79, 12, 2d),
						new ExpectedCellValue(sheetName, 80, 12, null),
						new ExpectedCellValue(sheetName, 81, 12, 831.5),
						new ExpectedCellValue(sheetName, 82, 12, 831.5),
						new ExpectedCellValue(sheetName, 83, 12, 831.5),
						new ExpectedCellValue(sheetName, 84, 12, 415.75),
						new ExpectedCellValue(sheetName, 85, 12, 2d),
						new ExpectedCellValue(sheetName, 86, 12, 831.5),
						new ExpectedCellValue(sheetName, 87, 12, null),
						new ExpectedCellValue(sheetName, 88, 12, null),
						new ExpectedCellValue(sheetName, 89, 12, null),
						new ExpectedCellValue(sheetName, 90, 12, null),
						new ExpectedCellValue(sheetName, 91, 12, null),
						new ExpectedCellValue(sheetName, 92, 12, null),
						new ExpectedCellValue(sheetName, 93, 12, null),
						new ExpectedCellValue(sheetName, 94, 12, null),
						new ExpectedCellValue(sheetName, 95, 12, null),
						new ExpectedCellValue(sheetName, 96, 12, null),
						new ExpectedCellValue(sheetName, 97, 12, null),
						new ExpectedCellValue(sheetName, 98, 12, null),
						new ExpectedCellValue(sheetName, 99, 12, null),
						new ExpectedCellValue(sheetName, 100, 12, null),
						new ExpectedCellValue(sheetName, 101, 12, null),
						new ExpectedCellValue(sheetName, 102, 12, null),
						new ExpectedCellValue(sheetName, 103, 12, 415.75),
						new ExpectedCellValue(sheetName, 104, 12, 2d),
						new ExpectedCellValue(sheetName, 105, 12, 831.5),
						new ExpectedCellValue(sheetName, 106, 12, null),
						new ExpectedCellValue(sheetName, 107, 12, null),
						new ExpectedCellValue(sheetName, 108, 12, null),
						new ExpectedCellValue(sheetName, 109, 12, 199d),
						new ExpectedCellValue(sheetName, 110, 12, 199d),
						new ExpectedCellValue(sheetName, 111, 12, 199d),
						new ExpectedCellValue(sheetName, 112, 12, null),
						new ExpectedCellValue(sheetName, 113, 12, 6d),
						new ExpectedCellValue(sheetName, 114, 12, 6d),
						new ExpectedCellValue(sheetName, 115, 12, 6d),
						new ExpectedCellValue(sheetName, 116, 12, null),
						new ExpectedCellValue(sheetName, 117, 12, 1194d),
						new ExpectedCellValue(sheetName, 118, 12, 1194d),
						new ExpectedCellValue(sheetName, 119, 12, 1194d),
						new ExpectedCellValue(sheetName, 120, 12, 199d),
						new ExpectedCellValue(sheetName, 121, 12, 6d),
						new ExpectedCellValue(sheetName, 122, 12, 1194d),
						new ExpectedCellValue(sheetName, 123, 12, 199d),
						new ExpectedCellValue(sheetName, 124, 12, 6d),
						new ExpectedCellValue(sheetName, 125, 12, 1194d),
						new ExpectedCellValue(sheetName, 126, 12, null),
						new ExpectedCellValue(sheetName, 127, 12, null),
						new ExpectedCellValue(sheetName, 128, 12, null),
						new ExpectedCellValue(sheetName, 129, 12, null),
						new ExpectedCellValue(sheetName, 130, 12, null),
						new ExpectedCellValue(sheetName, 131, 12, null),
						new ExpectedCellValue(sheetName, 132, 12, null),
						new ExpectedCellValue(sheetName, 133, 12, null),
						new ExpectedCellValue(sheetName, 134, 12, null),
						new ExpectedCellValue(sheetName, 135, 12, null),
						new ExpectedCellValue(sheetName, 136, 12, null),
						new ExpectedCellValue(sheetName, 137, 12, null),
						new ExpectedCellValue(sheetName, 138, 12, null),
						new ExpectedCellValue(sheetName, 139, 12, null),
						new ExpectedCellValue(sheetName, 140, 12, null),
						new ExpectedCellValue(sheetName, 141, 12, null),
						new ExpectedCellValue(sheetName, 142, 12, null),
						new ExpectedCellValue(sheetName, 143, 12, null),
						new ExpectedCellValue(sheetName, 144, 12, null),
						new ExpectedCellValue(sheetName, 145, 12, null),
						new ExpectedCellValue(sheetName, 146, 12, 614.75),
						new ExpectedCellValue(sheetName, 147, 12, 8d),
						new ExpectedCellValue(sheetName, 148, 12, 2025.5),
						new ExpectedCellValue(sheetName, 149, 12, 1030.5),
						new ExpectedCellValue(sheetName, 150, 12, 10d),
						new ExpectedCellValue(sheetName, 151, 12, 2857d),
						new ExpectedCellValue(sheetName, 2, 13, "San Francisco"),
						new ExpectedCellValue(sheetName, 3, 13, "Car Rack"),
						new ExpectedCellValue(sheetName, 4, 13, "Nov"),
						new ExpectedCellValue(sheetName, 5, 13, null),
						new ExpectedCellValue(sheetName, 6, 13, null),
						new ExpectedCellValue(sheetName, 7, 13, null),
						new ExpectedCellValue(sheetName, 8, 13, null),
						new ExpectedCellValue(sheetName, 9, 13, null),
						new ExpectedCellValue(sheetName, 10, 13, null),
						new ExpectedCellValue(sheetName, 11, 13, null),
						new ExpectedCellValue(sheetName, 12, 13, null),
						new ExpectedCellValue(sheetName, 13, 13, null),
						new ExpectedCellValue(sheetName, 14, 13, null),
						new ExpectedCellValue(sheetName, 15, 13, null),
						new ExpectedCellValue(sheetName, 16, 13, null),
						new ExpectedCellValue(sheetName, 17, 13, null),
						new ExpectedCellValue(sheetName, 18, 13, null),
						new ExpectedCellValue(sheetName, 19, 13, null),
						new ExpectedCellValue(sheetName, 20, 13, null),
						new ExpectedCellValue(sheetName, 21, 13, null),
						new ExpectedCellValue(sheetName, 22, 13, null),
						new ExpectedCellValue(sheetName, 23, 13, null),
						new ExpectedCellValue(sheetName, 24, 13, null),
						new ExpectedCellValue(sheetName, 25, 13, null),
						new ExpectedCellValue(sheetName, 26, 13, null),
						new ExpectedCellValue(sheetName, 27, 13, null),
						new ExpectedCellValue(sheetName, 28, 13, null),
						new ExpectedCellValue(sheetName, 29, 13, null),
						new ExpectedCellValue(sheetName, 30, 13, null),
						new ExpectedCellValue(sheetName, 31, 13, null),
						new ExpectedCellValue(sheetName, 32, 13, null),
						new ExpectedCellValue(sheetName, 33, 13, null),
						new ExpectedCellValue(sheetName, 34, 13, null),
						new ExpectedCellValue(sheetName, 35, 13, null),
						new ExpectedCellValue(sheetName, 36, 13, null),
						new ExpectedCellValue(sheetName, 37, 13, null),
						new ExpectedCellValue(sheetName, 38, 13, null),
						new ExpectedCellValue(sheetName, 39, 13, null),
						new ExpectedCellValue(sheetName, 40, 13, null),
						new ExpectedCellValue(sheetName, 41, 13, null),
						new ExpectedCellValue(sheetName, 42, 13, null),
						new ExpectedCellValue(sheetName, 43, 13, null),
						new ExpectedCellValue(sheetName, 44, 13, null),
						new ExpectedCellValue(sheetName, 45, 13, null),
						new ExpectedCellValue(sheetName, 46, 13, null),
						new ExpectedCellValue(sheetName, 47, 13, null),
						new ExpectedCellValue(sheetName, 48, 13, null),
						new ExpectedCellValue(sheetName, 49, 13, null),
						new ExpectedCellValue(sheetName, 50, 13, null),
						new ExpectedCellValue(sheetName, 51, 13, null),
						new ExpectedCellValue(sheetName, 52, 13, null),
						new ExpectedCellValue(sheetName, 53, 13, null),
						new ExpectedCellValue(sheetName, 54, 13, null),
						new ExpectedCellValue(sheetName, 55, 13, null),
						new ExpectedCellValue(sheetName, 56, 13, null),
						new ExpectedCellValue(sheetName, 57, 13, null),
						new ExpectedCellValue(sheetName, 58, 13, null),
						new ExpectedCellValue(sheetName, 59, 13, null),
						new ExpectedCellValue(sheetName, 60, 13, null),
						new ExpectedCellValue(sheetName, 61, 13, null),
						new ExpectedCellValue(sheetName, 62, 13, null),
						new ExpectedCellValue(sheetName, 63, 13, null),
						new ExpectedCellValue(sheetName, 64, 13, null),
						new ExpectedCellValue(sheetName, 65, 13, null),
						new ExpectedCellValue(sheetName, 66, 13, null),
						new ExpectedCellValue(sheetName, 67, 13, null),
						new ExpectedCellValue(sheetName, 68, 13, null),
						new ExpectedCellValue(sheetName, 69, 13, null),
						new ExpectedCellValue(sheetName, 70, 13, null),
						new ExpectedCellValue(sheetName, 71, 13, null),
						new ExpectedCellValue(sheetName, 72, 13, null),
						new ExpectedCellValue(sheetName, 73, 13, null),
						new ExpectedCellValue(sheetName, 74, 13, null),
						new ExpectedCellValue(sheetName, 75, 13, null),
						new ExpectedCellValue(sheetName, 76, 13, null),
						new ExpectedCellValue(sheetName, 77, 13, null),
						new ExpectedCellValue(sheetName, 78, 13, null),
						new ExpectedCellValue(sheetName, 79, 13, null),
						new ExpectedCellValue(sheetName, 80, 13, null),
						new ExpectedCellValue(sheetName, 81, 13, null),
						new ExpectedCellValue(sheetName, 82, 13, null),
						new ExpectedCellValue(sheetName, 83, 13, null),
						new ExpectedCellValue(sheetName, 84, 13, null),
						new ExpectedCellValue(sheetName, 85, 13, null),
						new ExpectedCellValue(sheetName, 86, 13, null),
						new ExpectedCellValue(sheetName, 87, 13, null),
						new ExpectedCellValue(sheetName, 88, 13, null),
						new ExpectedCellValue(sheetName, 89, 13, null),
						new ExpectedCellValue(sheetName, 90, 13, null),
						new ExpectedCellValue(sheetName, 91, 13, null),
						new ExpectedCellValue(sheetName, 92, 13, null),
						new ExpectedCellValue(sheetName, 93, 13, null),
						new ExpectedCellValue(sheetName, 94, 13, null),
						new ExpectedCellValue(sheetName, 95, 13, null),
						new ExpectedCellValue(sheetName, 96, 13, null),
						new ExpectedCellValue(sheetName, 97, 13, null),
						new ExpectedCellValue(sheetName, 98, 13, null),
						new ExpectedCellValue(sheetName, 99, 13, null),
						new ExpectedCellValue(sheetName, 100, 13, null),
						new ExpectedCellValue(sheetName, 101, 13, null),
						new ExpectedCellValue(sheetName, 102, 13, null),
						new ExpectedCellValue(sheetName, 103, 13, null),
						new ExpectedCellValue(sheetName, 104, 13, null),
						new ExpectedCellValue(sheetName, 105, 13, null),
						new ExpectedCellValue(sheetName, 106, 13, null),
						new ExpectedCellValue(sheetName, 107, 13, null),
						new ExpectedCellValue(sheetName, 108, 13, null),
						new ExpectedCellValue(sheetName, 109, 13, null),
						new ExpectedCellValue(sheetName, 110, 13, null),
						new ExpectedCellValue(sheetName, 111, 13, null),
						new ExpectedCellValue(sheetName, 112, 13, null),
						new ExpectedCellValue(sheetName, 113, 13, null),
						new ExpectedCellValue(sheetName, 114, 13, null),
						new ExpectedCellValue(sheetName, 115, 13, null),
						new ExpectedCellValue(sheetName, 116, 13, null),
						new ExpectedCellValue(sheetName, 117, 13, null),
						new ExpectedCellValue(sheetName, 118, 13, null),
						new ExpectedCellValue(sheetName, 119, 13, null),
						new ExpectedCellValue(sheetName, 120, 13, null),
						new ExpectedCellValue(sheetName, 121, 13, null),
						new ExpectedCellValue(sheetName, 122, 13, null),
						new ExpectedCellValue(sheetName, 123, 13, null),
						new ExpectedCellValue(sheetName, 124, 13, null),
						new ExpectedCellValue(sheetName, 125, 13, null),
						new ExpectedCellValue(sheetName, 126, 13, null),
						new ExpectedCellValue(sheetName, 127, 13, null),
						new ExpectedCellValue(sheetName, 128, 13, null),
						new ExpectedCellValue(sheetName, 129, 13, 415.75),
						new ExpectedCellValue(sheetName, 130, 13, 415.75),
						new ExpectedCellValue(sheetName, 131, 13, 415.75),
						new ExpectedCellValue(sheetName, 132, 13, null),
						new ExpectedCellValue(sheetName, 133, 13, 1d),
						new ExpectedCellValue(sheetName, 134, 13, 1d),
						new ExpectedCellValue(sheetName, 135, 13, 1d),
						new ExpectedCellValue(sheetName, 136, 13, null),
						new ExpectedCellValue(sheetName, 137, 13, 415.75),
						new ExpectedCellValue(sheetName, 138, 13, 415.75),
						new ExpectedCellValue(sheetName, 139, 13, 415.75),
						new ExpectedCellValue(sheetName, 140, 13, 415.75),
						new ExpectedCellValue(sheetName, 141, 13, 1d),
						new ExpectedCellValue(sheetName, 142, 13, 415.75),
						new ExpectedCellValue(sheetName, 143, 13, 415.75),
						new ExpectedCellValue(sheetName, 144, 13, 1d),
						new ExpectedCellValue(sheetName, 145, 13, 415.75),
						new ExpectedCellValue(sheetName, 146, 13, 415.75),
						new ExpectedCellValue(sheetName, 147, 13, 1d),
						new ExpectedCellValue(sheetName, 148, 13, 415.75),
						new ExpectedCellValue(sheetName, 149, 13, 415.75),
						new ExpectedCellValue(sheetName, 150, 13, 1d),
						new ExpectedCellValue(sheetName, 151, 13, 415.75),
						new ExpectedCellValue(sheetName, 2, 14, null),
						new ExpectedCellValue(sheetName, 3, 14, "Car Rack Total"),
						new ExpectedCellValue(sheetName, 4, 14, null),
						new ExpectedCellValue(sheetName, 5, 14, null),
						new ExpectedCellValue(sheetName, 6, 14, null),
						new ExpectedCellValue(sheetName, 7, 14, null),
						new ExpectedCellValue(sheetName, 8, 14, null),
						new ExpectedCellValue(sheetName, 9, 14, null),
						new ExpectedCellValue(sheetName, 10, 14, null),
						new ExpectedCellValue(sheetName, 11, 14, null),
						new ExpectedCellValue(sheetName, 12, 14, null),
						new ExpectedCellValue(sheetName, 13, 14, null),
						new ExpectedCellValue(sheetName, 14, 14, null),
						new ExpectedCellValue(sheetName, 15, 14, null),
						new ExpectedCellValue(sheetName, 16, 14, null),
						new ExpectedCellValue(sheetName, 17, 14, null),
						new ExpectedCellValue(sheetName, 18, 14, null),
						new ExpectedCellValue(sheetName, 19, 14, null),
						new ExpectedCellValue(sheetName, 20, 14, null),
						new ExpectedCellValue(sheetName, 21, 14, null),
						new ExpectedCellValue(sheetName, 22, 14, null),
						new ExpectedCellValue(sheetName, 23, 14, null),
						new ExpectedCellValue(sheetName, 24, 14, null),
						new ExpectedCellValue(sheetName, 25, 14, null),
						new ExpectedCellValue(sheetName, 26, 14, null),
						new ExpectedCellValue(sheetName, 27, 14, null),
						new ExpectedCellValue(sheetName, 28, 14, null),
						new ExpectedCellValue(sheetName, 29, 14, null),
						new ExpectedCellValue(sheetName, 30, 14, null),
						new ExpectedCellValue(sheetName, 31, 14, null),
						new ExpectedCellValue(sheetName, 32, 14, null),
						new ExpectedCellValue(sheetName, 33, 14, null),
						new ExpectedCellValue(sheetName, 34, 14, null),
						new ExpectedCellValue(sheetName, 35, 14, null),
						new ExpectedCellValue(sheetName, 36, 14, null),
						new ExpectedCellValue(sheetName, 37, 14, null),
						new ExpectedCellValue(sheetName, 38, 14, null),
						new ExpectedCellValue(sheetName, 39, 14, null),
						new ExpectedCellValue(sheetName, 40, 14, null),
						new ExpectedCellValue(sheetName, 41, 14, null),
						new ExpectedCellValue(sheetName, 42, 14, null),
						new ExpectedCellValue(sheetName, 43, 14, null),
						new ExpectedCellValue(sheetName, 44, 14, null),
						new ExpectedCellValue(sheetName, 45, 14, null),
						new ExpectedCellValue(sheetName, 46, 14, null),
						new ExpectedCellValue(sheetName, 47, 14, null),
						new ExpectedCellValue(sheetName, 48, 14, null),
						new ExpectedCellValue(sheetName, 49, 14, null),
						new ExpectedCellValue(sheetName, 50, 14, null),
						new ExpectedCellValue(sheetName, 51, 14, null),
						new ExpectedCellValue(sheetName, 52, 14, null),
						new ExpectedCellValue(sheetName, 53, 14, null),
						new ExpectedCellValue(sheetName, 54, 14, null),
						new ExpectedCellValue(sheetName, 55, 14, null),
						new ExpectedCellValue(sheetName, 56, 14, null),
						new ExpectedCellValue(sheetName, 57, 14, null),
						new ExpectedCellValue(sheetName, 58, 14, null),
						new ExpectedCellValue(sheetName, 59, 14, null),
						new ExpectedCellValue(sheetName, 60, 14, null),
						new ExpectedCellValue(sheetName, 61, 14, null),
						new ExpectedCellValue(sheetName, 62, 14, null),
						new ExpectedCellValue(sheetName, 63, 14, null),
						new ExpectedCellValue(sheetName, 64, 14, null),
						new ExpectedCellValue(sheetName, 65, 14, null),
						new ExpectedCellValue(sheetName, 66, 14, null),
						new ExpectedCellValue(sheetName, 67, 14, null),
						new ExpectedCellValue(sheetName, 68, 14, null),
						new ExpectedCellValue(sheetName, 69, 14, null),
						new ExpectedCellValue(sheetName, 70, 14, null),
						new ExpectedCellValue(sheetName, 71, 14, null),
						new ExpectedCellValue(sheetName, 72, 14, null),
						new ExpectedCellValue(sheetName, 73, 14, null),
						new ExpectedCellValue(sheetName, 74, 14, null),
						new ExpectedCellValue(sheetName, 75, 14, null),
						new ExpectedCellValue(sheetName, 76, 14, null),
						new ExpectedCellValue(sheetName, 77, 14, null),
						new ExpectedCellValue(sheetName, 78, 14, null),
						new ExpectedCellValue(sheetName, 79, 14, null),
						new ExpectedCellValue(sheetName, 80, 14, null),
						new ExpectedCellValue(sheetName, 81, 14, null),
						new ExpectedCellValue(sheetName, 82, 14, null),
						new ExpectedCellValue(sheetName, 83, 14, null),
						new ExpectedCellValue(sheetName, 84, 14, null),
						new ExpectedCellValue(sheetName, 85, 14, null),
						new ExpectedCellValue(sheetName, 86, 14, null),
						new ExpectedCellValue(sheetName, 87, 14, null),
						new ExpectedCellValue(sheetName, 88, 14, null),
						new ExpectedCellValue(sheetName, 89, 14, null),
						new ExpectedCellValue(sheetName, 90, 14, null),
						new ExpectedCellValue(sheetName, 91, 14, null),
						new ExpectedCellValue(sheetName, 92, 14, null),
						new ExpectedCellValue(sheetName, 93, 14, null),
						new ExpectedCellValue(sheetName, 94, 14, null),
						new ExpectedCellValue(sheetName, 95, 14, null),
						new ExpectedCellValue(sheetName, 96, 14, null),
						new ExpectedCellValue(sheetName, 97, 14, null),
						new ExpectedCellValue(sheetName, 98, 14, null),
						new ExpectedCellValue(sheetName, 99, 14, null),
						new ExpectedCellValue(sheetName, 100, 14, null),
						new ExpectedCellValue(sheetName, 101, 14, null),
						new ExpectedCellValue(sheetName, 102, 14, null),
						new ExpectedCellValue(sheetName, 103, 14, null),
						new ExpectedCellValue(sheetName, 104, 14, null),
						new ExpectedCellValue(sheetName, 105, 14, null),
						new ExpectedCellValue(sheetName, 106, 14, null),
						new ExpectedCellValue(sheetName, 107, 14, null),
						new ExpectedCellValue(sheetName, 108, 14, null),
						new ExpectedCellValue(sheetName, 109, 14, null),
						new ExpectedCellValue(sheetName, 110, 14, null),
						new ExpectedCellValue(sheetName, 111, 14, null),
						new ExpectedCellValue(sheetName, 112, 14, null),
						new ExpectedCellValue(sheetName, 113, 14, null),
						new ExpectedCellValue(sheetName, 114, 14, null),
						new ExpectedCellValue(sheetName, 115, 14, null),
						new ExpectedCellValue(sheetName, 116, 14, null),
						new ExpectedCellValue(sheetName, 117, 14, null),
						new ExpectedCellValue(sheetName, 118, 14, null),
						new ExpectedCellValue(sheetName, 119, 14, null),
						new ExpectedCellValue(sheetName, 120, 14, null),
						new ExpectedCellValue(sheetName, 121, 14, null),
						new ExpectedCellValue(sheetName, 122, 14, null),
						new ExpectedCellValue(sheetName, 123, 14, null),
						new ExpectedCellValue(sheetName, 124, 14, null),
						new ExpectedCellValue(sheetName, 125, 14, null),
						new ExpectedCellValue(sheetName, 126, 14, null),
						new ExpectedCellValue(sheetName, 127, 14, null),
						new ExpectedCellValue(sheetName, 128, 14, null),
						new ExpectedCellValue(sheetName, 129, 14, 415.75),
						new ExpectedCellValue(sheetName, 130, 14, 415.75),
						new ExpectedCellValue(sheetName, 131, 14, 415.75),
						new ExpectedCellValue(sheetName, 132, 14, null),
						new ExpectedCellValue(sheetName, 133, 14, 1d),
						new ExpectedCellValue(sheetName, 134, 14, 1d),
						new ExpectedCellValue(sheetName, 135, 14, 1d),
						new ExpectedCellValue(sheetName, 136, 14, null),
						new ExpectedCellValue(sheetName, 137, 14, 415.75),
						new ExpectedCellValue(sheetName, 138, 14, 415.75),
						new ExpectedCellValue(sheetName, 139, 14, 415.75),
						new ExpectedCellValue(sheetName, 140, 14, 415.75),
						new ExpectedCellValue(sheetName, 141, 14, 1d),
						new ExpectedCellValue(sheetName, 142, 14, 415.75),
						new ExpectedCellValue(sheetName, 143, 14, 415.75),
						new ExpectedCellValue(sheetName, 144, 14, 1d),
						new ExpectedCellValue(sheetName, 145, 14, 415.75),
						new ExpectedCellValue(sheetName, 146, 14, 415.75),
						new ExpectedCellValue(sheetName, 147, 14, 1d),
						new ExpectedCellValue(sheetName, 148, 14, 415.75),
						new ExpectedCellValue(sheetName, 149, 14, 415.75),
						new ExpectedCellValue(sheetName, 150, 14, 1d),
						new ExpectedCellValue(sheetName, 151, 14, 415.75),
						new ExpectedCellValue(sheetName, 2, 15, null),
						new ExpectedCellValue(sheetName, 3, 15, "Sleeping Bag"),
						new ExpectedCellValue(sheetName, 4, 15, "Dec"),
						new ExpectedCellValue(sheetName, 5, 15, null),
						new ExpectedCellValue(sheetName, 6, 15, null),
						new ExpectedCellValue(sheetName, 7, 15, null),
						new ExpectedCellValue(sheetName, 8, 15, null),
						new ExpectedCellValue(sheetName, 9, 15, null),
						new ExpectedCellValue(sheetName, 10, 15, null),
						new ExpectedCellValue(sheetName, 11, 15, null),
						new ExpectedCellValue(sheetName, 12, 15, null),
						new ExpectedCellValue(sheetName, 13, 15, null),
						new ExpectedCellValue(sheetName, 14, 15, null),
						new ExpectedCellValue(sheetName, 15, 15, null),
						new ExpectedCellValue(sheetName, 16, 15, null),
						new ExpectedCellValue(sheetName, 17, 15, null),
						new ExpectedCellValue(sheetName, 18, 15, null),
						new ExpectedCellValue(sheetName, 19, 15, null),
						new ExpectedCellValue(sheetName, 20, 15, null),
						new ExpectedCellValue(sheetName, 21, 15, null),
						new ExpectedCellValue(sheetName, 22, 15, null),
						new ExpectedCellValue(sheetName, 23, 15, null),
						new ExpectedCellValue(sheetName, 24, 15, null),
						new ExpectedCellValue(sheetName, 25, 15, null),
						new ExpectedCellValue(sheetName, 26, 15, null),
						new ExpectedCellValue(sheetName, 27, 15, null),
						new ExpectedCellValue(sheetName, 28, 15, null),
						new ExpectedCellValue(sheetName, 29, 15, null),
						new ExpectedCellValue(sheetName, 30, 15, null),
						new ExpectedCellValue(sheetName, 31, 15, null),
						new ExpectedCellValue(sheetName, 32, 15, null),
						new ExpectedCellValue(sheetName, 33, 15, null),
						new ExpectedCellValue(sheetName, 34, 15, null),
						new ExpectedCellValue(sheetName, 35, 15, null),
						new ExpectedCellValue(sheetName, 36, 15, null),
						new ExpectedCellValue(sheetName, 37, 15, null),
						new ExpectedCellValue(sheetName, 38, 15, null),
						new ExpectedCellValue(sheetName, 39, 15, null),
						new ExpectedCellValue(sheetName, 40, 15, null),
						new ExpectedCellValue(sheetName, 41, 15, null),
						new ExpectedCellValue(sheetName, 42, 15, null),
						new ExpectedCellValue(sheetName, 43, 15, null),
						new ExpectedCellValue(sheetName, 44, 15, null),
						new ExpectedCellValue(sheetName, 45, 15, null),
						new ExpectedCellValue(sheetName, 46, 15, null),
						new ExpectedCellValue(sheetName, 47, 15, null),
						new ExpectedCellValue(sheetName, 48, 15, null),
						new ExpectedCellValue(sheetName, 49, 15, 99d),
						new ExpectedCellValue(sheetName, 50, 15, 99d),
						new ExpectedCellValue(sheetName, 51, 15, 99d),
						new ExpectedCellValue(sheetName, 52, 15, null),
						new ExpectedCellValue(sheetName, 53, 15, 1d),
						new ExpectedCellValue(sheetName, 54, 15, 1d),
						new ExpectedCellValue(sheetName, 55, 15, 1d),
						new ExpectedCellValue(sheetName, 56, 15, null),
						new ExpectedCellValue(sheetName, 57, 15, 99d),
						new ExpectedCellValue(sheetName, 58, 15, 99d),
						new ExpectedCellValue(sheetName, 59, 15, 99d),
						new ExpectedCellValue(sheetName, 60, 15, 99d),
						new ExpectedCellValue(sheetName, 61, 15, 1d),
						new ExpectedCellValue(sheetName, 62, 15, 99d),
						new ExpectedCellValue(sheetName, 63, 15, 99d),
						new ExpectedCellValue(sheetName, 64, 15, 1d),
						new ExpectedCellValue(sheetName, 65, 15, 99d),
						new ExpectedCellValue(sheetName, 66, 15, 99d),
						new ExpectedCellValue(sheetName, 67, 15, 1d),
						new ExpectedCellValue(sheetName, 68, 15, 99d),
						new ExpectedCellValue(sheetName, 69, 15, null),
						new ExpectedCellValue(sheetName, 70, 15, null),
						new ExpectedCellValue(sheetName, 71, 15, null),
						new ExpectedCellValue(sheetName, 72, 15, null),
						new ExpectedCellValue(sheetName, 73, 15, null),
						new ExpectedCellValue(sheetName, 74, 15, null),
						new ExpectedCellValue(sheetName, 75, 15, null),
						new ExpectedCellValue(sheetName, 76, 15, null),
						new ExpectedCellValue(sheetName, 77, 15, null),
						new ExpectedCellValue(sheetName, 78, 15, null),
						new ExpectedCellValue(sheetName, 79, 15, null),
						new ExpectedCellValue(sheetName, 80, 15, null),
						new ExpectedCellValue(sheetName, 81, 15, null),
						new ExpectedCellValue(sheetName, 82, 15, null),
						new ExpectedCellValue(sheetName, 83, 15, null),
						new ExpectedCellValue(sheetName, 84, 15, null),
						new ExpectedCellValue(sheetName, 85, 15, null),
						new ExpectedCellValue(sheetName, 86, 15, null),
						new ExpectedCellValue(sheetName, 87, 15, null),
						new ExpectedCellValue(sheetName, 88, 15, null),
						new ExpectedCellValue(sheetName, 89, 15, null),
						new ExpectedCellValue(sheetName, 90, 15, null),
						new ExpectedCellValue(sheetName, 91, 15, null),
						new ExpectedCellValue(sheetName, 92, 15, null),
						new ExpectedCellValue(sheetName, 93, 15, null),
						new ExpectedCellValue(sheetName, 94, 15, null),
						new ExpectedCellValue(sheetName, 95, 15, null),
						new ExpectedCellValue(sheetName, 96, 15, null),
						new ExpectedCellValue(sheetName, 97, 15, null),
						new ExpectedCellValue(sheetName, 98, 15, null),
						new ExpectedCellValue(sheetName, 99, 15, null),
						new ExpectedCellValue(sheetName, 100, 15, null),
						new ExpectedCellValue(sheetName, 101, 15, null),
						new ExpectedCellValue(sheetName, 102, 15, null),
						new ExpectedCellValue(sheetName, 103, 15, null),
						new ExpectedCellValue(sheetName, 104, 15, null),
						new ExpectedCellValue(sheetName, 105, 15, null),
						new ExpectedCellValue(sheetName, 106, 15, null),
						new ExpectedCellValue(sheetName, 107, 15, null),
						new ExpectedCellValue(sheetName, 108, 15, null),
						new ExpectedCellValue(sheetName, 109, 15, null),
						new ExpectedCellValue(sheetName, 110, 15, null),
						new ExpectedCellValue(sheetName, 111, 15, null),
						new ExpectedCellValue(sheetName, 112, 15, null),
						new ExpectedCellValue(sheetName, 113, 15, null),
						new ExpectedCellValue(sheetName, 114, 15, null),
						new ExpectedCellValue(sheetName, 115, 15, null),
						new ExpectedCellValue(sheetName, 116, 15, null),
						new ExpectedCellValue(sheetName, 117, 15, null),
						new ExpectedCellValue(sheetName, 118, 15, null),
						new ExpectedCellValue(sheetName, 119, 15, null),
						new ExpectedCellValue(sheetName, 120, 15, null),
						new ExpectedCellValue(sheetName, 121, 15, null),
						new ExpectedCellValue(sheetName, 122, 15, null),
						new ExpectedCellValue(sheetName, 123, 15, null),
						new ExpectedCellValue(sheetName, 124, 15, null),
						new ExpectedCellValue(sheetName, 125, 15, null),
						new ExpectedCellValue(sheetName, 126, 15, null),
						new ExpectedCellValue(sheetName, 127, 15, null),
						new ExpectedCellValue(sheetName, 128, 15, null),
						new ExpectedCellValue(sheetName, 129, 15, null),
						new ExpectedCellValue(sheetName, 130, 15, null),
						new ExpectedCellValue(sheetName, 131, 15, null),
						new ExpectedCellValue(sheetName, 132, 15, null),
						new ExpectedCellValue(sheetName, 133, 15, null),
						new ExpectedCellValue(sheetName, 134, 15, null),
						new ExpectedCellValue(sheetName, 135, 15, null),
						new ExpectedCellValue(sheetName, 136, 15, null),
						new ExpectedCellValue(sheetName, 137, 15, null),
						new ExpectedCellValue(sheetName, 138, 15, null),
						new ExpectedCellValue(sheetName, 139, 15, null),
						new ExpectedCellValue(sheetName, 140, 15, null),
						new ExpectedCellValue(sheetName, 141, 15, null),
						new ExpectedCellValue(sheetName, 142, 15, null),
						new ExpectedCellValue(sheetName, 143, 15, null),
						new ExpectedCellValue(sheetName, 144, 15, null),
						new ExpectedCellValue(sheetName, 145, 15, null),
						new ExpectedCellValue(sheetName, 146, 15, null),
						new ExpectedCellValue(sheetName, 147, 15, null),
						new ExpectedCellValue(sheetName, 148, 15, null),
						new ExpectedCellValue(sheetName, 149, 15, 99d),
						new ExpectedCellValue(sheetName, 150, 15, 1d),
						new ExpectedCellValue(sheetName, 151, 15, 99d),
						new ExpectedCellValue(sheetName, 2, 16, null),
						new ExpectedCellValue(sheetName, 3, 16, "Sleeping Bag Total"),
						new ExpectedCellValue(sheetName, 4, 16, null),
						new ExpectedCellValue(sheetName, 5, 16, null),
						new ExpectedCellValue(sheetName, 6, 16, null),
						new ExpectedCellValue(sheetName, 7, 16, null),
						new ExpectedCellValue(sheetName, 8, 16, null),
						new ExpectedCellValue(sheetName, 9, 16, null),
						new ExpectedCellValue(sheetName, 10, 16, null),
						new ExpectedCellValue(sheetName, 11, 16, null),
						new ExpectedCellValue(sheetName, 12, 16, null),
						new ExpectedCellValue(sheetName, 13, 16, null),
						new ExpectedCellValue(sheetName, 14, 16, null),
						new ExpectedCellValue(sheetName, 15, 16, null),
						new ExpectedCellValue(sheetName, 16, 16, null),
						new ExpectedCellValue(sheetName, 17, 16, null),
						new ExpectedCellValue(sheetName, 18, 16, null),
						new ExpectedCellValue(sheetName, 19, 16, null),
						new ExpectedCellValue(sheetName, 20, 16, null),
						new ExpectedCellValue(sheetName, 21, 16, null),
						new ExpectedCellValue(sheetName, 22, 16, null),
						new ExpectedCellValue(sheetName, 23, 16, null),
						new ExpectedCellValue(sheetName, 24, 16, null),
						new ExpectedCellValue(sheetName, 25, 16, null),
						new ExpectedCellValue(sheetName, 26, 16, null),
						new ExpectedCellValue(sheetName, 27, 16, null),
						new ExpectedCellValue(sheetName, 28, 16, null),
						new ExpectedCellValue(sheetName, 29, 16, null),
						new ExpectedCellValue(sheetName, 30, 16, null),
						new ExpectedCellValue(sheetName, 31, 16, null),
						new ExpectedCellValue(sheetName, 32, 16, null),
						new ExpectedCellValue(sheetName, 33, 16, null),
						new ExpectedCellValue(sheetName, 34, 16, null),
						new ExpectedCellValue(sheetName, 35, 16, null),
						new ExpectedCellValue(sheetName, 36, 16, null),
						new ExpectedCellValue(sheetName, 37, 16, null),
						new ExpectedCellValue(sheetName, 38, 16, null),
						new ExpectedCellValue(sheetName, 39, 16, null),
						new ExpectedCellValue(sheetName, 40, 16, null),
						new ExpectedCellValue(sheetName, 41, 16, null),
						new ExpectedCellValue(sheetName, 42, 16, null),
						new ExpectedCellValue(sheetName, 43, 16, null),
						new ExpectedCellValue(sheetName, 44, 16, null),
						new ExpectedCellValue(sheetName, 45, 16, null),
						new ExpectedCellValue(sheetName, 46, 16, null),
						new ExpectedCellValue(sheetName, 47, 16, null),
						new ExpectedCellValue(sheetName, 48, 16, null),
						new ExpectedCellValue(sheetName, 49, 16, 99d),
						new ExpectedCellValue(sheetName, 50, 16, 99d),
						new ExpectedCellValue(sheetName, 51, 16, 99d),
						new ExpectedCellValue(sheetName, 52, 16, null),
						new ExpectedCellValue(sheetName, 53, 16, 1d),
						new ExpectedCellValue(sheetName, 54, 16, 1d),
						new ExpectedCellValue(sheetName, 55, 16, 1d),
						new ExpectedCellValue(sheetName, 56, 16, null),
						new ExpectedCellValue(sheetName, 57, 16, 99d),
						new ExpectedCellValue(sheetName, 58, 16, 99d),
						new ExpectedCellValue(sheetName, 59, 16, 99d),
						new ExpectedCellValue(sheetName, 60, 16, 99d),
						new ExpectedCellValue(sheetName, 61, 16, 1d),
						new ExpectedCellValue(sheetName, 62, 16, 99d),
						new ExpectedCellValue(sheetName, 63, 16, 99d),
						new ExpectedCellValue(sheetName, 64, 16, 1d),
						new ExpectedCellValue(sheetName, 65, 16, 99d),
						new ExpectedCellValue(sheetName, 66, 16, 99d),
						new ExpectedCellValue(sheetName, 67, 16, 1d),
						new ExpectedCellValue(sheetName, 68, 16, 99d),
						new ExpectedCellValue(sheetName, 69, 16, null),
						new ExpectedCellValue(sheetName, 70, 16, null),
						new ExpectedCellValue(sheetName, 71, 16, null),
						new ExpectedCellValue(sheetName, 72, 16, null),
						new ExpectedCellValue(sheetName, 73, 16, null),
						new ExpectedCellValue(sheetName, 74, 16, null),
						new ExpectedCellValue(sheetName, 75, 16, null),
						new ExpectedCellValue(sheetName, 76, 16, null),
						new ExpectedCellValue(sheetName, 77, 16, null),
						new ExpectedCellValue(sheetName, 78, 16, null),
						new ExpectedCellValue(sheetName, 79, 16, null),
						new ExpectedCellValue(sheetName, 80, 16, null),
						new ExpectedCellValue(sheetName, 81, 16, null),
						new ExpectedCellValue(sheetName, 82, 16, null),
						new ExpectedCellValue(sheetName, 83, 16, null),
						new ExpectedCellValue(sheetName, 84, 16, null),
						new ExpectedCellValue(sheetName, 85, 16, null),
						new ExpectedCellValue(sheetName, 86, 16, null),
						new ExpectedCellValue(sheetName, 87, 16, null),
						new ExpectedCellValue(sheetName, 88, 16, null),
						new ExpectedCellValue(sheetName, 89, 16, null),
						new ExpectedCellValue(sheetName, 90, 16, null),
						new ExpectedCellValue(sheetName, 91, 16, null),
						new ExpectedCellValue(sheetName, 92, 16, null),
						new ExpectedCellValue(sheetName, 93, 16, null),
						new ExpectedCellValue(sheetName, 94, 16, null),
						new ExpectedCellValue(sheetName, 95, 16, null),
						new ExpectedCellValue(sheetName, 96, 16, null),
						new ExpectedCellValue(sheetName, 97, 16, null),
						new ExpectedCellValue(sheetName, 98, 16, null),
						new ExpectedCellValue(sheetName, 99, 16, null),
						new ExpectedCellValue(sheetName, 100, 16, null),
						new ExpectedCellValue(sheetName, 101, 16, null),
						new ExpectedCellValue(sheetName, 102, 16, null),
						new ExpectedCellValue(sheetName, 103, 16, null),
						new ExpectedCellValue(sheetName, 104, 16, null),
						new ExpectedCellValue(sheetName, 105, 16, null),
						new ExpectedCellValue(sheetName, 106, 16, null),
						new ExpectedCellValue(sheetName, 107, 16, null),
						new ExpectedCellValue(sheetName, 108, 16, null),
						new ExpectedCellValue(sheetName, 109, 16, null),
						new ExpectedCellValue(sheetName, 110, 16, null),
						new ExpectedCellValue(sheetName, 111, 16, null),
						new ExpectedCellValue(sheetName, 112, 16, null),
						new ExpectedCellValue(sheetName, 113, 16, null),
						new ExpectedCellValue(sheetName, 114, 16, null),
						new ExpectedCellValue(sheetName, 115, 16, null),
						new ExpectedCellValue(sheetName, 116, 16, null),
						new ExpectedCellValue(sheetName, 117, 16, null),
						new ExpectedCellValue(sheetName, 118, 16, null),
						new ExpectedCellValue(sheetName, 119, 16, null),
						new ExpectedCellValue(sheetName, 120, 16, null),
						new ExpectedCellValue(sheetName, 121, 16, null),
						new ExpectedCellValue(sheetName, 122, 16, null),
						new ExpectedCellValue(sheetName, 123, 16, null),
						new ExpectedCellValue(sheetName, 124, 16, null),
						new ExpectedCellValue(sheetName, 125, 16, null),
						new ExpectedCellValue(sheetName, 126, 16, null),
						new ExpectedCellValue(sheetName, 127, 16, null),
						new ExpectedCellValue(sheetName, 128, 16, null),
						new ExpectedCellValue(sheetName, 129, 16, null),
						new ExpectedCellValue(sheetName, 130, 16, null),
						new ExpectedCellValue(sheetName, 131, 16, null),
						new ExpectedCellValue(sheetName, 132, 16, null),
						new ExpectedCellValue(sheetName, 133, 16, null),
						new ExpectedCellValue(sheetName, 134, 16, null),
						new ExpectedCellValue(sheetName, 135, 16, null),
						new ExpectedCellValue(sheetName, 136, 16, null),
						new ExpectedCellValue(sheetName, 137, 16, null),
						new ExpectedCellValue(sheetName, 138, 16, null),
						new ExpectedCellValue(sheetName, 139, 16, null),
						new ExpectedCellValue(sheetName, 140, 16, null),
						new ExpectedCellValue(sheetName, 141, 16, null),
						new ExpectedCellValue(sheetName, 142, 16, null),
						new ExpectedCellValue(sheetName, 143, 16, null),
						new ExpectedCellValue(sheetName, 144, 16, null),
						new ExpectedCellValue(sheetName, 145, 16, null),
						new ExpectedCellValue(sheetName, 146, 16, null),
						new ExpectedCellValue(sheetName, 147, 16, null),
						new ExpectedCellValue(sheetName, 148, 16, null),
						new ExpectedCellValue(sheetName, 149, 16, 99d),
						new ExpectedCellValue(sheetName, 150, 16, 1d),
						new ExpectedCellValue(sheetName, 151, 16, 99d),
						new ExpectedCellValue(sheetName, 2, 17, "San Francisco Total"),
						new ExpectedCellValue(sheetName, 3, 17, null),
						new ExpectedCellValue(sheetName, 4, 17, null),
						new ExpectedCellValue(sheetName, 5, 17, null),
						new ExpectedCellValue(sheetName, 6, 17, null),
						new ExpectedCellValue(sheetName, 7, 17, null),
						new ExpectedCellValue(sheetName, 8, 17, null),
						new ExpectedCellValue(sheetName, 9, 17, null),
						new ExpectedCellValue(sheetName, 10, 17, null),
						new ExpectedCellValue(sheetName, 11, 17, null),
						new ExpectedCellValue(sheetName, 12, 17, null),
						new ExpectedCellValue(sheetName, 13, 17, null),
						new ExpectedCellValue(sheetName, 14, 17, null),
						new ExpectedCellValue(sheetName, 15, 17, null),
						new ExpectedCellValue(sheetName, 16, 17, null),
						new ExpectedCellValue(sheetName, 17, 17, null),
						new ExpectedCellValue(sheetName, 18, 17, null),
						new ExpectedCellValue(sheetName, 19, 17, null),
						new ExpectedCellValue(sheetName, 20, 17, null),
						new ExpectedCellValue(sheetName, 21, 17, null),
						new ExpectedCellValue(sheetName, 22, 17, null),
						new ExpectedCellValue(sheetName, 23, 17, null),
						new ExpectedCellValue(sheetName, 24, 17, null),
						new ExpectedCellValue(sheetName, 25, 17, null),
						new ExpectedCellValue(sheetName, 26, 17, null),
						new ExpectedCellValue(sheetName, 27, 17, null),
						new ExpectedCellValue(sheetName, 28, 17, null),
						new ExpectedCellValue(sheetName, 29, 17, null),
						new ExpectedCellValue(sheetName, 30, 17, null),
						new ExpectedCellValue(sheetName, 31, 17, null),
						new ExpectedCellValue(sheetName, 32, 17, null),
						new ExpectedCellValue(sheetName, 33, 17, null),
						new ExpectedCellValue(sheetName, 34, 17, null),
						new ExpectedCellValue(sheetName, 35, 17, null),
						new ExpectedCellValue(sheetName, 36, 17, null),
						new ExpectedCellValue(sheetName, 37, 17, null),
						new ExpectedCellValue(sheetName, 38, 17, null),
						new ExpectedCellValue(sheetName, 39, 17, null),
						new ExpectedCellValue(sheetName, 40, 17, null),
						new ExpectedCellValue(sheetName, 41, 17, null),
						new ExpectedCellValue(sheetName, 42, 17, null),
						new ExpectedCellValue(sheetName, 43, 17, null),
						new ExpectedCellValue(sheetName, 44, 17, null),
						new ExpectedCellValue(sheetName, 45, 17, null),
						new ExpectedCellValue(sheetName, 46, 17, null),
						new ExpectedCellValue(sheetName, 47, 17, null),
						new ExpectedCellValue(sheetName, 48, 17, null),
						new ExpectedCellValue(sheetName, 49, 17, 99d),
						new ExpectedCellValue(sheetName, 50, 17, 99d),
						new ExpectedCellValue(sheetName, 51, 17, 99d),
						new ExpectedCellValue(sheetName, 52, 17, null),
						new ExpectedCellValue(sheetName, 53, 17, 1d),
						new ExpectedCellValue(sheetName, 54, 17, 1d),
						new ExpectedCellValue(sheetName, 55, 17, 1d),
						new ExpectedCellValue(sheetName, 56, 17, null),
						new ExpectedCellValue(sheetName, 57, 17, 99d),
						new ExpectedCellValue(sheetName, 58, 17, 99d),
						new ExpectedCellValue(sheetName, 59, 17, 99d),
						new ExpectedCellValue(sheetName, 60, 17, 99d),
						new ExpectedCellValue(sheetName, 61, 17, 1d),
						new ExpectedCellValue(sheetName, 62, 17, 99d),
						new ExpectedCellValue(sheetName, 63, 17, 99d),
						new ExpectedCellValue(sheetName, 64, 17, 1d),
						new ExpectedCellValue(sheetName, 65, 17, 99d),
						new ExpectedCellValue(sheetName, 66, 17, 99d),
						new ExpectedCellValue(sheetName, 67, 17, 1d),
						new ExpectedCellValue(sheetName, 68, 17, 99d),
						new ExpectedCellValue(sheetName, 69, 17, null),
						new ExpectedCellValue(sheetName, 70, 17, null),
						new ExpectedCellValue(sheetName, 71, 17, null),
						new ExpectedCellValue(sheetName, 72, 17, null),
						new ExpectedCellValue(sheetName, 73, 17, null),
						new ExpectedCellValue(sheetName, 74, 17, null),
						new ExpectedCellValue(sheetName, 75, 17, null),
						new ExpectedCellValue(sheetName, 76, 17, null),
						new ExpectedCellValue(sheetName, 77, 17, null),
						new ExpectedCellValue(sheetName, 78, 17, null),
						new ExpectedCellValue(sheetName, 79, 17, null),
						new ExpectedCellValue(sheetName, 80, 17, null),
						new ExpectedCellValue(sheetName, 81, 17, null),
						new ExpectedCellValue(sheetName, 82, 17, null),
						new ExpectedCellValue(sheetName, 83, 17, null),
						new ExpectedCellValue(sheetName, 84, 17, null),
						new ExpectedCellValue(sheetName, 85, 17, null),
						new ExpectedCellValue(sheetName, 86, 17, null),
						new ExpectedCellValue(sheetName, 87, 17, null),
						new ExpectedCellValue(sheetName, 88, 17, null),
						new ExpectedCellValue(sheetName, 89, 17, null),
						new ExpectedCellValue(sheetName, 90, 17, null),
						new ExpectedCellValue(sheetName, 91, 17, null),
						new ExpectedCellValue(sheetName, 92, 17, null),
						new ExpectedCellValue(sheetName, 93, 17, null),
						new ExpectedCellValue(sheetName, 94, 17, null),
						new ExpectedCellValue(sheetName, 95, 17, null),
						new ExpectedCellValue(sheetName, 96, 17, null),
						new ExpectedCellValue(sheetName, 97, 17, null),
						new ExpectedCellValue(sheetName, 98, 17, null),
						new ExpectedCellValue(sheetName, 99, 17, null),
						new ExpectedCellValue(sheetName, 100, 17, null),
						new ExpectedCellValue(sheetName, 101, 17, null),
						new ExpectedCellValue(sheetName, 102, 17, null),
						new ExpectedCellValue(sheetName, 103, 17, null),
						new ExpectedCellValue(sheetName, 104, 17, null),
						new ExpectedCellValue(sheetName, 105, 17, null),
						new ExpectedCellValue(sheetName, 106, 17, null),
						new ExpectedCellValue(sheetName, 107, 17, null),
						new ExpectedCellValue(sheetName, 108, 17, null),
						new ExpectedCellValue(sheetName, 109, 17, null),
						new ExpectedCellValue(sheetName, 110, 17, null),
						new ExpectedCellValue(sheetName, 111, 17, null),
						new ExpectedCellValue(sheetName, 112, 17, null),
						new ExpectedCellValue(sheetName, 113, 17, null),
						new ExpectedCellValue(sheetName, 114, 17, null),
						new ExpectedCellValue(sheetName, 115, 17, null),
						new ExpectedCellValue(sheetName, 116, 17, null),
						new ExpectedCellValue(sheetName, 117, 17, null),
						new ExpectedCellValue(sheetName, 118, 17, null),
						new ExpectedCellValue(sheetName, 119, 17, null),
						new ExpectedCellValue(sheetName, 120, 17, null),
						new ExpectedCellValue(sheetName, 121, 17, null),
						new ExpectedCellValue(sheetName, 122, 17, null),
						new ExpectedCellValue(sheetName, 123, 17, null),
						new ExpectedCellValue(sheetName, 124, 17, null),
						new ExpectedCellValue(sheetName, 125, 17, null),
						new ExpectedCellValue(sheetName, 126, 17, null),
						new ExpectedCellValue(sheetName, 127, 17, null),
						new ExpectedCellValue(sheetName, 128, 17, null),
						new ExpectedCellValue(sheetName, 129, 17, 415.75),
						new ExpectedCellValue(sheetName, 130, 17, 415.75),
						new ExpectedCellValue(sheetName, 131, 17, 415.75),
						new ExpectedCellValue(sheetName, 132, 17, null),
						new ExpectedCellValue(sheetName, 133, 17, 1d),
						new ExpectedCellValue(sheetName, 134, 17, 1d),
						new ExpectedCellValue(sheetName, 135, 17, 1d),
						new ExpectedCellValue(sheetName, 136, 17, null),
						new ExpectedCellValue(sheetName, 137, 17, 415.75),
						new ExpectedCellValue(sheetName, 138, 17, 415.75),
						new ExpectedCellValue(sheetName, 139, 17, 415.75),
						new ExpectedCellValue(sheetName, 140, 17, 415.75),
						new ExpectedCellValue(sheetName, 141, 17, 1d),
						new ExpectedCellValue(sheetName, 142, 17, 415.75),
						new ExpectedCellValue(sheetName, 143, 17, 415.75),
						new ExpectedCellValue(sheetName, 144, 17, 1d),
						new ExpectedCellValue(sheetName, 145, 17, 415.75),
						new ExpectedCellValue(sheetName, 146, 17, 415.75),
						new ExpectedCellValue(sheetName, 147, 17, 1d),
						new ExpectedCellValue(sheetName, 148, 17, 415.75),
						new ExpectedCellValue(sheetName, 149, 17, 514.75),
						new ExpectedCellValue(sheetName, 150, 17, 2d),
						new ExpectedCellValue(sheetName, 151, 17, 514.75),

						new ExpectedCellValue(sheetName, 2, 18, "Grand Total"),
						new ExpectedCellValue(sheetName, 3, 18, null),
						new ExpectedCellValue(sheetName, 4, 18, null),
						new ExpectedCellValue(sheetName, 5, 18, null),
						new ExpectedCellValue(sheetName, 6, 18, null),
						new ExpectedCellValue(sheetName, 7, 18, null),
						new ExpectedCellValue(sheetName, 8, 18, null),
						new ExpectedCellValue(sheetName, 9, 18, 415.75),
						new ExpectedCellValue(sheetName, 10, 18, 415.75),
						new ExpectedCellValue(sheetName, 11, 18, 415.75),
						new ExpectedCellValue(sheetName, 12, 18, null),
						new ExpectedCellValue(sheetName, 13, 18, 2d),
						new ExpectedCellValue(sheetName, 14, 18, 2d),
						new ExpectedCellValue(sheetName, 15, 18, 2d),
						new ExpectedCellValue(sheetName, 16, 18, null),
						new ExpectedCellValue(sheetName, 17, 18, 831.5),
						new ExpectedCellValue(sheetName, 18, 18, 831.5),
						new ExpectedCellValue(sheetName, 19, 18, 831.5),
						new ExpectedCellValue(sheetName, 20, 18, 415.75),
						new ExpectedCellValue(sheetName, 21, 18, 2d),
						new ExpectedCellValue(sheetName, 22, 18, 831.5),
						new ExpectedCellValue(sheetName, 23, 18, 415.75),
						new ExpectedCellValue(sheetName, 24, 18, 2d),
						new ExpectedCellValue(sheetName, 25, 18, 831.5),
						new ExpectedCellValue(sheetName, 26, 18, 415.75),
						new ExpectedCellValue(sheetName, 27, 18, 2d),
						new ExpectedCellValue(sheetName, 28, 18, 831.5),
						new ExpectedCellValue(sheetName, 29, 18, null),
						new ExpectedCellValue(sheetName, 30, 18, null),
						new ExpectedCellValue(sheetName, 31, 18, null),
						new ExpectedCellValue(sheetName, 32, 18, null),
						new ExpectedCellValue(sheetName, 33, 18, 415.75),
						new ExpectedCellValue(sheetName, 34, 18, 415.75),
						new ExpectedCellValue(sheetName, 35, 18, 415.75),
						new ExpectedCellValue(sheetName, 36, 18, null),
						new ExpectedCellValue(sheetName, 37, 18, 2d),
						new ExpectedCellValue(sheetName, 38, 18, 2d),
						new ExpectedCellValue(sheetName, 39, 18, 2d),
						new ExpectedCellValue(sheetName, 40, 18, null),
						new ExpectedCellValue(sheetName, 41, 18, 831.5),
						new ExpectedCellValue(sheetName, 42, 18, 831.5),
						new ExpectedCellValue(sheetName, 43, 18, 831.5),
						new ExpectedCellValue(sheetName, 44, 18, 415.75),
						new ExpectedCellValue(sheetName, 45, 18, 2d),
						new ExpectedCellValue(sheetName, 46, 18, 831.5),
						new ExpectedCellValue(sheetName, 47, 18, null),
						new ExpectedCellValue(sheetName, 48, 18, null),
						new ExpectedCellValue(sheetName, 49, 18, 99d),
						new ExpectedCellValue(sheetName, 50, 18, 99d),
						new ExpectedCellValue(sheetName, 51, 18, 99d),
						new ExpectedCellValue(sheetName, 52, 18, null),
						new ExpectedCellValue(sheetName, 53, 18, 1d),
						new ExpectedCellValue(sheetName, 54, 18, 1d),
						new ExpectedCellValue(sheetName, 55, 18, 1d),
						new ExpectedCellValue(sheetName, 56, 18, null),
						new ExpectedCellValue(sheetName, 57, 18, 99d),
						new ExpectedCellValue(sheetName, 58, 18, 99d),
						new ExpectedCellValue(sheetName, 59, 18, 99d),
						new ExpectedCellValue(sheetName, 60, 18, 99d),
						new ExpectedCellValue(sheetName, 61, 18, 1d),
						new ExpectedCellValue(sheetName, 62, 18, 99d),
						new ExpectedCellValue(sheetName, 63, 18, 514.75),
						new ExpectedCellValue(sheetName, 64, 18, 3d),
						new ExpectedCellValue(sheetName, 65, 18, 930.5),
						new ExpectedCellValue(sheetName, 66, 18, 514.75),
						new ExpectedCellValue(sheetName, 67, 18, 3d),
						new ExpectedCellValue(sheetName, 68, 18, 930.5),
						new ExpectedCellValue(sheetName, 69, 18, null),
						new ExpectedCellValue(sheetName, 70, 18, null),
						new ExpectedCellValue(sheetName, 71, 18, null),
						new ExpectedCellValue(sheetName, 72, 18, null),
						new ExpectedCellValue(sheetName, 73, 18, 415.75),
						new ExpectedCellValue(sheetName, 74, 18, 415.75),
						new ExpectedCellValue(sheetName, 75, 18, 415.75),
						new ExpectedCellValue(sheetName, 76, 18, null),
						new ExpectedCellValue(sheetName, 77, 18, 2d),
						new ExpectedCellValue(sheetName, 78, 18, 2d),
						new ExpectedCellValue(sheetName, 79, 18, 2d),
						new ExpectedCellValue(sheetName, 80, 18, null),
						new ExpectedCellValue(sheetName, 81, 18, 831.5),
						new ExpectedCellValue(sheetName, 82, 18, 831.5),
						new ExpectedCellValue(sheetName, 83, 18, 831.5),
						new ExpectedCellValue(sheetName, 84, 18, 415.75),
						new ExpectedCellValue(sheetName, 85, 18, 2d),
						new ExpectedCellValue(sheetName, 86, 18, 831.5),
						new ExpectedCellValue(sheetName, 87, 18, null),
						new ExpectedCellValue(sheetName, 88, 18, null),
						new ExpectedCellValue(sheetName, 89, 18, 24.99),
						new ExpectedCellValue(sheetName, 90, 18, 24.99),
						new ExpectedCellValue(sheetName, 91, 18, 24.99),
						new ExpectedCellValue(sheetName, 92, 18, null),
						new ExpectedCellValue(sheetName, 93, 18, 1d),
						new ExpectedCellValue(sheetName, 94, 18, 1d),
						new ExpectedCellValue(sheetName, 95, 18, 1d),
						new ExpectedCellValue(sheetName, 96, 18, null),
						new ExpectedCellValue(sheetName, 97, 18, 24.99),
						new ExpectedCellValue(sheetName, 98, 18, 24.99),
						new ExpectedCellValue(sheetName, 99, 18, 24.99),
						new ExpectedCellValue(sheetName, 100, 18, 24.99),
						new ExpectedCellValue(sheetName, 101, 18, 1d),
						new ExpectedCellValue(sheetName, 102, 18, 24.99),
						new ExpectedCellValue(sheetName, 103, 18, 440.74),
						new ExpectedCellValue(sheetName, 104, 18, 3d),
						new ExpectedCellValue(sheetName, 105, 18, 856.49),
						new ExpectedCellValue(sheetName, 106, 18, null),
						new ExpectedCellValue(sheetName, 107, 18, null),
						new ExpectedCellValue(sheetName, 108, 18, null),
						new ExpectedCellValue(sheetName, 109, 18, 199d),
						new ExpectedCellValue(sheetName, 110, 18, 199d),
						new ExpectedCellValue(sheetName, 111, 18, 199d),
						new ExpectedCellValue(sheetName, 112, 18, null),
						new ExpectedCellValue(sheetName, 113, 18, 6d),
						new ExpectedCellValue(sheetName, 114, 18, 6d),
						new ExpectedCellValue(sheetName, 115, 18, 6d),
						new ExpectedCellValue(sheetName, 116, 18, null),
						new ExpectedCellValue(sheetName, 117, 18, 1194d),
						new ExpectedCellValue(sheetName, 118, 18, 1194d),
						new ExpectedCellValue(sheetName, 119, 18, 1194d),
						new ExpectedCellValue(sheetName, 120, 18, 199d),
						new ExpectedCellValue(sheetName, 121, 18, 6d),
						new ExpectedCellValue(sheetName, 122, 18, 1194d),
						new ExpectedCellValue(sheetName, 123, 18, 199d),
						new ExpectedCellValue(sheetName, 124, 18, 6d),
						new ExpectedCellValue(sheetName, 125, 18, 1194d),
						new ExpectedCellValue(sheetName, 126, 18, null),
						new ExpectedCellValue(sheetName, 127, 18, null),
						new ExpectedCellValue(sheetName, 128, 18, null),
						new ExpectedCellValue(sheetName, 129, 18, 415.75),
						new ExpectedCellValue(sheetName, 130, 18, 415.75),
						new ExpectedCellValue(sheetName, 131, 18, 415.75),
						new ExpectedCellValue(sheetName, 132, 18, null),
						new ExpectedCellValue(sheetName, 133, 18, 1d),
						new ExpectedCellValue(sheetName, 134, 18, 1d),
						new ExpectedCellValue(sheetName, 135, 18, 1d),
						new ExpectedCellValue(sheetName, 136, 18, null),
						new ExpectedCellValue(sheetName, 137, 18, 415.75),
						new ExpectedCellValue(sheetName, 138, 18, 415.75),
						new ExpectedCellValue(sheetName, 139, 18, 415.75),
						new ExpectedCellValue(sheetName, 140, 18, 415.75),
						new ExpectedCellValue(sheetName, 141, 18, 1d),
						new ExpectedCellValue(sheetName, 142, 18, 415.75),
						new ExpectedCellValue(sheetName, 143, 18, 415.75),
						new ExpectedCellValue(sheetName, 144, 18, 1d),
						new ExpectedCellValue(sheetName, 145, 18, 415.75),
						new ExpectedCellValue(sheetName, 146, 18, 1055.49),
						new ExpectedCellValue(sheetName, 147, 18, 10d),
						new ExpectedCellValue(sheetName, 148, 18, 2466.24),
						new ExpectedCellValue(sheetName, 149, 18, 1985.99),
						new ExpectedCellValue(sheetName, 150, 18, 15d),
						new ExpectedCellValue(sheetName, 151, 18, 4228.24),
				});
			}
		}
		#endregion

		#region Custom Grouping Tests
		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomGrouping.xlsx")]
		public void PivotTableRefreshOneCustomGroupingFieldOnlyNoColumnFields()
		{
			var file = new FileInfo("PivotTableCustomGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ItemCustomGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A1:B8"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ItemCustomGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 2, 1, "Group1"),
					new ExpectedCellValue(sheetName, 3, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 4, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 5, 1, "Group2"),
					new ExpectedCellValue(sheetName, 6, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 7, 1, "Tent"),
					new ExpectedCellValue(sheetName, 8, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 1, 2, "Sum of Total"),
					new ExpectedCellValue(sheetName, 2, 2, 2935.24),
					new ExpectedCellValue(sheetName, 3, 2, 2910.25),
					new ExpectedCellValue(sheetName, 4, 2, 24.99),
					new ExpectedCellValue(sheetName, 5, 2, 1293d),
					new ExpectedCellValue(sheetName, 6, 2, 99d),
					new ExpectedCellValue(sheetName, 7, 2, 1194d),
					new ExpectedCellValue(sheetName, 8, 2, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomGrouping.xlsx")]
		public void PivotTableRefreshTwoCustomGroupingFieldsOnly()
		{
			var file = new FileInfo("PivotTableCustomGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ItemCustomGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable2"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("E1:H13"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(2, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ItemCustomGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 3, 5, "Group1"),
					new ExpectedCellValue(sheetName, 4, 5, 20100007),
					new ExpectedCellValue(sheetName, 5, 5, 20100017),
					new ExpectedCellValue(sheetName, 6, 5, 20100070),
					new ExpectedCellValue(sheetName, 7, 5, "Group2"),
					new ExpectedCellValue(sheetName, 8, 5, 20100076),
					new ExpectedCellValue(sheetName, 9, 5, 20100083),
					new ExpectedCellValue(sheetName, 10, 5, 20100085),
					new ExpectedCellValue(sheetName, 11, 5, 20100090),
					new ExpectedCellValue(sheetName, 12, 5, 20100090),
					new ExpectedCellValue(sheetName, 13, 5, "Grand Total"),
					new ExpectedCellValue(sheetName, 2, 6, "Group1"),
					new ExpectedCellValue(sheetName, 3, 6, 4d),
					new ExpectedCellValue(sheetName, 4, 6, 2d),
					new ExpectedCellValue(sheetName, 5, 6, 2d),
					new ExpectedCellValue(sheetName, 6, 6, null),
					new ExpectedCellValue(sheetName, 7, 6, 2d),
					new ExpectedCellValue(sheetName, 8, 6, 1d),
					new ExpectedCellValue(sheetName, 9, 6, 1d),
					new ExpectedCellValue(sheetName, 10, 6, null),
					new ExpectedCellValue(sheetName, 11, 6, 2d),
					new ExpectedCellValue(sheetName, 12, 6, 2d),
					new ExpectedCellValue(sheetName, 13, 6, 8d),
					new ExpectedCellValue(sheetName, 2, 7, "Group2"),
					new ExpectedCellValue(sheetName, 3, 7, 6d),
					new ExpectedCellValue(sheetName, 4, 7, null),
					new ExpectedCellValue(sheetName, 5, 7, null),
					new ExpectedCellValue(sheetName, 6, 7, 6d),
					new ExpectedCellValue(sheetName, 7, 7, 1d),
					new ExpectedCellValue(sheetName, 8, 7, null),
					new ExpectedCellValue(sheetName, 9, 7, null),
					new ExpectedCellValue(sheetName, 10, 7, 1d),
					new ExpectedCellValue(sheetName, 11, 7, null),
					new ExpectedCellValue(sheetName, 12, 7, null),
					new ExpectedCellValue(sheetName, 13, 7, 7d),
					new ExpectedCellValue(sheetName, 2, 8, "Grand Total"),
					new ExpectedCellValue(sheetName, 3, 8, 10d),
					new ExpectedCellValue(sheetName, 4, 8, 2d),
					new ExpectedCellValue(sheetName, 5, 8, 2d),
					new ExpectedCellValue(sheetName, 6, 8, 6d),
					new ExpectedCellValue(sheetName, 7, 8, 3d),
					new ExpectedCellValue(sheetName, 8, 8, 1d),
					new ExpectedCellValue(sheetName, 9, 8, 1d),
					new ExpectedCellValue(sheetName, 10, 8, 1d),
					new ExpectedCellValue(sheetName, 11, 8, 2d),
					new ExpectedCellValue(sheetName, 12, 8, 2d),
					new ExpectedCellValue(sheetName, 13, 8, 15d),
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomGrouping.xlsx")]
		public void PivotTableRefreshTwoCustomGroupingFieldsAndMultipleColumnDataFields()
		{
			var file = new FileInfo("PivotTableCustomGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ItemCustomGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable3"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A18:G36"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(2, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ItemCustomGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 21, 1, "Chicago"),
					new ExpectedCellValue(sheetName, 22, 1, "Group1"),
					new ExpectedCellValue(sheetName, 23, 1, "January"),
					new ExpectedCellValue(sheetName, 24, 1, "Group2"),
					new ExpectedCellValue(sheetName, 25, 1, "March"),
					new ExpectedCellValue(sheetName, 26, 1, "Nashville"),
					new ExpectedCellValue(sheetName, 27, 1, 20100090),
					new ExpectedCellValue(sheetName, 28, 1, "January"),
					new ExpectedCellValue(sheetName, 29, 1, "Group1"),
					new ExpectedCellValue(sheetName, 30, 1, "February"),
					new ExpectedCellValue(sheetName, 31, 1, "March"),
					new ExpectedCellValue(sheetName, 32, 1, "San Francisco"),
					new ExpectedCellValue(sheetName, 33, 1, "Group2"),
					new ExpectedCellValue(sheetName, 34, 1, "January"),
					new ExpectedCellValue(sheetName, 35, 1, "February"),
					new ExpectedCellValue(sheetName, 36, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 19, 2, "Group1"),
					new ExpectedCellValue(sheetName, 20, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 2, 3d),
					new ExpectedCellValue(sheetName, 22, 2, null),
					new ExpectedCellValue(sheetName, 23, 2, 2d),
					new ExpectedCellValue(sheetName, 24, 2, null),
					new ExpectedCellValue(sheetName, 25, 2, 1d),
					new ExpectedCellValue(sheetName, 26, 2, 4d),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, 2d),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, 2d),
					new ExpectedCellValue(sheetName, 32, 2, 1d),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, 1d),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, 8d),
					new ExpectedCellValue(sheetName, 19, 3, null),
					new ExpectedCellValue(sheetName, 20, 3, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 3, 856.49),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, 831.5),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, 24.99),
					new ExpectedCellValue(sheetName, 26, 3, 1663d),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, 831.5),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, null),
					new ExpectedCellValue(sheetName, 31, 3, 831.5),
					new ExpectedCellValue(sheetName, 32, 3, 415.75),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, 415.75),
					new ExpectedCellValue(sheetName, 35, 3, null),
					new ExpectedCellValue(sheetName, 36, 3, 2935.24),
					new ExpectedCellValue(sheetName, 19, 4, "Group2"),
					new ExpectedCellValue(sheetName, 20, 4, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 21, 4, null),
					new ExpectedCellValue(sheetName, 22, 4, null),
					new ExpectedCellValue(sheetName, 23, 4, null),
					new ExpectedCellValue(sheetName, 24, 4, null),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, 6d),
					new ExpectedCellValue(sheetName, 27, 4, null),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, 6d),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, 1d),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, 1d),
					new ExpectedCellValue(sheetName, 36, 4, 7d),
					new ExpectedCellValue(sheetName, 19, 5, null),
					new ExpectedCellValue(sheetName, 20, 5, "Sum of Total"),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, 1194d),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, 1194d),
					new ExpectedCellValue(sheetName, 31, 5, null),
					new ExpectedCellValue(sheetName, 32, 5, 99d),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, 99d),
					new ExpectedCellValue(sheetName, 36, 5, 1293d),
					new ExpectedCellValue(sheetName, 19, 6, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 20, 6, null),
					new ExpectedCellValue(sheetName, 21, 6, 3d),
					new ExpectedCellValue(sheetName, 22, 6, null),
					new ExpectedCellValue(sheetName, 23, 6, 2d),
					new ExpectedCellValue(sheetName, 24, 6, null),
					new ExpectedCellValue(sheetName, 25, 6, 1d),
					new ExpectedCellValue(sheetName, 26, 6, 10d),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, 2d),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, 6d),
					new ExpectedCellValue(sheetName, 31, 6, 2d),
					new ExpectedCellValue(sheetName, 32, 6, 2d),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, 1d),
					new ExpectedCellValue(sheetName, 35, 6, 1d),
					new ExpectedCellValue(sheetName, 36, 6, 15d),
					new ExpectedCellValue(sheetName, 19, 7, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 20, 7, null),
					new ExpectedCellValue(sheetName, 21, 7, 856.49),
					new ExpectedCellValue(sheetName, 22, 7, null),
					new ExpectedCellValue(sheetName, 23, 7, 831.5),
					new ExpectedCellValue(sheetName, 24, 7, null),
					new ExpectedCellValue(sheetName, 25, 7, 24.99),
					new ExpectedCellValue(sheetName, 26, 7, 2857d),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, 831.5),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, 1194d),
					new ExpectedCellValue(sheetName, 31, 7, 831.5),
					new ExpectedCellValue(sheetName, 32, 7, 514.75),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, 415.75),
					new ExpectedCellValue(sheetName, 35, 7, 99d),
					new ExpectedCellValue(sheetName, 36, 7, 4228.24)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableCustomGrouping.xlsx")]
		public void PivotTableRefreshTwoCustomGroupingFieldsAndMultipleRowDataFields()
		{
			var file = new FileInfo("PivotTableCustomGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets["ItemCustomGrouping"];
					var pivotTable = worksheet.PivotTables["PivotTable4"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A41:L67"), pivotTable.Address);
					Assert.AreEqual(9, pivotTable.Fields.Count);
					Assert.AreEqual(8, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(2, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[8].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "ItemCustomGrouping";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 45, 1, 20100090),
					new ExpectedCellValue(sheetName, 46, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 47, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 48, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 49, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 50, 1, "Group1"),
					new ExpectedCellValue(sheetName, 51, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 52, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 53, 1, "Tent"),
					new ExpectedCellValue(sheetName, 54, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 55, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 56, 1, "Tent"),
					new ExpectedCellValue(sheetName, 57, 1, "Group2"),
					new ExpectedCellValue(sheetName, 58, 1, "Sum of Total"),
					new ExpectedCellValue(sheetName, 59, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 60, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 61, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 62, 1, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 63, 1, "Car Rack"),
					new ExpectedCellValue(sheetName, 64, 1, "Headlamp"),
					new ExpectedCellValue(sheetName, 65, 1, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 66, 1, "Total Sum of Total"),
					new ExpectedCellValue(sheetName, 67, 1, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 42, 2, "January"),
					new ExpectedCellValue(sheetName, 43, 2, "Group1"),
					new ExpectedCellValue(sheetName, 44, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, null),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, null),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, 831.5),
					new ExpectedCellValue(sheetName, 53, 2, null),
					new ExpectedCellValue(sheetName, 54, 2, null),
					new ExpectedCellValue(sheetName, 55, 2, 2d),
					new ExpectedCellValue(sheetName, 56, 2, null),
					new ExpectedCellValue(sheetName, 57, 2, null),
					new ExpectedCellValue(sheetName, 58, 2, null),
					new ExpectedCellValue(sheetName, 59, 2, null),
					new ExpectedCellValue(sheetName, 60, 2, null),
					new ExpectedCellValue(sheetName, 61, 2, null),
					new ExpectedCellValue(sheetName, 62, 2, null),
					new ExpectedCellValue(sheetName, 63, 2, null),
					new ExpectedCellValue(sheetName, 64, 2, null),
					new ExpectedCellValue(sheetName, 65, 2, null),
					new ExpectedCellValue(sheetName, 66, 2, 831.5),
					new ExpectedCellValue(sheetName, 67, 2, 2d),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, "Nashville"),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, 831.5),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, 2d),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, null),
					new ExpectedCellValue(sheetName, 54, 3, null),
					new ExpectedCellValue(sheetName, 55, 3, null),
					new ExpectedCellValue(sheetName, 56, 3, null),
					new ExpectedCellValue(sheetName, 57, 3, null),
					new ExpectedCellValue(sheetName, 58, 3, null),
					new ExpectedCellValue(sheetName, 59, 3, null),
					new ExpectedCellValue(sheetName, 60, 3, null),
					new ExpectedCellValue(sheetName, 61, 3, null),
					new ExpectedCellValue(sheetName, 62, 3, null),
					new ExpectedCellValue(sheetName, 63, 3, null),
					new ExpectedCellValue(sheetName, 64, 3, null),
					new ExpectedCellValue(sheetName, 65, 3, null),
					new ExpectedCellValue(sheetName, 66, 3, 831.5),
					new ExpectedCellValue(sheetName, 67, 3, 2d),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, "San Francisco"),
					new ExpectedCellValue(sheetName, 45, 4, null),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, null),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, null),
					new ExpectedCellValue(sheetName, 54, 4, null),
					new ExpectedCellValue(sheetName, 55, 4, null),
					new ExpectedCellValue(sheetName, 56, 4, null),
					new ExpectedCellValue(sheetName, 57, 4, null),
					new ExpectedCellValue(sheetName, 58, 4, null),
					new ExpectedCellValue(sheetName, 59, 4, 415.75),
					new ExpectedCellValue(sheetName, 60, 4, null),
					new ExpectedCellValue(sheetName, 61, 4, null),
					new ExpectedCellValue(sheetName, 62, 4, null),
					new ExpectedCellValue(sheetName, 63, 4, 1d),
					new ExpectedCellValue(sheetName, 64, 4, null),
					new ExpectedCellValue(sheetName, 65, 4, null),
					new ExpectedCellValue(sheetName, 66, 4, 415.75),
					new ExpectedCellValue(sheetName, 67, 4, 1d),
					new ExpectedCellValue(sheetName, 42, 5, "January Total"),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, 831.5),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, 2d),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, 831.5),
					new ExpectedCellValue(sheetName, 53, 5, null),
					new ExpectedCellValue(sheetName, 54, 5, null),
					new ExpectedCellValue(sheetName, 55, 5, 2d),
					new ExpectedCellValue(sheetName, 56, 5, null),
					new ExpectedCellValue(sheetName, 57, 5, null),
					new ExpectedCellValue(sheetName, 58, 5, null),
					new ExpectedCellValue(sheetName, 59, 5, 415.75),
					new ExpectedCellValue(sheetName, 60, 5, null),
					new ExpectedCellValue(sheetName, 61, 5, null),
					new ExpectedCellValue(sheetName, 62, 5, null),
					new ExpectedCellValue(sheetName, 63, 5, 1d),
					new ExpectedCellValue(sheetName, 64, 5, null),
					new ExpectedCellValue(sheetName, 65, 5, null),
					new ExpectedCellValue(sheetName, 66, 5, 2078.75),
					new ExpectedCellValue(sheetName, 67, 5, 5d),
					new ExpectedCellValue(sheetName, 42, 6, "February"),
					new ExpectedCellValue(sheetName, 43, 6, "Group2"),
					new ExpectedCellValue(sheetName, 44, 6, "Nashville"),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, null),
					new ExpectedCellValue(sheetName, 47, 6, null),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, null),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, 1194d),
					new ExpectedCellValue(sheetName, 54, 6, null),
					new ExpectedCellValue(sheetName, 55, 6, null),
					new ExpectedCellValue(sheetName, 56, 6, 6d),
					new ExpectedCellValue(sheetName, 57, 6, null),
					new ExpectedCellValue(sheetName, 58, 6, null),
					new ExpectedCellValue(sheetName, 59, 6, null),
					new ExpectedCellValue(sheetName, 60, 6, null),
					new ExpectedCellValue(sheetName, 61, 6, null),
					new ExpectedCellValue(sheetName, 62, 6, null),
					new ExpectedCellValue(sheetName, 63, 6, null),
					new ExpectedCellValue(sheetName, 64, 6, null),
					new ExpectedCellValue(sheetName, 65, 6, null),
					new ExpectedCellValue(sheetName, 66, 6, 1194d),
					new ExpectedCellValue(sheetName, 67, 6, 6d),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, "San Francisco"),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, null),
					new ExpectedCellValue(sheetName, 47, 7, null),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, null),
					new ExpectedCellValue(sheetName, 52, 7, null),
					new ExpectedCellValue(sheetName, 53, 7, null),
					new ExpectedCellValue(sheetName, 54, 7, null),
					new ExpectedCellValue(sheetName, 55, 7, null),
					new ExpectedCellValue(sheetName, 56, 7, null),
					new ExpectedCellValue(sheetName, 57, 7, null),
					new ExpectedCellValue(sheetName, 58, 7, null),
					new ExpectedCellValue(sheetName, 59, 7, null),
					new ExpectedCellValue(sheetName, 60, 7, null),
					new ExpectedCellValue(sheetName, 61, 7, 99d),
					new ExpectedCellValue(sheetName, 62, 7, null),
					new ExpectedCellValue(sheetName, 63, 7, null),
					new ExpectedCellValue(sheetName, 64, 7, null),
					new ExpectedCellValue(sheetName, 65, 7, 1d),
					new ExpectedCellValue(sheetName, 66, 7, 99d),
					new ExpectedCellValue(sheetName, 67, 7, 1d),
					new ExpectedCellValue(sheetName, 42, 8, "February Total"),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, 1194d),
					new ExpectedCellValue(sheetName, 54, 8, null),
					new ExpectedCellValue(sheetName, 55, 8, null),
					new ExpectedCellValue(sheetName, 56, 8, 6d),
					new ExpectedCellValue(sheetName, 57, 8, null),
					new ExpectedCellValue(sheetName, 58, 8, null),
					new ExpectedCellValue(sheetName, 59, 8, null),
					new ExpectedCellValue(sheetName, 60, 8, null),
					new ExpectedCellValue(sheetName, 61, 8, 99d),
					new ExpectedCellValue(sheetName, 62, 8, null),
					new ExpectedCellValue(sheetName, 63, 8, null),
					new ExpectedCellValue(sheetName, 64, 8, null),
					new ExpectedCellValue(sheetName, 65, 8, 1d),
					new ExpectedCellValue(sheetName, 66, 8, 1293d),
					new ExpectedCellValue(sheetName, 67, 8, 7d),
					new ExpectedCellValue(sheetName, 42, 9, "March"),
					new ExpectedCellValue(sheetName, 43, 9, "Group1"),
					new ExpectedCellValue(sheetName, 44, 9, "Chicago"),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, null),
					new ExpectedCellValue(sheetName, 49, 9, null),
					new ExpectedCellValue(sheetName, 50, 9, null),
					new ExpectedCellValue(sheetName, 51, 9, null),
					new ExpectedCellValue(sheetName, 52, 9, null),
					new ExpectedCellValue(sheetName, 53, 9, null),
					new ExpectedCellValue(sheetName, 54, 9, null),
					new ExpectedCellValue(sheetName, 55, 9, null),
					new ExpectedCellValue(sheetName, 56, 9, null),
					new ExpectedCellValue(sheetName, 57, 9, null),
					new ExpectedCellValue(sheetName, 58, 9, null),
					new ExpectedCellValue(sheetName, 59, 9, null),
					new ExpectedCellValue(sheetName, 60, 9, 24.99),
					new ExpectedCellValue(sheetName, 61, 9, null),
					new ExpectedCellValue(sheetName, 62, 9, null),
					new ExpectedCellValue(sheetName, 63, 9, null),
					new ExpectedCellValue(sheetName, 64, 9, 1d),
					new ExpectedCellValue(sheetName, 65, 9, null),
					new ExpectedCellValue(sheetName, 66, 9, 24.99),
					new ExpectedCellValue(sheetName, 67, 9, 1d),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, "Nashville"),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, 831.5),
					new ExpectedCellValue(sheetName, 53, 10, null),
					new ExpectedCellValue(sheetName, 54, 10, null),
					new ExpectedCellValue(sheetName, 55, 10, 2d),
					new ExpectedCellValue(sheetName, 56, 10, null),
					new ExpectedCellValue(sheetName, 57, 10, null),
					new ExpectedCellValue(sheetName, 58, 10, null),
					new ExpectedCellValue(sheetName, 59, 10, null),
					new ExpectedCellValue(sheetName, 60, 10, null),
					new ExpectedCellValue(sheetName, 61, 10, null),
					new ExpectedCellValue(sheetName, 62, 10, null),
					new ExpectedCellValue(sheetName, 63, 10, null),
					new ExpectedCellValue(sheetName, 64, 10, null),
					new ExpectedCellValue(sheetName, 65, 10, null),
					new ExpectedCellValue(sheetName, 66, 10, 831.5),
					new ExpectedCellValue(sheetName, 67, 10, 2d),
					new ExpectedCellValue(sheetName, 42, 11, "March Total"),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, null),
					new ExpectedCellValue(sheetName, 49, 11, null),
					new ExpectedCellValue(sheetName, 50, 11, null),
					new ExpectedCellValue(sheetName, 51, 11, null),
					new ExpectedCellValue(sheetName, 52, 11, 831.5),
					new ExpectedCellValue(sheetName, 53, 11, null),
					new ExpectedCellValue(sheetName, 54, 11, null),
					new ExpectedCellValue(sheetName, 55, 11, 2d),
					new ExpectedCellValue(sheetName, 56, 11, null),
					new ExpectedCellValue(sheetName, 57, 11, null),
					new ExpectedCellValue(sheetName, 58, 11, null),
					new ExpectedCellValue(sheetName, 59, 11, null),
					new ExpectedCellValue(sheetName, 60, 11, 24.99),
					new ExpectedCellValue(sheetName, 61, 11, null),
					new ExpectedCellValue(sheetName, 62, 11, null),
					new ExpectedCellValue(sheetName, 63, 11, null),
					new ExpectedCellValue(sheetName, 64, 11, 1d),
					new ExpectedCellValue(sheetName, 65, 11, null),
					new ExpectedCellValue(sheetName, 66, 11, 856.49),
					new ExpectedCellValue(sheetName, 67, 11, 3d),
					new ExpectedCellValue(sheetName, 42, 12, "Grand Total"),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, null),
					new ExpectedCellValue(sheetName, 47, 12, 831.5),
					new ExpectedCellValue(sheetName, 48, 12, null),
					new ExpectedCellValue(sheetName, 49, 12, 2d),
					new ExpectedCellValue(sheetName, 50, 12, null),
					new ExpectedCellValue(sheetName, 51, 12, null),
					new ExpectedCellValue(sheetName, 52, 12, 1663d),
					new ExpectedCellValue(sheetName, 53, 12, 1194d),
					new ExpectedCellValue(sheetName, 54, 12, null),
					new ExpectedCellValue(sheetName, 55, 12, 4d),
					new ExpectedCellValue(sheetName, 56, 12, 6d),
					new ExpectedCellValue(sheetName, 57, 12, null),
					new ExpectedCellValue(sheetName, 58, 12, null),
					new ExpectedCellValue(sheetName, 59, 12, 415.75),
					new ExpectedCellValue(sheetName, 60, 12, 24.99),
					new ExpectedCellValue(sheetName, 61, 12, 99d),
					new ExpectedCellValue(sheetName, 62, 12, null),
					new ExpectedCellValue(sheetName, 63, 12, 1d),
					new ExpectedCellValue(sheetName, 64, 12, 1d),
					new ExpectedCellValue(sheetName, 65, 12, 1d),
					new ExpectedCellValue(sheetName, 66, 12, 4228.24),
					new ExpectedCellValue(sheetName, 67, 12, 15d)
				});
			}
		}

		[TestMethod]
		[DeploymentItem(@"..\..\Workbooks\PivotTables\PivotTableDateAndCustomGrouping.xlsx")]
		public void PivotTableRefreshDateAndCustomFieldGrouping()
		{
			var file = new FileInfo("PivotTableDateAndCustomGrouping.xlsx");
			Assert.IsTrue(file.Exists);
			using (var newFile = new TempTestFile())
			{
				using (var package = new ExcelPackage(file))
				{
					var worksheet = package.Workbook.Worksheets.First();
					var pivotTable = worksheet.PivotTables["PivotTable1"];
					foreach (var cacheDefinition in package.Workbook.PivotCacheDefinitions)
					{
						cacheDefinition.UpdateData();
					}
					ExcelPivotTableTest.CheckPivotTableAddress(new ExcelAddress("A14:Y53"), pivotTable.Address);
					Assert.AreEqual(13, pivotTable.Fields.Count);
					Assert.AreEqual(0, pivotTable.Fields[0].Items.Count);
					Assert.AreEqual(4, pivotTable.Fields[1].Items.Count);
					Assert.AreEqual(27, pivotTable.Fields[2].Items.Count);
					Assert.AreEqual(5, pivotTable.Fields[3].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[4].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[5].Items.Count);
					Assert.AreEqual(0, pivotTable.Fields[6].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[7].Items.Count);
					Assert.AreEqual(369, pivotTable.Fields[8].Items.Count);
					Assert.AreEqual(15, pivotTable.Fields[9].Items.Count);
					Assert.AreEqual(7, pivotTable.Fields[10].Items.Count);
					Assert.AreEqual(6, pivotTable.Fields[11].Items.Count);
					Assert.AreEqual(3, pivotTable.Fields[12].Items.Count);
					package.SaveAs(newFile.File);
				}
				string sheetName = "Sheet1";
				TestHelperUtility.ValidateWorksheet(newFile.File, sheetName, new[]
				{
					new ExpectedCellValue(sheetName, 19, 1, "Group1"),
					new ExpectedCellValue(sheetName, 20, 1, 2016),
					new ExpectedCellValue(sheetName, 21, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 22, 1, "May"),
					new ExpectedCellValue(sheetName, 23, 1, "28-May"),
					new ExpectedCellValue(sheetName, 24, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 25, 1, 2017),
					new ExpectedCellValue(sheetName, 26, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 27, 1, "Oct"),
					new ExpectedCellValue(sheetName, 28, 1, "19-Oct"),
					new ExpectedCellValue(sheetName, 29, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 30, 1, 2018),
					new ExpectedCellValue(sheetName, 31, 1, "Qtr1"),
					new ExpectedCellValue(sheetName, 32, 1, "Feb"),
					new ExpectedCellValue(sheetName, 33, 1, "9-Feb"),
					new ExpectedCellValue(sheetName, 34, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 35, 1, "Mar"),
					new ExpectedCellValue(sheetName, 36, 1, "29-Mar"),
					new ExpectedCellValue(sheetName, 37, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 38, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 39, 1, "Nov"),
					new ExpectedCellValue(sheetName, 40, 1, "3-Nov"),
					new ExpectedCellValue(sheetName, 41, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 42, 1, "Group2"),
					new ExpectedCellValue(sheetName, 43, 1, 2017),
					new ExpectedCellValue(sheetName, 44, 1, "Qtr4"),
					new ExpectedCellValue(sheetName, 45, 1, "Dec"),
					new ExpectedCellValue(sheetName, 46, 1, "9-Dec"),
					new ExpectedCellValue(sheetName, 47, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 48, 1, 2018),
					new ExpectedCellValue(sheetName, 49, 1, "Qtr2"),
					new ExpectedCellValue(sheetName, 50, 1, "May"),
					new ExpectedCellValue(sheetName, 51, 1, "4-May"),
					new ExpectedCellValue(sheetName, 52, 1, "12 AM"),
					new ExpectedCellValue(sheetName, 53, 1, "Grand Total"),
					new ExpectedCellValue(sheetName, 15, 2, "Group1"),
					new ExpectedCellValue(sheetName, 16, 2, "Chicago"),
					new ExpectedCellValue(sheetName, 17, 2, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 2, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 2, 2d),
					new ExpectedCellValue(sheetName, 20, 2, 2d),
					new ExpectedCellValue(sheetName, 21, 2, 2d),
					new ExpectedCellValue(sheetName, 22, 2, 2d),
					new ExpectedCellValue(sheetName, 23, 2, 2d),
					new ExpectedCellValue(sheetName, 24, 2, 2d),
					new ExpectedCellValue(sheetName, 25, 2, null),
					new ExpectedCellValue(sheetName, 26, 2, null),
					new ExpectedCellValue(sheetName, 27, 2, null),
					new ExpectedCellValue(sheetName, 28, 2, null),
					new ExpectedCellValue(sheetName, 29, 2, null),
					new ExpectedCellValue(sheetName, 30, 2, null),
					new ExpectedCellValue(sheetName, 31, 2, null),
					new ExpectedCellValue(sheetName, 32, 2, null),
					new ExpectedCellValue(sheetName, 33, 2, null),
					new ExpectedCellValue(sheetName, 34, 2, null),
					new ExpectedCellValue(sheetName, 35, 2, null),
					new ExpectedCellValue(sheetName, 36, 2, null),
					new ExpectedCellValue(sheetName, 37, 2, null),
					new ExpectedCellValue(sheetName, 38, 2, null),
					new ExpectedCellValue(sheetName, 39, 2, null),
					new ExpectedCellValue(sheetName, 40, 2, null),
					new ExpectedCellValue(sheetName, 41, 2, null),
					new ExpectedCellValue(sheetName, 42, 2, null),
					new ExpectedCellValue(sheetName, 43, 2, null),
					new ExpectedCellValue(sheetName, 44, 2, null),
					new ExpectedCellValue(sheetName, 45, 2, null),
					new ExpectedCellValue(sheetName, 46, 2, null),
					new ExpectedCellValue(sheetName, 47, 2, null),
					new ExpectedCellValue(sheetName, 48, 2, null),
					new ExpectedCellValue(sheetName, 49, 2, null),
					new ExpectedCellValue(sheetName, 50, 2, null),
					new ExpectedCellValue(sheetName, 51, 2, null),
					new ExpectedCellValue(sheetName, 52, 2, null),
					new ExpectedCellValue(sheetName, 53, 2, 2d),
					new ExpectedCellValue(sheetName, 15, 3, null),
					new ExpectedCellValue(sheetName, 16, 3, null),
					new ExpectedCellValue(sheetName, 17, 3, null),
					new ExpectedCellValue(sheetName, 18, 3, "Headlamp"),
					new ExpectedCellValue(sheetName, 19, 3, 1d),
					new ExpectedCellValue(sheetName, 20, 3, null),
					new ExpectedCellValue(sheetName, 21, 3, null),
					new ExpectedCellValue(sheetName, 22, 3, null),
					new ExpectedCellValue(sheetName, 23, 3, null),
					new ExpectedCellValue(sheetName, 24, 3, null),
					new ExpectedCellValue(sheetName, 25, 3, null),
					new ExpectedCellValue(sheetName, 26, 3, null),
					new ExpectedCellValue(sheetName, 27, 3, null),
					new ExpectedCellValue(sheetName, 28, 3, null),
					new ExpectedCellValue(sheetName, 29, 3, null),
					new ExpectedCellValue(sheetName, 30, 3, 1d),
					new ExpectedCellValue(sheetName, 31, 3, 1d),
					new ExpectedCellValue(sheetName, 32, 3, null),
					new ExpectedCellValue(sheetName, 33, 3, null),
					new ExpectedCellValue(sheetName, 34, 3, null),
					new ExpectedCellValue(sheetName, 35, 3, 1d),
					new ExpectedCellValue(sheetName, 36, 3, 1d),
					new ExpectedCellValue(sheetName, 37, 3, 1d),
					new ExpectedCellValue(sheetName, 38, 3, null),
					new ExpectedCellValue(sheetName, 39, 3, null),
					new ExpectedCellValue(sheetName, 40, 3, null),
					new ExpectedCellValue(sheetName, 41, 3, null),
					new ExpectedCellValue(sheetName, 42, 3, null),
					new ExpectedCellValue(sheetName, 43, 3, null),
					new ExpectedCellValue(sheetName, 44, 3, null),
					new ExpectedCellValue(sheetName, 45, 3, null),
					new ExpectedCellValue(sheetName, 46, 3, null),
					new ExpectedCellValue(sheetName, 47, 3, null),
					new ExpectedCellValue(sheetName, 48, 3, null),
					new ExpectedCellValue(sheetName, 49, 3, null),
					new ExpectedCellValue(sheetName, 50, 3, null),
					new ExpectedCellValue(sheetName, 51, 3, null),
					new ExpectedCellValue(sheetName, 52, 3, null),
					new ExpectedCellValue(sheetName, 53, 3, 1d),
					new ExpectedCellValue(sheetName, 15, 4, null),
					new ExpectedCellValue(sheetName, 16, 4, null),
					new ExpectedCellValue(sheetName, 17, 4, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 4, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 4, 415.75),
					new ExpectedCellValue(sheetName, 20, 4, 415.75),
					new ExpectedCellValue(sheetName, 21, 4, 415.75),
					new ExpectedCellValue(sheetName, 22, 4, 415.75),
					new ExpectedCellValue(sheetName, 23, 4, 415.75),
					new ExpectedCellValue(sheetName, 24, 4, 415.75),
					new ExpectedCellValue(sheetName, 25, 4, null),
					new ExpectedCellValue(sheetName, 26, 4, null),
					new ExpectedCellValue(sheetName, 27, 4, null),
					new ExpectedCellValue(sheetName, 28, 4, null),
					new ExpectedCellValue(sheetName, 29, 4, null),
					new ExpectedCellValue(sheetName, 30, 4, null),
					new ExpectedCellValue(sheetName, 31, 4, null),
					new ExpectedCellValue(sheetName, 32, 4, null),
					new ExpectedCellValue(sheetName, 33, 4, null),
					new ExpectedCellValue(sheetName, 34, 4, null),
					new ExpectedCellValue(sheetName, 35, 4, null),
					new ExpectedCellValue(sheetName, 36, 4, null),
					new ExpectedCellValue(sheetName, 37, 4, null),
					new ExpectedCellValue(sheetName, 38, 4, null),
					new ExpectedCellValue(sheetName, 39, 4, null),
					new ExpectedCellValue(sheetName, 40, 4, null),
					new ExpectedCellValue(sheetName, 41, 4, null),
					new ExpectedCellValue(sheetName, 42, 4, null),
					new ExpectedCellValue(sheetName, 43, 4, null),
					new ExpectedCellValue(sheetName, 44, 4, null),
					new ExpectedCellValue(sheetName, 45, 4, null),
					new ExpectedCellValue(sheetName, 46, 4, null),
					new ExpectedCellValue(sheetName, 47, 4, null),
					new ExpectedCellValue(sheetName, 48, 4, null),
					new ExpectedCellValue(sheetName, 49, 4, null),
					new ExpectedCellValue(sheetName, 50, 4, null),
					new ExpectedCellValue(sheetName, 51, 4, null),
					new ExpectedCellValue(sheetName, 52, 4, null),
					new ExpectedCellValue(sheetName, 53, 4, 415.75),
					new ExpectedCellValue(sheetName, 15, 5, null),
					new ExpectedCellValue(sheetName, 16, 5, null),
					new ExpectedCellValue(sheetName, 17, 5, null),
					new ExpectedCellValue(sheetName, 18, 5, "Headlamp"),
					new ExpectedCellValue(sheetName, 19, 5, 24.99),
					new ExpectedCellValue(sheetName, 20, 5, null),
					new ExpectedCellValue(sheetName, 21, 5, null),
					new ExpectedCellValue(sheetName, 22, 5, null),
					new ExpectedCellValue(sheetName, 23, 5, null),
					new ExpectedCellValue(sheetName, 24, 5, null),
					new ExpectedCellValue(sheetName, 25, 5, null),
					new ExpectedCellValue(sheetName, 26, 5, null),
					new ExpectedCellValue(sheetName, 27, 5, null),
					new ExpectedCellValue(sheetName, 28, 5, null),
					new ExpectedCellValue(sheetName, 29, 5, null),
					new ExpectedCellValue(sheetName, 30, 5, 24.99),
					new ExpectedCellValue(sheetName, 31, 5, 24.99),
					new ExpectedCellValue(sheetName, 32, 5, null),
					new ExpectedCellValue(sheetName, 33, 5, null),
					new ExpectedCellValue(sheetName, 34, 5, null),
					new ExpectedCellValue(sheetName, 35, 5, 24.99),
					new ExpectedCellValue(sheetName, 36, 5, 24.99),
					new ExpectedCellValue(sheetName, 37, 5, 24.99),
					new ExpectedCellValue(sheetName, 38, 5, null),
					new ExpectedCellValue(sheetName, 39, 5, null),
					new ExpectedCellValue(sheetName, 40, 5, null),
					new ExpectedCellValue(sheetName, 41, 5, null),
					new ExpectedCellValue(sheetName, 42, 5, null),
					new ExpectedCellValue(sheetName, 43, 5, null),
					new ExpectedCellValue(sheetName, 44, 5, null),
					new ExpectedCellValue(sheetName, 45, 5, null),
					new ExpectedCellValue(sheetName, 46, 5, null),
					new ExpectedCellValue(sheetName, 47, 5, null),
					new ExpectedCellValue(sheetName, 48, 5, null),
					new ExpectedCellValue(sheetName, 49, 5, null),
					new ExpectedCellValue(sheetName, 50, 5, null),
					new ExpectedCellValue(sheetName, 51, 5, null),
					new ExpectedCellValue(sheetName, 52, 5, null),
					new ExpectedCellValue(sheetName, 53, 5, 24.99),
					new ExpectedCellValue(sheetName, 15, 6, null),
					new ExpectedCellValue(sheetName, 16, 6, "Chicago Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 6, null),
					new ExpectedCellValue(sheetName, 18, 6, null),
					new ExpectedCellValue(sheetName, 19, 6, 3d),
					new ExpectedCellValue(sheetName, 20, 6, 2d),
					new ExpectedCellValue(sheetName, 21, 6, 2d),
					new ExpectedCellValue(sheetName, 22, 6, 2d),
					new ExpectedCellValue(sheetName, 23, 6, 2d),
					new ExpectedCellValue(sheetName, 24, 6, 2d),
					new ExpectedCellValue(sheetName, 25, 6, null),
					new ExpectedCellValue(sheetName, 26, 6, null),
					new ExpectedCellValue(sheetName, 27, 6, null),
					new ExpectedCellValue(sheetName, 28, 6, null),
					new ExpectedCellValue(sheetName, 29, 6, null),
					new ExpectedCellValue(sheetName, 30, 6, 1d),
					new ExpectedCellValue(sheetName, 31, 6, 1d),
					new ExpectedCellValue(sheetName, 32, 6, null),
					new ExpectedCellValue(sheetName, 33, 6, null),
					new ExpectedCellValue(sheetName, 34, 6, null),
					new ExpectedCellValue(sheetName, 35, 6, 1d),
					new ExpectedCellValue(sheetName, 36, 6, 1d),
					new ExpectedCellValue(sheetName, 37, 6, 1d),
					new ExpectedCellValue(sheetName, 38, 6, null),
					new ExpectedCellValue(sheetName, 39, 6, null),
					new ExpectedCellValue(sheetName, 40, 6, null),
					new ExpectedCellValue(sheetName, 41, 6, null),
					new ExpectedCellValue(sheetName, 42, 6, null),
					new ExpectedCellValue(sheetName, 43, 6, null),
					new ExpectedCellValue(sheetName, 44, 6, null),
					new ExpectedCellValue(sheetName, 45, 6, null),
					new ExpectedCellValue(sheetName, 46, 6, null),
					new ExpectedCellValue(sheetName, 47, 6, null),
					new ExpectedCellValue(sheetName, 48, 6, null),
					new ExpectedCellValue(sheetName, 49, 6, null),
					new ExpectedCellValue(sheetName, 50, 6, null),
					new ExpectedCellValue(sheetName, 51, 6, null),
					new ExpectedCellValue(sheetName, 52, 6, null),
					new ExpectedCellValue(sheetName, 53, 6, 3d),
					new ExpectedCellValue(sheetName, 15, 7, null),
					new ExpectedCellValue(sheetName, 16, 7, "Chicago Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 7, null),
					new ExpectedCellValue(sheetName, 18, 7, null),
					new ExpectedCellValue(sheetName, 19, 7, 440.74),
					new ExpectedCellValue(sheetName, 20, 7, 415.75),
					new ExpectedCellValue(sheetName, 21, 7, 415.75),
					new ExpectedCellValue(sheetName, 22, 7, 415.75),
					new ExpectedCellValue(sheetName, 23, 7, 415.75),
					new ExpectedCellValue(sheetName, 24, 7, 415.75),
					new ExpectedCellValue(sheetName, 25, 7, null),
					new ExpectedCellValue(sheetName, 26, 7, null),
					new ExpectedCellValue(sheetName, 27, 7, null),
					new ExpectedCellValue(sheetName, 28, 7, null),
					new ExpectedCellValue(sheetName, 29, 7, null),
					new ExpectedCellValue(sheetName, 30, 7, 24.99),
					new ExpectedCellValue(sheetName, 31, 7, 24.99),
					new ExpectedCellValue(sheetName, 32, 7, null),
					new ExpectedCellValue(sheetName, 33, 7, null),
					new ExpectedCellValue(sheetName, 34, 7, null),
					new ExpectedCellValue(sheetName, 35, 7, 24.99),
					new ExpectedCellValue(sheetName, 36, 7, 24.99),
					new ExpectedCellValue(sheetName, 37, 7, 24.99),
					new ExpectedCellValue(sheetName, 38, 7, null),
					new ExpectedCellValue(sheetName, 39, 7, null),
					new ExpectedCellValue(sheetName, 40, 7, null),
					new ExpectedCellValue(sheetName, 41, 7, null),
					new ExpectedCellValue(sheetName, 42, 7, null),
					new ExpectedCellValue(sheetName, 43, 7, null),
					new ExpectedCellValue(sheetName, 44, 7, null),
					new ExpectedCellValue(sheetName, 45, 7, null),
					new ExpectedCellValue(sheetName, 46, 7, null),
					new ExpectedCellValue(sheetName, 47, 7, null),
					new ExpectedCellValue(sheetName, 48, 7, null),
					new ExpectedCellValue(sheetName, 49, 7, null),
					new ExpectedCellValue(sheetName, 50, 7, null),
					new ExpectedCellValue(sheetName, 51, 7, null),
					new ExpectedCellValue(sheetName, 52, 7, null),
					new ExpectedCellValue(sheetName, 53, 7, 440.74),
					new ExpectedCellValue(sheetName, 15, 8, null),
					new ExpectedCellValue(sheetName, 16, 8, "Nashville"),
					new ExpectedCellValue(sheetName, 17, 8, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 8, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 8, 4d),
					new ExpectedCellValue(sheetName, 20, 8, null),
					new ExpectedCellValue(sheetName, 21, 8, null),
					new ExpectedCellValue(sheetName, 22, 8, null),
					new ExpectedCellValue(sheetName, 23, 8, null),
					new ExpectedCellValue(sheetName, 24, 8, null),
					new ExpectedCellValue(sheetName, 25, 8, 2d),
					new ExpectedCellValue(sheetName, 26, 8, 2d),
					new ExpectedCellValue(sheetName, 27, 8, 2d),
					new ExpectedCellValue(sheetName, 28, 8, 2d),
					new ExpectedCellValue(sheetName, 29, 8, 2d),
					new ExpectedCellValue(sheetName, 30, 8, 2d),
					new ExpectedCellValue(sheetName, 31, 8, 2d),
					new ExpectedCellValue(sheetName, 32, 8, 2d),
					new ExpectedCellValue(sheetName, 33, 8, 2d),
					new ExpectedCellValue(sheetName, 34, 8, 2d),
					new ExpectedCellValue(sheetName, 35, 8, null),
					new ExpectedCellValue(sheetName, 36, 8, null),
					new ExpectedCellValue(sheetName, 37, 8, null),
					new ExpectedCellValue(sheetName, 38, 8, null),
					new ExpectedCellValue(sheetName, 39, 8, null),
					new ExpectedCellValue(sheetName, 40, 8, null),
					new ExpectedCellValue(sheetName, 41, 8, null),
					new ExpectedCellValue(sheetName, 42, 8, null),
					new ExpectedCellValue(sheetName, 43, 8, null),
					new ExpectedCellValue(sheetName, 44, 8, null),
					new ExpectedCellValue(sheetName, 45, 8, null),
					new ExpectedCellValue(sheetName, 46, 8, null),
					new ExpectedCellValue(sheetName, 47, 8, null),
					new ExpectedCellValue(sheetName, 48, 8, null),
					new ExpectedCellValue(sheetName, 49, 8, null),
					new ExpectedCellValue(sheetName, 50, 8, null),
					new ExpectedCellValue(sheetName, 51, 8, null),
					new ExpectedCellValue(sheetName, 52, 8, null),
					new ExpectedCellValue(sheetName, 53, 8, 4d),
					new ExpectedCellValue(sheetName, 15, 9, null),
					new ExpectedCellValue(sheetName, 16, 9, null),
					new ExpectedCellValue(sheetName, 17, 9, null),
					new ExpectedCellValue(sheetName, 18, 9, "Tent"),
					new ExpectedCellValue(sheetName, 19, 9, null),
					new ExpectedCellValue(sheetName, 20, 9, null),
					new ExpectedCellValue(sheetName, 21, 9, null),
					new ExpectedCellValue(sheetName, 22, 9, null),
					new ExpectedCellValue(sheetName, 23, 9, null),
					new ExpectedCellValue(sheetName, 24, 9, null),
					new ExpectedCellValue(sheetName, 25, 9, null),
					new ExpectedCellValue(sheetName, 26, 9, null),
					new ExpectedCellValue(sheetName, 27, 9, null),
					new ExpectedCellValue(sheetName, 28, 9, null),
					new ExpectedCellValue(sheetName, 29, 9, null),
					new ExpectedCellValue(sheetName, 30, 9, null),
					new ExpectedCellValue(sheetName, 31, 9, null),
					new ExpectedCellValue(sheetName, 32, 9, null),
					new ExpectedCellValue(sheetName, 33, 9, null),
					new ExpectedCellValue(sheetName, 34, 9, null),
					new ExpectedCellValue(sheetName, 35, 9, null),
					new ExpectedCellValue(sheetName, 36, 9, null),
					new ExpectedCellValue(sheetName, 37, 9, null),
					new ExpectedCellValue(sheetName, 38, 9, null),
					new ExpectedCellValue(sheetName, 39, 9, null),
					new ExpectedCellValue(sheetName, 40, 9, null),
					new ExpectedCellValue(sheetName, 41, 9, null),
					new ExpectedCellValue(sheetName, 42, 9, 6d),
					new ExpectedCellValue(sheetName, 43, 9, null),
					new ExpectedCellValue(sheetName, 44, 9, null),
					new ExpectedCellValue(sheetName, 45, 9, null),
					new ExpectedCellValue(sheetName, 46, 9, null),
					new ExpectedCellValue(sheetName, 47, 9, null),
					new ExpectedCellValue(sheetName, 48, 9, 6d),
					new ExpectedCellValue(sheetName, 49, 9, 6d),
					new ExpectedCellValue(sheetName, 50, 9, 6d),
					new ExpectedCellValue(sheetName, 51, 9, 6d),
					new ExpectedCellValue(sheetName, 52, 9, 6d),
					new ExpectedCellValue(sheetName, 53, 9, 6d),
					new ExpectedCellValue(sheetName, 15, 10, null),
					new ExpectedCellValue(sheetName, 16, 10, null),
					new ExpectedCellValue(sheetName, 17, 10, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 10, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 10, 831.5),
					new ExpectedCellValue(sheetName, 20, 10, null),
					new ExpectedCellValue(sheetName, 21, 10, null),
					new ExpectedCellValue(sheetName, 22, 10, null),
					new ExpectedCellValue(sheetName, 23, 10, null),
					new ExpectedCellValue(sheetName, 24, 10, null),
					new ExpectedCellValue(sheetName, 25, 10, 415.75),
					new ExpectedCellValue(sheetName, 26, 10, 415.75),
					new ExpectedCellValue(sheetName, 27, 10, 415.75),
					new ExpectedCellValue(sheetName, 28, 10, 415.75),
					new ExpectedCellValue(sheetName, 29, 10, 415.75),
					new ExpectedCellValue(sheetName, 30, 10, 415.75),
					new ExpectedCellValue(sheetName, 31, 10, 415.75),
					new ExpectedCellValue(sheetName, 32, 10, 415.75),
					new ExpectedCellValue(sheetName, 33, 10, 415.75),
					new ExpectedCellValue(sheetName, 34, 10, 415.75),
					new ExpectedCellValue(sheetName, 35, 10, null),
					new ExpectedCellValue(sheetName, 36, 10, null),
					new ExpectedCellValue(sheetName, 37, 10, null),
					new ExpectedCellValue(sheetName, 38, 10, null),
					new ExpectedCellValue(sheetName, 39, 10, null),
					new ExpectedCellValue(sheetName, 40, 10, null),
					new ExpectedCellValue(sheetName, 41, 10, null),
					new ExpectedCellValue(sheetName, 42, 10, null),
					new ExpectedCellValue(sheetName, 43, 10, null),
					new ExpectedCellValue(sheetName, 44, 10, null),
					new ExpectedCellValue(sheetName, 45, 10, null),
					new ExpectedCellValue(sheetName, 46, 10, null),
					new ExpectedCellValue(sheetName, 47, 10, null),
					new ExpectedCellValue(sheetName, 48, 10, null),
					new ExpectedCellValue(sheetName, 49, 10, null),
					new ExpectedCellValue(sheetName, 50, 10, null),
					new ExpectedCellValue(sheetName, 51, 10, null),
					new ExpectedCellValue(sheetName, 52, 10, null),
					new ExpectedCellValue(sheetName, 53, 10, 831.5),
					new ExpectedCellValue(sheetName, 15, 11, null),
					new ExpectedCellValue(sheetName, 16, 11, null),
					new ExpectedCellValue(sheetName, 17, 11, null),
					new ExpectedCellValue(sheetName, 18, 11, "Tent"),
					new ExpectedCellValue(sheetName, 19, 11, null),
					new ExpectedCellValue(sheetName, 20, 11, null),
					new ExpectedCellValue(sheetName, 21, 11, null),
					new ExpectedCellValue(sheetName, 22, 11, null),
					new ExpectedCellValue(sheetName, 23, 11, null),
					new ExpectedCellValue(sheetName, 24, 11, null),
					new ExpectedCellValue(sheetName, 25, 11, null),
					new ExpectedCellValue(sheetName, 26, 11, null),
					new ExpectedCellValue(sheetName, 27, 11, null),
					new ExpectedCellValue(sheetName, 28, 11, null),
					new ExpectedCellValue(sheetName, 29, 11, null),
					new ExpectedCellValue(sheetName, 30, 11, null),
					new ExpectedCellValue(sheetName, 31, 11, null),
					new ExpectedCellValue(sheetName, 32, 11, null),
					new ExpectedCellValue(sheetName, 33, 11, null),
					new ExpectedCellValue(sheetName, 34, 11, null),
					new ExpectedCellValue(sheetName, 35, 11, null),
					new ExpectedCellValue(sheetName, 36, 11, null),
					new ExpectedCellValue(sheetName, 37, 11, null),
					new ExpectedCellValue(sheetName, 38, 11, null),
					new ExpectedCellValue(sheetName, 39, 11, null),
					new ExpectedCellValue(sheetName, 40, 11, null),
					new ExpectedCellValue(sheetName, 41, 11, null),
					new ExpectedCellValue(sheetName, 42, 11, 199d),
					new ExpectedCellValue(sheetName, 43, 11, null),
					new ExpectedCellValue(sheetName, 44, 11, null),
					new ExpectedCellValue(sheetName, 45, 11, null),
					new ExpectedCellValue(sheetName, 46, 11, null),
					new ExpectedCellValue(sheetName, 47, 11, null),
					new ExpectedCellValue(sheetName, 48, 11, 199d),
					new ExpectedCellValue(sheetName, 49, 11, 199d),
					new ExpectedCellValue(sheetName, 50, 11, 199d),
					new ExpectedCellValue(sheetName, 51, 11, 199d),
					new ExpectedCellValue(sheetName, 52, 11, 199d),
					new ExpectedCellValue(sheetName, 53, 11, 199d),
					new ExpectedCellValue(sheetName, 15, 12, null),
					new ExpectedCellValue(sheetName, 16, 12, "Nashville Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 12, null),
					new ExpectedCellValue(sheetName, 18, 12, null),
					new ExpectedCellValue(sheetName, 19, 12, 4d),
					new ExpectedCellValue(sheetName, 20, 12, null),
					new ExpectedCellValue(sheetName, 21, 12, null),
					new ExpectedCellValue(sheetName, 22, 12, null),
					new ExpectedCellValue(sheetName, 23, 12, null),
					new ExpectedCellValue(sheetName, 24, 12, null),
					new ExpectedCellValue(sheetName, 25, 12, 2d),
					new ExpectedCellValue(sheetName, 26, 12, 2d),
					new ExpectedCellValue(sheetName, 27, 12, 2d),
					new ExpectedCellValue(sheetName, 28, 12, 2d),
					new ExpectedCellValue(sheetName, 29, 12, 2d),
					new ExpectedCellValue(sheetName, 30, 12, 2d),
					new ExpectedCellValue(sheetName, 31, 12, 2d),
					new ExpectedCellValue(sheetName, 32, 12, 2d),
					new ExpectedCellValue(sheetName, 33, 12, 2d),
					new ExpectedCellValue(sheetName, 34, 12, 2d),
					new ExpectedCellValue(sheetName, 35, 12, null),
					new ExpectedCellValue(sheetName, 36, 12, null),
					new ExpectedCellValue(sheetName, 37, 12, null),
					new ExpectedCellValue(sheetName, 38, 12, null),
					new ExpectedCellValue(sheetName, 39, 12, null),
					new ExpectedCellValue(sheetName, 40, 12, null),
					new ExpectedCellValue(sheetName, 41, 12, null),
					new ExpectedCellValue(sheetName, 42, 12, 6d),
					new ExpectedCellValue(sheetName, 43, 12, null),
					new ExpectedCellValue(sheetName, 44, 12, null),
					new ExpectedCellValue(sheetName, 45, 12, null),
					new ExpectedCellValue(sheetName, 46, 12, null),
					new ExpectedCellValue(sheetName, 47, 12, null),
					new ExpectedCellValue(sheetName, 48, 12, 6d),
					new ExpectedCellValue(sheetName, 49, 12, 6d),
					new ExpectedCellValue(sheetName, 50, 12, 6d),
					new ExpectedCellValue(sheetName, 51, 12, 6d),
					new ExpectedCellValue(sheetName, 52, 12, 6d),
					new ExpectedCellValue(sheetName, 53, 12, 10d),
					new ExpectedCellValue(sheetName, 15, 13, null),
					new ExpectedCellValue(sheetName, 16, 13, "Nashville Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 13, null),
					new ExpectedCellValue(sheetName, 18, 13, null),
					new ExpectedCellValue(sheetName, 19, 13, 831.5),
					new ExpectedCellValue(sheetName, 20, 13, null),
					new ExpectedCellValue(sheetName, 21, 13, null),
					new ExpectedCellValue(sheetName, 22, 13, null),
					new ExpectedCellValue(sheetName, 23, 13, null),
					new ExpectedCellValue(sheetName, 24, 13, null),
					new ExpectedCellValue(sheetName, 25, 13, 415.75),
					new ExpectedCellValue(sheetName, 26, 13, 415.75),
					new ExpectedCellValue(sheetName, 27, 13, 415.75),
					new ExpectedCellValue(sheetName, 28, 13, 415.75),
					new ExpectedCellValue(sheetName, 29, 13, 415.75),
					new ExpectedCellValue(sheetName, 30, 13, 415.75),
					new ExpectedCellValue(sheetName, 31, 13, 415.75),
					new ExpectedCellValue(sheetName, 32, 13, 415.75),
					new ExpectedCellValue(sheetName, 33, 13, 415.75),
					new ExpectedCellValue(sheetName, 34, 13, 415.75),
					new ExpectedCellValue(sheetName, 35, 13, null),
					new ExpectedCellValue(sheetName, 36, 13, null),
					new ExpectedCellValue(sheetName, 37, 13, null),
					new ExpectedCellValue(sheetName, 38, 13, null),
					new ExpectedCellValue(sheetName, 39, 13, null),
					new ExpectedCellValue(sheetName, 40, 13, null),
					new ExpectedCellValue(sheetName, 41, 13, null),
					new ExpectedCellValue(sheetName, 42, 13, 199d),
					new ExpectedCellValue(sheetName, 43, 13, null),
					new ExpectedCellValue(sheetName, 44, 13, null),
					new ExpectedCellValue(sheetName, 45, 13, null),
					new ExpectedCellValue(sheetName, 46, 13, null),
					new ExpectedCellValue(sheetName, 47, 13, null),
					new ExpectedCellValue(sheetName, 48, 13, 199d),
					new ExpectedCellValue(sheetName, 49, 13, 199d),
					new ExpectedCellValue(sheetName, 50, 13, 199d),
					new ExpectedCellValue(sheetName, 51, 13, 199d),
					new ExpectedCellValue(sheetName, 52, 13, 199d),
					new ExpectedCellValue(sheetName, 53, 13, 1030.5),
					new ExpectedCellValue(sheetName, 15, 14, "Group1 Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 14, null),
					new ExpectedCellValue(sheetName, 17, 14, null),
					new ExpectedCellValue(sheetName, 18, 14, null),
					new ExpectedCellValue(sheetName, 19, 14, 7d),
					new ExpectedCellValue(sheetName, 20, 14, 2d),
					new ExpectedCellValue(sheetName, 21, 14, 2d),
					new ExpectedCellValue(sheetName, 22, 14, 2d),
					new ExpectedCellValue(sheetName, 23, 14, 2d),
					new ExpectedCellValue(sheetName, 24, 14, 2d),
					new ExpectedCellValue(sheetName, 25, 14, 2d),
					new ExpectedCellValue(sheetName, 26, 14, 2d),
					new ExpectedCellValue(sheetName, 27, 14, 2d),
					new ExpectedCellValue(sheetName, 28, 14, 2d),
					new ExpectedCellValue(sheetName, 29, 14, 2d),
					new ExpectedCellValue(sheetName, 30, 14, 3d),
					new ExpectedCellValue(sheetName, 31, 14, 3d),
					new ExpectedCellValue(sheetName, 32, 14, 2d),
					new ExpectedCellValue(sheetName, 33, 14, 2d),
					new ExpectedCellValue(sheetName, 34, 14, 2d),
					new ExpectedCellValue(sheetName, 35, 14, 1d),
					new ExpectedCellValue(sheetName, 36, 14, 1d),
					new ExpectedCellValue(sheetName, 37, 14, 1d),
					new ExpectedCellValue(sheetName, 38, 14, null),
					new ExpectedCellValue(sheetName, 39, 14, null),
					new ExpectedCellValue(sheetName, 40, 14, null),
					new ExpectedCellValue(sheetName, 41, 14, null),
					new ExpectedCellValue(sheetName, 42, 14, 6d),
					new ExpectedCellValue(sheetName, 43, 14, null),
					new ExpectedCellValue(sheetName, 44, 14, null),
					new ExpectedCellValue(sheetName, 45, 14, null),
					new ExpectedCellValue(sheetName, 46, 14, null),
					new ExpectedCellValue(sheetName, 47, 14, null),
					new ExpectedCellValue(sheetName, 48, 14, 6d),
					new ExpectedCellValue(sheetName, 49, 14, 6d),
					new ExpectedCellValue(sheetName, 50, 14, 6d),
					new ExpectedCellValue(sheetName, 51, 14, 6d),
					new ExpectedCellValue(sheetName, 52, 14, 6d),
					new ExpectedCellValue(sheetName, 53, 14, 13d),
					new ExpectedCellValue(sheetName, 15, 15, "Group1 Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 15, null),
					new ExpectedCellValue(sheetName, 17, 15, null),
					new ExpectedCellValue(sheetName, 18, 15, null),
					new ExpectedCellValue(sheetName, 19, 15, 1272.24),
					new ExpectedCellValue(sheetName, 20, 15, 415.75),
					new ExpectedCellValue(sheetName, 21, 15, 415.75),
					new ExpectedCellValue(sheetName, 22, 15, 415.75),
					new ExpectedCellValue(sheetName, 23, 15, 415.75),
					new ExpectedCellValue(sheetName, 24, 15, 415.75),
					new ExpectedCellValue(sheetName, 25, 15, 415.75),
					new ExpectedCellValue(sheetName, 26, 15, 415.75),
					new ExpectedCellValue(sheetName, 27, 15, 415.75),
					new ExpectedCellValue(sheetName, 28, 15, 415.75),
					new ExpectedCellValue(sheetName, 29, 15, 415.75),
					new ExpectedCellValue(sheetName, 30, 15, 440.74),
					new ExpectedCellValue(sheetName, 31, 15, 440.74),
					new ExpectedCellValue(sheetName, 32, 15, 415.75),
					new ExpectedCellValue(sheetName, 33, 15, 415.75),
					new ExpectedCellValue(sheetName, 34, 15, 415.75),
					new ExpectedCellValue(sheetName, 35, 15, 24.99),
					new ExpectedCellValue(sheetName, 36, 15, 24.99),
					new ExpectedCellValue(sheetName, 37, 15, 24.99),
					new ExpectedCellValue(sheetName, 38, 15, null),
					new ExpectedCellValue(sheetName, 39, 15, null),
					new ExpectedCellValue(sheetName, 40, 15, null),
					new ExpectedCellValue(sheetName, 41, 15, null),
					new ExpectedCellValue(sheetName, 42, 15, 199d),
					new ExpectedCellValue(sheetName, 43, 15, null),
					new ExpectedCellValue(sheetName, 44, 15, null),
					new ExpectedCellValue(sheetName, 45, 15, null),
					new ExpectedCellValue(sheetName, 46, 15, null),
					new ExpectedCellValue(sheetName, 47, 15, null),
					new ExpectedCellValue(sheetName, 48, 15, 199d),
					new ExpectedCellValue(sheetName, 49, 15, 199d),
					new ExpectedCellValue(sheetName, 50, 15, 199d),
					new ExpectedCellValue(sheetName, 51, 15, 199d),
					new ExpectedCellValue(sheetName, 52, 15, 199d),
					new ExpectedCellValue(sheetName, 53, 15, 1471.24),
					new ExpectedCellValue(sheetName, 15, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 16, 16, "San Francisco"),
					new ExpectedCellValue(sheetName, 17, 16, "Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 18, 16, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 16, 1d),
					new ExpectedCellValue(sheetName, 20, 16, null),
					new ExpectedCellValue(sheetName, 21, 16, null),
					new ExpectedCellValue(sheetName, 22, 16, null),
					new ExpectedCellValue(sheetName, 23, 16, null),
					new ExpectedCellValue(sheetName, 24, 16, null),
					new ExpectedCellValue(sheetName, 25, 16, null),
					new ExpectedCellValue(sheetName, 26, 16, null),
					new ExpectedCellValue(sheetName, 27, 16, null),
					new ExpectedCellValue(sheetName, 28, 16, null),
					new ExpectedCellValue(sheetName, 29, 16, null),
					new ExpectedCellValue(sheetName, 30, 16, 1d),
					new ExpectedCellValue(sheetName, 31, 16, null),
					new ExpectedCellValue(sheetName, 32, 16, null),
					new ExpectedCellValue(sheetName, 33, 16, null),
					new ExpectedCellValue(sheetName, 34, 16, null),
					new ExpectedCellValue(sheetName, 35, 16, null),
					new ExpectedCellValue(sheetName, 36, 16, null),
					new ExpectedCellValue(sheetName, 37, 16, null),
					new ExpectedCellValue(sheetName, 38, 16, 1d),
					new ExpectedCellValue(sheetName, 39, 16, 1d),
					new ExpectedCellValue(sheetName, 40, 16, 1d),
					new ExpectedCellValue(sheetName, 41, 16, 1d),
					new ExpectedCellValue(sheetName, 42, 16, null),
					new ExpectedCellValue(sheetName, 43, 16, null),
					new ExpectedCellValue(sheetName, 44, 16, null),
					new ExpectedCellValue(sheetName, 45, 16, null),
					new ExpectedCellValue(sheetName, 46, 16, null),
					new ExpectedCellValue(sheetName, 47, 16, null),
					new ExpectedCellValue(sheetName, 48, 16, null),
					new ExpectedCellValue(sheetName, 49, 16, null),
					new ExpectedCellValue(sheetName, 50, 16, null),
					new ExpectedCellValue(sheetName, 51, 16, null),
					new ExpectedCellValue(sheetName, 52, 16, null),
					new ExpectedCellValue(sheetName, 53, 16, 1d),
					new ExpectedCellValue(sheetName, 15, 17, null),
					new ExpectedCellValue(sheetName, 16, 17, null),
					new ExpectedCellValue(sheetName, 17, 17, null),
					new ExpectedCellValue(sheetName, 18, 17, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 19, 17, null),
					new ExpectedCellValue(sheetName, 20, 17, null),
					new ExpectedCellValue(sheetName, 21, 17, null),
					new ExpectedCellValue(sheetName, 22, 17, null),
					new ExpectedCellValue(sheetName, 23, 17, null),
					new ExpectedCellValue(sheetName, 24, 17, null),
					new ExpectedCellValue(sheetName, 25, 17, null),
					new ExpectedCellValue(sheetName, 26, 17, null),
					new ExpectedCellValue(sheetName, 27, 17, null),
					new ExpectedCellValue(sheetName, 28, 17, null),
					new ExpectedCellValue(sheetName, 29, 17, null),
					new ExpectedCellValue(sheetName, 30, 17, null),
					new ExpectedCellValue(sheetName, 31, 17, null),
					new ExpectedCellValue(sheetName, 32, 17, null),
					new ExpectedCellValue(sheetName, 33, 17, null),
					new ExpectedCellValue(sheetName, 34, 17, null),
					new ExpectedCellValue(sheetName, 35, 17, null),
					new ExpectedCellValue(sheetName, 36, 17, null),
					new ExpectedCellValue(sheetName, 37, 17, null),
					new ExpectedCellValue(sheetName, 38, 17, null),
					new ExpectedCellValue(sheetName, 39, 17, null),
					new ExpectedCellValue(sheetName, 40, 17, null),
					new ExpectedCellValue(sheetName, 41, 17, null),
					new ExpectedCellValue(sheetName, 42, 17, 1d),
					new ExpectedCellValue(sheetName, 43, 17, 1d),
					new ExpectedCellValue(sheetName, 44, 17, 1d),
					new ExpectedCellValue(sheetName, 45, 17, 1d),
					new ExpectedCellValue(sheetName, 46, 17, 1d),
					new ExpectedCellValue(sheetName, 47, 17, 1d),
					new ExpectedCellValue(sheetName, 48, 17, null),
					new ExpectedCellValue(sheetName, 49, 17, null),
					new ExpectedCellValue(sheetName, 50, 17, null),
					new ExpectedCellValue(sheetName, 51, 17, null),
					new ExpectedCellValue(sheetName, 52, 17, null),
					new ExpectedCellValue(sheetName, 53, 17, 1d),
					new ExpectedCellValue(sheetName, 15, 18, null),
					new ExpectedCellValue(sheetName, 16, 18, null),
					new ExpectedCellValue(sheetName, 17, 18, "Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 18, 18, "Car Rack"),
					new ExpectedCellValue(sheetName, 19, 18, 415.75),
					new ExpectedCellValue(sheetName, 20, 18, null),
					new ExpectedCellValue(sheetName, 21, 18, null),
					new ExpectedCellValue(sheetName, 22, 18, null),
					new ExpectedCellValue(sheetName, 23, 18, null),
					new ExpectedCellValue(sheetName, 24, 18, null),
					new ExpectedCellValue(sheetName, 25, 18, null),
					new ExpectedCellValue(sheetName, 26, 18, null),
					new ExpectedCellValue(sheetName, 27, 18, null),
					new ExpectedCellValue(sheetName, 28, 18, null),
					new ExpectedCellValue(sheetName, 29, 18, null),
					new ExpectedCellValue(sheetName, 30, 18, 415.75),
					new ExpectedCellValue(sheetName, 31, 18, null),
					new ExpectedCellValue(sheetName, 32, 18, null),
					new ExpectedCellValue(sheetName, 33, 18, null),
					new ExpectedCellValue(sheetName, 34, 18, null),
					new ExpectedCellValue(sheetName, 35, 18, null),
					new ExpectedCellValue(sheetName, 36, 18, null),
					new ExpectedCellValue(sheetName, 37, 18, null),
					new ExpectedCellValue(sheetName, 38, 18, 415.75),
					new ExpectedCellValue(sheetName, 39, 18, 415.75),
					new ExpectedCellValue(sheetName, 40, 18, 415.75),
					new ExpectedCellValue(sheetName, 41, 18, 415.75),
					new ExpectedCellValue(sheetName, 42, 18, null),
					new ExpectedCellValue(sheetName, 43, 18, null),
					new ExpectedCellValue(sheetName, 44, 18, null),
					new ExpectedCellValue(sheetName, 45, 18, null),
					new ExpectedCellValue(sheetName, 46, 18, null),
					new ExpectedCellValue(sheetName, 47, 18, null),
					new ExpectedCellValue(sheetName, 48, 18, null),
					new ExpectedCellValue(sheetName, 49, 18, null),
					new ExpectedCellValue(sheetName, 50, 18, null),
					new ExpectedCellValue(sheetName, 51, 18, null),
					new ExpectedCellValue(sheetName, 52, 18, null),
					new ExpectedCellValue(sheetName, 53, 18, 415.75),
					new ExpectedCellValue(sheetName, 15, 19, null),
					new ExpectedCellValue(sheetName, 16, 19, null),
					new ExpectedCellValue(sheetName, 17, 19, null),
					new ExpectedCellValue(sheetName, 18, 19, "Sleeping Bag"),
					new ExpectedCellValue(sheetName, 19, 19, null),
					new ExpectedCellValue(sheetName, 20, 19, null),
					new ExpectedCellValue(sheetName, 21, 19, null),
					new ExpectedCellValue(sheetName, 22, 19, null),
					new ExpectedCellValue(sheetName, 23, 19, null),
					new ExpectedCellValue(sheetName, 24, 19, null),
					new ExpectedCellValue(sheetName, 25, 19, null),
					new ExpectedCellValue(sheetName, 26, 19, null),
					new ExpectedCellValue(sheetName, 27, 19, null),
					new ExpectedCellValue(sheetName, 28, 19, null),
					new ExpectedCellValue(sheetName, 29, 19, null),
					new ExpectedCellValue(sheetName, 30, 19, null),
					new ExpectedCellValue(sheetName, 31, 19, null),
					new ExpectedCellValue(sheetName, 32, 19, null),
					new ExpectedCellValue(sheetName, 33, 19, null),
					new ExpectedCellValue(sheetName, 34, 19, null),
					new ExpectedCellValue(sheetName, 35, 19, null),
					new ExpectedCellValue(sheetName, 36, 19, null),
					new ExpectedCellValue(sheetName, 37, 19, null),
					new ExpectedCellValue(sheetName, 38, 19, null),
					new ExpectedCellValue(sheetName, 39, 19, null),
					new ExpectedCellValue(sheetName, 40, 19, null),
					new ExpectedCellValue(sheetName, 41, 19, null),
					new ExpectedCellValue(sheetName, 42, 19, 99d),
					new ExpectedCellValue(sheetName, 43, 19, 99d),
					new ExpectedCellValue(sheetName, 44, 19, 99d),
					new ExpectedCellValue(sheetName, 45, 19, 99d),
					new ExpectedCellValue(sheetName, 46, 19, 99d),
					new ExpectedCellValue(sheetName, 47, 19, 99d),
					new ExpectedCellValue(sheetName, 48, 19, null),
					new ExpectedCellValue(sheetName, 49, 19, null),
					new ExpectedCellValue(sheetName, 50, 19, null),
					new ExpectedCellValue(sheetName, 51, 19, null),
					new ExpectedCellValue(sheetName, 52, 19, null),
					new ExpectedCellValue(sheetName, 53, 19, 99d),
					new ExpectedCellValue(sheetName, 15, 20, null),
					new ExpectedCellValue(sheetName, 16, 20, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 17, 20, null),
					new ExpectedCellValue(sheetName, 18, 20, null),
					new ExpectedCellValue(sheetName, 19, 20, 1d),
					new ExpectedCellValue(sheetName, 20, 20, null),
					new ExpectedCellValue(sheetName, 21, 20, null),
					new ExpectedCellValue(sheetName, 22, 20, null),
					new ExpectedCellValue(sheetName, 23, 20, null),
					new ExpectedCellValue(sheetName, 24, 20, null),
					new ExpectedCellValue(sheetName, 25, 20, null),
					new ExpectedCellValue(sheetName, 26, 20, null),
					new ExpectedCellValue(sheetName, 27, 20, null),
					new ExpectedCellValue(sheetName, 28, 20, null),
					new ExpectedCellValue(sheetName, 29, 20, null),
					new ExpectedCellValue(sheetName, 30, 20, 1d),
					new ExpectedCellValue(sheetName, 31, 20, null),
					new ExpectedCellValue(sheetName, 32, 20, null),
					new ExpectedCellValue(sheetName, 33, 20, null),
					new ExpectedCellValue(sheetName, 34, 20, null),
					new ExpectedCellValue(sheetName, 35, 20, null),
					new ExpectedCellValue(sheetName, 36, 20, null),
					new ExpectedCellValue(sheetName, 37, 20, null),
					new ExpectedCellValue(sheetName, 38, 20, 1d),
					new ExpectedCellValue(sheetName, 39, 20, 1d),
					new ExpectedCellValue(sheetName, 40, 20, 1d),
					new ExpectedCellValue(sheetName, 41, 20, 1d),
					new ExpectedCellValue(sheetName, 42, 20, 1d),
					new ExpectedCellValue(sheetName, 43, 20, 1d),
					new ExpectedCellValue(sheetName, 44, 20, 1d),
					new ExpectedCellValue(sheetName, 45, 20, 1d),
					new ExpectedCellValue(sheetName, 46, 20, 1d),
					new ExpectedCellValue(sheetName, 47, 20, 1d),
					new ExpectedCellValue(sheetName, 48, 20, null),
					new ExpectedCellValue(sheetName, 49, 20, null),
					new ExpectedCellValue(sheetName, 50, 20, null),
					new ExpectedCellValue(sheetName, 51, 20, null),
					new ExpectedCellValue(sheetName, 52, 20, null),
					new ExpectedCellValue(sheetName, 53, 20, 2d),
					new ExpectedCellValue(sheetName, 15, 21, null),
					new ExpectedCellValue(sheetName, 16, 21, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 17, 21, null),
					new ExpectedCellValue(sheetName, 18, 21, null),
					new ExpectedCellValue(sheetName, 19, 21, 415.75),
					new ExpectedCellValue(sheetName, 20, 21, null),
					new ExpectedCellValue(sheetName, 21, 21, null),
					new ExpectedCellValue(sheetName, 22, 21, null),
					new ExpectedCellValue(sheetName, 23, 21, null),
					new ExpectedCellValue(sheetName, 24, 21, null),
					new ExpectedCellValue(sheetName, 25, 21, null),
					new ExpectedCellValue(sheetName, 26, 21, null),
					new ExpectedCellValue(sheetName, 27, 21, null),
					new ExpectedCellValue(sheetName, 28, 21, null),
					new ExpectedCellValue(sheetName, 29, 21, null),
					new ExpectedCellValue(sheetName, 30, 21, 415.75),
					new ExpectedCellValue(sheetName, 31, 21, null),
					new ExpectedCellValue(sheetName, 32, 21, null),
					new ExpectedCellValue(sheetName, 33, 21, null),
					new ExpectedCellValue(sheetName, 34, 21, null),
					new ExpectedCellValue(sheetName, 35, 21, null),
					new ExpectedCellValue(sheetName, 36, 21, null),
					new ExpectedCellValue(sheetName, 37, 21, null),
					new ExpectedCellValue(sheetName, 38, 21, 415.75),
					new ExpectedCellValue(sheetName, 39, 21, 415.75),
					new ExpectedCellValue(sheetName, 40, 21, 415.75),
					new ExpectedCellValue(sheetName, 41, 21, 415.75),
					new ExpectedCellValue(sheetName, 42, 21, 99d),
					new ExpectedCellValue(sheetName, 43, 21, 99d),
					new ExpectedCellValue(sheetName, 44, 21, 99d),
					new ExpectedCellValue(sheetName, 45, 21, 99d),
					new ExpectedCellValue(sheetName, 46, 21, 99d),
					new ExpectedCellValue(sheetName, 47, 21, 99d),
					new ExpectedCellValue(sheetName, 48, 21, null),
					new ExpectedCellValue(sheetName, 49, 21, null),
					new ExpectedCellValue(sheetName, 50, 21, null),
					new ExpectedCellValue(sheetName, 51, 21, null),
					new ExpectedCellValue(sheetName, 52, 21, null),
					new ExpectedCellValue(sheetName, 53, 21, 514.75),
					new ExpectedCellValue(sheetName, 15, 22, "San Francisco Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 22, null),
					new ExpectedCellValue(sheetName, 17, 22, null),
					new ExpectedCellValue(sheetName, 18, 22, null),
					new ExpectedCellValue(sheetName, 19, 22, 1d),
					new ExpectedCellValue(sheetName, 20, 22, null),
					new ExpectedCellValue(sheetName, 21, 22, null),
					new ExpectedCellValue(sheetName, 22, 22, null),
					new ExpectedCellValue(sheetName, 23, 22, null),
					new ExpectedCellValue(sheetName, 24, 22, null),
					new ExpectedCellValue(sheetName, 25, 22, null),
					new ExpectedCellValue(sheetName, 26, 22, null),
					new ExpectedCellValue(sheetName, 27, 22, null),
					new ExpectedCellValue(sheetName, 28, 22, null),
					new ExpectedCellValue(sheetName, 29, 22, null),
					new ExpectedCellValue(sheetName, 30, 22, 1d),
					new ExpectedCellValue(sheetName, 31, 22, null),
					new ExpectedCellValue(sheetName, 32, 22, null),
					new ExpectedCellValue(sheetName, 33, 22, null),
					new ExpectedCellValue(sheetName, 34, 22, null),
					new ExpectedCellValue(sheetName, 35, 22, null),
					new ExpectedCellValue(sheetName, 36, 22, null),
					new ExpectedCellValue(sheetName, 37, 22, null),
					new ExpectedCellValue(sheetName, 38, 22, 1d),
					new ExpectedCellValue(sheetName, 39, 22, 1d),
					new ExpectedCellValue(sheetName, 40, 22, 1d),
					new ExpectedCellValue(sheetName, 41, 22, 1d),
					new ExpectedCellValue(sheetName, 42, 22, 1d),
					new ExpectedCellValue(sheetName, 43, 22, 1d),
					new ExpectedCellValue(sheetName, 44, 22, 1d),
					new ExpectedCellValue(sheetName, 45, 22, 1d),
					new ExpectedCellValue(sheetName, 46, 22, 1d),
					new ExpectedCellValue(sheetName, 47, 22, 1d),
					new ExpectedCellValue(sheetName, 48, 22, null),
					new ExpectedCellValue(sheetName, 49, 22, null),
					new ExpectedCellValue(sheetName, 50, 22, null),
					new ExpectedCellValue(sheetName, 51, 22, null),
					new ExpectedCellValue(sheetName, 52, 22, null),
					new ExpectedCellValue(sheetName, 53, 22, 2d),
					new ExpectedCellValue(sheetName, 15, 23, "San Francisco Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 23, null),
					new ExpectedCellValue(sheetName, 17, 23, null),
					new ExpectedCellValue(sheetName, 18, 23, null),
					new ExpectedCellValue(sheetName, 19, 23, 415.75),
					new ExpectedCellValue(sheetName, 20, 23, null),
					new ExpectedCellValue(sheetName, 21, 23, null),
					new ExpectedCellValue(sheetName, 22, 23, null),
					new ExpectedCellValue(sheetName, 23, 23, null),
					new ExpectedCellValue(sheetName, 24, 23, null),
					new ExpectedCellValue(sheetName, 25, 23, null),
					new ExpectedCellValue(sheetName, 26, 23, null),
					new ExpectedCellValue(sheetName, 27, 23, null),
					new ExpectedCellValue(sheetName, 28, 23, null),
					new ExpectedCellValue(sheetName, 29, 23, null),
					new ExpectedCellValue(sheetName, 30, 23, 415.75),
					new ExpectedCellValue(sheetName, 31, 23, null),
					new ExpectedCellValue(sheetName, 32, 23, null),
					new ExpectedCellValue(sheetName, 33, 23, null),
					new ExpectedCellValue(sheetName, 34, 23, null),
					new ExpectedCellValue(sheetName, 35, 23, null),
					new ExpectedCellValue(sheetName, 36, 23, null),
					new ExpectedCellValue(sheetName, 37, 23, null),
					new ExpectedCellValue(sheetName, 38, 23, 415.75),
					new ExpectedCellValue(sheetName, 39, 23, 415.75),
					new ExpectedCellValue(sheetName, 40, 23, 415.75),
					new ExpectedCellValue(sheetName, 41, 23, 415.75),
					new ExpectedCellValue(sheetName, 42, 23, 99d),
					new ExpectedCellValue(sheetName, 43, 23, 99d),
					new ExpectedCellValue(sheetName, 44, 23, 99d),
					new ExpectedCellValue(sheetName, 45, 23, 99d),
					new ExpectedCellValue(sheetName, 46, 23, 99d),
					new ExpectedCellValue(sheetName, 47, 23, 99d),
					new ExpectedCellValue(sheetName, 48, 23, null),
					new ExpectedCellValue(sheetName, 49, 23, null),
					new ExpectedCellValue(sheetName, 50, 23, null),
					new ExpectedCellValue(sheetName, 51, 23, null),
					new ExpectedCellValue(sheetName, 52, 23, null),
					new ExpectedCellValue(sheetName, 53, 23, 514.75),
					new ExpectedCellValue(sheetName, 15, 24, "Total Sum of Units Sold"),
					new ExpectedCellValue(sheetName, 16, 24, null),
					new ExpectedCellValue(sheetName, 17, 24, null),
					new ExpectedCellValue(sheetName, 18, 24, null),
					new ExpectedCellValue(sheetName, 19, 24, 8d),
					new ExpectedCellValue(sheetName, 20, 24, 2d),
					new ExpectedCellValue(sheetName, 21, 24, 2d),
					new ExpectedCellValue(sheetName, 22, 24, 2d),
					new ExpectedCellValue(sheetName, 23, 24, 2d),
					new ExpectedCellValue(sheetName, 24, 24, 2d),
					new ExpectedCellValue(sheetName, 25, 24, 2d),
					new ExpectedCellValue(sheetName, 26, 24, 2d),
					new ExpectedCellValue(sheetName, 27, 24, 2d),
					new ExpectedCellValue(sheetName, 28, 24, 2d),
					new ExpectedCellValue(sheetName, 29, 24, 2d),
					new ExpectedCellValue(sheetName, 30, 24, 4d),
					new ExpectedCellValue(sheetName, 31, 24, 3d),
					new ExpectedCellValue(sheetName, 32, 24, 2d),
					new ExpectedCellValue(sheetName, 33, 24, 2d),
					new ExpectedCellValue(sheetName, 34, 24, 2d),
					new ExpectedCellValue(sheetName, 35, 24, 1d),
					new ExpectedCellValue(sheetName, 36, 24, 1d),
					new ExpectedCellValue(sheetName, 37, 24, 1d),
					new ExpectedCellValue(sheetName, 38, 24, 1d),
					new ExpectedCellValue(sheetName, 39, 24, 1d),
					new ExpectedCellValue(sheetName, 40, 24, 1d),
					new ExpectedCellValue(sheetName, 41, 24, 1d),
					new ExpectedCellValue(sheetName, 42, 24, 7d),
					new ExpectedCellValue(sheetName, 43, 24, 1d),
					new ExpectedCellValue(sheetName, 44, 24, 1d),
					new ExpectedCellValue(sheetName, 45, 24, 1d),
					new ExpectedCellValue(sheetName, 46, 24, 1d),
					new ExpectedCellValue(sheetName, 47, 24, 1d),
					new ExpectedCellValue(sheetName, 48, 24, 6d),
					new ExpectedCellValue(sheetName, 49, 24, 6d),
					new ExpectedCellValue(sheetName, 50, 24, 6d),
					new ExpectedCellValue(sheetName, 51, 24, 6d),
					new ExpectedCellValue(sheetName, 52, 24, 6d),
					new ExpectedCellValue(sheetName, 53, 24, 15d),
					new ExpectedCellValue(sheetName, 15, 25, "Total Sum of Wholesale Price"),
					new ExpectedCellValue(sheetName, 16, 25, null),
					new ExpectedCellValue(sheetName, 17, 25, null),
					new ExpectedCellValue(sheetName, 18, 25, null),
					new ExpectedCellValue(sheetName, 19, 25, 1687.99),
					new ExpectedCellValue(sheetName, 20, 25, 415.75),
					new ExpectedCellValue(sheetName, 21, 25, 415.75),
					new ExpectedCellValue(sheetName, 22, 25, 415.75),
					new ExpectedCellValue(sheetName, 23, 25, 415.75),
					new ExpectedCellValue(sheetName, 24, 25, 415.75),
					new ExpectedCellValue(sheetName, 25, 25, 415.75),
					new ExpectedCellValue(sheetName, 26, 25, 415.75),
					new ExpectedCellValue(sheetName, 27, 25, 415.75),
					new ExpectedCellValue(sheetName, 28, 25, 415.75),
					new ExpectedCellValue(sheetName, 29, 25, 415.75),
					new ExpectedCellValue(sheetName, 30, 25, 856.49),
					new ExpectedCellValue(sheetName, 31, 25, 440.74),
					new ExpectedCellValue(sheetName, 32, 25, 415.75),
					new ExpectedCellValue(sheetName, 33, 25, 415.75),
					new ExpectedCellValue(sheetName, 34, 25, 415.75),
					new ExpectedCellValue(sheetName, 35, 25, 24.99),
					new ExpectedCellValue(sheetName, 36, 25, 24.99),
					new ExpectedCellValue(sheetName, 37, 25, 24.99),
					new ExpectedCellValue(sheetName, 38, 25, 415.75),
					new ExpectedCellValue(sheetName, 39, 25, 415.75),
					new ExpectedCellValue(sheetName, 40, 25, 415.75),
					new ExpectedCellValue(sheetName, 41, 25, 415.75),
					new ExpectedCellValue(sheetName, 42, 25, 298d),
					new ExpectedCellValue(sheetName, 43, 25, 99d),
					new ExpectedCellValue(sheetName, 44, 25, 99d),
					new ExpectedCellValue(sheetName, 45, 25, 99d),
					new ExpectedCellValue(sheetName, 46, 25, 99d),
					new ExpectedCellValue(sheetName, 47, 25, 99d),
					new ExpectedCellValue(sheetName, 48, 25, 199d),
					new ExpectedCellValue(sheetName, 49, 25, 199d),
					new ExpectedCellValue(sheetName, 50, 25, 199d),
					new ExpectedCellValue(sheetName, 51, 25, 199d),
					new ExpectedCellValue(sheetName, 52, 25, 199d),
					new ExpectedCellValue(sheetName, 53, 25, 1985.99)
				});
			}
		}
		#endregion
		#endregion

		#region Helper Methods
		internal static void CheckPivotTableAddress(ExcelAddress expectedAddress, ExcelAddress pivotTableAddress)
		{
			Assert.AreEqual(expectedAddress.Start.Row, pivotTableAddress.Start.Row);
			Assert.AreEqual(expectedAddress.Start.Column, pivotTableAddress.Start.Column);
			Assert.AreEqual(expectedAddress.End.Row, pivotTableAddress.End.Row);
			Assert.AreEqual(expectedAddress.End.Column, pivotTableAddress.End.Column);
		}
		#endregion
	}
}